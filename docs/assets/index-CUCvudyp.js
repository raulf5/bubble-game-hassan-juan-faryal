(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const A of c)if(A.type==="childList")for(const B of A.addedNodes)B.tagName==="LINK"&&B.rel==="modulepreload"&&o(B)}).observe(document,{childList:!0,subtree:!0});function r(c){const A={};return c.integrity&&(A.integrity=c.integrity),c.referrerPolicy&&(A.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?A.credentials="include":c.crossOrigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function o(c){if(c.ep)return;c.ep=!0;const A=r(c);fetch(c.href,A)}})();function k2(y){if(y.__esModule)return y;var t=y.default;if(typeof t=="function"){var r=function o(){return this instanceof o?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(y).forEach(function(o){var c=Object.getOwnPropertyDescriptor(y,o);Object.defineProperty(r,o,c.get?c:{enumerable:!0,get:function(){return y[o]}})}),r}var U2={exports:{}};(function(y,t){var r={};(function(c,A){y.exports=A()})(self,()=>(()=>{var o={"./node_modules/an-array/index.js":m=>{var M=Object.prototype.toString;m.exports=h;function h(f){return f.BYTES_PER_ELEMENT&&M.call(f.buffer)==="[object ArrayBuffer]"||Array.isArray(f)}},"./node_modules/as-number/index.js":m=>{m.exports=function(h,f){return typeof h=="number"?h:typeof f=="number"?f:0}},"./node_modules/base64-js/index.js":(m,M)=>{M.byteLength=b,M.toByteArray=T,M.fromByteArray=S;for(var h=[],f=[],C=typeof Uint8Array<"u"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,u=p.length;g<u;++g)h[g]=p[g],f[p.charCodeAt(g)]=g;f[45]=62,f[95]=63;function E(L){var P=L.length;if(P%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var D=L.indexOf("=");D===-1&&(D=P);var U=D===P?0:4-D%4;return[D,U]}function b(L){var P=E(L),D=P[0],U=P[1];return(D+U)*3/4-U}function x(L,P,D){return(P+D)*3/4-D}function T(L){var P,D=E(L),U=D[0],F=D[1],j=new C(x(L,U,F)),Y=0,oe=F>0?U-4:U,te;for(te=0;te<oe;te+=4)P=f[L.charCodeAt(te)]<<18|f[L.charCodeAt(te+1)]<<12|f[L.charCodeAt(te+2)]<<6|f[L.charCodeAt(te+3)],j[Y++]=P>>16&255,j[Y++]=P>>8&255,j[Y++]=P&255;return F===2&&(P=f[L.charCodeAt(te)]<<2|f[L.charCodeAt(te+1)]>>4,j[Y++]=P&255),F===1&&(P=f[L.charCodeAt(te)]<<10|f[L.charCodeAt(te+1)]<<4|f[L.charCodeAt(te+2)]>>2,j[Y++]=P>>8&255,j[Y++]=P&255),j}function _(L){return h[L>>18&63]+h[L>>12&63]+h[L>>6&63]+h[L&63]}function w(L,P,D){for(var U,F=[],j=P;j<D;j+=3)U=(L[j]<<16&16711680)+(L[j+1]<<8&65280)+(L[j+2]&255),F.push(_(U));return F.join("")}function S(L){for(var P,D=L.length,U=D%3,F=[],j=16383,Y=0,oe=D-U;Y<oe;Y+=j)F.push(w(L,Y,Y+j>oe?oe:Y+j));return U===1?(P=L[D-1],F.push(h[P>>2]+h[P<<4&63]+"==")):U===2&&(P=(L[D-2]<<8)+L[D-1],F.push(h[P>>10]+h[P>>4&63]+h[P<<2&63]+"=")),F.join("")}},"./node_modules/buffer-equal/index.js":(m,M,h)=>{var f=h("./node_modules/buffer/index.js").Buffer;m.exports=function(C,p){if(f.isBuffer(C)&&f.isBuffer(p)){if(typeof C.equals=="function")return C.equals(p);if(C.length!==p.length)return!1;for(var g=0;g<C.length;g++)if(C[g]!==p[g])return!1;return!0}}},"./node_modules/buffer/index.js":(m,M,h)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const f=h("./node_modules/base64-js/index.js"),C=h("./node_modules/ieee754/index.js"),p=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;M.Buffer=b,M.SlowBuffer=j,M.INSPECT_MAX_BYTES=50;const g=2147483647;M.kMaxLength=g,b.TYPED_ARRAY_SUPPORT=u(),!b.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{const $=new Uint8Array(1),N={foo:function(){return 42}};return Object.setPrototypeOf(N,Uint8Array.prototype),Object.setPrototypeOf($,N),$.foo()===42}catch{return!1}}Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.byteOffset}});function E($){if($>g)throw new RangeError('The value "'+$+'" is invalid for option "size"');const N=new Uint8Array($);return Object.setPrototypeOf(N,b.prototype),N}function b($,N,V){if(typeof $=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w($)}return x($,N,V)}b.poolSize=8192;function x($,N,V){if(typeof $=="string")return S($,N);if(ArrayBuffer.isView($))return P($);if($==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof $);if(ve($,ArrayBuffer)||$&&ve($.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ve($,SharedArrayBuffer)||$&&ve($.buffer,SharedArrayBuffer)))return D($,N,V);if(typeof $=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const fe=$.valueOf&&$.valueOf();if(fe!=null&&fe!==$)return b.from(fe,N,V);const be=U($);if(be)return be;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof $[Symbol.toPrimitive]=="function")return b.from($[Symbol.toPrimitive]("string"),N,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof $)}b.from=function($,N,V){return x($,N,V)},Object.setPrototypeOf(b.prototype,Uint8Array.prototype),Object.setPrototypeOf(b,Uint8Array);function T($){if(typeof $!="number")throw new TypeError('"size" argument must be of type number');if($<0)throw new RangeError('The value "'+$+'" is invalid for option "size"')}function _($,N,V){return T($),$<=0?E($):N!==void 0?typeof V=="string"?E($).fill(N,V):E($).fill(N):E($)}b.alloc=function($,N,V){return _($,N,V)};function w($){return T($),E($<0?0:F($)|0)}b.allocUnsafe=function($){return w($)},b.allocUnsafeSlow=function($){return w($)};function S($,N){if((typeof N!="string"||N==="")&&(N="utf8"),!b.isEncoding(N))throw new TypeError("Unknown encoding: "+N);const V=Y($,N)|0;let fe=E(V);const be=fe.write($,N);return be!==V&&(fe=fe.slice(0,be)),fe}function L($){const N=$.length<0?0:F($.length)|0,V=E(N);for(let fe=0;fe<N;fe+=1)V[fe]=$[fe]&255;return V}function P($){if(ve($,Uint8Array)){const N=new Uint8Array($);return D(N.buffer,N.byteOffset,N.byteLength)}return L($)}function D($,N,V){if(N<0||$.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if($.byteLength<N+(V||0))throw new RangeError('"length" is outside of buffer bounds');let fe;return N===void 0&&V===void 0?fe=new Uint8Array($):V===void 0?fe=new Uint8Array($,N):fe=new Uint8Array($,N,V),Object.setPrototypeOf(fe,b.prototype),fe}function U($){if(b.isBuffer($)){const N=F($.length)|0,V=E(N);return V.length===0||$.copy(V,0,0,N),V}if($.length!==void 0)return typeof $.length!="number"||Le($.length)?E(0):L($);if($.type==="Buffer"&&Array.isArray($.data))return L($.data)}function F($){if($>=g)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+g.toString(16)+" bytes");return $|0}function j($){return+$!=$&&($=0),b.alloc(+$)}b.isBuffer=function(N){return N!=null&&N._isBuffer===!0&&N!==b.prototype},b.compare=function(N,V){if(ve(N,Uint8Array)&&(N=b.from(N,N.offset,N.byteLength)),ve(V,Uint8Array)&&(V=b.from(V,V.offset,V.byteLength)),!b.isBuffer(N)||!b.isBuffer(V))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===V)return 0;let fe=N.length,be=V.length;for(let Fe=0,We=Math.min(fe,be);Fe<We;++Fe)if(N[Fe]!==V[Fe]){fe=N[Fe],be=V[Fe];break}return fe<be?-1:be<fe?1:0},b.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(N,V){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(N.length===0)return b.alloc(0);let fe;if(V===void 0)for(V=0,fe=0;fe<N.length;++fe)V+=N[fe].length;const be=b.allocUnsafe(V);let Fe=0;for(fe=0;fe<N.length;++fe){let We=N[fe];if(ve(We,Uint8Array))Fe+We.length>be.length?(b.isBuffer(We)||(We=b.from(We)),We.copy(be,Fe)):Uint8Array.prototype.set.call(be,We,Fe);else if(b.isBuffer(We))We.copy(be,Fe);else throw new TypeError('"list" argument must be an Array of Buffers');Fe+=We.length}return be};function Y($,N){if(b.isBuffer($))return $.length;if(ArrayBuffer.isView($)||ve($,ArrayBuffer))return $.byteLength;if(typeof $!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof $);const V=$.length,fe=arguments.length>2&&arguments[2]===!0;if(!fe&&V===0)return 0;let be=!1;for(;;)switch(N){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":return Cr($).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V*2;case"hex":return V>>>1;case"base64":return St($).length;default:if(be)return fe?-1:Cr($).length;N=(""+N).toLowerCase(),be=!0}}b.byteLength=Y;function oe($,N,V){let fe=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((V===void 0||V>this.length)&&(V=this.length),V<=0)||(V>>>=0,N>>>=0,V<=N))return"";for($||($="utf8");;)switch($){case"hex":return yt(this,N,V);case"utf8":case"utf-8":return De(this,N,V);case"ascii":return Je(this,N,V);case"latin1":case"binary":return pt(this,N,V);case"base64":return Me(this,N,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gt(this,N,V);default:if(fe)throw new TypeError("Unknown encoding: "+$);$=($+"").toLowerCase(),fe=!0}}b.prototype._isBuffer=!0;function te($,N,V){const fe=$[N];$[N]=$[V],$[V]=fe}b.prototype.swap16=function(){const N=this.length;if(N%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let V=0;V<N;V+=2)te(this,V,V+1);return this},b.prototype.swap32=function(){const N=this.length;if(N%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let V=0;V<N;V+=4)te(this,V,V+3),te(this,V+1,V+2);return this},b.prototype.swap64=function(){const N=this.length;if(N%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let V=0;V<N;V+=8)te(this,V,V+7),te(this,V+1,V+6),te(this,V+2,V+5),te(this,V+3,V+4);return this},b.prototype.toString=function(){const N=this.length;return N===0?"":arguments.length===0?De(this,0,N):oe.apply(this,arguments)},b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=function(N){if(!b.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N?!0:b.compare(this,N)===0},b.prototype.inspect=function(){let N="";const V=M.INSPECT_MAX_BYTES;return N=this.toString("hex",0,V).replace(/(.{2})/g,"$1 ").trim(),this.length>V&&(N+=" ... "),"<Buffer "+N+">"},p&&(b.prototype[p]=b.prototype.inspect),b.prototype.compare=function(N,V,fe,be,Fe){if(ve(N,Uint8Array)&&(N=b.from(N,N.offset,N.byteLength)),!b.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(V===void 0&&(V=0),fe===void 0&&(fe=N?N.length:0),be===void 0&&(be=0),Fe===void 0&&(Fe=this.length),V<0||fe>N.length||be<0||Fe>this.length)throw new RangeError("out of range index");if(be>=Fe&&V>=fe)return 0;if(be>=Fe)return-1;if(V>=fe)return 1;if(V>>>=0,fe>>>=0,be>>>=0,Fe>>>=0,this===N)return 0;let We=Fe-be,Rt=fe-V;const zt=Math.min(We,Rt),Lt=this.slice(be,Fe),Tt=N.slice(V,fe);for(let ti=0;ti<zt;++ti)if(Lt[ti]!==Tt[ti]){We=Lt[ti],Rt=Tt[ti];break}return We<Rt?-1:Rt<We?1:0};function pe($,N,V,fe,be){if($.length===0)return-1;if(typeof V=="string"?(fe=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),V=+V,Le(V)&&(V=be?0:$.length-1),V<0&&(V=$.length+V),V>=$.length){if(be)return-1;V=$.length-1}else if(V<0)if(be)V=0;else return-1;if(typeof N=="string"&&(N=b.from(N,fe)),b.isBuffer(N))return N.length===0?-1:de($,N,V,fe,be);if(typeof N=="number")return N=N&255,typeof Uint8Array.prototype.indexOf=="function"?be?Uint8Array.prototype.indexOf.call($,N,V):Uint8Array.prototype.lastIndexOf.call($,N,V):de($,[N],V,fe,be);throw new TypeError("val must be string, number or Buffer")}function de($,N,V,fe,be){let Fe=1,We=$.length,Rt=N.length;if(fe!==void 0&&(fe=String(fe).toLowerCase(),fe==="ucs2"||fe==="ucs-2"||fe==="utf16le"||fe==="utf-16le")){if($.length<2||N.length<2)return-1;Fe=2,We/=2,Rt/=2,V/=2}function zt(Tt,ti){return Fe===1?Tt[ti]:Tt.readUInt16BE(ti*Fe)}let Lt;if(be){let Tt=-1;for(Lt=V;Lt<We;Lt++)if(zt($,Lt)===zt(N,Tt===-1?0:Lt-Tt)){if(Tt===-1&&(Tt=Lt),Lt-Tt+1===Rt)return Tt*Fe}else Tt!==-1&&(Lt-=Lt-Tt),Tt=-1}else for(V+Rt>We&&(V=We-Rt),Lt=V;Lt>=0;Lt--){let Tt=!0;for(let ti=0;ti<Rt;ti++)if(zt($,Lt+ti)!==zt(N,ti)){Tt=!1;break}if(Tt)return Lt}return-1}b.prototype.includes=function(N,V,fe){return this.indexOf(N,V,fe)!==-1},b.prototype.indexOf=function(N,V,fe){return pe(this,N,V,fe,!0)},b.prototype.lastIndexOf=function(N,V,fe){return pe(this,N,V,fe,!1)};function se($,N,V,fe){V=Number(V)||0;const be=$.length-V;fe?(fe=Number(fe),fe>be&&(fe=be)):fe=be;const Fe=N.length;fe>Fe/2&&(fe=Fe/2);let We;for(We=0;We<fe;++We){const Rt=parseInt(N.substr(We*2,2),16);if(Le(Rt))return We;$[V+We]=Rt}return We}function J($,N,V,fe){return ye(Cr(N,$.length-V),$,V,fe)}function H($,N,V,fe){return ye(ar(N),$,V,fe)}function ae($,N,V,fe){return ye(St(N),$,V,fe)}function ue($,N,V,fe){return ye(Tn(N,$.length-V),$,V,fe)}b.prototype.write=function(N,V,fe,be){if(V===void 0)be="utf8",fe=this.length,V=0;else if(fe===void 0&&typeof V=="string")be=V,fe=this.length,V=0;else if(isFinite(V))V=V>>>0,isFinite(fe)?(fe=fe>>>0,be===void 0&&(be="utf8")):(be=fe,fe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Fe=this.length-V;if((fe===void 0||fe>Fe)&&(fe=Fe),N.length>0&&(fe<0||V<0)||V>this.length)throw new RangeError("Attempt to write outside buffer bounds");be||(be="utf8");let We=!1;for(;;)switch(be){case"hex":return se(this,N,V,fe);case"utf8":case"utf-8":return J(this,N,V,fe);case"ascii":case"latin1":case"binary":return H(this,N,V,fe);case"base64":return ae(this,N,V,fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,N,V,fe);default:if(We)throw new TypeError("Unknown encoding: "+be);be=(""+be).toLowerCase(),We=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Me($,N,V){return N===0&&V===$.length?f.fromByteArray($):f.fromByteArray($.slice(N,V))}function De($,N,V){V=Math.min($.length,V);const fe=[];let be=N;for(;be<V;){const Fe=$[be];let We=null,Rt=Fe>239?4:Fe>223?3:Fe>191?2:1;if(be+Rt<=V){let zt,Lt,Tt,ti;switch(Rt){case 1:Fe<128&&(We=Fe);break;case 2:zt=$[be+1],(zt&192)===128&&(ti=(Fe&31)<<6|zt&63,ti>127&&(We=ti));break;case 3:zt=$[be+1],Lt=$[be+2],(zt&192)===128&&(Lt&192)===128&&(ti=(Fe&15)<<12|(zt&63)<<6|Lt&63,ti>2047&&(ti<55296||ti>57343)&&(We=ti));break;case 4:zt=$[be+1],Lt=$[be+2],Tt=$[be+3],(zt&192)===128&&(Lt&192)===128&&(Tt&192)===128&&(ti=(Fe&15)<<18|(zt&63)<<12|(Lt&63)<<6|Tt&63,ti>65535&&ti<1114112&&(We=ti))}}We===null?(We=65533,Rt=1):We>65535&&(We-=65536,fe.push(We>>>10&1023|55296),We=56320|We&1023),fe.push(We),be+=Rt}return Xe(fe)}const Ge=4096;function Xe($){const N=$.length;if(N<=Ge)return String.fromCharCode.apply(String,$);let V="",fe=0;for(;fe<N;)V+=String.fromCharCode.apply(String,$.slice(fe,fe+=Ge));return V}function Je($,N,V){let fe="";V=Math.min($.length,V);for(let be=N;be<V;++be)fe+=String.fromCharCode($[be]&127);return fe}function pt($,N,V){let fe="";V=Math.min($.length,V);for(let be=N;be<V;++be)fe+=String.fromCharCode($[be]);return fe}function yt($,N,V){const fe=$.length;(!N||N<0)&&(N=0),(!V||V<0||V>fe)&&(V=fe);let be="";for(let Fe=N;Fe<V;++Fe)be+=Se[$[Fe]];return be}function Gt($,N,V){const fe=$.slice(N,V);let be="";for(let Fe=0;Fe<fe.length-1;Fe+=2)be+=String.fromCharCode(fe[Fe]+fe[Fe+1]*256);return be}b.prototype.slice=function(N,V){const fe=this.length;N=~~N,V=V===void 0?fe:~~V,N<0?(N+=fe,N<0&&(N=0)):N>fe&&(N=fe),V<0?(V+=fe,V<0&&(V=0)):V>fe&&(V=fe),V<N&&(V=N);const be=this.subarray(N,V);return Object.setPrototypeOf(be,b.prototype),be};function Et($,N,V){if($%1!==0||$<0)throw new RangeError("offset is not uint");if($+N>V)throw new RangeError("Trying to access beyond buffer length")}b.prototype.readUintLE=b.prototype.readUIntLE=function(N,V,fe){N=N>>>0,V=V>>>0,fe||Et(N,V,this.length);let be=this[N],Fe=1,We=0;for(;++We<V&&(Fe*=256);)be+=this[N+We]*Fe;return be},b.prototype.readUintBE=b.prototype.readUIntBE=function(N,V,fe){N=N>>>0,V=V>>>0,fe||Et(N,V,this.length);let be=this[N+--V],Fe=1;for(;V>0&&(Fe*=256);)be+=this[N+--V]*Fe;return be},b.prototype.readUint8=b.prototype.readUInt8=function(N,V){return N=N>>>0,V||Et(N,1,this.length),this[N]},b.prototype.readUint16LE=b.prototype.readUInt16LE=function(N,V){return N=N>>>0,V||Et(N,2,this.length),this[N]|this[N+1]<<8},b.prototype.readUint16BE=b.prototype.readUInt16BE=function(N,V){return N=N>>>0,V||Et(N,2,this.length),this[N]<<8|this[N+1]},b.prototype.readUint32LE=b.prototype.readUInt32LE=function(N,V){return N=N>>>0,V||Et(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+this[N+3]*16777216},b.prototype.readUint32BE=b.prototype.readUInt32BE=function(N,V){return N=N>>>0,V||Et(N,4,this.length),this[N]*16777216+(this[N+1]<<16|this[N+2]<<8|this[N+3])},b.prototype.readBigUInt64LE=Re(function(N){N=N>>>0,bn(N,"offset");const V=this[N],fe=this[N+7];(V===void 0||fe===void 0)&&cn(N,this.length-8);const be=V+this[++N]*2**8+this[++N]*2**16+this[++N]*2**24,Fe=this[++N]+this[++N]*2**8+this[++N]*2**16+fe*2**24;return BigInt(be)+(BigInt(Fe)<<BigInt(32))}),b.prototype.readBigUInt64BE=Re(function(N){N=N>>>0,bn(N,"offset");const V=this[N],fe=this[N+7];(V===void 0||fe===void 0)&&cn(N,this.length-8);const be=V*2**24+this[++N]*2**16+this[++N]*2**8+this[++N],Fe=this[++N]*2**24+this[++N]*2**16+this[++N]*2**8+fe;return(BigInt(be)<<BigInt(32))+BigInt(Fe)}),b.prototype.readIntLE=function(N,V,fe){N=N>>>0,V=V>>>0,fe||Et(N,V,this.length);let be=this[N],Fe=1,We=0;for(;++We<V&&(Fe*=256);)be+=this[N+We]*Fe;return Fe*=128,be>=Fe&&(be-=Math.pow(2,8*V)),be},b.prototype.readIntBE=function(N,V,fe){N=N>>>0,V=V>>>0,fe||Et(N,V,this.length);let be=V,Fe=1,We=this[N+--be];for(;be>0&&(Fe*=256);)We+=this[N+--be]*Fe;return Fe*=128,We>=Fe&&(We-=Math.pow(2,8*V)),We},b.prototype.readInt8=function(N,V){return N=N>>>0,V||Et(N,1,this.length),this[N]&128?(255-this[N]+1)*-1:this[N]},b.prototype.readInt16LE=function(N,V){N=N>>>0,V||Et(N,2,this.length);const fe=this[N]|this[N+1]<<8;return fe&32768?fe|4294901760:fe},b.prototype.readInt16BE=function(N,V){N=N>>>0,V||Et(N,2,this.length);const fe=this[N+1]|this[N]<<8;return fe&32768?fe|4294901760:fe},b.prototype.readInt32LE=function(N,V){return N=N>>>0,V||Et(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},b.prototype.readInt32BE=function(N,V){return N=N>>>0,V||Et(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},b.prototype.readBigInt64LE=Re(function(N){N=N>>>0,bn(N,"offset");const V=this[N],fe=this[N+7];(V===void 0||fe===void 0)&&cn(N,this.length-8);const be=this[N+4]+this[N+5]*2**8+this[N+6]*2**16+(fe<<24);return(BigInt(be)<<BigInt(32))+BigInt(V+this[++N]*256+this[++N]*65536+this[++N]*16777216)}),b.prototype.readBigInt64BE=Re(function(N){N=N>>>0,bn(N,"offset");const V=this[N],fe=this[N+7];(V===void 0||fe===void 0)&&cn(N,this.length-8);const be=(V<<24)+this[++N]*2**16+this[++N]*2**8+this[++N];return(BigInt(be)<<BigInt(32))+BigInt(this[++N]*16777216+this[++N]*65536+this[++N]*256+fe)}),b.prototype.readFloatLE=function(N,V){return N=N>>>0,V||Et(N,4,this.length),C.read(this,N,!0,23,4)},b.prototype.readFloatBE=function(N,V){return N=N>>>0,V||Et(N,4,this.length),C.read(this,N,!1,23,4)},b.prototype.readDoubleLE=function(N,V){return N=N>>>0,V||Et(N,8,this.length),C.read(this,N,!0,52,8)},b.prototype.readDoubleBE=function(N,V){return N=N>>>0,V||Et(N,8,this.length),C.read(this,N,!1,52,8)};function Vt($,N,V,fe,be,Fe){if(!b.isBuffer($))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>be||N<Fe)throw new RangeError('"value" argument is out of bounds');if(V+fe>$.length)throw new RangeError("Index out of range")}b.prototype.writeUintLE=b.prototype.writeUIntLE=function(N,V,fe,be){if(N=+N,V=V>>>0,fe=fe>>>0,!be){const Rt=Math.pow(2,8*fe)-1;Vt(this,N,V,fe,Rt,0)}let Fe=1,We=0;for(this[V]=N&255;++We<fe&&(Fe*=256);)this[V+We]=N/Fe&255;return V+fe},b.prototype.writeUintBE=b.prototype.writeUIntBE=function(N,V,fe,be){if(N=+N,V=V>>>0,fe=fe>>>0,!be){const Rt=Math.pow(2,8*fe)-1;Vt(this,N,V,fe,Rt,0)}let Fe=fe-1,We=1;for(this[V+Fe]=N&255;--Fe>=0&&(We*=256);)this[V+Fe]=N/We&255;return V+fe},b.prototype.writeUint8=b.prototype.writeUInt8=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,1,255,0),this[V]=N&255,V+1},b.prototype.writeUint16LE=b.prototype.writeUInt16LE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,2,65535,0),this[V]=N&255,this[V+1]=N>>>8,V+2},b.prototype.writeUint16BE=b.prototype.writeUInt16BE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,2,65535,0),this[V]=N>>>8,this[V+1]=N&255,V+2},b.prototype.writeUint32LE=b.prototype.writeUInt32LE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,4,4294967295,0),this[V+3]=N>>>24,this[V+2]=N>>>16,this[V+1]=N>>>8,this[V]=N&255,V+4},b.prototype.writeUint32BE=b.prototype.writeUInt32BE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,4,4294967295,0),this[V]=N>>>24,this[V+1]=N>>>16,this[V+2]=N>>>8,this[V+3]=N&255,V+4};function Yt($,N,V,fe,be){rr(N,fe,be,$,V,7);let Fe=Number(N&BigInt(4294967295));$[V++]=Fe,Fe=Fe>>8,$[V++]=Fe,Fe=Fe>>8,$[V++]=Fe,Fe=Fe>>8,$[V++]=Fe;let We=Number(N>>BigInt(32)&BigInt(4294967295));return $[V++]=We,We=We>>8,$[V++]=We,We=We>>8,$[V++]=We,We=We>>8,$[V++]=We,V}function gi($,N,V,fe,be){rr(N,fe,be,$,V,7);let Fe=Number(N&BigInt(4294967295));$[V+7]=Fe,Fe=Fe>>8,$[V+6]=Fe,Fe=Fe>>8,$[V+5]=Fe,Fe=Fe>>8,$[V+4]=Fe;let We=Number(N>>BigInt(32)&BigInt(4294967295));return $[V+3]=We,We=We>>8,$[V+2]=We,We=We>>8,$[V+1]=We,We=We>>8,$[V]=We,V+8}b.prototype.writeBigUInt64LE=Re(function(N,V=0){return Yt(this,N,V,BigInt(0),BigInt("0xffffffffffffffff"))}),b.prototype.writeBigUInt64BE=Re(function(N,V=0){return gi(this,N,V,BigInt(0),BigInt("0xffffffffffffffff"))}),b.prototype.writeIntLE=function(N,V,fe,be){if(N=+N,V=V>>>0,!be){const zt=Math.pow(2,8*fe-1);Vt(this,N,V,fe,zt-1,-zt)}let Fe=0,We=1,Rt=0;for(this[V]=N&255;++Fe<fe&&(We*=256);)N<0&&Rt===0&&this[V+Fe-1]!==0&&(Rt=1),this[V+Fe]=(N/We>>0)-Rt&255;return V+fe},b.prototype.writeIntBE=function(N,V,fe,be){if(N=+N,V=V>>>0,!be){const zt=Math.pow(2,8*fe-1);Vt(this,N,V,fe,zt-1,-zt)}let Fe=fe-1,We=1,Rt=0;for(this[V+Fe]=N&255;--Fe>=0&&(We*=256);)N<0&&Rt===0&&this[V+Fe+1]!==0&&(Rt=1),this[V+Fe]=(N/We>>0)-Rt&255;return V+fe},b.prototype.writeInt8=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,1,127,-128),N<0&&(N=255+N+1),this[V]=N&255,V+1},b.prototype.writeInt16LE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,2,32767,-32768),this[V]=N&255,this[V+1]=N>>>8,V+2},b.prototype.writeInt16BE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,2,32767,-32768),this[V]=N>>>8,this[V+1]=N&255,V+2},b.prototype.writeInt32LE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,4,2147483647,-2147483648),this[V]=N&255,this[V+1]=N>>>8,this[V+2]=N>>>16,this[V+3]=N>>>24,V+4},b.prototype.writeInt32BE=function(N,V,fe){return N=+N,V=V>>>0,fe||Vt(this,N,V,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[V]=N>>>24,this[V+1]=N>>>16,this[V+2]=N>>>8,this[V+3]=N&255,V+4},b.prototype.writeBigInt64LE=Re(function(N,V=0){return Yt(this,N,V,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),b.prototype.writeBigInt64BE=Re(function(N,V=0){return gi(this,N,V,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ri($,N,V,fe,be,Fe){if(V+fe>$.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function Ni($,N,V,fe,be){return N=+N,V=V>>>0,be||Ri($,N,V,4),C.write($,N,V,fe,23,4),V+4}b.prototype.writeFloatLE=function(N,V,fe){return Ni(this,N,V,!0,fe)},b.prototype.writeFloatBE=function(N,V,fe){return Ni(this,N,V,!1,fe)};function Oi($,N,V,fe,be){return N=+N,V=V>>>0,be||Ri($,N,V,8),C.write($,N,V,fe,52,8),V+8}b.prototype.writeDoubleLE=function(N,V,fe){return Oi(this,N,V,!0,fe)},b.prototype.writeDoubleBE=function(N,V,fe){return Oi(this,N,V,!1,fe)},b.prototype.copy=function(N,V,fe,be){if(!b.isBuffer(N))throw new TypeError("argument should be a Buffer");if(fe||(fe=0),!be&&be!==0&&(be=this.length),V>=N.length&&(V=N.length),V||(V=0),be>0&&be<fe&&(be=fe),be===fe||N.length===0||this.length===0)return 0;if(V<0)throw new RangeError("targetStart out of bounds");if(fe<0||fe>=this.length)throw new RangeError("Index out of range");if(be<0)throw new RangeError("sourceEnd out of bounds");be>this.length&&(be=this.length),N.length-V<be-fe&&(be=N.length-V+fe);const Fe=be-fe;return this===N&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(V,fe,be):Uint8Array.prototype.set.call(N,this.subarray(fe,be),V),Fe},b.prototype.fill=function(N,V,fe,be){if(typeof N=="string"){if(typeof V=="string"?(be=V,V=0,fe=this.length):typeof fe=="string"&&(be=fe,fe=this.length),be!==void 0&&typeof be!="string")throw new TypeError("encoding must be a string");if(typeof be=="string"&&!b.isEncoding(be))throw new TypeError("Unknown encoding: "+be);if(N.length===1){const We=N.charCodeAt(0);(be==="utf8"&&We<128||be==="latin1")&&(N=We)}}else typeof N=="number"?N=N&255:typeof N=="boolean"&&(N=Number(N));if(V<0||this.length<V||this.length<fe)throw new RangeError("Out of range index");if(fe<=V)return this;V=V>>>0,fe=fe===void 0?this.length:fe>>>0,N||(N=0);let Fe;if(typeof N=="number")for(Fe=V;Fe<fe;++Fe)this[Fe]=N;else{const We=b.isBuffer(N)?N:b.from(N,be),Rt=We.length;if(Rt===0)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(Fe=0;Fe<fe-V;++Fe)this[Fe+V]=We[Fe%Rt]}return this};const yi={};function zi($,N,V){yi[$]=class extends V{constructor(){super(),Object.defineProperty(this,"message",{value:N.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${$}]`,this.stack,delete this.name}get code(){return $}set code(be){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:be,writable:!0})}toString(){return`${this.name} [${$}]: ${this.message}`}}}zi("ERR_BUFFER_OUT_OF_BOUNDS",function($){return $?`${$} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),zi("ERR_INVALID_ARG_TYPE",function($,N){return`The "${$}" argument must be of type number. Received type ${typeof N}`},TypeError),zi("ERR_OUT_OF_RANGE",function($,N,V){let fe=`The value of "${$}" is out of range.`,be=V;return Number.isInteger(V)&&Math.abs(V)>4294967296?be=Cn(String(V)):typeof V=="bigint"&&(be=String(V),(V>BigInt(2)**BigInt(32)||V<-(BigInt(2)**BigInt(32)))&&(be=Cn(be)),be+="n"),fe+=` It must be ${N}. Received ${be}`,fe},RangeError);function Cn($){let N="",V=$.length;const fe=$[0]==="-"?1:0;for(;V>=fe+4;V-=3)N=`_${$.slice(V-3,V)}${N}`;return`${$.slice(0,V)}${N}`}function gn($,N,V){bn(N,"offset"),($[N]===void 0||$[N+V]===void 0)&&cn(N,$.length-(V+1))}function rr($,N,V,fe,be,Fe){if($>V||$<N){const We=typeof N=="bigint"?"n":"";let Rt;throw N===0||N===BigInt(0)?Rt=`>= 0${We} and < 2${We} ** ${(Fe+1)*8}${We}`:Rt=`>= -(2${We} ** ${(Fe+1)*8-1}${We}) and < 2 ** ${(Fe+1)*8-1}${We}`,new yi.ERR_OUT_OF_RANGE("value",Rt,$)}gn(fe,be,Fe)}function bn($,N){if(typeof $!="number")throw new yi.ERR_INVALID_ARG_TYPE(N,"number",$)}function cn($,N,V){throw Math.floor($)!==$?(bn($,V),new yi.ERR_OUT_OF_RANGE("offset","an integer",$)):N<0?new yi.ERR_BUFFER_OUT_OF_BOUNDS:new yi.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${N}`,$)}const Kn=/[^+/0-9A-Za-z-_]/g;function wn($){if($=$.split("=")[0],$=$.trim().replace(Kn,""),$.length<2)return"";for(;$.length%4!==0;)$=$+"=";return $}function Cr($,N){N=N||1/0;let V;const fe=$.length;let be=null;const Fe=[];for(let We=0;We<fe;++We){if(V=$.charCodeAt(We),V>55295&&V<57344){if(!be){if(V>56319){(N-=3)>-1&&Fe.push(239,191,189);continue}else if(We+1===fe){(N-=3)>-1&&Fe.push(239,191,189);continue}be=V;continue}if(V<56320){(N-=3)>-1&&Fe.push(239,191,189),be=V;continue}V=(be-55296<<10|V-56320)+65536}else be&&(N-=3)>-1&&Fe.push(239,191,189);if(be=null,V<128){if((N-=1)<0)break;Fe.push(V)}else if(V<2048){if((N-=2)<0)break;Fe.push(V>>6|192,V&63|128)}else if(V<65536){if((N-=3)<0)break;Fe.push(V>>12|224,V>>6&63|128,V&63|128)}else if(V<1114112){if((N-=4)<0)break;Fe.push(V>>18|240,V>>12&63|128,V>>6&63|128,V&63|128)}else throw new Error("Invalid code point")}return Fe}function ar($){const N=[];for(let V=0;V<$.length;++V)N.push($.charCodeAt(V)&255);return N}function Tn($,N){let V,fe,be;const Fe=[];for(let We=0;We<$.length&&!((N-=2)<0);++We)V=$.charCodeAt(We),fe=V>>8,be=V%256,Fe.push(be),Fe.push(fe);return Fe}function St($){return f.toByteArray(wn($))}function ye($,N,V,fe){let be;for(be=0;be<fe&&!(be+V>=N.length||be>=$.length);++be)N[be+V]=$[be];return be}function ve($,N){return $ instanceof N||$!=null&&$.constructor!=null&&$.constructor.name!=null&&$.constructor.name===N.name}function Le($){return $!==$}const Se=function(){const $="0123456789abcdef",N=new Array(256);for(let V=0;V<16;++V){const fe=V*16;for(let be=0;be<16;++be)N[fe+be]=$[V]+$[be]}return N}();function Re($){return typeof BigInt>"u"?Pe:$}function Pe(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":m=>{m.exports=function(M){var h=[];return h.toString=function(){return this.map(function(C){var p="",g=typeof C[5]<"u";return C[4]&&(p+="@supports (".concat(C[4],") {")),C[2]&&(p+="@media ".concat(C[2]," {")),g&&(p+="@layer".concat(C[5].length>0?" ".concat(C[5]):""," {")),p+=M(C),g&&(p+="}"),C[2]&&(p+="}"),C[4]&&(p+="}"),p}).join("")},h.i=function(C,p,g,u,E){typeof C=="string"&&(C=[[null,C,void 0]]);var b={};if(g)for(var x=0;x<this.length;x++){var T=this[x][0];T!=null&&(b[T]=!0)}for(var _=0;_<C.length;_++){var w=[].concat(C[_]);g&&b[w[0]]||(typeof E<"u"&&(typeof w[5]>"u"||(w[1]="@layer".concat(w[5].length>0?" ".concat(w[5]):""," {").concat(w[1],"}")),w[5]=E),p&&(w[2]&&(w[1]="@media ".concat(w[2]," {").concat(w[1],"}")),w[2]=p),u&&(w[4]?(w[1]="@supports (".concat(w[4],") {").concat(w[1],"}"),w[4]=u):w[4]="".concat(u)),h.push(w))}},h}},"./node_modules/css-loader/dist/runtime/getUrl.js":m=>{m.exports=function(M,h){return h||(h={}),M&&(M=String(M.__esModule?M.default:M),/^['"].*['"]$/.test(M)&&(M=M.slice(1,-1)),h.hash&&(M+=h.hash),/["'() \t\n]|(%20)/.test(M)||h.needQuotes?'"'.concat(M.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):M)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":m=>{m.exports=function(M){var h=M[1],f=M[3];if(!f)return h;if(typeof btoa=="function"){var C=btoa(unescape(encodeURIComponent(JSON.stringify(f)))),p="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(C),g="/*# ".concat(p," */");return[h].concat([g]).join(`
`)}return[h].join(`
`)}},"./node_modules/debug/src/browser.js":(m,M,h)=>{M.formatArgs=C,M.save=p,M.load=g,M.useColors=f,M.storage=u(),M.destroy=(()=>{let b=!1;return()=>{b||(b=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),M.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function f(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function C(b){if(b[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+b[0]+(this.useColors?"%c ":" ")+"+"+m.exports.humanize(this.diff),!this.useColors)return;const x="color: "+this.color;b.splice(1,0,x,"color: inherit");let T=0,_=0;b[0].replace(/%[a-zA-Z%]/g,w=>{w!=="%%"&&(T++,w==="%c"&&(_=T))}),b.splice(_,0,x)}M.log=console.debug||console.log||(()=>{});function p(b){try{b?M.storage.setItem("debug",b):M.storage.removeItem("debug")}catch{}}function g(){let b;try{b=M.storage.getItem("debug")}catch{}return!b&&typeof process<"u"&&"env"in process&&(b=r.DEBUG),b}function u(){try{return localStorage}catch{}}m.exports=h("./node_modules/debug/src/common.js")(M);const{formatters:E}=m.exports;E.j=function(b){try{return JSON.stringify(b)}catch(x){return"[UnexpectedJSONParseError]: "+x.message}}},"./node_modules/debug/src/common.js":(m,M,h)=>{function f(C){g.debug=g,g.default=g,g.coerce=_,g.disable=b,g.enable=E,g.enabled=x,g.humanize=h("./node_modules/ms/index.js"),g.destroy=w,Object.keys(C).forEach(S=>{g[S]=C[S]}),g.names=[],g.skips=[],g.formatters={};function p(S){let L=0;for(let P=0;P<S.length;P++)L=(L<<5)-L+S.charCodeAt(P),L|=0;return g.colors[Math.abs(L)%g.colors.length]}g.selectColor=p;function g(S){let L,P=null,D,U;function F(...j){if(!F.enabled)return;const Y=F,oe=Number(new Date),te=oe-(L||oe);Y.diff=te,Y.prev=L,Y.curr=oe,L=oe,j[0]=g.coerce(j[0]),typeof j[0]!="string"&&j.unshift("%O");let pe=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(se,J)=>{if(se==="%%")return"%";pe++;const H=g.formatters[J];if(typeof H=="function"){const ae=j[pe];se=H.call(Y,ae),j.splice(pe,1),pe--}return se}),g.formatArgs.call(Y,j),(Y.log||g.log).apply(Y,j)}return F.namespace=S,F.useColors=g.useColors(),F.color=g.selectColor(S),F.extend=u,F.destroy=g.destroy,Object.defineProperty(F,"enabled",{enumerable:!0,configurable:!1,get:()=>P!==null?P:(D!==g.namespaces&&(D=g.namespaces,U=g.enabled(S)),U),set:j=>{P=j}}),typeof g.init=="function"&&g.init(F),F}function u(S,L){const P=g(this.namespace+(typeof L>"u"?":":L)+S);return P.log=this.log,P}function E(S){g.save(S),g.namespaces=S,g.names=[],g.skips=[];let L;const P=(typeof S=="string"?S:"").split(/[\s,]+/),D=P.length;for(L=0;L<D;L++)P[L]&&(S=P[L].replace(/\*/g,".*?"),S[0]==="-"?g.skips.push(new RegExp("^"+S.slice(1)+"$")):g.names.push(new RegExp("^"+S+"$")))}function b(){const S=[...g.names.map(T),...g.skips.map(T).map(L=>"-"+L)].join(",");return g.enable(""),S}function x(S){if(S[S.length-1]==="*")return!0;let L,P;for(L=0,P=g.skips.length;L<P;L++)if(g.skips[L].test(S))return!1;for(L=0,P=g.names.length;L<P;L++)if(g.names[L].test(S))return!0;return!1}function T(S){return S.toString().substring(2,S.toString().length-2).replace(/\.\*\?$/,"*")}function _(S){return S instanceof Error?S.stack||S.message:S}function w(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return g.enable(g.load()),g}m.exports=f},"./node_modules/deep-assign/index.js":(m,M,h)=>{var f=h("./node_modules/is-obj/index.js"),C=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;function g(b){if(b==null)throw new TypeError("Sources cannot be null or undefined");return Object(b)}function u(b,x,T){var _=x[T];if(_!=null){if(C.call(b,T)&&(b[T]===void 0||b[T]===null))throw new TypeError("Cannot convert undefined or null to object ("+T+")");!C.call(b,T)||!f(_)?b[T]=_:b[T]=E(Object(b[T]),x[T])}}function E(b,x){if(b===x)return b;x=Object(x);for(var T in x)C.call(x,T)&&u(b,x,T);if(Object.getOwnPropertySymbols)for(var _=Object.getOwnPropertySymbols(x),w=0;w<_.length;w++)p.call(x,_[w])&&u(b,x,_[w]);return b}m.exports=function(x){x=g(x);for(var T=1;T<arguments.length;T++)E(x,arguments[T]);return x}},"./node_modules/dtype/index.js":m=>{m.exports=function(M){switch(M){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(m,M,h)=>{var f;typeof window<"u"?f=window:typeof h.g<"u"?f=h.g:typeof self<"u"?f=self:f={},m.exports=f},"./node_modules/ieee754/index.js":(m,M)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */M.read=function(h,f,C,p,g){var u,E,b=g*8-p-1,x=(1<<b)-1,T=x>>1,_=-7,w=C?g-1:0,S=C?-1:1,L=h[f+w];for(w+=S,u=L&(1<<-_)-1,L>>=-_,_+=b;_>0;u=u*256+h[f+w],w+=S,_-=8);for(E=u&(1<<-_)-1,u>>=-_,_+=p;_>0;E=E*256+h[f+w],w+=S,_-=8);if(u===0)u=1-T;else{if(u===x)return E?NaN:(L?-1:1)*(1/0);E=E+Math.pow(2,p),u=u-T}return(L?-1:1)*E*Math.pow(2,u-p)},M.write=function(h,f,C,p,g,u){var E,b,x,T=u*8-g-1,_=(1<<T)-1,w=_>>1,S=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=p?0:u-1,P=p?1:-1,D=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(b=isNaN(f)?1:0,E=_):(E=Math.floor(Math.log(f)/Math.LN2),f*(x=Math.pow(2,-E))<1&&(E--,x*=2),E+w>=1?f+=S/x:f+=S*Math.pow(2,1-w),f*x>=2&&(E++,x/=2),E+w>=_?(b=0,E=_):E+w>=1?(b=(f*x-1)*Math.pow(2,g),E=E+w):(b=f*Math.pow(2,w-1)*Math.pow(2,g),E=0));g>=8;h[C+L]=b&255,L+=P,b/=256,g-=8);for(E=E<<g|b,T+=g;T>0;h[C+L]=E&255,L+=P,E/=256,T-=8);h[C+L-P]|=D*128}},"./node_modules/is-buffer/index.js":m=>{/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */m.exports=function(f){return f!=null&&(M(f)||h(f)||!!f._isBuffer)};function M(f){return!!f.constructor&&typeof f.constructor.isBuffer=="function"&&f.constructor.isBuffer(f)}function h(f){return typeof f.readFloatLE=="function"&&typeof f.slice=="function"&&M(f.slice(0,0))}},"./node_modules/is-function/index.js":m=>{m.exports=h;var M=Object.prototype.toString;function h(f){if(!f)return!1;var C=M.call(f);return C==="[object Function]"||typeof f=="function"&&C!=="[object RegExp]"||typeof window<"u"&&(f===window.setTimeout||f===window.alert||f===window.confirm||f===window.prompt)}},"./node_modules/is-obj/index.js":m=>{m.exports=function(M){var h=typeof M;return M!==null&&(h==="object"||h==="function")}},"./node_modules/layout-bmfont-text/index.js":(m,M,h)=>{var f=h("./node_modules/word-wrapper/index.js"),C=h("./node_modules/xtend/immutable.js"),p=h("./node_modules/as-number/index.js"),g=["x","e","a","o","n","s","r","c","u","m","v","w","z"],u=["m","w"],E=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],b=9,x=32,T=0,_=1,w=2;m.exports=function(de){return new S(de)};function S(pe){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(pe)}S.prototype.update=function(pe){if(pe=C({measure:this._measure},pe),this._opt=pe,this._opt.tabSize=p(this._opt.tabSize,4),!pe.font)throw new Error("must provide a valid bitmap font");var de=this.glyphs,se=pe.text||"",J=pe.font;this._setupSpaceGlyphs(J);var H=f.lines(se,pe),ae=pe.width||0;de.length=0;var ue=H.reduce(function(Vt,Yt){return Math.max(Vt,Yt.width,ae)},0),Me=0,De=0,Ge=p(pe.lineHeight,J.common.lineHeight),Xe=J.common.base,Je=Ge-Xe,pt=pe.letterSpacing||0,yt=Ge*H.length-Je,Gt=oe(this._opt.align);De-=yt,this._width=ue,this._height=yt,this._descender=Ge-Xe,this._baseline=Xe,this._xHeight=U(J),this._capHeight=j(J),this._lineHeight=Ge,this._ascender=Ge-Je-this._xHeight;var Et=this;H.forEach(function(Vt,Yt){for(var gi=Vt.start,Ri=Vt.end,Ni=Vt.width,Oi,yi=gi;yi<Ri;yi++){var zi=se.charCodeAt(yi),Cn=Et.getGlyph(J,zi);if(Cn){Oi&&(Me+=Y(J,Oi.id,Cn.id));var gn=Me;Gt===_?gn+=(ue-Ni)/2:Gt===w&&(gn+=ue-Ni),de.push({position:[gn,De],data:Cn,index:yi,line:Yt}),Me+=Cn.xadvance+pt,Oi=Cn}}De+=Ge,Me=0}),this._linesTotal=H.length},S.prototype._setupSpaceGlyphs=function(pe){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!pe.chars||pe.chars.length===0)){var de=D(pe,x)||F(pe)||pe.chars[0],se=this._opt.tabSize*de.xadvance;this._fallbackSpaceGlyph=de,this._fallbackTabGlyph=C(de,{x:0,y:0,xadvance:se,id:b,xoffset:0,yoffset:0,width:0,height:0})}},S.prototype.getGlyph=function(pe,de){var se=D(pe,de);return se||(de===b?this._fallbackTabGlyph:de===x?this._fallbackSpaceGlyph:null)},S.prototype.computeMetrics=function(pe,de,se,J){var H=this._opt.letterSpacing||0,ae=this._opt.font,ue=0,Me=0,De=0,Ge,Xe;if(!ae.chars||ae.chars.length===0)return{start:de,end:de,width:0};se=Math.min(pe.length,se);for(var Je=de;Je<se;Je++){var pt=pe.charCodeAt(Je),Ge=this.getGlyph(ae,pt);if(Ge){Ge.xoffset;var yt=Xe?Y(ae,Xe.id,Ge.id):0;ue+=yt;var Gt=ue+Ge.xadvance+H,Et=ue+Ge.width;if(Et>=J||Gt>=J)break;ue=Gt,Me=Et,Xe=Ge}De++}return Xe&&(Me+=Xe.xoffset),{start:de,end:de+De,width:Me}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(L);function L(pe){Object.defineProperty(S.prototype,pe,{get:P(pe),configurable:!0})}function P(pe){return new Function(["return function "+pe+"() {","  return this._"+pe,"}"].join(`
`))()}function D(pe,de){if(!pe.chars||pe.chars.length===0)return null;var se=te(pe.chars,de);return se>=0?pe.chars[se]:null}function U(pe){for(var de=0;de<g.length;de++){var se=g[de].charCodeAt(0),J=te(pe.chars,se);if(J>=0)return pe.chars[J].height}return 0}function F(pe){for(var de=0;de<u.length;de++){var se=u[de].charCodeAt(0),J=te(pe.chars,se);if(J>=0)return pe.chars[J]}return 0}function j(pe){for(var de=0;de<E.length;de++){var se=E[de].charCodeAt(0),J=te(pe.chars,se);if(J>=0)return pe.chars[J].height}return 0}function Y(pe,de,se){if(!pe.kernings||pe.kernings.length===0)return 0;for(var J=pe.kernings,H=0;H<J.length;H++){var ae=J[H];if(ae.first===de&&ae.second===se)return ae.amount}return 0}function oe(pe){return pe==="center"?_:pe==="right"?w:T}function te(pe,de,se){se=se||0;for(var J=se;J<pe.length;J++)if(pe[J].id===de)return J;return-1}},"./node_modules/load-bmfont/browser.js":(m,M,h)=>{var f=h("./node_modules/buffer/index.js").Buffer,C=h("./node_modules/xhr/index.js"),p=function(){},g=h("./node_modules/parse-bmfont-ascii/index.js"),u=h("./node_modules/parse-bmfont-xml/lib/browser.js"),E=h("./node_modules/parse-bmfont-binary/index.js"),b=h("./node_modules/load-bmfont/lib/is-binary.js"),x=h("./node_modules/xtend/immutable.js"),T=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();m.exports=function(S,L){L=typeof L=="function"?L:p,typeof S=="string"?S={uri:S}:S||(S={});var P=S.binary;P&&(S=w(S)),C(S,function(D,U,F){if(D)return L(D);if(!/^2/.test(U.statusCode))return L(new Error("http status code: "+U.statusCode));if(!F)return L(new Error("no body result"));var j=!1;if(_(F)){var Y=new Uint8Array(F);F=f.from(Y,"binary")}b(F)&&(j=!0,typeof F=="string"&&(F=f.from(F,"binary"))),j||(f.isBuffer(F)&&(F=F.toString(S.encoding)),F=F.trim());var oe;try{var te=U.headers["content-type"];j?oe=E(F):/json/.test(te)||F.charAt(0)==="{"?oe=JSON.parse(F):/xml/.test(te)||F.charAt(0)==="<"?oe=u(F):oe=g(F)}catch(pe){L(new Error("error parsing font "+pe.message)),L=p}L(null,oe)})};function _(S){var L=Object.prototype.toString;return L.call(S)==="[object ArrayBuffer]"}function w(S){if(T)return x(S,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var L=new self.XMLHttpRequest;return L.overrideMimeType("text/plain; charset=x-user-defined"),x({xhr:L},S)}},"./node_modules/load-bmfont/lib/is-binary.js":(m,M,h)=>{var f=h("./node_modules/buffer/index.js").Buffer,C=h("./node_modules/buffer-equal/index.js"),p=f.from([66,77,70,3]);m.exports=function(g){return typeof g=="string"?g.substring(0,3)==="BMF":g.length>4&&C(g.slice(0,4),p)}},"./node_modules/ms/index.js":m=>{var M=1e3,h=M*60,f=h*60,C=f*24,p=C*7,g=C*365.25;m.exports=function(T,_){_=_||{};var w=typeof T;if(w==="string"&&T.length>0)return u(T);if(w==="number"&&isFinite(T))return _.long?b(T):E(T);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(T))};function u(T){if(T=String(T),!(T.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(T);if(_){var w=parseFloat(_[1]),S=(_[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return w*g;case"weeks":case"week":case"w":return w*p;case"days":case"day":case"d":return w*C;case"hours":case"hour":case"hrs":case"hr":case"h":return w*f;case"minutes":case"minute":case"mins":case"min":case"m":return w*h;case"seconds":case"second":case"secs":case"sec":case"s":return w*M;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}function E(T){var _=Math.abs(T);return _>=C?Math.round(T/C)+"d":_>=f?Math.round(T/f)+"h":_>=h?Math.round(T/h)+"m":_>=M?Math.round(T/M)+"s":T+"ms"}function b(T){var _=Math.abs(T);return _>=C?x(T,_,C,"day"):_>=f?x(T,_,f,"hour"):_>=h?x(T,_,h,"minute"):_>=M?x(T,_,M,"second"):T+" ms"}function x(T,_,w,S){var L=_>=w*1.5;return Math.round(T/w)+" "+S+(L?"s":"")}},"./node_modules/parse-bmfont-ascii/index.js":m=>{m.exports=function(p){if(!p)throw new Error("no data provided");p=p.toString().trim();var g={pages:[],chars:[],kernings:[]},u=p.split(/\r\n?|\n/g);if(u.length===0)throw new Error("no data in BMFont file");for(var E=0;E<u.length;E++){var b=M(u[E],E);if(b)if(b.key==="page"){if(typeof b.data.id!="number")throw new Error("malformed file at line "+E+" -- needs page id=N");if(typeof b.data.file!="string")throw new Error("malformed file at line "+E+' -- needs page file="path"');g.pages[b.data.id]=b.data.file}else b.key==="chars"||b.key==="kernings"||(b.key==="char"?g.chars.push(b.data):b.key==="kerning"?g.kernings.push(b.data):g[b.key]=b.data)}return g};function M(C,p){if(C=C.replace(/\t+/g," ").trim(),!C)return null;var g=C.indexOf(" ");if(g===-1)throw new Error("no named row at line "+p);var u=C.substring(0,g);C=C.substring(g+1),C=C.replace(/letter=[\'\"]\S+[\'\"]/gi,""),C=C.split("="),C=C.map(function(_){return _.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var E=[],b=0;b<C.length;b++){var x=C[b];b===0?E.push({key:x[0],data:""}):b===C.length-1?E[E.length-1].data=h(x[0]):(E[E.length-1].data=h(x[0]),E.push({key:x[1],data:""}))}var T={key:u,data:{}};return E.forEach(function(_){T.data[_.key]=_.data}),T}function h(C){return!C||C.length===0?"":C.indexOf('"')===0||C.indexOf("'")===0?C.substring(1,C.length-1):C.indexOf(",")!==-1?f(C):parseInt(C,10)}function f(C){return C.split(",").map(function(p){return parseInt(p,10)})}},"./node_modules/parse-bmfont-binary/index.js":m=>{var M=[66,77,70];m.exports=function(T){if(T.length<6)throw new Error("invalid buffer length for BMFont");var _=M.every(function(D,U){return T.readUInt8(U)===D});if(!_)throw new Error("BMFont missing BMF byte header");var w=3,S=T.readUInt8(w++);if(S>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var L={kernings:[],chars:[]},P=0;P<5;P++)w+=h(L,T,w);return L};function h(x,T,_){if(_>T.length-1)return 0;var w=T.readUInt8(_++),S=T.readInt32LE(_);switch(_+=4,w){case 1:x.info=f(T,_);break;case 2:x.common=C(T,_);break;case 3:x.pages=p(T,_,S);break;case 4:x.chars=g(T,_,S);break;case 5:x.kernings=u(T,_,S);break}return 5+S}function f(x,T){var _={};_.size=x.readInt16LE(T);var w=x.readUInt8(T+2);return _.smooth=w>>7&1,_.unicode=w>>6&1,_.italic=w>>5&1,_.bold=w>>4&1,w>>3&1&&(_.fixedHeight=1),_.charset=x.readUInt8(T+3)||"",_.stretchH=x.readUInt16LE(T+4),_.aa=x.readUInt8(T+6),_.padding=[x.readInt8(T+7),x.readInt8(T+8),x.readInt8(T+9),x.readInt8(T+10)],_.spacing=[x.readInt8(T+11),x.readInt8(T+12)],_.outline=x.readUInt8(T+13),_.face=b(x,T+14),_}function C(x,T){var _={};return _.lineHeight=x.readUInt16LE(T),_.base=x.readUInt16LE(T+2),_.scaleW=x.readUInt16LE(T+4),_.scaleH=x.readUInt16LE(T+6),_.pages=x.readUInt16LE(T+8),x.readUInt8(T+10),_.packed=0,_.alphaChnl=x.readUInt8(T+11),_.redChnl=x.readUInt8(T+12),_.greenChnl=x.readUInt8(T+13),_.blueChnl=x.readUInt8(T+14),_}function p(x,T,_){for(var w=[],S=E(x,T),L=S.length+1,P=_/L,D=0;D<P;D++)w[D]=x.slice(T,T+S.length).toString("utf8"),T+=L;return w}function g(x,T,_){for(var w=[],S=_/20,L=0;L<S;L++){var P={},D=L*20;P.id=x.readUInt32LE(T+0+D),P.x=x.readUInt16LE(T+4+D),P.y=x.readUInt16LE(T+6+D),P.width=x.readUInt16LE(T+8+D),P.height=x.readUInt16LE(T+10+D),P.xoffset=x.readInt16LE(T+12+D),P.yoffset=x.readInt16LE(T+14+D),P.xadvance=x.readInt16LE(T+16+D),P.page=x.readUInt8(T+18+D),P.chnl=x.readUInt8(T+19+D),w[L]=P}return w}function u(x,T,_){for(var w=[],S=_/10,L=0;L<S;L++){var P={},D=L*10;P.first=x.readUInt32LE(T+0+D),P.second=x.readUInt32LE(T+4+D),P.amount=x.readInt16LE(T+8+D),w[L]=P}return w}function E(x,T){for(var _=T;_<x.length&&x[_]!==0;_++);return x.slice(T,_)}function b(x,T){return E(x,T).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(m,M,h)=>{var f=h("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),C=h("./node_modules/xml-parse-from-string/index.js"),p={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};m.exports=function(x){x=x.toString();var T=C(x),_={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(F){var j=T.getElementsByTagName(F)[0];j&&(_[F]=f(g(j)))});var w=T.getElementsByTagName("pages")[0];if(!w)throw new Error("malformed file -- no <pages> element");for(var S=w.getElementsByTagName("page"),L=0;L<S.length;L++){var P=S[L],D=parseInt(P.getAttribute("id"),10),U=P.getAttribute("file");if(isNaN(D))throw new Error('malformed file -- page "id" attribute is NaN');if(!U)throw new Error('malformed file -- needs page "file" attribute');_.pages[parseInt(D,10)]=U}return["chars","kernings"].forEach(function(F){var j=T.getElementsByTagName(F)[0];if(j)for(var Y=F.substring(0,F.length-1),oe=j.getElementsByTagName(Y),te=0;te<oe.length;te++){var pe=oe[te];_[F].push(f(g(pe)))}}),_};function g(b){var x=u(b);return x.reduce(function(T,_){var w=E(_.nodeName);return T[w]=_.nodeValue,T},{})}function u(b){for(var x=[],T=0;T<b.attributes.length;T++)x.push(b.attributes[T]);return x}function E(b){return p[b.toLowerCase()]||b}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":m=>{var M="chasrset";m.exports=function(C){M in C&&(C.charset=C[M],delete C[M]);for(var p in C)p==="face"||p==="charset"||(p==="padding"||p==="spacing"?C[p]=h(C[p]):C[p]=parseInt(C[p],10));return C};function h(f){return f.split(",").map(function(C){return parseInt(C,10)})}},"./node_modules/parse-headers/parse-headers.js":m=>{var M=function(f){return f.replace(/^\s+|\s+$/g,"")},h=function(f){return Object.prototype.toString.call(f)==="[object Array]"};m.exports=function(f){if(!f)return{};for(var C={},p=M(f).split(`
`),g=0;g<p.length;g++){var u=p[g],E=u.indexOf(":"),b=M(u.slice(0,E)).toLowerCase(),x=M(u.slice(E+1));typeof C[b]>"u"?C[b]=x:h(C[b])?C[b].push(x):C[b]=[C[b],x]}return C}},"./node_modules/quad-indices/index.js":(m,M,h)=>{var f=h("./node_modules/dtype/index.js"),C=h("./node_modules/an-array/index.js"),p=h("./node_modules/is-buffer/index.js"),g=[0,2,3],u=[2,1,3];m.exports=function(b,x){(!b||!(C(b)||p(b)))&&(x=b||{},b=null),typeof x=="number"?x={count:x}:x=x||{};for(var T=typeof x.type=="string"?x.type:"uint16",_=typeof x.count=="number"?x.count:1,w=x.start||0,S=x.clockwise!==!1?g:u,L=S[0],P=S[1],D=S[2],U=_*6,F=b||new(f(T))(U),j=0,Y=0;j<U;j+=6,Y+=4){var oe=j+w;F[oe+0]=Y+0,F[oe+1]=Y+1,F[oe+2]=Y+2,F[oe+3]=Y+L,F[oe+4]=Y+P,F[oe+5]=Y+D}return F}},"./node_modules/super-animejs/lib/anime.es.js":(m,M,h)=>{h.r(M),h.d(M,{default:()=>Fs});var f={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},C={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},p=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],g={CSS:{},springs:{}};function u(we,Ne,Ye){return Math.min(Math.max(we,Ne),Ye)}function E(we,Ne){return we.indexOf(Ne)>-1}function b(we,Ne){return we.apply(null,Ne)}var x=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,T=/^rgb/,_=/^hsl/,w={arr:function(we){return Array.isArray(we)},obj:function(we){return E(Object.prototype.toString.call(we),"Object")},pth:function(we){return w.obj(we)&&we.hasOwnProperty("totalLength")},svg:function(we){return we instanceof SVGElement},inp:function(we){return we instanceof HTMLInputElement},dom:function(we){return we.nodeType||w.svg(we)},str:function(we){return typeof we=="string"},fnc:function(we){return typeof we=="function"},und:function(we){return typeof we>"u"},hex:function(we){return x.test(we)},rgb:function(we){return T.test(we)},hsl:function(we){return _.test(we)},col:function(we){return w.hex(we)||w.rgb(we)||w.hsl(we)},key:function(we){return!f.hasOwnProperty(we)&&!C.hasOwnProperty(we)&&we!=="targets"&&we!=="keyframes"}},S=/\(([^)]+)\)/;function L(we){var Ne=S.exec(we);return Ne?Ne[1].split(",").map(function(Ye){return parseFloat(Ye)}):[]}function P(we,Ne){var Ye=L(we),ht=u(w.und(Ye[0])?1:Ye[0],.1,100),nt=u(w.und(Ye[1])?100:Ye[1],.1,100),At=u(w.und(Ye[2])?10:Ye[2],.1,100),Bt=u(w.und(Ye[3])?0:Ye[3],.1,100),oi=Math.sqrt(nt/ht),qt=At/(2*Math.sqrt(nt*ht)),mt=qt<1?oi*Math.sqrt(1-qt*qt):0,pi=1,Ai=qt<1?(qt*oi+-Bt)/mt:-Bt+oi;function Li(Ki){var ki=Ne?Ne*Ki/1e3:Ki;return qt<1?ki=Math.exp(-ki*qt*oi)*(pi*Math.cos(mt*ki)+Ai*Math.sin(mt*ki)):ki=(pi+Ai*ki)*Math.exp(-ki*oi),Ki===0||Ki===1?Ki:1-ki}function Mn(){var Ki=g.springs[we];if(Ki)return Ki;for(var ki=1/6,sn=0,Gn=0;;)if(sn+=ki,Li(sn)===1){if(Gn++,Gn>=16)break}else Gn=0;var cr=sn*ki*1e3;return g.springs[we]=cr,cr}return Ne?Li:Mn}function D(we,Ne){we===void 0&&(we=1),Ne===void 0&&(Ne=.5);var Ye=u(we,1,10),ht=u(Ne,.1,2);return function(nt){return nt===0||nt===1?nt:-Ye*Math.pow(2,10*(nt-1))*Math.sin((nt-1-ht/(Math.PI*2)*Math.asin(1/Ye))*(Math.PI*2)/ht)}}function U(we){return we===void 0&&(we=10),function(Ne){return Math.round(Ne*we)*(1/we)}}var F=function(){var we=11,Ne=1/(we-1);function Ye(pi,Ai){return 1-3*Ai+3*pi}function ht(pi,Ai){return 3*Ai-6*pi}function nt(pi){return 3*pi}function At(pi,Ai,Li){return((Ye(Ai,Li)*pi+ht(Ai,Li))*pi+nt(Ai))*pi}function Bt(pi,Ai,Li){return 3*Ye(Ai,Li)*pi*pi+2*ht(Ai,Li)*pi+nt(Ai)}function oi(pi,Ai,Li,Mn,Ki){var ki,sn,Gn=0;do sn=Ai+(Li-Ai)/2,ki=At(sn,Mn,Ki)-pi,ki>0?Li=sn:Ai=sn;while(Math.abs(ki)>1e-7&&++Gn<10);return sn}function qt(pi,Ai,Li,Mn){for(var Ki=0;Ki<4;++Ki){var ki=Bt(Ai,Li,Mn);if(ki===0)return Ai;var sn=At(Ai,Li,Mn)-pi;Ai-=sn/ki}return Ai}function mt(pi,Ai,Li,Mn){if(!(0<=pi&&pi<=1&&0<=Li&&Li<=1))return;var Ki=new Float32Array(we);if(pi!==Ai||Li!==Mn)for(var ki=0;ki<we;++ki)Ki[ki]=At(ki*Ne,pi,Li);function sn(Gn){for(var cr=0,Nt=1,Xi=we-1;Nt!==Xi&&Ki[Nt]<=Gn;++Nt)cr+=Ne;--Nt;var Zn=(Gn-Ki[Nt])/(Ki[Nt+1]-Ki[Nt]),hn=cr+Zn*Ne,W=Bt(hn,pi,Li);return W>=.001?qt(Gn,hn,pi,Li):W===0?hn:oi(Gn,cr,cr+Ne,pi,Li)}return function(Gn){return pi===Ai&&Li===Mn||Gn===0||Gn===1?Gn:At(sn(Gn),Ai,Mn)}}return mt}(),j=function(){var we=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],Ne={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],D],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(Bt,oi){return function(qt){return 1-D(Bt,oi)(1-qt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(Bt,oi){return function(qt){return qt<.5?D(Bt,oi)(qt*2)/2:1-D(Bt,oi)(qt*-2+2)/2}}]},Ye={linear:[.25,.25,.75,.75]};for(var ht in Ne)for(var nt=0,At=Ne[ht].length;nt<At;nt++)Ye["ease"+ht+we[nt]]=Ne[ht][nt];return Ye}();function Y(we,Ne){if(w.fnc(we))return we;var Ye=we.split("(")[0],ht=j[Ye],nt=L(we);switch(Ye){case"spring":return P(we,Ne);case"cubicBezier":return b(F,nt);case"steps":return b(U,nt);default:return w.fnc(ht)?b(ht,nt):b(F,ht)}}function oe(we){try{var Ne=document.querySelectorAll(we);return Ne}catch{return}}var te=[];function pe(we,Ne){for(var Ye=te,ht=we.length,nt=arguments.length>=2?arguments[1]:void 0,At=0;At<ht;At++)if(At in we){var Bt=we[At];Ne.call(nt,Bt,At,we)&&Ye.push(Bt)}return te=we,te.length=0,Ye}function de(we,Ne){Ne||(Ne=[]);for(var Ye=0,ht=we.length;Ye<ht;Ye++){var nt=we[Ye];Array.isArray(nt)?de(nt,Ne):Ne.push(nt)}return Ne}function se(we){return w.arr(we)?we:(w.str(we)&&(we=oe(we)||we),we instanceof NodeList||we instanceof HTMLCollection?[].slice.call(we):[we])}function J(we,Ne){return we.some(function(Ye){return Ye===Ne})}function H(we){var Ne={};for(var Ye in we)Ne[Ye]=we[Ye];return Ne}function ae(we,Ne){var Ye=H(we);for(var ht in we)Ye[ht]=Ne.hasOwnProperty(ht)?Ne[ht]:we[ht];return Ye}function ue(we,Ne){var Ye=H(we);for(var ht in Ne)Ye[ht]=w.und(we[ht])?Ne[ht]:we[ht];return Ye}var Me=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function De(we){var Ne=Me.exec(we);return Ne?"rgba("+Ne[1]+",1)":we}var Ge=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Xe=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function Je(we){var Ne=we.replace(Ge,function(Bt,oi,qt,mt){return oi+oi+qt+qt+mt+mt}),Ye=Xe.exec(Ne),ht=parseInt(Ye[1],16),nt=parseInt(Ye[2],16),At=parseInt(Ye[3],16);return"rgba("+ht+","+nt+","+At+",1)"}var pt=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,yt=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Gt(we){var Ne=pt.exec(we)||yt.exec(we),Ye=parseInt(Ne[1],10)/360,ht=parseInt(Ne[2],10)/100,nt=parseInt(Ne[3],10)/100,At=Ne[4]||1;function Bt(Li,Mn,Ki){return Ki<0&&(Ki+=1),Ki>1&&(Ki-=1),Ki<.16666666666666666?Li+(Mn-Li)*6*Ki:Ki<.5?Mn:Ki<.6666666666666666?Li+(Mn-Li)*(.6666666666666666-Ki)*6:Li}var oi,qt,mt;if(ht==0)oi=qt=mt=nt;else{var pi=nt<.5?nt*(1+ht):nt+ht-nt*ht,Ai=2*nt-pi;oi=Bt(Ai,pi,Ye+.3333333333333333),qt=Bt(Ai,pi,Ye),mt=Bt(Ai,pi,Ye-.3333333333333333)}return"rgba("+oi*255+","+qt*255+","+mt*255+","+At+")"}function Et(we){if(w.rgb(we))return De(we);if(w.hex(we))return Je(we);if(w.hsl(we))return Gt(we)}var Vt=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function Yt(we){var Ne=Vt.exec(we);if(Ne)return Ne[2]}function gi(we){if(E(we,"translate")||we==="perspective")return"px";if(E(we,"rotate")||E(we,"skew"))return"deg"}function Ri(we,Ne){return w.fnc(we)?we(Ne.target,Ne.id,Ne.total):we}function Ni(we,Ne){return we.getAttribute(Ne)}function Oi(we,Ne,Ye){var ht=Yt(Ne);if(J([Ye,"deg","rad","turn"],ht))return Ne;var nt=g.CSS[Ne+Ye];if(!w.und(nt))return nt;var At=100,Bt=document.createElement(we.tagName),oi=we.parentNode&&we.parentNode!==document?we.parentNode:document.body;oi.appendChild(Bt),Bt.style.position="absolute",Bt.style.width=At+Ye;var qt=At/Bt.offsetWidth;oi.removeChild(Bt);var mt=qt*parseFloat(Ne);return g.CSS[Ne+Ye]=mt,mt}function yi(we,Ne,Ye){if(Ne in we.style){var ht=Ne.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),nt=we.style[Ne]||getComputedStyle(we).getPropertyValue(ht)||"0";return Ye?Oi(we,nt,Ye):nt}}function zi(we,Ne){if(w.dom(we)&&!w.inp(we)&&(Ni(we,Ne)||w.svg(we)&&we[Ne]))return"attribute";if(w.dom(we)&&J(p,Ne))return"transform";if(w.dom(we)&&Ne!=="transform"&&yi(we,Ne))return"css";if(we[Ne]!=null)return"object"}var Cn=/(\w+)\(([^)]*)\)/g;function gn(we){if(w.dom(we)){for(var Ne=we.style.transform||"",Ye=new Map,ht;ht=Cn.exec(Ne);)Ye.set(ht[1],ht[2]);return Ye}}function rr(we,Ne,Ye,ht){var nt=E(Ne,"scale")?1:0+gi(Ne),At=gn(we).get(Ne)||nt;return Ye&&(Ye.transforms.list.set(Ne,At),Ye.transforms.last=Ne),ht?Oi(we,At,ht):At}function bn(we,Ne,Ye,ht){switch(zi(we,Ne)){case"transform":return rr(we,Ne,ht,Ye);case"css":return yi(we,Ne,Ye);case"attribute":return Ni(we,Ne);default:return we[Ne]||0}}var cn=/^(\*=|\+=|-=)/;function Kn(we,Ne){var Ye=cn.exec(we);if(!Ye)return we;var ht=Yt(we)||0,nt=parseFloat(Ne),At=parseFloat(we.replace(Ye[0],""));switch(Ye[0][0]){case"+":return nt+At+ht;case"-":return nt-At+ht;case"*":return nt*At+ht}}var wn=/\s/g;function Cr(we,Ne){if(w.col(we))return Et(we);var Ye=Yt(we),ht=Ye?we.substr(0,we.length-Ye.length):we;return Ne&&!wn.test(we)?ht+Ne:ht}function ar(we,Ne){return Math.sqrt(Math.pow(Ne.x-we.x,2)+Math.pow(Ne.y-we.y,2))}function Tn(we){return Math.PI*2*Ni(we,"r")}function St(we){return Ni(we,"width")*2+Ni(we,"height")*2}function ye(we){return ar({x:Ni(we,"x1"),y:Ni(we,"y1")},{x:Ni(we,"x2"),y:Ni(we,"y2")})}function ve(we){for(var Ne=we.points,Ye=0,ht,nt=0;nt<Ne.numberOfItems;nt++){var At=Ne.getItem(nt);nt>0&&(Ye+=ar(ht,At)),ht=At}return Ye}function Le(we){var Ne=we.points;return ve(we)+ar(Ne.getItem(Ne.numberOfItems-1),Ne.getItem(0))}function Se(we){if(we.getTotalLength)return we.getTotalLength();switch(we.tagName.toLowerCase()){case"circle":return Tn(we);case"rect":return St(we);case"line":return ye(we);case"polyline":return ve(we);case"polygon":return Le(we)}}function Re(we){var Ne=Se(we);return we.setAttribute("stroke-dasharray",Ne),Ne}function Pe(we){for(var Ne=we.parentNode;w.svg(Ne)&&(Ne=Ne.parentNode,!!w.svg(Ne.parentNode)););return Ne}function $(we,Ne){var Ye=Ne||{},ht=Ye.el||Pe(we),nt=ht.getBoundingClientRect(),At=Ni(ht,"viewBox"),Bt=nt.width,oi=nt.height,qt=Ye.viewBox||(At?At.split(" "):[0,0,Bt,oi]);return{el:ht,viewBox:qt,x:qt[0]/1,y:qt[1]/1,w:Bt/qt[2],h:oi/qt[3]}}function N(we,Ne){var Ye=w.str(we)?oe(we)[0]:we,ht=Ne||100;return function(nt){return{property:nt,el:Ye,svg:$(Ye),totalLength:Se(Ye)*(ht/100)}}}function V(we,Ne){function Ye(oi){oi===void 0&&(oi=0);var qt=Ne+oi>=1?Ne+oi:0;return we.el.getPointAtLength(qt)}var ht=$(we.el,we.svg),nt=Ye(),At=Ye(-1),Bt=Ye(1);switch(we.property){case"x":return(nt.x-ht.x)*ht.w;case"y":return(nt.y-ht.y)*ht.h;case"angle":return Math.atan2(Bt.y-At.y,Bt.x-At.x)*180/Math.PI}}var fe=/-?\d*\.?\d+/g;function be(we,Ne){var Ye=Cr(w.pth(we)?we.totalLength:we,Ne)+"";return{original:Ye,numbers:Ye.match(fe)?Ye.match(fe).map(Number):[0],strings:w.str(we)||Ne?Ye.split(fe):[]}}function Fe(we){var Ne=we?de(w.arr(we)?we.map(se):se(we)):[];return pe(Ne,function(Ye,ht,nt){return nt.indexOf(Ye)===ht})}function We(we){var Ne=Fe(we);return Ne.map(function(Ye,ht){return{target:Ye,id:ht,total:Ne.length,transforms:{list:gn(Ye)}}})}var Rt=/^spring/;function zt(we,Ne){var Ye=H(Ne);if(Rt.test(Ye.easing)&&(Ye.duration=P(Ye.easing)),w.arr(we)){var ht=we.length,nt=ht===2&&!w.obj(we[0]);nt?we={value:we}:w.fnc(Ne.duration)||(Ye.duration=Ne.duration/ht)}var At=w.arr(we)?we:[we];return At.map(function(Bt,oi){var qt=w.obj(Bt)&&!w.pth(Bt)?Bt:{value:Bt};return w.und(qt.delay)&&(qt.delay=oi?0:Ne.delay),w.und(qt.endDelay)&&(qt.endDelay=oi===At.length-1?Ne.endDelay:0),qt}).map(function(Bt){return ue(Bt,Ye)})}function Lt(we){for(var Ne=pe(de(we.map(function(At){return Object.keys(At)})),function(At){return w.key(At)}).reduce(function(At,Bt){return At.indexOf(Bt)<0&&At.push(Bt),At},[]),Ye={},ht=function(At){var Bt=Ne[At];Ye[Bt]=we.map(function(oi){var qt={};for(var mt in oi)w.key(mt)?mt==Bt&&(qt.value=oi[mt]):qt[mt]=oi[mt];return qt})},nt=0;nt<Ne.length;nt++)ht(nt);return Ye}function Tt(we,Ne){var Ye=[],ht=Ne.keyframes;ht&&(Ne=ue(Lt(ht),Ne));for(var nt in Ne)w.key(nt)&&Ye.push({name:nt,tweens:zt(Ne[nt],we)});return Ye}function ti(we,Ne){var Ye={};for(var ht in we){var nt=Ri(we[ht],Ne);w.arr(nt)&&(nt=nt.map(function(At){return Ri(At,Ne)}),nt.length===1&&(nt=nt[0])),Ye[ht]=nt}return Ye.duration=parseFloat(Ye.duration),Ye.delay=parseFloat(Ye.delay),Ye}function Jn(we,Ne){var Ye;return we.tweens.map(function(ht){var nt=ti(ht,Ne),At=nt.value,Bt=w.arr(At)?At[1]:At,oi=Yt(Bt),qt=bn(Ne.target,we.name,oi,Ne),mt=Ye?Ye.to.original:qt,pi=w.arr(At)?At[0]:mt,Ai=Yt(pi)||Yt(qt),Li=oi||Ai;return w.und(Bt)&&(Bt=mt),nt.from=be(pi,Li),nt.to=be(Kn(Bt,pi),Li),nt.start=Ye?Ye.end:0,nt.end=nt.start+nt.delay+nt.duration+nt.endDelay,nt.easing=Y(nt.easing,nt.duration),nt.isPath=w.pth(At),nt.isColor=w.col(nt.from.original),nt.isColor&&(nt.round=1),Ye=nt,nt})}var wi={css:function(we,Ne,Ye){return we.style[Ne]=Ye},attribute:function(we,Ne,Ye){return we.setAttribute(Ne,Ye)},object:function(we,Ne,Ye){return we[Ne]=Ye},transform:function(we,Ne,Ye,ht,nt){if(ht.list.set(Ne,Ye),Ne===ht.last||nt){var At="";ht.list.forEach(function(Bt,oi){At+=oi+"("+Bt+") "}),we.style.transform=At}}};function Xn(we,Ne){for(var Ye=We(we),ht=0,nt=Ye.length;ht<nt;ht++){var At=Ye[ht];for(var Bt in Ne){var oi=Ri(Ne[Bt],At),qt=At.target,mt=Yt(oi),pi=bn(qt,Bt,mt,At),Ai=mt||Yt(pi),Li=Kn(Cr(oi,Ai),pi),Mn=zi(qt,Bt);wi[Mn](qt,Bt,Li,At.transforms,!0)}}}function mn(we,Ne){var Ye=zi(we.target,Ne.name);if(Ye){var ht=Jn(Ne,we),nt=ht[ht.length-1];return{type:Ye,property:Ne.name,animatable:we,tweens:ht,duration:nt.end,delay:ht[0].delay,endDelay:nt.endDelay}}}function In(we,Ne){return pe(de(we.map(function(Ye){return Ne.map(function(ht){return mn(Ye,ht)})})),function(Ye){return!w.und(Ye)})}function Yr(we,Ne){var Ye=we.length,ht=function(At){return At.timelineOffset?At.timelineOffset:0},nt={};return nt.duration=Ye?Math.max.apply(Math,we.map(function(At){return ht(At)+At.duration})):Ne.duration,nt.delay=Ye?Math.min.apply(Math,we.map(function(At){return ht(At)+At.delay})):Ne.delay,nt.endDelay=Ye?nt.duration-Math.max.apply(Math,we.map(function(At){return ht(At)+At.duration-At.endDelay})):Ne.endDelay,nt}var Qn=0;function ms(we){var Ne=ae(f,we),Ye=ae(C,we),ht=Tt(Ye,we),nt=We(we.targets),At=In(nt,ht),Bt=Yr(At,Ye),oi=Qn;return Qn++,ue(Ne,{id:oi,children:[],animatables:nt,animations:At,duration:Bt.duration,delay:Bt.delay,endDelay:Bt.endDelay})}var sr=[],Qr=[],gs,Tr=function(){function we(){gs=requestAnimationFrame(Ne)}function Ne(Ye){var ht=sr.length;if(ht){for(var nt=0;nt<ht;){var At=sr[nt];if(!At.paused)At.tick(Ye);else{var Bt=sr.indexOf(At);Bt>-1&&(sr.splice(Bt,1),ht=sr.length)}nt++}we()}else gs=cancelAnimationFrame(gs)}return we}();function Yn(){if(document.hidden){for(var we=0,Ne=sr.length;we<Ne;we++)activeInstance[we].pause();Qr=sr.slice(0),sr=[]}else for(var Ye=0,ht=Qr.length;Ye<ht;Ye++)Qr[Ye].play()}document.addEventListener("visibilitychange",Yn);function Bn(we){we===void 0&&(we={});var Ne=0,Ye=0,ht=0,nt,At=0,Bt=null;function oi(){return window.Promise&&new Promise(function(Nt){return Bt=Nt})}var qt=oi(),mt=ms(we);function pi(){mt.reversed=!mt.reversed;for(var Nt=0,Xi=nt.length;Nt<Xi;Nt++)nt[Nt].reversed=mt.reversed}function Ai(Nt){return mt.reversed?mt.duration-Nt:Nt}function Li(){Ne=0,Ye=Ai(mt.currentTime)*(1/Bn.speed)}function Mn(Nt,Xi){Xi&&Xi.seek(Nt-Xi.timelineOffset)}function Ki(Nt){if(mt.reversePlayback)for(var Zn=At;Zn--;)Mn(Nt,nt[Zn]);else for(var Xi=0;Xi<At;Xi++)Mn(Nt,nt[Xi])}function ki(Nt){for(var Xi=0,Zn=mt.animations,hn=Zn.length;Xi<hn;){var W=Zn[Xi],Z=W.animatable,le=W.tweens,me=le.length-1,Ee=le[me];me&&(Ee=pe(le,function(Ei){return Nt<Ei.end})[0]||Ee);for(var He=u(Nt-Ee.start-Ee.delay,0,Ee.duration)/Ee.duration,q=isNaN(He)?1:Ee.easing(He),ie=Ee.to.strings,ce=Ee.round,ne=[],re=Ee.to.numbers.length,ke=void 0,Ze=0;Ze<re;Ze++){var st=void 0,dt=Ee.to.numbers[Ze],Ot=Ee.from.numbers[Ze]||0;Ee.isPath?st=V(Ee.value,q*dt):st=Ot+q*(dt-Ot),ce&&(Ee.isColor&&Ze>2||(st=Math.round(st*ce)/ce)),ne.push(st)}var ft=ie.length;if(!ft)ke=ne[0];else{ke=ie[0];for(var _t=0;_t<ft;_t++){ie[_t];var di=ie[_t+1],ni=ne[_t];isNaN(ni)||(di?ke+=ni+di:ke+=ni+" ")}}wi[W.type](Z.target,W.property,ke,Z.transforms),W.currentValue=ke,Xi++}}function sn(Nt){mt[Nt]&&!mt.passThrough&&mt[Nt](mt)}function Gn(){mt.remaining&&mt.remaining!==!0&&mt.remaining--}function cr(Nt){var Xi=mt.duration,Zn=mt.delay,hn=Xi-mt.endDelay,W=Ai(Nt);mt.progress=u(W/Xi*100,0,100),mt.reversePlayback=W<mt.currentTime,nt&&Ki(W),!mt.began&&mt.currentTime>0&&(mt.began=!0,sn("begin"),sn("loopBegin")),W<=Zn&&mt.currentTime!==0&&ki(0),(W>=hn&&mt.currentTime!==Xi||!Xi)&&ki(Xi),W>Zn&&W<hn?(mt.changeBegan||(mt.changeBegan=!0,mt.changeCompleted=!1,sn("changeBegin")),sn("change"),ki(W)):mt.changeBegan&&(mt.changeCompleted=!0,mt.changeBegan=!1,sn("changeComplete")),mt.currentTime=u(W,0,Xi),mt.began&&sn("update"),Nt>=Xi&&(Ye=0,Gn(),mt.remaining?(Ne=ht,sn("loopComplete"),sn("loopBegin"),mt.direction==="alternate"&&pi()):(mt.paused=!0,mt.completed||(mt.completed=!0,sn("loopComplete"),sn("complete"),"Promise"in window&&(Bt(),qt=oi()))))}return mt.reset=function(){var Nt=mt.direction;mt.passThrough=!1,mt.currentTime=0,mt.progress=0,mt.paused=!0,mt.began=!1,mt.changeBegan=!1,mt.completed=!1,mt.changeCompleted=!1,mt.reversePlayback=!1,mt.reversed=Nt==="reverse",mt.remaining=mt.loop,nt=mt.children,At=nt.length;for(var Xi=At;Xi--;)mt.children[Xi].reset();(mt.reversed&&mt.loop!==!0||Nt==="alternate"&&mt.loop===1)&&mt.remaining++,ki(0)},mt.set=function(Nt,Xi){return Xn(Nt,Xi),mt},mt.tick=function(Nt){ht=Nt,Ne||(Ne=ht),cr((ht+(Ye-Ne))*Bn.speed)},mt.seek=function(Nt){cr(Ai(Nt))},mt.pause=function(){mt.paused=!0,Li()},mt.play=function(){mt.paused&&(mt.paused=!1,sr.push(mt),Li(),gs||Tr())},mt.reverse=function(){pi(),Li()},mt.restart=function(){mt.reset(),mt.play()},mt.finished=qt,mt.reset(),mt.autoplay&&mt.play(),mt}function lr(we,Ne){for(var Ye=Ne.length;Ye--;)J(we,Ne[Ye].animatable.target)&&Ne.splice(Ye,1)}function Hs(we){for(var Ne=Fe(we),Ye=sr.length;Ye--;){var ht=sr[Ye],nt=ht.animations,At=ht.children;lr(Ne,nt);for(var Bt=At.length;Bt--;){var oi=At[Bt],qt=oi.animations;lr(Ne,qt),!qt.length&&!oi.children.length&&At.splice(Bt,1)}!nt.length&&!At.length&&ht.pause()}}function ss(we,Ne){Ne===void 0&&(Ne={});var Ye=Ne.direction||"normal",ht=Ne.easing?Y(Ne.easing):null,nt=Ne.grid,At=Ne.axis,Bt=Ne.from||0,oi=Bt==="first",qt=Bt==="center",mt=Bt==="last",pi=w.arr(we),Ai=parseFloat(pi?we[0]:we),Li=pi?parseFloat(we[1]):0,Mn=Yt(pi?we[1]:we)||0,Ki=Ne.start||0+(pi?Ai:0),ki=[],sn=0;return function(Gn,cr,Nt){if(oi&&(Bt=0),qt&&(Bt=(Nt-1)/2),mt&&(Bt=Nt-1),!ki.length){for(var Xi=0;Xi<Nt;Xi++){if(!nt)ki.push(Math.abs(Bt-Xi));else{var Zn=qt?(nt[0]-1)/2:Bt%nt[0],hn=qt?(nt[1]-1)/2:Math.floor(Bt/nt[0]),W=Xi%nt[0],Z=Math.floor(Xi/nt[0]),le=Zn-W,me=hn-Z,Ee=Math.sqrt(le*le+me*me);At==="x"&&(Ee=-le),At==="y"&&(Ee=-me),ki.push(Ee)}sn=Math.max.apply(Math,ki)}ht&&(ki=ki.map(function(q){return ht(q/sn)*sn})),Ye==="reverse"&&(ki=ki.map(function(q){return At?q<0?q*-1:-q:Math.abs(sn-q)}))}var He=pi?(Li-Ai)/sn:Ai;return Ki+He*(Math.round(ki[cr]*100)/100)+Mn}}function oo(we){we===void 0&&(we={});var Ne=Bn(we);return Ne.duration=0,Ne.add=function(Ye,ht){var nt=sr.indexOf(Ne),At=Ne.children;nt>-1&&sr.splice(nt,1);function Bt(Li){Li.passThrough=!0}for(var oi=0;oi<At.length;oi++)Bt(At[oi]);var qt=ue(Ye,ae(C,we));qt.targets=qt.targets||we.targets;var mt=Ne.duration;qt.autoplay=!1,qt.direction=Ne.direction,qt.timelineOffset=w.und(ht)?mt:Kn(ht,mt),Bt(Ne),Ne.seek(qt.timelineOffset);var pi=Bn(qt);Bt(pi),At.push(pi);var Ai=Yr(At,we);return Ne.delay=Ai.delay,Ne.endDelay=Ai.endDelay,Ne.duration=Ai.duration,Ne.seek(0),Ne.reset(),Ne.autoplay&&Ne.play(),Ne},Ne}Bn.version="3.0.0",Bn.speed=1,Bn.running=sr,Bn.remove=Hs,Bn.get=bn,Bn.set=Xn,Bn.convertPx=Oi,Bn.path=N,Bn.setDashoffset=Re,Bn.stagger=ss,Bn.timeline=oo,Bn.easing=Y,Bn.penner=j,Bn.random=function(we,Ne){return Math.floor(Math.random()*(Ne-we+1))+we};const Fs=Bn},"./node_modules/three-bmfont-text/index.js":(m,M,h)=>{var f=h("./node_modules/layout-bmfont-text/index.js"),C=h("./node_modules/quad-indices/index.js"),p=h("./node_modules/three-bmfont-text/lib/vertices.js"),g=h("./node_modules/three-bmfont-text/lib/utils.js");m.exports=function(b){return new u(b)};class u extends THREE.BufferGeometry{constructor(b){super(),typeof b=="string"&&(b={text:b}),this._opt=Object.assign({},b),b&&this.update(b)}update(b){if(typeof b=="string"&&(b={text:b}),b=Object.assign({},this._opt,b),!b.font)throw new TypeError("must specify a { font } in options");this.layout=f(b);var x=b.flipY!==!1,T=b.font,_=T.common.scaleW,w=T.common.scaleH,S=this.layout.glyphs.filter(function(F){var j=F.data;return j.width*j.height>0});this.visibleGlyphs=S;var L=p.positions(S),P=p.uvs(S,_,w,x),D=C([],{clockwise:!0,type:"uint16",count:S.length});if(this.setIndex(D),this.setAttribute("position",new THREE.BufferAttribute(L,2)),this.setAttribute("uv",new THREE.BufferAttribute(P,2)),!b.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(b.multipage){var U=p.pages(S);this.setAttribute("page",new THREE.BufferAttribute(U,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var b=this.attributes.position.array,x=this.attributes.position.itemSize;if(!b||!x||b.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}g.computeSphere(b,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var b=this.boundingBox,x=this.attributes.position.array,T=this.attributes.position.itemSize;if(!x||!T||x.length<2){b.makeEmpty();return}g.computeBox(x,b)}}},"./node_modules/three-bmfont-text/lib/utils.js":m=>{var M=2,h={min:[0,0],max:[0,0]};function f(C){var p=C.length/M;h.min[0]=C[0],h.min[1]=C[1],h.max[0]=C[0],h.max[1]=C[1];for(var g=0;g<p;g++){var u=C[g*M+0],E=C[g*M+1];h.min[0]=Math.min(u,h.min[0]),h.min[1]=Math.min(E,h.min[1]),h.max[0]=Math.max(u,h.max[0]),h.max[1]=Math.max(E,h.max[1])}}m.exports.computeBox=function(C,p){f(C),p.min.set(h.min[0],h.min[1],0),p.max.set(h.max[0],h.max[1],0)},m.exports.computeSphere=function(C,p){f(C);var g=h.min[0],u=h.min[1],E=h.max[0],b=h.max[1],x=E-g,T=b-u,_=Math.sqrt(x*x+T*T);p.center.set(g+x/2,u+T/2,0),p.radius=_/2}},"./node_modules/three-bmfont-text/lib/vertices.js":m=>{m.exports.pages=function(h){var f=new Float32Array(h.length*4*1),C=0;return h.forEach(function(p){var g=p.data.page||0;f[C++]=g,f[C++]=g,f[C++]=g,f[C++]=g}),f},m.exports.uvs=function(h,f,C,p){var g=new Float32Array(h.length*4*2),u=0;return h.forEach(function(E){var b=E.data,x=b.x+b.width,T=b.y+b.height,_=b.x/f,w=b.y/C,S=x/f,L=T/C;p&&(w=(C-b.y)/C,L=(C-T)/C),g[u++]=_,g[u++]=w,g[u++]=_,g[u++]=L,g[u++]=S,g[u++]=L,g[u++]=S,g[u++]=w}),g},m.exports.positions=function(h){var f=new Float32Array(h.length*4*2),C=0;return h.forEach(function(p){var g=p.data,u=p.position[0]+g.xoffset,E=p.position[1]+g.yoffset,b=g.width,x=g.height;f[C++]=u,f[C++]=E,f[C++]=u,f[C++]=E+x,f[C++]=u+b,f[C++]=E+x,f[C++]=u+b,f[C++]=E}),f}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(m,M,h){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(f,C){m.exports=C()})(this,function(){var f=typeof window<"u"?window:typeof h.g<"u"?h.g:typeof self<"u"?self:{};function C(D){return D&&D.__esModule&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D}function p(D,U){return U={exports:{}},D(U,U.exports),U.exports}var g=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},u=function(U,F){for(var j=0,Y=U.length;j<Y;j++)F[j]=U[j]},E=function(U,F){for(var j in F)F.hasOwnProperty(j)&&(U[j]=F[j]);return U},b=p(function(D,U){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(F,j){D.exports=j()})(f,function(){var F=function(W,Z){if(!(W instanceof Z))throw new TypeError("Cannot call a class as a function")},j=function(){function W(Z,le){for(var me=0;me<le.length;me++){var Ee=le[me];Ee.enumerable=Ee.enumerable||!1,Ee.configurable=!0,"value"in Ee&&(Ee.writable=!0),Object.defineProperty(Z,Ee.key,Ee)}}return function(Z,le,me){return le&&W(Z.prototype,le),me&&W(Z,me),Z}}(),Y=function(){function W(Z,le){var me=[],Ee=!0,He=!1,q=void 0;try{for(var ie=Z[Symbol.iterator](),ce;!(Ee=(ce=ie.next()).done)&&(me.push(ce.value),!(le&&me.length===le));Ee=!0);}catch(ne){He=!0,q=ne}finally{try{!Ee&&ie.return&&ie.return()}finally{if(He)throw q}}return me}return function(Z,le){if(Array.isArray(Z))return Z;if(Symbol.iterator in Object(Z))return W(Z,le);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),oe=.001,te=1,pe=function(Z,le){return"data:"+Z+","+encodeURIComponent(le)},de=function(Z,le,me){return Z+(le-Z)*me},se=function(){var W=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return W}}(),J=function(){var W=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return W}}(),H=function(){var W=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return W}}(),ae=function(){var W=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return W}}(),ue=function(){var W=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),Z=W?parseInt(W[1],10):null;return function(){return Z}}(),Me=function(){var W=!1;return W=se()&&H()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return W}}(),De=function(){var W=!1;if(ue()===65){var Z=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(Z){var le=Z[1].split("."),me=Y(le,4);me[0],me[1];var Ee=me[2],He=me[3];W=parseInt(Ee,10)===3325&&parseInt(He,10)<148}}return function(){return W}}(),Ge=function(){var W=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return W}}(),Xe=function(){var Z=window.orientation==90||window.orientation==-90;return Ge()?!Z:Z},Je=function(Z){return!(isNaN(Z)||Z<=oe||Z>te)},pt=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},yt=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Gt=function(Z){if(J())return!1;if(Z.requestFullscreen)Z.requestFullscreen();else if(Z.webkitRequestFullscreen)Z.webkitRequestFullscreen();else if(Z.mozRequestFullScreen)Z.mozRequestFullScreen();else if(Z.msRequestFullscreen)Z.msRequestFullscreen();else return!1;return!0},Et=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},Vt=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Yt=function(Z,le,me,Ee){var He=Z.createShader(Z.VERTEX_SHADER);Z.shaderSource(He,le),Z.compileShader(He);var q=Z.createShader(Z.FRAGMENT_SHADER);Z.shaderSource(q,me),Z.compileShader(q);var ie=Z.createProgram();Z.attachShader(ie,He),Z.attachShader(ie,q);for(var ce in Ee)Z.bindAttribLocation(ie,Ee[ce],ce);return Z.linkProgram(ie),Z.deleteShader(He),Z.deleteShader(q),ie},gi=function(Z,le){for(var me={},Ee=Z.getProgramParameter(le,Z.ACTIVE_UNIFORMS),He="",q=0;q<Ee;q++){var ie=Z.getActiveUniform(le,q);He=ie.name.replace("[0]",""),me[He]=Z.getUniformLocation(le,He)}return me},Ri=function(Z,le,me,Ee,He,q,ie){var ce=1/(le-me),ne=1/(Ee-He),re=1/(q-ie);return Z[0]=-2*ce,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,Z[5]=-2*ne,Z[6]=0,Z[7]=0,Z[8]=0,Z[9]=0,Z[10]=2*re,Z[11]=0,Z[12]=(le+me)*ce,Z[13]=(He+Ee)*ne,Z[14]=(ie+q)*re,Z[15]=1,Z},Ni=function(){var Z=!1;return function(le){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(le)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(le.substr(0,4)))&&(Z=!0)}(navigator.userAgent||navigator.vendor||window.opera),Z},Oi=function(Z,le){for(var me in le)le.hasOwnProperty(me)&&(Z[me]=le[me]);return Z},yi=function(Z){if(se()){var le=Z.style.width,me=Z.style.height;Z.style.width=parseInt(le)+1+"px",Z.style.height=parseInt(me)+"px",setTimeout(function(){Z.style.width=le,Z.style.height=me},100)}window.canvas=Z},zi=function(){var W=Math.PI/180,Z=Math.PI*.25;function le(ne,re,ke,Ze){var st=Math.tan(re?re.upDegrees*W:Z),dt=Math.tan(re?re.downDegrees*W:Z),Ot=Math.tan(re?re.leftDegrees*W:Z),ft=Math.tan(re?re.rightDegrees*W:Z),_t=2/(Ot+ft),di=2/(st+dt);return ne[0]=_t,ne[1]=0,ne[2]=0,ne[3]=0,ne[4]=0,ne[5]=di,ne[6]=0,ne[7]=0,ne[8]=-((Ot-ft)*_t*.5),ne[9]=(st-dt)*di*.5,ne[10]=Ze/(ke-Ze),ne[11]=-1,ne[12]=0,ne[13]=0,ne[14]=Ze*ke/(ke-Ze),ne[15]=0,ne}function me(ne,re,ke){var Ze=re[0],st=re[1],dt=re[2],Ot=re[3],ft=Ze+Ze,_t=st+st,di=dt+dt,ni=Ze*ft,Ei=Ze*_t,Xt=Ze*di,_i=st*_t,Ti=st*di,Pi=dt*di,Hi=Ot*ft,Ji=Ot*_t,Bi=Ot*di;return ne[0]=1-(_i+Pi),ne[1]=Ei+Bi,ne[2]=Xt-Ji,ne[3]=0,ne[4]=Ei-Bi,ne[5]=1-(ni+Pi),ne[6]=Ti+Hi,ne[7]=0,ne[8]=Xt+Ji,ne[9]=Ti-Hi,ne[10]=1-(ni+_i),ne[11]=0,ne[12]=ke[0],ne[13]=ke[1],ne[14]=ke[2],ne[15]=1,ne}function Ee(ne,re,ke){var Ze=ke[0],st=ke[1],dt=ke[2],Ot,ft,_t,di,ni,Ei,Xt,_i,Ti,Pi,Hi,Ji;return re===ne?(ne[12]=re[0]*Ze+re[4]*st+re[8]*dt+re[12],ne[13]=re[1]*Ze+re[5]*st+re[9]*dt+re[13],ne[14]=re[2]*Ze+re[6]*st+re[10]*dt+re[14],ne[15]=re[3]*Ze+re[7]*st+re[11]*dt+re[15]):(Ot=re[0],ft=re[1],_t=re[2],di=re[3],ni=re[4],Ei=re[5],Xt=re[6],_i=re[7],Ti=re[8],Pi=re[9],Hi=re[10],Ji=re[11],ne[0]=Ot,ne[1]=ft,ne[2]=_t,ne[3]=di,ne[4]=ni,ne[5]=Ei,ne[6]=Xt,ne[7]=_i,ne[8]=Ti,ne[9]=Pi,ne[10]=Hi,ne[11]=Ji,ne[12]=Ot*Ze+ni*st+Ti*dt+re[12],ne[13]=ft*Ze+Ei*st+Pi*dt+re[13],ne[14]=_t*Ze+Xt*st+Hi*dt+re[14],ne[15]=di*Ze+_i*st+Ji*dt+re[15]),ne}function He(ne,re){var ke=re[0],Ze=re[1],st=re[2],dt=re[3],Ot=re[4],ft=re[5],_t=re[6],di=re[7],ni=re[8],Ei=re[9],Xt=re[10],_i=re[11],Ti=re[12],Pi=re[13],Hi=re[14],Ji=re[15],Bi=ke*ft-Ze*Ot,Hn=ke*_t-st*Ot,Di=ke*di-dt*Ot,os=Ze*_t-st*ft,vs=Ze*di-dt*ft,js=st*di-dt*_t,vo=ni*Pi-Ei*Ti,ao=ni*Hi-Xt*Ti,lo=ni*Ji-_i*Ti,qr=Ei*Hi-Xt*Pi,co=Ei*Ji-_i*Pi,Hr=Xt*Ji-_i*Hi,yn=Bi*Hr-Hn*co+Di*qr+os*lo-vs*ao+js*vo;return yn?(yn=1/yn,ne[0]=(ft*Hr-_t*co+di*qr)*yn,ne[1]=(st*co-Ze*Hr-dt*qr)*yn,ne[2]=(Pi*js-Hi*vs+Ji*os)*yn,ne[3]=(Xt*vs-Ei*js-_i*os)*yn,ne[4]=(_t*lo-Ot*Hr-di*ao)*yn,ne[5]=(ke*Hr-st*lo+dt*ao)*yn,ne[6]=(Hi*Di-Ti*js-Ji*Hn)*yn,ne[7]=(ni*js-Xt*Di+_i*Hn)*yn,ne[8]=(Ot*co-ft*lo+di*vo)*yn,ne[9]=(Ze*lo-ke*co-dt*vo)*yn,ne[10]=(Ti*vs-Pi*Di+Ji*Bi)*yn,ne[11]=(Ei*Di-ni*vs-_i*Bi)*yn,ne[12]=(ft*ao-Ot*qr-_t*vo)*yn,ne[13]=(ke*qr-Ze*ao+st*vo)*yn,ne[14]=(Pi*Hn-Ti*os-Hi*Bi)*yn,ne[15]=(ni*os-Ei*Hn+Xt*Bi)*yn,ne):null}var q=new Float32Array([0,0,0,1]),ie=new Float32Array([0,0,0]);function ce(ne,re,ke,Ze,st,dt){le(ne,Ze||null,dt.depthNear,dt.depthFar);var Ot=ke.orientation||q,ft=ke.position||ie;me(re,Ot,ft),st&&Ee(re,re,st),He(re,re)}return function(ne,re,ke){return!ne||!re?!1:(ne.pose=re,ne.timestamp=re.timestamp,ce(ne.leftProjectionMatrix,ne.leftViewMatrix,re,ke._getFieldOfView("left"),ke._getEyeOffset("left"),ke),ce(ne.rightProjectionMatrix,ne.rightViewMatrix,re,ke._getFieldOfView("right"),ke._getEyeOffset("right"),ke),!0)}}(),Cn=function(){var Z=window.self!==window.top,le=gn(document.referrer),me=gn(window.location.href);return Z&&le!==me},gn=function(Z){var le,me=Z.indexOf("://");me!==-1?le=me+3:le=0;var Ee=Z.indexOf("/",le);return Ee===-1&&(Ee=Z.length),Z.substring(0,Ee)},rr=function(Z){if(Z.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var le=2*Math.acos(Z.w);return le},bn=function(){var W={};return function(Z,le){W[Z]===void 0&&(console.warn("webvr-polyfill: "+le),W[Z]=!0)}}(),cn=function(Z,le){var me=le?"Please use "+le+" instead.":"";bn(Z,Z+" has been deprecated. This may not work on native WebVR displays. "+me)};function Kn(W,Z,le){if(!Z){le(W);return}for(var me=[],Ee=null,He=0;He<Z.length;++He){var q=Z[He];switch(q){case W.TEXTURE_BINDING_2D:case W.TEXTURE_BINDING_CUBE_MAP:var ie=Z[++He];if(ie<W.TEXTURE0||ie>W.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),me.push(null,null);break}Ee||(Ee=W.getParameter(W.ACTIVE_TEXTURE)),W.activeTexture(ie),me.push(W.getParameter(q),null);break;case W.ACTIVE_TEXTURE:Ee=W.getParameter(W.ACTIVE_TEXTURE),me.push(null);break;default:me.push(W.getParameter(q));break}}le(W);for(var He=0;He<Z.length;++He){var q=Z[He],ce=me[He];switch(q){case W.ACTIVE_TEXTURE:break;case W.ARRAY_BUFFER_BINDING:W.bindBuffer(W.ARRAY_BUFFER,ce);break;case W.COLOR_CLEAR_VALUE:W.clearColor(ce[0],ce[1],ce[2],ce[3]);break;case W.COLOR_WRITEMASK:W.colorMask(ce[0],ce[1],ce[2],ce[3]);break;case W.CURRENT_PROGRAM:W.useProgram(ce);break;case W.ELEMENT_ARRAY_BUFFER_BINDING:W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,ce);break;case W.FRAMEBUFFER_BINDING:W.bindFramebuffer(W.FRAMEBUFFER,ce);break;case W.RENDERBUFFER_BINDING:W.bindRenderbuffer(W.RENDERBUFFER,ce);break;case W.TEXTURE_BINDING_2D:var ie=Z[++He];if(ie<W.TEXTURE0||ie>W.TEXTURE31)break;W.activeTexture(ie),W.bindTexture(W.TEXTURE_2D,ce);break;case W.TEXTURE_BINDING_CUBE_MAP:var ie=Z[++He];if(ie<W.TEXTURE0||ie>W.TEXTURE31)break;W.activeTexture(ie),W.bindTexture(W.TEXTURE_CUBE_MAP,ce);break;case W.VIEWPORT:W.viewport(ce[0],ce[1],ce[2],ce[3]);break;case W.BLEND:case W.CULL_FACE:case W.DEPTH_TEST:case W.SCISSOR_TEST:case W.STENCIL_TEST:ce?W.enable(q):W.disable(q);break;default:console.log("No GL restore behavior for 0x"+q.toString(16));break}Ee&&W.activeTexture(Ee)}}var wn=Kn,Cr=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),ar=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function Tn(W,Z,le,me){this.gl=W,this.cardboardUI=Z,this.bufferScale=le,this.dirtySubmitFrameBindings=me,this.ctxAttribs=W.getContextAttributes(),this.instanceExt=W.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=W.drawingBufferWidth,this.bufferHeight=W.drawingBufferHeight,this.realBindFramebuffer=W.bindFramebuffer,this.realEnable=W.enable,this.realDisable=W.disable,this.realColorMask=W.colorMask,this.realClearColor=W.clearColor,this.realViewport=W.viewport,se()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(W.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(W.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Yt(W,Cr,ar,this.attribs),this.uniforms=gi(W,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=W.createBuffer(),this.indexBuffer=W.createBuffer(),this.indexCount=0,this.renderTarget=W.createTexture(),this.framebuffer=W.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=W.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=W.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=W.createRenderbuffer()),this.patch(),this.onResize()}Tn.prototype.destroy=function(){var W=this.gl;this.unpatch(),W.deleteProgram(this.program),W.deleteBuffer(this.vertexBuffer),W.deleteBuffer(this.indexBuffer),W.deleteTexture(this.renderTarget),W.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&W.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&W.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&W.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},Tn.prototype.onResize=function(){var W=this.gl,Z=this,le=[W.RENDERBUFFER_BINDING,W.TEXTURE_BINDING_2D,W.TEXTURE0];wn(W,le,function(me){Z.realBindFramebuffer.call(me,me.FRAMEBUFFER,null),Z.scissorTest&&Z.realDisable.call(me,me.SCISSOR_TEST),Z.realColorMask.call(me,!0,!0,!0,!0),Z.realViewport.call(me,0,0,me.drawingBufferWidth,me.drawingBufferHeight),Z.realClearColor.call(me,0,0,0,1),me.clear(me.COLOR_BUFFER_BIT),Z.realBindFramebuffer.call(me,me.FRAMEBUFFER,Z.framebuffer),me.bindTexture(me.TEXTURE_2D,Z.renderTarget),me.texImage2D(me.TEXTURE_2D,0,Z.ctxAttribs.alpha?me.RGBA:me.RGB,Z.bufferWidth,Z.bufferHeight,0,Z.ctxAttribs.alpha?me.RGBA:me.RGB,me.UNSIGNED_BYTE,null),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.framebufferTexture2D(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_2D,Z.renderTarget,0),Z.ctxAttribs.depth&&Z.ctxAttribs.stencil?(me.bindRenderbuffer(me.RENDERBUFFER,Z.depthStencilBuffer),me.renderbufferStorage(me.RENDERBUFFER,me.DEPTH_STENCIL,Z.bufferWidth,Z.bufferHeight),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.DEPTH_STENCIL_ATTACHMENT,me.RENDERBUFFER,Z.depthStencilBuffer)):Z.ctxAttribs.depth?(me.bindRenderbuffer(me.RENDERBUFFER,Z.depthBuffer),me.renderbufferStorage(me.RENDERBUFFER,me.DEPTH_COMPONENT16,Z.bufferWidth,Z.bufferHeight),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.DEPTH_ATTACHMENT,me.RENDERBUFFER,Z.depthBuffer)):Z.ctxAttribs.stencil&&(me.bindRenderbuffer(me.RENDERBUFFER,Z.stencilBuffer),me.renderbufferStorage(me.RENDERBUFFER,me.STENCIL_INDEX8,Z.bufferWidth,Z.bufferHeight),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.STENCIL_ATTACHMENT,me.RENDERBUFFER,Z.stencilBuffer)),!me.checkFramebufferStatus(me.FRAMEBUFFER)===me.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),Z.realBindFramebuffer.call(me,me.FRAMEBUFFER,Z.lastBoundFramebuffer),Z.scissorTest&&Z.realEnable.call(me,me.SCISSOR_TEST),Z.realColorMask.apply(me,Z.colorMask),Z.realViewport.apply(me,Z.viewport),Z.realClearColor.apply(me,Z.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},Tn.prototype.patch=function(){if(!this.isPatched){var W=this,Z=this.gl.canvas,le=this.gl;se()||(Z.width=pt()*this.bufferScale,Z.height=yt()*this.bufferScale,Object.defineProperty(Z,"width",{configurable:!0,enumerable:!0,get:function(){return W.bufferWidth},set:function(Ee){W.bufferWidth=Ee,W.realCanvasWidth.set.call(Z,Ee),W.onResize()}}),Object.defineProperty(Z,"height",{configurable:!0,enumerable:!0,get:function(){return W.bufferHeight},set:function(Ee){W.bufferHeight=Ee,W.realCanvasHeight.set.call(Z,Ee),W.onResize()}})),this.lastBoundFramebuffer=le.getParameter(le.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(le.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(me,Ee){W.lastBoundFramebuffer=Ee||W.framebuffer,W.realBindFramebuffer.call(le,me,W.lastBoundFramebuffer)},this.cullFace=le.getParameter(le.CULL_FACE),this.depthTest=le.getParameter(le.DEPTH_TEST),this.blend=le.getParameter(le.BLEND),this.scissorTest=le.getParameter(le.SCISSOR_TEST),this.stencilTest=le.getParameter(le.STENCIL_TEST),le.enable=function(me){switch(me){case le.CULL_FACE:W.cullFace=!0;break;case le.DEPTH_TEST:W.depthTest=!0;break;case le.BLEND:W.blend=!0;break;case le.SCISSOR_TEST:W.scissorTest=!0;break;case le.STENCIL_TEST:W.stencilTest=!0;break}W.realEnable.call(le,me)},le.disable=function(me){switch(me){case le.CULL_FACE:W.cullFace=!1;break;case le.DEPTH_TEST:W.depthTest=!1;break;case le.BLEND:W.blend=!1;break;case le.SCISSOR_TEST:W.scissorTest=!1;break;case le.STENCIL_TEST:W.stencilTest=!1;break}W.realDisable.call(le,me)},this.colorMask=le.getParameter(le.COLOR_WRITEMASK),le.colorMask=function(me,Ee,He,q){W.colorMask[0]=me,W.colorMask[1]=Ee,W.colorMask[2]=He,W.colorMask[3]=q,W.realColorMask.call(le,me,Ee,He,q)},this.clearColor=le.getParameter(le.COLOR_CLEAR_VALUE),le.clearColor=function(me,Ee,He,q){W.clearColor[0]=me,W.clearColor[1]=Ee,W.clearColor[2]=He,W.clearColor[3]=q,W.realClearColor.call(le,me,Ee,He,q)},this.viewport=le.getParameter(le.VIEWPORT),le.viewport=function(me,Ee,He,q){W.viewport[0]=me,W.viewport[1]=Ee,W.viewport[2]=He,W.viewport[3]=q,W.realViewport.call(le,me,Ee,He,q)},this.isPatched=!0,yi(Z)}},Tn.prototype.unpatch=function(){if(this.isPatched){var W=this.gl,Z=this.gl.canvas;se()||(Object.defineProperty(Z,"width",this.realCanvasWidth),Object.defineProperty(Z,"height",this.realCanvasHeight)),Z.width=this.bufferWidth,Z.height=this.bufferHeight,W.bindFramebuffer=this.realBindFramebuffer,W.enable=this.realEnable,W.disable=this.realDisable,W.colorMask=this.realColorMask,W.clearColor=this.realClearColor,W.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&W.bindFramebuffer(W.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){yi(Z)},1)}},Tn.prototype.setTextureBounds=function(W,Z){W||(W=[0,0,.5,1]),Z||(Z=[.5,0,.5,1]),this.viewportOffsetScale[0]=W[0],this.viewportOffsetScale[1]=W[1],this.viewportOffsetScale[2]=W[2],this.viewportOffsetScale[3]=W[3],this.viewportOffsetScale[4]=Z[0],this.viewportOffsetScale[5]=Z[1],this.viewportOffsetScale[6]=Z[2],this.viewportOffsetScale[7]=Z[3]},Tn.prototype.submitFrame=function(){var W=this.gl,Z=this,le=[];if(this.dirtySubmitFrameBindings||le.push(W.CURRENT_PROGRAM,W.ARRAY_BUFFER_BINDING,W.ELEMENT_ARRAY_BUFFER_BINDING,W.TEXTURE_BINDING_2D,W.TEXTURE0),wn(W,le,function(Ee){Z.realBindFramebuffer.call(Ee,Ee.FRAMEBUFFER,null);var He=0,q=0;Z.instanceExt&&(He=Ee.getVertexAttrib(Z.attribs.position,Z.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),q=Ee.getVertexAttrib(Z.attribs.texCoord,Z.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),Z.cullFace&&Z.realDisable.call(Ee,Ee.CULL_FACE),Z.depthTest&&Z.realDisable.call(Ee,Ee.DEPTH_TEST),Z.blend&&Z.realDisable.call(Ee,Ee.BLEND),Z.scissorTest&&Z.realDisable.call(Ee,Ee.SCISSOR_TEST),Z.stencilTest&&Z.realDisable.call(Ee,Ee.STENCIL_TEST),Z.realColorMask.call(Ee,!0,!0,!0,!0),Z.realViewport.call(Ee,0,0,Ee.drawingBufferWidth,Ee.drawingBufferHeight),(Z.ctxAttribs.alpha||se())&&(Z.realClearColor.call(Ee,0,0,0,1),Ee.clear(Ee.COLOR_BUFFER_BIT)),Ee.useProgram(Z.program),Ee.bindBuffer(Ee.ELEMENT_ARRAY_BUFFER,Z.indexBuffer),Ee.bindBuffer(Ee.ARRAY_BUFFER,Z.vertexBuffer),Ee.enableVertexAttribArray(Z.attribs.position),Ee.enableVertexAttribArray(Z.attribs.texCoord),Ee.vertexAttribPointer(Z.attribs.position,2,Ee.FLOAT,!1,20,0),Ee.vertexAttribPointer(Z.attribs.texCoord,3,Ee.FLOAT,!1,20,8),Z.instanceExt&&(He!=0&&Z.instanceExt.vertexAttribDivisorANGLE(Z.attribs.position,0),q!=0&&Z.instanceExt.vertexAttribDivisorANGLE(Z.attribs.texCoord,0)),Ee.activeTexture(Ee.TEXTURE0),Ee.uniform1i(Z.uniforms.diffuse,0),Ee.bindTexture(Ee.TEXTURE_2D,Z.renderTarget),Ee.uniform4fv(Z.uniforms.viewportOffsetScale,Z.viewportOffsetScale),Ee.drawElements(Ee.TRIANGLES,Z.indexCount,Ee.UNSIGNED_SHORT,0),Z.cardboardUI&&Z.cardboardUI.renderNoState(),Z.realBindFramebuffer.call(Z.gl,Ee.FRAMEBUFFER,Z.framebuffer),Z.ctxAttribs.preserveDrawingBuffer||(Z.realClearColor.call(Ee,0,0,0,0),Ee.clear(Ee.COLOR_BUFFER_BIT)),Z.dirtySubmitFrameBindings||Z.realBindFramebuffer.call(Ee,Ee.FRAMEBUFFER,Z.lastBoundFramebuffer),Z.cullFace&&Z.realEnable.call(Ee,Ee.CULL_FACE),Z.depthTest&&Z.realEnable.call(Ee,Ee.DEPTH_TEST),Z.blend&&Z.realEnable.call(Ee,Ee.BLEND),Z.scissorTest&&Z.realEnable.call(Ee,Ee.SCISSOR_TEST),Z.stencilTest&&Z.realEnable.call(Ee,Ee.STENCIL_TEST),Z.realColorMask.apply(Ee,Z.colorMask),Z.realViewport.apply(Ee,Z.viewport),(Z.ctxAttribs.alpha||!Z.ctxAttribs.preserveDrawingBuffer)&&Z.realClearColor.apply(Ee,Z.clearColor),Z.instanceExt&&(He!=0&&Z.instanceExt.vertexAttribDivisorANGLE(Z.attribs.position,He),q!=0&&Z.instanceExt.vertexAttribDivisorANGLE(Z.attribs.texCoord,q))}),se()){var me=W.canvas;(me.width!=Z.bufferWidth||me.height!=Z.bufferHeight)&&(Z.bufferWidth=me.width,Z.bufferHeight=me.height,Z.onResize())}},Tn.prototype.updateDeviceInfo=function(W){var Z=this.gl,le=this,me=[Z.ARRAY_BUFFER_BINDING,Z.ELEMENT_ARRAY_BUFFER_BINDING];wn(Z,me,function(Ee){var He=le.computeMeshVertices_(le.meshWidth,le.meshHeight,W);if(Ee.bindBuffer(Ee.ARRAY_BUFFER,le.vertexBuffer),Ee.bufferData(Ee.ARRAY_BUFFER,He,Ee.STATIC_DRAW),!le.indexCount){var q=le.computeMeshIndices_(le.meshWidth,le.meshHeight);Ee.bindBuffer(Ee.ELEMENT_ARRAY_BUFFER,le.indexBuffer),Ee.bufferData(Ee.ELEMENT_ARRAY_BUFFER,q,Ee.STATIC_DRAW),le.indexCount=q.length}})},Tn.prototype.computeMeshVertices_=function(W,Z,le){for(var me=new Float32Array(2*W*Z*5),Ee=le.getLeftEyeVisibleTanAngles(),He=le.getLeftEyeNoLensTanAngles(),q=le.getLeftEyeVisibleScreenRect(He),ie=0,ce=0;ce<2;ce++){for(var ne=0;ne<Z;ne++)for(var re=0;re<W;re++,ie++){var ke=re/(W-1),Ze=ne/(Z-1),st=ke,dt=Ze,Ot=de(Ee[0],Ee[2],ke),ft=de(Ee[3],Ee[1],Ze),_t=Math.sqrt(Ot*Ot+ft*ft),di=le.distortion.distortInverse(_t),ni=Ot*di/_t,Ei=ft*di/_t;ke=(ni-He[0])/(He[2]-He[0]),Ze=(Ei-He[3])/(He[1]-He[3]),ke=(q.x+ke*q.width-.5)*2,Ze=(q.y+Ze*q.height-.5)*2,me[ie*5+0]=ke,me[ie*5+1]=Ze,me[ie*5+2]=st,me[ie*5+3]=dt,me[ie*5+4]=ce}var Xt=Ee[2]-Ee[0];Ee[0]=-(Xt+Ee[0]),Ee[2]=Xt-Ee[2],Xt=He[2]-He[0],He[0]=-(Xt+He[0]),He[2]=Xt-He[2],q.x=1-(q.x+q.width)}return me},Tn.prototype.computeMeshIndices_=function(W,Z){for(var le=new Uint16Array(2*(W-1)*(Z-1)*6),me=W/2,Ee=Z/2,He=0,q=0,ie=0;ie<2;ie++)for(var ce=0;ce<Z;ce++)for(var ne=0;ne<W;ne++,He++)ne==0||ce==0||(ne<=me==ce<=Ee?(le[q++]=He,le[q++]=He-W-1,le[q++]=He-W,le[q++]=He-W-1,le[q++]=He,le[q++]=He-1):(le[q++]=He-1,le[q++]=He-W,le[q++]=He,le[q++]=He-W,le[q++]=He-1,le[q++]=He-W-1));return le},Tn.prototype.getOwnPropertyDescriptor_=function(W,Z){var le=Object.getOwnPropertyDescriptor(W,Z);return(le.get===void 0||le.set===void 0)&&(le.configurable=!0,le.enumerable=!0,le.get=function(){return this.getAttribute(Z)},le.set=function(me){this.setAttribute(Z,me)}),le};var St=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),ye=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),ve=Math.PI/180,Le=60,Se=12,Re=20,Pe=1,$=.75,N=.3125,V=4,fe=28,be=1.5;function Fe(W){this.gl=W,this.attribs={position:0},this.program=Yt(W,St,ye,this.attribs),this.uniforms=gi(W,this.program),this.vertexBuffer=W.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Fe.prototype.destroy=function(){var W=this.gl;this.listener&&W.canvas.removeEventListener("click",this.listener,!1),W.deleteProgram(this.program),W.deleteBuffer(this.vertexBuffer)},Fe.prototype.listen=function(W,Z){var le=this.gl.canvas;this.listener=function(me){var Ee=le.clientWidth/2,He=fe*be;me.clientX>Ee-He&&me.clientX<Ee+He&&me.clientY>le.clientHeight-He?W(me):me.clientX<He&&me.clientY<He&&Z(me)},le.addEventListener("click",this.listener,!1)},Fe.prototype.onResize=function(){var W=this.gl,Z=this,le=[W.ARRAY_BUFFER_BINDING];wn(W,le,function(me){var Ee=[],He=me.drawingBufferWidth/2,q=Math.max(screen.width,screen.height)*window.devicePixelRatio,ie=me.drawingBufferWidth/q,ce=ie*window.devicePixelRatio,ne=V*ce/2,re=fe*be*ce,ke=fe*ce/2,Ze=(fe*be-fe)*ce;Ee.push(He-ne,re),Ee.push(He-ne,me.drawingBufferHeight),Ee.push(He+ne,re),Ee.push(He+ne,me.drawingBufferHeight),Z.gearOffset=Ee.length/2;function st(di,ni){var Ei=(90-di)*ve,Xt=Math.cos(Ei),_i=Math.sin(Ei);Ee.push(N*Xt*ke+He,N*_i*ke+ke),Ee.push(ni*Xt*ke+He,ni*_i*ke+ke)}for(var dt=0;dt<=6;dt++){var Ot=dt*Le;st(Ot,Pe),st(Ot+Se,Pe),st(Ot+Re,$),st(Ot+(Le-Re),$),st(Ot+(Le-Se),Pe)}Z.gearVertexCount=Ee.length/2-Z.gearOffset,Z.arrowOffset=Ee.length/2;function ft(di,ni){Ee.push(Ze+di,me.drawingBufferHeight-Ze-ni)}var _t=ne/Math.sin(45*ve);ft(0,ke),ft(ke,0),ft(ke+_t,_t),ft(_t,ke+_t),ft(_t,ke-_t),ft(0,ke),ft(ke,ke*2),ft(ke+_t,ke*2-_t),ft(_t,ke-_t),ft(0,ke),ft(_t,ke-ne),ft(fe*ce,ke-ne),ft(_t,ke+ne),ft(fe*ce,ke+ne),Z.arrowVertexCount=Ee.length/2-Z.arrowOffset,me.bindBuffer(me.ARRAY_BUFFER,Z.vertexBuffer),me.bufferData(me.ARRAY_BUFFER,new Float32Array(Ee),me.STATIC_DRAW)})},Fe.prototype.render=function(){var W=this.gl,Z=this,le=[W.CULL_FACE,W.DEPTH_TEST,W.BLEND,W.SCISSOR_TEST,W.STENCIL_TEST,W.COLOR_WRITEMASK,W.VIEWPORT,W.CURRENT_PROGRAM,W.ARRAY_BUFFER_BINDING];wn(W,le,function(me){me.disable(me.CULL_FACE),me.disable(me.DEPTH_TEST),me.disable(me.BLEND),me.disable(me.SCISSOR_TEST),me.disable(me.STENCIL_TEST),me.colorMask(!0,!0,!0,!0),me.viewport(0,0,me.drawingBufferWidth,me.drawingBufferHeight),Z.renderNoState()})},Fe.prototype.renderNoState=function(){var W=this.gl;W.useProgram(this.program),W.bindBuffer(W.ARRAY_BUFFER,this.vertexBuffer),W.enableVertexAttribArray(this.attribs.position),W.vertexAttribPointer(this.attribs.position,2,W.FLOAT,!1,8,0),W.uniform4f(this.uniforms.color,1,1,1,1),Ri(this.projMat,0,W.drawingBufferWidth,0,W.drawingBufferHeight,.1,1024),W.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),W.drawArrays(W.TRIANGLE_STRIP,0,4),W.drawArrays(W.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),W.drawArrays(W.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function We(W){this.coefficients=W}We.prototype.distortInverse=function(W){for(var Z=0,le=1,me=W-this.distort(Z);Math.abs(le-Z)>1e-4;){var Ee=W-this.distort(le),He=le-Ee*((le-Z)/(Ee-me));Z=le,le=He,me=Ee}return le},We.prototype.distort=function(W){for(var Z=W*W,le=0,me=0;me<this.coefficients.length;me++)le=Z*(le+this.coefficients[me]);return(le+1)*W};var Rt=Math.PI/180,zt=180/Math.PI,Lt=function(Z,le,me){this.x=Z||0,this.y=le||0,this.z=me||0};Lt.prototype={constructor:Lt,set:function(Z,le,me){return this.x=Z,this.y=le,this.z=me,this},copy:function(Z){return this.x=Z.x,this.y=Z.y,this.z=Z.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var Z=this.length();if(Z!==0){var le=1/Z;this.multiplyScalar(le)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(Z){this.x*=Z,this.y*=Z,this.z*=Z},applyQuaternion:function(Z){var le=this.x,me=this.y,Ee=this.z,He=Z.x,q=Z.y,ie=Z.z,ce=Z.w,ne=ce*le+q*Ee-ie*me,re=ce*me+ie*le-He*Ee,ke=ce*Ee+He*me-q*le,Ze=-He*le-q*me-ie*Ee;return this.x=ne*ce+Ze*-He+re*-ie-ke*-q,this.y=re*ce+Ze*-q+ke*-He-ne*-ie,this.z=ke*ce+Ze*-ie+ne*-q-re*-He,this},dot:function(Z){return this.x*Z.x+this.y*Z.y+this.z*Z.z},crossVectors:function(Z,le){var me=Z.x,Ee=Z.y,He=Z.z,q=le.x,ie=le.y,ce=le.z;return this.x=Ee*ce-He*ie,this.y=He*q-me*ce,this.z=me*ie-Ee*q,this}};var Tt=function(Z,le,me,Ee){this.x=Z||0,this.y=le||0,this.z=me||0,this.w=Ee!==void 0?Ee:1};Tt.prototype={constructor:Tt,set:function(Z,le,me,Ee){return this.x=Z,this.y=le,this.z=me,this.w=Ee,this},copy:function(Z){return this.x=Z.x,this.y=Z.y,this.z=Z.z,this.w=Z.w,this},setFromEulerXYZ:function(Z,le,me){var Ee=Math.cos(Z/2),He=Math.cos(le/2),q=Math.cos(me/2),ie=Math.sin(Z/2),ce=Math.sin(le/2),ne=Math.sin(me/2);return this.x=ie*He*q+Ee*ce*ne,this.y=Ee*ce*q-ie*He*ne,this.z=Ee*He*ne+ie*ce*q,this.w=Ee*He*q-ie*ce*ne,this},setFromEulerYXZ:function(Z,le,me){var Ee=Math.cos(Z/2),He=Math.cos(le/2),q=Math.cos(me/2),ie=Math.sin(Z/2),ce=Math.sin(le/2),ne=Math.sin(me/2);return this.x=ie*He*q+Ee*ce*ne,this.y=Ee*ce*q-ie*He*ne,this.z=Ee*He*ne-ie*ce*q,this.w=Ee*He*q+ie*ce*ne,this},setFromAxisAngle:function(Z,le){var me=le/2,Ee=Math.sin(me);return this.x=Z.x*Ee,this.y=Z.y*Ee,this.z=Z.z*Ee,this.w=Math.cos(me),this},multiply:function(Z){return this.multiplyQuaternions(this,Z)},multiplyQuaternions:function(Z,le){var me=Z.x,Ee=Z.y,He=Z.z,q=Z.w,ie=le.x,ce=le.y,ne=le.z,re=le.w;return this.x=me*re+q*ie+Ee*ne-He*ce,this.y=Ee*re+q*ce+He*ie-me*ne,this.z=He*re+q*ne+me*ce-Ee*ie,this.w=q*re-me*ie-Ee*ce-He*ne,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var Z=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return Z===0?(this.x=0,this.y=0,this.z=0,this.w=1):(Z=1/Z,this.x=this.x*Z,this.y=this.y*Z,this.z=this.z*Z,this.w=this.w*Z),this},slerp:function(Z,le){if(le===0)return this;if(le===1)return this.copy(Z);var me=this.x,Ee=this.y,He=this.z,q=this.w,ie=q*Z.w+me*Z.x+Ee*Z.y+He*Z.z;if(ie<0?(this.w=-Z.w,this.x=-Z.x,this.y=-Z.y,this.z=-Z.z,ie=-ie):this.copy(Z),ie>=1)return this.w=q,this.x=me,this.y=Ee,this.z=He,this;var ce=Math.acos(ie),ne=Math.sqrt(1-ie*ie);if(Math.abs(ne)<.001)return this.w=.5*(q+this.w),this.x=.5*(me+this.x),this.y=.5*(Ee+this.y),this.z=.5*(He+this.z),this;var re=Math.sin((1-le)*ce)/ne,ke=Math.sin(le*ce)/ne;return this.w=q*re+this.w*ke,this.x=me*re+this.x*ke,this.y=Ee*re+this.y*ke,this.z=He*re+this.z*ke,this},setFromUnitVectors:function(){var W,Z,le=1e-6;return function(me,Ee){return W===void 0&&(W=new Lt),Z=me.dot(Ee)+1,Z<le?(Z=0,Math.abs(me.x)>Math.abs(me.z)?W.set(-me.y,me.x,0):W.set(0,-me.z,me.y)):W.crossVectors(me,Ee),this.x=W.x,this.y=W.y,this.z=W.z,this.w=Z,this.normalize(),this}}()};function ti(W){this.width=W.width||pt(),this.height=W.height||yt(),this.widthMeters=W.widthMeters,this.heightMeters=W.heightMeters,this.bevelMeters=W.bevelMeters}var Jn=new ti({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),wi=new ti({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Xn={CardboardV1:new In({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new In({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function mn(W,Z){this.viewer=Xn.CardboardV2,this.updateDeviceParams(W),this.distortion=new We(this.viewer.distortionCoefficients);for(var le=0;le<Z.length;le++){var me=Z[le];Xn[me.id]=new In(me)}}mn.prototype.updateDeviceParams=function(W){this.device=this.determineDevice_(W)||this.device},mn.prototype.getDevice=function(){return this.device},mn.prototype.setViewer=function(W){this.viewer=W,this.distortion=new We(this.viewer.distortionCoefficients)},mn.prototype.determineDevice_=function(W){if(!W)return se()?(console.warn("Using fallback iOS device measurements."),wi):(console.warn("Using fallback Android device measurements."),Jn);var Z=.0254,le=Z/W.xdpi,me=Z/W.ydpi,Ee=pt(),He=yt();return new ti({widthMeters:le*Ee,heightMeters:me*He,bevelMeters:W.bevelMm*.001})},mn.prototype.getDistortedFieldOfViewLeftEye=function(){var W=this.viewer,Z=this.device,le=this.distortion,me=W.screenLensDistance,Ee=(Z.widthMeters-W.interLensDistance)/2,He=W.interLensDistance/2,q=W.baselineLensDistance-Z.bevelMeters,ie=Z.heightMeters-q,ce=zt*Math.atan(le.distort(Ee/me)),ne=zt*Math.atan(le.distort(He/me)),re=zt*Math.atan(le.distort(q/me)),ke=zt*Math.atan(le.distort(ie/me));return{leftDegrees:Math.min(ce,W.fov),rightDegrees:Math.min(ne,W.fov),downDegrees:Math.min(re,W.fov),upDegrees:Math.min(ke,W.fov)}},mn.prototype.getLeftEyeVisibleTanAngles=function(){var W=this.viewer,Z=this.device,le=this.distortion,me=Math.tan(-Rt*W.fov),Ee=Math.tan(Rt*W.fov),He=Math.tan(Rt*W.fov),q=Math.tan(-Rt*W.fov),ie=Z.widthMeters/4,ce=Z.heightMeters/2,ne=W.baselineLensDistance-Z.bevelMeters-ce,re=W.interLensDistance/2-ie,ke=-ne,Ze=W.screenLensDistance,st=le.distort((re-ie)/Ze),dt=le.distort((ke+ce)/Ze),Ot=le.distort((re+ie)/Ze),ft=le.distort((ke-ce)/Ze),_t=new Float32Array(4);return _t[0]=Math.max(me,st),_t[1]=Math.min(Ee,dt),_t[2]=Math.min(He,Ot),_t[3]=Math.max(q,ft),_t},mn.prototype.getLeftEyeNoLensTanAngles=function(){var W=this.viewer,Z=this.device,le=this.distortion,me=new Float32Array(4),Ee=le.distortInverse(Math.tan(-Rt*W.fov)),He=le.distortInverse(Math.tan(Rt*W.fov)),q=le.distortInverse(Math.tan(Rt*W.fov)),ie=le.distortInverse(Math.tan(-Rt*W.fov)),ce=Z.widthMeters/4,ne=Z.heightMeters/2,re=W.baselineLensDistance-Z.bevelMeters-ne,ke=W.interLensDistance/2-ce,Ze=-re,st=W.screenLensDistance,dt=(ke-ce)/st,Ot=(Ze+ne)/st,ft=(ke+ce)/st,_t=(Ze-ne)/st;return me[0]=Math.max(Ee,dt),me[1]=Math.min(He,Ot),me[2]=Math.min(q,ft),me[3]=Math.max(ie,_t),me},mn.prototype.getLeftEyeVisibleScreenRect=function(W){var Z=this.viewer,le=this.device,me=Z.screenLensDistance,Ee=(le.widthMeters-Z.interLensDistance)/2,He=Z.baselineLensDistance-le.bevelMeters,q=(W[0]*me+Ee)/le.widthMeters,ie=(W[1]*me+He)/le.heightMeters,ce=(W[2]*me+Ee)/le.widthMeters,ne=(W[3]*me+He)/le.heightMeters;return{x:q,y:ne,width:ce-q,height:ie-ne}},mn.prototype.getFieldOfViewLeftEye=function(W){return W?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},mn.prototype.getFieldOfViewRightEye=function(W){var Z=this.getFieldOfViewLeftEye(W);return{leftDegrees:Z.rightDegrees,rightDegrees:Z.leftDegrees,upDegrees:Z.upDegrees,downDegrees:Z.downDegrees}},mn.prototype.getUndistortedFieldOfViewLeftEye=function(){var W=this.getUndistortedParams_();return{leftDegrees:zt*Math.atan(W.outerDist),rightDegrees:zt*Math.atan(W.innerDist),downDegrees:zt*Math.atan(W.bottomDist),upDegrees:zt*Math.atan(W.topDist)}},mn.prototype.getUndistortedViewportLeftEye=function(){var W=this.getUndistortedParams_(),Z=this.viewer,le=this.device,me=Z.screenLensDistance,Ee=le.widthMeters/me,He=le.heightMeters/me,q=le.width/Ee,ie=le.height/He,ce=Math.round((W.eyePosX-W.outerDist)*q),ne=Math.round((W.eyePosY-W.bottomDist)*ie);return{x:ce,y:ne,width:Math.round((W.eyePosX+W.innerDist)*q)-ce,height:Math.round((W.eyePosY+W.topDist)*ie)-ne}},mn.prototype.getUndistortedParams_=function(){var W=this.viewer,Z=this.device,le=this.distortion,me=W.screenLensDistance,Ee=W.interLensDistance/2/me,He=Z.widthMeters/me,q=Z.heightMeters/me,ie=He/2-Ee,ce=(W.baselineLensDistance-Z.bevelMeters)/me,ne=W.fov,re=le.distortInverse(Math.tan(Rt*ne)),ke=Math.min(ie,re),Ze=Math.min(Ee,re),st=Math.min(ce,re),dt=Math.min(q-ce,re);return{outerDist:ke,innerDist:Ze,topDist:dt,bottomDist:st,eyePosX:ie,eyePosY:ce}};function In(W){this.id=W.id,this.label=W.label,this.fov=W.fov,this.interLensDistance=W.interLensDistance,this.baselineLensDistance=W.baselineLensDistance,this.screenLensDistance=W.screenLensDistance,this.distortionCoefficients=W.distortionCoefficients,this.inverseCoefficients=W.inverseCoefficients}mn.Viewers=Xn;var Yr=1,Qn="2019-11-09T17:36:14Z",ms=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],sr={format:Yr,last_updated:Qn,devices:ms};function Qr(W,Z){if(this.dpdb=sr,this.recalculateDeviceParams_(),W){this.onDeviceParamsUpdated=Z;var le=new XMLHttpRequest,me=this;le.open("GET",W,!0),le.addEventListener("load",function(){me.loading=!1,le.status>=200&&le.status<=299?(me.dpdb=JSON.parse(le.response),me.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),le.send()}}Qr.prototype.getDeviceParams=function(){return this.deviceParams},Qr.prototype.recalculateDeviceParams_=function(){var W=this.calcDeviceParams_();W?(this.deviceParams=W,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Qr.prototype.calcDeviceParams_=function(){var W=this.dpdb;if(!W)return console.error("DPDB not available."),null;if(W.format!=1)return console.error("DPDB has unexpected format version."),null;if(!W.devices||!W.devices.length)return console.error("DPDB does not have a devices section."),null;var Z=navigator.userAgent||navigator.vendor||window.opera,le=pt(),me=yt();if(!W.devices)return console.error("DPDB has no devices section."),null;for(var Ee=0;Ee<W.devices.length;Ee++){var He=W.devices[Ee];if(!He.rules){console.warn("Device["+Ee+"] has no rules section.");continue}if(He.type!="ios"&&He.type!="android"){console.warn("Device["+Ee+"] has invalid type.");continue}if(se()==(He.type=="ios")){for(var q=!1,ie=0;ie<He.rules.length;ie++){var ce=He.rules[ie];if(this.ruleMatches_(ce,Z,le,me)){q=!0;break}}if(q){var ne=He.dpi[0]||He.dpi,re=He.dpi[1]||He.dpi;return new gs({xdpi:ne,ydpi:re,bevelMm:He.bw})}}}return console.warn("No DPDB device match."),null},Qr.prototype.ruleMatches_=function(W,Z,le,me){if(!W.ua&&!W.res||(W.ua&&W.ua.substring(0,2)==="SM"&&(W.ua=W.ua.substring(0,7)),W.ua&&Z.indexOf(W.ua)<0))return!1;if(W.res){if(!W.res[0]||!W.res[1])return!1;var Ee=W.res[0],He=W.res[1];if(Math.min(le,me)!=Math.min(Ee,He)||Math.max(le,me)!=Math.max(Ee,He))return!1}return!0};function gs(W){this.xdpi=W.xdpi,this.ydpi=W.ydpi,this.bevelMm=W.bevelMm}function Tr(W,Z){this.set(W,Z)}Tr.prototype.set=function(W,Z){this.sample=W,this.timestampS=Z},Tr.prototype.copy=function(W){this.set(W.sample,W.timestampS)};function Yn(W,Z){this.kFilter=W,this.isDebug=Z,this.currentAccelMeasurement=new Tr,this.currentGyroMeasurement=new Tr,this.previousGyroMeasurement=new Tr,se()?this.filterQ=new Tt(-1,0,0,1):this.filterQ=new Tt(1,0,0,1),this.previousFilterQ=new Tt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new Tt,this.isOrientationInitialized=!1,this.estimatedGravity=new Lt,this.measuredGravity=new Lt,this.gyroIntegralQ=new Tt}Yn.prototype.addAccelMeasurement=function(W,Z){this.currentAccelMeasurement.set(W,Z)},Yn.prototype.addGyroMeasurement=function(W,Z){this.currentGyroMeasurement.set(W,Z);var le=Z-this.previousGyroMeasurement.timestampS;Je(le)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},Yn.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var W=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,Z=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,W);this.gyroIntegralQ.multiply(Z),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(Z);var le=new Tt;le.copy(this.filterQ),le.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(le),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var me=new Tt;me.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),me.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",zt*rr(me),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Ee=new Tt;Ee.copy(this.filterQ),Ee.multiply(me),this.filterQ.slerp(Ee,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},Yn.prototype.getOrientation=function(){return this.filterQ},Yn.prototype.accelToQuaternion_=function(W){var Z=new Lt;Z.copy(W),Z.normalize();var le=new Tt;return le.setFromUnitVectors(new Lt(0,0,-1),Z),le.inverse(),le},Yn.prototype.gyroToQuaternionDelta_=function(W,Z){var le=new Tt,me=new Lt;return me.copy(W),me.normalize(),le.setFromAxisAngle(me,W.length()*Z),le};function Bn(W,Z){this.predictionTimeS=W,this.isDebug=Z,this.previousQ=new Tt,this.previousTimestampS=null,this.deltaQ=new Tt,this.outQ=new Tt}Bn.prototype.getPrediction=function(W,Z,le){if(!this.previousTimestampS)return this.previousQ.copy(W),this.previousTimestampS=le,W;var me=new Lt;me.copy(Z),me.normalize();var Ee=Z.length();if(Ee<Rt*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(zt*Ee).toFixed(1)),this.outQ.copy(W),this.previousQ.copy(W),this.outQ;var He=Ee*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(me,He),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(W),this.previousTimestampS=le,this.outQ};function lr(W,Z,le,me){this.yawOnly=le,this.accelerometer=new Lt,this.gyroscope=new Lt,this.filter=new Yn(W,me),this.posePredictor=new Bn(Z,me),this.isFirefoxAndroid=ae(),this.isIOS=se();var Ee=ue();this.isDeviceMotionInRadians=!this.isIOS&&Ee&&Ee<66,this.isWithoutDeviceMotion=De()||Me(),this.filterToWorldQ=new Tt,se()?this.filterToWorldQ.setFromAxisAngle(new Lt(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Lt(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new Tt,this.worldToScreenQ=new Tt,this.originalPoseAdjustQ=new Tt,this.originalPoseAdjustQ.setFromAxisAngle(new Lt(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),Xe()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new Tt,this.orientationOut_=new Float32Array(4),this.start()}lr.prototype.getPosition=function(){return null},lr.prototype.getOrientation=function(){var W=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Ee=new Tt().setFromAxisAngle(new Lt(0,0,-1),0),He=new Tt;return window.orientation===-90?He.setFromAxisAngle(new Lt(0,1,0),Math.PI/-2):He.setFromAxisAngle(new Lt(0,1,0),Math.PI/2),Ee.multiply(He)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Ee=new Tt;return Ee.setFromAxisAngle(new Lt(1,0,0),-Math.PI/2),Ee}(),W=this._deviceOrientationQ;var le=new Tt;return le.copy(W),le.multiply(this.deviceOrientationFilterToWorldQ),le.multiply(this.resetQ),le.multiply(this.worldToScreenQ),le.multiplyQuaternions(this.deviceOrientationFixQ,le),this.yawOnly&&(le.x=0,le.z=0,le.normalize()),this.orientationOut_[0]=le.x,this.orientationOut_[1]=le.y,this.orientationOut_[2]=le.z,this.orientationOut_[3]=le.w,this.orientationOut_}else{var Z=this.filter.getOrientation();W=this.posePredictor.getPrediction(Z,this.gyroscope,this.previousTimestampS)}var le=new Tt;return le.copy(this.filterToWorldQ),le.multiply(this.resetQ),le.multiply(W),le.multiply(this.worldToScreenQ),this.yawOnly&&(le.x=0,le.z=0,le.normalize()),this.orientationOut_[0]=le.x,this.orientationOut_[1]=le.y,this.orientationOut_[2]=le.z,this.orientationOut_[3]=le.w,this.orientationOut_},lr.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),Xe()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},lr.prototype.onDeviceOrientation_=function(W){this._deviceOrientationQ=this._deviceOrientationQ||new Tt;var Z=W.alpha,le=W.beta,me=W.gamma;Z=(Z||0)*Math.PI/180,le=(le||0)*Math.PI/180,me=(me||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(le,Z,-me)},lr.prototype.onDeviceMotion_=function(W){this.updateDeviceMotion_(W)},lr.prototype.updateDeviceMotion_=function(W){var Z=W.accelerationIncludingGravity,le=W.rotationRate,me=W.timeStamp/1e3,Ee=me-this.previousTimestampS;if(Ee<0){bn("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=me;return}else if(Ee<=oe||Ee>te){bn("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=me;return}this.accelerometer.set(-Z.x,-Z.y,-Z.z),le&&(Ge()?this.gyroscope.set(-le.beta,le.alpha,le.gamma):this.gyroscope.set(le.alpha,le.beta,le.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,me)),this.filter.addAccelMeasurement(this.accelerometer,me),this.previousTimestampS=me},lr.prototype.onOrientationChange_=function(W){this.setScreenTransform_()},lr.prototype.onMessage_=function(W){var Z=W.data;if(!(!Z||!Z.type)){var le=Z.type.toLowerCase();le==="devicemotion"&&this.updateDeviceMotion_(Z.deviceMotionEvent)}},lr.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new Lt(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new Lt(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},lr.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),se()&&Cn()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},lr.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var Hs=60,ss=new Lt(1,0,0),oo=new Lt(0,0,1),Fs=new Tt;Fs.setFromAxisAngle(ss,-Math.PI/2),Fs.multiply(new Tt().setFromAxisAngle(oo,Math.PI/2));var we=function(){function W(Z){F(this,W),this.config=Z,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new Tt,this._outQ=new Tt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return j(W,[{key:"init",value:function(){var le=null;try{le=new RelativeOrientationSensor({frequency:Hs,referenceFrame:"screen"}),le.addEventListener("error",this._onSensorError)}catch(me){this.errors.push(me),me.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):me.name==="ReferenceError"?this.useDeviceMotion():console.error(me)}le&&(this.api="sensor",this.sensor=le,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new lr(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var le=this.sensor.quaternion;this._sensorQ.set(le[0],le[1],le[2],le[3]);var me=this._outQ;return me.copy(Fs),me.multiply(this._sensorQ),this.config.YAW_ONLY&&(me.x=me.z=0,me.normalize()),this._out[0]=me.x,this._out[1]=me.y,this._out[2]=me.z,this._out[3]=me.w,this._out}},{key:"_onSensorError",value:function(le){this.errors.push(le.error),le.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):le.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(le.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),W}(),Ne="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function Ye(){this.loadIcon_();var W=document.createElement("div"),q=W.style;q.position="fixed",q.top=0,q.right=0,q.bottom=0,q.left=0,q.backgroundColor="gray",q.fontFamily="sans-serif",q.zIndex=1e6;var Z=document.createElement("img");Z.src=this.icon;var q=Z.style;q.marginLeft="25%",q.marginTop="25%",q.width="50%",W.appendChild(Z);var le=document.createElement("div"),q=le.style;q.textAlign="center",q.fontSize="16px",q.lineHeight="24px",q.margin="24px 25%",q.width="50%",le.innerHTML="Place your phone into your Cardboard viewer.",W.appendChild(le);var me=document.createElement("div"),q=me.style;q.backgroundColor="#CFD8DC",q.position="fixed",q.bottom=0,q.width="100%",q.height="48px",q.padding="14px 24px",q.boxSizing="border-box",q.color="#656A6B",W.appendChild(me);var Ee=document.createElement("div");Ee.style.float="left",Ee.innerHTML="No Cardboard viewer?";var He=document.createElement("a");He.href="https://www.google.com/get/cardboard/get-cardboard/",He.innerHTML="get one",He.target="_blank";var q=He.style;q.float="right",q.fontWeight=600,q.textTransform="uppercase",q.borderLeft="1px solid gray",q.paddingLeft="24px",q.textDecoration="none",q.color="#656A6B",me.appendChild(Ee),me.appendChild(He),this.overlay=W,this.text=le,this.hide()}Ye.prototype.show=function(W){!W&&!this.overlay.parentElement?document.body.appendChild(this.overlay):W&&(this.overlay.parentElement&&this.overlay.parentElement!=W&&this.overlay.parentElement.removeChild(this.overlay),W.appendChild(this.overlay)),this.overlay.style.display="block";var Z=this.overlay.querySelector("img"),le=Z.style;Xe()?(le.width="20%",le.marginLeft="40%",le.marginTop="3%"):(le.width="50%",le.marginLeft="25%",le.marginTop="25%")},Ye.prototype.hide=function(){this.overlay.style.display="none"},Ye.prototype.showTemporarily=function(W,Z){this.show(Z),this.timer=setTimeout(this.hide.bind(this),W)},Ye.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},Ye.prototype.update=function(){this.disableShowTemporarily(),!Xe()&&Ni()?this.show():this.hide()},Ye.prototype.loadIcon_=function(){this.icon=pe("image/svg+xml",Ne)};var ht="CardboardV1",nt="WEBVR_CARDBOARD_VIEWER",At="webvr-polyfill-viewer-selector";function Bt(W){try{this.selectedKey=localStorage.getItem(nt)}catch(Z){console.error("Failed to load viewer profile: %s",Z)}this.selectedKey||(this.selectedKey=W||ht),this.dialog=this.createDialog_(mn.Viewers),this.root=null,this.onChangeCallbacks_=[]}Bt.prototype.show=function(W){this.root=W,W.appendChild(this.dialog);var Z=this.dialog.querySelector("#"+this.selectedKey);Z.checked=!0,this.dialog.style.display="block"},Bt.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Bt.prototype.getCurrentViewer=function(){return mn.Viewers[this.selectedKey]},Bt.prototype.getSelectedKey_=function(){var W=this.dialog.querySelector("input[name=field]:checked");return W?W.id:null},Bt.prototype.onChange=function(W){this.onChangeCallbacks_.push(W)},Bt.prototype.fireOnChange_=function(W){for(var Z=0;Z<this.onChangeCallbacks_.length;Z++)this.onChangeCallbacks_[Z](W)},Bt.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!mn.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(mn.Viewers[this.selectedKey]);try{localStorage.setItem(nt,this.selectedKey)}catch(W){console.error("Failed to save viewer profile: %s",W)}this.hide()},Bt.prototype.createDialog_=function(W){var Z=document.createElement("div");Z.classList.add(At),Z.style.display="none";var le=document.createElement("div"),He=le.style;He.position="fixed",He.left=0,He.top=0,He.width="100%",He.height="100%",He.background="rgba(0, 0, 0, 0.3)",le.addEventListener("click",this.hide.bind(this));var me=280,Ee=document.createElement("div"),He=Ee.style;He.boxSizing="border-box",He.position="fixed",He.top="24px",He.left="50%",He.marginLeft=-me/2+"px",He.width=me+"px",He.padding="24px",He.overflow="hidden",He.background="#fafafa",He.fontFamily="'Roboto', sans-serif",He.boxShadow="0px 5px 20px #666",Ee.appendChild(this.createH1_("Select your viewer"));for(var q in W)Ee.appendChild(this.createChoice_(q,W[q].label));return Ee.appendChild(this.createButton_("Save",this.onSave_.bind(this))),Z.appendChild(le),Z.appendChild(Ee),Z},Bt.prototype.createH1_=function(W){var Z=document.createElement("h1"),le=Z.style;return le.color="black",le.fontSize="20px",le.fontWeight="bold",le.marginTop=0,le.marginBottom="24px",Z.innerHTML=W,Z},Bt.prototype.createChoice_=function(W,Z){var le=document.createElement("div");le.style.marginTop="8px",le.style.color="black";var me=document.createElement("input");me.style.fontSize="30px",me.setAttribute("id",W),me.setAttribute("type","radio"),me.setAttribute("value",W),me.setAttribute("name","field");var Ee=document.createElement("label");return Ee.style.marginLeft="4px",Ee.setAttribute("for",W),Ee.innerHTML=Z,le.appendChild(me),le.appendChild(Ee),le},Bt.prototype.createButton_=function(W,Z){var le=document.createElement("button");le.innerHTML=W;var me=le.style;return me.float="right",me.textTransform="uppercase",me.color="#1094f7",me.fontSize="14px",me.letterSpacing=0,me.border=0,me.background="none",me.marginTop="16px",le.addEventListener("click",Z),le};var oi=typeof window<"u"?window:typeof f<"u"?f:typeof self<"u"?self:{};function qt(W){return W&&W.__esModule&&Object.prototype.hasOwnProperty.call(W,"default")?W.default:W}function mt(W,Z){return Z={exports:{}},W(Z,Z.exports),Z.exports}var pi=mt(function(W,Z){(function(me,Ee){W.exports=Ee()})(oi,function(){return function(le){var me={};function Ee(He){if(me[He])return me[He].exports;var q=me[He]={i:He,l:!1,exports:{}};return le[He].call(q.exports,q,q.exports,Ee),q.l=!0,q.exports}return Ee.m=le,Ee.c=me,Ee.d=function(He,q,ie){Ee.o(He,q)||Object.defineProperty(He,q,{configurable:!1,enumerable:!0,get:ie})},Ee.n=function(He){var q=He&&He.__esModule?function(){return He.default}:function(){return He};return Ee.d(q,"a",q),q},Ee.o=function(He,q){return Object.prototype.hasOwnProperty.call(He,q)},Ee.p="",Ee(Ee.s=0)}([function(le,me,Ee){var He=function(){function re(ke,Ze){for(var st=0;st<Ze.length;st++){var dt=Ze[st];dt.enumerable=dt.enumerable||!1,dt.configurable=!0,"value"in dt&&(dt.writable=!0),Object.defineProperty(ke,dt.key,dt)}}return function(ke,Ze,st){return Ze&&re(ke.prototype,Ze),st&&re(ke,st),ke}}();function q(re,ke){if(!(re instanceof ke))throw new TypeError("Cannot call a class as a function")}var ie=Ee(1),ce=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,ne=function(){function re(){q(this,re),ce?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",ie),this.noSleepVideo.addEventListener("timeupdate",(function(ke){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return He(re,[{key:"enable",value:function(){ce?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){ce?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),re}();le.exports=ne},function(le,me,Ee){le.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),Ai=qt(pi),Li=1e3,Mn=[0,0,.5,1],Ki=[.5,0,.5,1],ki=window.requestAnimationFrame,sn=window.cancelAnimationFrame;function Gn(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function cr(W){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:W.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:W.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:W.canPresent},maxLayers:{writable:!1,enumerable:!0,value:W.maxLayers},hasOrientation:{enumerable:!0,get:function(){return cn("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),W.hasOrientation}}})}function Nt(W){W=W||{};var Z="wakelock"in W?W.wakelock:!0;this.isPolyfilled=!0,this.displayId=Li++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return cn("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new cr({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,Z&&Ni()&&(this.wakelock_=new Ai)}Nt.prototype.getFrameData=function(W){return zi(W,this._getPose(),this)},Nt.prototype.getPose=function(){return cn("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Nt.prototype.resetPose=function(){return cn("VRDisplay.prototype.resetPose"),this._resetPose()},Nt.prototype.getImmediatePose=function(){return cn("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Nt.prototype.requestAnimationFrame=function(W){return ki(W)},Nt.prototype.cancelAnimationFrame=function(W){return sn(W)},Nt.prototype.wrapForFullscreen=function(W){if(se())return W;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var Z=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",Z.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==W)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=W,this.originalParent_=W.parentElement,this.originalParent_||document.body.appendChild(W),!this.fullscreenWrapper_.parentElement){var le=this.fullscreenElement_.parentElement;le.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),le.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var me=this;function Ee(){if(me.fullscreenElement_){var He=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];me.fullscreenElement_.setAttribute("style",He.join("; ")+";")}}return Ee(),this.fullscreenWrapper_},Nt.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var W=this.fullscreenElement_;this.fullscreenElementCachedStyle_?W.setAttribute("style",this.fullscreenElementCachedStyle_):W.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var Z=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(W),this.originalParent_===Z?Z.insertBefore(W,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(W),Z.removeChild(this.fullscreenWrapper_),W}},Nt.prototype.requestPresent=function(W){var Z=this.isPresenting,le=this;return W instanceof Array||(cn("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),W=[W]),new Promise(function(me,Ee){if(!le.capabilities.canPresent){Ee(new Error("VRDisplay is not capable of presenting."));return}if(W.length==0||W.length>le.capabilities.maxLayers){Ee(new Error("Invalid number of layers."));return}var He=W[0];if(!He.source){me();return}var q=He.leftBounds||Mn,ie=He.rightBounds||Ki;if(Z){var ce=le.layer_;ce.source!==He.source&&(ce.source=He.source);for(var ne=0;ne<4;ne++)ce.leftBounds[ne]=q[ne],ce.rightBounds[ne]=ie[ne];le.wrapForFullscreen(le.layer_.source),le.updatePresent_(),me();return}if(le.layer_={predistorted:He.predistorted,source:He.source,leftBounds:q.slice(0),rightBounds:ie.slice(0)},le.waitingForPresent_=!1,le.layer_&&le.layer_.source){var re=le.wrapForFullscreen(le.layer_.source),ke=function(){var dt=Vt();le.isPresenting=re===dt,le.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Ot){console.error("screen.orientation.lock() failed due to",Ot.message)}),le.waitingForPresent_=!1,le.beginPresent_(),me()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),le.removeFullscreenWrapper(),le.disableWakeLock(),le.endPresent_(),le.removeFullscreenListeners_()),le.fireVRDisplayPresentChange_()},Ze=function(){le.waitingForPresent_&&(le.removeFullscreenWrapper(),le.removeFullscreenListeners_(),le.disableWakeLock(),le.waitingForPresent_=!1,le.isPresenting=!1,Ee(new Error("Unable to present.")))};le.addFullscreenListeners_(re,ke,Ze),Gt(re)?(le.enableWakeLock(),le.waitingForPresent_=!0):(se()||J())&&(le.enableWakeLock(),le.isPresenting=!0,le.beginPresent_(),le.fireVRDisplayPresentChange_(),me())}!le.waitingForPresent_&&!se()&&(Et(),Ee(new Error("Unable to present.")))})},Nt.prototype.exitPresent=function(){var W=this.isPresenting,Z=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(le,me){W?(!Et()&&se()&&(Z.endPresent_(),Z.fireVRDisplayPresentChange_()),J()&&(Z.removeFullscreenWrapper(),Z.removeFullscreenListeners_(),Z.endPresent_(),Z.fireVRDisplayPresentChange_()),le()):me(new Error("Was not presenting to VRDisplay."))})},Nt.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Nt.prototype.fireVRDisplayPresentChange_=function(){var W=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(W)},Nt.prototype.fireVRDisplayConnect_=function(){var W=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(W)},Nt.prototype.addFullscreenListeners_=function(W,Z,le){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=W,this.fullscreenChangeHandler_=Z,this.fullscreenErrorHandler_=le,Z&&(document.fullscreenEnabled?W.addEventListener("fullscreenchange",Z,!1):document.webkitFullscreenEnabled?W.addEventListener("webkitfullscreenchange",Z,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",Z,!1):document.msFullscreenEnabled&&W.addEventListener("msfullscreenchange",Z,!1)),le&&(document.fullscreenEnabled?W.addEventListener("fullscreenerror",le,!1):document.webkitFullscreenEnabled?W.addEventListener("webkitfullscreenerror",le,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",le,!1):document.msFullscreenEnabled&&W.addEventListener("msfullscreenerror",le,!1))},Nt.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var W=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var Z=this.fullscreenChangeHandler_;W.removeEventListener("fullscreenchange",Z,!1),W.removeEventListener("webkitfullscreenchange",Z,!1),document.removeEventListener("mozfullscreenchange",Z,!1),W.removeEventListener("msfullscreenchange",Z,!1)}if(this.fullscreenErrorHandler_){var le=this.fullscreenErrorHandler_;W.removeEventListener("fullscreenerror",le,!1),W.removeEventListener("webkitfullscreenerror",le,!1),document.removeEventListener("mozfullscreenerror",le,!1),W.removeEventListener("msfullscreenerror",le,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Nt.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Nt.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Nt.prototype.beginPresent_=function(){},Nt.prototype.endPresent_=function(){},Nt.prototype.submitFrame=function(W){},Nt.prototype.getEyeParameters=function(W){return null};var Xi={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},Zn={LEFT:"left",RIGHT:"right"};function hn(W){var Z=Oi({},Xi);W=Oi(Z,W||{}),Nt.call(this,{wakelock:W.MOBILE_WAKE_LOCK}),this.config=W,this.displayName="Cardboard VRDisplay",this.capabilities=new cr({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new we(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Qr(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new mn(this.dpdb_.getDeviceParams(),W.ADDITIONAL_VIEWERS),this.viewerSelector_=new Bt(W.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new Ye),se()&&window.addEventListener("resize",this.onResize_.bind(this))}return hn.prototype=Object.create(Nt.prototype),hn.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},hn.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},hn.prototype._getFieldOfView=function(W){var Z;if(W==Zn.LEFT)Z=this.deviceInfo_.getFieldOfViewLeftEye();else if(W==Zn.RIGHT)Z=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",W),null;return Z},hn.prototype._getEyeOffset=function(W){var Z;if(W==Zn.LEFT)Z=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(W==Zn.RIGHT)Z=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",W),null;return Z},hn.prototype.getEyeParameters=function(W){var Z=this._getEyeOffset(W),le=this._getFieldOfView(W),me={offset:Z,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(me,"fieldOfView",{enumerable:!0,get:function(){return cn("VRFieldOfView","VRFrameData's projection matrices"),le}}),me},hn.prototype.onDeviceParamsUpdated_=function(W){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(W),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},hn.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},hn.prototype.beginPresent_=function(){var W=this.layer_.source.getContext("webgl");W||(W=this.layer_.source.getContext("experimental-webgl")),W||(W=this.layer_.source.getContext("webgl2")),W&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(W.canvas.width=pt()*this.bufferScale_,W.canvas.height=yt()*this.bufferScale_,this.cardboardUI_=new Fe(W)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Fe(W)),this.distorter_=new Tn(W,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(Z){this.viewerSelector_.show(this.layer_.source.parentElement),Z.stopPropagation(),Z.preventDefault()}).bind(this),(function(Z){this.exitPresent(),Z.stopPropagation(),Z.preventDefault()}).bind(this)),this.rotateInstructions_&&(Xe()&&Ni()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},hn.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},hn.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},hn.prototype.submitFrame=function(W){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var Z=this.layer_.source.getContext("webgl");Z||(Z=this.layer_.source.getContext("experimental-webgl")),Z||(Z=this.layer_.source.getContext("webgl2"));var le=Z.canvas;(le.width!=this.lastWidth||le.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=le.width,this.lastHeight=le.height,this.cardboardUI_.render()}},hn.prototype.onOrientationChange_=function(W){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},hn.prototype.onResize_=function(W){if(this.layer_){var Z=this.layer_.source.getContext("webgl");Z||(Z=this.layer_.source.getContext("experimental-webgl")),Z||(Z=this.layer_.source.getContext("webgl2"));var le=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];Z.canvas.setAttribute("style",le.join("; ")+";"),yi(Z.canvas)}},hn.prototype.onViewerChanged_=function(W){this.deviceInfo_.setViewer(W),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},hn.prototype.fireVRDisplayDeviceParamsChange_=function(){var W=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(W)},hn.VRFrameData=Gn,hn.VRDisplay=Nt,hn})}),x=C(b),T="0.10.12",_={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function w(D){this.config=E(E({},_),D),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&g())&&(this.enable(),this.getVRDisplays().then(function(U){U&&U[0]&&U[0].fireVRDisplayConnect_&&U[0].fireVRDisplayConnect_()}))}w.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(g()){var D=new x({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(D)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},w.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var D=this.native.VRFrameData,U=new this.native.VRFrameData,F=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(j){if(j instanceof D){F.call(this,j);return}F.call(this,U),j.pose=U.pose,u(U.leftProjectionMatrix,j.leftProjectionMatrix),u(U.rightProjectionMatrix,j.rightProjectionMatrix),u(U.leftViewMatrix,j.leftViewMatrix),u(U.rightViewMatrix,j.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=x.VRDisplay,window.VRFrameData=x.VRFrameData},w.prototype.getVRDisplays=function(){var D=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(U){return U.length>0?U:D.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},w.version=T,w.VRFrameData=x.VRFrameData,w.VRDisplay=x.VRDisplay;var S=Object.freeze({default:w}),L=S&&w||S;typeof f<"u"&&f.window&&(f.document||(f.document=f.window.document),f.navigator||(f.navigator=f.window.navigator));var P=L;return P})},"./node_modules/word-wrapper/index.js":m=>{var M=/\n/,h=`
`,f=/\s/;m.exports=function(b,x){var T=m.exports.lines(b,x);return T.map(function(_){return b.substring(_.start,_.end)}).join(`
`)},m.exports.lines=function(x,T){if(T=T||{},T.width===0&&T.mode!=="nowrap")return[];x=x||"";var _=typeof T.width=="number"?T.width:Number.MAX_VALUE,w=Math.max(0,T.start||0),S=typeof T.end=="number"?T.end:x.length,L=T.mode,P=T.measure||E;return L==="pre"?g(P,x,w,S,_):u(P,x,w,S,_,L)};function C(b,x,T,_){var w=b.indexOf(x,T);return w===-1||w>_?_:w}function p(b){return f.test(b)}function g(b,x,T,_,w){for(var S=[],L=T,P=T;P<_&&P<x.length;P++){var D=x.charAt(P),U=M.test(D);if(U||P===_-1){var F=U?P:P+1,j=b(x,L,F,w);S.push(j),L=P+1}}return S}function u(b,x,T,_,w,S){var L=[],P=w;for(S==="nowrap"&&(P=Number.MAX_VALUE);T<_&&T<x.length;){for(var D=C(x,h,T,_);T<D&&p(x.charAt(T));)T++;var U=b(x,T,D,P),F=T+(U.end-U.start),j=F+h.length;if(F<D){for(;F>T&&!p(x.charAt(F));)F--;if(F===T)j>T+h.length&&j--,F=j;else for(j=F;F>T&&p(x.charAt(F-h.length));)F--}if(F>=T){var Y=b(x,T,F,P);L.push(Y)}T=j}return L}function E(b,x,T,_){var w=Math.min(_,T-x);return{start:x,end:x+w}}},"./node_modules/xhr/index.js":(m,M,h)=>{var f=h("./node_modules/global/window.js"),C=h("./node_modules/is-function/index.js"),p=h("./node_modules/parse-headers/parse-headers.js"),g=h("./node_modules/xtend/immutable.js");m.exports=x,m.exports.default=x,x.XMLHttpRequest=f.XMLHttpRequest||w,x.XDomainRequest="withCredentials"in new x.XMLHttpRequest?x.XMLHttpRequest:f.XDomainRequest,u(["get","put","post","patch","head","delete"],function(S){x[S==="delete"?"del":S]=function(L,P,D){return P=b(L,P,D),P.method=S.toUpperCase(),T(P)}});function u(S,L){for(var P=0;P<S.length;P++)L(S[P])}function E(S){for(var L in S)if(S.hasOwnProperty(L))return!1;return!0}function b(S,L,P){var D=S;return C(L)?(P=L,typeof S=="string"&&(D={uri:S})):D=g(L,{uri:S}),D.callback=P,D}function x(S,L,P){return L=b(S,L,P),T(L)}function T(S){if(typeof S.callback>"u")throw new Error("callback argument missing");var L=!1,P=function(Ge,Xe,Je){L||(L=!0,S.callback(Ge,Xe,Je))};function D(){Y.readyState===4&&setTimeout(j,0)}function U(){var De=void 0;if(Y.response?De=Y.response:De=Y.responseText||_(Y),ae)try{De=JSON.parse(De)}catch{}return De}function F(De){return clearTimeout(ue),De instanceof Error||(De=new Error(""+(De||"Unknown XMLHttpRequest Error"))),De.statusCode=0,P(De,Me)}function j(){if(!te){var De;clearTimeout(ue),S.useXDR&&Y.status===void 0?De=200:De=Y.status===1223?204:Y.status;var Ge=Me,Xe=null;return De!==0?(Ge={body:U(),statusCode:De,method:de,headers:{},url:pe,rawRequest:Y},Y.getAllResponseHeaders&&(Ge.headers=p(Y.getAllResponseHeaders()))):Xe=new Error("Internal XMLHttpRequest Error"),P(Xe,Ge,Ge.body)}}var Y=S.xhr||null;Y||(S.cors||S.useXDR?Y=new x.XDomainRequest:Y=new x.XMLHttpRequest);var oe,te,pe=Y.url=S.uri||S.url,de=Y.method=S.method||"GET",se=S.body||S.data,J=Y.headers=S.headers||{},H=!!S.sync,ae=!1,ue,Me={body:void 0,headers:{},statusCode:0,method:de,url:pe,rawRequest:Y};if("json"in S&&S.json!==!1&&(ae=!0,J.accept||J.Accept||(J.Accept="application/json"),de!=="GET"&&de!=="HEAD"&&(J["content-type"]||J["Content-Type"]||(J["Content-Type"]="application/json"),se=JSON.stringify(S.json===!0?se:S.json))),Y.onreadystatechange=D,Y.onload=j,Y.onerror=F,Y.onprogress=function(){},Y.onabort=function(){te=!0},Y.ontimeout=F,Y.open(de,pe,!H,S.username,S.password),H||(Y.withCredentials=!!S.withCredentials),!H&&S.timeout>0&&(ue=setTimeout(function(){if(!te){te=!0,Y.abort("timeout");var De=new Error("XMLHttpRequest timeout");De.code="ETIMEDOUT",F(De)}},S.timeout)),Y.setRequestHeader)for(oe in J)J.hasOwnProperty(oe)&&Y.setRequestHeader(oe,J[oe]);else if(S.headers&&!E(S.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in S&&(Y.responseType=S.responseType),"beforeSend"in S&&typeof S.beforeSend=="function"&&S.beforeSend(Y),Y.send(se||null),Y}function _(S){try{if(S.responseType==="document")return S.responseXML;var L=S.responseXML&&S.responseXML.documentElement.nodeName==="parsererror";if(S.responseType===""&&!L)return S.responseXML}catch{}return null}function w(){}},"./node_modules/xml-parse-from-string/index.js":m=>{m.exports=function(){return typeof self.DOMParser<"u"?function(h){var f=new self.DOMParser;return f.parseFromString(h,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(h){var f=new self.ActiveXObject("Microsoft.XMLDOM");return f.async="false",f.loadXML(h),f}:function(h){var f=document.createElement("div");return f.innerHTML=h,f}}()},"./node_modules/xtend/immutable.js":m=>{m.exports=h;var M=Object.prototype.hasOwnProperty;function h(){for(var f={},C=0;C<arguments.length;C++){var p=arguments[C];for(var g in p)M.call(p,g)&&(f[g]=p[g])}return f}},"./src/components/anchored.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/index.js"),p=C.debug("components:anchored:warn");m.exports.Component=f("anchored",{schema:{persistent:{default:!1}},init:function(){var u=this.el.sceneEl,E=u.getAttribute("webxr"),b=E.optionalFeatures;b.indexOf("anchors")===-1&&(b.push("anchors"),this.el.sceneEl.setAttribute("webxr",E)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var u=this.el.sceneEl,E=u.renderer.xr,b,x,T,_=this.el.object3D;!u.is("ar-mode")&&!u.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),this.anchor&&(b=u.frame,x=E.getReferenceSpace(),T=b.getPose(this.anchor.anchorSpace,x),_.matrix.elements=T.transform.matrix,_.matrix.decompose(_.position,_.rotation,_.scale)))},createAnchor:async function(E,b){var x=this.el.sceneEl,T=x.renderer.xr,_,w,S,L,P=this.el.object3D;if(E=E||P.position,b=b||this.auxQuaternion.setFromEuler(P.rotation),!g(x)){p("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),_=x.frame,w=T.getReferenceSpace(),S=new XRRigidTransform({x:E.x,y:E.y,z:E.z},{x:b.x,y:b.y,z:b.z,w:b.w}),this.requestAnchorPending=!1,L=await _.createAnchor(S,w),this.data.persistent&&(this.el.id?(this.persistentHandle=await L.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):p("The anchor won't be persisted because the entity has no assigned id.")),x.object3D.attach(this.el.object3D),this.anchor=L},restorePersistentAnchor:async function(){var E=this.el.sceneEl.renderer.xr,b=E.getSession(),x=b.persistentAnchors,T;if(this.requestPersistentAnchorPending=!1,!this.el.id){p("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(x){T=localStorage.getItem(this.el.id);for(var _=0;_<x.length;++_)if(T===x[_]){this.anchor=await b.restorePersistentAnchor(x[_]),this.anchor&&(this.persistentHandle=x[_]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0},deleteAnchor:function(){var u,E,b=this.anchor;b&&(u=this.el.sceneEl.renderer.xr,E=u.getSession(),b.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&E.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function g(u){var E=u.renderer.xr,b=E.getSession();return b&&b.restorePersistentAnchor}},"./src/components/animation.js":(m,M,h)=>{var f=h("./node_modules/super-animejs/lib/anime.es.js").default,C=h("./src/core/component.js").components,p=h("./src/core/component.js").registerComponent,g=h("./src/lib/three.js"),u=h("./src/utils/index.js"),E=new g.Color,b=new g.Color,x=u.entity.getComponentProperty,T=u.entity.setComponentProperty,_={},w="color",S="position",L="rotation",P="scale",D="components",U="object3D";m.exports.Component=p("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(J){return J===!0||J==="true"?!0:J===!1||J==="false"?!1:parseInt(J,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var J=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){J.animationIsPlaying=!1,J.el.emit("animationcomplete",J.eventDetail,!1),J.id&&J.el.emit("animationcomplete__"+J.id,J.eventDetail,!1)}}},update:function(J){var H=this.config,ae=this.data;this.animationIsPlaying=!1,this.data.enabled&&ae.property&&(H.autoplay=!1,H.direction=ae.dir,H.duration=ae.dur,H.easing=ae.easing,H.elasticity=ae.elasticity,H.loop=ae.loop,H.round=ae.round,this.createAndStartAnimation())},tick:function(J,H){this.animationIsPlaying&&(this.time+=H,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var J=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=f(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!J.autoplay||J.startEvents&&J.startEvents.length)){if(J.delay){setTimeout(this.beginAnimation,J.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=f(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var J=this.config,H=this.data,ae=this.el,ue,Me,De;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){ue=H.from===""?te(ae,H.property):H.from,De=H.to,this.setColorConfig(ue,De),ue=this.fromColor,De=this.toColor,this.targetsArray.length=0,this.targetsArray.push(ue),J.targets=this.targetsArray;for(Me in De)J[Me]=De[Me];J.update=function(){var Ge={};return function(Xe){var Je;Je=Xe.animatables[0].target,!(Je.r===Ge.r&&Je.g===Ge.g&&Je.b===Ge.b)&&pe(ae,H.property,Je,H.type)}}()}},updateConfigForDefault:function(){var J=this.config,H=this.data,ae=this.el,ue,Me,De,Ge;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(H.from===""?ue=se(H)?te(ae,H.property):x(ae,H.property):ue=H.from,Ge=H.to,De=!isNaN(ue||Ge),De?(ue=parseFloat(ue),Ge=parseFloat(Ge)):(ue=ue&&ue.toString(),Ge=Ge&&Ge.toString()),Me=H.to==="true"||H.to==="false"||H.to===!0||H.to===!1,Me&&(ue=H.from==="true"||H.from===!0?1:0,Ge=H.to==="true"||H.to===!0?1:0),this.targets.aframeProperty=ue,J.targets=this.targets,J.aframeProperty=Ge,J.update=function(){var Xe;return function(Je){var pt;pt=Je.animatables[0].target.aframeProperty,pt!==Xe&&(Xe=pt,Me&&(pt=pt>=1),se(H)?pe(ae,H.property,pt,H.type):T(ae,H.property,pt))}}())},updateConfigForVector:function(){var J=this.config,H=this.data,ae=this.el,ue,Me,De;Me=H.from!==""?u.coordinates.parse(H.from):x(ae,H.property),De=u.coordinates.parse(H.to),H.property===L&&(j(Me),j(De)),this.targetsArray.length=0,this.targetsArray.push(Me),J.targets=this.targetsArray;for(ue in De)J[ue]=De[ue];if(H.property===S||H.property===L||H.property===P){J.update=function(){var Ge={};return function(Xe){var Je=Xe.animatables[0].target;Je.x===Ge.x&&Je.y===Ge.y&&Je.z===Ge.z||(Ge.x=Je.x,Ge.y=Je.y,Ge.z=Je.z,ae.object3D[H.property].set(Je.x,Je.y,Je.z))}}();return}J.update=function(){var Ge={};return function(Xe){var Je=Xe.animatables[0].target;Je.x===Ge.x&&Je.y===Ge.y&&Je.z===Ge.z||(Ge.x=Je.x,Ge.y=Je.y,Ge.z=Je.z,T(ae,H.property,Je))}}()},updateConfig:function(){var J;J=F(this.el,this.data.property),se(this.data)&&this.data.type===w?this.updateConfigForRawColor():J==="vec2"||J==="vec3"||J==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(J){var H,ae=this.data,ue=this.el,Me=this;return ae.from!==""||!ae.property.startsWith(D)||(H=de(ae.property)[1],ue.components[H])?!1:(ue.addEventListener("componentinitialized",function De(Ge){Ge.detail.name===H&&(J(),Me.animation=f(Me.config),ue.removeEventListener("componentinitialized",De))}),!0)},stopRelatedAnimations:function(){var J,H;for(H in this.el.components)J=this.el.components[H],H!==this.attrName&&J.name==="animation"&&J.animationIsPlaying&&J.data.property===this.data.property&&(J.animationIsPlaying=!1)},addEventListeners:function(){var J=this.data,H=this.el;Y(H,J.startEvents,this.onStartEvent),Y(H,J.pauseEvents,this.pauseAnimation),Y(H,J.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var J=this.data,H=this.el;oe(H,J.startEvents,this.onStartEvent),oe(H,J.pauseEvents,this.pauseAnimation),oe(H,J.resumeEvents,this.resumeAnimation)},setColorConfig:function(J,H){E.set(J),b.set(H),J=this.fromColor,H=this.toColor,J.r=E.r,J.g=E.g,J.b=E.b,H.r=b.r,H.g=b.g,H.b=b.b}});function F(J,H){var ae,ue,Me,De;return Me=H.split("."),ue=Me[0],De=Me[1],ae=J.components[ue]||C[ue],!ae||De&&!ae.schema[De]?null:De?ae.schema[De].type:ae.schema.type}function j(J){J.x=g.MathUtils.degToRad(J.x),J.y=g.MathUtils.degToRad(J.y),J.z=g.MathUtils.degToRad(J.z)}function Y(J,H,ae){var ue;for(ue=0;ue<H.length;ue++)J.addEventListener(H[ue],ae)}function oe(J,H,ae){var ue;for(ue=0;ue<H.length;ue++)J.removeEventListener(H[ue],ae)}function te(J,H){var ae,ue,Me;for(ue=de(H),Me=J,ae=0;ae<ue.length;ae++)Me=Me[ue[ae]];if(Me===void 0)throw console.log(J),new Error("[animation] property ("+H+") could not be found");return Me}function pe(J,H,ae,ue){var Me,De,Ge,Xe;for(H.startsWith("object3D.rotation")&&(ae=g.MathUtils.degToRad(ae)),De=de(H),Xe=J,Me=0;Me<De.length-1;Me++)Xe=Xe[De[Me]];if(Ge=De[De.length-1],ue===w){"r"in Xe[Ge]?(Xe[Ge].r=ae.r,Xe[Ge].g=ae.g,Xe[Ge].b=ae.b):(Xe[Ge].x=ae.r,Xe[Ge].y=ae.g,Xe[Ge].z=ae.b);return}Xe[Ge]=ae}function de(J){return J in _||(_[J]=J.split(".")),_[J]}function se(J){return J.isRawProperty||J.property.startsWith(D)||J.property.startsWith(U)}},"./src/components/camera.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js");m.exports.Component=f("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var p,g=this.el;p=this.camera=new C.PerspectiveCamera,g.setObject3D("camera",p)},update:function(p){var g=this.data,u=this.camera;u.aspect=g.aspect||window.innerWidth/window.innerHeight,u.far=g.far,u.fov=g.fov,u.near=g.near,u.zoom=g.zoom,u.updateProjectionMatrix(),this.updateActiveCamera(p),this.updateSpectatorCamera(p)},updateActiveCamera:function(p){var g=this.data,u=this.el,E=this.system;p&&p.active===g.active||g.spectator||(g.active&&E.activeCameraEl!==u?E.setActiveCamera(u):!g.active&&E.activeCameraEl===u&&E.disableActiveCamera())},updateSpectatorCamera:function(p){var g=this.data,u=this.el,E=this.system;p&&p.spectator===g.spectator||(g.spectator&&E.spectatorCameraEl!==u?E.setSpectatorCamera(u):!g.spectator&&E.spectatorCameraEl===u&&E.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/index.js"),p={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},g={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},u={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},E={DOWN:["selectstart"],UP:["selectend"]},b="a-mouse-cursor-hover";m.exports.Component=f("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:C.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},after:["tracked-controls"],multiple:!0,init:function(){var x=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=C.debounce(function(){x.canvasBounds=x.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=this.onCursorDown.bind(this),this.onCursorUp=this.onCursorUp.bind(this),this.onIntersection=this.onIntersection.bind(this),this.onIntersectionCleared=this.onIntersectionCleared.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},update:function(x){this.data.rayOrigin!==x.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var x=this.el.sceneEl.frame,T=this.activeXRInput;this.data.rayOrigin==="xrselect"&&x&&T&&this.onMouseMove({frame:x,inputSource:T,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var x=this.el;x.removeState(g.HOVERING),x.removeState(g.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(g.HOVERED),this.removeEventListeners()},addEventListeners:function(){var x,T=this.data,_=this.el,w=this;function S(){x=_.sceneEl.canvas,!(T.downEvents.length||T.upEvents.length)&&(u.DOWN.forEach(function(L){x.addEventListener(L,w.onCursorDown,{passive:!1})}),u.UP.forEach(function(L){x.addEventListener(L,w.onCursorUp,{passive:!1})}))}x=_.sceneEl.canvas,x?S():_.sceneEl.addEventListener("render-target-loaded",S),T.downEvents.forEach(function(L){_.addEventListener(L,w.onCursorDown)}),T.upEvents.forEach(function(L){_.addEventListener(L,w.onCursorUp)}),_.addEventListener("raycaster-intersection",this.onIntersection),_.addEventListener("raycaster-closest-entity-changed",this.onIntersection),_.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),_.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),_.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var x,T=this.data,_=this.el,w=this;x=_.sceneEl.canvas,x&&!T.downEvents.length&&!T.upEvents.length&&(u.DOWN.forEach(function(S){x.removeEventListener(S,w.onCursorDown)}),u.UP.forEach(function(S){x.removeEventListener(S,w.onCursorUp)})),T.downEvents.forEach(function(S){_.removeEventListener(S,w.onCursorDown)}),T.upEvents.forEach(function(S){_.removeEventListener(S,w.onCursorUp)}),_.removeEventListener("raycaster-intersection",this.onIntersection),_.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),x.removeEventListener("mousemove",this.onMouseMove),x.removeEventListener("touchstart",this.onMouseMove),x.removeEventListener("touchmove",this.onMouseMove),_.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),_.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var x,T=this.el;x=T.sceneEl.canvas,x.removeEventListener("mousemove",this.onMouseMove),x.removeEventListener("touchmove",this.onMouseMove),T.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(x.addEventListener("mousemove",this.onMouseMove),x.addEventListener("touchmove",this.onMouseMove,{passive:!1}),T.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var x=new THREE.Vector3,T=new THREE.Vector2,_=new THREE.Vector3,w={origin:_,direction:x};return function(S){var L=this.canvasBounds,P=this.el.sceneEl.camera,D,U,F,j,Y,oe,te,pe;P.parent.updateMatrixWorld(),S.type==="touchmove"||S.type==="touchstart"?U=S.touches.item(0):U=S,D=U.clientX-L.left,F=U.clientY-L.top,T.x=D/L.width*2-1,T.y=-(F/L.height)*2+1,this.data.rayOrigin==="xrselect"&&(S.type==="selectstart"||S.type==="fakeselectevent")?(j=S.frame,Y=S.inputSource,oe=this.el.renderer.xr.getReferenceSpace(),te=j.getPose(Y.targetRaySpace,oe),pe=te.transform,x.set(0,0,-1),x.applyQuaternion(pe.orientation),_.copy(pe.position)):S.type==="fakeselectout"?(x.set(0,1,0),_.set(0,9999,0)):P&&P.isPerspectiveCamera?(_.setFromMatrixPosition(P.matrixWorld),x.set(T.x,T.y,.5).unproject(P).sub(_).normalize()):P&&P.isOrthographicCamera?(_.set(T.x,T.y,(P.near+P.far)/(P.near-P.far)).unproject(P),x.set(0,0,-1).transformDirection(P.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+P.type),this.el.setAttribute("raycaster",w),S.type==="touchmove"&&S.preventDefault()}}(),onCursorDown:function(x){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&x.type==="touchstart"&&(this.onMouseMove(x),this.el.components.raycaster.checkIntersections(),x.preventDefault()),this.data.rayOrigin==="xrselect"&&x.type==="selectstart"&&(this.activeXRInput=x.inputSource,this.onMouseMove(x),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(p.MOUSEDOWN,x),this.cursorDownEl=this.intersectedEl},onCursorUp:function(x){if(this.isCursorDown){this.isCursorDown=!1;var T=this.data;this.twoWayEmit(p.MOUSEUP,x),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(p.MOUSEUP,this.intersectedEventDetail)),(!T.fuse||T.rayOrigin==="mouse"||T.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(p.CLICK,x),T.rayOrigin==="xrselect"&&this.activeXRInput===x.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,x.type==="touchend"&&x.preventDefault()}},onIntersection:function(x){var T,_=this.el,w,S,L;w=x.detail.els[0]===_?1:0,L=x.detail.intersections[w],S=x.detail.els[w],S&&this.intersectedEl!==S&&(this.intersectedEl&&(T=this.el.components.raycaster.getIntersection(this.intersectedEl),T&&T.distance<=L.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(S,L)))},onIntersectionCleared:function(x){var T=x.detail.clearedEls;T.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var x=this.el.sceneEl.xrSession,T=this;x&&this.data.rayOrigin!=="mouse"&&(E.DOWN.forEach(function(_){x.addEventListener(_,T.onCursorDown)}),E.UP.forEach(function(_){x.addEventListener(_,T.onCursorUp)}))},setIntersection:function(x,T){var _=this.el,w=this.data,S=this;this.intersectedEl!==x&&(this.intersectedEl=x,_.addState(g.HOVERING),x.addState(g.HOVERED),this.twoWayEmit(p.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(b),!(w.fuseTimeout===0||!w.fuse||w.rayOrigin==="xrselect"||w.rayOrigin==="mouse")&&(_.addState(g.FUSING),this.twoWayEmit(p.FUSING),this.fuseTimeout=setTimeout(function(){_.removeState(g.FUSING),S.twoWayEmit(p.CLICK)},w.fuseTimeout)))},clearCurrentIntersection:function(x){var T,_,w,S=this.el;this.intersectedEl&&(this.intersectedEl.removeState(g.HOVERED),S.removeState(g.HOVERING),S.removeState(g.FUSING),this.twoWayEmit(p.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(b),this.intersectedEl=null,clearTimeout(this.fuseTimeout),x!==!0&&(w=this.el.components.raycaster.intersections,w.length!==0&&(T=w[0].object.el===S?1:0,_=w[T],_&&this.setIntersection(_.object.el,_))))},twoWayEmit:function(x,T){var _=this.el,w=this.intersectedEl,S;function L(P,D){T instanceof MouseEvent?P.mouseEvent=T:typeof TouchEvent<"u"&&T instanceof TouchEvent&&(P.touchEvent=T)}S=this.el.components.raycaster.getIntersection(w),this.eventDetail.intersectedEl=w,this.eventDetail.intersection=S,L(this.eventDetail),_.emit(x,this.eventDetail),w&&(this.intersectedEventDetail.intersection=S,L(this.intersectedEventDetail),w.emit(x,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/tracked-controls.js"),p=C.checkControllerPresentAndSetup,g=C.emitIfAxesChanged,u=C.onButtonEvent,E="generic",b={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};m.exports.Component=f("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},after:["tracked-controls"],mapping:b,bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var x=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(T){u(T.detail.id,"down",x)},this.onButtonUp=function(T){u(T.detail.id,"up",x)},this.onButtonTouchStart=function(T){u(T.detail.id,"touchstart",x)},this.onButtonTouchEnd=function(T){u(T.detail.id,"touchend",x)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(T){T.detail.name!==x.name&&(x.wasControllerConnected=!0,x.removeEventListeners(),x.removeControllersUpdateListener())})},addEventListeners:function(){var x=this.el;x.addEventListener("buttonchanged",this.onButtonChanged),x.addEventListener("buttondown",this.onButtonDown),x.addEventListener("buttonup",this.onButtonUp),x.addEventListener("touchstart",this.onButtonTouchStart),x.addEventListener("touchend",this.onButtonTouchEnd),x.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var x=this.el;x.removeEventListener("buttonchanged",this.onButtonChanged),x.removeEventListener("buttondown",this.onButtonDown),x.removeEventListener("buttonup",this.onButtonUp),x.removeEventListener("touchstart",this.onButtonTouchStart),x.removeEventListener("touchend",this.onButtonTouchEnd),x.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var x=this.data,T=x.hand?x.hand:void 0;p(this,E,{hand:T,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var x=this.el,T=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}x.setAttribute("tracked-controls",{hand:T.hand,idPrefix:E,orientationOffset:T.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(x){var T=this.mapping.buttons[x.detail.id];T&&this.el.emit(T+"changed",x.detail.state)},onAxisMoved:function(x){g(this,this.mapping.axes,x)},initDefaultModel:function(){var x=this.modelEl=document.createElement("a-entity");x.setAttribute("geometry",{primitive:"sphere",radius:.03}),x.setAttribute("material",{color:this.data.color}),this.el.appendChild(x),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(m,M,h)=>{var f=h("./src/core/geometry.js").geometries,C=h("./src/core/geometry.js").geometryNames,p=h("./src/core/component.js").registerComponent,g=h("./src/lib/three.js"),u=new g.BufferGeometry;m.exports.Component=p("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:C,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(E){var b=this.data,x=this.el,T,_=this.system;this.geometry&&(_.unuseGeometry(E),this.geometry=null),this.geometry=_.getOrCreateGeometry(b),T=x.getObject3D("mesh"),T?T.geometry=this.geometry:(T=new g.Mesh,T.geometry=this.geometry,this.el.getAttribute("material")||(T.material=new g.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),x.setObject3D("mesh",T))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=u,this.geometry=null},updateSchema:function(E){var b=this.oldData&&this.oldData.primitive,x=E.primitive,T=f[x]&&f[x].schema;if(!T)throw new Error("Unknown geometry schema `"+x+"`");b&&b===x||this.extendSchema(T)}})},"./src/components/gltf-model.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/index.js"),g=p.debug("components:gltf-model:warn");m.exports.Component=f("gltf-model",{schema:{type:"model"},init:function(){var u=this,E=this.system.getDRACOLoader(),b=this.system.getMeshoptDecoder(),x=this.system.getKTX2Loader();this.model=null,this.loader=new C.GLTFLoader,E&&this.loader.setDRACOLoader(E),b?this.ready=b.then(function(T){u.loader.setMeshoptDecoder(T)}):this.ready=Promise.resolve(),x&&this.loader.setKTX2Loader(x)},update:function(){var u=this,E=this.el,b=this.data;b&&(this.remove(),this.ready.then(function(){u.loader.load(b,function(T){u.model=T.scene||T.scenes[0],u.model.animations=T.animations,E.setObject3D("mesh",u.model),E.emit("model-loaded",{format:"gltf",model:u.model})},void 0,function(T){var _=T&&T.message?T.message:"Failed to load glTF model";g(_),E.emit("model-error",{format:"gltf",src:b})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;f("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/constants/index.js").AFRAME_CDN_ROOT,p={toonLeft:C+"controllers/hands/leftHand.glb",toonRight:C+"controllers/hands/rightHand.glb",lowPolyLeft:C+"controllers/hands/leftHandLow.glb",lowPolyRight:C+"controllers/hands/rightHandLow.glb",highPolyLeft:C+"controllers/hands/leftHandHigh.glb",highPolyRight:C+"controllers/hands/rightHandHigh.glb"},g={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},u={};u[g.fist]="grip",u[g.thumbUp]="pistol",u[g.point]="pointing",m.exports.Component=f("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},after:["tracked-controls"],init:function(){var x=this,T=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){x.handleButton("grip","down")},this.onGripUp=function(){x.handleButton("grip","up")},this.onTrackpadDown=function(){x.handleButton("trackpad","down")},this.onTrackpadUp=function(){x.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){x.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){x.handleButton("trackpad","touchend")},this.onTriggerDown=function(){x.handleButton("trigger","down")},this.onTriggerUp=function(){x.handleButton("trigger","up")},this.onTriggerTouchStart=function(){x.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){x.handleButton("trigger","touchend")},this.onGripTouchStart=function(){x.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){x.handleButton("grip","touchend")},this.onThumbstickDown=function(){x.handleButton("thumbstick","down")},this.onThumbstickUp=function(){x.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){x.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){x.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){x.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){x.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){x.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){x.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),T.addEventListener("controllerconnected",this.onControllerConnected),T.addEventListener("controllerdisconnected",this.onControllerDisconnected),T.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(x,T){var _=this.el.getObject3D("mesh");!_||!_.mixer||_.mixer.update(T/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var x=this.el;x.addEventListener("gripdown",this.onGripDown),x.addEventListener("gripup",this.onGripUp),x.addEventListener("trackpaddown",this.onTrackpadDown),x.addEventListener("trackpadup",this.onTrackpadUp),x.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),x.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),x.addEventListener("triggerdown",this.onTriggerDown),x.addEventListener("triggerup",this.onTriggerUp),x.addEventListener("triggertouchstart",this.onTriggerTouchStart),x.addEventListener("triggertouchend",this.onTriggerTouchEnd),x.addEventListener("griptouchstart",this.onGripTouchStart),x.addEventListener("griptouchend",this.onGripTouchEnd),x.addEventListener("thumbstickdown",this.onThumbstickDown),x.addEventListener("thumbstickup",this.onThumbstickUp),x.addEventListener("abuttontouchstart",this.onAorXTouchStart),x.addEventListener("abuttontouchend",this.onAorXTouchEnd),x.addEventListener("bbuttontouchstart",this.onBorYTouchStart),x.addEventListener("bbuttontouchend",this.onBorYTouchEnd),x.addEventListener("xbuttontouchstart",this.onAorXTouchStart),x.addEventListener("xbuttontouchend",this.onAorXTouchEnd),x.addEventListener("ybuttontouchstart",this.onBorYTouchStart),x.addEventListener("ybuttontouchend",this.onBorYTouchEnd),x.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),x.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var x=this.el;x.removeEventListener("gripdown",this.onGripDown),x.removeEventListener("gripup",this.onGripUp),x.removeEventListener("trackpaddown",this.onTrackpadDown),x.removeEventListener("trackpadup",this.onTrackpadUp),x.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),x.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),x.removeEventListener("triggerdown",this.onTriggerDown),x.removeEventListener("triggerup",this.onTriggerUp),x.removeEventListener("triggertouchstart",this.onTriggerTouchStart),x.removeEventListener("triggertouchend",this.onTriggerTouchEnd),x.removeEventListener("griptouchstart",this.onGripTouchStart),x.removeEventListener("griptouchend",this.onGripTouchEnd),x.removeEventListener("thumbstickdown",this.onThumbstickDown),x.removeEventListener("thumbstickup",this.onThumbstickUp),x.removeEventListener("abuttontouchstart",this.onAorXTouchStart),x.removeEventListener("abuttontouchend",this.onAorXTouchEnd),x.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),x.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),x.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),x.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),x.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),x.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),x.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),x.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(x){var T,_=this.el,w=this.data.hand,S=this.data.handModelStyle,L=this.data.color,P=this;if(T={hand:w,model:!1},w!==x){var D=p[S+w.charAt(0).toUpperCase()+w.slice(1)];this.loader.load(D,function(U){var F=U.scene.children[0],j=w==="left"?Math.PI/2:-Math.PI/2,Y=_.sceneEl.hasWebXR?-Math.PI/2:0;F.mixer=new THREE.AnimationMixer(F),P.clips=U.animations,_.setObject3D("mesh",F),F.traverse(function(oe){oe.isMesh&&(oe.material.color=new THREE.Color(L))}),F.position.set(0,0,0),F.rotation.set(Y,0,j),_.setAttribute("magicleap-controls",T),_.setAttribute("vive-controls",T),_.setAttribute("oculus-touch-controls",T),_.setAttribute("pico-controls",T),_.setAttribute("windows-motion-controls",T),_.setAttribute("hp-mixed-reality-controls",T)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(x,T){var _,w=T==="down",S=T==="touchstart";if(T.indexOf("touch")===0){if(S===this.touchedButtons[x])return;this.touchedButtons[x]=S}else{if(w===this.pressedButtons[x])return;this.pressedButtons[x]=w}_=this.gesture,this.gesture=this.determineGesture(),this.gesture!==_&&(this.animateGesture(this.gesture,_),this.emitGestureEvents(this.gesture,_))},determineGesture:function(){var x,T=this.pressedButtons.grip,_=this.pressedButtons.surface||this.touchedButtons.surface,w=this.pressedButtons.trackpad||this.touchedButtons.trackpad,S=this.pressedButtons.trigger||this.touchedButtons.trigger,L=this.touchedButtons.AorX||this.touchedButtons.BorY,P=b(this.el.components["tracked-controls"]);return P?T||S?x=g.fist:w&&(x=g.point):T?_||L||w?x=S?g.fist:g.point:x=S?g.thumbUp:g.pointThumb:S&&(x=g.hold),x},getClip:function(x){var T,_;for(_=0;_<this.clips.length;_++)if(T=this.clips[_],T.name===x)return T},animateGesture:function(x,T){if(x){this.playAnimation(x||g.open,T,!1);return}this.playAnimation(T,T,!0)},emitGestureEvents:function(x,T){var _=this.el,w;T!==x&&(w=E(T,!1),w&&_.emit(w),w=E(x,!0),w&&_.emit(w))},playAnimation:function(x,T,_){var w,S,L=this.el.getObject3D("mesh"),P;if(L){if(w=this.getClip(x),P=L.mixer.clipAction(w),_){P.paused=!1,P.timeScale=-1;return}if(P.clampWhenFinished=!0,P.loop=THREE.LoopOnce,P.repetitions=0,P.timeScale=1,P.time=0,P.weight=1,!T){L.mixer.stopAllAction(),P.play();return}w=this.getClip(T),P.reset(),P.play(),S=L.mixer.clipAction(w),S.crossFadeTo(P,.15,!0)}}});function E(x,T){var _;if(x){if(_=u[x],_==="grip")return _+(T?"close":"open");if(_==="point")return _+(T?"up":"down");if(_==="pointing"||_==="pistol")return _+(T?"start":"end")}}function b(x){var T=x&&x.controller,_=T&&(T.id&&T.id.indexOf("OpenVR ")===0||T.profiles&&T.profiles[0]&&T.profiles[0]==="htc-vive");return _}},"./src/components/hand-tracking-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/core/a-entity.js").AEntity,p=h("./src/utils/tracked-controls.js"),g=p.checkControllerPresentAndSetup,u=h("./src/constants/index.js").AFRAME_CDN_ROOT,E=u+"controllers/oculus-hands/v4/left.glb",b=u+"controllers/oculus-hands/v4/right.glb",x=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],T=0,_=4,w=9,S=.015,L=.1;m.exports.Component=f("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"},modelOpacity:{default:1}},after:["tracked-controls"],bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var P=0;P<this.jointEls.length;++P)this.jointEls[P].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var P=0;P<this.jointEls.length;++P)this.jointEls[P].object3D.visible=!1},init:function(){var P=this.el.sceneEl,D=P.getAttribute("webxr"),U=D.optionalFeatures;U.indexOf("hand-tracking")===-1&&(U.push("hand-tracking"),P.setAttribute("webxr",D)),this.wristObject3D=new THREE.Object3D,this.el.sceneEl.object3D.add(this.wristObject3D),this.onModelLoaded=this.onModelLoaded.bind(this),this.onChildAttached=this.onChildAttached.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*x.length),this.jointRadii=new Float32Array(x.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace),this.el.addEventListener("child-attached",this.onChildAttached),this.el.object3D.visible=!1,this.wristObject3D.visible=!1},onChildAttached:function(P){this.addChildEntity(P.detail.el)},update:function(){this.updateModelMaterial()},updateModelMaterial:function(){var P=this.jointEls,D=this.skinnedMesh,U=this.data.modelOpacity!==1;D&&(this.skinnedMesh.material.color.set(this.data.modelColor),this.skinnedMesh.material.transparent=U,this.skinnedMesh.material.opacity=this.data.modelOpacity);for(var F=0;F<P.length;F++)P[F].setAttribute("material",{color:this.data.modelColor,transparent:U,opacity:this.data.modelOpacity})},updateReferenceSpace:function(){var P=this,D=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!D){var U=P.el.sceneEl.systems.webxr.sessionReferenceSpaceType;D.requestReferenceSpace(U).then(function(F){P.referenceSpace=F}).catch(function(F){throw P.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(U,"tracked-controls-webxr uses reference space "+U),F})}},checkIfControllerPresent:function(){var P=this.data,D=P.hand?P.hand:void 0;g(this,"",{hand:D,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var P=this.el.sceneEl,D=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,U=P.frame,F=this.el.components["tracked-controls-webxr"],j=this.referenceSpace;!D||!U||!j||!F||(this.hasPoses=!1,D.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=U.fillPoses(D.hand.values(),j,this.jointPoses)&&U.fillJointRadii(D.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture(),this.updateWristObject()))},updateWristObject:function(){var P=new THREE.Matrix4;return function(){var D=this.wristObject3D;!D||!this.hasPoses||(P.fromArray(this.jointPoses,T*16),D.position.setFromMatrixPosition(P),D.quaternion.setFromRotationMatrix(P))}}(),updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(P){for(var D=this.bones,U=0;U<D.length;U++)if(D[U].name===P)return D[U];return null},updateHandMeshModel:function(){var P=new THREE.Matrix4;return function(){var D=0,U=this.jointPoses,F=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!F||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var j of F.hand.values()){var Y=this.getBone(j.jointName);Y!=null&&(this.mesh.visible=!0,P.fromArray(U,D*16),Y.position.setFromMatrixPosition(P),Y.quaternion.setFromRotationMatrix(P)),D++}}}(),updateHandDotsModel:function(){for(var P=this.jointPoses,D=this.jointRadii,U=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,F,j,Y=0;Y<U.hand.size;Y++)F=this.jointEls[Y],j=F.object3D,F.object3D.visible=this.hasPoses,this.hasPoses&&(j.matrix.fromArray(P,Y*16),j.matrix.decompose(j.position,j.rotation,j.scale),F.setAttribute("scale",{x:D[Y],y:D[Y],z:D[Y]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var P=new THREE.Vector3,D=new THREE.Matrix4;return function(){var U=this.indexTipPosition,F=this.pinchEventDetail;if(this.hasPoses){P.setFromMatrixPosition(D.fromArray(this.jointPoses,_*16)),U.setFromMatrixPosition(D.fromArray(this.jointPoses,w*16)),F.wristRotation.setFromRotationMatrix(D.fromArray(this.jointPoses,T*16));var j=U.distanceTo(P);j<S&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=j,F.position.copy(U).add(P).multiplyScalar(.5),this.el.emit("pinchstarted",F)),j>this.pinchDistance+this.pinchDistance*L&&this.isPinched===!0&&(this.isPinched=!1,F.position.copy(U).add(P).multiplyScalar(.5),this.el.emit("pinchended",F)),this.isPinched&&(F.position.copy(U).add(P).multiplyScalar(.5),this.el.emit("pinchmoved",F))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var P=this.el,D=this.data;if(P.setAttribute("tracked-controls",{id:"",hand:D.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==P.getObject3D("mesh")&&P.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var P=this.el,D;this.checkIfControllerPresent(),D=P.components["tracked-controls"]&&P.components["tracked-controls"].controller,this.mesh&&D&&D.hand&&D.hand instanceof XRHand&&P.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var P=this.data;P.modelStyle==="dots"&&this.initDotsModel(),P.modelStyle==="mesh"&&this.initMeshHandModel(),this.el.object3D.visible=!0,this.wristObject3D.visible=!0},initDotsModel:function(){if(this.jointEls.length===0){for(var P=0;P<x.length;++P){var D=this.jointEl=document.createElement("a-entity");D.setAttribute("geometry",{primitive:"sphere",radius:1}),D.object3D.visible=!1,this.el.appendChild(D),this.jointEls.push(D)}this.updateModelMaterial()}},initMeshHandModel:function(){var P=this.data.hand==="left"?E:b;this.el.setAttribute("gltf-model",P)},onModelLoaded:function(){var P=this.mesh=this.el.getObject3D("mesh").children[0],D=this.skinnedMesh=P.getObjectByProperty("type","SkinnedMesh");this.skinnedMesh&&(this.bones=D.skeleton.bones,this.el.removeObject3D("mesh"),P.position.set(0,0,0),P.rotation.set(0,0,0),D.frustumCulled=!1,D.material=new THREE.MeshStandardMaterial,this.updateModelMaterial(),this.setupChildrenEntities(),this.el.setObject3D("mesh",P))},setupChildrenEntities:function(){for(var P=this.el.children,D=0;D<P.length;++D)P[D]instanceof C&&this.addChildEntity(P[D])},addChildEntity:function(P){P instanceof C&&this.wristObject3D.add(P.object3D)}})},"./src/components/hand-tracking-grab-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js");f("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var p=this.el,g=this.data,u;g.hand==="right"?u="components.hand-tracking-controls.bones.3":u="components.hand-tracking-controls.bones.21",p.setAttribute("hand-tracking-controls",{hand:g.hand}),p.setAttribute("obb-collider",{trackedObject3D:u,size:.04}),this.auxMatrix=new C.Matrix4,this.auxQuaternion=new C.Quaternion,this.auxQuaternion2=new C.Quaternion,this.auxVector=new C.Vector3,this.auxVector2=new C.Vector3,this.grabbingObjectPosition=new C.Vector3,this.grabbedObjectPosition=new C.Vector3,this.grabbedObjectPositionDelta=new C.Vector3,this.grabDeltaPosition=new C.Vector3,this.grabInitialRotation=new C.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var p,g=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),u=0;u<g.length;++u)p=g[u].components["hand-tracking-grab-controls"],p!==this&&this.grabbedEl&&this.grabbedEl===p.grabbedEl&&p.releaseGrabbedEntity();return!1},onCollisionStarted:function(p){var g=p.detail.withEl;this.collidedEl||g.getAttribute("grabbable")&&(this.collidedEl=g,this.grabbingObject3D=p.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(p){this.collidedEl&&(this.pinchPosition=p.detail.position,this.wristRotation=p.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(p){this.wristRotation=p.detail.wristRotation},releaseGrabbedEntity:function(){var p=this.grabbedEl;p&&(p.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,p.object3D.matrixAutoUpdate=!0,p.object3D.matrixWorldAutoUpdate=!0,p.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),p.object3D.position.copy(this.auxVector),p.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:p}),this.grabbedEl=void 0)},grab:function(){var p=this.grabbedEl,g;g=p.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(g).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=p.object3D.updateMatrixWorld,p.object3D.updateMatrixWorld=function(){},p.object3D.updateMatrixWorldChildren=function(u){for(var E=this.children,b=0,x=E.length;b<x;b++){var T=E[b];(T.matrixWorldAutoUpdate===!0||u===!0)&&T.updateMatrixWorld(!0)}},p.object3D.matrixAutoUpdate=!1,p.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:p})},tock:function(){var p=this.auxMatrix,g=this.auxQuaternion,u=this.auxQuaternion2,E,b=this.grabbedEl;b&&(E=b.object3D,E.getWorldQuaternion(u),E.matrixWorld.identity(),p.identity(),p.makeTranslation(this.pinchPosition),E.matrixWorld.multiply(p),p.identity(),p.makeRotationFromQuaternion(g.copy(this.wristRotation).multiply(this.grabInitialRotation)),E.matrixWorld.multiply(p),p.identity(),p.makeTranslation(this.grabDeltaPosition),E.matrixWorld.multiply(p),p.identity(),p.makeRotationFromQuaternion(u),E.matrixWorld.multiply(p),p.makeScale(b.object3D.scale.x,b.object3D.scale.y,b.object3D.scale.z),E.matrixWorld.multiply(p),E.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("hide-on-enter-ar",{init:function(){var C=this;this.el.sceneEl.addEventListener("enter-vr",function(){C.el.sceneEl.is("ar-mode")&&(C.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){C.el.object3D.visible=!0})}})},"./src/components/hide-on-enter-vr.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("hide-on-enter-vr",{init:function(){var C=this;this.el.sceneEl.addEventListener("enter-vr",function(){C.el.sceneEl.is("vr-mode")&&(C.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){C.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/tracked-controls.js"),g=p.checkControllerPresentAndSetup,u=p.emitIfAxesChanged,E=p.onButtonEvent,b="hp-mixed-reality",x=h("./src/constants/index.js").AFRAME_CDN_ROOT,T=x+"controllers/hp/mixed-reality/",_={x:0,y:0,z:.06},w={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},S={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};m.exports.Component=f("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:S,init:function(){var L=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(P){E(P.detail.id,"down",L,L.data.hand)},this.onButtonUp=function(P){E(P.detail.id,"up",L,L.data.hand)},this.onButtonTouchEnd=function(P){E(P.detail.id,"touchend",L,L.data.hand)},this.onButtonTouchStart=function(P){E(P.detail.id,"touchstart",L,L.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var L=this.data;this.controllerIndex=L.hand==="right"?0:L.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("axismove",this.onAxisMoved),L.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("axismove",this.onAxisMoved),L.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var L=this.data;g(this,b,{index:this.controllerIndex,hand:L.hand})},injectTrackedControls:function(){var L=this.el,P=this.data;L.setAttribute("tracked-controls",{idPrefix:b,hand:P.hand,controller:this.controllerIndex,orientationOffset:P.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",T+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(L){var P=this.mapping[this.data.hand].buttons[L.detail.id],D;P&&(P==="trigger"&&(D=L.detail.state.value,console.log("analog value of trigger press: "+D)),this.el.emit(P+"changed",L.detail.state))},onModelLoaded:function(L){var P=L.detail.model;this.data.model&&(P.position.copy(_),P.rotation.copy(w),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new C.Vector3(0,0,0)}))},onAxisMoved:function(L){u(this,this.mapping.axes,L)}})},"./src/components/index.js":(m,M,h)=>{h("./src/components/animation.js"),h("./src/components/anchored.js"),h("./src/components/camera.js"),h("./src/components/cursor.js"),h("./src/components/geometry.js"),h("./src/components/generic-tracked-controller-controls.js"),h("./src/components/gltf-model.js"),h("./src/components/grabbable.js"),h("./src/components/hand-tracking-controls.js"),h("./src/components/hand-tracking-grab-controls.js"),h("./src/components/hand-controls.js"),h("./src/components/hide-on-enter-ar.js"),h("./src/components/hide-on-enter-vr.js"),h("./src/components/hp-mixed-reality-controls.js"),h("./src/components/layer.js"),h("./src/components/laser-controls.js"),h("./src/components/light.js"),h("./src/components/line.js"),h("./src/components/link.js"),h("./src/components/look-controls.js"),h("./src/components/magicleap-controls.js"),h("./src/components/material.js"),h("./src/components/obb-collider.js"),h("./src/components/obj-model.js"),h("./src/components/oculus-go-controls.js"),h("./src/components/oculus-touch-controls.js"),h("./src/components/pico-controls.js"),h("./src/components/position.js"),h("./src/components/raycaster.js"),h("./src/components/rotation.js"),h("./src/components/scale.js"),h("./src/components/shadow.js"),h("./src/components/sound.js"),h("./src/components/text.js"),h("./src/components/tracked-controls.js"),h("./src/components/tracked-controls-webvr.js"),h("./src/components/tracked-controls-webxr.js"),h("./src/components/visible.js"),h("./src/components/valve-index-controls.js"),h("./src/components/vive-controls.js"),h("./src/components/vive-focus-controls.js"),h("./src/components/wasd-controls.js"),h("./src/components/windows-motion-controls.js"),h("./src/components/scene/ar-hit-test.js"),h("./src/components/scene/background.js"),h("./src/components/scene/debug.js"),h("./src/components/scene/device-orientation-permission-ui.js"),h("./src/components/scene/embedded.js"),h("./src/components/scene/inspector.js"),h("./src/components/scene/fog.js"),h("./src/components/scene/keyboard-shortcuts.js"),h("./src/components/scene/pool.js"),h("./src/components/scene/real-world-meshing.js"),h("./src/components/scene/reflection.js"),h("./src/components/scene/screenshot.js"),h("./src/components/scene/stats.js"),h("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/index.js");f("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var p=this.config,g=this.data,u=this.el,E=this,b={hand:g.hand,model:g.model};u.setAttribute("hp-mixed-reality-controls",b),u.setAttribute("magicleap-controls",b),u.setAttribute("oculus-go-controls",b),u.setAttribute("oculus-touch-controls",b),u.setAttribute("pico-controls",b),u.setAttribute("valve-index-controls",b),u.setAttribute("vive-controls",b),u.setAttribute("vive-focus-controls",b),u.setAttribute("windows-motion-controls",b),u.setAttribute("generic-tracked-controller-controls",{hand:b.hand}),u.addEventListener("controllerconnected",x),u.addEventListener("controllerdisconnected",T),u.addEventListener("controllermodelready",function(_){x(_),E.modelReady=!0});function x(_){var w=p[_.detail.name];if(w){var S=C.extend({showLine:!0},w.raycaster||{});_.detail.rayOrigin&&(S.origin=_.detail.rayOrigin.origin,S.direction=_.detail.rayOrigin.direction,S.showLine=!0),_.detail.rayOrigin||!E.modelReady?u.setAttribute("raycaster",S):u.setAttribute("raycaster","showLine",!0),u.setAttribute("cursor",C.extend({fuse:!1},w.cursor))}}function T(_){var w=p[_.detail.name];w&&u.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"pico-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/index.js"),p=C.debug("components:layer:warn");m.exports.Component=f("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var u=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=u.createFramebuffer();var E=this.el.sceneEl.getAttribute("webxr"),b=E.requiredFeatures;b.indexOf("layers")===-1&&(b.push("layers"),this.el.sceneEl.setAttribute("webxr",E)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(u){this.data.src!==u.src&&this.updateSrc()},updateSrc:function(){var u=this.data.type;if(this.texture=void 0,u==="quad"){this.loadQuadImage();return}if(u==="monocubemap"||u==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var u,E=this.xrGLFactory,b=this.el.sceneEl.frame,x=this.data.src,T=this.data.type;this.visibilityChanged=!1,this.layer&&(T!=="monocubemap"&&T!=="stereocubemap"||(x.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,T==="monocubemap"?(u=E.getSubImage(this.layer,b),this.loadCubeMapImage(u.colorTexture,x,0)):(u=E.getSubImage(this.layer,b,"left"),this.loadCubeMapImage(u.colorTexture,x,0),u=E.getSubImage(this.layer,b,"right"),this.loadCubeMapImage(u.colorTexture,x,6))))},loadQuadImage:function(){var u=this.data.src,E=this;this.el.sceneEl.systems.material.loadTexture(u,{src:u},function(x){E.el.sceneEl.renderer.initTexture(x),E.texture=x,u.tagName==="VIDEO"&&setTimeout(function(){E.textureIsVideo=!0},1e3),E.layer&&(E.layer.height=E.data.height/2||E.texture.image.height/1e3,E.layer.width=E.data.width/2||E.texture.image.width/1e3,E.needsRedraw=!0),E.updateQuadPanel()})},preGenerateCubeMapTextures:function(u,E){this.data.type==="monocubemap"?this.generateCubeMapTextures(u,0,E):(this.generateCubeMapTextures(u,0,E),this.generateCubeMapTextures(u,6,E))},generateCubeMapTextures:function(u,E,b){for(var x=this.data,T=this.cubeFaceSize,_=Math.min(u.width,u.height),w=[],S,L,P=0;P<6;P++){var D=document.createElement("CANVAS");D.width=D.height=T;var U=D.getContext("2d");x.rotateCubemap&&(P===2||P===3)&&(U.save(),U.translate(T,T),U.rotate(Math.PI)),U.drawImage(u,(P+E)*_,0,_,_,0,0,T,T),U.restore(),b&&b(),w.push(D)}return x.rotateCubemap&&(S=w[0],L=w[1],w[0]=L,w[1]=S,S=w[4],L=w[5],w[4]=L,w[5]=S),b&&b(),w},loadCubeMapImage:function(u,E,b){var x=this.el.sceneEl.renderer.getContext(),T;x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,!1),x.bindTexture(x.TEXTURE_CUBE_MAP,u),!E.complete||this.loadingScreen?T=this.loadingScreenImages:T=this.generateCubeMapTextures(E,b);var _=0;T.forEach(function(w,S){x.texSubImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+S,0,0,0,x.RGBA,x.UNSIGNED_BYTE,w),_=x.getError()}),_!==0&&console.log("renderingError, WebGL Error Code: "+_),x.bindTexture(x.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var u=this,E=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(b){u.visibilityChanged=b.session.visibilityState!=="hidden"},E==="quad"){this.initQuadLayer();return}if(E==="monocubemap"||E==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var u=this.el.sceneEl,E=u.renderer.getContext(),b=this.xrGLFactory=new XRWebGLBinding(u.xrSession,E);this.texture&&(this.layer=b.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),u.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var u=this.data.src,E=this.el.sceneEl,b=E.renderer.getContext(),x=b.getParameter(b.MAX_CUBE_MAP_TEXTURE_SIZE),T=this.cubeFaceSize=Math.min(x,Math.min(u.width,u.height)),_=this.xrGLFactory=new XRWebGLBinding(E.xrSession,b);this.layer=_.createCubeLayer({space:this.referenceSpace,viewPixelWidth:T,viewPixelHeight:T,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),E.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var u=this.cubeFaceSize,E=this.loadingScreenImages=[],b=0;b<6;b++){var x=document.createElement("CANVAS");x.width=x.height=u;var T=x.getContext("2d");x.width=x.height=u,T.fillStyle="black",T.fillRect(0,0,u,u),b!==2&&b!==3&&(T.translate(u,0),T.scale(-1,1),T.fillStyle="white",T.font="30px Arial",T.fillText("Loading",u/2,u/2)),E.push(x)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(u){this.layerEnabled=u,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var u=this.quadPanelEl;this.quadPanelEl||(u=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(u)),u.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),u.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var u=this.el.sceneEl,E=this.el.sceneEl.renderer.getContext(),b=this.xrGLFactory.getSubImage(this.layer,u.frame),x=u.renderer.properties.get(this.texture).__webglTexture,T=E.getParameter(E.FRAMEBUFFER_BINDING);E.viewport(b.viewport.x,b.viewport.y,b.viewport.width,b.viewport.height),E.bindFramebuffer(E.FRAMEBUFFER,this.frameBuffer),E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,b.colorTexture,0),g(E,x,b,this.data.src),E.bindFramebuffer(E.FRAMEBUFFER,T)},updateTransform:function(){var u=this.el,E=this.position,b=this.quaternion;u.object3D.updateMatrixWorld(),E.setFromMatrixPosition(u.object3D.matrixWorld),b.setFromRotationMatrix(u.object3D.matrixWorld),this.layerEnabled||E.set(0,0,1e8),this.layer.transform=new XRRigidTransform(E,b)},onEnterVR:function(){var u=this.el.sceneEl,E=u.xrSession;if(!u.hasWebXR||!XRWebGLBinding||!E){p("The layer component requires WebXR and the layers API enabled");return}E.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(u){this.referenceSpace=u}});function g(u,E,b,x){var T=u.createFramebuffer(),_=b.viewport.x,w=b.viewport.y,S=b.viewport.x+b.viewport.width,L=b.viewport.y+b.viewport.height;x.tagName==="VIDEO"&&(u.bindTexture(u.TEXTURE_2D,E),u.texSubImage2D(u.TEXTURE_2D,0,0,0,x.width,x.height,u.RGB,u.UNSIGNED_BYTE,x)),u.bindFramebuffer(u.READ_FRAMEBUFFER,T),u.framebufferTexture2D(u.READ_FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,E,0),u.readBuffer(u.COLOR_ATTACHMENT0),u.blitFramebuffer(0,0,x.width,x.height,_,w,S,L,u.COLOR_BUFFER_BIT,u.NEAREST),u.bindFramebuffer(u.READ_FRAMEBUFFER,null),u.deleteFramebuffer(T)}},"./src/components/light.js":(m,M,h)=>{var f=h("./src/utils/index.js"),C=f.diff,p=h("./src/utils/debug.js"),g=h("./src/core/component.js").registerComponent,u=h("./src/lib/three.js"),E=h("./src/utils/math.js"),b=u.MathUtils.degToRad,x=p("components:light:warn"),T=new u.CubeTextureLoader,_={};m.exports.Component=g("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var w=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(w)},update:function(w){var S=this.data,L=C(S,w),P=this.light,D=this;if(P&&!("type"in L)){var U=!1;Object.keys(L).forEach(function(F){var j=S[F];switch(F){case"color":{P.color.set(j);break}case"groundColor":{P.groundColor.set(j);break}case"angle":{P.angle=b(j);break}case"target":{j===null?(S.type==="spot"||S.type==="directional")&&(P.target=D.defaultTarget):j.hasLoaded?D.onSetTarget(j,P):j.addEventListener("loaded",D.onSetTarget.bind(D,j,P));break}case"envMap":D.updateProbeMap(S,P);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":U||(D.updateShadow(),U=!0);break;case"shadowCameraAutomatic":S.shadowCameraAutomatic?D.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(S.shadowCameraAutomatic)):D.shadowCameraAutomaticEls=[];break;default:P[F]=j}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var w=new u.Box3,S=new u.Vector3,L=new u.Vector3,P=new u.Matrix4,D=new u.Sphere,U=new u.Vector3;return function(){if(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof u.OrthographicCamera&&this.shadowCameraAutomaticEls.length){var F=this.light.shadow.camera;F.getWorldDirection(S),F.getWorldPosition(L),P.copy(F.matrixWorld),P.invert(),F.near=1,F.left=1e5,F.right=-1e5,F.top=-1e5,F.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(j){w.setFromObject(j.object3D),w.getBoundingSphere(D);var Y=E.distanceOfPointFromPlane(L,S,D.center),oe=E.nearestPointInPlane(L,S,D.center,U),te=oe.applyMatrix4(P);F.near=Math.min(-Y-D.radius-1,F.near),F.left=Math.min(-D.radius+te.x,F.left),F.right=Math.max(D.radius+te.x,F.right),F.top=Math.max(D.radius+te.y,F.top),F.bottom=Math.min(-D.radius+te.y,F.bottom)}),F.updateProjectionMatrix()}}}(),setLight:function(w){var S=this.el,L=this.getLight(w);L&&(this.light&&S.removeObject3D("light"),this.light=L,this.light.el=S,S.setObject3D("light",this.light),(w.type==="spot"||w.type==="directional"||w.type==="hemisphere")&&S.getObject3D("light").translateY(-1),w.type==="spot"&&(S.setObject3D("light-target",this.defaultTarget),S.getObject3D("light-target").position.set(0,0,-1)),w.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(w.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var w=this.el,S=this.data,L=this.light;L.castShadow=S.castShadow;var P=w.getObject3D("cameraHelper");if(S.shadowCameraVisible&&!P?w.setObject3D("cameraHelper",new u.CameraHelper(L.shadow.camera)):!S.shadowCameraVisible&&P&&w.removeObject3D("cameraHelper"),!S.castShadow)return L;L.shadow.bias=S.shadowBias,L.shadow.radius=S.shadowRadius,L.shadow.mapSize.height=S.shadowMapHeight,L.shadow.mapSize.width=S.shadowMapWidth,L.shadow.camera.near=S.shadowCameraNear,L.shadow.camera.far=S.shadowCameraFar,L.shadow.camera instanceof u.OrthographicCamera?(L.shadow.camera.top=S.shadowCameraTop,L.shadow.camera.right=S.shadowCameraRight,L.shadow.camera.bottom=S.shadowCameraBottom,L.shadow.camera.left=S.shadowCameraLeft):L.shadow.camera.fov=S.shadowCameraFov,L.shadow.camera.updateProjectionMatrix(),P&&P.update()},getLight:function(w){var S=w.angle,L=new u.Color(w.color);L=L.getHex();var P=w.decay,D=w.distance,U=new u.Color(w.groundColor);U=U.getHex();var F=w.intensity,j=w.type,Y=w.target,oe=null;switch(j.toLowerCase()){case"ambient":return new u.AmbientLight(L,F);case"directional":return oe=new u.DirectionalLight(L,F),this.defaultTarget=oe.target,Y&&(Y.hasLoaded?this.onSetTarget(Y,oe):Y.addEventListener("loaded",this.onSetTarget.bind(this,Y,oe))),oe;case"hemisphere":return new u.HemisphereLight(L,U,F);case"point":return new u.PointLight(L,F,D,P);case"spot":return oe=new u.SpotLight(L,F,D,b(S),w.penumbra,P),this.defaultTarget=oe.target,Y&&(Y.hasLoaded?this.onSetTarget(Y,oe):Y.addEventListener("loaded",this.onSetTarget.bind(this,Y,oe))),oe;case"probe":return oe=new u.LightProbe,this.updateProbeMap(w,oe),oe;default:x("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",j)}},updateProbeMap:function(w,S){w.envMap||S.copy(new u.LightProbe),_[w.envMap]instanceof window.Promise&&_[w.envMap].then(function(L){S.copy(L)}),_[w.envMap]instanceof u.LightProbe&&S.copy(_[w.envMap]),_[w.envMap]=new window.Promise(function(L){f.srcLoader.validateCubemapSrc(w.envMap,function(D){T.load(D,function(U){var F=u.LightProbeGenerator.fromCubeTexture(U);_[w.envMap]=F,S.copy(F)})})})},onSetTarget:function(w,S){S.target=w.object3D},remove:function(){var w=this.el;w.removeObject3D("light"),w.getObject3D("cameraHelper")&&w.removeObject3D("cameraHelper")}})},"./src/components/line.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var p=this.data,g,u;u=this.material=new THREE.LineBasicMaterial({color:p.color,opacity:p.opacity,transparent:p.opacity<1,visible:p.visible}),g=this.geometry=new THREE.BufferGeometry,g.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(g,u),this.el.setObject3D(this.attrName,this.line)},update:function(p){var g=this.data,u=this.geometry,E=!1,b=this.material,x=u.attributes.position.array;C(g.start,p.start)||(x[0]=g.start.x,x[1]=g.start.y,x[2]=g.start.z,E=!0),C(g.end,p.end)||(x[3]=g.end.x,x[4]=g.end.y,x[5]=g.end.z,E=!0),E&&(u.attributes.position.needsUpdate=!0,u.computeBoundingSphere()),b.color.setStyle(g.color),b.opacity=g.opacity,b.transparent=g.opacity<1,b.visible=g.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function C(p,g){return!p||!g?!1:p.x===g.x&&p.y===g.y&&p.z===g.z}},"./src/components/link.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/core/shader.js").registerShader,p=h("./src/lib/three.js");m.exports.Component=f("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new p.Quaternion,this.hiddenEls=[]},update:function(g){var u=this.data,E=this.el,b,x;u.visualAspectEnabled&&(this.initVisualAspect(),b=u.highlighted?u.highlightedColor:u.backgroundColor,x=u.highlighted?u.highlightedColor:u.borderColor,E.setAttribute("material","backgroundColor",b),E.setAttribute("material","strokeColor",x),u.on!==g.on&&this.updateEventListener(),g.peekMode!==void 0&&u.peekMode!==g.peekMode&&this.updatePeekMode(),!(!u.image||g.image===u.image)&&E.setAttribute("material","pano",typeof u.image=="string"?u.image:u.image.src))},updatePeekMode:function(){var g=this.el,u=this.sphereEl;this.data.peekMode?(this.hideAll(),g.getObject3D("mesh").visible=!1,u.setAttribute("visible",!0)):(this.showAll(),g.getObject3D("mesh").visible=!0,u.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var g=this.el;g.isPlaying&&(this.removeEventListener(),g.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var g=this.data.on;g&&this.el.removeEventListener(g,this.navigate)},initVisualAspect:function(){var g=this.el,u,E,b;!this.data.visualAspectEnabled||this.visualAspectInitialized||(b=this.textEl=this.textEl||document.createElement("a-entity"),E=this.sphereEl=this.sphereEl||document.createElement("a-entity"),u=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),g.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),g.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),b.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),b.setAttribute("position","0 1.5 0"),g.appendChild(b),u.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),u.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),u.setAttribute("rotation","0 180 0"),u.setAttribute("position","0 0 0"),u.setAttribute("visible",!1),g.appendChild(u),E.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),E.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),E.setAttribute("visible",!1),g.appendChild(E),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var g=new p.Vector3,u=new p.Vector3,E=new p.Quaternion,b=new p.Vector3;return function(){var x=this.el,T=x.object3D,_=x.sceneEl.camera,w,S,L=this.textEl;if(this.data.visualAspectEnabled)if(T.updateMatrixWorld(),_.parent.updateMatrixWorld(),_.updateMatrixWorld(),T.matrix.decompose(u,E,b),u.setFromMatrixPosition(T.matrixWorld),g.setFromMatrixPosition(_.matrixWorld),S=u.distanceTo(g),S>20)this.previousQuaternion||(this.quaternionClone.copy(E),this.previousQuaternion=this.quaternionClone),T.lookAt(g);else{if(w=this.calculateCameraPortalOrientation(),S<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;L.setAttribute("text","width",1.5),w<=0?(L.setAttribute("position","0 0 0.75"),L.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(L.setAttribute("position","0 0 -0.75"),L.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),x.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=w}else w<=0?L.setAttribute("rotation","0 180 0"):L.setAttribute("rotation","0 0 0"),L.setAttribute("text","width",5),L.setAttribute("position","0 1.5 0"),x.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(T.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var g=this.el,u=this.hiddenEls,E=this;u.length>0||g.sceneEl.object3D.traverse(function(b){b&&b.el&&b.el.hasAttribute("link-controls")||!b.el||b===g.sceneEl.object3D||b.el===g||b.el===E.sphereEl||b.el===g.sceneEl.cameraEl||b.el.getAttribute("visible")===!1||b.el===E.textEl||b.el===E.semiSphereEl||(b.el.setAttribute("visible",!1),u.push(b.el))})},showAll:function(){this.hiddenEls.forEach(function(g){g.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var g=new p.Matrix4,u=new p.Vector3,E=new p.Vector3(0,0,1),b=new p.Vector3(0,0,0);return function(){var x=this.el,T=x.sceneEl.camera;return u.set(0,0,0),E.set(0,0,1),b.set(0,0,0),x.object3D.matrixWorld.extractRotation(g),E.applyMatrix4(g),x.object3D.updateMatrixWorld(),x.object3D.localToWorld(b),T.parent.parent.updateMatrixWorld(),T.parent.updateMatrixWorld(),T.updateMatrixWorld(),T.localToWorld(u),u.sub(b).normalize(),E.normalize(),Math.sign(E.dot(u))}}(),remove:function(){this.removeEventListener()}}),C("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/index.js"),g=Math.PI/2;m.exports.Component=f("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new C.Vector3,this.hmdQuaternion=new C.Quaternion,this.magicWindowAbsoluteEuler=new C.Euler,this.magicWindowDeltaEuler=new C.Euler,this.position=new C.Vector3,this.magicWindowObject=new C.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new C.Vector3,rotation:new C.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var u,E=this.data;(p.device.isMobile()||p.device.isMobileDeviceRequestingDesktopSite())&&(u=this.magicWindowControls=new C.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(u.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?u.enabled=E.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){u.enabled=E.magicWindowTrackingEnabled})))},update:function(u){var E=this.data;E.enabled!==u.enabled&&this.updateGrabCursor(E.enabled),u&&!E.magicWindowTrackingEnabled&&u.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=E.magicWindowTrackingEnabled),u&&!E.pointerLockEnabled!==u.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(u){var E=this.data;E.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockError=this.onPointerLockError.bind(this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new C.Object3D,this.yawObject=new C.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var u=this.el.sceneEl,E=u.canvas;if(!E){u.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}E.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),E.addEventListener("touchstart",this.onTouchStart,{passive:!0}),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),window.addEventListener("touchend",this.onTouchEnd,{passive:!0}),u.addEventListener("enter-vr",this.onEnterVR),u.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var u=this.el.sceneEl,E=u&&u.canvas;E&&(E.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),E.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),u.removeEventListener("enter-vr",this.onEnterVR),u.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var u=this.el.object3D,E=this.pitchObject,b=this.yawObject,x=this.el.sceneEl;(x.is("vr-mode")||x.is("ar-mode"))&&x.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),u.rotation.x=this.magicWindowDeltaEuler.x+E.rotation.x,u.rotation.y=this.magicWindowDeltaEuler.y+b.rotation.y,u.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var u=this.magicWindowAbsoluteEuler,E=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),u.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&u.y!==0&&(this.previousMagicWindowYaw=u.y),this.previousMagicWindowYaw&&(E.x=u.x,E.y+=u.y-this.previousMagicWindowYaw,E.z=u.z,this.previousMagicWindowYaw=u.y))},onMouseMove:function(u){var E,b,x,T=this.pitchObject,_=this.previousMouseEvent,w=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(b=u.movementX||u.mozMovementX||0,x=u.movementY||u.mozMovementY||0):(b=u.screenX-_.screenX,x=u.screenY-_.screenY),this.previousMouseEvent.screenX=u.screenX,this.previousMouseEvent.screenY=u.screenY,E=this.data.reverseMouseDrag?1:-1,w.rotation.y+=b*.002*E,T.rotation.x+=x*.002*E,T.rotation.x=Math.max(-g,Math.min(g,T.rotation.x)))},onMouseDown:function(u){var E=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(E.is("vr-mode")||E.is("ar-mode"))&&E.checkHeadsetConnected())&&u.button===0){var b=E&&E.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=u.screenX,this.previousMouseEvent.screenY=u.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(b.requestPointerLock?b.requestPointerLock():b.mozRequestPointerLock&&b.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(u){u.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:u.touches[0].pageX,y:u.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(u){var E,b=this.el.sceneEl.canvas,x,T=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(x=2*Math.PI*(u.touches[0].pageX-this.touchStart.x)/b.clientWidth,E=this.data.reverseTouchDrag?1:-1,T.rotation.y-=x*.5*E,this.touchStart={x:u.touches[0].pageX,y:u.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var u=this.el.sceneEl;u.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),u.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(u){var E=this.el.sceneEl;function b(){E.canvas.classList.add("a-grab-cursor")}function x(){E.canvas.classList.remove("a-grab-cursor")}if(!E.canvas){u?E.addEventListener("render-target-loaded",b):E.addEventListener("render-target-loaded",x);return}if(u){b();return}x()},saveCameraPose:function(){var u=this.el;this.savedPose.position.copy(u.object3D.position),this.savedPose.rotation.copy(u.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var u=this.el,E=this.savedPose;this.hasSavedPose&&(u.object3D.position.copy(E.position),u.object3D.rotation.copy(E.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/tracked-controls.js"),p=C.checkControllerPresentAndSetup,g=C.emitIfAxesChanged,u=C.onButtonEvent,E="magicleap",b="-one",x=E+b,T=h("./src/constants/index.js").AFRAME_CDN_ROOT,_=T+"controllers/magicleap/magicleap-one-controller.glb",w={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};m.exports.Component=f("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:w,init:function(){var S=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(L){u(L.detail.id,"down",S)},this.onButtonUp=function(L){u(L.detail.id,"up",S)},this.onButtonTouchEnd=function(L){u(L.detail.id,"touchend",S)},this.onButtonTouchStart=function(L){u(L.detail.id,"touchstart",S)},this.previousButtonValues={},this.bindMethods()},update:function(){var S=this.data;this.controllerIndex=S.hand==="right"?0:S.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var S=this.el;S.addEventListener("buttonchanged",this.onButtonChanged),S.addEventListener("buttondown",this.onButtonDown),S.addEventListener("buttonup",this.onButtonUp),S.addEventListener("touchstart",this.onButtonTouchStart),S.addEventListener("touchend",this.onButtonTouchEnd),S.addEventListener("axismove",this.onAxisMoved),S.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var S=this.el;S.removeEventListener("buttonchanged",this.onButtonChanged),S.removeEventListener("buttondown",this.onButtonDown),S.removeEventListener("buttonup",this.onButtonUp),S.removeEventListener("touchstart",this.onButtonTouchStart),S.removeEventListener("touchend",this.onButtonTouchEnd),S.removeEventListener("axismove",this.onAxisMoved),S.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var S=this.data;p(this,x,{index:this.controllerIndex,hand:S.hand})},injectTrackedControls:function(){var S=this.el,L=this.data;S.setAttribute("tracked-controls",{idPrefix:x,hand:L.hand,controller:this.controllerIndex,orientationOffset:L.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",_)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(S){var L=this.mapping.buttons[S.detail.id],P;L&&(L==="trigger"&&(P=S.detail.state.value,console.log("analog value of trigger press: "+P)),this.el.emit(L+"changed",S.detail.state))},onModelLoaded:function(S){var L=S.detail.model;L.scale.set(.01,.01,.01)},onAxisMoved:function(S){g(this,this.mapping.axes,S)},updateModel:function(S,L){},setButtonColor:function(S,L){}})},"./src/components/material.js":(m,M,h)=>{var f=h("./src/utils/index.js"),C=h("./src/core/component.js"),p=h("./src/lib/three.js"),g=h("./src/core/shader.js"),u=f.debug("components:material:error"),E=C.registerComponent,b=g.shaders,x=g.shaderNames;m.exports.Component=E("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:x,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(S){var L=this.data;(!this.shader||L.shader!==S.shader)&&this.updateShader(L.shader),this.shader.update(this.data),this.updateMaterial(S)},updateSchema:function(S){var L,P,D,U;P=S&&S.shader,L=this.oldData&&this.oldData.shader,U=P||L,D=b[U]&&b[U].schema,D||u("Unknown shader schema "+U),!(L&&P===L)&&(this.extendSchema(D),this.updateBehavior())},updateBehavior:function(){var S,L=this.el.sceneEl,P=this.schema,D=this,U;function F(j,Y){var oe;for(oe in U)U[oe]=j;D.shader.update(U)}this.tick=void 0,U={};for(S in P)P[S].type==="time"&&(this.tick=F,U[S]=!0);L&&(this.tick?L.addBehavior(this):L.removeBehavior(this))},updateShader:function(S){var L=this.data,P=b[S]&&b[S].Shader,D;if(!P)throw new Error("Unknown shader "+S);D=this.shader=new P,D.el=this.el,D.init(L),this.setMaterial(D.material),this.updateSchema(L)},updateMaterial:function(S){var L=this.data,P=this.material,D;P.alphaTest=L.alphaTest,P.depthTest=L.depthTest!==!1,P.depthWrite=L.depthWrite!==!1,P.opacity=L.opacity,P.flatShading=L.flatShading,P.side=T(L.side),P.transparent=L.transparent!==!1||L.opacity<1,P.vertexColors=L.vertexColorsEnabled,P.visible=L.visible,P.blending=_(L.blending),P.dithering=L.dithering;for(D in S)break;D&&(S.alphaTest!==L.alphaTest||S.side!==L.side||S.vertexColorsEnabled!==L.vertexColorsEnabled)&&(P.needsUpdate=!0)},remove:function(){var S=new p.MeshBasicMaterial,L=this.material,P=this.el.getObject3D("mesh");P&&(P.material=S),w(L,this.system)},setMaterial:function(S){var L=this.el,P,D=this.system;this.material&&w(this.material,D),this.material=S,D.registerMaterial(S),P=L.getObject3D("mesh"),P?P.material=S:L.addEventListener("object3dset",function U(F){F.detail.type!=="mesh"||F.target!==L||(L.getObject3D("mesh").material=S,L.removeEventListener("object3dset",U))})}});function T(S){switch(S){case"back":return p.BackSide;case"double":return p.DoubleSide;default:return p.FrontSide}}function _(S){switch(S){case"none":return p.NoBlending;case"additive":return p.AdditiveBlending;case"subtractive":return p.SubtractiveBlending;case"multiply":return p.MultiplyBlending;default:return p.NormalBlending}}function w(S,L){S.dispose(),L.unregisterMaterial(S),Object.keys(S).filter(function(P){return S[P]&&S[P].isTexture}).forEach(function(P){S[P].dispose()})}},"./src/components/obb-collider.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js");f("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new C.Vector3().copy(this.el.object3D.scale),this.auxEuler=new C.Euler,this.boundingBox=new C.Box3,this.boundingBoxSize=new C.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var p=this.el,g=p.components["gltf-model"]&&p.components["gltf-model"].model,u,E;g&&(this.el.removeObject3D("mesh"),u=new C.Box3().setFromObject(g),E=u.getCenter(new C.Vector3),g.position.x+=g.position.x-E.x,g.position.y+=g.position.y-E.y,g.position.z+=g.position.z-E.z,this.el.setObject3D("mesh",g))},updateCollider:function(){var p=this.el,g=this.boundingBoxSize,u=this.aabb=this.aabb||new C.OBB;if(this.obb=this.obb||new C.OBB,!p.hasLoaded){p.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),u.halfSize.copy(g).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var p=this.renderColliderMesh,g=this.boundingBoxSize;if(!p){this.initColliderMesh();return}p.geometry.dispose(),p.geometry=new C.BoxGeometry(g.x,g.y,g.z)},hideCollider:function(){this.renderColliderMesh&&(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var p,g,u;p=this.boundingBoxSize,g=this.renderColliderGeometry=new C.BoxGeometry(p.x,p.y,p.z),u=this.renderColliderMesh=new C.Mesh(g,new C.MeshLambertMaterial({color:65280,side:C.DoubleSide})),u.matrixAutoUpdate=!1,u.matrixWorldAutoUpdate=!1,u.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(u)},updateBoundingBox:function(){var p=new C.Vector3,g=new C.Vector3,u=new C.Quaternion,E=new C.Quaternion,b=new C.Matrix4;return function(){var x=this.auxEuler,T=this.boundingBox,_=this.data.size,w=this.trackedObject3D||this.el.object3D,S=this.boundingBoxSize,L=this.data.minimumColliderDimension;if(_){this.boundingBoxSize.x=_,this.boundingBoxSize.y=_,this.boundingBoxSize.z=_;return}x.copy(w.rotation),w.rotation.set(0,0,0),w.parent.matrixWorld.decompose(p,u,g),b.compose(p,E,g),w.parent.matrixWorld.copy(b),T.setFromObject(w,!0),T.getSize(S),S.x=S.x<L?L:S.x,S.y=S.y<L?L:S.y,S.z=S.z<L?L:S.z,w.parent.matrixWorld.compose(p,u,g),this.el.object3D.rotation.copy(x)}}(),checkTrackedObject:function(){var p=this.trackedObject3DPath,g;if(p&&p.length&&!this.trackedObject3D){g=this.el;for(var u=0;u<p.length&&(g=g[p[u]],!!g);u++);g&&(this.trackedObject3D=g,this.updateCollider())}return this.trackedObject3D},tick:function(){var p=new C.Vector3,g=new C.Vector3,u=new C.Quaternion,E=new C.Matrix4;return function(){var b=this.obb,x=this.renderColliderMesh,T=this.checkTrackedObject()||this.el.object3D;T&&(T.updateMatrix(),T.updateMatrixWorld(!0),T.matrixWorld.decompose(p,u,g),(Math.abs(g.x-this.previousScale.x)>1e-4||Math.abs(g.y-this.previousScale.y)>1e-4||Math.abs(g.z-this.previousScale.z)>1e-4)&&this.updateCollider(),this.previousScale.copy(g),g.set(1,1,1),E.compose(p,u,g),x&&x.matrixWorld.copy(E),b.copy(this.aabb),b.applyMatrix4(E))}}()})},"./src/components/obj-model.js":(m,M,h)=>{var f=h("./src/utils/debug.js"),C=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),g=f("components:obj-model:warn");m.exports.Component=C("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var u=this;this.model=null,this.objLoader=new p.OBJLoader,this.mtlLoader=new p.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(E){u.model&&E.detail.name==="material"&&u.applyMaterial()})},update:function(){var u=this.data;u.obj&&(this.resetMesh(),this.loadObj(u.obj,u.mtl))},remove:function(){this.resetMesh()},resetMesh:function(){this.model&&this.el.removeObject3D("mesh")},loadObj:function(u,E){var b=this,x=this.el,T=this.mtlLoader,_=this.objLoader,w=this.el.sceneEl.systems.renderer,S=E.substr(0,E.lastIndexOf("/")+1);if(E){x.hasAttribute("material")&&g("Material component properties are ignored when a .MTL is provided"),T.setResourcePath(S),T.load(E,function(L){L.preload(),_.setMaterials(L),_.load(u,function(P){b.model=P,b.model.traverse(function(D){if(D.isMesh){var U=D.material;U.map&&w.applyColorCorrection(U.map),U.emissiveMap&&w.applyColorCorrection(U.emissiveMap)}}),x.setObject3D("mesh",P),x.emit("model-loaded",{format:"obj",model:P})})});return}_.load(u,function(P){b.model=P,b.applyMaterial(),x.setObject3D("mesh",P),x.emit("model-loaded",{format:"obj",model:P})})},applyMaterial:function(){var u=this.el.components.material;u&&this.model.traverse(function(E){E instanceof p.Mesh&&(E.material=u.material)})}})},"./src/components/oculus-go-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/tracked-controls.js"),p=C.checkControllerPresentAndSetup,g=C.emitIfAxesChanged,u=C.onButtonEvent,E=h("./src/utils/index.js").device.isWebXRAvailable,b="oculus-go",x="Oculus Go",T=h("./src/constants/index.js").AFRAME_CDN_ROOT,_=T+"controllers/oculus/go/oculus-go-controller.gltf",w=E?b:x,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},L={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},P=E?L:S;m.exports.Component=f("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:P,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var D=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(U){u(U.detail.id,"down",D)},this.onButtonUp=function(U){u(U.detail.id,"up",D)},this.onButtonTouchStart=function(U){u(U.detail.id,"touchstart",D)},this.onButtonTouchEnd=function(U){u(U.detail.id,"touchend",D)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var D=this.el;D.addEventListener("buttonchanged",this.onButtonChanged),D.addEventListener("buttondown",this.onButtonDown),D.addEventListener("buttonup",this.onButtonUp),D.addEventListener("touchstart",this.onButtonTouchStart),D.addEventListener("touchend",this.onButtonTouchEnd),D.addEventListener("model-loaded",this.onModelLoaded),D.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var D=this.el;D.removeEventListener("buttonchanged",this.onButtonChanged),D.removeEventListener("buttondown",this.onButtonDown),D.removeEventListener("buttonup",this.onButtonUp),D.removeEventListener("touchstart",this.onButtonTouchStart),D.removeEventListener("touchend",this.onButtonTouchEnd),D.removeEventListener("model-loaded",this.onModelLoaded),D.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){p(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var D=this.el,U=this.data;D.setAttribute("tracked-controls",{armModel:U.armModel,hand:U.hand,idPrefix:w,orientationOffset:U.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",_)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(D){var U=D.detail.model,F;D.target!==this.el||!this.data.model||(F=this.buttonMeshes={},F.trigger=U.getObjectByName("oculus_go_button_trigger"),F.trackpad=U.getObjectByName("oculus_go_touchpad"),F.touchpad=U.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(D){var U=this.mapping.buttons[D.detail.id];U&&this.el.emit(U+"changed",D.detail.state)},onAxisMoved:function(D){g(this,this.mapping.axes,D)},updateModel:function(D,U){this.data.model&&this.updateButtonModel(D,U)},updateButtonModel:function(D,U){var F=this.buttonMeshes;if(!(!F||!F[D])){var j,Y;switch(U){case"down":j=this.data.buttonHighlightColor;break;case"touchstart":j=this.data.buttonTouchedColor;break;default:j=this.data.buttonColor}Y=F[D],Y.material.color.set(j)}}})},"./src/components/oculus-touch-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/tracked-controls.js"),g=p.checkControllerPresentAndSetup,u=p.emitIfAxesChanged,E=p.onButtonEvent,b=h("./src/utils/index.js").device.isWebXRAvailable,x="oculus-touch",T="Oculus Touch",_=b?x:T,w=h("./src/constants/index.js").AFRAME_CDN_ROOT,S=w+"controllers/oculus/oculus-touch-controller-",L=w+"controllers/meta/",P={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new C.Vector3(-.005,.003,-.055),modelPivotRotation:new C.Euler(0,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new C.Vector3(.005,.003,-.055),modelPivotRotation:new C.Euler(0,0,0)}},D={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new C.Vector3(-.005,.036,-.037),modelPivotRotation:new C.Euler(Math.PI/4.5,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new C.Vector3(.005,.036,-.037),modelPivotRotation:new C.Euler(Math.PI/4.5,0,0)}},U=b?D:P,F="oculus-touch",j={"oculus-touch":U,"oculus-touch-v2":{left:{modelUrl:S+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new C.Vector3(0,-.007,-.021),modelPivotRotation:new C.Euler(-Math.PI/4,0,0)},right:{modelUrl:S+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new C.Vector3(0,-.007,-.021),modelPivotRotation:new C.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:S+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new C.Vector3(0,0,0),modelPivotRotation:new C.Euler(0,0,0)},right:{modelUrl:S+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new C.Vector3(0,0,0),modelPivotRotation:new C.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:L+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new C.Vector3(0,0,0),modelPivotRotation:new C.Euler(0,0,0)},right:{modelUrl:L+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new C.Vector3(0,0,0),modelPivotRotation:new C.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:L+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new C.Vector3(0,0,0),modelPivotRotation:new C.Euler(0,0,0)},right:{modelUrl:L+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new C.Vector3(0,0,0),modelPivotRotation:new C.Euler(0,0,0)}}},Y={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},oe={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},te=b?oe:Y;m.exports.Component=f("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},after:["tracked-controls"],mapping:te,bindMethods:function(){this.onButtonChanged=this.onButtonChanged.bind(this),this.onThumbstickMoved=this.onThumbstickMoved.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var de=this;this.onButtonDown=function(se){E(se.detail.id,"down",de,de.data.hand)},this.onButtonUp=function(se){E(se.detail.id,"up",de,de.data.hand)},this.onButtonTouchStart=function(se){E(se.detail.id,"touchstart",de,de.data.hand)},this.onButtonTouchEnd=function(se){E(se.detail.id,"touchend",de,de.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new C.Euler},addEventListeners:function(){var de=this.el;de.addEventListener("buttonchanged",this.onButtonChanged),de.addEventListener("buttondown",this.onButtonDown),de.addEventListener("buttonup",this.onButtonUp),de.addEventListener("touchstart",this.onButtonTouchStart),de.addEventListener("touchend",this.onButtonTouchEnd),de.addEventListener("axismove",this.onAxisMoved),de.addEventListener("model-loaded",this.onModelLoaded),de.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var de=this.el;de.removeEventListener("buttonchanged",this.onButtonChanged),de.removeEventListener("buttondown",this.onButtonDown),de.removeEventListener("buttonup",this.onButtonUp),de.removeEventListener("touchstart",this.onButtonTouchStart),de.removeEventListener("touchend",this.onButtonTouchEnd),de.removeEventListener("axismove",this.onAxisMoved),de.removeEventListener("model-loaded",this.onModelLoaded),de.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){g(this,_,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(de){var se=this.data,J;if(se.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=j[se.controllerType]||j[F],se.controllerType==="auto"){var H=this.el.sceneEl.systems["tracked-controls-webvr"];if(H&&H.vrDisplay){var ae=H.vrDisplay.displayName;/^Oculus Quest$/.test(ae)&&(this.displayModel=j["oculus-touch-v2"])}else{J=F;for(var ue=Object.keys(j),Me=0;Me<de.profiles.length;Me++)if(ue.indexOf(de.profiles[Me])!==-1){J=de.profiles[Me];break}this.displayModel=j[J]}}var De=this.displayModel[se.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===j["oculus-touch-v3"]||this.displayModel===j["meta-quest-touch-pro"]||this.displayModel===j["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",De)}},injectTrackedControls:function(de){var se=this.data,J=x,H=se.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",ae=b?J:H;this.el.setAttribute("tracked-controls",{id:ae,hand:se.hand,orientationOffset:se.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel(de)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(de){var se=this.mapping[this.data.hand].buttons[de.detail.id];if(se){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(de);else{var J=this.buttonMeshes,H;(se==="trigger"||se==="grip")&&(H=de.detail.state.value),J&&(se==="trigger"&&J.trigger&&(J.trigger.rotation.x=this.originalXRotationTrigger-H*(Math.PI/26)),se==="grip"&&J.grip&&(H*=this.data.hand==="left"?-1:1,J.grip.position.x=this.originalXPositionGrip+H*.004))}this.el.emit(se+"changed",de.detail.state)}},onButtonChangedV3orPROorPlus:function(de){var se=this.mapping[this.data.hand].buttons[de.detail.id],J=this.buttonObjects,H;!J||!J[se]||(H=de.detail.state.value,J[se].quaternion.slerpQuaternions(this.buttonRanges[se].min.quaternion,this.buttonRanges[se].max.quaternion,H),J[se].position.lerpVectors(this.buttonRanges[se].min.position,this.buttonRanges[se].max.position,H))},onModelLoaded:function(de){if(!(de.target!==this.el||!this.data.model)){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(de);else{var se=this.controllerObject3D=de.detail.model,J;J=this.buttonMeshes={},J.grip=se.getObjectByName("buttonHand"),this.originalXPositionGrip=J.grip&&J.grip.position.x,J.trigger=se.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=J.trigger&&J.trigger.rotation.x,J.thumbstick=se.getObjectByName("stick"),J.xbutton=se.getObjectByName("buttonX"),J.abutton=se.getObjectByName("buttonA"),J.ybutton=se.getObjectByName("buttonY"),J.bbutton=se.getObjectByName("buttonB")}for(var H in this.buttonMeshes)this.buttonMeshes[H]&&pe(this.buttonMeshes[H]);this.applyOffset(de.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function(de){de.position.copy(this.displayModel[this.data.hand].modelPivotOffset),de.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(de){var se=this.controllerObject3D=de.detail.model,J=this.buttonObjects={},H=this.buttonMeshes={},ae=this.buttonRanges={};H.grip=se.getObjectByName("squeeze"),J.grip=se.getObjectByName("xr_standard_squeeze_pressed_value"),ae.grip={min:se.getObjectByName("xr_standard_squeeze_pressed_min"),max:se.getObjectByName("xr_standard_squeeze_pressed_max")},J.grip.minX=J.grip.position.x,H.thumbstick=se.getObjectByName("thumbstick"),J.thumbstick=se.getObjectByName("xr_standard_thumbstick_pressed_value"),ae.thumbstick={min:se.getObjectByName("xr_standard_thumbstick_pressed_min"),max:se.getObjectByName("xr_standard_thumbstick_pressed_max")},J.thumbstickXAxis=se.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),ae.thumbstickXAxis={min:se.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:se.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},J.thumbstickYAxis=se.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),ae.thumbstickYAxis={min:se.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:se.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},H.trigger=se.getObjectByName("trigger"),J.trigger=se.getObjectByName("xr_standard_trigger_pressed_value"),ae.trigger={min:se.getObjectByName("xr_standard_trigger_pressed_min"),max:se.getObjectByName("xr_standard_trigger_pressed_max")},ae.trigger.diff={x:Math.abs(ae.trigger.max.rotation.x)-Math.abs(ae.trigger.min.rotation.x),y:Math.abs(ae.trigger.max.rotation.y)-Math.abs(ae.trigger.min.rotation.y),z:Math.abs(ae.trigger.max.rotation.z)-Math.abs(ae.trigger.min.rotation.z)};var ue=this.data.hand==="left"?"x":"a",Me=this.data.hand==="left"?"y":"b",De=ue+"button",Ge=Me+"button";H[De]=se.getObjectByName(ue+"_button"),J[De]=se.getObjectByName(ue+"_button_pressed_value"),ae[De]={min:se.getObjectByName(ue+"_button_pressed_min"),max:se.getObjectByName(ue+"_button_pressed_max")},H[Ge]=se.getObjectByName(Me+"_button"),J[Ge]=se.getObjectByName(Me+"_button_pressed_value"),ae[Ge]={min:se.getObjectByName(Me+"_button_pressed_min"),max:se.getObjectByName(Me+"_button_pressed_max")}},onAxisMoved:function(de){u(this,this.mapping[this.data.hand].axes,de)},onThumbstickMoved:function(de){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus(de);return}for(var se in de.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[se]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[se]]-Math.PI/8*de.detail[se]*(se==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(de){var se=(de.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,se);var J=(de.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,J)},updateModel:function(de,se){this.data.model&&this.updateButtonModel(de,se)},updateButtonModel:function(de,se){var J=this.buttonMeshes,H,ae;J&&J[de]&&(ae=se==="up"||se==="touchend"?J[de].originalColor||this.data.buttonColor:se==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,H=J[de],H.material.color.set(ae))}});function pe(de){de.traverse(function(se){var J;se.type==="Mesh"&&(J=se.material.clone(),de.originalColor=se.material.color,se.material.dispose(),se.material=J)})}},"./src/components/pico-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/tracked-controls.js"),g=p.checkControllerPresentAndSetup,u=p.emitIfAxesChanged,E=p.onButtonEvent,b="pico-4",x=h("./src/constants/index.js").AFRAME_CDN_ROOT,T=x+"controllers/pico/pico4/",_={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};m.exports.Component=f("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:_,init:function(){var w=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(S){E(S.detail.id,"down",w,w.data.hand)},this.onButtonUp=function(S){E(S.detail.id,"up",w,w.data.hand)},this.onButtonTouchEnd=function(S){E(S.detail.id,"touchend",w,w.data.hand)},this.onButtonTouchStart=function(S){E(S.detail.id,"touchstart",w,w.data.hand)},this.bindMethods()},update:function(){var w=this.data;this.controllerIndex=w.hand==="right"?0:w.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var w=this.el;w.addEventListener("buttonchanged",this.onButtonChanged),w.addEventListener("buttondown",this.onButtonDown),w.addEventListener("buttonup",this.onButtonUp),w.addEventListener("touchstart",this.onButtonTouchStart),w.addEventListener("touchend",this.onButtonTouchEnd),w.addEventListener("axismove",this.onAxisMoved),w.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var w=this.el;w.removeEventListener("buttonchanged",this.onButtonChanged),w.removeEventListener("buttondown",this.onButtonDown),w.removeEventListener("buttonup",this.onButtonUp),w.removeEventListener("touchstart",this.onButtonTouchStart),w.removeEventListener("touchend",this.onButtonTouchEnd),w.removeEventListener("axismove",this.onAxisMoved),w.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var w=this.data;g(this,b,{index:this.controllerIndex,hand:w.hand})},injectTrackedControls:function(){var w=this.el,S=this.data;w.setAttribute("tracked-controls",{idPrefix:b,hand:S.hand,controller:this.controllerIndex,orientationOffset:S.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",T+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(w){var S=this.mapping[this.data.hand].buttons[w.detail.id],L;S&&(S==="trigger"&&(L=w.detail.state.value,console.log("analog value of trigger press: "+L)),this.el.emit(S+"changed",w.detail.state))},onModelLoaded:function(w){w.target!==this.el||!this.data.model||this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new C.Vector3(0,0,0)})},onAxisMoved:function(w){u(this,this.mapping.axes,w)}})},"./src/components/position.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("position",{schema:{type:"vec3"},update:function(){var C=this.el.object3D,p=this.data;C.position.set(p.x,p.y,p.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/index.js"),g=p.debug("components:raycaster:warn"),u=/^[\w\s-.,[\]#]*$/,E={childList:!0,attributes:!0,subtree:!0},b={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};m.exports.Component=f("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new C.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new C.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new C.Vector3,this.otherLineEndVec3=new C.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(T){var _=this.data,w=this.el,S=this.raycaster;S.far=_.far,S.near=_.near,_.showLine&&(_.far!==T.far||_.origin!==T.origin||_.direction!==T.direction||!T.showLine)&&(this.unitLineEndVec3.copy(_.direction).normalize(),this.drawLine()),!_.showLine&&T.showLine&&w.removeAttribute("line"),_.objects!==T.objects&&!u.test(_.objects)&&g('[raycaster] Selector "'+_.objects+'" may not update automatically with DOM changes.'),_.objects||g('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),_.autoRefresh!==T.autoRefresh&&w.isPlaying&&(_.autoRefresh?this.addEventListeners():this.removeEventListeners()),T.enabled&&!_.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,E),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var T=this.data,_;_=T.objects?this.el.sceneEl.querySelectorAll(T.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(_),this.dirty=!1},tock:function(T){var _=this.data,w=this.prevCheckTime;_.enabled&&(w&&T-w<_.interval||(this.prevCheckTime=T,this.checkIntersections()))},checkIntersections:function(){var T=this.clearedIntersectedEls,_=this.el,w=this.data,S,L=this.intersectedEls,P,D=this.intersections,U=this.newIntersectedEls,F=this.newIntersections,j=this.prevIntersectedEls,Y=this.rawIntersections;for(this.dirty&&this.refreshObjects(),x(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),Y.length=0,this.raycaster.intersectObjects(this.objects,!0,Y),D.length=0,L.length=0,S=0;S<Y.length;S++)P=Y[S],!(w.showLine&&P.object===_.getObject3D("line"))&&P.object.el&&(D.push(P),L.push(P.object.el));for(F.length=0,U.length=0,S=0;S<D.length;S++)j.indexOf(D[S].object.el)===-1&&(F.push(D[S]),U.push(D[S].object.el));for(T.length=0,S=0;S<j.length;S++)L.indexOf(j[S])===-1&&(j[S].emit(b.INTERSECT_CLEAR,this.intersectedClearedDetail),T.push(j[S]));for(T.length&&_.emit(b.INTERSECTION_CLEAR,this.intersectionClearedDetail),S=0;S<U.length;S++)U[S].emit(b.INTERSECT,this.intersectedDetail);F.length&&(this.intersectionDetail.els=U,this.intersectionDetail.intersections=F,_.emit(b.INTERSECTION,this.intersectionDetail)),(j.length===0&&D.length>0||j.length>0&&D.length===0||j.length&&D.length&&j[0]!==D[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=D,_.emit(b.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),w.showLine&&setTimeout(this.updateLine)},updateLine:function(){var T=this.el,_=this.intersections,w;_.length&&(_[0].object.el===T&&_[1]?w=_[1].distance:w=_[0].distance),this.drawLine(w)},getIntersection:function(T){var _,w;for(_=0;_<this.intersections.length;_++)if(w=this.intersections[_],w.object.el===T)return w;return null},updateOriginDirection:function(){var T=new C.Vector3,_=new C.Vector3;return function(){var S=this.el,L=this.data;if(L.useWorldCoordinates){this.raycaster.set(L.origin,L.direction);return}S.object3D.updateMatrixWorld(),_.setFromMatrixPosition(S.object3D.matrixWorld),(L.origin.x!==0||L.origin.y!==0||L.origin.z!==0)&&(_=S.object3D.localToWorld(_.copy(L.origin))),T.copy(L.direction).transformDirection(S.object3D.matrixWorld).normalize(),this.raycaster.set(_,T)}}(),drawLine:function(T){var _=this.data,w=this.el,S;S=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,T===void 0&&(T=_.far===1/0?1e3:_.far),this.lineData.start=_.origin,this.lineData.end=S.copy(this.unitLineEndVec3).multiplyScalar(T).add(_.origin),this.lineData.color=_.lineColor,this.lineData.opacity=_.lineOpacity,w.setAttribute("line",this.lineData)},flattenObject3DMaps:function(T){var _,w,S=this.objects,L=this.el.sceneEl.object3D;function P(U){return U.parent?P(U.parent):U===L}for(S.length=0,w=0;w<T.length;w++){var D=T[w];if(D.isEntity&&D.object3D&&P(D.object3D))for(_ in D.object3DMap)S.push(D.getObject3D(_))}return S},clearAllIntersections:function(){var T;for(T=0;T<this.intersectedEls.length;T++)this.intersectedEls[T].emit(b.INTERSECT_CLEAR,this.intersectedClearedDetail);x(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(b.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function x(T,_){var w;for(T.length=_.length,w=0;w<_.length;w++)T[w]=_[w]}},"./src/components/rotation.js":(m,M,h)=>{var f=h("./src/lib/three.js").MathUtils.degToRad,C=h("./src/core/component.js").registerComponent;m.exports.Component=C("rotation",{schema:{type:"vec3"},update:function(){var p=this.data,g=this.el.object3D;g.rotation.set(f(p.x),f(p.y),f(p.z),"YXZ")},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var C=this.data,p=this.el.object3D;p.scale.set(C.x,C.y,C.z)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(m,M,h)=>{var f="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",C=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),g=21,u=function(){var T=new p.Quaternion,_=new p.Vector3;function w(S,L,P){L.position.copy(S.transform.position),L.quaternion.copy(S.transform.orientation),_.copy(P),T.copy(S.transform.orientation),_.applyQuaternion(T),L.position.sub(_)}return w}();u.tempFakePose={transform:{orientation:new p.Quaternion,position:new p.Vector3}};function E(T,_){this.renderer=T,this.xrHitTestSource=null,T.xr.addEventListener("sessionend",(function(){this.xrHitTestSource=null}).bind(this)),T.xr.addEventListener("sessionstart",(function(){this.sessionStart(_)}).bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(_)}E.prototype.previousFrameAnchors=new Set,E.prototype.anchorToObject3D=new Map;function b(T){console.warn(T.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}E.prototype.sessionStart=function(_){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){b({message:"No requestHitTestSource on the session."});return}_.space?this.session.requestHitTestSource(_).then((function(w){this.xrHitTestSource=w}).bind(this)).catch(b):_.profile&&this.session.requestHitTestSourceForTransientInput(_).then((function(w){this.xrHitTestSource=w,this.transient=!0}).bind(this)).catch(b)},E.prototype.anchorFromLastHitTestResult=function(T,_){var w=this.lastHitTest;if(w){var S={object3D:T,offset:_};Array.from(this.anchorToObject3D.entries()).forEach((function(L){var P=L[1].object3D,D=L[0];P===T&&(this.anchorToObject3D.delete(D),D.delete())}).bind(this)),w.createAnchor&&w.createAnchor().then((function(L){this.anchorToObject3D.set(L,S)}).bind(this)).catch(function(L){console.warn(L.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},E.prototype.doHit=function(_){if(this.renderer.xr.isPresenting){var w=this.renderer.xr.getReferenceSpace(),S=_.getViewerPose(w),L,P;if(this.xrHitTestSource&&S)return this.transient?(L=_.getHitTestResultsForTransientInput(this.xrHitTestSource),L.length>0?(P=L[0].results,P.length>0?(this.lastHitTest=P[0],P[0].getPose(w)):!1):!1):(L=_.getHitTestResults(this.xrHitTestSource),L.length>0?(this.lastHitTest=L[0],L[0].getPose(w)):!1)}},E.updateAnchorPoses=function(T,_){var w=T.trackedAnchors||E.prototype.previousFrameAnchors;E.prototype.previousFrameAnchors.forEach(function(S){w.has(S)||E.prototype.anchorToObject3D.delete(S)}),w.forEach(function(S){var L,P,D,U;try{L=T.getPose(S.anchorSpace,_)}catch{}if(L){if(P=E.prototype.anchorToObject3D.get(S),!P)return;D=P.offset,U=P.object3D,u(L,U,D)}})};var x;m.exports.Component=C("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:f,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},sceneOnly:!0,init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(1048576),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new p.OrthographicCamera,this.orthoCam.layers.set(g),this.textureTarget=new p.WebGLRenderTarget(512,512,{}),this.basicMaterial=new p.MeshBasicMaterial({color:0,side:p.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new p.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var T=this.el.getAttribute("webxr"),_=T.optionalFeatures;(!_.includes("hit-test")||!_.includes("anchors"))&&(_.push("hit-test"),_.push("anchors"),this.el.setAttribute("webxr",T)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",(function(){this.hitTest=null}).bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",(function(){if(this.el.is("ar-mode")){var w=this.el.sceneEl.renderer,S=this.session=w.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,x||(x=new Map),S.requestReferenceSpace("viewer").then((function(D){this.hitTest=new E(w,{space:D}),x.set(D,this.hitTest),this.el.emit("ar-hit-test-start")}).bind(this));var L="generic-touchscreen",P=new E(w,{profile:L});S.addEventListener("selectstart",(function(D){if(this.data.enabled===!0){var U=D.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:U,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),U.profiles[0]===L?this.hitTest=P:(this.hitTest=x.get(U)||new E(w,{space:U.targetRaySpace}),x.set(U,this.hitTest)))}}).bind(this)),S.addEventListener("selectend",(function(D){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var U=D.inputSource,F;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(F=this.data.target.object3D,F&&(u.tempFakePose.transform.position.copy(this.bboxMesh.position),u.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),u(u.tempFakePose,F,this.bboxOffset),F.visible=!0,this.hitTest.anchorFromLastHitTestResult(F,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:U,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}).bind(this))}}).bind(this)),this.bboxOffset=new p.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(g),this.data.target.object3D.traverse(function(T){T.layers.enable(g)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var T=new p.PlaneGeometry(1,1),_=new p.MeshBasicMaterial({transparent:!0,color:16777215});T.rotateX(-Math.PI/2),T.rotateY(-Math.PI/2),this.bbox=new p.Box3,this.bboxMesh=new p.Mesh(T,_),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var T,_=this.el.sceneEl.renderer,w,S,L=_.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),w=_.getRenderTarget(),_.setRenderTarget(this.textureTarget),_.xr.enabled=!1,S=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,_.render(this.el.object3D,this.orthoCam),this.el.object3D.background=S,this.el.object3D.overrideMaterial=null,_.xr.enabled=L,_.setRenderTarget(w),_.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),T=this.context.getImageData(0,0,512,512);for(var P=0;P<262144;P++)T.data[P*4+3]!==0&&T.data[P*4+3]!==255&&(T.data[P*4+3]=128);this.context.putImageData(T,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var T,_=this.el.sceneEl.frame,w=this.el.sceneEl.renderer;if(_&&E.updateAnchorPoses(_,w.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var S;this.textureCache.has(this.data.src)?S=this.textureCache.get(this.data.src):(S=new p.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,S)),this.bboxMesh.material.map=S,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(T=this.hitTest.doHit(_),T&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(T.transform.position),this.bboxMesh.quaternion.copy(T.transform.orientation)))}})},"./src/components/scene/background.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},sceneOnly:!0,update:function(){var C=this.data,p=this.el.object3D;C.transparent?p.background=null:p.background=new THREE.Color(C.color)},remove:function(){var C=this.el.object3D;C.background=null}})},"./src/components/scene/debug.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("debug",{schema:{default:!0},sceneOnly:!0})},"./src/components/scene/device-orientation-permission-ui.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/constants/index.js"),p="a-modal",g="a-dialog",u="a-dialog-text",E="a-dialog-text-container",b="a-dialog-buttons-container",x="a-dialog-button",T="a-dialog-allow-button",_="a-dialog-deny-button",w="a-dialog-ok-button";m.exports.Component=f("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},sceneOnly:!0,init:function(){var D=this;if(this.data.enabled){if(window.isSecureContext||this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=this.onDeviceMotionDialogAllowClicked.bind(this),this.onDeviceMotionDialogDenyClicked=this.onDeviceMotionDialogDenyClicked.bind(this),DeviceOrientationEvent.requestPermission().then(function(){D.el.emit("deviceorientationpermissiongranted"),D.permissionGranted=!0}).catch(function(){D.devicePermissionDialogEl=S(D.data.denyButtonText,D.data.allowButtonText,D.data.deviceMotionMessage,D.onDeviceMotionDialogAllowClicked,D.onDeviceMotionDialogDenyClicked),D.el.appendChild(D.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var D=this,U=L(D.data.cancelButtonText,D.data.httpsMessage,function(){D.el.removeChild(U)});this.el.appendChild(U)},onDeviceMotionDialogAllowClicked:function(){var D=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(U){U==="granted"?(D.el.emit("deviceorientationpermissiongranted"),D.permissionGranted=!0):D.el.emit("deviceorientationpermissionrejected"),D.remove()}).catch(console.error)}});function S(D,U,F,j,Y){var oe,te,pe;return oe=document.createElement("div"),oe.classList.add(b),te=document.createElement("button"),te.classList.add(x,_),te.setAttribute(C.AFRAME_INJECTED,""),te.innerHTML=D,oe.appendChild(te),pe=document.createElement("button"),pe.classList.add(x,T),pe.setAttribute(C.AFRAME_INJECTED,""),pe.innerHTML=U,oe.appendChild(pe),pe.addEventListener("click",function(de){de.stopPropagation(),j()}),te.addEventListener("click",function(de){de.stopPropagation(),Y()}),P(F,oe)}function L(D,U,F){var j,Y;return j=document.createElement("div"),j.classList.add(b),Y=document.createElement("button"),Y.classList.add(x,w),Y.setAttribute(C.AFRAME_INJECTED,""),Y.innerHTML=D,j.appendChild(Y),Y.addEventListener("click",function(oe){oe.stopPropagation(),F()}),P(U,j)}function P(D,U){var F,j,Y,oe;return F=document.createElement("div"),F.classList.add(p),F.setAttribute(C.AFRAME_INJECTED,""),j=document.createElement("div"),j.className=g,j.setAttribute(C.AFRAME_INJECTED,""),F.appendChild(j),Y=document.createElement("div"),Y.classList.add(E),j.appendChild(Y),oe=document.createElement("div"),oe.classList.add(u),oe.innerHTML=D,Y.appendChild(oe),j.appendChild(U),F}},"./src/components/scene/embedded.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},sceneOnly:!0,update:function(){var C=this.el,p=C.querySelector(".a-enter-vr");this.data===!0?(p&&p.classList.add("embedded"),C.removeFullScreenStyles()):(p&&p.classList.remove("embedded"),C.addFullScreenStyles())}})},"./src/components/scene/fog.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/debug.js");p("components:fog:warn"),m.exports.Component=f("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},sceneOnly:!0,update:function(){var u=this.data,E=this.el,b=this.el.object3D.fog;if(!b||u.type!==b.name){E.object3D.fog=g(u);return}Object.keys(this.schema).forEach(function(x){var T=u[x];x==="color"&&(T=new C.Color(T)),b[x]=T})},remove:function(){var u=this.el,E=this.el.object3D.fog;E&&(u.object3D.fog=null)}});function g(u){var E;return u.type==="exponential"?E=new C.FogExp2(u.color,u.density):E=new C.Fog(u.color,u.near,u.far),E.name=u.type,E}},"./src/components/scene/inspector.js":(m,M,h)=>{var f=h("./src/constants/index.js").AFRAME_INJECTED,C=h("./package.json"),p=h("./src/core/component.js").registerComponent,g=h("./src/utils/index.js");function u(_){var w=_.split(".");return w[2]="x",w.join(".")}var E="https://unpkg.com/aframe-inspector@"+u(C.version)+"/dist/aframe-inspector.min.js",b=E,x="Loading Inspector",T="Error loading Inspector";m.exports.Component=p("inspector",{schema:{url:{default:b}},sceneOnly:!0,init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var _;this.firstPlay&&(_=g.getUrlParameter("inspector"),_!=="false"&&_&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var _='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=x+_},remove:function(){this.removeEventListeners()},onKeydown:function(_){var w=_.keyCode===73&&(_.ctrlKey&&_.altKey||_.getModifierState("AltGraph"));w&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(_){_.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(_){var w=this,S;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(_);return}this.showLoader(),S=document.createElement("script"),S.src=this.data.url,S.setAttribute("data-name","aframe-inspector"),S.setAttribute(f,""),S.onload=function(){AFRAME.INSPECTOR.open(_),w.hideLoader(),w.removeEventListeners()},S.onerror=function(){w.loadingMessageEl.innerHTML=T},document.head.appendChild(S),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/index.js").shouldCaptureKeyEvent;m.exports.Component=f("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},sceneOnly:!0,init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(p){var g=this.data;this.enterVREnabled=g.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(p){var g=this.el;C(p)&&(this.enterVREnabled&&p.keyCode===70&&g.enterVR(),this.enterVREnabled&&p.keyCode===27&&g.exitVR())}})},"./src/components/scene/pool.js":(m,M,h)=>{var f=h("./src/utils/debug.js"),C=h("./src/core/component.js").registerComponent,p=f("components:pool:warn");m.exports.Component=C("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},sceneOnly:!0,multiple:!0,initPool:function(){var g;for(this.availableEls=[],this.usedEls=[],this.data.mixin||p("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||p("Container "+this.data.container+" not found.")),this.container=this.container||this.el,g=0;g<this.data.size;++g)this.createEntity()},update:function(g){var u=this.data;(g.mixin!==u.mixin||g.size!==u.size)&&this.initPool()},createEntity:function(){var g;g=document.createElement("a-entity"),g.play=this.wrapPlay(g.play),g.setAttribute("mixin",this.data.mixin),g.object3D.visible=!1,g.pause(),this.container.appendChild(g),this.availableEls.push(g);var u=this.usedEls;g.addEventListener("loaded",function(){u.indexOf(g)===-1&&(g.object3DParent=g.object3D.parent,g.object3D.parent.remove(g.object3D))})},wrapPlay:function(g){var u=this.usedEls;return function(){u.indexOf(this)!==-1&&g.call(this)}},requestEntity:function(){var g;if(this.availableEls.length===0){if(this.data.dynamic===!1){p("Requested entity from empty pool: "+this.attrName);return}else p("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return g=this.availableEls.shift(),this.usedEls.push(g),g.object3DParent&&(g.object3DParent.add(g.object3D),this.updateRaycasters()),g.object3D.visible=!0,g},returnEntity:function(g){var u=this.usedEls.indexOf(g);if(u===-1){p("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(u,1),this.availableEls.push(g),g.object3DParent=g.object3D.parent,g.object3D.parent.remove(g.object3D),this.updateRaycasters(),g.object3D.visible=!1,g.pause(),g},updateRaycasters:function(){var g=document.querySelectorAll("[raycaster]");g.forEach(function(u){u.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js");m.exports.Component=f("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},sceneOnly:!0,init:function(){var p=this.el.getAttribute("webxr"),g=p.requiredFeatures;g.indexOf("mesh-detection")===-1&&(g.push("mesh-detection"),this.el.setAttribute("webxr",p)),g.indexOf("plane-detection")===-1&&(g.push("plane-detection"),this.el.setAttribute("webxr",p)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){this.el.is("ar-mode")&&(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var p=this.data,g,u,E=this.el;E.renderer.xr;var b,x=this.meshEntities,T=!1,_=[],w=this.data.filterLabels;b=E.frame,g=b.detectedMeshes,u=b.detectedPlanes;for(var S=0;S<x.length;S++)x[S].present=!1;if(p.meshesEnabled){for(var L of g.values())if(!(w.length&&w.indexOf(L.semanticLabel)===-1)){for(S=0;S<x.length;S++)if(L===x[S].mesh){T=!0,x[S].present=!0,x[S].lastChangedTime<L.lastChangedTime&&this.updateMeshGeometry(x[S].el,L),x[S].lastChangedTime=L.lastChangedTime;break}T||_.push(L),T=!1}}if(p.planesEnabled){for(L of u.values())if(!(w.length&&w.indexOf(L.semanticLabel)===-1)){for(S=0;S<x.length;S++)if(L===x[S].mesh){T=!0,x[S].present=!0,x[S].lastChangedTime<L.lastChangedTime&&this.updateMeshGeometry(x[S].el,L),x[S].lastChangedTime=L.lastChangedTime;break}T||_.push(L),T=!1}}this.deleteMeshes(),this.createNewMeshes(_)},updateMeshes:function(){var p=new C.Matrix4;return function(){for(var g,u=this.el,E,b=u.frame,x=this.meshEntities,T=u.renderer.xr.getReferenceSpace(),_,w=0;w<x.length;w++)_=x[w].mesh.meshSpace||x[w].mesh.planeSpace,g=b.getPose(_,T),E=x[w].el,E.hasLoaded&&(p.fromArray(g.transform.matrix),p.decompose(E.object3D.position,E.object3D.quaternion,E.object3D.scale))}}(),deleteMeshes:function(){for(var p=this.meshEntities,g=[],u=0;u<p.length;u++)p[u].present?g.push(p[u]):this.el.removeChild(p[u]);this.meshEntities=g},createNewMeshes:function(p){for(var g,u=0;u<p.length;u++)g=document.createElement("a-entity"),this.meshEntities.push({mesh:p[u],el:g}),g.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(g)},initMeshGeometry:function(p){var g,u,E;if(p instanceof XRPlane){u=new C.Shape,E=p.polygon;for(var b=0;b<E.length;++b)b===0?u.moveTo(E[b].x,E[b].z):u.lineTo(E[b].x,E[b].z);return g=new C.ShapeGeometry(u),g.rotateX(Math.PI/2),g}return g=new C.BufferGeometry,g.setAttribute("position",new C.BufferAttribute(p.vertices,3)),g.setIndex(new C.BufferAttribute(p.indices,1)),g},initWorldMeshEntity:function(p){for(var g=p.target,u,E,b,x=this.meshEntities,T=0;T<x.length;T++)if(x[T].el===g){b=x[T];break}u=this.initMeshGeometry(b.mesh),E=new C.Mesh(u,new C.MeshBasicMaterial({color:Math.random()*16777215,side:C.DoubleSide})),g.setObject3D("mesh",E),b.mesh instanceof XRPlane&&this.data.planeMixin?g.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&g.setAttribute("mixin",this.data.meshMixin),g.setAttribute("data-world-mesh",b.mesh.semanticLabel)},updateMeshGeometry:function(p,g){var u=p.getObject3D("mesh");u.geometry.dispose(),u.geometry=this.initMeshGeometry(g)}})},"./src/components/scene/reflection.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;function C(p,g,u,E){var b=Math.max(p.primaryLightIntensity.x,Math.max(p.primaryLightIntensity.y,p.primaryLightIntensity.z));g.sh.fromArray(p.sphericalHarmonicsCoefficients),g.intensity=1,u&&(u.color.setRGB(p.primaryLightIntensity.x/b,p.primaryLightIntensity.y/b,p.primaryLightIntensity.z/b),u.intensity=b,E.copy(p.primaryLightDirection))}m.exports.Component=f("reflection",{schema:{directionalLight:{type:"selector"}},sceneOnly:!0,init:function(){var p=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var g=this.el.getAttribute("webxr"),u=g.optionalFeatures;u.includes("light-estimation")||(u.push("light-estimation"),this.el.setAttribute("webxr",g)),this.el.addEventListener("enter-vr",function(){if(p.el.is("ar-mode")){var E=p.el.renderer,b=E.xr.getSession();b.requestLightProbe&&p.startLightProbe()}}),this.el.addEventListener("exit-vr",function(){p.xrLightProbe&&p.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var p=this.el.renderer,g=p.xr.getSession(),u=this,E=p.getContext();if(!this.probeLight){var b=document.createElement("a-light");b.setAttribute("type","probe"),b.setAttribute("intensity",0),this.el.appendChild(b),this.probeLight=b}switch(g.preferredReflectionFormat){case"srgba8":E.getExtension("EXT_sRGB");break;case"rgba16f":E.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(g,E),E.getExtension("EXT_sRGB"),E.getExtension("OES_texture_half_float"),g.requestLightProbe().then(function(x){u.xrLightProbe=x,x.addEventListener("reflectionchange",u.updateXRCubeMap.bind(u))}).catch(function(x){console.warn("Lighting estimation not supported: "+x.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var p=this.el.renderer,g=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(g){var u=p.properties.get(this.lightingEstimationTexture);u.__webglTexture=g,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var p=this.el.object3D,g=this.el.renderer,u=this.el.frame;if(u&&this.xrLightProbe){var E=u.getLightEstimate(this.xrLightProbe);E&&C(E,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(p.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(g,p),p.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&u&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),g=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);m.exports.Component=f("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},sceneOnly:!0,setup:function(){var u=this.el;if(!this.canvas){var E=u.renderer.getContext();E&&(this.cubeMapSize=E.getParameter(E.MAX_CUBE_MAP_TEXTURE_SIZE),this.material=new C.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:p,fragmentShader:g,side:C.DoubleSide}),this.quad=new C.Mesh(new C.PlaneGeometry(1,1),this.material),this.quad.visible=!1,this.camera=new C.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),u.object3D.add(this.quad),this.onKeyDown=this.onKeyDown.bind(this))}},getRenderTarget:function(u,E){return new C.WebGLRenderTarget(u,E,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:C.LinearFilter,magFilter:C.LinearFilter,wrapS:C.ClampToEdgeWrapping,wrapT:C.ClampToEdgeWrapping,format:C.RGBAFormat,type:C.UnsignedByteType})},resize:function(u,E){this.quad.scale.set(u,E,1),this.camera.left=-1*u/2,this.camera.right=u/2,this.camera.top=E/2,this.camera.bottom=-1*E/2,this.camera.updateProjectionMatrix(),this.canvas.width=u,this.canvas.height=E},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(u){var E=u.keyCode===83&&u.ctrlKey&&u.altKey;if(!(!this.data||!E)){var b=u.shiftKey?"equirectangular":"perspective";this.capture(b)}},setCapture:function(u){var E=this.el,b,x,T,_;return u==="perspective"?(this.quad.visible=!1,x=this.data.camera&&this.data.camera.components.camera.camera||E.camera,b={width:this.data.width,height:this.data.height}):(x=this.camera,_=new C.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:C.RGBFormat,generateMipmaps:!0,minFilter:C.LinearMipmapLinearFilter,colorSpace:C.SRGBColorSpace}),T=new C.CubeCamera(E.camera.near,E.camera.far,_),E.camera.getWorldPosition(T.position),E.camera.getWorldQuaternion(T.quaternion),T.update(E.renderer,E.object3D),this.quad.material.uniforms.map.value=T.renderTarget.texture,b={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:x,size:b,projection:u}},capture:function(u){var E=this.el.renderer.xr.enabled,b=this.el.renderer,x;this.setup(),b.xr.enabled=!1,x=this.setCapture(u),this.renderCapture(x.camera,x.size,x.projection),this.saveCapture(),b.xr.enabled=E},getCanvas:function(u){var E=this.el.renderer.xr.enabled,b=this.el.renderer;this.setup();var x=this.setCapture(u);return b.xr.enabled=!1,this.renderCapture(x.camera,x.size,x.projection),b.xr.enabled=E,this.canvas},renderCapture:function(u,E,b){var x=this.el.renderer.autoClear,T=this.el,_,w,S,L=T.renderer;w=this.getRenderTarget(E.width,E.height),S=new Uint8Array(4*E.width*E.height),this.resize(E.width,E.height),L.autoClear=!0,L.clear(),L.setRenderTarget(w),L.render(T.object3D,u),L.autoClear=x,L.readRenderTargetPixels(w,0,0,E.width,E.height,S),L.setRenderTarget(null),b==="perspective"&&(S=this.flipPixelsVertically(S,E.width,E.height)),_=new ImageData(new Uint8ClampedArray(S),E.width,E.height),this.quad.visible=!1,this.ctx.putImageData(_,0,0)},flipPixelsVertically:function(u,E,b){for(var x=u.slice(0),T=0;T<E;++T)for(var _=0;_<b;++_)x[T*4+_*E*4]=u[T*4+(b-_)*E*4],x[T*4+1+_*E*4]=u[T*4+1+(b-_)*E*4],x[T*4+2+_*E*4]=u[T*4+2+(b-_)*E*4],x[T*4+3+_*E*4]=u[T*4+3+(b-_)*E*4];return x},saveCapture:function(){this.canvas.toBlob(function(u){var E="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",b=document.createElement("a"),x=URL.createObjectURL(u);b.href=x,b.setAttribute("download",E),b.innerHTML="downloading...",b.style.display="none",document.body.appendChild(b),setTimeout(function(){b.click(),document.body.removeChild(b)},1)},"image/png")}})},"./src/components/scene/stats.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./vendor/rStats.js"),p=h("./src/utils/index.js");h("./vendor/rStats.extras.js"),h("./src/lib/rStatsAframe.js");var g=window.aframeStats,u="a-hidden",E=window.threeStats;m.exports.Component=f("stats",{schema:{default:!0},sceneOnly:!0,init:function(){var x=this.el;p.getUrlParameter("stats")!=="false"&&(this.stats=b(x),this.statsEl=document.querySelector(".rs-base"),this.hideBound=this.hide.bind(this),this.showBound=this.show.bind(this),x.addEventListener("enter-vr",this.hideBound),x.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var x=this.stats;x&&(x("rAF").tick(),x("FPS").frame(),x().update())},hide:function(){this.statsEl.classList.add(u)},show:function(){this.statsEl.classList.remove(u)}});function b(x){var T=new E(x.renderer),_=new g(x),w=x.isMobile?[]:[T,_];return new C({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:w})}},"./src/components/scene/xr-mode-ui.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/constants/index.js"),p=h("./src/utils/index.js"),g="a-enter-vr",u="a-enter-ar",E="a-enter-vr-button",b="a-enter-ar-button",x="a-hidden",T="a-orientation-modal";m.exports.Component=f("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},sceneOnly:!0,init:function(){var P=this,D=this.el;p.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),D.addEventListener("enter-vr",this.updateEnterInterfaces),D.addEventListener("exit-vr",this.updateEnterInterfaces),D.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(U){U.data.type==="loaderReady"&&(P.insideLoader=!0,P.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=this.onEnterVRButtonClick.bind(this),this.onEnterARButtonClick=this.onEnterARButtonClick.bind(this),this.onModalClick=this.onModalClick.bind(this),this.toggleOrientationModalIfNeeded=this.toggleOrientationModalIfNeeded.bind(this),this.updateEnterInterfaces=this.updateEnterInterfaces.bind(this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var P=this.data,D=this.el;if(!P.enabled||this.insideLoader||p.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&P.enterVREnabled&&(P.XRMode==="xr"||P.XRMode==="vr")&&(P.enterVRButton?(this.enterVREl=document.querySelector(P.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=_(this.onEnterVRButtonClick),D.appendChild(this.enterVREl))),!this.enterAREl&&P.enterAREnabled&&(P.XRMode==="xr"||P.XRMode==="ar")&&(P.enterARButton?(this.enterAREl=document.querySelector(P.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=w(this.onEnterARButtonClick,P.XRMode==="xr"),D.appendChild(this.enterAREl))),this.orientationModalEl=S(this.onModalClick),D.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(P){P&&P.parentNode&&P.parentNode.removeChild(P)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var P=this.el;this.enterVREl&&(P.is("vr-mode")||(P.isMobile||p.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!p.device.checkVRSupport()?this.enterVREl.classList.add(x):(p.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(x),P.enterVR(!1,!0)))},toggleEnterARButtonIfNeeded:function(){var P=this.el;this.enterAREl&&(P.is("vr-mode")||!p.device.checkARSupport()?this.enterAREl.classList.add(x):(this.enterAREl.classList.remove(x),P.enterVR(!0,!0)))},toggleOrientationModalIfNeeded:function(){var P=this.el,D=this.orientationModalEl;!D||!P.isMobile||(!p.device.isLandscape()&&P.is("vr-mode")?D.classList.remove(x):D.classList.add(x))}});function _(P){var D,U;return U=document.createElement("div"),U.classList.add(g),U.setAttribute(C.AFRAME_INJECTED,""),D=document.createElement("button"),D.className=E,D.setAttribute("title","Enter VR mode with a headset or fullscreen without"),D.setAttribute(C.AFRAME_INJECTED,""),p.device.isMobile()&&L(D),U.appendChild(D),D.addEventListener("click",function(F){P(),F.stopPropagation()}),U}function w(P,D){var U,F;return F=document.createElement("div"),F.classList.add(u),D&&F.classList.add("xr"),F.setAttribute(C.AFRAME_INJECTED,""),U=document.createElement("button"),U.className=b,U.setAttribute("title","Enter AR mode with a headset or handheld device."),U.setAttribute(C.AFRAME_INJECTED,""),p.device.isMobile()&&L(U),F.appendChild(U),U.addEventListener("click",function(j){P(),j.stopPropagation()}),F}function S(P){var D=document.createElement("div");D.className=T,D.classList.add(x),D.setAttribute(C.AFRAME_INJECTED,"");var U=document.createElement("button");return U.setAttribute(C.AFRAME_INJECTED,""),U.innerHTML="Exit VR",U.addEventListener("click",P),D.appendChild(U),D}function L(P){P.addEventListener("touchstart",function(){P.classList.remove("resethover")},{passive:!0}),P.addEventListener("touchend",function(){P.classList.add("resethover")},{passive:!0})}},"./src/components/shadow.js":(m,M,h)=>{var f=h("./src/core/component.js"),C=h("./src/lib/three.js"),p=f.registerComponent;m.exports.Component=p("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=this.update.bind(this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var g=this.data;this.updateDescendants(g.cast,g.receive)},remove:function(){var g=this.el;g.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(g,u){var E=this.el.sceneEl;this.el.object3D.traverse(function(b){if(b instanceof C.Mesh&&(b.castShadow=g,b.receiveShadow=u,E.hasLoaded&&b.material))for(var x=Array.isArray(b.material)?b.material:[b.material],T=0;T<x.length;T++)x[T].needsUpdate=!0})}})},"./src/components/sound.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/debug.js"),p=h("./src/lib/three.js"),g=C("components:sound:warn");m.exports.Component=f("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var u=this;this.listener=null,this.audioLoader=new p.AudioLoader,this.pool=new p.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){u.playSound()}},update:function(u){var E=this.data,b,x,T=E.src!==u.src;if(T){if(!E.src)return;this.setupSound()}for(b=0;b<this.pool.children.length;b++)x=this.pool.children[b],E.positional&&(x.setDistanceModel(E.distanceModel),x.setMaxDistance(E.maxDistance),x.setRefDistance(E.refDistance),x.setRolloffFactor(E.rolloffFactor)),x.setLoop(E.loop),x.setLoopStart(E.loopStart),E.loopStart!==0&&E.loopEnd===0?x.setLoopEnd(x.buffer.duration):x.setLoopEnd(E.loopEnd),x.setVolume(E.volume),x.isPaused=!1;if(E.on!==u.on&&this.updateEventListener(u.on),T){var _=this;this.loaded=!1,this.audioLoader.load(E.src,function(w){for(b=0;b<_.pool.children.length;b++)x=_.pool.children[b],x.setBuffer(w);_.loaded=!0,p.Cache.remove(E.src),(_.data.autoplay||_.mustPlay)&&_.playSound(_.processSound),_.el.emit("sound-loaded",_.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var u,E;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(u=0;u<this.pool.children.length;u++)E=this.pool.children[u],E.disconnect()}catch{g("Audio source not properly disconnected")}},updateEventListener:function(u){var E=this.el;u&&E.removeEventListener(u,this.playSoundBound),E.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var u=this.el,E,b=u.sceneEl,x=this,T;this.pool.children.length>0&&(this.stopSound(),u.removeObject3D("sound"));var _=this.listener=b.audioListener||new p.AudioListener;for(b.audioListener=_,b.camera&&b.camera.add(_),b.addEventListener("camera-set-active",function(w){w.detail.cameraEl.getObject3D("camera").add(_)}),this.pool=new p.Group,E=0;E<this.data.poolSize;E++)T=this.data.positional?new p.PositionalAudio(_):new p.Audio(_),this.pool.add(T);for(u.setObject3D(this.attrName,this.pool),E=0;E<this.pool.children.length;E++)T=this.pool.children[E],T.onEnded=function(){this.isPlaying=!1,x.el.emit("sound-ended",x.evtDetail,!1)}},pauseSound:function(){var u,E;for(this.isPlaying=!1,u=0;u<this.pool.children.length;u++)E=this.pool.children[u],!(!E.source||!E.source.buffer||!E.isPlaying||E.isPaused)&&(E.isPaused=!0,E.pause())},playSound:function(u){var E,b,x;if(!this.loaded){g("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=u;return}for(E=!1,this.isPlaying=!0,b=0;b<this.pool.children.length;b++)if(x=this.pool.children[b],!x.isPlaying&&x.buffer&&!E){u&&u(x),x.play(),x.isPaused=!1,E=!0;continue}if(!E){g("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var u,E;for(this.isPlaying=!1,u=0;u<this.pool.children.length;u++){if(E=this.pool.children[u],!E.source||!E.source.buffer)return;E.stop()}}})},"./src/components/text.js":(m,M,h)=>{var f=h("./node_modules/three-bmfont-text/index.js"),C=h("./node_modules/load-bmfont/browser.js"),p=h("./src/core/component.js").registerComponent,g=h("./src/core/shader.js"),u=h("./src/lib/three.js"),E=h("./src/utils/index.js"),b=E.debug("components:text:error"),x=g.shaders,T=E.debug("components:text:warn"),_=1,w=16,S=h("./src/constants/index.js").AFRAME_CDN_ROOT,L=S+"fonts/",P={aileronsemibold:L+"Aileron-Semibold.fnt",dejavu:L+"DejaVu-sdf.fnt",exo2bold:L+"Exo2Bold.fnt",exo2semibold:L+"Exo2SemiBold.fnt",kelsonsans:L+"KelsonSans.fnt",monoid:L+"Monoid.fnt",mozillavr:L+"mozillavr.fnt",roboto:L+"Roboto-msdf.json",sourcecodepro:L+"SourceCodePro.fnt"},D=["roboto"],U="roboto";m.exports.FONTS=P;var F=new ae,j={},Y={},oe=/^\w+:/;m.exports.Component=p("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:U},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:x},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=f(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(ue){var Me=this.data,De=this.currentFont;if(Y[Me.font]?this.texture=Y[Me.font]:(this.texture=Y[Me.font]=new u.Texture,this.texture.anisotropy=w),this.createOrUpdateMaterial(),ue.font!==Me.font){this.updateFont();return}De&&(this.updateGeometry(this.geometry,De),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var ue=this.data,Me,De=this.material,Ge,Xe=this.shaderData,Je;if(Je=ue.shader,D.indexOf(ue.font)!==-1||ue.font.indexOf("-msdf.")>=0?Je="msdf":ue.font in P&&D.indexOf(ue.font)===-1&&(Je="sdf"),Me=(this.shaderObject&&this.shaderObject.name)!==Je,Xe.alphaTest=ue.alphaTest,Xe.color=ue.color,Xe.map=this.texture,Xe.opacity=ue.opacity,Xe.side=te(ue.side),Xe.transparent=ue.transparent,Xe.negate=ue.negate,!Me){this.shaderObject.update(Xe),De.transparent=Xe.transparent,De.side=Xe.side;return}Ge=se(this.el,Je,Xe),this.material=Ge.material,this.shaderObject=Ge.shader,this.material.side=Xe.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var ue=this.data,Me=this.el,De,Ge=this.geometry,Xe=this;ue.font||T("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),De=this.lookupFont(ue.font||U)||ue.font,F.get(De,function(){return pe(De,ue.yOffset)}).then(function(pt){var yt;if(pt.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");j[De]||(pt.widthFactor=j[pt]=H(pt)),Xe.currentFont=pt,yt=Xe.getFontImageSrc(),F.get(yt,function(){return de(yt)}).then(function(Gt){var Et=Xe.texture;Et&&(Et.image=Gt,Et.needsUpdate=!0,Y[ue.font]=Et,Xe.texture=Et,Xe.initMesh(),Xe.currentFont=pt,Xe.updateGeometry(Ge,pt),Xe.updateLayout(),Xe.mesh.visible=!0,Me.emit("textfontset",{font:ue.font,fontObj:pt}))}).catch(function(Gt){b(Gt.message),b(Gt.stack)})}).catch(function(Je){b(Je.message),b(Je.stack)})},initMesh:function(){this.mesh||(this.mesh=new u.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var ue=this.lookupFont(this.data.font||U)||this.data.font,Me=this.currentFont.pages[0];return Me.match(oe)&&Me.indexOf("http")!==0?ue.replace(/(\.fnt)|(\.json)/,".png"):u.LoaderUtils.extractUrlBase(ue)+Me},updateLayout:function(){var ue,Me,De=this.el,Ge=this.data,Xe=this.geometry,Je,pt,yt,Gt=this.mesh,Et,Vt,Yt,gi,Ri;if(!(!Gt||!Xe.layout)){if(Je=De.getAttribute("geometry"),Yt=Ge.width||Je&&Je.width||_,Et=J(Ge.wrapPixels,Ge.wrapCount,this.currentFont.widthFactor),Vt=Yt/Et,yt=Xe.layout,pt=Vt*(yt.height+yt.descender),Je&&Je.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!Je.width,this.hasExplicitGeoHeight=!!Je.height),this.hasExplicitGeoWidth||De.setAttribute("geometry","width",Yt),this.hasExplicitGeoHeight||De.setAttribute("geometry","height",pt)),ue=Ge.anchor==="align"?Ge.align:Ge.anchor,ue==="left")gi=0;else if(ue==="right")gi=-1*yt.width;else if(ue==="center")gi=-1*yt.width/2;else throw new TypeError("Invalid text.anchor property value",ue);if(Me=Ge.baseline,Me==="bottom")Ri=0;else if(Me==="top")Ri=-1*yt.height+yt.ascender;else if(Me==="center")Ri=-1*yt.height/2;else throw new TypeError("Invalid text.baseline property value",Me);Gt.position.x=gi*Vt+Ge.xOffset,Gt.position.y=Ri*Vt,Gt.position.z=Ge.zOffset,Gt.scale.set(Vt,-1*Vt,Vt)}},lookupFont:function(ue){return P[ue]},updateGeometry:function(){var ue={},Me={},De=/\\n/g,Ge=/\\t/g;return function(Xe,Je){var pt=this.data;Me.font=Je,Me.lineHeight=pt.lineHeight&&isFinite(pt.lineHeight)?pt.lineHeight:Je.common.lineHeight,Me.text=pt.value.toString().replace(De,`
`).replace(Ge,"	"),Me.width=J(pt.wrapPixels,pt.wrapCount,Je.widthFactor),Xe.update(E.extend(ue,pt,Me))}}()});function te(ue){switch(ue){case"back":return u.FrontSide;case"double":return u.DoubleSide;default:return u.BackSide}}function pe(ue,Me){return new Promise(function(De,Ge){C(ue,function(Xe,Je){if(Xe){b("Error loading font",ue),Ge(Xe);return}ue.indexOf("/Roboto-msdf.json")>=0&&(Me=30),Me&&Je.chars.map(function(yt){yt.yoffset+=Me}),De(Je)})})}function de(ue){return new Promise(function(Me,De){new u.ImageLoader().load(ue,function(Ge){Me(Ge)},void 0,function(){b("Error loading font image",ue),De(null)})})}function se(ue,Me,De){var Ge,Xe;return Xe=new x[Me].Shader,Xe.el=ue,Xe.init(De),Xe.update(De),Ge=Xe.material,Ge.transparent=De.transparent,{material:Ge,shader:Xe}}function J(ue,Me,De){return ue||(.5+Me)*De}function H(ue){var Me=0,De=0,Ge=0;return ue.chars.map(function(Xe){Me+=Xe.xadvance,Xe.id>=48&&Xe.id<=57&&(Ge++,De+=Xe.xadvance)}),Ge?De/Ge:Me/ue.chars.length}function ae(){var ue=this.cache={};this.get=function(Me,De){return Me in ue||(ue[Me]=De()),ue[Me]}}},"./src/components/tracked-controls-webvr.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/tracked-controls.js"),p=h("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,g=h("./src/lib/three.js"),u=h("./src/constants/index.js").DEFAULT_HANDEDNESS,E={x:.175,y:-.3,z:-.03},b={x:0,y:0,z:-.175},x={touches:[]},T={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};m.exports.Component=f("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new g.Vector3,this.controllerQuaternion=new g.Quaternion,this.controllerEuler=new g.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(_,w){var S=this.el.getObject3D("mesh");S&&S.update&&S.update(w/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return p},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var _=this.data,w=C.findMatchingControllerWebVR(this.system.controllers,_.id,_.idPrefix,_.hand,_.controller);this.controller=w,this.el.components["tracked-controls"].controller=w,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(_){var w=this.controller,S=this.controllerEuler,L=this.controllerQuaternion,P=this.deltaControllerPosition,D,U,F,j,Y;U=this.getHeadElement(),F=U.object3D,Y=this.defaultUserHeight(),j=w.pose,D=(w?w.hand:void 0)||u,_.copy(F.position),P.set(E.x*(D==="left"?-1:D==="right"?1:0),E.y,E.z),P.multiplyScalar(Y),P.applyAxisAngle(F.up,F.rotation.y),_.add(P),P.set(b.x,b.y,b.z),P.multiplyScalar(Y),j.orientation?L.fromArray(j.orientation):L.copy(F.quaternion),S.setFromQuaternion(L),S.set(S.x,S.y,0),P.applyEuler(S),_.add(P)},updatePose:function(){var _=this.controller,w=this.data,S=this.el.object3D,L,P=this.system.vrDisplay,D;_&&(L=_.pose,L.position?S.position.fromArray(L.position):w.armModel&&this.applyArmModel(S.position),L.orientation&&S.quaternion.fromArray(L.orientation),P&&L.position&&(D=this.el.sceneEl.renderer.xr.getStandingMatrix(),S.matrix.compose(S.position,S.quaternion,S.scale),S.matrix.multiplyMatrices(D,S.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),S.rotateX(this.data.orientationOffset.x*g.MathUtils.DEG2RAD),S.rotateY(this.data.orientationOffset.y*g.MathUtils.DEG2RAD),S.rotateZ(this.data.orientationOffset.z*g.MathUtils.DEG2RAD))},updateButtons:function(){var _,w=this.controller,S;if(w){for(S=0;S<w.buttons.length;++S)this.buttonStates[S]||(this.buttonStates[S]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[S]||(this.buttonEventDetails[S]={id:S,state:this.buttonStates[S]}),_=w.buttons[S],this.handleButton(S,_);this.handleAxes()}},handleButton:function(_,w){var S;return S=this.handlePress(_,w)|this.handleTouch(_,w)|this.handleValue(_,w),S?(this.el.emit(T.BUTTONCHANGED,this.buttonEventDetails[_],!1),!0):!1},handleAxes:function(){var _=!1,w=this.controller.axes,S,L=this.axis,P=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),S=0;S<w.length;++S)P.push(L[S]!==w[S]),P[S]&&(_=!0);if(!_)return!1;for(this.axis.splice(0,this.axis.length),S=0;S<w.length;S++)this.axis.push(w[S]);return this.el.emit(T.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(_,w){var S,L=this.buttonStates[_];return w.pressed===L.pressed?!1:(S=w.pressed?T.BUTTONDOWN:T.BUTTONUP,this.el.emit(S,this.buttonEventDetails[_],!1),L.pressed=w.pressed,!0)},handleTouch:function(_,w){var S,L=this.buttonStates[_];return w.touched===L.touched?!1:(S=w.touched?T.TOUCHSTART:T.TOUCHEND,this.el.emit(S,this.buttonEventDetails[_],!1,x),L.touched=w.touched,!0)},handleValue:function(_,w){var S=this.buttonStates[_];return w.value===S.value?!1:(S.value=w.value,!0)}})},"./src/components/tracked-controls-webxr.js":(m,M,h)=>{var f=h("./src/utils/tracked-controls.js"),C=h("./src/core/component.js").registerComponent,p={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};m.exports.Component=C("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var g=this.el.sceneEl;this.updateController(),g.addEventListener("controllersupdated",this.updateController)},pause:function(){var g=this.el.sceneEl;g.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(g){return!(!this.controller||this.controller.gamepad||g.inputSource.handedness!=="none"&&g.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=f.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var g=this.el.sceneEl,u=this.controller,E=g.frame;!u||!g.frame||!this.system.referenceSpace||u.hand||(this.pose=E.getPose(u[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var g=this.el.object3D,u=this.pose;u&&(g.matrix.elements=u.transform.matrix,g.matrix.decompose(g.position,g.rotation,g.scale))},updateButtons:function(){var g,u,E=this.controller,b;if(!(!E||!E.gamepad)){for(b=E.gamepad,u=0;u<b.buttons.length;++u)this.buttonStates[u]||(this.buttonStates[u]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[u]||(this.buttonEventDetails[u]={id:u,state:this.buttonStates[u]}),g=b.buttons[u],this.handleButton(u,g);this.handleAxes()}},handleButton:function(g,u){var E;return E=this.handlePress(g,u)|this.handleTouch(g,u)|this.handleValue(g,u),E?(this.el.emit(p.BUTTONCHANGED,this.buttonEventDetails[g],!1),!0):!1},handleAxes:function(){var g=!1,u=this.controller.gamepad.axes,E,b=this.axis,x=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),E=0;E<u.length;++E)x.push(b[E]!==u[E]),x[E]&&(g=!0);if(!g)return!1;for(this.axis.splice(0,this.axis.length),E=0;E<u.length;E++)this.axis.push(u[E]);return this.el.emit(p.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(g,u){var E,b=this.buttonStates[g];return u.pressed===b.pressed?!1:(E=u.pressed?p.BUTTONDOWN:p.BUTTONUP,this.el.emit(E,this.buttonEventDetails[g],!1),b.pressed=u.pressed,!0)},handleTouch:function(g,u){var E,b=this.buttonStates[g];return u.touched===b.touched?!1:(E=u.touched?p.TOUCHSTART:p.TOUCHEND,this.el.emit(E,this.buttonEventDetails[g],!1),b.touched=u.touched,!0)},handleValue:function(g,u){var E=this.buttonStates[g];return u.value===E.value?!1:(E.value=u.value,!0)}})},"./src/components/tracked-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},after:["tracked-controls-webvr","tracked-controls-webxr"],update:function(){var C=this.data,p=this.el;p.sceneEl.hasWebXR?p.setAttribute("tracked-controls-webxr",{id:C.id,hand:C.hand,index:C.controller,iterateControllerProfiles:C.iterateControllerProfiles,handTrackingEnabled:C.handTrackingEnabled,space:C.space}):p.setAttribute("tracked-controls-webvr",C)}})},"./src/components/valve-index-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=h("./src/utils/tracked-controls.js"),g=p.checkControllerPresentAndSetup,u=p.emitIfAxesChanged,E=p.onButtonEvent,b=h("./src/constants/index.js").AFRAME_CDN_ROOT,x=b+"controllers/valve/index/valve-index-",T={left:x+"left.glb",right:x+"right.glb"},_="valve",w=h("./src/utils/index.js").device.isWebXRAvailable,S={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},L={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},P={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},D={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},U=w?D:P,F=w?L:S;m.exports.Component=f("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var j=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(Y){E(Y.detail.id,"down",j)},this.onButtonUp=function(Y){E(Y.detail.id,"up",j)},this.onButtonTouchEnd=function(Y){E(Y.detail.id,"touchend",j)},this.onButtonTouchStart=function(Y){E(Y.detail.id,"touchstart",j)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var j=this.el;j.addEventListener("buttonchanged",this.onButtonChanged),j.addEventListener("buttondown",this.onButtonDown),j.addEventListener("buttonup",this.onButtonUp),j.addEventListener("touchend",this.onButtonTouchEnd),j.addEventListener("touchstart",this.onButtonTouchStart),j.addEventListener("model-loaded",this.onModelLoaded),j.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var j=this.el;j.removeEventListener("buttonchanged",this.onButtonChanged),j.removeEventListener("buttondown",this.onButtonDown),j.removeEventListener("buttonup",this.onButtonUp),j.removeEventListener("touchend",this.onButtonTouchEnd),j.removeEventListener("touchstart",this.onButtonTouchStart),j.removeEventListener("model-loaded",this.onModelLoaded),j.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var j=this.data,Y=j.hand==="right"?0:j.hand==="left"?1:2;g(this,_,{index:Y,iterateControllerProfiles:!0,hand:j.hand})},injectTrackedControls:function(){var j=this.el,Y=this.data;j.setAttribute("tracked-controls",{idPrefix:_,controller:Y.hand==="right"?1:Y.hand==="left"?0:2,hand:Y.hand,orientationOffset:Y.orientationOffset}),this.loadModel()},loadModel:function(){var j=this.data;j.model&&this.el.setAttribute("gltf-model",""+T[j.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(j){var Y=this.mapping.buttons[j.detail.id],oe=this.buttonMeshes,te;Y&&(Y==="trigger"&&(te=j.detail.state.value,oe&&oe.trigger&&(oe.trigger.rotation.x=this.triggerOriginalRotationX-te*(Math.PI/40))),this.el.emit(Y+"changed",j.detail.state))},onModelLoaded:function(j){var Y,oe=j.detail.model,te=this;j.target!==this.el||!this.data.model||(Y=this.buttonMeshes={},Y.grip={left:oe.getObjectByName("leftgrip"),right:oe.getObjectByName("rightgrip")},Y.menu=oe.getObjectByName("menubutton"),Y.system=oe.getObjectByName("systembutton"),Y.trackpad=oe.getObjectByName("touchpad"),Y.trigger=oe.getObjectByName("trigger"),this.triggerOriginalRotationX=Y.trigger.rotation.x,Object.keys(Y).forEach(function(pe){te.setButtonColor(pe,te.data.buttonColor)}),oe.position.copy(F[this.data.hand]),oe.rotation.copy(U[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controls",model:this.data.model,rayOrigin:new C.Vector3(0,0,0)}))},onAxisMoved:function(j){u(this,this.mapping.axes,j)},updateModel:function(j,Y){var oe,te;this.data.model&&(te=Y.indexOf("touch")!==-1,!te&&(oe=Y==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(j,oe)))},setButtonColor:function(j,Y){}})},"./src/components/visible.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent;m.exports.Component=f("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/tracked-controls.js"),p=C.checkControllerPresentAndSetup,g=C.emitIfAxesChanged,u=C.onButtonEvent,E=h("./src/constants/index.js").AFRAME_CDN_ROOT,b=E+"controllers/vive/vr_controller_vive.obj",x=E+"controllers/vive/vr_controller_vive.mtl",T=h("./src/utils/index.js").device.isWebXRAvailable,_="htc-vive",w="OpenVR ",S=T?_:w,L={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},P={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","none"]},D=T?P:L;m.exports.Component=f("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:D,init:function(){var U=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(F){u(F.detail.id,"down",U)},this.onButtonUp=function(F){u(F.detail.id,"up",U)},this.onButtonTouchEnd=function(F){u(F.detail.id,"touchend",U)},this.onButtonTouchStart=function(F){u(F.detail.id,"touchstart",U)},this.previousButtonValues={},this.bindMethods()},update:function(){var U=this.data;this.controllerIndex=U.hand==="right"?0:U.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var U=this.el;U.addEventListener("buttonchanged",this.onButtonChanged),U.addEventListener("buttondown",this.onButtonDown),U.addEventListener("buttonup",this.onButtonUp),U.addEventListener("touchend",this.onButtonTouchEnd),U.addEventListener("touchstart",this.onButtonTouchStart),U.addEventListener("model-loaded",this.onModelLoaded),U.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var U=this.el;U.removeEventListener("buttonchanged",this.onButtonChanged),U.removeEventListener("buttondown",this.onButtonDown),U.removeEventListener("buttonup",this.onButtonUp),U.removeEventListener("touchend",this.onButtonTouchEnd),U.removeEventListener("touchstart",this.onButtonTouchStart),U.removeEventListener("model-loaded",this.onModelLoaded),U.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var U=this.data;p(this,S,{index:this.controllerIndex,hand:U.hand})},injectTrackedControls:function(){var U=this.el,F=this.data;U.setAttribute("tracked-controls",{idPrefix:S,hand:F.hand,controller:this.controllerIndex,orientationOffset:F.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:b,mtl:x})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(U){var F=this.mapping.buttons[U.detail.id],j=this.buttonMeshes,Y;F&&(F==="trigger"&&(Y=U.detail.state.value,j&&j.trigger&&(j.trigger.rotation.x=-Y*(Math.PI/12))),this.el.emit(F+"changed",U.detail.state))},onModelLoaded:function(U){var F,j=U.detail.model,Y=this;U.target!==this.el||!this.data.model||(F=this.buttonMeshes={},F.grip={left:j.getObjectByName("leftgrip"),right:j.getObjectByName("rightgrip")},F.menu=j.getObjectByName("menubutton"),F.system=j.getObjectByName("systembutton"),F.trackpad=j.getObjectByName("touchpad"),F.touchpad=j.getObjectByName("touchpad"),F.trigger=j.getObjectByName("trigger"),Object.keys(F).forEach(function(oe){Y.setButtonColor(oe,Y.data.buttonColor)}),j.position.set(0,-.015,.04))},onAxisMoved:function(U){g(this,this.mapping.axes,U)},updateModel:function(U,F){var j,Y;this.data.model&&(Y=F.indexOf("touch")!==-1,!Y&&(j=F==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(U,j)))},setButtonColor:function(U,F){var j=this.buttonMeshes;if(j){if(U==="grip"){j.grip.left.material.color.set(F),j.grip.right.material.color.set(F);return}j[U].material.color.set(F)}}})},"./src/components/vive-focus-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/tracked-controls.js"),p=C.checkControllerPresentAndSetup,g=C.emitIfAxesChanged,u=C.onButtonEvent,E=h("./src/constants/index.js").AFRAME_CDN_ROOT,b=E+"controllers/vive/focus-controller/focus-controller.gltf",x=h("./src/utils/index.js").device.isWebXRAvailable,T="htc-vive-focus",_="HTC Vive Focus ",w=x?T:_,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},L={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},P=x?L:S;m.exports.Component=f("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},after:["tracked-controls"],mapping:P,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var D=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(U){u(U.detail.id,"down",D)},this.onButtonUp=function(U){u(U.detail.id,"up",D)},this.onButtonTouchStart=function(U){u(U.detail.id,"touchstart",D)},this.onButtonTouchEnd=function(U){u(U.detail.id,"touchend",D)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var D=this.el;D.addEventListener("buttonchanged",this.onButtonChanged),D.addEventListener("buttondown",this.onButtonDown),D.addEventListener("buttonup",this.onButtonUp),D.addEventListener("touchstart",this.onButtonTouchStart),D.addEventListener("touchend",this.onButtonTouchEnd),D.addEventListener("model-loaded",this.onModelLoaded),D.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var D=this.el;D.removeEventListener("buttonchanged",this.onButtonChanged),D.removeEventListener("buttondown",this.onButtonDown),D.removeEventListener("buttonup",this.onButtonUp),D.removeEventListener("touchstart",this.onButtonTouchStart),D.removeEventListener("touchend",this.onButtonTouchEnd),D.removeEventListener("model-loaded",this.onModelLoaded),D.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){p(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var D=this.el,U=this.data;D.setAttribute("tracked-controls",{armModel:U.armModel,idPrefix:w,orientationOffset:U.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",b)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(D){var U=D.detail.model,F;D.target!==this.el||!this.data.model||(F=this.buttonMeshes={},F.trigger=U.getObjectByName("BumperKey"),F.triggerPressed=U.getObjectByName("BumperKey_Press"),F.triggerPressed&&(F.triggerPressed.visible=!1),F.trackpad=U.getObjectByName("TouchPad"),F.trackpadPressed=U.getObjectByName("TouchPad_Press"),F.trackpadPressed&&(F.trackpadPressed.visible=!1))},onButtonChanged:function(D){var U=this.mapping.buttons[D.detail.id];U&&this.el.emit(U+"changed",D.detail.state)},onAxisMoved:function(D){g(this,this.mapping.axes,D)},updateModel:function(D,U){this.data.model&&this.updateButtonModel(D,U)},updateButtonModel:function(D,U){var F=this.buttonMeshes,j=D+"Pressed";if(!(!F||!F[D]||!F[j])){var Y;switch(U){case"down":Y=this.data.buttonHighlightColor;break;case"touchstart":Y=this.data.buttonTouchedColor;break}Y&&F[j].material.color.set(Y),F[j].visible=!!Y,F[D].visible=!Y}}})},"./src/components/wasd-controls.js":(m,M,h)=>{var f=h("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,C=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),g=h("./src/utils/index.js"),u=g.shouldCaptureKeyEvent,E=1e-5,b=.2,x=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];m.exports.Component=C("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},after:["look-controls"],init:function(){this.keys={},this.easing=1.1,this.velocity=new p.Vector3,this.onBlur=this.onBlur.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onFocus=this.onFocus.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.attachVisibilityEventListeners()},tick:function(_,w){var S=this.data,L=this.el,P=this.velocity;!P[S.adAxis]&&!P[S.wsAxis]&&T(this.keys)||(w=w/1e3,this.updateVelocity(w),!(!P[S.adAxis]&&!P[S.wsAxis])&&L.object3D.position.add(this.getMovementVector(w)))},update:function(_){_.adAxis!==this.data.adAxis&&(this.velocity[_.adAxis]=0),_.wsAxis!==this.data.wsAxis&&(this.velocity[_.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(_){var w,S,L,P=this.data,D=this.keys,U=this.velocity,F,j;if(S=P.adAxis,F=P.wsAxis,_>b){U[S]=0,U[F]=0;return}var Y=Math.pow(1/this.easing,_*60);U[S]!==0&&(U[S]=U[S]*Y),U[F]!==0&&(U[F]=U[F]*Y),Math.abs(U[S])<E&&(U[S]=0),Math.abs(U[F])<E&&(U[F]=0),P.enabled&&(w=P.acceleration,P.adEnabled&&(L=P.adInverted?-1:1,(D.KeyA||D.ArrowLeft)&&(U[S]-=L*w*_),(D.KeyD||D.ArrowRight)&&(U[S]+=L*w*_)),P.wsEnabled&&(j=P.wsInverted?-1:1,(D.KeyW||D.ArrowUp)&&(U[F]-=j*w*_),(D.KeyS||D.ArrowDown)&&(U[F]+=j*w*_)))},getMovementVector:function(){var _=new p.Vector3(0,0,0),w=new p.Euler(0,0,0,"YXZ");return function(S){var L=this.el.getAttribute("rotation"),P=this.velocity,D;return _.copy(P),_.multiplyScalar(S),L&&(D=this.data.fly?L.x:0,w.set(p.MathUtils.degToRad(D),p.MathUtils.degToRad(L.y),0),_.applyEuler(w)),_}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var _=Object.keys(this.keys),w=0;w<_.length;w++)delete this.keys[_[w]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(_){var w;u(_)&&(w=_.code||f[_.keyCode],x.indexOf(w)!==-1&&(this.keys[w]=!0))},onKeyUp:function(_){var w;w=_.code||f[_.keyCode],delete this.keys[w]}});function T(_){var w;for(w in _)return!1;return!0}},"./src/components/windows-motion-controls.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/utils/tracked-controls.js"),p=C.checkControllerPresentAndSetup,g=C.emitIfAxesChanged,u=C.onButtonEvent,E=h("./src/utils/index.js"),b=E.debug("components:windows-motion-controls:debug"),x=E.debug("components:windows-motion-controls:warn"),T=h("./src/constants/index.js").DEFAULT_HANDEDNESS,_=h("./src/constants/index.js").AFRAME_CDN_ROOT,w=_+"controllers/microsoft/",S={left:"left.glb",right:"right.glb",default:"universal.glb"},L=h("./src/utils/index.js").device.isWebXRAvailable,P="windows-mixed-reality",D="Spatial Controller (Spatial Interaction Source) ",U=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,F=L?P:D,j={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},Y={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},oe=L?Y:j;m.exports.Component=f("windows-motion-controls",{schema:{hand:{default:T},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},after:["tracked-controls"],mapping:oe,bindMethods:function(){this.onModelError=this.onModelError.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var te=this,pe=this.el;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(de){u(de.detail.id,"down",te)},this.onButtonUp=function(de){u(de.detail.id,"up",te)},this.onButtonTouchStart=function(de){u(de.detail.id,"touchstart",te)},this.onButtonTouchEnd=function(de){u(de.detail.id,"touchend",te)},this.onControllerConnected=function(){te.setModelVisibility(!0)},this.onControllerDisconnected=function(){te.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},pe.addEventListener("controllerconnected",this.onControllerConnected),pe.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var te=this.el;te.addEventListener("buttonchanged",this.onButtonChanged),te.addEventListener("buttondown",this.onButtonDown),te.addEventListener("buttonup",this.onButtonUp),te.addEventListener("touchstart",this.onButtonTouchStart),te.addEventListener("touchend",this.onButtonTouchEnd),te.addEventListener("axismove",this.onAxisMoved),te.addEventListener("model-error",this.onModelError),te.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var te=this.el;te.removeEventListener("buttonchanged",this.onButtonChanged),te.removeEventListener("buttondown",this.onButtonDown),te.removeEventListener("buttonup",this.onButtonUp),te.removeEventListener("touchstart",this.onButtonTouchStart),te.removeEventListener("touchend",this.onButtonTouchEnd),te.removeEventListener("axismove",this.onAxisMoved),te.removeEventListener("model-error",this.onModelError),te.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){p(this,F,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var te=this.createControllerModelUrl();this.loadModel(te)},createControllerModelUrl:function(te){var pe=this.el.components["tracked-controls"],de=pe?pe.controller:null,se="default",J=this.data.hand,H;if(de&&!window.hasNativeWebXRImplementation&&(J=de.hand,!te)){var ae=de.id.match(U);se=ae&&ae[0]||se}return H=S[J]||S.default,w+se+"/"+H},injectTrackedControls:function(){var te=this.data;this.el.setAttribute("tracked-controls",{idPrefix:F,controller:te.pair,hand:te.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(te){var pe=this.createControllerModelUrl(!0);te.detail.src!==pe?(x("Failed to load controller model for device, attempting to load default."),this.loadModel(pe)):x("Failed to load default controller model.")},loadModel:function(te){this.el.setAttribute("gltf-model","url("+te+")")},onModelLoaded:function(te){var pe=this.controllerModel=te.detail.model,de=this.loadedMeshInfo,se,J,H,ae;if(te.target!==this.el)return;if(b("Processing model"),de.buttonMeshes={},de.axisMeshes={},pe){for(se=0;se<this.mapping.buttons.length;se++){if(J=this.mapping.buttonMeshNames[this.mapping.buttons[se]],!J){b("Skipping unknown button at index: "+se+" with mapped name: "+this.mapping.buttons[se]);continue}if(H=pe.getObjectByName(J),!H){x("Missing button mesh with name: "+J);continue}ae={index:se,value:ue(H,"VALUE"),pressed:ue(H,"PRESSED"),unpressed:ue(H,"UNPRESSED")},ae.value&&ae.pressed&&ae.unpressed?de.buttonMeshes[this.mapping.buttons[se]]=ae:x("Missing button submesh under mesh with name: "+J+"(VALUE: "+!!ae.value+", PRESSED: "+!!ae.pressed+", UNPRESSED:"+!!ae.unpressed+")")}for(se=0;se<this.mapping.axisMeshNames.length;se++){if(J=this.mapping.axisMeshNames[se],!J){b("Skipping unknown axis at index: "+se);continue}if(H=pe.getObjectByName(J),!H){x("Missing axis mesh with name: "+J);continue}ae={index:se,value:ue(H,"VALUE"),min:ue(H,"MIN"),max:ue(H,"MAX")},ae.value&&ae.min&&ae.max?de.axisMeshes[se]=ae:x("Missing axis submesh under mesh with name: "+J+"(VALUE: "+!!ae.value+", MIN: "+!!ae.min+", MAX:"+!!ae.max+")")}this.calculateRayOriginFromMesh(pe),this.setModelVisibility()}b("Model load complete.");function ue(Me,De){for(var Ge=0,Xe=Me.children.length;Ge<Xe;Ge++){var Je=Me.children[Ge];if(Je&&Je.name===De)return Je}}},calculateRayOriginFromMesh:function(){var te=new THREE.Quaternion;return function(pe){var de;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,de=pe.getObjectByName(this.mapping.pointingPoseMeshName),de){var se=pe.parent;se&&(pe.parent=null,pe.updateMatrixWorld(!0),pe.parent=se),de.getWorldPosition(this.rayOrigin.origin),de.getWorldQuaternion(te),this.rayOrigin.direction.applyQuaternion(te),se&&pe.updateMatrixWorld(!0)}else b("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var te=new THREE.Quaternion;return function(pe,de){var se=this.loadedMeshInfo.axisMeshes[pe];if(se){var J=se.min,H=se.max,ae=se.value,ue=de*.5+.5;ae.setRotationFromQuaternion(te.copy(J.quaternion).slerp(H.quaternion,ue)),ae.position.lerpVectors(J.position,H.position,ue)}}}(),lerpButtonTransform:function(){var te=new THREE.Quaternion;return function(pe,de){var se=this.loadedMeshInfo.buttonMeshes[pe];if(se){var J=se.unpressed,H=se.pressed,ae=se.value;ae.setRotationFromQuaternion(te.copy(J.quaternion).slerp(H.quaternion,de)),ae.position.lerpVectors(J.position,H.position,de)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(te){var pe=this.mapping.buttons[te.detail.id];pe&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(pe,te.detail.state.value),this.el.emit(pe+"changed",te.detail.state))},onAxisMoved:function(te){var pe=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var de=0;de<pe;de++)this.lerpAxisTransform(de,te.detail.axis[de]||0);g(this,this.mapping.axes,te)},setModelVisibility:function(te){var pe=this.el.getObject3D("mesh");this.controllerPresent&&(te=te!==void 0?te:this.modelVisible,this.modelVisible=te,pe&&(pe.visible=te))}})},"./src/constants/index.js":(m,M,h)=>{m.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:h("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":m=>{m.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},"./src/core/a-assets.js":(m,M,h)=>{var f=h("./src/core/a-node.js").ANode,C=h("./src/utils/debug.js"),p=h("./src/lib/three.js"),g=new p.FileLoader,u=C("core:a-assets:warn");class E extends f{constructor(){super(),this.isAssets=!0,this.fileLoader=g,this.timeout=null}doConnectedCallback(){var D=this,U,F=[],j,Y,oe,te,pe,de;if(super.doConnectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(te=this.querySelectorAll("img"),U=0;U<te.length;U++)oe=T(te[U]),F.push(new Promise(function(se,J){if(p.Cache.add(te[U].getAttribute("src"),oe),oe.complete){se();return}oe.onload=se,oe.onerror=J}));for(Y=this.querySelectorAll("audio, video"),U=0;U<Y.length;U++)j=T(Y[U]),!j.src&&!j.srcObject&&u("Audio/video asset has neither `src` nor `srcObject` attributes."),F.push(x(j));de=this.getChildren(),de.forEach(function(se){!se.isAssetItem||!se.hasAttribute("src")||F.push(new Promise(function(H,ae){if(se.hasLoaded)return H();se.addEventListener("loaded",H),se.addEventListener("error",ae)}))}),Promise.allSettled(F).then(function(){D.timeout!==null&&D.load()}),pe=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){D.hasLoaded||(u("Asset loading timed out in",pe,"ms"),D.timeout=null,D.emit("timeout"),D.load())},pe)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(){return!1})}}customElements.define("a-assets",E);class b extends f{constructor(){super(),this.data=null,this.isAssetItem=!0}connectedCallback(){var D=this,U=this.getAttribute("src");g.setResponseType(this.getAttribute("response-type")||S(U)),g.load(U,function(j){D.data=j,f.prototype.load.call(D)},function(j){D.emit("progress",{loadedBytes:j.loaded,totalBytes:j.total,xhr:j})},function(j){D.emit("error",{xhr:j})})}}customElements.define("a-asset-item",b);function x(P){if(!(!P.hasAttribute("autoplay")&&P.getAttribute("preload")!=="auto"))return new Promise(function(D,U){if(P.readyState===4)return D();if(P.error)return U();P.addEventListener("loadeddata",F,!1),P.addEventListener("progress",F,!1),P.addEventListener("error",U,!1);function F(){for(var j=0,Y=0;Y<P.buffered.length;Y++)j+=P.buffered.end(Y)-P.buffered.start(Y);j>=P.duration&&(P.tagName==="VIDEO"&&p.Cache.add(P.getAttribute("src"),P),D())}})}function T(P){var D=_(P);return D.tagName&&D.tagName.toLowerCase()==="video"&&(D.setAttribute("playsinline",""),D.setAttribute("webkit-playsinline","")),D!==P&&(P.parentNode.appendChild(D),P.parentNode.removeChild(P)),D}function _(P){var D,U;return P.hasAttribute("crossorigin")||(U=P.getAttribute("src"),U!==null&&(U.indexOf("://")===-1||w(U)===window.location.host))?P:(u('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',U),P.crossOrigin="anonymous",D=P.cloneNode(!0),D)}function w(P){var D=P.indexOf("://")>-1?P.split("/")[2]:P.split("/")[0];return D.substring(0,D.indexOf(":"))}function S(P){var D=L(P),U=D.lastIndexOf(".");if(U>=0){var F=D.slice(U,P.search(/\?|#|$/));if(F===".glb")return"arraybuffer"}return"text"}m.exports.inferResponseType=S;function L(P){var D=document.createElement("a");D.href=P;var U=D.search.replace(/^\?/,""),F=P.replace(U,"").replace("?","");return F.substring(F.lastIndexOf("/")+1)}m.exports.getFileNameFromURL=L},"./src/core/a-cubemap.js":(m,M,h)=>{var f=h("./src/utils/debug.js"),C=f("core:cubemap:warn");class p extends HTMLElement{constructor(u){return u=super(u),u}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}p.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var u=this.querySelectorAll("[src]"),E,b=[];if(u.length===6){for(E=0;E<u.length;E++)u[E].tagName==="IMG"?b.push(u[E]):b.push(u[E].getAttribute("src"));return b}C("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",p)},"./src/core/a-entity.js":(m,M,h)=>{var f=h("./src/core/a-node.js").ANode,C=h("./src/core/component.js").components,p=h("./src/lib/three.js"),g=h("./src/utils/index.js"),u=g.debug("core:a-entity:debug"),E=g.debug("core:a-entity:warn"),b="__",x=["position","rotation","scale","visible"],T={once:!0};class _ extends f{constructor(){super(),this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new p.Group,this.object3D.rotation.order="YXZ",this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(F,j,Y){var oe=this.components[F];if(super.attributeChangedCallback(),oe&&oe.justInitialized&&Y===""){delete oe.justInitialized;return}!oe&&Y===null||this.setEntityAttribute(F,j,Y)}doConnectedCallback(){var F=this,j,Y;if(super.doConnectedCallback(),Y=this.sceneEl,this.addToParent(),!this.isScene){if(!Y){this.load();return}if(j=Y.querySelector("a-assets"),j&&!j.hasLoaded){j.addEventListener("loaded",function(){F.load()});return}this.load()}}disconnectedCallback(){var F;if(this.parentEl){for(F in this.components)this.removeComponent(F,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(F){return this.object3DMap[F]}setObject3D(F,j){var Y,oe=this;if(!(j instanceof p.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");Y=this.getObject3D(F),Y&&this.object3D.remove(Y),j.el=this,j.children.length&&j.traverse(function(pe){pe.el=oe}),this.object3D.add(j),this.object3DMap[F]=j,this.emit("object3dset",{object:j,type:F})}removeObject3D(F){var j=this.getObject3D(F);if(!j){E("Tried to remove `Object3D` of type:",F,"which was not defined.");return}this.object3D.remove(j),delete this.object3DMap[F],this.emit("object3dremove",{type:F})}getOrCreateObject3D(F,j){var Y=this.getObject3D(F);return!Y&&j&&(Y=new j,this.setObject3D(F,Y)),E("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),Y}add(F){if(!F.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(F.object3D),this.emit("child-attached",{el:F})}addToParent(){var F=this.parentEl=this.parentNode;!F||!F.add||this.attachedToParent||(F.add(this),this.attachedToParent=!0)}removeFromParent(){var F=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,F.emit("child-detached",{el:this})}load(){var F=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){F.parentEl&&(F.updateComponents(),(F.isScene||F.parentEl.isPlaying)&&F.play())})}remove(F){F?this.object3D.remove(F.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var F=this.children,j=[],Y=0;Y<F.length;Y++){var oe=F[Y];oe instanceof _&&j.push(oe)}return j}initComponent(F,j,Y){var oe,te,pe,de,se;pe=g.split(F,b),de=pe[0],te=pe.length>2?pe.slice(1).join("__"):pe[1],C[de]&&(se=w(this,F)||j!==void 0,!(!se&&!Y)&&(F in this.components||(this.initComponentDependencies(de),oe=new C[de].Component(this,j,te),this.isPlaying&&oe.play(),this.hasAttribute(F)||(oe.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,F,"")),u("Component initialized: %s",F))))}initComponentDependencies(F){var j=this,Y=C[F],oe,te;if(Y&&(oe=C[F].dependencies,!!oe))for(te=0;te<oe.length;te++)j.initComponent(oe[te],window.HTMLElement.prototype.getAttribute.call(j,oe[te])||void 0,!0)}removeComponent(F,j){var Y;if(Y=this.components[F],!!Y){if(!Y.initialized){this.addEventListener("componentinitialized",function oe(te){te.detail.name===F&&(this.removeComponent(F,j),this.removeEventListener("componentinitialized",oe))});return}Y.pause(),Y.remove(),j&&(Y.destroy(),delete this.components[F],this.hasAttribute(F)&&window.HTMLElement.prototype.removeAttribute.call(this,F)),this.emit("componentremoved",Y.evtDetail,!1)}}updateComponents(){var F,j,Y,oe,te=this.componentsToUpdate;if(!(!this.hasLoaded&&!this.isLoading)){for(Y=0;Y<this.mixinEls.length;Y++)for(oe in this.mixinEls[Y].componentCache)P(oe)&&(te[oe]=!0);if(this.getExtraComponents){j=this.getExtraComponents();for(oe in j)P(oe)&&(te[oe]=!0)}for(Y=0;Y<this.attributes.length;++Y)oe=this.attributes[Y].name,x.indexOf(oe)===-1&&P(oe)&&(te[oe]=!0);for(Y=0;Y<x.length;Y++)oe=x[Y],this.hasAttribute(oe)&&this.updateComponent(oe,this.getDOMAttribute(oe));for(oe in te)F=L(this.getDOMAttribute(oe),j&&j[oe]),this.updateComponent(oe,F),delete te[oe]}}updateComponent(F,j,Y){var oe=this.components[F];if(oe){if(j===null&&!w(this,F)){this.removeComponent(F,!0);return}oe.updateProperties(j,Y);return}this.initComponent(F,j,!1)}removeAttribute(F,j){var Y=this.components[F];if(Y&&j===void 0&&this.removeComponent(F,!0),Y&&j!==void 0){Y.resetProperty(j);return}F==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,F)}play(){var F,j,Y;if(!(this.isPlaying||!this.hasLoaded&&!this.isLoading)){this.isPlaying=!0;for(Y in this.components)this.components[Y].play();for(F=this.getChildEntities(),j=0;j<F.length;j++)F[j].play();this.emit("play")}}pause(){var F,j,Y;if(this.isPlaying){this.isPlaying=!1;for(Y in this.components)this.components[Y].pause();for(F=this.getChildEntities(),j=0;j<F.length;j++)F[j].pause();this.emit("pause")}}setEntityAttribute(F,j,Y){if(C[F]||this.components[F]){this.updateComponent(F,Y);return}if(F==="mixin"){if(Y===this.computedMixinStr)return;this.mixinUpdate(Y,j)}}mixinUpdate(F,j,Y){var oe=_.componentsUpdated,te,pe,de,se,J=this;if(Y||(j=j||this.getAttribute("mixin")),!this.hasLoaded){this.addEventListener("loaded-private",function(){J.mixinUpdate(F,j,!0)},T);return}for(de=this.updateMixins(F,j),oe.length=0,se=0;se<this.mixinEls.length;se++)for(te in this.mixinEls[se].componentCache)oe.indexOf(te)===-1&&(this.components[te]?this.components[te].handleMixinUpdate():this.initComponent(te,null),oe.push(te));for(se=0;se<de.oldMixinIds.length;se++)if(pe=document.getElementById(de.oldMixinIds[se]),!!pe)for(te in pe.componentCache)oe.indexOf(te)===-1&&this.components[te]&&(this.getDOMAttribute(te)?this.components[te].handleMixinUpdate():this.removeComponent(te,!0))}setAttribute(F,j,Y){var oe=_.singlePropUpdate,te,pe,de,se,J,H;if(se=F.indexOf(b),de=se>0?F.substring(0,se):F,!C[de]){F==="mixin"&&this.mixinUpdate(j),super.setAttribute.call(this,F,j);return}if(!this.components[F]&&this.hasAttribute(F)&&this.updateComponent(F,window.HTMLElement.prototype.getAttribute.call(this,F)),typeof Y<"u"&&typeof j=="string"&&j.length>0&&typeof g.styleParser.parse(j)=="string"){for(H in oe)delete oe[H];te=oe,te[j]=Y,pe=!1}else te=j,pe=Y===!0;this.updateComponent(F,te,pe),J=this.sceneEl&&this.sceneEl.getAttribute("debug"),J&&this.components[F].flushToDOM()}flushToDOM(F){var j=this.components,Y,oe=this.children,te,pe;for(pe in j)j[pe].flushToDOM();if(F)for(te=0;te<oe.length;++te)Y=oe[te],Y.flushToDOM&&Y.flushToDOM(F)}getAttribute(F){var j;return F==="position"?this.object3D.position:F==="rotation"?D(this):F==="scale"?this.object3D.scale:F==="visible"?this.object3D.visible:(j=this.components[F],j?j.data:window.HTMLElement.prototype.getAttribute.call(this,F))}getDOMAttribute(F){var j=this.components[F];return j?j.attrValue:window.HTMLElement.prototype.getAttribute.call(this,F)}addState(F){this.is(F)||(this.states.push(F),this.emit("stateadded",F))}removeState(F){var j=this.states.indexOf(F);j!==-1&&(this.states.splice(j,1),this.emit("stateremoved",F))}is(F){return this.states.indexOf(F)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var F;if(this.parentNode){E("Entity can only be destroyed if detached from scenegraph.");return}for(F in this.components)this.components[F].destroy()}}function w(U,F){return U.components[F]&&U.components[F].attrValue?!0:S(F,U.mixinEls)}function S(U,F){var j,Y=!1;for(j=0;j<F.length&&(Y=F[j].hasAttribute(U),!Y);++j);return Y}function L(U,F){return F?F.constructor===Object?g.extend(F,g.styleParser.parse(U||{})):U||F:U}function P(U){return U.indexOf(b)!==-1&&(U=g.split(U,b)[0]),!!C[U]}function D(U){var F=p.MathUtils.radToDeg,j=U.object3D.rotation,Y=U.rotationObj;return Y.x=F(j.x),Y.y=F(j.y),Y.z=F(j.z),Y}_.componentsUpdated=[],_.singlePropUpdate={},customElements.define("a-entity",_),m.exports.AEntity=_},"./src/core/a-mixin.js":(m,M,h)=>{var f=h("./src/core/a-node.js").ANode,C=h("./src/core/component.js").components,p=h("./src/utils/index.js"),g=p.styleParser,u="__";class E extends f{constructor(){super(),this.componentCache={},this.rawAttributeCache={},this.isMixin=!0}doConnectedCallback(){super.doConnectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(x,T,_){super.attributeChangedCallback(),this.cacheAttribute(x,_),this.updateEntities()}setAttribute(x,T){window.HTMLElement.prototype.setAttribute.call(this,x,T),this.cacheAttribute(x,T)}cacheAttribute(x,T){var _,w;w=p.split(x,u)[0],_=C[w],T===void 0&&(T=window.HTMLElement.prototype.getAttribute.call(this,x)),this.rawAttributeCache[x]=T,_&&(this.componentCache[x]=this.parseComponentAttrValue(_,T))}parseComponentAttrValue(x,T){var _;return typeof T!="string"?T:(x.isSingleProperty?(_=x.schema.parse(T),typeof _=="string"&&(_=T)):_=g.parse(T),_)}getAttribute(x){return this.componentCache[x]||window.HTMLElement.prototype.getAttribute.call(this,x)}cacheAttributes(){var x=this.attributes,T,_;for(_=0;_<x.length;_++)T=x[_].name,this.cacheAttribute(T)}updateEntities(){var x,T,_;if(this.sceneEl)for(T=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),_=0;_<T.length;_++)x=T[_],!(!x.hasLoaded||x.isMixin)&&x.mixinUpdate(this.id)}}customElements.define("a-mixin",E)},"./src/core/a-node.js":(m,M,h)=>{var f=h("./src/utils/index.js"),C=h("./src/core/readyState.js"),p=f.debug("core:a-node:warn"),g={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function u(b){return b.tagName.toLowerCase()in g||b.isNode}class E extends HTMLElement{constructor(){super(),this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}connectedCallback(){if(!C.canInitializeElements){document.addEventListener("aframeready",this.connectedCallback.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var x;this.sceneEl=this.closestScene(),this.sceneEl||p("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(x=this.getAttribute("mixin"),x&&this.updateMixins(x))}attributeChangedCallback(x,T,_){_!==this.computedMixinStr&&x==="mixin"&&!this.isMixin&&this.updateMixins(_,T)}closestScene(){for(var x=this;x&&!x.isScene;)x=x.parentElement;return x}closest(x){for(var T=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,_=this;_&&!T.call(_,x);)_=_.parentElement;return _}disconnectedCallback(){this.hasLoaded=!1}load(x,T){var _,w,S=this;this.hasLoaded||(T=T||u,_=this.getChildren(),w=_.filter(T).map(function(L){return new Promise(function(D,U){if(L.hasLoaded)return D();L.addEventListener("loaded",D),L.addEventListener("error",U)})}),Promise.allSettled(w).then(function(P){P.forEach(function(U){U.status==="rejected"&&p("Rendering scene with errors on node: ",U.reason.target)}),S.isLoading=!0,S.setupMutationObserver(),x&&x(),S.isLoading=!1,S.hasLoaded=!0,S.emit("loaded-private",void 0,!1),S.emit("loaded",void 0,!1)}))}setupMutationObserver(){var x=this,T={attributes:!0,attributeOldValue:!0},_=new MutationObserver(function(S){var L;for(L=0;L<S.length;L++)if(S[L].type==="attributes"){var P=S[L].attributeName,D=window.HTMLElement.prototype.getAttribute.call(x,P),U=S[L].oldValue;x.attributeChangedCallback(P,U,D)}});_.observe(this,T)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(x,T){var _=E.newMixinIdArray,w=E.oldMixinIdArray,S=E.mixinIds,L,P,D;for(_.length=0,w.length=0,P=x?f.split(x.trim(),/\s+/):_,D=T?f.split(T.trim(),/\s+/):w,S.newMixinIds=P,S.oldMixinIds=D,L=0;L<D.length;L++)P.indexOf(D[L])===-1&&this.unregisterMixin(D[L]);for(this.computedMixinStr="",this.mixinEls.length=0,L=0;L<P.length;L++)this.registerMixin(P[L]);return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),P.length===0&&window.HTMLElement.prototype.removeAttribute.call(this,"mixin"),S}registerMixin(x){var T,_,w,S=document.getElementById(x);if(!S){p("No mixin was found with id `%s`",x);return}if(w=S.getAttribute("mixin"),w)for(T=f.split(w.trim(),/\s+/),_=0;_<T.length;_++)this.registerMixin(T[_]);this.computedMixinStr=this.computedMixinStr+" "+S.id,this.mixinEls.push(S)}setAttribute(x,T){x==="mixin"&&this.updateMixins(T),window.HTMLElement.prototype.setAttribute.call(this,x,T)}unregisterMixin(x){var T,_=this.mixinEls,w;for(T=0;T<_.length;++T)if(w=_[T],x===w.id){_.splice(T,1);break}}emit(x,T,_,w){var S=E.evtData;_===void 0&&(_=!0),S.bubbles=!!_,S.detail=T,w&&(S=f.extend({},w,S)),this.dispatchEvent(new CustomEvent(x,S))}}E.evtData={},E.newMixinIdArray=[],E.oldMixinIdArray=[],E.mixinIds={},customElements.define("a-node",E),m.exports.ANode=E,m.exports.knownTags=g},"./src/core/component.js":(m,M,h)=>{var f=h("./src/core/schema.js"),C=h("./src/core/scene/scenes.js"),p=h("./src/core/system.js"),g=h("./src/utils/index.js"),u=m.exports.components={},E=f.parseProperty,b=f.process,x=f.isSingleProperty,T=f.stringifyProperties,_=f.stringifyProperty,w=g.styleParser,S=g.debug("core:component:warn"),L=document.currentScript,P=new RegExp("[A-Z]+"),D={},U=Object.freeze({}),F=[],j={get:function(H,ae){return H.getComputedPropertyValue(ae)},set:function(H,ae,ue){return ae in H.schema?H.recomputeProperty(ae,ue):ue!==void 0&&H.handleUnknownProperty(ae,ue),!0}},Y=m.exports.Component=function(H,ae,ue){var Me=this;if(this.sceneOnly&&!H.isScene)throw new Error("Component `"+this.name+"` can only be applied to <a-scene>");if(ue&&!this.multiple)throw new Error("Trying to initialize multiple components of type `"+this.name+"`. There can only be one component of this type per entity.");this.el=H,this.id=ue,this.attrName=this.name+(ue?"__"+ue:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=D[this.name];var De=this.events;this.events={},oe(this,De),this.attrValue=void 0,this.isObjectBased?(this.data=this.objectPool.use(),g.objectPool.removeUnusedKeys(this.data,this.schema),this.oldData=this.objectPool.use(),g.objectPool.removeUnusedKeys(this.oldData,this.schema),this.attrValueProxy=new Proxy(this,j)):(this.data=void 0,this.oldData=void 0,this.attrValueProxy=void 0),this.deferUnknownPropertyWarnings=!!this.updateSchema,this.silenceUnknownPropertyWarnings=!1,this.throttledEmitComponentChanged=g.throttleLeadingAndTrailing(function(){H.emit("componentchanged",Me.evtDetail,!1)},200),this.updateProperties(ae,!0)};Y.prototype={schema:{},init:function(){},events:{},update:function(H){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},stringify:function(H){var ae=this.schema;return typeof H=="string"?H:this.isSingleProperty?_(H,ae):(H=T(H,ae),w.stringify(H))},flushToDOM:function(H){var ae=H?this.data:this.attrValue;ae!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(ae))},updateProperties:function(H,ae){var ue=this.el;this.updateData(H,ae),!(!ue.hasLoaded&&!ue.isLoading)&&(this.initialized?this.callUpdateHandler():this.initComponent())},initComponent:function(){var H=this.el,ae;H.initializingComponents[this.name]||(H.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete H.initializingComponents[this.name],ae=this.isObjectBased?U:void 0,this.dataChanged=!1,this.storeOldData(),this.update(ae),H.isPlaying&&this.play(),H.emit("componentinitialized",this.evtDetail,!1))},updateData:function(H,ae){if(this.isSingleProperty){this.recomputeProperty(void 0,H);return}ae?(g.objectPool.clearObject(this.attrValue),this.recomputeData(H),this.schemaChangeRequired=!!this.updateSchema):typeof H=="string"?w.parse(H,this.attrValueProxy):g.extend(this.attrValueProxy,H),this.updateSchemaIfNeeded(H)},updateSchemaIfNeeded:function(H){if(!this.schemaChangeRequired||!this.updateSchema){for(var ae=0;ae<F.length;ae++)S("Unknown property `"+F[ae]+"` for component `"+this.name+"`.");F.length=0;return}F.length=0,this.updateSchema(this.data),g.objectPool.removeUnusedKeys(this.data,this.schema),this.silenceUnknownPropertyWarnings=!0,this.recomputeData(H),this.silenceUnknownPropertyWarnings=!1,this.schemaChangeRequired=!1},callUpdateHandler:function(){if(!(!this.isPositionRotationScale&&!this.dataChanged)){this.dataChanged=!1;var H=this.oldData;this.oldDataInUse=!0,this.update(H),H!==this.oldData&&this.objectPool.recycle(H),this.oldDataInUse=!1,this.storeOldData(),this.throttledEmitComponentChanged()}},handleMixinUpdate:function(){this.recomputeData(),this.updateSchemaIfNeeded(),this.callUpdateHandler()},resetProperty:function(H){!this.isSingleProperty&&!(H in this.schema)||(H?this.attrValue[H]=void 0:(this.isObjectBased&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0),this.recomputeProperty(H,void 0),this.updateSchemaIfNeeded(),this.callUpdateHandler())},extendSchema:function(H){var ae;ae=g.extend({},u[this.name].schema),g.extend(ae,H),this.schema=b(ae),this.el.emit("schemachanged",this.evtDetail)},getComputedPropertyValue:function(H){var ae=this.el.mixinEls,ue=this.attrValue&&H?this.attrValue[H]:this.attrValue;if(ue!==void 0)return ue;for(var Me=ae.length-1;Me>=0;Me--){var De=ae[Me].getAttribute(this.attrName);if(!(De===null||H&&!(H in De)))return H?De[H]:De}var Ge=H?this.schema[H].default:this.schema.default;return Ge},recomputeProperty:function(H,ae){var ue=H?this.schema[H]:this.schema;if(ae!=null){this.attrValue===void 0&&this.isObjectBased&&(this.attrValue=this.objectPool.use());var Me=H?this.attrValue[H]:this.attrValue;Me=ue.isCacheable?E(ae,ue,Me):ae,typeof Me=="string"&&(Me=ae===""?void 0:ae),H?this.attrValue[H]=Me:this.attrValue=Me}this.oldDataInUse&&(this.oldData=this.objectPool.use(),g.objectPool.removeUnusedKeys(this.oldData,this.schema),this.storeOldData(),this.oldDataInUse=!1);var De=H?this.oldData[H]:this.oldData,Ge=H?this.data[H]:this.data,Xe=E(this.getComputedPropertyValue(H),ue,Ge);return ue.type==="array"&&!H&&(Xe=g.clone(Xe)),ue.equals(Xe,De)||(this.dataChanged=!0,ue.schemaChange&&(this.schemaChangeRequired=!0)),H?this.data[H]=Xe:this.data=Xe,Xe},handleUnknownProperty:function(H,ae){this.attrValue===void 0&&(this.attrValue=this.objectPool.use()),this.attrValue[H]=ae,this.silenceUnknownPropertyWarnings||(this.deferUnknownPropertyWarnings?F.push(H):this.silenceUnknownPropertyWarnings||S("Unknown property `"+H+"` for component `"+this.name+"`."))},storeOldData:function(){if(!this.isObjectBased){this.oldData=this.data;return}if(this.isSingleProperty){this.oldData=E(this.data,this.schema,this.oldData);return}var H;for(H in this.schema)this.data[H]!==void 0&&(this.data[H]&&typeof this.data[H]=="object"?this.oldData[H]=E(this.data[H],this.schema[H],this.oldData[H]):this.oldData[H]=this.data[H])},recomputeData:function(H){var ae;if(this.isSingleProperty){this.recomputeProperty(void 0,H);return}if(H&&typeof H=="object")for(ae in this.schema)this.attrValueProxy[ae]=H[ae];else for(ae in this.schema)this.attrValueProxy[ae]=void 0;typeof H=="string"&&w.parse(H,this.attrValueProxy);for(ae in this.attrValue)this.attrValue[ae]!==void 0&&F.indexOf(ae)!==-1&&(ae in this.schema||S("Unknown property `"+ae+"` for component `"+this.name+"`."))},eventsAttach:function(){var H;this.eventsDetach();for(H in this.events)this.el.addEventListener(H,this.events[H])},eventsDetach:function(){var H;for(H in this.events)this.el.removeEventListener(H,this.events[H])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.data),this.objectPool.recycle(this.oldData),this.attrValue=this.data=this.oldData=this.attrValueProxy=void 0}};function oe(H,ae){var ue;for(ue in ae)H.events[ue]=ae[ue].bind(H)}if(window.debug)var te=m.exports.registrationOrderWarnings={};m.exports.registerComponent=function(H,ae){var ue,Me={},De,Ge;if(document.currentScript&&document.currentScript!==L&&C.forEach(function(pt){pt.hasLoaded||document.currentScript.compareDocumentPosition(pt)!==Node.DOCUMENT_POSITION_FOLLOWING&&(S("The component `"+H+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(te[H]=!0))}),P.test(H)===!0&&S("The component name `"+H+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+H.toLowerCase()+"`"),H.indexOf("__")!==-1)throw new Error("The component name `"+H+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(ae).forEach(function(Je){Me[Je]={value:ae[Je],writable:!0}}),u[H])throw new Error("The component `"+H+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");ue=function(Je,pt,yt){Y.call(this,Je,pt,yt)},ue.prototype=Object.create(Y.prototype,Me),ue.prototype.name=H,ue.prototype.isPositionRotationScale=H==="position"||H==="rotation"||H==="scale",ue.prototype.constructor=ue,ue.prototype.system=p&&p.systems[H],ue.prototype.play=se(ue.prototype.play),ue.prototype.pause=de(ue.prototype.pause),De=g.extend(b(ue.prototype.schema,ue.prototype.name)),ue.prototype.isSingleProperty=Ge=x(ue.prototype.schema),ue.prototype.isObjectBased=!Ge||Ge&&(J(De.default)||J(E(void 0,De))),D[H]=g.objectPool.createPool(),u[H]={Component:ue,dependencies:ue.prototype.dependencies,before:ue.prototype.before,after:ue.prototype.after,isSingleProperty:ue.prototype.isSingleProperty,isObjectBased:ue.prototype.isObjectBased,multiple:ue.prototype.multiple,sceneOnly:ue.prototype.sceneOnly,name:H,schema:De,stringify:ue.prototype.stringify};for(var Xe=0;Xe<C.length;Xe++)C[Xe].emit("componentregistered",{name:H},!1);return ue};function pe(H){return H.tick||H.tock}function de(H){return function(){var ue=this.el.sceneEl;this.isPlaying&&(H.call(this),this.isPlaying=!1,this.eventsDetach(),pe(this)&&ue.removeBehavior(this))}}function se(H){return function(){var ue=this.el.sceneEl,Me=this.el.isPlaying&&!this.isPlaying;!this.initialized||!Me||(H.call(this),this.isPlaying=!0,this.eventsAttach(),pe(this)&&ue.addBehavior(this))}}function J(H){return H&&H.constructor===Object&&!(H instanceof window.HTMLElement)}},"./src/core/geometry.js":(m,M,h)=>{var f=h("./src/core/schema.js"),C=f.process,p=m.exports.geometries={},g=m.exports.geometryNames=[],u=h("./src/lib/three.js"),E=m.exports.Geometry=function(){};E.prototype={schema:{},init:function(b){return this.geometry=new u.BufferGeometry,this.geometry},update:function(b){}},m.exports.registerGeometry=function(b,x){var T,_={};if(Object.keys(x).forEach(function(S){_[S]={value:x[S],writable:!0}}),p[b])throw new Error("The geometry `"+b+"` has been already registered");return T=function(){E.call(this)},T.prototype=Object.create(E.prototype,_),T.prototype.name=b,T.prototype.constructor=T,p[b]={Geometry:T,schema:C(T.prototype.schema)},g.push(b),T}},"./src/core/propertyTypes.js":(m,M,h)=>{var f=h("./src/utils/coordinates.js"),C=h("./node_modules/debug/src/browser.js"),p=C("core:propertyTypes:warn"),g=m.exports.propertyTypes={},u=/[,> .[\]:]/,E=/url\((.+)\)/;b("audio","",w),b("array",[],x,T,_),b("asset","",w),b("boolean",!1,D),b("color","#FFF"),b("int",0,U),b("number",0,F),b("map","",w),b("model","",w),b("selector",null,j,oe,P,!1),b("selectorAll",null,Y,te,_,!1),b("src","",pe),b("string",""),b("time",0,U),b("vec2",{x:0,y:0},de,f.stringify,f.equals),b("vec3",{x:0,y:0,z:0},de,f.stringify,f.equals),b("vec4",{x:0,y:0,z:0,w:1},de,f.stringify,f.equals);function b(H,ae,ue,Me,De,Ge){if(H in g)throw new Error("Property type "+H+" is already registered.");g[H]={default:ae,parse:ue||S,stringify:Me||L,equals:De||P,isCacheable:Ge!==!1}}m.exports.registerPropertyType=b;function x(H){if(Array.isArray(H))return H;if(!H||typeof H!="string")return[];return H.split(",").map(ae);function ae(ue){return ue.trim()}}function T(H){return H.join(", ")}function _(H,ae){if(!Array.isArray(H)||!Array.isArray(ae))return H===ae;if(H.length!==ae.length)return!1;for(var ue=0;ue<H.length;ue++)if(H[ue]!==ae[ue])return!1;return!0}function w(H){var ae,ue;if(typeof H!="string")return H;if(ue=H.match(E),ue)return ue[1];if(H.charAt(0)==="#"){if(ae=document.getElementById(H.substring(1)),ae)return ae.tagName==="CANVAS"||ae.tagName==="VIDEO"||ae.tagName==="IMG"?ae:ae.getAttribute("src");p('"'+H+'" asset not found.');return}return H}function S(H){return H}function L(H){return H===null?"null":H.toString()}function P(H,ae){return H===ae}function D(H){return H!=="false"&&H!==!1}function U(H){return parseInt(H,10)}function F(H){return parseFloat(H,10)}function j(H){return H?typeof H!="string"?H:H[0]==="#"&&!u.test(H)?document.getElementById(H.substring(1)):document.querySelector(H):null}function Y(H){return H?typeof H!="string"?H:Array.prototype.slice.call(document.querySelectorAll(H),0):null}function oe(H){return H.getAttribute?"#"+H.getAttribute("id"):L(H)}function te(H){return H instanceof Array?H.map(function(ae){return"#"+ae.getAttribute("id")}).join(", "):L(H)}function pe(H){return p("`src` property type is deprecated. Use `asset` instead."),w(H)}function de(H,ae,ue){return f.parse(H,ae,ue)}function se(H,ae){return H==="audio"&&typeof ae!="string"||H==="array"&&!Array.isArray(ae)||H==="asset"&&typeof ae!="string"||H==="boolean"&&typeof ae!="boolean"||H==="color"&&typeof ae!="string"||H==="int"&&typeof ae!="number"||H==="number"&&typeof ae!="number"||H==="map"&&typeof ae!="string"||H==="model"&&typeof ae!="string"||H==="selector"&&typeof ae!="string"&&ae!==null||H==="selectorAll"&&typeof ae!="string"&&ae!==null||H==="src"&&typeof ae!="string"||H==="string"&&typeof ae!="string"||H==="time"&&typeof ae!="number"?!1:H==="vec2"?J(ae,2):H==="vec3"?J(ae,3):H==="vec4"?J(ae,4):!0}m.exports.isValidDefaultValue=se;function J(H,ae){if(H===null)return!0;if(typeof H!="object"||Object.keys(H).length!==ae)return!1;var ue=H.x,Me=H.y,De=H.z,Ge=H.w;return!(typeof ue!="number"||typeof Me!="number"||ae>2&&typeof De!="number"||ae>3&&typeof Ge!="number")}m.exports.isValidDefaultCoordinate=J},"./src/core/readyState.js":m=>{m.exports.canInitializeElements=!1;function M(){if(document.readyState==="complete"){h();return}document.addEventListener("readystatechange",function f(){document.readyState==="complete"&&(document.removeEventListener("readystatechange",f),h())})}m.exports.waitForDocumentReadyState=M;function h(){m.exports.canInitializeElements||(m.exports.canInitializeElements=!0,setTimeout(function(){document.dispatchEvent(new CustomEvent("aframeready"))}))}m.exports.emitReady=h},"./src/core/scene/a-scene.js":(m,M,h)=>{var f=h("./src/core/scene/metaTags.js").inject,C=h("./src/core/scene/wakelock.js"),p=h("./src/core/scene/loadingScreen.js"),g=h("./src/core/scene/scenes.js"),u=h("./src/core/system.js").systems,E=h("./src/core/component.js").components,b=h("./src/lib/three.js"),x=h("./src/utils/index.js"),T=x.debug("core:a-scene:warn"),_=h("./src/core/a-entity.js").AEntity,w=h("./src/core/a-node.js").ANode,S=h("./src/core/scene/postMessage.js"),L=x.device.isIOS(),P=x.device.isMobile(),D=x.device.isWebXRAvailable;L&&h("./src/utils/ios-orientationchange-blank-bug.js");class U extends _{constructor(){var J;super(),J=this,J.clock=new b.Clock,J.isIOS=L,J.isMobile=P,J.hasWebXR=D,J.isAR=!1,J.isScene=!0,J.object3D=new b.Scene,J.object3D.onAfterRender=function(H,ae,ue){J.isPlaying&&J.tock(J.time,J.delta,ue)},J.resize=J.resize.bind(J),J.render=J.render.bind(J),J.systems={},J.systemNames=[],J.time=J.delta=0,J.usedOfferSession=!1,J.componentOrder=[],J.behaviors={},J.hasLoaded=!1,J.isPlaying=!1,J.originalHTML=J.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}doConnectedCallback(){var J=this,H=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.doConnectedCallback(),de(this),this.setupRenderer(),p.setup(this,Y),this.resize(),H||this.addFullScreenStyles(),S(this),f(this),C(this),this.onVRPresentChangeBound=this.onVRPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){J.enterVR()},this.exitVRBound=function(){J.exitVR()},this.exitVRTrueBound=function(){J.exitVR(!0)},this.pointerRestrictedBound=function(){J.pointerRestricted()},this.pointerUnrestrictedBound=function(){J.pointerUnrestricted()},J.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){J.attachedCallbackPostCamera()}),this.initSystems(),this.componentOrder=F(E,this.componentOrder),this.addEventListener("componentregistered",function(){J.componentOrder=F(E,J.componentOrder)}),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){J.enterVR()})}attachedCallbackPostCamera(){var J,H=this;window.addEventListener("load",J),window.addEventListener("resize",function(){H.isIOS?setTimeout(H.resize,100):H.resize()}),this.play(),g.push(this)}initSystems(){var J;this.initSystem("camera");for(J in u)J!=="camera"&&this.initSystem(J)}initSystem(J){this.systems[J]||(this.systems[J]=new u[J](this),this.systemNames.push(J))}disconnectedCallback(){var J=g.indexOf(this);super.disconnectedCallback(),g.splice(J,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(J){var H,ae=this.behaviors[J.name],ue;ae||(ae=this.behaviors[J.name]={tick:{inUse:!1,array:[],markedForRemoval:[]},tock:{inUse:!1,array:[],markedForRemoval:[]}});for(ue in ae)if(J[ue]){if(H=ae[ue],H.inUse){var Me=H.markedForRemoval.indexOf(J);Me!==-1&&H.markedForRemoval.splice(Me,1)}H.array.indexOf(J)===-1&&H.array.push(J)}}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return x.device.checkHeadsetConnected()}enterAR(){var J;if(!this.hasWebXR)throw J="Failed to enter AR mode, WebXR not supported.",new Error(J);if(!x.device.checkARSupport())throw J="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(J);return this.enterVR(!0)}enterVR(J,H){var ae=this,ue,Me=ae.renderer.xr,De;if(H&&(!navigator.xr||!navigator.xr.offerSession))return Promise.resolve("OfferSession is not supported.");if(ae.usedOfferSession&&H)return Promise.resolve("OfferSession was already called.");if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var Ge=ae.getAttribute("renderer");if(Me.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var Xe=this.sceneEl.systems.webxr.sessionReferenceSpaceType;Me.setReferenceSpaceType(Xe);var Je=J?"immersive-ar":"immersive-vr";return De=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(Et,Vt){var Yt=H?navigator.xr.offerSession.bind(navigator.xr):navigator.xr.requestSession.bind(navigator.xr);ae.usedOfferSession|=H,Yt(Je,De).then(function(Ri){H&&(ae.usedOfferSession=!1),Me.layersEnabled=De.requiredFeatures.indexOf("layers")!==-1,Me.setSession(Ri).then(function(){Me.setFoveation(Ge.foveationLevel),ae.xrSession=Ri,ae.systems.renderer.setWebXRFrameRate(Ri),Ri.addEventListener("end",ae.exitVRBound),yt(Et)})},function(Ri){var Ni=Je==="immersive-ar",Oi=Ni?"AR":"VR";Vt(new Error("Failed to enter "+Oi+" mode (`requestSession`)",{cause:Ri}))})})}else{if(ue=x.device.getVRDisplay(),Me.setDevice(ue),ue.isPresenting&&!window.hasNativeWebVRImplementation)return yt(),Promise.resolve();var pt={highRefreshRate:Ge.highRefreshRate};return ue.requestPresent([{source:this.canvas,attributes:pt}]).then(yt,Gt)}}return yt(),Promise.resolve();function yt(Et){var Vt;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(Vt=new CustomEvent("vrdisplaypresentchange",{detail:{display:x.device.getVRDisplay()}}),window.dispatchEvent(Vt)),J?ae.addState("ar-mode"):ae.addState("vr-mode"),ae.emit("enter-vr",{target:ae}),!ae.hasWebXR&&ae.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),ae.addFullScreenStyles(),!ae.isMobile&&!ae.checkHeadsetConnected()&&te(ae.canvas),ae.resize(),Et&&Et()}function Gt(Et){throw ae.removeState("vr-mode"),Et&&Et.message?new Error("Failed to enter VR mode (`requestPresent`): "+Et.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var J=this,H,ae=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(ae.enabled=!1,H=x.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(H.isPresenting)return H.exitPresent().then(ue,Me)}else pe();return ue(),Promise.resolve();function ue(){J.removeState("vr-mode"),J.removeState("ar-mode"),J.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),J.hasAttribute("embedded")&&J.removeFullScreenStyles(),J.resize(),J.isIOS&&x.forceCanvasResizeSafariMobile(J.canvas),J.renderer.setPixelRatio(window.devicePixelRatio),J.emit("exit-vr",{target:J})}function Me(De){throw De&&De.message?new Error("Failed to exit VR mode (`exitPresent`): "+De.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var J=this.getPointerLockElement();J&&J!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var J=this.getPointerLockElement();J&&J===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(J){var H=J.display||J.detail.display;if(H&&H.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(J){var H=this.systems[J];return H?H.data:_.prototype.getAttribute.call(this,J)}getDOMAttribute(J){var H=this.systems[J];return H?H.data:_.prototype.getDOMAttribute.call(this,J)}setAttribute(J,H,ae){if(u[J]){w.prototype.setAttribute.call(this,J,H);var ue=this.systems[J];ue&&ue.updateProperties(H);return}_.prototype.setAttribute.call(this,J,H,ae)}removeBehavior(J){var H,ae,ue=this.behaviors[J.name],Me;for(ae in ue)J[ae]&&(H=ue[ae],Me=H.array.indexOf(J),Me!==-1&&(H.inUse?H.markedForRemoval.indexOf(J)===-1&&H.markedForRemoval.push(J):(H.array[Me]=H.array[H.array.length-1],H.array.pop())))}resize(){var J=this.camera,H=this.canvas,ae,ue,Me,De=this.renderer.xr.isPresenting;ue=this.renderer.xr.enabled&&De,!(!J||!H||this.is("vr-mode")&&(this.isMobile||ue))&&(ae=this.getAttribute("embedded")&&!this.is("vr-mode"),Me=Y(H,ae,this.maxCanvasSize,this.is("vr-mode")),J.aspect=Me.width/Me.height,J.updateProjectionMatrix(),this.renderer.setSize(Me.width,Me.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var J=this,H,ae,ue,Me;Me={alpha:!0,antialias:!P,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:-1,width:-1},this.hasAttribute("renderer")&&(ue=this.getAttribute("renderer"),ae=x.styleParser.parse(ue),ae.precision&&(Me.precision=ae.precision+"p"),ae.antialias&&ae.antialias!=="auto"&&(Me.antialias=ae.antialias==="true"),ae.logarithmicDepthBuffer&&ae.logarithmicDepthBuffer!=="auto"&&(Me.logarithmicDepthBuffer=ae.logarithmicDepthBuffer==="true"),ae.alpha&&(Me.alpha=ae.alpha==="true"),ae.stencil&&(Me.stencil=ae.stencil==="true"),ae.multiviewStereo&&(Me.multiviewStereo=ae.multiviewStereo==="true"),this.maxCanvasSize={width:ae.maxCanvasWidth?parseInt(ae.maxCanvasWidth):this.maxCanvasSize.width,height:ae.maxCanvasHeight?parseInt(ae.maxCanvasHeight):this.maxCanvasSize.height}),H=this.renderer=new b.WebGLRenderer(Me),H.setPixelRatio(window.devicePixelRatio),this.camera&&H.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){H.xr.setPoseTarget(J.camera.el.object3D)})}play(){var J=this,H=this;if(this.renderStarted){_.prototype.play.call(this);return}this.addEventListener("loaded",function(){var ae=this.renderer,ue,Me=this.renderer.xr;_.prototype.play.call(this),!H.renderStarted&&(H.resize(),H.renderer&&(window.performance&&window.performance.mark("render-started"),p.remove(),ue=x.device.getVRDisplay(),ue&&ue.isPresenting&&(Me.setDevice(ue),Me.enabled=!0,H.enterVR()),ae.setAnimationLoop(this.render),H.renderStarted=!0,H.emit("renderstart")))}),setTimeout(function(){_.prototype.load.call(J)})}updateComponent(J){J in u||_.prototype.updateComponent.apply(this,arguments)}tick(J,H){var ae,ue=this.systems;for(this.callComponentBehaviors("tick",J,H),ae=0;ae<this.systemNames.length;ae++)ue[this.systemNames[ae]].tick&&ue[this.systemNames[ae]].tick(J,H)}tock(J,H,ae){var ue,Me=this.systems;for(this.callComponentBehaviors("tock",J,H),ue=0;ue<this.systemNames.length;ue++)Me[this.systemNames[ue]].tock&&Me[this.systemNames[ue]].tock(J,H,ae)}render(J,H){var ae=this.renderer;this.frame=H,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var ue=null;this.is("ar-mode")&&(ue=this.object3D.background,this.object3D.background=null),ae.render(this.object3D,this.camera),ue&&(this.object3D.background=ue)}callComponentBehaviors(J,H,ae){for(var ue,Me=0;Me<this.componentOrder.length;Me++){var De=this.behaviors[this.componentOrder[Me]];if(De){var Ge=De[J];for(Ge.inUse=!0,ue=0;ue<Ge.array.length;ue++)Ge.array[ue].isPlaying&&Ge.array[ue][J](H,ae);for(Ge.inUse=!1,ue=0;ue<Ge.markedForRemoval.length;ue++)this.removeBehavior(Ge.markedForRemoval[ue]);Ge.markedForRemoval.length=0}}}}function F(se,J){var H={},ae,ue,Me=J||[];Me.length=0;for(ue in se){var De=se[ue];if(De!==void 0){var Ge=De.before?De.before.slice(0):[],Xe=De.after?De.after.slice(0):[];H[ue]={before:Ge,after:Xe,visited:!1,done:!1}}}for(ue in H)for(ae=0;ae<H[ue].before.length;ae++){var Je=H[ue].before[ae];if(!(Je in H)){T("Invalid ordering constraint, no component named `"+Je+"` referenced by `"+ue+"`");continue}H[Je].after.push(ue)}function pt(yt){if(!(!(yt in H)||H[yt].done)){if(H[yt].visited){T("Cycle detected, ignoring one or more before/after constraints. The resulting order might be incorrect");return}H[yt].visited=!0;for(var Gt=0;Gt<H[yt].after.length;Gt++){var Et=H[yt].after[Gt];Et in H||T("Invalid before/after constraint, no component named `"+Et+"` referenced in `"+yt+"`"),pt(Et)}H[yt].done=!0,Me.push(yt)}}for(ue in H)H[ue].done||pt(ue);return Me}m.exports.determineComponentBehaviorOrder=F;function j(se,J){var H,ae=window.devicePixelRatio;return!J||J.width===-1&&J.height===-1||se.width*ae<J.width&&se.height*ae<J.height||(H=se.width/se.height,se.width*ae>J.width&&J.width!==-1&&(se.width=Math.round(J.width/ae),se.height=Math.round(J.width/H/ae)),se.height*ae>J.height&&J.height!==-1&&(se.height=Math.round(J.height/ae),se.width=Math.round(J.height*H/ae))),se}customElements.define("a-scene",U);function Y(se,J,H,ae){if(!se.parentElement)return{height:0,width:0};if(J){var ue;return ue={height:se.parentElement.offsetHeight,width:se.parentElement.offsetWidth},j(ue,H)}return oe(H,ae)}function oe(se,J){var H;return H={height:document.body.offsetHeight,width:document.body.offsetWidth},J?H:j(H,se)}function te(se){var J=se.requestFullscreen||se.webkitRequestFullscreen||se.mozRequestFullScreen||se.msRequestFullscreen;J.apply(se,[{navigationUI:"hide"}])}function pe(){var se=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;se&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function de(se){var J;J=document.createElement("canvas"),J.classList.add("a-canvas"),J.dataset.aframeCanvas=!0,se.appendChild(J),document.addEventListener("fullscreenchange",H),document.addEventListener("mozfullscreenchange",H),document.addEventListener("webkitfullscreenchange",H),document.addEventListener("MSFullscreenChange",H),J.addEventListener("touchmove",function(ae){ae.preventDefault()},{passive:!1}),se.canvas=J,se.emit("render-target-loaded",{target:J}),setTimeout(se.resize.bind(se),0);function H(){var ae=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;ae||se.exitVR(),document.activeElement.blur(),document.body.focus()}}m.exports.setupCanvas=de,m.exports.AScene=U},"./src/core/scene/loadingScreen.js":(m,M,h)=>{var f=h("./src/utils/index.js"),C=f.styleParser,p,g,u,E="loading-screen",b="a-loader-title";m.exports.setup=function(w,S){p=w,u=S;var L=p.hasAttribute(E)?C.parse(p.getAttribute(E)):void 0,P=L&&L.dotsColor||"white",D=L&&L.backgroundColor||"#24CAFF",U=L===void 0||L.enabled==="true"||L.enabled===void 0,F,j,Y,oe,te,pe,de,se,J,H;U&&(F=new THREE.Scene,j=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),Y=new THREE.MeshBasicMaterial({color:P}),oe=new THREE.Mesh(j,Y),te=oe.clone(),pe=oe.clone(),de=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),se=new THREE.Clock,J=0,H=function(){p.renderer.render(F,de),J=se.getElapsedTime()%4,oe.visible=J>=1,te.visible=J>=2,pe.visible=J>=3},F.background=new THREE.Color(D),F.add(de),oe.position.set(-1,0,-15),te.position.set(0,0,-15),pe.position.set(1,0,-15),de.add(oe),de.add(te),de.add(pe),T(),setTimeout(function(){p.hasLoaded||(x(de),g.style.display="block",window.addEventListener("resize",function(){x(de)}),p.renderer.setAnimationLoop(H))},200))},m.exports.remove=function(){window.removeEventListener("resize",x),g&&(g.style.display="none")};function x(_){var w=p.hasAttribute("embedded"),S=u(p.canvas,w,p.maxCanvasSize,p.is("vr-mode"));_.aspect=S.width/S.height,_.updateProjectionMatrix(),p.renderer.setSize(S.width,S.height,!1)}function T(){g=document.createElement("div"),g.className=b,g.innerHTML=document.title,g.style.display="none",p.appendChild(g)}},"./src/core/scene/metaTags.js":(m,M,h)=>{var f=h("./src/constants/index.js"),C=h("./src/utils/index.js").extend,p=m.exports.MOBILE_HEAD_TAGS=[u({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),u({name:"mobile-web-app-capable",content:"yes"}),u({name:"theme-color",content:"black"})],g=[u({name:"apple-mobile-web-app-capable",content:"yes"}),u({name:"apple-mobile-web-app-status-bar-style",content:"black"}),E({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function u(x){return{tagName:"meta",attributes:x,exists:function(){return document.querySelector('meta[name="'+x.name+'"]')}}}function E(x){return{tagName:"link",attributes:x,exists:function(){return document.querySelector('link[rel="'+x.rel+'"]')}}}m.exports.inject=function(T){var _=document.head,w=_.querySelector("script"),S,L=[];return p.forEach(P),T.isIOS&&g.forEach(P),L;function P(D){!D||D.exists()||(S=b(D),S&&(w?w.parentNode.insertBefore(S,w):_.appendChild(S),L.push(S)))}};function b(x){if(!(!x||!x.tagName)){var T=document.createElement(x.tagName);return T.setAttribute(f.AFRAME_INJECTED,""),C(T,x.attributes)}}},"./src/core/scene/postMessage.js":(m,M,h)=>{var f=h("./src/utils/index.js").isIframed;m.exports=function(g){f()&&window.addEventListener("message",C.bind(g))};function C(p){var g=this;if(p.data)switch(p.data.type){case"vr":switch(p.data.data){case"enter":g.enterVR();break;case"exit":g.exitVR();break}}}},"./src/core/scene/scenes.js":m=>{m.exports=[]},"./src/core/scene/wakelock.js":(m,M,h)=>{var f=h("./vendor/wakelock/wakelock.js");m.exports=function(p){if(p.isMobile){var g=p.wakelock=new f;p.addEventListener("enter-vr",function(){g.request()}),p.addEventListener("exit-vr",function(){g.release()})}}},"./src/core/schema.js":(m,M,h)=>{var f=h("./src/utils/index.js"),C=h("./src/core/propertyTypes.js"),p=f.debug,g=C.isValidDefaultValue,u=C.propertyTypes,E=p("core:schema:warn");function b(w){return"type"in w?typeof w.type=="string":"default"in w}m.exports.isSingleProperty=b,m.exports.process=function(w,S){var L;if(b(w))return x(w,S);for(L in w)w[L]=x(w[L],S);return w};function x(w,S){var L=w.default,P,D,U=w.type;return w.type?w.type==="bool"?U="boolean":w.type==="float"&&(U="number"):L!==void 0&&(typeof L=="boolean"||typeof L=="number")?U=typeof L:Array.isArray(L)?U="array":U="string",D=u[U],D||E("Unknown property type for component `"+S+"`: "+U),P=!!w.parse,w.parse=w.parse||D.parse,w.stringify=w.stringify||D.stringify,w.equals=w.equals||D.equals,w.isCacheable=w.isCacheable===!0||D.isCacheable,w.type=U,"default"in w?!P&&!g(U,L)&&E("Default value `"+L+"` does not match type `"+U+"` in component `"+S+"`"):w.default=D.default,w}m.exports.processPropertyDefinition=x,m.exports.parseProperties=function(){var w=[];return function(S,L,P,D,U){var F,j,Y,oe;w.length=0;for(j in P?S:L)P&&S[j]===void 0||w.push(j);if(S===null||typeof S!="object")return S;for(j in S)S[j]!==void 0&&!L[j]&&!U&&E("Unknown property `"+j+"` for component/system `"+D+"`.");for(F=0;F<w.length;F++){if(j=w[F],Y=L[j],oe=S[j],!L[j])return;S[j]=T(oe,Y)}return S}}();function T(w,S,L){return(w==null||w==="")&&(w=S.default,Array.isArray(w)&&(w=w.slice())),S.parse(w,S.default,L)}m.exports.parseProperty=T,m.exports.stringifyProperties=function(w,S){var L,P,D,U={},F;for(L in w)P=S[L],D=w[L],F=D,typeof F=="object"&&(F=_(D,P),P||E("Unknown component property: "+L)),U[L]=F;return U};function _(w,S){return typeof w!="object"?w:!S||w===null?JSON.stringify(w):S.stringify(w)}m.exports.stringifyProperty=_},"./src/core/shader.js":(m,M,h)=>{var f=h("./src/core/schema.js"),C=f.process,p=m.exports.shaders={},g=m.exports.shaderNames=[],u=h("./src/lib/three.js"),E=h("./src/utils/index.js"),b={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},x=m.exports.Shader=function(){};x.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(T){return this.uniforms=this.initUniforms(),this.material=new(this.raw?u.RawShaderMaterial:u.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw||this.glsl3?u.GLSL3:null,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initUniforms:function(){var T,_=this.schema,w={},S;for(T in _)_[T].is==="uniform"&&(S=b[_[T].type],w[T]={type:S,value:void 0});return w},update:function(T){var _,w,S=this.schema,L=this.uniforms;for(_ in T)if(!(!S[_]||S[_].is!=="uniform")){if(S[_].type==="map"){if(!L[_]||L[_].value===T[_])continue;w="_texture_"+_,this.setMapOnTextureLoad(L,_,w),E.material.updateMapMaterialFromData(w,_,this,T);continue}L[_].value=this.parseValue(S[_].type,T[_]),L[_].needsUpdate=!0}},parseValue:function(T,_){var w;switch(T){case"vec2":return new u.Vector2(_.x,_.y);case"vec3":return new u.Vector3(_.x,_.y,_.z);case"vec4":return new u.Vector4(_.x,_.y,_.z,_.w);case"color":return w=new u.Color(_),new u.Vector3(w.r,w.g,w.b);default:return _}},setMapOnTextureLoad:function(T,_,w){var S=this;this.el.addEventListener("materialtextureloaded",function(){T[_].value=S.material[w],T[_].needsUpdate=!0})}},m.exports.registerShader=function(T,_){var w,S={};if(Object.keys(_).forEach(function(L){S[L]={value:_[L],writable:!0}}),p[T])throw new Error("The shader "+T+" has already been registered");return w=function(){x.call(this)},w.prototype=Object.create(x.prototype,S),w.prototype.name=T,w.prototype.constructor=w,p[T]={Shader:w,schema:C(w.prototype.schema)},g.push(T),w}},"./src/core/system.js":(m,M,h)=>{var f=h("./src/core/component.js"),C=h("./src/core/schema.js"),p=h("./src/utils/index.js"),g=h("./src/core/readyState.js"),u=C.parseProperties,E=C.parseProperty,b=C.process,x=C.isSingleProperty,T=p.styleParser,_=m.exports.systems={},w=m.exports.System=function(S){var L=f&&f.components[this.name];this.el=S,this.sceneEl=S,L&&(L.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};w.prototype={schema:{},init:function(){},update:function(S){},updateProperties:function(S){var L=this.data;Object.keys(C).length&&(this.buildData(S),this.update(L))},buildData:function(S){var L=this.schema;Object.keys(L).length&&(S=S||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),x(L)?this.data=E(S,L):this.data=u(T.parse(S)||{},L,!1,this.name))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},m.exports.registerSystem=function(S,L){var P,D,U={},F=p.findAllScenes(document);if(Object.keys(L).forEach(function(j){U[j]={value:L[j],writable:!0}}),_[S])throw new Error("The system `"+S+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");if(D=function(j){w.call(this,j)},D.prototype=Object.create(w.prototype,U),D.prototype.name=S,D.prototype.constructor=D,D.prototype.schema=p.extend(b(D.prototype.schema)),_[S]=D,g.canInitializeElements)for(P=0;P<F.length;P++)F[P].initSystem(S)}},"./src/extras/components/index.js":(m,M,h)=>{h("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(m,M,h)=>{var f=h("./src/core/component.js").registerComponent,C=h("./src/lib/three.js"),p=new C.Vector3,g=new C.Vector3;f("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var u=this.data,E=this.el,b=E.object3D.parent,x=E.object3D,T=new C.Group;p.copy(x.position),g.copy(x.rotation),b.remove(x),T.add(x),b.add(T),E.object3D=T,x.position.set(-1*u.x,-1*u.y,-1*u.z),T.position.set(u.x+p.x,u.y+p.y,u.z+p.z),T.rotation.copy(x.rotation),x.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(m,M,h)=>{var f=h("./src/core/component.js").components,C=h("./src/core/shader.js").shaders,p=h("./src/utils/index.js"),g={};Object.keys(f.material.schema).forEach(u),Object.keys(C.standard.schema).forEach(u);function u(E){var b=E.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();E==="fog"&&(b="material-fog"),E==="visible"&&(b="material-visible"),g[b]="material."+E}m.exports=function(){return{defaultComponents:{material:{}},mappings:p.extend({},g)}}},"./src/extras/primitives/index.js":(m,M,h)=>{h("./src/extras/primitives/primitives/a-camera.js"),h("./src/extras/primitives/primitives/a-cursor.js"),h("./src/extras/primitives/primitives/a-curvedimage.js"),h("./src/extras/primitives/primitives/a-gltf-model.js"),h("./src/extras/primitives/primitives/a-image.js"),h("./src/extras/primitives/primitives/a-light.js"),h("./src/extras/primitives/primitives/a-link.js"),h("./src/extras/primitives/primitives/a-obj-model.js"),h("./src/extras/primitives/primitives/a-sky.js"),h("./src/extras/primitives/primitives/a-sound.js"),h("./src/extras/primitives/primitives/a-text.js"),h("./src/extras/primitives/primitives/a-video.js"),h("./src/extras/primitives/primitives/a-videosphere.js"),h("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(m,M,h)=>{var f=h("./src/core/a-node.js").knownTags,C=h("./src/core/a-entity.js").AEntity,p=h("./src/core/component.js").components,g=h("./src/utils/index.js"),u=g.debug,E=g.entity.setComponentProperty,b=u("extras:primitives:debug"),x=u("extras:primitives:warn"),T=u("extras:primitives:error"),_=m.exports.primitives={};m.exports.registerPrimitive=function(D,U){if(D=D.toLowerCase(),f[D]){T("Trying to register primitive "+D+" that has been already previously registered");return}f[D]=!0,b("Registering <%s>",D),U.defaultAttributes&&x("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var F=U.mappings||{},j=class extends C{constructor(){super(),this.defaultComponentsFromPrimitive=U.defaultComponents||U.defaultAttributes||{},this.deprecated=U.deprecated||null,this.deprecatedMappings=U.deprecatedMappings||{},this.mappings=F,U.deprecated&&console.warn(U.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var Y=this.mappings,oe=this;Object.keys(Y).forEach(function(pe){var de;pe!==pe.toLowerCase()&&x("Mapping keys should be specified in lower case. The mapping key "+pe+" may not be recognized"),p[pe]&&(de=Y[pe].replace(".","-"),Y[de]=Y[pe],delete Y[pe],console.warn("The primitive "+oe.tagName.toLowerCase()+" has a mapping collision. The attribute "+pe+" has the same name as a registered component and has been renamed to "+de))})}getExtraComponents(){var Y,oe,te,pe,de,se=this;for(oe=g.clone(this.defaultComponentsFromPrimitive),de=this.getAttribute("mixin"),de&&(de=g.split(de.trim(),/\s+/),de.forEach(function(De){var Ge=document.getElementById(De);if(Ge){var Xe=Ge.rawAttributeCache,Je=Ge.componentCache;for(var pt in Xe){if(pe=se.mappings[pt],pe){w(pe,Xe[pt],oe);return}pt in Je&&(oe[pt]=J(oe[pt],Je[pt]))}}})),te=0;te<this.attributes.length;te++)Y=this.attributes[te],pe=this.mappings[Y.name],pe&&w(pe,Y.value,oe);return oe;function J(Me,De){return H(Me)?ae(De):H(De)?ae(Me):ue(Me)&&ue(De)?g.extendDeep(Me,De):ae(De)}function H(Me){return typeof Me>"u"}function ae(Me){return ue(Me)?g.extendDeep({},Me):Me}function ue(Me){return Me!==null&&Me.constructor===Object}}attributeChangedCallback(Y,oe,te){var pe=this.mappings[Y];if(Y in this.deprecatedMappings&&console.warn(this.deprecatedMappings[Y]),!Y||!pe){super.attributeChangedCallback(Y,oe,te);return}E(this,pe,te)}};return customElements.define(D,j),j.mappings=F,_[D]=j,j};function w(P,D,U){var F=g.entity.getComponentPropertyPath(P);F.constructor===Array?(U[F[0]]=U[F[0]]||{},U[F[0]][F[1]]=D.trim()):U[F]=D.trim()}function S(P,D){var U=p[P].schema;Object.keys(U).map(function(F){var j=F.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();D[j]!==void 0&&(j=P+"-"+F),D[j]=P+"."+F})}function L(P,D,U){U=U||{},Object.keys(D).map(function(j){S(j,U)}),m.exports.registerPrimitive(P,g.extendDeep({},null,{defaultComponents:D,mappings:U}))}m.exports.definePrimitive=L},"./src/extras/primitives/primitives/a-camera.js":(m,M,h)=>{var f=h("./src/extras/primitives/primitives.js").registerPrimitive;f("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js"),C=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");C("a-cursor",p.extendDeep({},f(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js"),C=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");C("a-curvedimage",p.extendDeep({},f(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(m,M,h)=>{var f=h("./src/extras/primitives/primitives.js").registerPrimitive;f("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js"),C=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");C("a-image",p.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(m,M,h)=>{var f=h("./src/extras/primitives/primitives.js").registerPrimitive;f("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(m,M,h)=>{var f=h("./src/extras/primitives/primitives.js").registerPrimitive;f("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js")(),C=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");C("a-obj-model",p.extendDeep({},f,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js"),C=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js"),g=h("./src/extras/primitives/primitives/meshPrimitives.js");C("a-sky",p.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:p.extendDeep({},g["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(m,M,h)=>{var f=h("./src/extras/primitives/primitives.js").registerPrimitive;f("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(m,M,h)=>{var f=h("./src/extras/primitives/primitives.js").definePrimitive;f("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js"),C=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");C("a-video",p.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js"),C=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");C("a-videosphere",p.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(m,M,h)=>{var f=h("./src/extras/primitives/getMeshMixin.js"),C=h("./src/core/geometry.js").geometries,p=h("./src/core/geometry.js").geometryNames,g=h("./src/extras/primitives/primitives.js").registerPrimitive,u=h("./src/utils/index.js"),E=m.exports={};p.forEach(function(T){var _=C[T],w=b(T),S={};Object.keys(_.schema).forEach(function(U){S[b(U)]="geometry."+U});var L="a-"+w,P=g(L,u.extendDeep({},f(),{defaultComponents:{geometry:{primitive:T}},mappings:S}));E[L]=P});function b(x){return x.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js");f("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(p){this.geometry=new C.BoxGeometry(p.width,p.height,p.depth,p.segmentsWidth,p.segmentsHeight,p.segmentsDepth)}})},"./src/geometries/circle.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js"),p=C.MathUtils.degToRad;f("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(g){this.geometry=new C.CircleGeometry(g.radius,g.segments,p(g.thetaStart),p(g.thetaLength))}})},"./src/geometries/cone.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js"),p=C.MathUtils.degToRad;f("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(g){this.geometry=new C.CylinderGeometry(g.radiusTop,g.radiusBottom,g.height,g.segmentsRadial,g.segmentsHeight,g.openEnded,p(g.thetaStart),p(g.thetaLength))}})},"./src/geometries/cylinder.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js"),p=C.MathUtils.degToRad;f("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(g){this.geometry=new C.CylinderGeometry(g.radius,g.radius,g.height,g.segmentsRadial,g.segmentsHeight,g.openEnded,p(g.thetaStart),p(g.thetaLength))}})},"./src/geometries/dodecahedron.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js");f("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new C.DodecahedronGeometry(p.radius,p.detail)}})},"./src/geometries/icosahedron.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js");f("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new C.IcosahedronGeometry(p.radius,p.detail)}})},"./src/geometries/index.js":(m,M,h)=>{h("./src/geometries/box.js"),h("./src/geometries/circle.js"),h("./src/geometries/cone.js"),h("./src/geometries/cylinder.js"),h("./src/geometries/dodecahedron.js"),h("./src/geometries/icosahedron.js"),h("./src/geometries/octahedron.js"),h("./src/geometries/plane.js"),h("./src/geometries/ring.js"),h("./src/geometries/sphere.js"),h("./src/geometries/tetrahedron.js"),h("./src/geometries/torus.js"),h("./src/geometries/torusKnot.js"),h("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js");f("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new C.OctahedronGeometry(p.radius,p.detail)}})},"./src/geometries/plane.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js");f("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(p){this.geometry=new C.PlaneGeometry(p.width,p.height,p.segmentsWidth,p.segmentsHeight)}})},"./src/geometries/ring.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js"),p=C.MathUtils.degToRad;f("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(g){this.geometry=new C.RingGeometry(g.radiusInner,g.radiusOuter,g.segmentsTheta,g.segmentsPhi,p(g.thetaStart),p(g.thetaLength))}})},"./src/geometries/sphere.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js"),p=C.MathUtils.degToRad;f("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(g){this.geometry=new C.SphereGeometry(g.radius,g.segmentsWidth,g.segmentsHeight,p(g.phiStart),p(g.phiLength),p(g.thetaStart),p(g.thetaLength))}})},"./src/geometries/tetrahedron.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js");f("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new C.TetrahedronGeometry(p.radius,p.detail)}})},"./src/geometries/torus.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js"),p=C.MathUtils.degToRad;f("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(g){this.geometry=new C.TorusGeometry(g.radius,g.radiusTubular*2,g.segmentsRadial,g.segmentsTubular,p(g.arc))}})},"./src/geometries/torusKnot.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js");f("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(p){this.geometry=new C.TorusKnotGeometry(p.radius,p.radiusTubular*2,p.segmentsTubular,p.segmentsRadial,p.p,p.q)}})},"./src/geometries/triangle.js":(m,M,h)=>{var f=h("./src/core/geometry.js").registerGeometry,C=h("./src/lib/three.js"),p=new C.Quaternion,g=new C.Vector3(0,0,1),u=new C.Vector2,E=new C.Vector2,b=new C.Vector2;f("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(x){var T,_,w,S,L,P,D,U,F;w=new C.Triangle,w.a.set(x.vertexA.x,x.vertexA.y,x.vertexA.z),w.b.set(x.vertexB.x,x.vertexB.y,x.vertexB.z),w.c.set(x.vertexC.x,x.vertexC.y,x.vertexC.z),_=w.getNormal(new C.Vector3),p.setFromUnitVectors(_,g),S=w.a.clone().applyQuaternion(p),L=w.b.clone().applyQuaternion(p),P=w.c.clone().applyQuaternion(p),u.set(Math.min(S.x,L.x,P.x),Math.min(S.y,L.y,P.y)),E.set(Math.max(S.x,L.x,P.x),Math.max(S.y,L.y,P.y)),b.set(0,0).subVectors(E,u),S=new C.Vector2().subVectors(S,u).divide(b),L=new C.Vector2().subVectors(L,u).divide(b),P=new C.Vector2().subVectors(P,u).divide(b),T=this.geometry=new C.BufferGeometry,D=[w.a.x,w.a.y,w.a.z,w.b.x,w.b.y,w.b.z,w.c.x,w.c.y,w.c.z],U=[_.x,_.y,_.z,_.x,_.y,_.z,_.x,_.y,_.z],F=[S.x,S.y,L.x,L.y,P.x,P.y],T.setAttribute("position",new C.Float32BufferAttribute(D,3)),T.setAttribute("normal",new C.Float32BufferAttribute(U,3)),T.setAttribute("uv",new C.Float32BufferAttribute(F,2))}})},"./src/index.js":(m,M,h)=>{if(window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var f=h("./src/utils/isIOSOlderThan10.js"),C=f(window.navigator.userAgent)?1/window.devicePixelRatio:1,p=h("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),g={BUFFER_SCALE:C,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new p(g)}var u=h("./src/utils/index.js"),E=u.debug,b=E("A-Frame:error"),x=E("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&x("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&b("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),u.device.isBrowserEnvironment&&(h("./src/style/aframe.css"),h("./src/style/rStats.css"));var T=h("./src/core/scene/a-scene.js").AScene,_=h("./src/core/component.js").components,w=h("./src/core/component.js").registerComponent,S=h("./src/core/geometry.js").registerGeometry,L=h("./src/extras/primitives/primitives.js").registerPrimitive,P=h("./src/core/shader.js").registerShader,D=h("./src/core/system.js").registerSystem,U=h("./src/core/shader.js").shaders,F=h("./src/core/system.js").systems,j=window.THREE=h("./src/lib/three.js"),Y=h("./src/core/readyState.js"),oe=h("./package.json");h("./src/components/index.js"),h("./src/geometries/index.js"),h("./src/shaders/index.js"),h("./src/systems/index.js");var te=h("./src/core/a-node.js").ANode,pe=h("./src/core/a-entity.js").AEntity;h("./src/core/a-assets.js"),h("./src/core/a-cubemap.js"),h("./src/core/a-mixin.js"),h("./src/extras/components/index.js"),h("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.6.0 (Date 2024-05-23, Commit #e6c47761)"),console.log("THREE Version (https://github.com/supermedium/three.js):",j.REVISION),console.log("WebVR Polyfill Version:",oe.dependencies["webvr-polyfill"]),window.AFRAME_ASYNC||Y.waitForDocumentReadyState(),m.exports=window.AFRAME={AComponent:h("./src/core/component.js").Component,AEntity:pe,ANode:te,ANIME:h("./node_modules/super-animejs/lib/anime.es.js").default,AScene:T,components:_,coreComponents:Object.keys(_),geometries:h("./src/core/geometry.js").geometries,registerComponent:w,registerGeometry:S,registerPrimitive:L,registerShader:P,registerSystem:D,primitives:{getMeshMixin:h("./src/extras/primitives/getMeshMixin.js"),primitives:h("./src/extras/primitives/primitives.js").primitives},scenes:h("./src/core/scene/scenes.js"),schema:h("./src/core/schema.js"),shaders:U,systems:F,emitReady:Y.emitReady,THREE:j,utils:u,version:oe.version}},"./src/lib/rStatsAframe.js":m=>{window.aframeStats=function(M){var h=null,f=M,C={te:{caption:"Entities"},lt:{caption:"Load Time"}},p=[{caption:"A-Frame",values:["te","lt"]}];function g(){h("te").set(u()),window.performance.getEntriesByName&&h("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function u(){var T=f.querySelectorAll("*");return Array.prototype.slice.call(T).filter(function(_){return _.isEntity}),T.length}function E(){}function b(){}function x(T){h=T}return{update:g,start:E,end:b,attach:x,values:C,groups:p,fractions:[]}},m.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(m,M,h)=>{var f=h("./src/lib/three.mjs").default;h.g.THREE=f,h("./vendor/DeviceOrientationControls.js"),f.Cache&&(f.Cache.enabled=!0),m.exports=f},"./src/shaders/flat.js":(m,M,h)=>{var f=h("./src/core/shader.js").registerShader,C=h("./src/lib/three.js"),p=h("./src/utils/index.js");m.exports.Shader=f("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(u){this.materialData={color:new C.Color},g(u,this.materialData),this.material=new C.MeshBasicMaterial(this.materialData)},update:function(u){this.updateMaterial(u),p.material.updateMap(this,u)},updateMaterial:function(u){var E;g(u,this.materialData);for(E in this.materialData)this.material[E]=this.materialData[E]}});function g(u,E){return E.color.set(u.color),E.fog=u.fog,E.wireframe=u.wireframe,E.toneMapped=u.toneMapped,E.wireframeLinewidth=u.wireframeLinewidth,E}},"./src/shaders/index.js":(m,M,h)=>{h("./src/shaders/flat.js"),h("./src/shaders/standard.js"),h("./src/shaders/phong.js"),h("./src/shaders/sdf.js"),h("./src/shaders/msdf.js"),h("./src/shaders/shadow.js")},"./src/shaders/msdf.js":(m,M,h)=>{var f=h("./src/core/shader.js").registerShader,C=h("./src/lib/three.js"),p=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),g=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);m.exports.Shader=f("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},vertexShader:p,fragmentShader:g,init:function(){return this.uniforms=C.UniformsUtils.merge([C.UniformsLib.fog,this.initUniforms()]),this.material=new C.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/phong.js":(m,M,h)=>{var f=h("./src/core/shader.js").registerShader,C=h("./src/lib/three.js"),p=h("./src/utils/index.js");m.exports.Shader=f("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(u){this.materialData={color:new C.Color,specular:new C.Color,emissive:new C.Color},g(u,this.materialData),this.material=new C.MeshPhongMaterial(this.materialData);var E=this.el.sceneEl;Object.defineProperty(this.material,"envMap",{get:function(){return this._envMap||E.object3D.environment},set:function(b){this._envMap=b}})},update:function(u){this.updateMaterial(u),p.material.updateMap(this,u),p.material.updateDistortionMap("normal",this,u),p.material.updateDistortionMap("displacement",this,u),p.material.updateDistortionMap("ambientOcclusion",this,u),p.material.updateDistortionMap("bump",this,u),p.material.updateEnvMap(this,u)},updateMaterial:function(u){var E;g(u,this.materialData);for(E in this.materialData)this.material[E]=this.materialData[E]}});function g(u,E){switch(E.color.set(u.color),E.specular.set(u.specular),E.emissive.set(u.emissive),E.emissiveIntensity=u.emissiveIntensity,E.fog=u.fog,E.transparent=u.transparent,E.wireframe=u.wireframe,E.wireframeLinewidth=u.wireframeLinewidth,E.shininess=u.shininess,E.flatShading=u.flatShading,E.wireframe=u.wireframe,E.wireframeLinewidth=u.wireframeLinewidth,E.reflectivity=u.reflectivity,E.refractionRatio=u.refractionRatio,u.combine){case"mix":E.combine=C.MixOperation;break;case"multiply":E.combine=C.MultiplyOperation;break;case"add":E.combine=C.AddOperation;break}return u.normalMap&&(E.normalScale=u.normalScale),u.ambientOcclusionMap&&(E.aoMapIntensity=u.ambientOcclusionMapIntensity),u.bumpMap&&(E.bumpScale=u.bumpMapScale),u.displacementMap&&(E.displacementScale=u.displacementScale,E.displacementBias=u.displacementBias),E}},"./src/shaders/sdf.js":(m,M,h)=>{var f=h("./src/core/shader.js").registerShader,C=h("./src/lib/three.js"),p=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),g=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec2 uv = vUV;","  vec4 texColor = texture(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture(map, box.xy).a, width)","      + contour(texture(map, box.zw).a, width)","      + contour(texture(map, box.xw).a, width)","      + contour(texture(map, box.zy).a, width)","    )) / 3.0;","  }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color, opacity * alpha);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);m.exports.Shader=f("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:p,fragmentShader:g,init:function(){return this.uniforms=C.UniformsUtils.merge([C.UniformsLib.fog,this.initUniforms()]),this.material=new C.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/shadow.js":(m,M,h)=>{var f=h("./src/core/shader.js").registerShader,C=h("./src/lib/three.js");m.exports.Shader=f("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(p){this.material=new C.ShadowMaterial},update:function(p){this.material.opacity=p.opacity,this.material.alphaToCoverage=p.alphaToCoverage,this.material.transparent=p.transparent}})},"./src/shaders/standard.js":(m,M,h)=>{var f=h("./src/core/shader.js").registerShader,C=h("./src/lib/three.js"),p=h("./src/utils/index.js");m.exports.Shader=f("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(u){this.materialData={color:new C.Color,emissive:new C.Color},g(u,this.materialData),this.material=new C.MeshStandardMaterial(this.materialData)},update:function(u){this.updateMaterial(u),p.material.updateMap(this,u),p.material.updateDistortionMap("normal",this,u),p.material.updateDistortionMap("displacement",this,u),p.material.updateDistortionMap("ambientOcclusion",this,u),p.material.updateDistortionMap("metalness",this,u),p.material.updateDistortionMap("roughness",this,u),p.material.updateEnvMap(this,u)},updateMaterial:function(u){var E,b=this.material;g(u,this.materialData);for(E in this.materialData)b[E]=this.materialData[E]}});function g(u,E){return E.color.set(u.color),E.emissive.set(u.emissive),E.emissiveIntensity=u.emissiveIntensity,E.fog=u.fog,E.metalness=u.metalness,E.roughness=u.roughness,E.wireframe=u.wireframe,E.wireframeLinewidth=u.wireframeLinewidth,u.normalMap&&(E.normalScale=u.normalScale),u.ambientOcclusionMap&&(E.aoMapIntensity=u.ambientOcclusionMapIntensity),u.displacementMap&&(E.displacementScale=u.displacementScale,E.displacementBias=u.displacementBias),E}},"./src/systems/camera.js":(m,M,h)=>{var f=h("./src/constants/index.js"),C=h("./src/core/system.js").registerSystem,p="data-aframe-default-camera";m.exports.System=C("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var u,E,b=this.sceneEl,x=this;if(b.camera&&!b.camera.el.getAttribute("camera").spectator){b.emit("cameraready",{cameraEl:b.camera.el});return}if(u=b.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!u.length){this.createDefaultCamera();return}for(this.numUserCameras=u.length,E=0;E<u.length;E++)u[E].addEventListener("object3dset",function(T){T.detail.type==="camera"&&x.checkUserCamera(this)}),u[E].isNode?u[E].load():u[E].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(u){var E,b=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(E=u.getAttribute("camera"),!E.active||E.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,b.camera=u.getObject3D("camera"),b.emit("cameraready",{cameraEl:u})}},createDefaultCamera:function(){var u,E=this.sceneEl;u=document.createElement("a-entity"),u.setAttribute("camera",{active:!0}),u.setAttribute("position",{x:0,y:f.DEFAULT_CAMERA_HEIGHT,z:0}),u.setAttribute("wasd-controls",""),u.setAttribute("look-controls",""),u.setAttribute(f.AFRAME_INJECTED,""),u.addEventListener("object3dset",function(b){b.detail.type==="camera"&&(E.camera=b.detail.object,E.emit("cameraready",{cameraEl:u}))}),E.appendChild(u)},disableActiveCamera:function(){var u,E;u=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),E=u[u.length-1],E.setAttribute("camera","active",!0)},setActiveCamera:function(u){var E,b,x,T,_=this.activeCameraEl,w=this.sceneEl;if(T=u.getObject3D("camera"),!(!T||u===this.activeCameraEl)){var S=w.querySelector("["+p+"]"),L=S&&S.querySelector(":not(a-mixin)[camera]");for(u!==L&&g(w),this.activeCameraEl=u,this.activeCameraEl.play(),w.camera=T,_&&_.setAttribute("camera","active",!1),b=w.querySelectorAll(":not(a-mixin)[camera]"),x=0;x<b.length;x++)E=b[x],!(!E.isEntity||u===E)&&(E.setAttribute("camera","active",!1),E.pause());w.emit("camera-set-active",{cameraEl:u})}},setSpectatorCamera:function(u){var E,b=this.spectatorCameraEl,x=this.sceneEl,T;E=u.getObject3D("camera"),!(!E||u===this.spectatorCameraEl)&&(b&&b.setAttribute("camera","spectator",!1),T=this.spectatorCameraEl=u,x.addEventListener("enter-vr",this.wrapRender),x.addEventListener("exit-vr",this.unwrapRender),T.setAttribute("camera","active",!1),T.play(),x.emit("camera-set-spectator",{cameraEl:u}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(u,E){var b,x=this.sceneEl,T;b=x.renderer.xr.enabled,this.originalRender.call(x.renderer,u,E),!(!this.spectatorCameraEl||x.isMobile||!b)&&(T=this.spectatorCameraEl.components.camera.camera,x.renderer.xr.enabled=!1,this.originalRender.call(x.renderer,u,T),x.renderer.xr.enabled=b)}});function g(u){var E,b=u.camera;b&&(E=u.querySelector("["+p+"]"),E&&u.removeChild(E))}},"./src/systems/geometry.js":(m,M,h)=>{var f=h("./src/core/geometry.js").geometries,C=h("./src/core/system.js").registerSystem;m.exports.System=C("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(E){var b=this.cache,x,T;return E.skipCache?p(E):(T=this.hash(E),x=b[T],u(this.cacheCount,T),x||(x=p(E),b[T]=x,x))},unuseGeometry:function(E){var b=this.cache,x=this.cacheCount,T,_;E.skipCache||(_=this.hash(E),b[_]&&(g(x,_),!(x[_]>0)&&(T=b[_],T.dispose(),delete b[_],delete x[_])))},hash:function(E){return JSON.stringify(E)}});function p(E){var b=E.primitive,x=f[b]&&f[b].Geometry,T=new x;if(!x)throw new Error("Unknown geometry `"+b+"`");return T.init(E),T.geometry}function g(E,b){E[b]--}function u(E,b){E[b]=E[b]===void 0?1:E[b]+1}},"./src/systems/gltf-model.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/lib/three.js");function p(g){return new Promise(function(u,E){var b=document.createElement("script");document.body.appendChild(b),b.onload=u,b.onerror=E,b.async=!0,b.src=g})}m.exports.System=f("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var g=this.data.dracoDecoderPath,u=this.data.basisTranscoderPath,E=this.data.meshoptDecoderPath;!this.dracoLoader&&g&&(this.dracoLoader=new C.DRACOLoader,this.dracoLoader.setDecoderPath(g)),!this.ktx2Loader&&u&&(this.ktx2Loader=new C.KTX2Loader,this.ktx2Loader.setTranscoderPath(u).detectSupport(this.el.renderer)),!this.meshoptDecoder&&E&&(this.meshoptDecoder=p(E).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(m,M,h)=>{h("./src/systems/camera.js"),h("./src/systems/geometry.js"),h("./src/systems/gltf-model.js"),h("./src/systems/light.js"),h("./src/systems/material.js"),h("./src/systems/obb-collider.js"),h("./src/systems/renderer.js"),h("./src/systems/shadow.js"),h("./src/systems/tracked-controls-webvr.js"),h("./src/systems/tracked-controls-webxr.js"),h("./src/systems/webxr.js")},"./src/systems/light.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/constants/index.js"),p="data-aframe-default-light";m.exports.System=f("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",this.setupDefaultLights.bind(this))},registerLight:function(g){g.hasAttribute(p)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var g,u=this.sceneEl;if(this.defaultLights){g=document.querySelectorAll("["+p+"]");for(var E=0;E<g.length;E++)u.removeChild(g[E]);this.defaultLights=!1}},setupDefaultLights:function(){var g=this.sceneEl,u,E;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(u=document.createElement("a-entity"),u.setAttribute("light",{color:"#BBB",type:"ambient"}),u.setAttribute(p,""),u.setAttribute(C.AFRAME_INJECTED,""),g.appendChild(u),E=document.createElement("a-entity"),E.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),E.setAttribute("position",{x:-.5,y:1,z:1}),E.setAttribute(p,""),E.setAttribute(C.AFRAME_INJECTED,""),g.appendChild(E),this.defaultLights=!0)}})},"./src/systems/material.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/lib/three.js"),p=h("./src/utils/index.js"),g=h("./src/utils/material.js").setTextureProperties,u=h("./src/utils/material.js").createCompatibleTexture,E=p.debug,b=E("components:texture:error"),x=E("components:texture:warn"),T=new C.ImageLoader;m.exports.System=f("material",{init:function(){this.materials={},this.sourceCache={}},clearTextureSourceCache:function(){this.sourceCache={}},loadTexture:function(L,P,D){this.loadTextureSource(L,function(F){var j=u(F);g(j,P),D(j)})},loadTextureSource:function(L,P){var D=this,U=this.sourceCache,F=this.hash(L);if(U[F]){U[F].then(P);return}if(L.tagName==="CANVAS"){Y(new C.Source(L));return}Y(new Promise(j));function j(oe,te){p.srcLoader.validateSrc(L,pe,de);function pe(se){D.loadImage(se,oe)}function de(se){D.loadVideo(se,oe)}}function Y(oe){U[F]=Promise.resolve(oe),U[F].then(P)}},loadCubeMapTexture:function(L,P){var D=this,U=0,F=new C.CubeTexture;F.colorSpace=C.SRGBColorSpace;function j(oe){D.loadTextureSource(L[oe],function(te){F.images[oe]=te,U++,U===6&&(F.needsUpdate=!0,P(F))})}if(L.length!==6){x("Cube map texture requires exactly 6 sources, got only %s sources",L.length);return}for(var Y=0;Y<L.length;Y++)j(Y)},loadImage:function(L,P){if(typeof L!="string"){P(new C.Source(L));return}P(_(L))},loadVideo:function(L,P){var D;typeof L!="string"&&(D=L,S(D)),D=D||w(L),P(new C.Source(D))},hash:function(L){return L.tagName&&(L.id||L.src)||L},registerMaterial:function(L){this.materials[L.uuid]=L},unregisterMaterial:function(L){delete this.materials[L.uuid]}});function _(L){return new Promise(P);function P(D,U){T.load(L,F,function(){},function(j){b("`$s` could not be fetched (Error code: %s; Response: %s)",j.status,j.statusText)});function F(j){D(new C.Source(j))}}}function w(L){var P=document.createElement("video");return P.setAttribute("playsinline",""),P.setAttribute("webkit-playsinline",""),P.autoplay=!0,P.loop=!0,P.crossOrigin="anonymous",P.addEventListener("error",function(){x("`%s` is not a valid video",L)},!0),P.src=L,P}function S(L){return L.autoplay=L.hasAttribute("autoplay")&&L.getAttribute("autoplay")!=="false",L.controls=L.hasAttribute("controls")&&L.getAttribute("controls")!=="false",L.getAttribute("loop")==="false"&&L.removeAttribute("loop"),L.getAttribute("preload")==="false"&&(L.preload="none"),L.crossOrigin=L.crossOrigin||"anonymous",L.setAttribute("playsinline",""),L.setAttribute("webkit-playsinline",""),L}},"./src/systems/obb-collider.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem;f("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(C){this.colliderEls.push(C),this.data.showColliders?C.components["obb-collider"].showCollider():C.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(C){var p=this.colliderEls,g=p.indexOf(C);C.components["obb-collider"].hideCollider(),g>-1&&p.splice(g,1),p.length===0&&(this.tick=void 0)},registerCollision:function(C,p){var g=this.collisions,u=!1,E=C.obb,b=p.obb,x=C.renderColliderMesh,T=p.renderColliderMesh;x&&x.material.color.set(16711680),T&&T.material.color.set(16711680);for(var _=0;_<g.length;_++)if(g[_].componentA.obb===E&&g[_].componentB.obb===b||g[_].componentA.obb===b&&g[_].componentB.obb===E){u=!0,g[_].detected=!0;break}u||(g.push({componentA:C,componentB:p,detected:!0}),C.el.emit("obbcollisionstarted",{trackedObject3D:C.trackedObject3D,withEl:p.el}),p.el.emit("obbcollisionstarted",{trackedObject3D:p.trackedObject3D,withEl:C.el}))},resetCollisions:function(){for(var C=this.collisions,p=0;p<C.length;p++)C[p].detected=!1},clearCollisions:function(){for(var C=this.collisions,p=[],g,u,E,b,x=0;x<C.length;x++)C[x].detected?p.push(C[x]):(g=C[x].componentA,u=C[x].componentB,E=g.renderColliderMesh,b=u.renderColliderMesh,E&&E.material.color.set(65280),g.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:u.el}),b&&b.material.color.set(65280),u.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:g.el}));this.collisions=p},detectCollisions:function(){var C,p,g,u,E=this.colliderEls;if(!(E.length<2)){this.resetCollisions();for(var b=0;b<E.length;b++)if(g=E[b].components["obb-collider"],C=E[b].components["obb-collider"].obb,!(C.halfSize.x===0||C.halfSize.y===0||C.halfSize.z===0))for(var x=b+1;x<E.length;x++)u=E[x].components["obb-collider"],p=u.obb,!(p.halfSize.x===0||p.halfSize.y===0||p.halfSize.z===0)&&C.intersectsOBB(p)&&this.registerCollision(g,u);this.clearCollisions()}}})},"./src/systems/renderer.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/utils/index.js"),p=h("./src/lib/three.js"),g=C.debug,u=g("components:renderer:warn");m.exports.System=f("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:C.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:-1},maxCanvasHeight:{default:-1},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},stencil:{default:!1},foveationLevel:{default:1}},init:function(){var T=this.data,_=this.el,w=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),S=_.renderer;T.physicallyCorrectLights||(S.useLegacyLights=!T.physicallyCorrectLights),S.toneMapping=p[w+"ToneMapping"],p.Texture.DEFAULT_ANISOTROPY=T.anisotropy,p.ColorManagement.enabled=T.colorManagement,S.outputColorSpace=T.colorManagement?p.SRGBColorSpace:p.LinearSRGBColorSpace,_.hasAttribute("antialias")&&u('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),_.hasAttribute("logarithmicDepthBuffer")&&u('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),S.sortObjects=!0,S.setOpaqueSort(E)},update:function(){var T=this.data,_=this.el,w=_.renderer,S=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);w.toneMapping=p[S+"ToneMapping"],w.toneMappingExposure=T.exposure,w.xr.setFoveation(T.foveationLevel),T.sortObjects&&u('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),T.sortTransparentObjects?w.setTransparentSort(x):w.setTransparentSort(b)},applyColorCorrection:function(T){!this.data.colorManagement||!T||T.isTexture&&T.colorSpace!==p.SRGBColorSpace&&(T.colorSpace=p.SRGBColorSpace,T.needsUpdate=!0)},setWebXRFrameRate:function(T){var _=this.data,w=T.supportedFrameRates;if(w&&T.updateTargetFrameRate){var S;w.includes(90)?S=_.highRefreshRate?90:72:S=_.highRefreshRate?72:60,T.updateTargetFrameRate(S).catch(function(L){console.warn("failed to set target frame rate of "+S+". Error info: "+L)})}}});function E(T,_){return T.groupOrder!==_.groupOrder?T.groupOrder-_.groupOrder:T.renderOrder!==_.renderOrder?T.renderOrder-_.renderOrder:T.z-_.z}function b(T,_){return T.groupOrder!==_.groupOrder?T.groupOrder-_.groupOrder:T.renderOrder-_.renderOrder}function x(T,_){return T.groupOrder!==_.groupOrder?T.groupOrder-_.groupOrder:T.renderOrder!==_.renderOrder?T.renderOrder-_.renderOrder:_.z-T.z}m.exports.sortFrontToBack=E,m.exports.sortRenderOrderOnly=b,m.exports.sortBackToFront=x},"./src/systems/shadow.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/lib/three.js"),p={basic:C.BasicShadowMap,pcf:C.PCFShadowMap,pcfsoft:C.PCFSoftShadowMap};m.exports.System=f("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var u=this.sceneEl,E=this.data;this.shadowMapEnabled=!1,u.renderer.shadowMap.type=p[E.type],u.renderer.shadowMap.autoUpdate=E.autoUpdate},update:function(u){u.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.shadowMapEnabled)},setShadowMapEnabled:function(u){var E=this.sceneEl,b=this.sceneEl.renderer;this.shadowMapEnabled=u;var x=this.data.enabled&&this.shadowMapEnabled;b&&x!==b.shadowMap.enabled&&(b.shadowMap.enabled=x,g(E))}});function g(u){u.hasLoaded&&u.object3D.traverse(function(E){if(E.material)for(var b=Array.isArray(E.material)?E.material:[E.material],x=0;x<b.length;x++)b[x].needsUpdate=!0})}},"./src/systems/tracked-controls-webvr.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/utils/index.js"),p=C.device.isWebXRAvailable;m.exports.System=f("tracked-controls-webvr",{init:function(){var g=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=C.throttle(this.updateControllerList,500,this),!p&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(u){u.length&&(g.vrDisplay=u[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var g=this.controllers,u,E,b,x;if(E=navigator.getGamepads&&navigator.getGamepads(),!!E){for(x=g.length,g.length=0,b=0;b<E.length;++b)u=E[b],u&&u.pose&&g.push(u);g.length!==x&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/utils/index.js");m.exports.System=f("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=C.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var p=this,g=this.el.xrSession;if(!g){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var u=p.el.sceneEl.systems.webxr.sessionReferenceSpaceType;g.requestReferenceSpace(u).then(function(E){p.referenceSpace=E}).catch(function(E){throw p.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(u,'tracked-controls-webxr uses reference space "'+u+'".'),E})},updateControllerList:function(){var p=this.el.xrSession,g=this.oldControllers,u;if(!p){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(p.inputSources){if(this.controllers=p.inputSources,this.oldControllersLength===this.controllers.length){var E=!0;for(u=0;u<this.controllers.length;++u)if(!(this.controllers[u]===g[u]&&this.controllers[u].gamepad===g[u].gamepad)){E=!1;break}if(E)return}for(g.length=0,u=0;u<this.controllers.length;u++)g.push(this.controllers[u]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(m,M,h)=>{var f=h("./src/core/system.js").registerSystem,C=h("./src/utils/index.js"),p=C.debug("systems:webxr:warn");m.exports.System=f("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var g=this.data;this.sessionConfiguration={requiredFeatures:g.requiredFeatures,optionalFeatures:g.optionalFeatures},this.sessionReferenceSpaceType=g.referenceSpaceType,g.overlayElement&&(g.overlayElement.classList.remove("a-dom-overlay"),g.optionalFeatures.includes("dom-overlay")||(g.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",g)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:g.overlayElement},g.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(g){return!!(g==="viewer"||g==="local"||this.sessionConfiguration.requiredFeatures.includes(g)||this.sessionConfiguration.optionalFeatures.includes(g))},warnIfFeatureNotRequested:function(g,u){if(!this.wasFeatureRequested(g)){var E='Please add the feature "'+g+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;p((u?u+" ":"")+E)}}})},"./src/utils/coordinates.js":(m,M,h)=>{var f=h("./src/utils/debug.js"),C=f("utils:coordinates:warn"),p=["x","y","z","w"],g=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;m.exports.regex=g;var u=/\s+/g;function E(w,S,L){var P,D,U,F,j=L&&typeof L=="object"?L:{},Y,oe,te,pe;if(w&&w instanceof Object)return Y=w.x===void 0?S&&S.x:w.x,oe=w.y===void 0?S&&S.y:w.y,te=w.z===void 0?S&&S.z:w.z,pe=w.w===void 0?S&&S.w:w.w,Y!=null&&(j.x=_(Y)),oe!=null&&(j.y=_(oe)),te!=null&&(j.z=_(te)),pe!=null&&(j.w=_(pe)),j;if(w==null)return typeof S=="object"?Object.assign(j,S):S;for(P=w.trim().split(u),F=0;F<p.length;F++)if(U=p[F],P[F])j[U]=parseFloat(P[F],10);else{if(D=S&&S[U],D===void 0)continue;j[U]=_(D)}return j}m.exports.parse=E;function b(w){var S;return typeof w!="object"?w:(S=w.x+" "+w.y,w.z!=null&&(S+=" "+w.z),w.w!=null&&(S+=" "+w.w),S)}m.exports.stringify=b;function x(w,S){return typeof w!="object"||typeof S!="object"?w===S:w.x===S.x&&w.y===S.y&&w.z===S.z&&w.w===S.w}m.exports.equals=x;function T(w){return g.test(w)}m.exports.isCoordinates=T,m.exports.isCoordinate=function(w){return C("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),T(w)};function _(w){return w!=null&&w.constructor===String?parseFloat(w,10):w}m.exports.toVector3=function(w){return new THREE.Vector3(w.x,w.y,w.z)}},"./src/utils/debug.js":(m,M,h)=>{var f=h("./node_modules/debug/src/browser.js"),C=h("./src/utils/device.js").isBrowserEnvironment,p={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};f.formatArgs=g;function g(T){if(T[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+T[0]+(this.useColors?"%c ":" "),!!this.useColors){this.color=E(this.namespace);var _="color: "+this.color;T.splice(1,0,_,"color: inherit");var w=0,S=0;T[0].replace(/%[a-zA-Z%]/g,function(L){L!=="%%"&&(w++,L==="%c"&&(S=w))}),T.splice(S,0,_)}}function u(T){var _=T.split(":");return _[_.length-1]}function E(T){var _=u(T),w=p.colors&&p.colors[_];return w||null}function b(){try{return window.localStorage}catch{}}var x=b();x&&(parseInt(x.logs,10)||x.logs==="true")?f.enable("*"):f.enable("*:error,*:info,*:warn"),C&&(window.logs=f),m.exports=f},"./src/utils/device.js":(m,M,h)=>{var f=h("./node_modules/debug/src/browser.js")("device:error"),C,p=!1,g=!1,u=m.exports.isWebXRAvailable=navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(te){var pe;u||(pe=document.createElement("canvas"),C=te.display,pe.getContext("webgl",{}),C.requestPresent([{source:pe}]).then(function(){},function(){}))}),u){var E=function(){var te=document.querySelector("a-scene");if(!te){window.addEventListener("DOMContentLoaded",E);return}te.hasLoaded?te.components["xr-mode-ui"].updateEnterInterfaces():te.addEventListener("loaded",E)},b=function(te){f("WebXR session support error: "+te.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(te){p=te,E()}).catch(b),navigator.xr.isSessionSupported("immersive-ar").then(function(te){g=te,E()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){p=!0,E()}).catch(b),navigator.xr.supportsSession("immersive-ar").then(function(){g=!0,E()}).catch(function(){})):f("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(te){var pe=document.querySelector("a-scene");C=te.length&&te[0],pe&&pe.emit("displayconnected",{vrDisplay:C})});function x(){return C}m.exports.getVRDisplay=x;function T(){return p||g||!!x()}m.exports.checkHeadsetConnected=T;function _(){return g}m.exports.checkARSupport=_;function w(){return p}m.exports.checkVRSupport=w;var S=function(){var te=!1;return function(pe){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(pe)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(pe.substr(0,4)))&&(te=!0),(D()||L()||oe())&&(te=!0),Y()&&(te=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return te}}();m.exports.isMobile=S;function L(te){var pe=te||window.navigator.userAgent,de=/Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(pe);return de||P()}m.exports.isTablet=L;function P(te,pe,de){var se=te||window.navigator.userAgent,J=pe||window.navigator.platform,H=de||window.navigator.maxTouchPoints||0;return(J==="iPad"||J==="MacIntel")&&H>0&&/Macintosh|Intel|iPad|ipad/i.test(se)&&!window.MSStream}m.exports.isIpad=P;function D(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}m.exports.isIOS=D;function U(){return!S()&&!Y()&&window.orientation!==void 0}m.exports.isMobileDeviceRequestingDesktopSite=U;function F(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}m.exports.isOculusBrowser=F;function j(){return/(Mobile VR)/i.test(window.navigator.userAgent)}m.exports.isFirefoxReality=j;function Y(){return F()||j()}m.exports.isMobileVR=Y;function oe(){return/R7 Build/.test(window.navigator.userAgent)}m.exports.isR7=oe,m.exports.isLandscape=function(){var te=window.orientation;return oe()&&(te+=90),te===90||te===-90},m.exports.isBrowserEnvironment=typeof process>"u"||process.browser===!0,m.exports.isNodeEnvironment=!m.exports.isBrowserEnvironment},"./src/utils/entity.js":(m,M,h)=>{var f=h("./src/utils/split.js").split;function C(p,g){g=g||".";var u=f(p,g);return u.length===1?u[0]:u}m.exports.getComponentPropertyPath=C,m.exports.getComponentProperty=function(p,g,u){var E;return u=u||".",g.indexOf(u)!==-1?(E=C(g,u),E.constructor===String?p.getAttribute(E):p.getAttribute(E[0])[E[1]]):p.getAttribute(g)},m.exports.setComponentProperty=function(p,g,u,E){var b;if(E=E||".",g.indexOf(E)!==-1){b=C(g,E),b.constructor===String?p.setAttribute(b,u):p.setAttribute(b[0],b[1],u);return}p.setAttribute(g,u)}},"./src/utils/forceCanvasResizeSafariMobile.js":m=>{m.exports=function(h){var f=h.style.width,C=h.style.height;h.style.width=parseInt(f,10)+1+"px",h.style.height=parseInt(C,10)+1+"px",setTimeout(function(){h.style.width=f,h.style.height=C},200)}},"./src/utils/index.js":(m,M,h)=>{var f=h("./src/utils/debug.js"),C=h("./node_modules/deep-assign/index.js"),p=h("./src/utils/device.js"),g=h("./src/utils/object-pool.js"),u=f("utils:warn");m.exports.bind=function(b){return b.bind.apply(b,Array.prototype.slice.call(arguments,1))},m.exports.coordinates=h("./src/utils/coordinates.js"),m.exports.debug=f,m.exports.device=p,m.exports.entity=h("./src/utils/entity.js"),m.exports.forceCanvasResizeSafariMobile=h("./src/utils/forceCanvasResizeSafariMobile.js"),m.exports.material=h("./src/utils/material.js"),m.exports.objectPool=g,m.exports.split=h("./src/utils/split.js").split,m.exports.styleParser=h("./src/utils/styleParser.js"),m.exports.trackedControls=h("./src/utils/tracked-controls.js"),m.exports.checkHeadsetConnected=function(){return u("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),p.checkHeadsetConnected(arguments)},m.exports.isGearVR=m.exports.device.isGearVR=function(){u("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},m.exports.isIOS=function(){return u("`utils.isIOS` has moved to `utils.device.isIOS`"),p.isIOS(arguments)},m.exports.isOculusGo=m.exports.device.isOculusGo=function(){u("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},m.exports.isMobile=function(){return u("`utils.isMobile has moved to `utils.device.isMobile`"),p.isMobile(arguments)},m.exports.throttle=function(b,x,T){var _;return T&&(b=b.bind(T)),function(){var w=Date.now(),S=typeof _>"u"?x:w-_;(typeof _>"u"||S>=x)&&(_=w,b.apply(null,arguments))}},m.exports.throttleLeadingAndTrailing=function(b,x,T){var _,w;T&&(b=b.bind(T));var S,L=function(){_=Date.now(),b.apply(this,S),w=void 0};return function(){var P=Date.now(),D=typeof _>"u"?x:P-_;D>=x?(clearTimeout(w),w=void 0,_=P,b.apply(null,arguments)):(w=w||setTimeout(L,x-D),S=arguments)}},m.exports.throttleTick=function(b,x,T){var _;return T&&(b=b.bind(T)),function(w,S){var L=typeof _>"u"?S:w-_;(typeof _>"u"||L>=x)&&(_=w,b(w,L))}},m.exports.debounce=function(b,x,T){var _;return function(){var w=this,S=arguments,L=function(){_=null,T||b.apply(w,S)},P=T&&!_;clearTimeout(_),_=setTimeout(L,x),P&&b.apply(w,S)}},m.exports.extend=Object.assign,m.exports.extendDeep=C,m.exports.clone=function(b){return JSON.parse(JSON.stringify(b))};var E=function(){var b=g.createPool(function(){return[]});return function(x,T){var _,w,S,L,P,D;if(x===void 0||T===void 0||x===null||T===null||!(x&&T&&x.constructor===Object&&T.constructor===Object||x.constructor===Array&&T.constructor===Array))return x===T;w=b.use(),S=b.use(),w.length=0,S.length=0;for(_ in x)w.push(_);for(_ in T)S.push(_);if(w.length!==S.length)return b.recycle(w),b.recycle(S),!1;for(L=0;L<w.length;++L)if(P=x[w[L]],D=T[w[L]],typeof P=="object"||typeof D=="object"||Array.isArray(P)&&Array.isArray(D)){if(P===D)continue;if(!E(P,D))return b.recycle(w),b.recycle(S),!1}else if(P!==D)return b.recycle(w),b.recycle(S),!1;return b.recycle(w),b.recycle(S),!0}}();m.exports.deepEqual=E,m.exports.diff=function(){var b=[];return function(x,T,_){var w,S,L,P,D,U,F;P=_||{},b.length=0;for(D in x)b.push(D);if(!T)return P;for(L in T)b.indexOf(L)===-1&&b.push(L);for(U=0;U<b.length;U++)D=b[U],w=x[D],S=T[D],F=w&&S&&w.constructor===Object&&S.constructor===Object,(F&&!E(w,S)||!F&&w!==S)&&(P[D]=S);return P}}(),m.exports.shouldCaptureKeyEvent=function(b){return b.metaKey?!1:document.activeElement===document.body},m.exports.splitString=function(b,x){typeof x>"u"&&(x=" ");var T=new RegExp(x,"g");return b=(b||"").replace(T,x),b.split(x)},m.exports.getElData=function(b,x){x=x||{};var T={};Object.keys(x).forEach(_);function _(w){b.hasAttribute(w)&&(T[w]=b.getAttribute(w))}return T},m.exports.getUrlParameter=function(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var x=new RegExp("[\\?&]"+b+"=([^&#]*)"),T=x.exec(location.search);return T===null?"":decodeURIComponent(T[1].replace(/\+/g," "))},m.exports.isIframed=function(){return window.top!==window.self},m.exports.findAllScenes=function(b){for(var x=[],T=b.getElementsByTagName("*"),_=0,w=T.length;_<w;_++)T[_].isScene&&x.push(T[_]);return x},m.exports.srcLoader=h("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/isIOSOlderThan10.js":m=>{m.exports=function(h){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(h)}},"./src/utils/material.js":(m,M,h)=>{var f=h("./src/lib/three.js"),C=h("./src/utils/src-loader.js"),p=h("./src/utils/debug.js"),g=p("utils:material:warn"),u=new Set(["emissiveMap","envMap","map","specularMap"]);function E(w,S){var L=S.offset||{x:0,y:0},P=S.repeat||{x:1,y:1},D=S.npot||!1,U=S.anisotropy||f.Texture.DEFAULT_ANISOTROPY,F=w.wrapS,j=w.wrapT,Y=w.magFilter,oe=w.minFilter;D&&(F=f.ClampToEdgeWrapping,j=f.ClampToEdgeWrapping,Y=f.LinearFilter,oe=f.LinearFilter),(P.x!==1||P.y!==1)&&(F=f.RepeatWrapping,j=f.RepeatWrapping),w.offset.set(L.x,L.y),w.repeat.set(P.x,P.y),(w.wrapS!==F||w.wrapT!==j||w.magFilter!==Y||w.minFilter!==oe||w.anisotropy!==U)&&(w.wrapS=F,w.wrapT=j,w.magFilter=Y,w.minFilter=oe,w.anisotropy=U,w.needsUpdate=!0)}m.exports.setTextureProperties=E,m.exports.updateMapMaterialFromData=function(w,S,L,P){var D=L.el,U=L.material,F=D.sceneEl.systems.renderer,j=P[S];if(L.materialSrcs||(L.materialSrcs={}),!j){delete L.materialSrcs[w],oe(null);return}if(j===L.materialSrcs[w]&&U[w]){E(U[w],P);return}L.materialSrcs[w]=j,j instanceof f.Texture?oe(j):D.sceneEl.systems.material.loadTextureSource(j,Y);function Y(te){if(L.materialSrcs[w]===j){var pe=U[w];pe&&(te===null||!T(pe,te))&&(pe=null),!pe&&te&&(pe=_(te)),pe&&(pe.source!==te&&(pe.source=te,pe.needsUpdate=!0),u.has(w)&&F.applyColorCorrection(pe),E(pe,P)),oe(pe)}}function oe(te){U[w]!==te&&(U[w]&&U[w].dispose(),U[w]=te,U.needsUpdate=!0,x(D,te))}},m.exports.updateMap=function(w,S){return m.exports.updateMapMaterialFromData("map","src",w,S)},m.exports.updateDistortionMap=function(w,S,L){var P=w;w==="ambientOcclusion"&&(P="ao");var D={};return D.src=L[w+"Map"],D.offset=L[w+"TextureOffset"],D.repeat=L[w+"TextureRepeat"],D.wrap=L[w+"TextureWrap"],m.exports.updateMapMaterialFromData(P+"Map","src",S,D)};var b={};m.exports.updateEnvMap=function(w,S){var L=w.material,P=w.el,D="envMap",U=S.envMap,F=S.sphericalEnvMap,j=S.refract;if(F&&(U=F,g("`sphericalEnvMap` property is deprecated, using spherical map as equirectangular map instead. Use `envMap` property with a CubeMap or Equirectangular image instead.")),w.materialSrcs||(w.materialSrcs={}),!U){delete w.materialSrcs[D],L.envMap=null,L.needsUpdate=!0;return}if(w.materialSrcs[D]=U,b[U]){b[U].then(Y);return}b[U]=new Promise(function(oe){C.validateEnvMapSrc(U,function(pe){P.sceneEl.systems.material.loadCubeMapTexture(pe,function(de){de.mapping=j?f.CubeRefractionMapping:f.CubeReflectionMapping,Y(de),oe(de)})},function(pe){P.sceneEl.systems.material.loadTexture(pe,{src:pe},function(de){de.mapping=j?f.EquirectangularRefractionMapping:f.EquirectangularReflectionMapping,Y(de),oe(de)})})});function Y(oe){w.materialSrcs[D]===U&&(L.envMap=oe,L.needsUpdate=!0,x(P,oe))}};function x(w,S){if(!S||(w.emit("materialtextureloaded",{src:S.image,texture:S}),!S.image||S.image.tagName!=="VIDEO"))return;S.image.addEventListener("loadeddata",L),S.image.addEventListener("ended",P);function L(){w.emit("materialvideoloadeddata",{src:S.image,texture:S})}function P(){w.emit("materialvideoended",{src:S.image,texture:S})}S.addEventListener("dispose",function(){S.image.removeEventListener("loadeddata",L),S.image.removeEventListener("ended",P)})}m.exports.handleTextureEvents=x;function T(w,S){return S.data instanceof HTMLCanvasElement?w.isCanvasTexture:S.data instanceof HTMLVideoElement?w.isVideoTexture&&w.source===S:w.isTexture&&!w.isCanvasTexture&&!w.isVideoTexture}m.exports.isCompatibleTexture=T;function _(w){var S;return w.data instanceof HTMLCanvasElement?S=new f.CanvasTexture:w.data instanceof HTMLVideoElement?S=new f.VideoTexture(w.data):S=new f.Texture,S.source=w,S.needsUpdate=!0,S}m.exports.createCompatibleTexture=_},"./src/utils/math.js":m=>{function M(f,C,p){var g=C.dot(f);return(g-C.dot(p))/C.length()}function h(f,C,p,g){var u=M(f,C,p);return g.copy(C),g.multiplyScalar(u),g.add(p),g}m.exports.distanceOfPointFromPlane=M,m.exports.nearestPointInPlane=h},"./src/utils/object-pool.js":m=>{var M=Object.freeze(Object.create(null));function h(){return{}}m.exports.createPool=function(g){var u=[],E=null;g=g||h;function b(){var w;return(E===null||E===u.length)&&T(u.length||5),w=u[E],u[E++]=M,f(w),w}function x(w){if(w instanceof Object){if(E===null||E===-1){u[u.length]=w;return}u[--E]=w}}function T(w){var S,L;if(w=w===void 0?u.length:w,w>0&&E==null&&(E=0),w>0)for(S=u.length,u.length+=Number(w),L=S;L<u.length;L++)u[L]=g();return u.length}function _(){return u.length}return{grow:T,pool:u,recycle:x,size:_,use:b}};function f(p){var g;if(!(!p||p.constructor!==Object))for(g in p)p[g]=void 0}m.exports.clearObject=f;function C(p,g){var u;if(!(!p||p.constructor!==Object))for(u in p)u in g||delete p[u]}m.exports.removeUnusedKeys=C},"./src/utils/split.js":m=>{m.exports.split=function(){var M={};return function(h,f){return f in M||(M[f]={}),h in M[f]||(M[f][h]=h.split(f)),M[f][h]}}()},"./src/utils/src-loader.js":(m,M,h)=>{var f=h("./src/utils/debug.js"),C=f("utils:src-loader:warn");function p(_,w,S){b(_,function(P){if(P){w(_);return}S(_)})}function g(_,w,S){var L,P="",D,U,F=[];if(typeof _=="string"){let Y=function(oe){F.push(oe),F.length===6&&w(F)};for(D=0;D<5;D++)P+="(url\\((?:[^\\)]+)\\),\\s*)";if(P+="(url\\((?:[^\\)]+)\\)\\s*)",U=_.match(new RegExp(P)),U){for(D=1;D<7;D++)p(E(U[D]),Y);return}if(!_.startsWith("#")){var j=E(_);p(j||_,S);return}}if(_.tagName?L=_:L=T(_),!!L){if(L.tagName==="A-CUBEMAP"&&L.srcs)return w(L.srcs);if(L.tagName==="IMG")return S(L);C('Selector "%s" does not point to <a-cubemap> or <img>',_)}}function u(_,w){return g(_,w,function(){C("Expected cubemap but got image")})}function E(_){var w=_.match(/url\((.+)\)/);if(w)return w[1]}function b(_,w){var S;if(_.tagName){w(_.tagName==="IMG");return}S=new XMLHttpRequest,S.open("HEAD",_),S.addEventListener("load",function(L){var P;S.status>=200&&S.status<300?(P=S.getResponseHeader("Content-Type"),P==null?x(_,w):P.startsWith("image")?w(!0):w(!1)):x(_,w),S.abort()}),S.send()}function x(_,w){var S=new Image;S.addEventListener("load",L);function L(){w(!0)}S.addEventListener("error",P);function P(){w(!1)}S.src=_}function T(_){try{var w=document.querySelector(_);return w||C('No element was found matching the selector: "%s"',_),w}catch{C('"%s" is not a valid selector',_);return}}m.exports={parseUrl:E,validateSrc:p,validateCubemapSrc:u,validateEnvMapSrc:g}},"./src/utils/styleParser.js":m=>{var M=/-([a-z])/g;m.exports.parse=function(u,E){var b;return typeof u!="string"||(b=C(u,E),b[""])?u:b},m.exports.stringify=function(u){return typeof u=="string"?u:p(u)};function h(u){return u.replace(M,g)}m.exports.toCamelCase=h;var f=function(){var u=[],E=/url\([^)]+$/;return function(x){var T="",_,w=0,S=";";for(u.length=0;w<x.length;){if(_=x.indexOf(S,w),_===-1&&(_=x.length),T+=x.substring(w,_),E.test(T)){T+=";",w=_+1;continue}u.push(T.trim()),T="",w=_+1}return u}}();function C(u,E){var b,x,T,_,w,S;for(E=E||{},b=f(u),x=0;x<b.length;x++)T=b[x],T&&(_=T.indexOf(":"),w=T.substr(0,_).trim(),S=T.substr(_+1).trim(),E[h(w)]=S);return E}function p(u){var E,b=0,x=0,T="";for(E in u)b++;for(E in u)T+=E+": "+u[E],x<b-1&&(T+="; "),x++;return T}function g(u){return u[1].toUpperCase()}},"./src/utils/tracked-controls.js":(m,M,h)=>{var f=h("./src/constants/index.js").DEFAULT_HANDEDNESS,C=["x","y","z","w"],p=2;m.exports.checkControllerPresentAndSetup=function(x,T,_){var w=x.el,S,L=w.sceneEl.hasWebXR,P=L?u:g,D;if(S=P(x,T,_),D=!!S,x.controllerPresent&&!x.controllerEventsActive&&!L&&x.addEventListeners(),D===x.controllerPresent)return D;x.controllerPresent=D,D?(x.addEventListeners(),x.injectTrackedControls(S),w.emit("controllerconnected",{name:x.name,component:x})):(x.removeEventListeners(),w.emit("controllerdisconnected",{name:x.name,component:x}))};function g(x,T,_){var w,S=x.el.sceneEl,L,P=_.index||0;return!T||(L=S&&S.systems["tracked-controls-webvr"],!L)||(w=L.controllers,!w.length)?!1:!!E(w,null,T,_.hand,P)}function u(x,T,_){var w,S=x.el.sceneEl,L=S&&S.systems["tracked-controls-webxr"];return!L||(w=L.controllers,!w||!w.length)?!1:b(w,T,_.hand,_.index,_.iterateControllerProfiles,_.handTracking)}m.exports.isControllerPresentWebVR=g,m.exports.isControllerPresentWebXR=u;function E(x,T,_,w,S){var L,P,D=0,U=S>=0?S:0;for(P=0;P<x.length;P++)if(L=x[P],!(_&&!L.id.startsWith(_))&&!(!_&&L.id!==T)&&!(w&&L.hand&&w!==L.hand)){if(w&&!L.hand)U=p*S+(w===f?0:1);else return L;if(D===U)return L;++D}}function b(x,T,_,w,S,L){var P,D,U,F=!1,j,Y;for(P=0;P<x.length;P++){if(U=x[P],Y=U.profiles,L)F=U.hand;else if(S)for(D=0;D<Y.length&&(F=Y[D].startsWith(T),!F);D++);else F=Y.length>0&&Y[0].startsWith(T);if(F){if(j=U.handedness==="right"||U.handedness==="left",j){if(U.handedness===_)return x[P]}else if(P===w)return x[P]}}}m.exports.findMatchingControllerWebVR=E,m.exports.findMatchingControllerWebXR=b,m.exports.emitIfAxesChanged=function(x,T,_){var w,S,L,P,D;for(S in T){for(w=T[S],L=!1,D=0;D<w.length;D++)_.detail.changed[w[D]]&&(L=!0);if(L){for(P={},D=0;D<w.length;D++)P[C[D]]=_.detail.axis[w[D]];x.el.emit(S+"moved",P)}}},m.exports.onButtonEvent=function(x,T,_,w){var S=w?_.mapping[w]:_.mapping,L=S.buttons[x];_.el.emit(L+T),_.updateModel&&_.updateModel(L,T)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(m){var M=this;this.object=m,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var h=function(p){M.deviceOrientation=p},f=function(){M.screenOrientation=window.orientation||0},C=function(){var p=new THREE.Vector3(0,0,1),g=new THREE.Euler,u=new THREE.Quaternion,E=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(b,x,T,_,w){g.set(T,x,-_,"YXZ"),b.setFromEuler(g),b.multiply(E),b.multiply(u.setFromAxisAngle(p,-w))}}();this.connect=function(){f(),window.addEventListener("orientationchange",f,!1),window.addEventListener("deviceorientation",h,!1),M.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",f,!1),window.removeEventListener("deviceorientation",h,!1),M.enabled=!1},this.update=function(){if(M.enabled!==!1){var p=M.deviceOrientation;if(p){var g=p.alpha?THREE.MathUtils.degToRad(p.alpha)+M.alphaOffset:0,u=p.beta?THREE.MathUtils.degToRad(p.beta):0,E=p.gamma?THREE.MathUtils.degToRad(p.gamma):0,b=M.screenOrientation?THREE.MathUtils.degToRad(M.screenOrientation):0;C(M.object.quaternion,g,u,E,b)}}},this.dispose=function(){M.disconnect()},this.connect()}},"./vendor/rStats.extras.js":m=>{window.glStats=function(){var M=null,h=0,f=0,C=0,p=0,g=0,u=0,E=0;function b(D,U){return function(){U.apply(this,arguments),D.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=b(WebGLRenderingContext.prototype.drawArrays,function(){h++,arguments[0]==this.POINTS?u+=arguments[2]:g+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=b(WebGLRenderingContext.prototype.drawElements,function(){f++,p+=arguments[1]/3,g+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=b(WebGLRenderingContext.prototype.useProgram,function(){C++}),WebGLRenderingContext.prototype.bindTexture=b(WebGLRenderingContext.prototype.bindTexture,function(){E++});var x={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},T=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],_=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function w(){M("allcalls").set(h+f),M("drawElements").set(f),M("drawArrays").set(h),M("bindTexture").set(E),M("useProgram").set(C),M("glfaces").set(p),M("glvertices").set(g),M("glpoints").set(u)}function S(){h=0,f=0,C=0,p=0,g=0,u=0,E=0}function L(){}function P(D){M=D}return{update:w,start:S,end:L,attach:P,values:x,groups:T,fractions:_}},window.threeStats=function(M){var h=null,f={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},C=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],p=[];function g(){h("renderer.info.memory.geometries").set(M.info.memory.geometries),h("renderer.info.programs").set(M.info.programs.length),h("renderer.info.memory.textures").set(M.info.memory.textures),h("renderer.info.render.calls").set(M.info.render.calls),h("renderer.info.render.triangles").set(M.info.render.triangles),h("renderer.info.render.points").set(M.info.render.points)}function u(){}function E(){}function b(x){h=x}return{update:g,start:u,end:E,attach:b,values:f,groups:C,fractions:p}},window.BrowserStats=function(){var M=null,h=0,f=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var C={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},p=[{caption:"Browser",values:["memory","total"]}],g=[{base:"total",steps:["memory"]}],u=Math.log(1024);function E(w){var S=100,L=Math.floor(Math.log(w)/u);return Math.round(w*S/Math.pow(1024,L))/S}function b(){h=E(performance.memory.usedJSHeapSize),f=E(performance.memory.totalJSHeapSize),M("memory").set(h),M("total").set(f)}function x(){h=0}function T(){}function _(w){M=w}return{update:b,start:x,end:T,attach:_,values:C,groups:p,fractions:g}},m.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":m=>{(function(){"performance"in window||(window.performance={});var M=window.performance;if(!("now"in M)){var h=Date.now();M.timing&&M.timing.navigationStart&&(h=M.timing.navigationStart),M.now=function(){return Date.now()-h}}M.mark||(M.mark=function(){}),M.measure||(M.measure=function(){})})(),window.rStats=function(h){function f(Y,oe){for(var te=Object.keys(Y),pe=0,de=te.length;pe<de;pe++)oe(te[pe])}function C(Y){var oe=document.createElement("link");oe.href=Y,oe.rel="stylesheet",oe.type="text/css",document.getElementsByTagName("head")[0].appendChild(oe)}var p=h||{},g=p.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],u="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",E=(p.CSSPath?p.CSSPath:"")+"rStats.css",b=p.css||[u,E];b.forEach(function(Y){C(Y)}),p.values||(p.values={});var x,T,_=10,w=200,S={};function L(Y,oe,te){var pe=te||{},de=document.createElement("canvas"),se=de.getContext("2d"),J=0,H=0,ae=pe.color?pe.color:"#666666",ue=document.createElement("canvas"),Me=ue.getContext("2d");ue.width=1,ue.height=2*_,Me.fillStyle="#444444",Me.fillRect(0,0,1,2*_),Me.fillStyle=ae,Me.fillRect(0,_,1,_),Me.fillStyle="#ffffff",Me.globalAlpha=.5,Me.fillRect(0,_,1,1),Me.globalAlpha=1;var De=document.createElement("canvas"),Ge=De.getContext("2d");De.width=1,De.height=2*_,Ge.fillStyle="#444444",Ge.fillRect(0,0,1,2*_),Ge.fillStyle="#b70000",Ge.fillRect(0,_,1,_),Ge.globalAlpha=.5,Ge.fillStyle="#ffffff",Ge.fillRect(0,_,1,1),Ge.globalAlpha=1;function Xe(){de.width=w,de.height=_,de.style.width=de.width+"px",de.style.height=de.height+"px",de.className="rs-canvas",Y.appendChild(de),se.fillStyle="#444444",se.fillRect(0,0,de.width,de.height)}function Je(pt,yt){H+=(pt-H)*.1,J*=.99,H>J&&(J=H),se.drawImage(de,1,0,de.width-1,de.height,0,0,de.width-1,de.height),yt?se.drawImage(De,de.width-1,de.height-H*de.height/J-_):se.drawImage(ue,de.width-1,de.height-H*de.height/J-_)}return Xe(),{draw:Je}}function P(Y,oe){var te=document.createElement("canvas"),pe=te.getContext("2d");function de(){te.width=w,te.height=_*oe,te.style.width=te.width+"px",te.style.height=te.height+"px",te.className="rs-canvas",Y.appendChild(te),pe.fillStyle="#444444",pe.fillRect(0,0,te.width,te.height)}function se(J){pe.drawImage(te,1,0,te.width-1,te.height,0,0,te.width-1,te.height);var H=0;f(J,function(ae){var ue=J[ae]*te.height;pe.fillStyle=g[ae],pe.fillRect(te.width-1,H,1,ue),H+=ue})}return de(),{draw:se}}function D(Y,oe){var te=Y,pe,de=0,se=0,J=0,H=0,ae=performance.now(),ue=0,Me=document.createElement("div"),De=document.createElement("span"),Ge=document.createElement("div"),Xe=document.createTextNode(""),Je=p?p.values[te.toLowerCase()]:null,pt=new L(Me,te,Je),yt=!1;De.className="rs-counter-id",De.textContent=Je&&Je.caption?Je.caption:te,Ge.className="rs-counter-value",Ge.appendChild(Xe),Me.appendChild(De),Me.appendChild(Ge),oe?oe.div.appendChild(Me):T.appendChild(Me),pe=performance.now();function Gt(Oi){if(Je&&Je.average){H+=Oi,ue++;var yi=performance.now();yi-ae>=(Je.avgMs||1e3)&&(J=H/ue,H=0,ae=yi,ue=0)}}function Et(){pe=performance.now(),p.userTimingAPI&&performance.mark(te+"-start"),yt=!0}function Vt(){de=performance.now()-pe,p.userTimingAPI&&(performance.mark(te+"-end"),yt&&performance.measure(te,te+"-start",te+"-end")),Gt(de)}function Yt(){Vt(),Et()}function gi(){var Oi=Je&&Je.average?J:de;Xe.nodeValue=Math.round(Oi*100)/100;var yi=Je&&(Je.below&&de<Je.below||Je.over&&de>Je.over);pt.draw(de,yi),Me.className=yi?"rs-counter-base alarm":"rs-counter-base"}function Ri(){var Oi=performance.now(),yi=Oi-pe;se++,yi>1e3&&(Je&&Je.interpolate===!1?de=se:de=se*1e3/yi,se=0,pe=Oi,Gt(de))}function Ni(Oi){de=Oi,Gt(de)}return{set:Ni,start:Et,tick:Yt,end:Vt,frame:Ri,value:function(){return de},draw:gi}}function U(Y){var oe=Y.toLowerCase();if(oe===void 0&&(oe="default"),S[oe])return S[oe];var te=null;p&&p.groups&&f(p.groups,function(de){var se=p.groups[parseInt(de,10)];!te&&se.values.indexOf(oe.toLowerCase())!==-1&&(te=se)});var pe=new D(oe,te);return S[oe]=pe,pe}function F(){if(p.plugins){p.values||(p.values={}),p.groups||(p.groups=[]),p.fractions||(p.fractions=[]);for(var Y=0;Y<p.plugins.length;Y++)p.plugins[Y].attach(U),f(p.plugins[Y].values,function(oe){p.values[oe]=p.plugins[Y].values[oe]}),p.groups=p.groups.concat(p.plugins[Y].groups),p.fractions=p.fractions.concat(p.plugins[Y].fractions)}else p.plugins={};x=document.createElement("div"),x.className="rs-base",T=document.createElement("div"),T.className="rs-container",T.style.height="auto",x.appendChild(T),document.body.appendChild(x),p&&(p.groups&&f(p.groups,function(oe){var te=p.groups[parseInt(oe,10)],pe=document.createElement("div");pe.className="rs-group",te.div=pe;var de=document.createElement("h1");de.textContent=te.caption,de.addEventListener("click",(function(se){this.classList.toggle("hidden"),se.preventDefault()}).bind(pe)),T.appendChild(de),T.appendChild(pe)}),p.fractions&&f(p.fractions,function(oe){var te=p.fractions[parseInt(oe,10)],pe=document.createElement("div");pe.className="rs-fraction";var de=document.createElement("div");de.className="rs-legend";var se=0;f(p.fractions[oe].steps,function(H){var ae=document.createElement("p");ae.textContent=p.fractions[oe].steps[H],ae.style.color=g[se],de.appendChild(ae),se++}),pe.appendChild(de),pe.style.height=se*_+"px",te.div=pe;var J=new P(pe,se);te.graph=J,T.appendChild(pe)}))}function j(){f(p.plugins,function(Y){p.plugins[Y].update()}),f(S,function(Y){S[Y].draw()}),p&&p.fractions&&f(p.fractions,function(Y){var oe=p.fractions[parseInt(Y,10)],te=[],pe=S[oe.base.toLowerCase()];pe&&(pe=pe.value(),f(p.fractions[Y].steps,function(de){var se=p.fractions[Y].steps[parseInt(de,10)].toLowerCase(),J=S[se];J&&te.push(J.value()/pe)})),oe.graph.draw(te)})}return F(),function(Y){return Y?U(Y):{element:x,update:j}}},m.exports=window.rStats},"./vendor/wakelock/util.js":m=>{var M={};M.base64=function(h,f){return"data:"+h+";base64,"+f},M.isMobile=function(){var h=!1;return function(f){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(f)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(f.substr(0,4)))&&(h=!0)}(navigator.userAgent||navigator.vendor||window.opera),h},M.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},M.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},M.appendQueryParameter=function(h,f,C){var p=h.indexOf("?")<0?"?":"&";return h+=p+f+"="+C,h},M.getQueryParameter=function(h){h=h.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var f=new RegExp("[\\?&]"+h+"=([^&#]*)"),C=f.exec(location.search);return C===null?"":decodeURIComponent(C[1].replace(/\+/g," "))},M.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},m.exports=M},"./vendor/wakelock/wakelock.js":(m,M,h)=>{var f=h("./vendor/wakelock/util.js");function C(){var u=document.createElement("video");u.addEventListener("ended",function(){u.play()}),this.request=function(){u.paused&&(u.src=f.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),u.play())},this.release=function(){u.pause(),u.src=""}}function p(){var u=null;this.request=function(){u||(u=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){u&&(clearInterval(u),u=null)}}function g(){var u=navigator.userAgent||navigator.vendor||window.opera;return u.match(/iPhone/i)||u.match(/iPod/i)?p:C}m.exports=g()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(m,M,h)=>{h.r(M),h.d(M,{default:()=>j});var f=h("./node_modules/css-loader/dist/runtime/sourceMaps.js"),C=h.n(f),p=h("./node_modules/css-loader/dist/runtime/api.js"),g=h.n(p),u=h("./node_modules/css-loader/dist/runtime/getUrl.js"),E=h.n(u),b=new URL(h("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),h.b),x=new URL(h("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),h.b),T=new URL(h("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),h.b),_=new URL(h("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),h.b),w=new URL(h("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),h.b),S=g()(C()),L=E()(b),P=E()(x),D=E()(T),U=E()(_),F=E()(w);S.push([m.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(`+L+`) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(`+P+`) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(`+D+`);
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(`+U+`) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(`+F+`) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);const j=S},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(m,M,h)=>{h.r(M),h.d(M,{default:()=>E});var f=h("./node_modules/css-loader/dist/runtime/sourceMaps.js"),C=h.n(f),p=h("./node_modules/css-loader/dist/runtime/api.js"),g=h.n(p),u=g()(C());u.push([m.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);const E=u},"./src/style/aframe.css":(m,M,h)=>{h.r(M),h.d(M,{default:()=>D});var f=h("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),C=h.n(f),p=h("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),g=h.n(p),u=h("./node_modules/style-loader/dist/runtime/insertBySelector.js"),E=h.n(u),b=h("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),x=h.n(b),T=h("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),_=h.n(T),w=h("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),S=h.n(w),L=h("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),P={};P.styleTagTransform=S(),P.setAttributes=x(),P.insert=E().bind(null,"head"),P.domAPI=g(),P.insertStyleElement=_(),C()(L.default,P);const D=L.default&&L.default.locals?L.default.locals:void 0},"./src/style/rStats.css":(m,M,h)=>{h.r(M),h.d(M,{default:()=>D});var f=h("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),C=h.n(f),p=h("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),g=h.n(p),u=h("./node_modules/style-loader/dist/runtime/insertBySelector.js"),E=h.n(u),b=h("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),x=h.n(b),T=h("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),_=h.n(T),w=h("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),S=h.n(w),L=h("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),P={};P.styleTagTransform=S(),P.setAttributes=x(),P.insert=E().bind(null,"head"),P.domAPI=g(),P.insertStyleElement=_(),C()(L.default,P);const D=L.default&&L.default.locals?L.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":m=>{var M=[];function h(p){for(var g=-1,u=0;u<M.length;u++)if(M[u].identifier===p){g=u;break}return g}function f(p,g){for(var u={},E=[],b=0;b<p.length;b++){var x=p[b],T=g.base?x[0]+g.base:x[0],_=u[T]||0,w="".concat(T," ").concat(_);u[T]=_+1;var S=h(w),L={css:x[1],media:x[2],sourceMap:x[3],supports:x[4],layer:x[5]};if(S!==-1)M[S].references++,M[S].updater(L);else{var P=C(L,g);g.byIndex=b,M.splice(b,0,{identifier:w,updater:P,references:1})}E.push(w)}return E}function C(p,g){var u=g.domAPI(g);u.update(p);var E=function(x){if(x){if(x.css===p.css&&x.media===p.media&&x.sourceMap===p.sourceMap&&x.supports===p.supports&&x.layer===p.layer)return;u.update(p=x)}else u.remove()};return E}m.exports=function(p,g){g=g||{},p=p||[];var u=f(p,g);return function(b){b=b||[];for(var x=0;x<u.length;x++){var T=u[x],_=h(T);M[_].references--}for(var w=f(b,g),S=0;S<u.length;S++){var L=u[S],P=h(L);M[P].references===0&&(M[P].updater(),M.splice(P,1))}u=w}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":m=>{var M={};function h(C){if(typeof M[C]>"u"){var p=document.querySelector(C);if(window.HTMLIFrameElement&&p instanceof window.HTMLIFrameElement)try{p=p.contentDocument.head}catch{p=null}M[C]=p}return M[C]}function f(C,p){var g=h(C);if(!g)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");g.appendChild(p)}m.exports=f},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":m=>{function M(h){var f=document.createElement("style");return h.setAttributes(f,h.attributes),h.insert(f,h.options),f}m.exports=M},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(m,M,h)=>{function f(C){var p=h.nc;p&&C.setAttribute("nonce",p)}m.exports=f},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":m=>{function M(C,p,g){var u="";g.supports&&(u+="@supports (".concat(g.supports,") {")),g.media&&(u+="@media ".concat(g.media," {"));var E=typeof g.layer<"u";E&&(u+="@layer".concat(g.layer.length>0?" ".concat(g.layer):""," {")),u+=g.css,E&&(u+="}"),g.media&&(u+="}"),g.supports&&(u+="}");var b=g.sourceMap;b&&typeof btoa<"u"&&(u+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(b))))," */")),p.styleTagTransform(u,C,p.options)}function h(C){if(C.parentNode===null)return!1;C.parentNode.removeChild(C)}function f(C){if(typeof document>"u")return{update:function(){},remove:function(){}};var p=C.insertStyleElement(C);return{update:function(u){M(p,C,u)},remove:function(){h(p)}}}m.exports=f},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":m=>{function M(h,f){if(f.styleSheet)f.styleSheet.cssText=h;else{for(;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(document.createTextNode(h))}}m.exports=M},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":m=>{m.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":m=>{m.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":m=>{m.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":m=>{m.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":m=>{m.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/three/build/three.module.js":(m,M,h)=>{h.r(M),h.d(M,{ACESFilmicToneMapping:()=>St,AddEquation:()=>te,AddOperation:()=>Kn,AdditiveAnimationBlendMode:()=>os,AdditiveBlending:()=>F,AgXToneMapping:()=>ve,AlphaFormat:()=>Fs,AlwaysCompare:()=>yh,AlwaysDepth:()=>Ni,AlwaysStencilFunc:()=>lc,AmbientLight:()=>qg,AnimationAction:()=>d0,AnimationClip:()=>Vc,AnimationLoader:()=>Lb,AnimationMixer:()=>a2,AnimationObjectGroup:()=>s2,AnimationUtils:()=>Tb,ArcCurve:()=>dg,ArrayCamera:()=>jf,ArrowHelper:()=>I2,AttachedBindMode:()=>Se,Audio:()=>c0,AudioAnalyser:()=>Yb,AudioContext:()=>Mp,AudioListener:()=>Wb,AudioLoader:()=>Qb,AxesHelper:()=>B2,BackSide:()=>L,BasicDepthPacking:()=>ao,BasicShadowMap:()=>x,BatchedMesh:()=>ng,Bone:()=>Jf,BooleanKeyframeTrack:()=>ka,Box2:()=>A2,Box3:()=>hr,Box3Helper:()=>S2,BoxGeometry:()=>_a,BoxHelper:()=>_2,BufferAttribute:()=>zn,BufferGeometry:()=>on,BufferGeometryLoader:()=>t0,ByteType:()=>ms,Cache:()=>To,Camera:()=>zh,CameraHelper:()=>M2,CanvasTexture:()=>ZC,CapsuleGeometry:()=>gu,CatmullRomCurve3:()=>fg,CineonToneMapping:()=>Tn,CircleGeometry:()=>vu,ClampToEdgeWrapping:()=>We,Clock:()=>o0,Color:()=>li,ColorKeyframeTrack:()=>yp,ColorManagement:()=>Fn,CompressedArrayTexture:()=>qC,CompressedCubeTexture:()=>JC,CompressedTexture:()=>fu,CompressedTextureLoader:()=>Db,ConeGeometry:()=>yu,ConstantAlphaFactor:()=>Yt,ConstantColorFactor:()=>Et,CubeCamera:()=>sm,CubeReflectionMapping:()=>$,CubeRefractionMapping:()=>N,CubeTexture:()=>yc,CubeTextureLoader:()=>Pb,CubeUVReflectionMapping:()=>be,CubicBezierCurve:()=>ap,CubicBezierCurve3:()=>Ag,CubicInterpolant:()=>Ug,CullFaceBack:()=>u,CullFaceFront:()=>E,CullFaceFrontBack:()=>b,CullFaceNone:()=>g,Curve:()=>qs,CurvePath:()=>gg,CustomBlending:()=>oe,CustomToneMapping:()=>ye,CylinderGeometry:()=>Ll,Cylindrical:()=>p2,Data3DTexture:()=>Wi,DataArrayTexture:()=>sl,DataTexture:()=>Zo,DataTextureLoader:()=>Ob,DataUtils:()=>My,DecrementStencilOp:()=>Od,DecrementWrapStencilOp:()=>Nd,DefaultLoadingManager:()=>zg,DepthFormat:()=>nt,DepthStencilFormat:()=>At,DepthTexture:()=>Gf,DetachedBindMode:()=>Re,DirectionalLight:()=>Yg,DirectionalLightHelper:()=>w2,DiscreteInterpolant:()=>Gg,DisplayP3ColorSpace:()=>tl,DodecahedronGeometry:()=>Eu,DoubleSide:()=>P,DstAlphaFactor:()=>Xe,DstColorFactor:()=>pt,DynamicCopyUsage:()=>Zd,DynamicDrawUsage:()=>Wd,DynamicReadUsage:()=>Yd,EdgesGeometry:()=>vg,EllipseCurve:()=>pu,EqualCompare:()=>Ah,EqualDepth:()=>zi,EqualStencilFunc:()=>Vd,EquirectangularReflectionMapping:()=>V,EquirectangularRefractionMapping:()=>fe,Euler:()=>Is,EventDispatcher:()=>as,ExtrudeGeometry:()=>Su,FileLoader:()=>Bo,Float16BufferAttribute:()=>Ry,Float32BufferAttribute:()=>xi,FloatType:()=>Yn,Fog:()=>qh,FogExp2:()=>Yh,FramebufferTexture:()=>YC,FrontSide:()=>S,Frustum:()=>Ec,GLBufferAttribute:()=>u2,GLSL1:()=>ef,GLSL3:()=>hc,GreaterCompare:()=>mh,GreaterDepth:()=>gn,GreaterEqualCompare:()=>vh,GreaterEqualDepth:()=>Cn,GreaterEqualStencilFunc:()=>jd,GreaterStencilFunc:()=>Qd,GridHelper:()=>C2,Group:()=>Ra,HalfFloatType:()=>Bn,HemisphereLight:()=>Qg,HemisphereLightHelper:()=>x2,IcosahedronGeometry:()=>Tu,ImageBitmapLoader:()=>zb,ImageLoader:()=>zc,ImageUtils:()=>jo,IncrementStencilOp:()=>Pd,IncrementWrapStencilOp:()=>Fd,InstancedBufferAttribute:()=>Il,InstancedBufferGeometry:()=>e0,InstancedInterleavedBuffer:()=>h2,InstancedMesh:()=>eg,Int16BufferAttribute:()=>Iy,Int32BufferAttribute:()=>By,Int8BufferAttribute:()=>_y,IntType:()=>gs,InterleavedBuffer:()=>Jh,InterleavedBufferAttribute:()=>Da,Interpolant:()=>kc,InterpolateDiscrete:()=>Ti,InterpolateLinear:()=>Pi,InterpolateSmooth:()=>Hi,InvertStencilOp:()=>kd,KeepStencilOp:()=>yo,KeyframeTrack:()=>Js,LOD:()=>Hm,LatheGeometry:()=>Lc,Layers:()=>Bh,LessCompare:()=>ph,LessDepth:()=>Oi,LessEqualCompare:()=>cc,LessEqualDepth:()=>yi,LessEqualStencilFunc:()=>zd,LessStencilFunc:()=>Gd,Light:()=>ia,LightProbe:()=>$g,Line:()=>ea,Line3:()=>m2,LineBasicMaterial:()=>ds,LineCurve:()=>lp,LineCurve3:()=>mg,LineDashedMaterial:()=>Fg,LineLoop:()=>lg,LineSegments:()=>fo,LinearDisplayP3ColorSpace:()=>ga,LinearFilter:()=>wi,LinearInterpolant:()=>vp,LinearMipMapLinearFilter:()=>Yr,LinearMipMapNearestFilter:()=>mn,LinearMipmapLinearFilter:()=>In,LinearMipmapNearestFilter:()=>Xn,LinearSRGBColorSpace:()=>Ws,LinearToneMapping:()=>Cr,LinearTransfer:()=>va,Loader:()=>bs,LoaderUtils:()=>wp,LoadingManager:()=>Ep,LoopOnce:()=>Ei,LoopPingPong:()=>_i,LoopRepeat:()=>Xt,LuminanceAlphaFormat:()=>ht,LuminanceFormat:()=>Ye,MOUSE:()=>C,Material:()=>$r,MaterialLoader:()=>Ou,MathUtils:()=>vf,Matrix3:()=>ji,Matrix4:()=>mi,MaxEquation:()=>J,Mesh:()=>wr,MeshBasicMaterial:()=>Yo,MeshDepthMaterial:()=>Qf,MeshDistanceMaterial:()=>Hf,MeshLambertMaterial:()=>Pg,MeshMatcapMaterial:()=>Og,MeshNormalMaterial:()=>Dg,MeshPhongMaterial:()=>Rg,MeshPhysicalMaterial:()=>Bg,MeshStandardMaterial:()=>Ap,MeshToonMaterial:()=>Lg,MinEquation:()=>se,MirroredRepeatWrapping:()=>Rt,MixOperation:()=>cn,MultiplyBlending:()=>Y,MultiplyOperation:()=>bn,NearestFilter:()=>zt,NearestMipMapLinearFilter:()=>Jn,NearestMipMapNearestFilter:()=>Tt,NearestMipmapLinearFilter:()=>ti,NearestMipmapNearestFilter:()=>Lt,NeutralToneMapping:()=>Le,NeverCompare:()=>fh,NeverDepth:()=>Ri,NeverStencilFunc:()=>Ud,NoBlending:()=>D,NoColorSpace:()=>Hr,NoToneMapping:()=>wn,NormalAnimationBlendMode:()=>Di,NormalBlending:()=>U,NotEqualCompare:()=>gh,NotEqualDepth:()=>rr,NotEqualStencilFunc:()=>Hd,NumberKeyframeTrack:()=>Uc,Object3D:()=>Ln,ObjectLoader:()=>Gb,ObjectSpaceNormalMap:()=>co,OctahedronGeometry:()=>Fc,OneFactor:()=>ae,OneMinusConstantAlphaFactor:()=>gi,OneMinusConstantColorFactor:()=>Vt,OneMinusDstAlphaFactor:()=>Je,OneMinusDstColorFactor:()=>yt,OneMinusSrcAlphaFactor:()=>Ge,OneMinusSrcColorFactor:()=>Me,OrthographicCamera:()=>jh,P3Primaries:()=>Ea,PCFShadowMap:()=>T,PCFSoftShadowMap:()=>_,PMREMGenerator:()=>kf,Path:()=>Rc,PerspectiveCamera:()=>Rr,Plane:()=>Jo,PlaneGeometry:()=>xl,PlaneHelper:()=>T2,PointLight:()=>Xg,PointLightHelper:()=>y2,Points:()=>hg,PointsMaterial:()=>tp,PolarGridHelper:()=>b2,PolyhedronGeometry:()=>ta,PositionalAudio:()=>Xb,PropertyBinding:()=>Sn,PropertyMixer:()=>u0,QuadraticBezierCurve:()=>cp,QuadraticBezierCurve3:()=>hp,Quaternion:()=>Rn,QuaternionKeyframeTrack:()=>Pl,QuaternionLinearInterpolant:()=>Vg,RED_GREEN_RGTC2_Format:()=>di,RED_RGTC1_Format:()=>ft,REVISION:()=>f,RGBADepthPacking:()=>lo,RGBAFormat:()=>Ne,RGBAIntegerFormat:()=>pi,RGBA_ASTC_10x10_Format:()=>re,RGBA_ASTC_10x5_Format:()=>ie,RGBA_ASTC_10x6_Format:()=>ce,RGBA_ASTC_10x8_Format:()=>ne,RGBA_ASTC_12x10_Format:()=>ke,RGBA_ASTC_12x12_Format:()=>Ze,RGBA_ASTC_4x4_Format:()=>hn,RGBA_ASTC_5x4_Format:()=>W,RGBA_ASTC_5x5_Format:()=>Z,RGBA_ASTC_6x5_Format:()=>le,RGBA_ASTC_6x6_Format:()=>me,RGBA_ASTC_8x5_Format:()=>Ee,RGBA_ASTC_8x6_Format:()=>He,RGBA_ASTC_8x8_Format:()=>q,RGBA_BPTC_Format:()=>st,RGBA_ETC2_EAC_Format:()=>Zn,RGBA_PVRTC_2BPPV1_Format:()=>cr,RGBA_PVRTC_4BPPV1_Format:()=>Gn,RGBA_S3TC_DXT1_Format:()=>Li,RGBA_S3TC_DXT3_Format:()=>Mn,RGBA_S3TC_DXT5_Format:()=>Ki,RGBFormat:()=>we,RGB_BPTC_SIGNED_Format:()=>dt,RGB_BPTC_UNSIGNED_Format:()=>Ot,RGB_ETC1_Format:()=>Nt,RGB_ETC2_Format:()=>Xi,RGB_PVRTC_2BPPV1_Format:()=>sn,RGB_PVRTC_4BPPV1_Format:()=>ki,RGB_S3TC_DXT1_Format:()=>Ai,RGFormat:()=>qt,RGIntegerFormat:()=>mt,RawShaderMaterial:()=>Ig,Ray:()=>Br,Raycaster:()=>d2,Rec709Primaries:()=>ya,RectAreaLight:()=>Jg,RedFormat:()=>Bt,RedIntegerFormat:()=>oi,ReinhardToneMapping:()=>ar,RenderTarget:()=>rl,RepeatWrapping:()=>Fe,ReplaceStencilOp:()=>Dd,ReverseSubtractEquation:()=>de,RingGeometry:()=>Iu,SIGNED_RED_GREEN_RGTC2_Format:()=>ni,SIGNED_RED_RGTC1_Format:()=>_t,SRGBColorSpace:()=>yn,SRGBTransfer:()=>jn,Scene:()=>km,ShaderChunk:()=>tn,ShaderLib:()=>Ys,ShaderMaterial:()=>Xs,ShadowMaterial:()=>Tg,Shape:()=>Oa,ShapeGeometry:()=>Bu,ShapePath:()=>R2,ShapeUtils:()=>po,ShortType:()=>sr,Skeleton:()=>nu,SkeletonHelper:()=>v2,SkinnedMesh:()=>qm,Source:()=>tr,Sphere:()=>Ir,SphereGeometry:()=>Nc,Spherical:()=>f2,SphericalHarmonics3:()=>Zg,SplineCurve:()=>up,SpotLight:()=>Wg,SpotLightHelper:()=>g2,Sprite:()=>zm,SpriteMaterial:()=>Kf,SrcAlphaFactor:()=>De,SrcAlphaSaturateFactor:()=>Gt,SrcColorFactor:()=>ue,StaticCopyUsage:()=>Jd,StaticDrawUsage:()=>xa,StaticReadUsage:()=>Xd,StereoCamera:()=>Hb,StreamCopyUsage:()=>$d,StreamDrawUsage:()=>Kd,StreamReadUsage:()=>qd,StringKeyframeTrack:()=>Ua,SubtractEquation:()=>pe,SubtractiveBlending:()=>j,TOUCH:()=>p,TangentSpaceNormalMap:()=>qr,TetrahedronGeometry:()=>Ru,Texture:()=>qn,TextureLoader:()=>Fb,TorusGeometry:()=>Lu,TorusKnotGeometry:()=>Du,Triangle:()=>Bs,TriangleFanDrawMode:()=>vo,TriangleStripDrawMode:()=>js,TrianglesDrawMode:()=>vs,TubeGeometry:()=>Pu,UVMapping:()=>Pe,Uint16BufferAttribute:()=>Sf,Uint32BufferAttribute:()=>Tf,Uint8BufferAttribute:()=>Sy,Uint8ClampedBufferAttribute:()=>Ty,Uniform:()=>Tp,UniformsGroup:()=>c2,UniformsLib:()=>Jt,UniformsUtils:()=>im,UnsignedByteType:()=>Qn,UnsignedInt248Type:()=>ss,UnsignedInt5999Type:()=>oo,UnsignedIntType:()=>Tr,UnsignedShort4444Type:()=>lr,UnsignedShort5551Type:()=>Hs,UnsignedShortType:()=>Qr,VSMShadowMap:()=>w,Vector2:()=>xt,Vector3:()=>Ie,Vector4:()=>_n,VectorKeyframeTrack:()=>Gc,VideoTexture:()=>XC,WebGL3DRenderTarget:()=>vn,WebGLArrayRenderTarget:()=>ui,WebGLCoordinateSystem:()=>Ns,WebGLCubeRenderTarget:()=>om,WebGLMultipleRenderTargets:()=>L2,WebGLRenderTarget:()=>ys,WebGLRenderer:()=>UC,WebGLUtils:()=>Dm,WebGPUCoordinateSystem:()=>Ca,WireframeGeometry:()=>Mg,WrapAroundEnding:()=>Hn,ZeroCurvatureEnding:()=>Ji,ZeroFactor:()=>H,ZeroSlopeEnding:()=>Bi,ZeroStencilOp:()=>Ld,createCanvasElement:()=>Ch});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const f="164",C={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},p={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},g=0,u=1,E=2,b=3,x=0,T=1,_=2,w=3,S=0,L=1,P=2,D=0,U=1,F=2,j=3,Y=4,oe=5,te=100,pe=101,de=102,se=103,J=104,H=200,ae=201,ue=202,Me=203,De=204,Ge=205,Xe=206,Je=207,pt=208,yt=209,Gt=210,Et=211,Vt=212,Yt=213,gi=214,Ri=0,Ni=1,Oi=2,yi=3,zi=4,Cn=5,gn=6,rr=7,bn=0,cn=1,Kn=2,wn=0,Cr=1,ar=2,Tn=3,St=4,ye=5,ve=6,Le=7,Se="attached",Re="detached",Pe=300,$=301,N=302,V=303,fe=304,be=306,Fe=1e3,We=1001,Rt=1002,zt=1003,Lt=1004,Tt=1004,ti=1005,Jn=1005,wi=1006,Xn=1007,mn=1007,In=1008,Yr=1008,Qn=1009,ms=1010,sr=1011,Qr=1012,gs=1013,Tr=1014,Yn=1015,Bn=1016,lr=1017,Hs=1018,ss=1020,oo=35902,Fs=1021,we=1022,Ne=1023,Ye=1024,ht=1025,nt=1026,At=1027,Bt=1028,oi=1029,qt=1030,mt=1031,pi=1033,Ai=33776,Li=33777,Mn=33778,Ki=33779,ki=35840,sn=35841,Gn=35842,cr=35843,Nt=36196,Xi=37492,Zn=37496,hn=37808,W=37809,Z=37810,le=37811,me=37812,Ee=37813,He=37814,q=37815,ie=37816,ce=37817,ne=37818,re=37819,ke=37820,Ze=37821,st=36492,dt=36494,Ot=36495,ft=36283,_t=36284,di=36285,ni=36286,Ei=2200,Xt=2201,_i=2202,Ti=2300,Pi=2301,Hi=2302,Ji=2400,Bi=2401,Hn=2402,Di=2500,os=2501,vs=0,js=1,vo=2,ao=3200,lo=3201,qr=0,co=1,Hr="",yn="srgb",Ws="srgb-linear",tl="display-p3",ga="display-p3-linear",va="linear",jn="srgb",ya="rec709",Ea="p3",Ld=0,yo=7680,Dd=7681,Pd=7682,Od=7683,Fd=34055,Nd=34056,kd=5386,Ud=512,Gd=513,Vd=514,zd=515,Qd=516,Hd=517,jd=518,lc=519,fh=512,ph=513,Ah=514,cc=515,mh=516,gh=517,vh=518,yh=519,xa=35044,Wd=35048,Kd=35040,Xd=35045,Yd=35049,qd=35041,Jd=35046,Zd=35050,$d=35042,ef="100",hc="300 es",Ns=2e3,Ca=2001;class as{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(i)===-1&&n[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const a=s.indexOf(i);a!==-1&&s.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let a=0,d=s.length;a<d;a++)s[a].call(this,e);e.target=null}}}const Nr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Eh=1234567;const Eo=Math.PI/180,zo=180/Math.PI;function ls(){const l=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Nr[l&255]+Nr[l>>8&255]+Nr[l>>16&255]+Nr[l>>24&255]+"-"+Nr[e&255]+Nr[e>>8&255]+"-"+Nr[e>>16&15|64]+Nr[e>>24&255]+"-"+Nr[i&63|128]+Nr[i>>8&255]+"-"+Nr[i>>16&255]+Nr[i>>24&255]+Nr[n&255]+Nr[n>>8&255]+Nr[n>>16&255]+Nr[n>>24&255]).toLowerCase()}function or(l,e,i){return Math.max(e,Math.min(i,l))}function uc(l,e){return(l%e+e)%e}function tf(l,e,i,n,s){return n+(l-e)*(s-n)/(i-e)}function nf(l,e,i){return l!==e?(i-l)/(e-l):0}function ba(l,e,i){return(1-i)*l+i*e}function rf(l,e,i,n){return ba(l,e,1-Math.exp(-i*n))}function sf(l,e=1){return e-Math.abs(uc(l,e*2)-e)}function of(l,e,i){return l<=e?0:l>=i?1:(l=(l-e)/(i-e),l*l*(3-2*l))}function af(l,e,i){return l<=e?0:l>=i?1:(l=(l-e)/(i-e),l*l*l*(l*(l*6-15)+10))}function lf(l,e){return l+Math.floor(Math.random()*(e-l+1))}function cf(l,e){return l+Math.random()*(e-l)}function hf(l){return l*(.5-Math.random())}function uf(l){l!==void 0&&(Eh=l);let e=Eh+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function df(l){return l*Eo}function ff(l){return l*zo}function pf(l){return(l&l-1)===0&&l!==0}function Af(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function mf(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))}function gf(l,e,i,n,s){const a=Math.cos,d=Math.sin,v=a(i/2),I=d(i/2),R=a((e+n)/2),O=d((e+n)/2),k=a((e-n)/2),G=d((e-n)/2),z=a((n-e)/2),K=d((n-e)/2);switch(s){case"XYX":l.set(v*O,I*k,I*G,v*R);break;case"YZY":l.set(I*G,v*O,I*k,v*R);break;case"ZXZ":l.set(I*k,I*G,v*O,v*R);break;case"XZX":l.set(v*O,I*K,I*z,v*R);break;case"YXY":l.set(I*z,v*O,I*K,v*R);break;case"ZYZ":l.set(I*K,I*z,v*O,v*R);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function jr(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return l/4294967295;case Uint16Array:return l/65535;case Uint8Array:return l/255;case Int32Array:return Math.max(l/2147483647,-1);case Int16Array:return Math.max(l/32767,-1);case Int8Array:return Math.max(l/127,-1);default:throw new Error("Invalid component type.")}}function Yi(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return Math.round(l*4294967295);case Uint16Array:return Math.round(l*65535);case Uint8Array:return Math.round(l*255);case Int32Array:return Math.round(l*2147483647);case Int16Array:return Math.round(l*32767);case Int8Array:return Math.round(l*127);default:throw new Error("Invalid component type.")}}const vf={DEG2RAD:Eo,RAD2DEG:zo,generateUUID:ls,clamp:or,euclideanModulo:uc,mapLinear:tf,inverseLerp:nf,lerp:ba,damp:rf,pingpong:sf,smoothstep:of,smootherstep:af,randInt:lf,randFloat:cf,randFloatSpread:hf,seededRandom:uf,degToRad:df,radToDeg:ff,isPowerOfTwo:pf,ceilPowerOfTwo:Af,floorPowerOfTwo:mf,setQuaternionFromProperEuler:gf,normalize:Yi,denormalize:jr};class xt{constructor(e=0,i=0){xt.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,s=e.elements;return this.x=s[0]*i+s[3]*n+s[6],this.y=s[1]*i+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(or(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),s=Math.sin(i),a=this.x-e.x,d=this.y-e.y;return this.x=a*n-d*s+e.x,this.y=a*s+d*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ji{constructor(e,i,n,s,a,d,v,I,R){ji.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,n,s,a,d,v,I,R)}set(e,i,n,s,a,d,v,I,R){const O=this.elements;return O[0]=e,O[1]=s,O[2]=v,O[3]=i,O[4]=a,O[5]=I,O[6]=n,O[7]=d,O[8]=R,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,a=this.elements,d=n[0],v=n[3],I=n[6],R=n[1],O=n[4],k=n[7],G=n[2],z=n[5],K=n[8],ee=s[0],X=s[3],Q=s[6],ge=s[1],Ae=s[4],he=s[7],Qe=s[2],Be=s[5],Oe=s[8];return a[0]=d*ee+v*ge+I*Qe,a[3]=d*X+v*Ae+I*Be,a[6]=d*Q+v*he+I*Oe,a[1]=R*ee+O*ge+k*Qe,a[4]=R*X+O*Ae+k*Be,a[7]=R*Q+O*he+k*Oe,a[2]=G*ee+z*ge+K*Qe,a[5]=G*X+z*Ae+K*Be,a[8]=G*Q+z*he+K*Oe,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],s=e[2],a=e[3],d=e[4],v=e[5],I=e[6],R=e[7],O=e[8];return i*d*O-i*v*R-n*a*O+n*v*I+s*a*R-s*d*I}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],a=e[3],d=e[4],v=e[5],I=e[6],R=e[7],O=e[8],k=O*d-v*R,G=v*I-O*a,z=R*a-d*I,K=i*k+n*G+s*z;if(K===0)return this.set(0,0,0,0,0,0,0,0,0);const ee=1/K;return e[0]=k*ee,e[1]=(s*R-O*n)*ee,e[2]=(v*n-s*d)*ee,e[3]=G*ee,e[4]=(O*i-s*I)*ee,e[5]=(s*a-v*i)*ee,e[6]=z*ee,e[7]=(n*I-R*i)*ee,e[8]=(d*i-n*a)*ee,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,s,a,d,v){const I=Math.cos(a),R=Math.sin(a);return this.set(n*I,n*R,-n*(I*d+R*v)+d+e,-s*R,s*I,-s*(-R*d+I*v)+v+i,0,0,1),this}scale(e,i){return this.premultiply(dc.makeScale(e,i)),this}rotate(e){return this.premultiply(dc.makeRotation(-e)),this}translate(e,i){return this.premultiply(dc.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<9;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const dc=new ji;function xh(l){for(let e=l.length-1;e>=0;--e)if(l[e]>=65535)return!0;return!1}const yf={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Qo(l,e){return new yf[l](e)}function wa(l){return document.createElementNS("http://www.w3.org/1999/xhtml",l)}function Ch(){const l=wa("canvas");return l.style.display="block",l}const bh={};function wh(l){l in bh||(bh[l]=!0,console.warn(l))}const Mh=new ji().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),_h=new ji().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),il={[Ws]:{transfer:va,primaries:ya,toReference:l=>l,fromReference:l=>l},[yn]:{transfer:jn,primaries:ya,toReference:l=>l.convertSRGBToLinear(),fromReference:l=>l.convertLinearToSRGB()},[ga]:{transfer:va,primaries:Ea,toReference:l=>l.applyMatrix3(_h),fromReference:l=>l.applyMatrix3(Mh)},[tl]:{transfer:jn,primaries:Ea,toReference:l=>l.convertSRGBToLinear().applyMatrix3(_h),fromReference:l=>l.applyMatrix3(Mh).convertLinearToSRGB()}},Ef=new Set([Ws,ga]),Fn={enabled:!0,_workingColorSpace:Ws,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(l){if(!Ef.has(l))throw new Error(`Unsupported working color space, "${l}".`);this._workingColorSpace=l},convert:function(l,e,i){if(this.enabled===!1||e===i||!e||!i)return l;const n=il[e].toReference,s=il[i].fromReference;return s(n(l))},fromWorkingColorSpace:function(l,e){return this.convert(l,this._workingColorSpace,e)},toWorkingColorSpace:function(l,e){return this.convert(l,e,this._workingColorSpace)},getPrimaries:function(l){return il[l].primaries},getTransfer:function(l){return l===Hr?va:il[l].transfer}};function Ho(l){return l<.04045?l*.0773993808:Math.pow(l*.9478672986+.0521327014,2.4)}function fc(l){return l<.0031308?l*12.92:1.055*Math.pow(l,.41666)-.055}let xo;class jo{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{xo===void 0&&(xo=wa("canvas")),xo.width=e.width,xo.height=e.height;const n=xo.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),i=xo}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=wa("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),a=s.data;for(let d=0;d<a.length;d++)a[d]=Ho(a[d]/255)*255;return n.putImageData(s,0,0),i}else if(e.data){const i=e.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(Ho(i[n]/255)*255):i[n]=Ho(i[n]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Sh=0;class tr{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Sh++}),this.uuid=ls(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let a;if(Array.isArray(s)){a=[];for(let d=0,v=s.length;d<v;d++)s[d].isDataTexture?a.push(nl(s[d].image)):a.push(nl(s[d]))}else a=nl(s);n.url=a}return i||(e.images[this.uuid]=n),n}}function nl(l){return typeof HTMLImageElement<"u"&&l instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&l instanceof ImageBitmap?jo.getDataURL(l):l.data?{data:Array.from(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Th=0;class qn extends as{constructor(e=qn.DEFAULT_IMAGE,i=qn.DEFAULT_MAPPING,n=We,s=We,a=wi,d=In,v=Ne,I=Qn,R=qn.DEFAULT_ANISOTROPY,O=Hr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Th++}),this.uuid=ls(),this.name="",this.source=new tr(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=a,this.minFilter=d,this.anisotropy=R,this.format=v,this.internalFormat=null,this.type=I,this.offset=new xt(0,0),this.repeat=new xt(1,1),this.center=new xt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ji,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=O,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Pe)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Fe:e.x=e.x-Math.floor(e.x);break;case We:e.x=e.x<0?0:1;break;case Rt:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Fe:e.y=e.y-Math.floor(e.y);break;case We:e.y=e.y<0?0:1;break;case Rt:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}qn.DEFAULT_IMAGE=null,qn.DEFAULT_MAPPING=Pe,qn.DEFAULT_ANISOTROPY=1;class _n{constructor(e=0,i=0,n=0,s=1){_n.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,s){return this.x=e,this.y=i,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,a=this.w,d=e.elements;return this.x=d[0]*i+d[4]*n+d[8]*s+d[12]*a,this.y=d[1]*i+d[5]*n+d[9]*s+d[13]*a,this.z=d[2]*i+d[6]*n+d[10]*s+d[14]*a,this.w=d[3]*i+d[7]*n+d[11]*s+d[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,s,a;const I=e.elements,R=I[0],O=I[4],k=I[8],G=I[1],z=I[5],K=I[9],ee=I[2],X=I[6],Q=I[10];if(Math.abs(O-G)<.01&&Math.abs(k-ee)<.01&&Math.abs(K-X)<.01){if(Math.abs(O+G)<.1&&Math.abs(k+ee)<.1&&Math.abs(K+X)<.1&&Math.abs(R+z+Q-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const Ae=(R+1)/2,he=(z+1)/2,Qe=(Q+1)/2,Be=(O+G)/4,Oe=(k+ee)/4,Ve=(K+X)/4;return Ae>he&&Ae>Qe?Ae<.01?(n=0,s=.707106781,a=.707106781):(n=Math.sqrt(Ae),s=Be/n,a=Oe/n):he>Qe?he<.01?(n=.707106781,s=0,a=.707106781):(s=Math.sqrt(he),n=Be/s,a=Ve/s):Qe<.01?(n=.707106781,s=.707106781,a=0):(a=Math.sqrt(Qe),n=Oe/a,s=Ve/a),this.set(n,s,a,i),this}let ge=Math.sqrt((X-K)*(X-K)+(k-ee)*(k-ee)+(G-O)*(G-O));return Math.abs(ge)<.001&&(ge=1),this.x=(X-K)/ge,this.y=(k-ee)/ge,this.z=(G-O)/ge,this.w=Math.acos((R+z+Q-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rl extends as{constructor(e=1,i=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new _n(0,0,e,i),this.scissorTest=!1,this.viewport=new _n(0,0,e,i);const s={width:e,height:i,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:wi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const a=new qn(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);a.flipY=!1,a.generateMipmaps=n.generateMipmaps,a.internalFormat=n.internalFormat,this.textures=[];const d=n.count;for(let v=0;v<d;v++)this.textures[v]=a.clone(),this.textures[v].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,i,n=1){if(this.width!==e||this.height!==i||this.depth!==n){this.width=e,this.height=i,this.depth=n;for(let s=0,a=this.textures.length;s<a;s++)this.textures[s].image.width=e,this.textures[s].image.height=i,this.textures[s].image.depth=n;this.dispose()}this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,s=e.textures.length;n<s;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new tr(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ys extends rl{constructor(e=1,i=1,n={}){super(e,i,n),this.isWebGLRenderTarget=!0}}class sl extends qn{constructor(e=null,i=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:n,depth:s},this.magFilter=zt,this.minFilter=zt,this.wrapR=We,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ui extends ys{constructor(e=1,i=1,n=1,s={}){super(e,i,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new sl(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class Wi extends qn{constructor(e=null,i=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:n,depth:s},this.magFilter=zt,this.minFilter=zt,this.wrapR=We,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class vn extends ys{constructor(e=1,i=1,n=1,s={}){super(e,i,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Wi(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class Rn{constructor(e=0,i=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=n,this._w=s}static slerpFlat(e,i,n,s,a,d,v){let I=n[s+0],R=n[s+1],O=n[s+2],k=n[s+3];const G=a[d+0],z=a[d+1],K=a[d+2],ee=a[d+3];if(v===0){e[i+0]=I,e[i+1]=R,e[i+2]=O,e[i+3]=k;return}if(v===1){e[i+0]=G,e[i+1]=z,e[i+2]=K,e[i+3]=ee;return}if(k!==ee||I!==G||R!==z||O!==K){let X=1-v;const Q=I*G+R*z+O*K+k*ee,ge=Q>=0?1:-1,Ae=1-Q*Q;if(Ae>Number.EPSILON){const Qe=Math.sqrt(Ae),Be=Math.atan2(Qe,Q*ge);X=Math.sin(X*Be)/Qe,v=Math.sin(v*Be)/Qe}const he=v*ge;if(I=I*X+G*he,R=R*X+z*he,O=O*X+K*he,k=k*X+ee*he,X===1-v){const Qe=1/Math.sqrt(I*I+R*R+O*O+k*k);I*=Qe,R*=Qe,O*=Qe,k*=Qe}}e[i]=I,e[i+1]=R,e[i+2]=O,e[i+3]=k}static multiplyQuaternionsFlat(e,i,n,s,a,d){const v=n[s],I=n[s+1],R=n[s+2],O=n[s+3],k=a[d],G=a[d+1],z=a[d+2],K=a[d+3];return e[i]=v*K+O*k+I*z-R*G,e[i+1]=I*K+O*G+R*k-v*z,e[i+2]=R*K+O*z+v*G-I*k,e[i+3]=O*K-v*k-I*G-R*z,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,n,s){return this._x=e,this._y=i,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i=!0){const n=e._x,s=e._y,a=e._z,d=e._order,v=Math.cos,I=Math.sin,R=v(n/2),O=v(s/2),k=v(a/2),G=I(n/2),z=I(s/2),K=I(a/2);switch(d){case"XYZ":this._x=G*O*k+R*z*K,this._y=R*z*k-G*O*K,this._z=R*O*K+G*z*k,this._w=R*O*k-G*z*K;break;case"YXZ":this._x=G*O*k+R*z*K,this._y=R*z*k-G*O*K,this._z=R*O*K-G*z*k,this._w=R*O*k+G*z*K;break;case"ZXY":this._x=G*O*k-R*z*K,this._y=R*z*k+G*O*K,this._z=R*O*K+G*z*k,this._w=R*O*k-G*z*K;break;case"ZYX":this._x=G*O*k-R*z*K,this._y=R*z*k+G*O*K,this._z=R*O*K-G*z*k,this._w=R*O*k+G*z*K;break;case"YZX":this._x=G*O*k+R*z*K,this._y=R*z*k+G*O*K,this._z=R*O*K-G*z*k,this._w=R*O*k-G*z*K;break;case"XZY":this._x=G*O*k-R*z*K,this._y=R*z*k-G*O*K,this._z=R*O*K+G*z*k,this._w=R*O*k+G*z*K;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return i===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const n=i/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,n=i[0],s=i[4],a=i[8],d=i[1],v=i[5],I=i[9],R=i[2],O=i[6],k=i[10],G=n+v+k;if(G>0){const z=.5/Math.sqrt(G+1);this._w=.25/z,this._x=(O-I)*z,this._y=(a-R)*z,this._z=(d-s)*z}else if(n>v&&n>k){const z=2*Math.sqrt(1+n-v-k);this._w=(O-I)/z,this._x=.25*z,this._y=(s+d)/z,this._z=(a+R)/z}else if(v>k){const z=2*Math.sqrt(1+v-n-k);this._w=(a-R)/z,this._x=(s+d)/z,this._y=.25*z,this._z=(I+O)/z}else{const z=2*Math.sqrt(1+k-n-v);this._w=(d-s)/z,this._x=(a+R)/z,this._y=(I+O)/z,this._z=.25*z}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let n=e.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(or(this.dot(e),-1,1)))}rotateTowards(e,i){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,i/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const n=e._x,s=e._y,a=e._z,d=e._w,v=i._x,I=i._y,R=i._z,O=i._w;return this._x=n*O+d*v+s*R-a*I,this._y=s*O+d*I+a*v-n*R,this._z=a*O+d*R+n*I-s*v,this._w=d*O-n*v-s*I-a*R,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const n=this._x,s=this._y,a=this._z,d=this._w;let v=d*e._w+n*e._x+s*e._y+a*e._z;if(v<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,v=-v):this.copy(e),v>=1)return this._w=d,this._x=n,this._y=s,this._z=a,this;const I=1-v*v;if(I<=Number.EPSILON){const z=1-i;return this._w=z*d+i*this._w,this._x=z*n+i*this._x,this._y=z*s+i*this._y,this._z=z*a+i*this._z,this.normalize(),this}const R=Math.sqrt(I),O=Math.atan2(R,v),k=Math.sin((1-i)*O)/R,G=Math.sin(i*O)/R;return this._w=d*k+this._w*G,this._x=n*k+this._x*G,this._y=s*k+this._y*G,this._z=a*k+this._z*G,this._onChangeCallback(),this}slerpQuaternions(e,i,n){return this.copy(e).slerp(i,n)}random(){const e=2*Math.PI*Math.random(),i=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),a*Math.sin(i),a*Math.cos(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ie{constructor(e=0,i=0,n=0){Ie.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(mr.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(mr.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,s=this.z,a=e.elements;return this.x=a[0]*i+a[3]*n+a[6]*s,this.y=a[1]*i+a[4]*n+a[7]*s,this.z=a[2]*i+a[5]*n+a[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,a=e.elements,d=1/(a[3]*i+a[7]*n+a[11]*s+a[15]);return this.x=(a[0]*i+a[4]*n+a[8]*s+a[12])*d,this.y=(a[1]*i+a[5]*n+a[9]*s+a[13])*d,this.z=(a[2]*i+a[6]*n+a[10]*s+a[14])*d,this}applyQuaternion(e){const i=this.x,n=this.y,s=this.z,a=e.x,d=e.y,v=e.z,I=e.w,R=2*(d*s-v*n),O=2*(v*i-a*s),k=2*(a*n-d*i);return this.x=i+I*R+d*k-v*O,this.y=n+I*O+v*R-a*k,this.z=s+I*k+a*O-d*R,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,s=this.z,a=e.elements;return this.x=a[0]*i+a[4]*n+a[8]*s,this.y=a[1]*i+a[5]*n+a[9]*s,this.z=a[2]*i+a[6]*n+a[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,s=e.y,a=e.z,d=i.x,v=i.y,I=i.z;return this.x=s*I-a*v,this.y=a*d-n*I,this.z=n*v-s*d,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return _s.copy(this).projectOnVector(e),this.sub(_s)}reflect(e){return this.sub(_s.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(or(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return i*i+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const s=Math.sin(i)*e;return this.x=s*Math.sin(n),this.y=Math.cos(i)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=s,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,i=Math.random()*2-1,n=Math.sqrt(1-i*i);return this.x=n*Math.cos(e),this.y=i,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _s=new Ie,mr=new Rn;class hr{constructor(e=new Ie(1/0,1/0,1/0),i=new Ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i+=3)this.expandByPoint(Jr.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,n=e.count;i<n;i++)this.expandByPoint(Jr.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=Jr.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const a=n.getAttribute("position");if(i===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let d=0,v=a.count;d<v;d++)e.isMesh===!0?e.getVertexPosition(d,Jr):Jr.fromBufferAttribute(a,d),Jr.applyMatrix4(e.matrixWorld),this.expandByPoint(Jr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),ho.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),ho.copy(n.boundingBox)),ho.applyMatrix4(e.matrixWorld),this.union(ho)}const s=e.children;for(let a=0,d=s.length;a<d;a++)this.expandByObject(s[a],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Jr),Jr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,n;return e.normal.x>0?(i=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),i<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(En),Vn.subVectors(this.max,En),Es.subVectors(e.a,En),kr.subVectors(e.b,En),$i.subVectors(e.c,En),Wr.subVectors(kr,Es),Ss.subVectors($i,kr),Ur.subVectors(Es,$i);let i=[0,-Wr.z,Wr.y,0,-Ss.z,Ss.y,0,-Ur.z,Ur.y,Wr.z,0,-Wr.x,Ss.z,0,-Ss.x,Ur.z,0,-Ur.x,-Wr.y,Wr.x,0,-Ss.y,Ss.x,0,-Ur.y,Ur.x,0];return!cs(i,Es,kr,$i,Vn)||(i=[1,0,0,0,1,0,0,0,1],!cs(i,Es,kr,$i,Vn))?!1:(en.crossVectors(Wr,Ss),i=[en.x,en.y,en.z],cs(i,Es,kr,$i,Vn))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Jr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Jr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(An[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),An[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),An[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),An[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),An[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),An[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),An[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),An[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(An),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const An=[new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie],Jr=new Ie,ho=new hr,Es=new Ie,kr=new Ie,$i=new Ie,Wr=new Ie,Ss=new Ie,Ur=new Ie,En=new Ie,Vn=new Ie,en=new Ie,xn=new Ie;function cs(l,e,i,n,s){for(let a=0,d=l.length-3;a<=d;a+=3){xn.fromArray(l,a);const v=s.x*Math.abs(xn.x)+s.y*Math.abs(xn.y)+s.z*Math.abs(xn.z),I=e.dot(xn),R=i.dot(xn),O=n.dot(xn);if(Math.max(-Math.max(I,R,O),Math.min(I,R,O))>v)return!1}return!0}const Wo=new hr,Co=new Ie,ol=new Ie;class Ir{constructor(e=new Ie,i=-1){this.isSphere=!0,this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const n=this.center;i!==void 0?n.copy(i):Wo.setFromPoints(e).getCenter(n);let s=0;for(let a=0,d=e.length;a<d;a++)s=Math.max(s,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const n=this.center.distanceToSquared(e);return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Co.subVectors(e,this.center);const i=Co.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),s=(n-this.radius)*.5;this.center.addScaledVector(Co,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ol.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Co.copy(e.center).add(ol)),this.expandByPoint(Co.copy(e.center).sub(ol))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ks=new Ie,al=new Ie,ll=new Ie,uo=new Ie,pc=new Ie,cl=new Ie,Ac=new Ie;class Br{constructor(e=new Ie,i=new Ie(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ks)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=ks.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(ks.copy(this.origin).addScaledVector(this.direction,i),ks.distanceToSquared(e))}distanceSqToSegment(e,i,n,s){al.copy(e).add(i).multiplyScalar(.5),ll.copy(i).sub(e).normalize(),uo.copy(this.origin).sub(al);const a=e.distanceTo(i)*.5,d=-this.direction.dot(ll),v=uo.dot(this.direction),I=-uo.dot(ll),R=uo.lengthSq(),O=Math.abs(1-d*d);let k,G,z,K;if(O>0)if(k=d*I-v,G=d*v-I,K=a*O,k>=0)if(G>=-K)if(G<=K){const ee=1/O;k*=ee,G*=ee,z=k*(k+d*G+2*v)+G*(d*k+G+2*I)+R}else G=a,k=Math.max(0,-(d*G+v)),z=-k*k+G*(G+2*I)+R;else G=-a,k=Math.max(0,-(d*G+v)),z=-k*k+G*(G+2*I)+R;else G<=-K?(k=Math.max(0,-(-d*a+v)),G=k>0?-a:Math.min(Math.max(-a,-I),a),z=-k*k+G*(G+2*I)+R):G<=K?(k=0,G=Math.min(Math.max(-a,-I),a),z=G*(G+2*I)+R):(k=Math.max(0,-(d*a+v)),G=k>0?a:Math.min(Math.max(-a,-I),a),z=-k*k+G*(G+2*I)+R);else G=d>0?-a:a,k=Math.max(0,-(d*G+v)),z=-k*k+G*(G+2*I)+R;return n&&n.copy(this.origin).addScaledVector(this.direction,k),s&&s.copy(al).addScaledVector(ll,G),z}intersectSphere(e,i){ks.subVectors(e.center,this.origin);const n=ks.dot(this.direction),s=ks.dot(ks)-n*n,a=e.radius*e.radius;if(s>a)return null;const d=Math.sqrt(a-s),v=n-d,I=n+d;return I<0?null:v<0?this.at(I,i):this.at(v,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/i;return n>=0?n:null}intersectPlane(e,i){const n=this.distanceToPlane(e);return n===null?null:this.at(n,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let n,s,a,d,v,I;const R=1/this.direction.x,O=1/this.direction.y,k=1/this.direction.z,G=this.origin;return R>=0?(n=(e.min.x-G.x)*R,s=(e.max.x-G.x)*R):(n=(e.max.x-G.x)*R,s=(e.min.x-G.x)*R),O>=0?(a=(e.min.y-G.y)*O,d=(e.max.y-G.y)*O):(a=(e.max.y-G.y)*O,d=(e.min.y-G.y)*O),n>d||a>s||((a>n||isNaN(n))&&(n=a),(d<s||isNaN(s))&&(s=d),k>=0?(v=(e.min.z-G.z)*k,I=(e.max.z-G.z)*k):(v=(e.max.z-G.z)*k,I=(e.min.z-G.z)*k),n>I||v>s)||((v>n||n!==n)&&(n=v),(I<s||s!==s)&&(s=I),s<0)?null:this.at(n>=0?n:s,i)}intersectsBox(e){return this.intersectBox(e,ks)!==null}intersectTriangle(e,i,n,s,a){pc.subVectors(i,e),cl.subVectors(n,e),Ac.crossVectors(pc,cl);let d=this.direction.dot(Ac),v;if(d>0){if(s)return null;v=1}else if(d<0)v=-1,d=-d;else return null;uo.subVectors(this.origin,e);const I=v*this.direction.dot(cl.crossVectors(uo,cl));if(I<0)return null;const R=v*this.direction.dot(pc.cross(uo));if(R<0||I+R>d)return null;const O=-v*uo.dot(Ac);return O<0?null:this.at(O/d,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class mi{constructor(e,i,n,s,a,d,v,I,R,O,k,G,z,K,ee,X){mi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,n,s,a,d,v,I,R,O,k,G,z,K,ee,X)}set(e,i,n,s,a,d,v,I,R,O,k,G,z,K,ee,X){const Q=this.elements;return Q[0]=e,Q[4]=i,Q[8]=n,Q[12]=s,Q[1]=a,Q[5]=d,Q[9]=v,Q[13]=I,Q[2]=R,Q[6]=O,Q[10]=k,Q[14]=G,Q[3]=z,Q[7]=K,Q[11]=ee,Q[15]=X,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new mi().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,s=1/bo.setFromMatrixColumn(e,0).length(),a=1/bo.setFromMatrixColumn(e,1).length(),d=1/bo.setFromMatrixColumn(e,2).length();return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[3]=0,i[4]=n[4]*a,i[5]=n[5]*a,i[6]=n[6]*a,i[7]=0,i[8]=n[8]*d,i[9]=n[9]*d,i[10]=n[10]*d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,s=e.y,a=e.z,d=Math.cos(n),v=Math.sin(n),I=Math.cos(s),R=Math.sin(s),O=Math.cos(a),k=Math.sin(a);if(e.order==="XYZ"){const G=d*O,z=d*k,K=v*O,ee=v*k;i[0]=I*O,i[4]=-I*k,i[8]=R,i[1]=z+K*R,i[5]=G-ee*R,i[9]=-v*I,i[2]=ee-G*R,i[6]=K+z*R,i[10]=d*I}else if(e.order==="YXZ"){const G=I*O,z=I*k,K=R*O,ee=R*k;i[0]=G+ee*v,i[4]=K*v-z,i[8]=d*R,i[1]=d*k,i[5]=d*O,i[9]=-v,i[2]=z*v-K,i[6]=ee+G*v,i[10]=d*I}else if(e.order==="ZXY"){const G=I*O,z=I*k,K=R*O,ee=R*k;i[0]=G-ee*v,i[4]=-d*k,i[8]=K+z*v,i[1]=z+K*v,i[5]=d*O,i[9]=ee-G*v,i[2]=-d*R,i[6]=v,i[10]=d*I}else if(e.order==="ZYX"){const G=d*O,z=d*k,K=v*O,ee=v*k;i[0]=I*O,i[4]=K*R-z,i[8]=G*R+ee,i[1]=I*k,i[5]=ee*R+G,i[9]=z*R-K,i[2]=-R,i[6]=v*I,i[10]=d*I}else if(e.order==="YZX"){const G=d*I,z=d*R,K=v*I,ee=v*R;i[0]=I*O,i[4]=ee-G*k,i[8]=K*k+z,i[1]=k,i[5]=d*O,i[9]=-v*O,i[2]=-R*O,i[6]=z*k+K,i[10]=G-ee*k}else if(e.order==="XZY"){const G=d*I,z=d*R,K=v*I,ee=v*R;i[0]=I*O,i[4]=-k,i[8]=R*O,i[1]=G*k+ee,i[5]=d*O,i[9]=z*k-K,i[2]=K*k-z,i[6]=v*O,i[10]=ee*k+G}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gy,e,vy)}lookAt(e,i,n){const s=this.elements;return Ts.subVectors(e,i),Ts.lengthSq()===0&&(Ts.z=1),Ts.normalize(),Ko.crossVectors(n,Ts),Ko.lengthSq()===0&&(Math.abs(n.z)===1?Ts.x+=1e-4:Ts.z+=1e-4,Ts.normalize(),Ko.crossVectors(n,Ts)),Ko.normalize(),Ih.crossVectors(Ts,Ko),s[0]=Ko.x,s[4]=Ih.x,s[8]=Ts.x,s[1]=Ko.y,s[5]=Ih.y,s[9]=Ts.y,s[2]=Ko.z,s[6]=Ih.z,s[10]=Ts.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,a=this.elements,d=n[0],v=n[4],I=n[8],R=n[12],O=n[1],k=n[5],G=n[9],z=n[13],K=n[2],ee=n[6],X=n[10],Q=n[14],ge=n[3],Ae=n[7],he=n[11],Qe=n[15],Be=s[0],Oe=s[4],Ve=s[8],_e=s[12],xe=s[1],ze=s[5],qe=s[9],Ke=s[13],$e=s[2],at=s[6],vt=s[10],jt=s[14],ct=s[3],Ut=s[7],Qt=s[11],fi=s[15];return a[0]=d*Be+v*xe+I*$e+R*ct,a[4]=d*Oe+v*ze+I*at+R*Ut,a[8]=d*Ve+v*qe+I*vt+R*Qt,a[12]=d*_e+v*Ke+I*jt+R*fi,a[1]=O*Be+k*xe+G*$e+z*ct,a[5]=O*Oe+k*ze+G*at+z*Ut,a[9]=O*Ve+k*qe+G*vt+z*Qt,a[13]=O*_e+k*Ke+G*jt+z*fi,a[2]=K*Be+ee*xe+X*$e+Q*ct,a[6]=K*Oe+ee*ze+X*at+Q*Ut,a[10]=K*Ve+ee*qe+X*vt+Q*Qt,a[14]=K*_e+ee*Ke+X*jt+Q*fi,a[3]=ge*Be+Ae*xe+he*$e+Qe*ct,a[7]=ge*Oe+Ae*ze+he*at+Qe*Ut,a[11]=ge*Ve+Ae*qe+he*vt+Qe*Qt,a[15]=ge*_e+Ae*Ke+he*jt+Qe*fi,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],s=e[8],a=e[12],d=e[1],v=e[5],I=e[9],R=e[13],O=e[2],k=e[6],G=e[10],z=e[14],K=e[3],ee=e[7],X=e[11],Q=e[15];return K*(+a*I*k-s*R*k-a*v*G+n*R*G+s*v*z-n*I*z)+ee*(+i*I*z-i*R*G+a*d*G-s*d*z+s*R*O-a*I*O)+X*(+i*R*k-i*v*z-a*d*k+n*d*z+a*v*O-n*R*O)+Q*(-s*v*O-i*I*k+i*v*G+s*d*k-n*d*G+n*I*O)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=i,s[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],a=e[3],d=e[4],v=e[5],I=e[6],R=e[7],O=e[8],k=e[9],G=e[10],z=e[11],K=e[12],ee=e[13],X=e[14],Q=e[15],ge=k*X*R-ee*G*R+ee*I*z-v*X*z-k*I*Q+v*G*Q,Ae=K*G*R-O*X*R-K*I*z+d*X*z+O*I*Q-d*G*Q,he=O*ee*R-K*k*R+K*v*z-d*ee*z-O*v*Q+d*k*Q,Qe=K*k*I-O*ee*I-K*v*G+d*ee*G+O*v*X-d*k*X,Be=i*ge+n*Ae+s*he+a*Qe;if(Be===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Oe=1/Be;return e[0]=ge*Oe,e[1]=(ee*G*a-k*X*a-ee*s*z+n*X*z+k*s*Q-n*G*Q)*Oe,e[2]=(v*X*a-ee*I*a+ee*s*R-n*X*R-v*s*Q+n*I*Q)*Oe,e[3]=(k*I*a-v*G*a-k*s*R+n*G*R+v*s*z-n*I*z)*Oe,e[4]=Ae*Oe,e[5]=(O*X*a-K*G*a+K*s*z-i*X*z-O*s*Q+i*G*Q)*Oe,e[6]=(K*I*a-d*X*a-K*s*R+i*X*R+d*s*Q-i*I*Q)*Oe,e[7]=(d*G*a-O*I*a+O*s*R-i*G*R-d*s*z+i*I*z)*Oe,e[8]=he*Oe,e[9]=(K*k*a-O*ee*a-K*n*z+i*ee*z+O*n*Q-i*k*Q)*Oe,e[10]=(d*ee*a-K*v*a+K*n*R-i*ee*R-d*n*Q+i*v*Q)*Oe,e[11]=(O*v*a-d*k*a-O*n*R+i*k*R+d*n*z-i*v*z)*Oe,e[12]=Qe*Oe,e[13]=(O*ee*s-K*k*s+K*n*G-i*ee*G-O*n*X+i*k*X)*Oe,e[14]=(K*v*s-d*ee*s-K*n*I+i*ee*I+d*n*X-i*v*X)*Oe,e[15]=(d*k*s-O*v*s+O*n*I-i*k*I-d*n*G+i*v*G)*Oe,this}scale(e){const i=this.elements,n=e.x,s=e.y,a=e.z;return i[0]*=n,i[4]*=s,i[8]*=a,i[1]*=n,i[5]*=s,i[9]*=a,i[2]*=n,i[6]*=s,i[10]*=a,i[3]*=n,i[7]*=s,i[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,s))}makeTranslation(e,i,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),s=Math.sin(i),a=1-n,d=e.x,v=e.y,I=e.z,R=a*d,O=a*v;return this.set(R*d+n,R*v-s*I,R*I+s*v,0,R*v+s*I,O*v+n,O*I-s*d,0,R*I-s*v,O*I+s*d,a*I*I+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,s,a,d){return this.set(1,n,a,0,e,1,d,0,i,s,1,0,0,0,0,1),this}compose(e,i,n){const s=this.elements,a=i._x,d=i._y,v=i._z,I=i._w,R=a+a,O=d+d,k=v+v,G=a*R,z=a*O,K=a*k,ee=d*O,X=d*k,Q=v*k,ge=I*R,Ae=I*O,he=I*k,Qe=n.x,Be=n.y,Oe=n.z;return s[0]=(1-(ee+Q))*Qe,s[1]=(z+he)*Qe,s[2]=(K-Ae)*Qe,s[3]=0,s[4]=(z-he)*Be,s[5]=(1-(G+Q))*Be,s[6]=(X+ge)*Be,s[7]=0,s[8]=(K+Ae)*Oe,s[9]=(X-ge)*Oe,s[10]=(1-(G+ee))*Oe,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,i,n){const s=this.elements;let a=bo.set(s[0],s[1],s[2]).length();const d=bo.set(s[4],s[5],s[6]).length(),v=bo.set(s[8],s[9],s[10]).length();this.determinant()<0&&(a=-a),e.x=s[12],e.y=s[13],e.z=s[14],xs.copy(this);const R=1/a,O=1/d,k=1/v;return xs.elements[0]*=R,xs.elements[1]*=R,xs.elements[2]*=R,xs.elements[4]*=O,xs.elements[5]*=O,xs.elements[6]*=O,xs.elements[8]*=k,xs.elements[9]*=k,xs.elements[10]*=k,i.setFromRotationMatrix(xs),n.x=a,n.y=d,n.z=v,this}makePerspective(e,i,n,s,a,d,v=Ns){const I=this.elements,R=2*a/(i-e),O=2*a/(n-s),k=(i+e)/(i-e),G=(n+s)/(n-s);let z,K;if(v===Ns)z=-(d+a)/(d-a),K=-2*d*a/(d-a);else if(v===Ca)z=-d/(d-a),K=-d*a/(d-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+v);return I[0]=R,I[4]=0,I[8]=k,I[12]=0,I[1]=0,I[5]=O,I[9]=G,I[13]=0,I[2]=0,I[6]=0,I[10]=z,I[14]=K,I[3]=0,I[7]=0,I[11]=-1,I[15]=0,this}makeOrthographic(e,i,n,s,a,d,v=Ns){const I=this.elements,R=1/(i-e),O=1/(n-s),k=1/(d-a),G=(i+e)*R,z=(n+s)*O;let K,ee;if(v===Ns)K=(d+a)*k,ee=-2*k;else if(v===Ca)K=a*k,ee=-1*k;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+v);return I[0]=2*R,I[4]=0,I[8]=0,I[12]=-G,I[1]=0,I[5]=2*O,I[9]=0,I[13]=-z,I[2]=0,I[6]=0,I[10]=ee,I[14]=-K,I[3]=0,I[7]=0,I[11]=0,I[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<16;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}}const bo=new Ie,xs=new mi,gy=new Ie(0,0,0),vy=new Ie(1,1,1),Ko=new Ie,Ih=new Ie,Ts=new Ie,VA=new mi,zA=new Rn;class Is{constructor(e=0,i=0,n=0,s=Is.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,s=this._order){return this._x=e,this._y=i,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const s=e.elements,a=s[0],d=s[4],v=s[8],I=s[1],R=s[5],O=s[9],k=s[2],G=s[6],z=s[10];switch(i){case"XYZ":this._y=Math.asin(or(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(-O,z),this._z=Math.atan2(-d,a)):(this._x=Math.atan2(G,R),this._z=0);break;case"YXZ":this._x=Math.asin(-or(O,-1,1)),Math.abs(O)<.9999999?(this._y=Math.atan2(v,z),this._z=Math.atan2(I,R)):(this._y=Math.atan2(-k,a),this._z=0);break;case"ZXY":this._x=Math.asin(or(G,-1,1)),Math.abs(G)<.9999999?(this._y=Math.atan2(-k,z),this._z=Math.atan2(-d,R)):(this._y=0,this._z=Math.atan2(I,a));break;case"ZYX":this._y=Math.asin(-or(k,-1,1)),Math.abs(k)<.9999999?(this._x=Math.atan2(G,z),this._z=Math.atan2(I,a)):(this._x=0,this._z=Math.atan2(-d,R));break;case"YZX":this._z=Math.asin(or(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(-O,R),this._y=Math.atan2(-k,a)):(this._x=0,this._y=Math.atan2(v,z));break;case"XZY":this._z=Math.asin(-or(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(G,R),this._y=Math.atan2(v,a)):(this._x=Math.atan2(-O,z),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return VA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(VA,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return zA.setFromEuler(this),this.setFromQuaternion(zA,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Is.DEFAULT_ORDER="XYZ";class Bh{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let yy=0;const QA=new Ie,hl=new Rn,wo=new mi,Rh=new Ie,mc=new Ie,Ey=new Ie,xy=new Rn,HA=new Ie(1,0,0),jA=new Ie(0,1,0),WA=new Ie(0,0,1),KA={type:"added"},Cy={type:"removed"},ul={type:"childadded",child:null},xf={type:"childremoved",child:null};class Ln extends as{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:yy++}),this.uuid=ls(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ln.DEFAULT_UP.clone();const e=new Ie,i=new Is,n=new Rn,s=new Ie(1,1,1);function a(){n.setFromEuler(i,!1)}function d(){i.setFromQuaternion(n,void 0,!1)}i._onChange(a),n._onChange(d),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new mi},normalMatrix:{value:new ji}}),this.matrix=new mi,this.matrixWorld=new mi,this.matrixAutoUpdate=Ln.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ln.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Bh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return hl.setFromAxisAngle(e,i),this.quaternion.multiply(hl),this}rotateOnWorldAxis(e,i){return hl.setFromAxisAngle(e,i),this.quaternion.premultiply(hl),this}rotateX(e){return this.rotateOnAxis(HA,e)}rotateY(e){return this.rotateOnAxis(jA,e)}rotateZ(e){return this.rotateOnAxis(WA,e)}translateOnAxis(e,i){return QA.copy(e).applyQuaternion(this.quaternion),this.position.add(QA.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(HA,e)}translateY(e){return this.translateOnAxis(jA,e)}translateZ(e){return this.translateOnAxis(WA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(wo.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?Rh.copy(e):Rh.set(e,i,n);const s=this.parent;this.updateWorldMatrix(!0,!1),mc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wo.lookAt(mc,Rh,this.up):wo.lookAt(Rh,mc,this.up),this.quaternion.setFromRotationMatrix(wo),s&&(wo.extractRotation(s.matrixWorld),hl.setFromRotationMatrix(wo),this.quaternion.premultiply(hl.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(KA),ul.child=e,this.dispatchEvent(ul),ul.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(Cy),xf.child=e,this.dispatchEvent(xf),xf.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),wo.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),wo.multiply(e.parent.matrixWorld)),e.applyMatrix4(wo),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(KA),ul.child=e,this.dispatchEvent(ul),ul.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,s=this.children.length;n<s;n++){const d=this.children[n].getObjectByProperty(e,i);if(d!==void 0)return d}}getObjectsByProperty(e,i,n=[]){this[e]===i&&n.push(this);const s=this.children;for(let a=0,d=s.length;a<d;a++)s[a].getObjectsByProperty(e,i,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mc,e,Ey),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mc,xy,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,s=i.length;n<s;n++){const a=i[n];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const s=this.children;for(let a=0,d=s.length;a<d;a++){const v=s[a];v.matrixWorldAutoUpdate===!0&&v.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(v=>({boxInitialized:v.boxInitialized,boxMin:v.box.min.toArray(),boxMax:v.box.max.toArray(),sphereInitialized:v.sphereInitialized,sphereRadius:v.sphere.radius,sphereCenter:v.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function a(v,I){return v[I.uuid]===void 0&&(v[I.uuid]=I.toJSON(e)),I.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=a(e.geometries,this.geometry);const v=this.geometry.parameters;if(v!==void 0&&v.shapes!==void 0){const I=v.shapes;if(Array.isArray(I))for(let R=0,O=I.length;R<O;R++){const k=I[R];a(e.shapes,k)}else a(e.shapes,I)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const v=[];for(let I=0,R=this.material.length;I<R;I++)v.push(a(e.materials,this.material[I]));s.material=v}else s.material=a(e.materials,this.material);if(this.children.length>0){s.children=[];for(let v=0;v<this.children.length;v++)s.children.push(this.children[v].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let v=0;v<this.animations.length;v++){const I=this.animations[v];s.animations.push(a(e.animations,I))}}if(i){const v=d(e.geometries),I=d(e.materials),R=d(e.textures),O=d(e.images),k=d(e.shapes),G=d(e.skeletons),z=d(e.animations),K=d(e.nodes);v.length>0&&(n.geometries=v),I.length>0&&(n.materials=I),R.length>0&&(n.textures=R),O.length>0&&(n.images=O),k.length>0&&(n.shapes=k),G.length>0&&(n.skeletons=G),z.length>0&&(n.animations=z),K.length>0&&(n.nodes=K)}return n.object=s,n;function d(v){const I=[];for(const R in v){const O=v[R];delete O.metadata,I.push(O)}return I}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}Ln.DEFAULT_UP=new Ie(0,1,0),Ln.DEFAULT_MATRIX_AUTO_UPDATE=!0,Ln.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ks=new Ie,Mo=new Ie,Cf=new Ie,_o=new Ie,dl=new Ie,fl=new Ie,XA=new Ie,bf=new Ie,wf=new Ie,Mf=new Ie;class Bs{constructor(e=new Ie,i=new Ie,n=new Ie){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,s){s.subVectors(n,i),Ks.subVectors(e,i),s.cross(Ks);const a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}static getBarycoord(e,i,n,s,a){Ks.subVectors(s,i),Mo.subVectors(n,i),Cf.subVectors(e,i);const d=Ks.dot(Ks),v=Ks.dot(Mo),I=Ks.dot(Cf),R=Mo.dot(Mo),O=Mo.dot(Cf),k=d*R-v*v;if(k===0)return a.set(0,0,0),null;const G=1/k,z=(R*I-v*O)*G,K=(d*O-v*I)*G;return a.set(1-z-K,K,z)}static containsPoint(e,i,n,s){return this.getBarycoord(e,i,n,s,_o)===null?!1:_o.x>=0&&_o.y>=0&&_o.x+_o.y<=1}static getInterpolation(e,i,n,s,a,d,v,I){return this.getBarycoord(e,i,n,s,_o)===null?(I.x=0,I.y=0,"z"in I&&(I.z=0),"w"in I&&(I.w=0),null):(I.setScalar(0),I.addScaledVector(a,_o.x),I.addScaledVector(d,_o.y),I.addScaledVector(v,_o.z),I)}static isFrontFacing(e,i,n,s){return Ks.subVectors(n,i),Mo.subVectors(e,i),Ks.cross(Mo).dot(s)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,s){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,i,n,s){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ks.subVectors(this.c,this.b),Mo.subVectors(this.a,this.b),Ks.cross(Mo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(e){return Bs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return Bs.getBarycoord(e,this.a,this.b,this.c,i)}getInterpolation(e,i,n,s,a){return Bs.getInterpolation(e,this.a,this.b,this.c,i,n,s,a)}containsPoint(e){return Bs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Bs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,s=this.b,a=this.c;let d,v;dl.subVectors(s,n),fl.subVectors(a,n),bf.subVectors(e,n);const I=dl.dot(bf),R=fl.dot(bf);if(I<=0&&R<=0)return i.copy(n);wf.subVectors(e,s);const O=dl.dot(wf),k=fl.dot(wf);if(O>=0&&k<=O)return i.copy(s);const G=I*k-O*R;if(G<=0&&I>=0&&O<=0)return d=I/(I-O),i.copy(n).addScaledVector(dl,d);Mf.subVectors(e,a);const z=dl.dot(Mf),K=fl.dot(Mf);if(K>=0&&z<=K)return i.copy(a);const ee=z*R-I*K;if(ee<=0&&R>=0&&K<=0)return v=R/(R-K),i.copy(n).addScaledVector(fl,v);const X=O*K-z*k;if(X<=0&&k-O>=0&&z-K>=0)return XA.subVectors(a,s),v=(k-O)/(k-O+(z-K)),i.copy(s).addScaledVector(XA,v);const Q=1/(X+ee+G);return d=ee*Q,v=G*Q,i.copy(n).addScaledVector(dl,d).addScaledVector(fl,v)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const YA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xo={h:0,s:0,l:0},Lh={h:0,s:0,l:0};function _f(l,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?l+(e-l)*6*i:i<.5?e:i<.6666666666666666?l+(e-l)*6*(.6666666666666666-i):l}class li{constructor(e,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,n)}set(e,i,n){if(i===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,i,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=yn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Fn.toWorkingColorSpace(this,i),this}setRGB(e,i,n,s=Fn.workingColorSpace){return this.r=e,this.g=i,this.b=n,Fn.toWorkingColorSpace(this,s),this}setHSL(e,i,n,s=Fn.workingColorSpace){if(e=uc(e,1),i=or(i,0,1),n=or(n,0,1),i===0)this.r=this.g=this.b=n;else{const a=n<=.5?n*(1+i):n+i-n*i,d=2*n-a;this.r=_f(d,a,e+.3333333333333333),this.g=_f(d,a,e),this.b=_f(d,a,e-.3333333333333333)}return Fn.toWorkingColorSpace(this,s),this}setStyle(e,i=yn){function n(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const d=s[1],v=s[2];switch(d){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(v))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,i);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(v))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,i);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(v))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=s[1],d=a.length;if(d===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,i);if(d===6)return this.setHex(parseInt(a,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=yn){const n=YA[e.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ho(e.r),this.g=Ho(e.g),this.b=Ho(e.b),this}copyLinearToSRGB(e){return this.r=fc(e.r),this.g=fc(e.g),this.b=fc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=yn){return Fn.fromWorkingColorSpace(Zr.copy(this),e),Math.round(or(Zr.r*255,0,255))*65536+Math.round(or(Zr.g*255,0,255))*256+Math.round(or(Zr.b*255,0,255))}getHexString(e=yn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=Fn.workingColorSpace){Fn.fromWorkingColorSpace(Zr.copy(this),i);const n=Zr.r,s=Zr.g,a=Zr.b,d=Math.max(n,s,a),v=Math.min(n,s,a);let I,R;const O=(v+d)/2;if(v===d)I=0,R=0;else{const k=d-v;switch(R=O<=.5?k/(d+v):k/(2-d-v),d){case n:I=(s-a)/k+(s<a?6:0);break;case s:I=(a-n)/k+2;break;case a:I=(n-s)/k+4;break}I/=6}return e.h=I,e.s=R,e.l=O,e}getRGB(e,i=Fn.workingColorSpace){return Fn.fromWorkingColorSpace(Zr.copy(this),i),e.r=Zr.r,e.g=Zr.g,e.b=Zr.b,e}getStyle(e=yn){Fn.fromWorkingColorSpace(Zr.copy(this),e);const i=Zr.r,n=Zr.g,s=Zr.b;return e!==yn?`color(${e} ${i.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,i,n){return this.getHSL(Xo),this.setHSL(Xo.h+e,Xo.s+i,Xo.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,n){return this.r=e.r+(i.r-e.r)*n,this.g=e.g+(i.g-e.g)*n,this.b=e.b+(i.b-e.b)*n,this}lerpHSL(e,i){this.getHSL(Xo),e.getHSL(Lh);const n=ba(Xo.h,Lh.h,i),s=ba(Xo.s,Lh.s,i),a=ba(Xo.l,Lh.l,i);return this.setHSL(n,s,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,n=this.g,s=this.b,a=e.elements;return this.r=a[0]*i+a[3]*n+a[6]*s,this.g=a[1]*i+a[4]*n+a[7]*s,this.b=a[2]*i+a[5]*n+a[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Zr=new li;li.NAMES=YA;let by=0;class $r extends as{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:by++}),this.uuid=ls(),this.name="",this.type="Material",this.blending=U,this.side=S,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=De,this.blendDst=Ge,this.blendEquation=te,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new li(0,0,0),this.blendAlpha=0,this.depthFunc=yi,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=lc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=yo,this.stencilZFail=yo,this.stencilZPass=yo,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const n=e[i];if(n===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const s=this[i];if(s===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[i]=n}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==U&&(n.blending=this.blending),this.side!==S&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==De&&(n.blendSrc=this.blendSrc),this.blendDst!==Ge&&(n.blendDst=this.blendDst),this.blendEquation!==te&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==yi&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==lc&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==yo&&(n.stencilFail=this.stencilFail),this.stencilZFail!==yo&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==yo&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(a){const d=[];for(const v in a){const I=a[v];delete I.metadata,d.push(I)}return d}if(i){const a=s(e.textures),d=s(e.images);a.length>0&&(n.textures=a),d.length>0&&(n.images=d)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let n=null;if(i!==null){const s=i.length;n=new Array(s);for(let a=0;a!==s;++a)n[a]=i[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Yo extends $r{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new li(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Is,this.combine=bn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const So=wy();function wy(){const l=new ArrayBuffer(4),e=new Float32Array(l),i=new Uint32Array(l),n=new Uint32Array(512),s=new Uint32Array(512);for(let I=0;I<256;++I){const R=I-127;R<-27?(n[I]=0,n[I|256]=32768,s[I]=24,s[I|256]=24):R<-14?(n[I]=1024>>-R-14,n[I|256]=1024>>-R-14|32768,s[I]=-R-1,s[I|256]=-R-1):R<=15?(n[I]=R+15<<10,n[I|256]=R+15<<10|32768,s[I]=13,s[I|256]=13):R<128?(n[I]=31744,n[I|256]=64512,s[I]=24,s[I|256]=24):(n[I]=31744,n[I|256]=64512,s[I]=13,s[I|256]=13)}const a=new Uint32Array(2048),d=new Uint32Array(64),v=new Uint32Array(64);for(let I=1;I<1024;++I){let R=I<<13,O=0;for(;!(R&8388608);)R<<=1,O-=8388608;R&=-8388609,O+=947912704,a[I]=R|O}for(let I=1024;I<2048;++I)a[I]=939524096+(I-1024<<13);for(let I=1;I<31;++I)d[I]=I<<23;d[31]=1199570944,d[32]=2147483648;for(let I=33;I<63;++I)d[I]=2147483648+(I-32<<23);d[63]=3347054592;for(let I=1;I<64;++I)I!==32&&(v[I]=1024);return{floatView:e,uint32View:i,baseTable:n,shiftTable:s,mantissaTable:a,exponentTable:d,offsetTable:v}}function Cs(l){Math.abs(l)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),l=or(l,-65504,65504),So.floatView[0]=l;const e=So.uint32View[0],i=e>>23&511;return So.baseTable[i]+((e&8388607)>>So.shiftTable[i])}function gc(l){const e=l>>10;return So.uint32View[0]=So.mantissaTable[So.offsetTable[e]+(l&1023)]+So.exponentTable[e],So.floatView[0]}const My={toHalfFloat:Cs,fromHalfFloat:gc},br=new Ie,Dh=new xt;class zn{constructor(e,i,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=n,this.usage=xa,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Yn,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return wh("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,n){e*=this.itemSize,n*=i.itemSize;for(let s=0,a=this.itemSize;s<a;s++)this.array[e+s]=i.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)Dh.fromBufferAttribute(this,i),Dh.applyMatrix3(e),this.setXY(i,Dh.x,Dh.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)br.fromBufferAttribute(this,i),br.applyMatrix3(e),this.setXYZ(i,br.x,br.y,br.z);return this}applyMatrix4(e){for(let i=0,n=this.count;i<n;i++)br.fromBufferAttribute(this,i),br.applyMatrix4(e),this.setXYZ(i,br.x,br.y,br.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)br.fromBufferAttribute(this,i),br.applyNormalMatrix(e),this.setXYZ(i,br.x,br.y,br.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)br.fromBufferAttribute(this,i),br.transformDirection(e),this.setXYZ(i,br.x,br.y,br.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let n=this.array[e*this.itemSize+i];return this.normalized&&(n=jr(n,this.array)),n}setComponent(e,i,n){return this.normalized&&(n=Yi(n,this.array)),this.array[e*this.itemSize+i]=n,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=jr(i,this.array)),i}setX(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=jr(i,this.array)),i}setY(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=jr(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=jr(i,this.array)),i}setW(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array)),this.array[e+0]=i,this.array[e+1]=n,this}setXYZ(e,i,n,s){return e*=this.itemSize,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array),s=Yi(s,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,i,n,s,a){return e*=this.itemSize,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array),s=Yi(s,this.array),a=Yi(a,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==xa&&(e.usage=this.usage),e}}class _y extends zn{constructor(e,i,n){super(new Int8Array(e),i,n)}}class Sy extends zn{constructor(e,i,n){super(new Uint8Array(e),i,n)}}class Ty extends zn{constructor(e,i,n){super(new Uint8ClampedArray(e),i,n)}}class Iy extends zn{constructor(e,i,n){super(new Int16Array(e),i,n)}}class Sf extends zn{constructor(e,i,n){super(new Uint16Array(e),i,n)}}class By extends zn{constructor(e,i,n){super(new Int32Array(e),i,n)}}class Tf extends zn{constructor(e,i,n){super(new Uint32Array(e),i,n)}}class Ry extends zn{constructor(e,i,n){super(new Uint16Array(e),i,n),this.isFloat16BufferAttribute=!0}getX(e){let i=gc(this.array[e*this.itemSize]);return this.normalized&&(i=jr(i,this.array)),i}setX(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize]=Cs(i),this}getY(e){let i=gc(this.array[e*this.itemSize+1]);return this.normalized&&(i=jr(i,this.array)),i}setY(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize+1]=Cs(i),this}getZ(e){let i=gc(this.array[e*this.itemSize+2]);return this.normalized&&(i=jr(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize+2]=Cs(i),this}getW(e){let i=gc(this.array[e*this.itemSize+3]);return this.normalized&&(i=jr(i,this.array)),i}setW(e,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize+3]=Cs(i),this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array)),this.array[e+0]=Cs(i),this.array[e+1]=Cs(n),this}setXYZ(e,i,n,s){return e*=this.itemSize,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array),s=Yi(s,this.array)),this.array[e+0]=Cs(i),this.array[e+1]=Cs(n),this.array[e+2]=Cs(s),this}setXYZW(e,i,n,s,a){return e*=this.itemSize,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array),s=Yi(s,this.array),a=Yi(a,this.array)),this.array[e+0]=Cs(i),this.array[e+1]=Cs(n),this.array[e+2]=Cs(s),this.array[e+3]=Cs(a),this}}class xi extends zn{constructor(e,i,n){super(new Float32Array(e),i,n)}}let Ly=0;const Us=new mi,If=new Ln,pl=new Ie,Rs=new hr,vc=new hr,Gr=new Ie;class on extends as{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ly++}),this.uuid=ls(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(xh(e)?Tf:Sf)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const a=new ji().getNormalMatrix(e);n.applyNormalMatrix(a),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Us.makeRotationFromQuaternion(e),this.applyMatrix4(Us),this}rotateX(e){return Us.makeRotationX(e),this.applyMatrix4(Us),this}rotateY(e){return Us.makeRotationY(e),this.applyMatrix4(Us),this}rotateZ(e){return Us.makeRotationZ(e),this.applyMatrix4(Us),this}translate(e,i,n){return Us.makeTranslation(e,i,n),this.applyMatrix4(Us),this}scale(e,i,n){return Us.makeScale(e,i,n),this.applyMatrix4(Us),this}lookAt(e){return If.lookAt(e),If.updateMatrix(),this.applyMatrix4(If.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pl).negate(),this.translate(pl.x,pl.y,pl.z),this}setFromPoints(e){const i=[];for(let n=0,s=e.length;n<s;n++){const a=e[n];i.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new xi(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hr);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ie(-1/0,-1/0,-1/0),new Ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,s=i.length;n<s;n++){const a=i[n];Rs.setFromBufferAttribute(a),this.morphTargetsRelative?(Gr.addVectors(this.boundingBox.min,Rs.min),this.boundingBox.expandByPoint(Gr),Gr.addVectors(this.boundingBox.max,Rs.max),this.boundingBox.expandByPoint(Gr)):(this.boundingBox.expandByPoint(Rs.min),this.boundingBox.expandByPoint(Rs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ir);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ie,1/0);return}if(e){const n=this.boundingSphere.center;if(Rs.setFromBufferAttribute(e),i)for(let a=0,d=i.length;a<d;a++){const v=i[a];vc.setFromBufferAttribute(v),this.morphTargetsRelative?(Gr.addVectors(Rs.min,vc.min),Rs.expandByPoint(Gr),Gr.addVectors(Rs.max,vc.max),Rs.expandByPoint(Gr)):(Rs.expandByPoint(vc.min),Rs.expandByPoint(vc.max))}Rs.getCenter(n);let s=0;for(let a=0,d=e.count;a<d;a++)Gr.fromBufferAttribute(e,a),s=Math.max(s,n.distanceToSquared(Gr));if(i)for(let a=0,d=i.length;a<d;a++){const v=i[a],I=this.morphTargetsRelative;for(let R=0,O=v.count;R<O;R++)Gr.fromBufferAttribute(v,R),I&&(pl.fromBufferAttribute(e,R),Gr.add(pl)),s=Math.max(s,n.distanceToSquared(Gr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=i.position,s=i.normal,a=i.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new zn(new Float32Array(4*n.count),4));const d=this.getAttribute("tangent"),v=[],I=[];for(let Ve=0;Ve<n.count;Ve++)v[Ve]=new Ie,I[Ve]=new Ie;const R=new Ie,O=new Ie,k=new Ie,G=new xt,z=new xt,K=new xt,ee=new Ie,X=new Ie;function Q(Ve,_e,xe){R.fromBufferAttribute(n,Ve),O.fromBufferAttribute(n,_e),k.fromBufferAttribute(n,xe),G.fromBufferAttribute(a,Ve),z.fromBufferAttribute(a,_e),K.fromBufferAttribute(a,xe),O.sub(R),k.sub(R),z.sub(G),K.sub(G);const ze=1/(z.x*K.y-K.x*z.y);isFinite(ze)&&(ee.copy(O).multiplyScalar(K.y).addScaledVector(k,-z.y).multiplyScalar(ze),X.copy(k).multiplyScalar(z.x).addScaledVector(O,-K.x).multiplyScalar(ze),v[Ve].add(ee),v[_e].add(ee),v[xe].add(ee),I[Ve].add(X),I[_e].add(X),I[xe].add(X))}let ge=this.groups;ge.length===0&&(ge=[{start:0,count:e.count}]);for(let Ve=0,_e=ge.length;Ve<_e;++Ve){const xe=ge[Ve],ze=xe.start,qe=xe.count;for(let Ke=ze,$e=ze+qe;Ke<$e;Ke+=3)Q(e.getX(Ke+0),e.getX(Ke+1),e.getX(Ke+2))}const Ae=new Ie,he=new Ie,Qe=new Ie,Be=new Ie;function Oe(Ve){Qe.fromBufferAttribute(s,Ve),Be.copy(Qe);const _e=v[Ve];Ae.copy(_e),Ae.sub(Qe.multiplyScalar(Qe.dot(_e))).normalize(),he.crossVectors(Be,_e);const ze=he.dot(I[Ve])<0?-1:1;d.setXYZW(Ve,Ae.x,Ae.y,Ae.z,ze)}for(let Ve=0,_e=ge.length;Ve<_e;++Ve){const xe=ge[Ve],ze=xe.start,qe=xe.count;for(let Ke=ze,$e=ze+qe;Ke<$e;Ke+=3)Oe(e.getX(Ke+0)),Oe(e.getX(Ke+1)),Oe(e.getX(Ke+2))}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new zn(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let G=0,z=n.count;G<z;G++)n.setXYZ(G,0,0,0);const s=new Ie,a=new Ie,d=new Ie,v=new Ie,I=new Ie,R=new Ie,O=new Ie,k=new Ie;if(e)for(let G=0,z=e.count;G<z;G+=3){const K=e.getX(G+0),ee=e.getX(G+1),X=e.getX(G+2);s.fromBufferAttribute(i,K),a.fromBufferAttribute(i,ee),d.fromBufferAttribute(i,X),O.subVectors(d,a),k.subVectors(s,a),O.cross(k),v.fromBufferAttribute(n,K),I.fromBufferAttribute(n,ee),R.fromBufferAttribute(n,X),v.add(O),I.add(O),R.add(O),n.setXYZ(K,v.x,v.y,v.z),n.setXYZ(ee,I.x,I.y,I.z),n.setXYZ(X,R.x,R.y,R.z)}else for(let G=0,z=i.count;G<z;G+=3)s.fromBufferAttribute(i,G+0),a.fromBufferAttribute(i,G+1),d.fromBufferAttribute(i,G+2),O.subVectors(d,a),k.subVectors(s,a),O.cross(k),n.setXYZ(G+0,O.x,O.y,O.z),n.setXYZ(G+1,O.x,O.y,O.z),n.setXYZ(G+2,O.x,O.y,O.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)Gr.fromBufferAttribute(e,i),Gr.normalize(),e.setXYZ(i,Gr.x,Gr.y,Gr.z)}toNonIndexed(){function e(v,I){const R=v.array,O=v.itemSize,k=v.normalized,G=new R.constructor(I.length*O);let z=0,K=0;for(let ee=0,X=I.length;ee<X;ee++){v.isInterleavedBufferAttribute?z=I[ee]*v.data.stride+v.offset:z=I[ee]*O;for(let Q=0;Q<O;Q++)G[K++]=R[z++]}return new zn(G,O,k)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new on,n=this.index.array,s=this.attributes;for(const v in s){const I=s[v],R=e(I,n);i.setAttribute(v,R)}const a=this.morphAttributes;for(const v in a){const I=[],R=a[v];for(let O=0,k=R.length;O<k;O++){const G=R[O],z=e(G,n);I.push(z)}i.morphAttributes[v]=I}i.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let v=0,I=d.length;v<I;v++){const R=d[v];i.addGroup(R.start,R.count,R.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const I=this.parameters;for(const R in I)I[R]!==void 0&&(e[R]=I[R]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const I in n){const R=n[I];e.data.attributes[I]=R.toJSON(e.data)}const s={};let a=!1;for(const I in this.morphAttributes){const R=this.morphAttributes[I],O=[];for(let k=0,G=R.length;k<G;k++){const z=R[k];O.push(z.toJSON(e.data))}O.length>0&&(s[I]=O,a=!0)}a&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const v=this.boundingSphere;return v!==null&&(e.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const s=e.attributes;for(const R in s){const O=s[R];this.setAttribute(R,O.clone(i))}const a=e.morphAttributes;for(const R in a){const O=[],k=a[R];for(let G=0,z=k.length;G<z;G++)O.push(k[G].clone(i));this.morphAttributes[R]=O}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let R=0,O=d.length;R<O;R++){const k=d[R];this.addGroup(k.start,k.count,k.materialIndex)}const v=e.boundingBox;v!==null&&(this.boundingBox=v.clone());const I=e.boundingSphere;return I!==null&&(this.boundingSphere=I.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const qA=new mi,Ma=new Br,Ph=new Ir,JA=new Ie,Al=new Ie,ml=new Ie,gl=new Ie,Bf=new Ie,Oh=new Ie,Fh=new xt,Nh=new xt,kh=new xt,ZA=new Ie,$A=new Ie,em=new Ie,Uh=new Ie,Gh=new Ie;class wr extends Ln{constructor(e=new on,i=new Yo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const s=i[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,d=s.length;a<d;a++){const v=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=a}}}}getVertexPosition(e,i){const n=this.geometry,s=n.attributes.position,a=n.morphAttributes.position,d=n.morphTargetsRelative;i.fromBufferAttribute(s,e);const v=this.morphTargetInfluences;if(a&&v){Oh.set(0,0,0);for(let I=0,R=a.length;I<R;I++){const O=v[I],k=a[I];O!==0&&(Bf.fromBufferAttribute(k,e),d?Oh.addScaledVector(Bf,O):Oh.addScaledVector(Bf.sub(i),O))}i.add(Oh)}return i}raycast(e,i){const n=this.geometry,s=this.material,a=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Ph.copy(n.boundingSphere),Ph.applyMatrix4(a),Ma.copy(e.ray).recast(e.near),!(Ph.containsPoint(Ma.origin)===!1&&(Ma.intersectSphere(Ph,JA)===null||Ma.origin.distanceToSquared(JA)>(e.far-e.near)**2))&&(qA.copy(a).invert(),Ma.copy(e.ray).applyMatrix4(qA),!(n.boundingBox!==null&&Ma.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,i,Ma)))}_computeIntersections(e,i,n){let s;const a=this.geometry,d=this.material,v=a.index,I=a.attributes.position,R=a.attributes.uv,O=a.attributes.uv1,k=a.attributes.normal,G=a.groups,z=a.drawRange;if(v!==null)if(Array.isArray(d))for(let K=0,ee=G.length;K<ee;K++){const X=G[K],Q=d[X.materialIndex],ge=Math.max(X.start,z.start),Ae=Math.min(v.count,Math.min(X.start+X.count,z.start+z.count));for(let he=ge,Qe=Ae;he<Qe;he+=3){const Be=v.getX(he),Oe=v.getX(he+1),Ve=v.getX(he+2);s=Vh(this,Q,e,n,R,O,k,Be,Oe,Ve),s&&(s.faceIndex=Math.floor(he/3),s.face.materialIndex=X.materialIndex,i.push(s))}}else{const K=Math.max(0,z.start),ee=Math.min(v.count,z.start+z.count);for(let X=K,Q=ee;X<Q;X+=3){const ge=v.getX(X),Ae=v.getX(X+1),he=v.getX(X+2);s=Vh(this,d,e,n,R,O,k,ge,Ae,he),s&&(s.faceIndex=Math.floor(X/3),i.push(s))}}else if(I!==void 0)if(Array.isArray(d))for(let K=0,ee=G.length;K<ee;K++){const X=G[K],Q=d[X.materialIndex],ge=Math.max(X.start,z.start),Ae=Math.min(I.count,Math.min(X.start+X.count,z.start+z.count));for(let he=ge,Qe=Ae;he<Qe;he+=3){const Be=he,Oe=he+1,Ve=he+2;s=Vh(this,Q,e,n,R,O,k,Be,Oe,Ve),s&&(s.faceIndex=Math.floor(he/3),s.face.materialIndex=X.materialIndex,i.push(s))}}else{const K=Math.max(0,z.start),ee=Math.min(I.count,z.start+z.count);for(let X=K,Q=ee;X<Q;X+=3){const ge=X,Ae=X+1,he=X+2;s=Vh(this,d,e,n,R,O,k,ge,Ae,he),s&&(s.faceIndex=Math.floor(X/3),i.push(s))}}}}function Dy(l,e,i,n,s,a,d,v){let I;if(e.side===L?I=n.intersectTriangle(d,a,s,!0,v):I=n.intersectTriangle(s,a,d,e.side===S,v),I===null)return null;Gh.copy(v),Gh.applyMatrix4(l.matrixWorld);const R=i.ray.origin.distanceTo(Gh);return R<i.near||R>i.far?null:{distance:R,point:Gh.clone(),object:l}}function Vh(l,e,i,n,s,a,d,v,I,R){l.getVertexPosition(v,Al),l.getVertexPosition(I,ml),l.getVertexPosition(R,gl);const O=Dy(l,e,i,n,Al,ml,gl,Uh);if(O){s&&(Fh.fromBufferAttribute(s,v),Nh.fromBufferAttribute(s,I),kh.fromBufferAttribute(s,R),O.uv=Bs.getInterpolation(Uh,Al,ml,gl,Fh,Nh,kh,new xt)),a&&(Fh.fromBufferAttribute(a,v),Nh.fromBufferAttribute(a,I),kh.fromBufferAttribute(a,R),O.uv1=Bs.getInterpolation(Uh,Al,ml,gl,Fh,Nh,kh,new xt)),d&&(ZA.fromBufferAttribute(d,v),$A.fromBufferAttribute(d,I),em.fromBufferAttribute(d,R),O.normal=Bs.getInterpolation(Uh,Al,ml,gl,ZA,$A,em,new Ie),O.normal.dot(n.direction)>0&&O.normal.multiplyScalar(-1));const k={a:v,b:I,c:R,normal:new Ie,materialIndex:0};Bs.getNormal(Al,ml,gl,k.normal),O.face=k}return O}class _a extends on{constructor(e=1,i=1,n=1,s=1,a=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:n,widthSegments:s,heightSegments:a,depthSegments:d};const v=this;s=Math.floor(s),a=Math.floor(a),d=Math.floor(d);const I=[],R=[],O=[],k=[];let G=0,z=0;K("z","y","x",-1,-1,n,i,e,d,a,0),K("z","y","x",1,-1,n,i,-e,d,a,1),K("x","z","y",1,1,e,n,i,s,d,2),K("x","z","y",1,-1,e,n,-i,s,d,3),K("x","y","z",1,-1,e,i,n,s,a,4),K("x","y","z",-1,-1,e,i,-n,s,a,5),this.setIndex(I),this.setAttribute("position",new xi(R,3)),this.setAttribute("normal",new xi(O,3)),this.setAttribute("uv",new xi(k,2));function K(ee,X,Q,ge,Ae,he,Qe,Be,Oe,Ve,_e){const xe=he/Oe,ze=Qe/Ve,qe=he/2,Ke=Qe/2,$e=Be/2,at=Oe+1,vt=Ve+1;let jt=0,ct=0;const Ut=new Ie;for(let Qt=0;Qt<vt;Qt++){const fi=Qt*ze-Ke;for(let an=0;an<at;an++){const Nn=an*xe-qe;Ut[ee]=Nn*ge,Ut[X]=fi*Ae,Ut[Q]=$e,R.push(Ut.x,Ut.y,Ut.z),Ut[ee]=0,Ut[X]=0,Ut[Q]=Be>0?1:-1,O.push(Ut.x,Ut.y,Ut.z),k.push(an/Oe),k.push(1-Qt/Ve),jt+=1}}for(let Qt=0;Qt<Ve;Qt++)for(let fi=0;fi<Oe;fi++){const an=G+fi+at*Qt,Nn=G+fi+at*(Qt+1),$n=G+(fi+1)+at*(Qt+1),Dn=G+(fi+1)+at*Qt;I.push(an,Nn,Dn),I.push(Nn,$n,Dn),ct+=6}v.addGroup(z,ct,_e),z+=ct,G+=jt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _a(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function vl(l){const e={};for(const i in l){e[i]={};for(const n in l[i]){const s=l[i][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][n]=null):e[i][n]=s.clone():Array.isArray(s)?e[i][n]=s.slice():e[i][n]=s}}return e}function hs(l){const e={};for(let i=0;i<l.length;i++){const n=vl(l[i]);for(const s in n)e[s]=n[s]}return e}function Py(l){const e=[];for(let i=0;i<l.length;i++)e.push(l[i].clone());return e}function tm(l){const e=l.getRenderTarget();return e===null?l.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Fn.workingColorSpace}const im={clone:vl,merge:hs};var Oy=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Fy=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Xs extends $r{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Oy,this.fragmentShader=Fy,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=vl(e.uniforms),this.uniformsGroups=Py(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const s in this.uniforms){const d=this.uniforms[s].value;d&&d.isTexture?i.uniforms[s]={type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?i.uniforms[s]={type:"c",value:d.getHex()}:d&&d.isVector2?i.uniforms[s]={type:"v2",value:d.toArray()}:d&&d.isVector3?i.uniforms[s]={type:"v3",value:d.toArray()}:d&&d.isVector4?i.uniforms[s]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?i.uniforms[s]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?i.uniforms[s]={type:"m4",value:d.toArray()}:i.uniforms[s]={value:d}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class zh extends Ln{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new mi,this.projectionMatrix=new mi,this.projectionMatrixInverse=new mi,this.coordinateSystem=Ns}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const qo=new Ie,nm=new xt,rm=new xt;class Rr extends zh{constructor(e=50,i=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=zo*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Eo*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return zo*2*Math.atan(Math.tan(Eo*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,i,n){qo.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(qo.x,qo.y).multiplyScalar(-e/qo.z),qo.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(qo.x,qo.y).multiplyScalar(-e/qo.z)}getViewSize(e,i){return this.getViewBounds(e,nm,rm),i.subVectors(rm,nm)}setViewOffset(e,i,n,s,a,d){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=s,this.view.width=a,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(Eo*.5*this.fov)/this.zoom,n=2*i,s=this.aspect*n,a=-.5*s;const d=this.view;if(this.view!==null&&this.view.enabled){const I=d.fullWidth,R=d.fullHeight;a+=d.offsetX*s/I,i-=d.offsetY*n/R,s*=d.width/I,n*=d.height/R}const v=this.filmOffset;v!==0&&(a+=e*v/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+s,i,i-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const yl=-90,El=1;class sm extends Ln{constructor(e,i,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Rr(yl,El,e,i);s.layers=this.layers,this.add(s);const a=new Rr(yl,El,e,i);a.layers=this.layers,this.add(a);const d=new Rr(yl,El,e,i);d.layers=this.layers,this.add(d);const v=new Rr(yl,El,e,i);v.layers=this.layers,this.add(v);const I=new Rr(yl,El,e,i);I.layers=this.layers,this.add(I);const R=new Rr(yl,El,e,i);R.layers=this.layers,this.add(R)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[n,s,a,d,v,I]=i;for(const R of i)this.remove(R);if(e===Ns)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),v.up.set(0,1,0),v.lookAt(0,0,1),I.up.set(0,1,0),I.lookAt(0,0,-1);else if(e===Ca)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),v.up.set(0,-1,0),v.lookAt(0,0,1),I.up.set(0,-1,0),I.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const R of i)this.add(R),R.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,d,v,I,R,O]=this.children,k=e.getRenderTarget(),G=e.getActiveCubeFace(),z=e.getActiveMipmapLevel(),K=e.xr.enabled;e.xr.enabled=!1;const ee=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(i,a),e.setRenderTarget(n,1,s),e.render(i,d),e.setRenderTarget(n,2,s),e.render(i,v),e.setRenderTarget(n,3,s),e.render(i,I),e.setRenderTarget(n,4,s),e.render(i,R),n.texture.generateMipmaps=ee,e.setRenderTarget(n,5,s),e.render(i,O),e.setRenderTarget(k,G,z),e.xr.enabled=K,n.texture.needsPMREMUpdate=!0}}class yc extends qn{constructor(e,i,n,s,a,d,v,I,R,O){e=e!==void 0?e:[],i=i!==void 0?i:$,super(e,i,n,s,a,d,v,I,R,O),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class om extends ys{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new yc(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:wi}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new _a(5,5,5),a=new Xs({name:"CubemapFromEquirect",uniforms:vl(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:L,blending:D});a.uniforms.tEquirect.value=i;const d=new wr(s,a),v=i.minFilter;return i.minFilter===In&&(i.minFilter=wi),new sm(1,10,this).update(e,d),i.minFilter=v,d.geometry.dispose(),d.material.dispose(),this}clear(e,i,n,s){const a=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(i,n,s);e.setRenderTarget(a)}}const Rf=new Ie,Ny=new Ie,ky=new ji;class Jo{constructor(e=new Ie(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,n,s){return this.normal.set(e,i,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,n){const s=Rf.subVectors(n,i).cross(Ny.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const n=e.delta(Rf),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/s;return a<0||a>1?null:i.copy(e.start).addScaledVector(n,a)}intersectsLine(e){const i=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return i<0&&n>0||n<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const n=i||ky.getNormalMatrix(e),s=this.coplanarPoint(Rf).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Sa=new Ir,Qh=new Ie;class Ec{constructor(e=new Jo,i=new Jo,n=new Jo,s=new Jo,a=new Jo,d=new Jo){this.planes=[e,i,n,s,a,d]}set(e,i,n,s,a,d){const v=this.planes;return v[0].copy(e),v[1].copy(i),v[2].copy(n),v[3].copy(s),v[4].copy(a),v[5].copy(d),this}copy(e){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,i=Ns){const n=this.planes,s=e.elements,a=s[0],d=s[1],v=s[2],I=s[3],R=s[4],O=s[5],k=s[6],G=s[7],z=s[8],K=s[9],ee=s[10],X=s[11],Q=s[12],ge=s[13],Ae=s[14],he=s[15];if(n[0].setComponents(I-a,G-R,X-z,he-Q).normalize(),n[1].setComponents(I+a,G+R,X+z,he+Q).normalize(),n[2].setComponents(I+d,G+O,X+K,he+ge).normalize(),n[3].setComponents(I-d,G-O,X-K,he-ge).normalize(),n[4].setComponents(I-v,G-k,X-ee,he-Ae).normalize(),i===Ns)n[5].setComponents(I+v,G+k,X+ee,he+Ae).normalize();else if(i===Ca)n[5].setComponents(v,k,ee,Ae).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Sa.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Sa.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Sa)}intersectsSprite(e){return Sa.center.set(0,0,0),Sa.radius=.7071067811865476,Sa.applyMatrix4(e.matrixWorld),this.intersectsSphere(Sa)}intersectsSphere(e){const i=this.planes,n=e.center,s=-e.radius;for(let a=0;a<6;a++)if(i[a].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const i=this.planes;for(let n=0;n<6;n++){const s=i[n];if(Qh.x=s.normal.x>0?e.max.x:e.min.x,Qh.y=s.normal.y>0?e.max.y:e.min.y,Qh.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Qh)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Lf(){let l=null,e=!1,i=null,n=null;function s(a,d){i(a,d),n=l.requestAnimationFrame(s)}return{start:function(){e!==!0&&i!==null&&(n=l.requestAnimationFrame(s),e=!0)},stop:function(){l.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(a){i=a},setContext:function(a){l=a}}}function Uy(l){const e=new WeakMap;function i(v,I){const R=v.array,O=v.usage,k=R.byteLength,G=l.createBuffer();l.bindBuffer(I,G),l.bufferData(I,R,O),v.onUploadCallback();let z;if(R instanceof Float32Array)z=l.FLOAT;else if(R instanceof Uint16Array)v.isFloat16BufferAttribute?z=l.HALF_FLOAT:z=l.UNSIGNED_SHORT;else if(R instanceof Int16Array)z=l.SHORT;else if(R instanceof Uint32Array)z=l.UNSIGNED_INT;else if(R instanceof Int32Array)z=l.INT;else if(R instanceof Int8Array)z=l.BYTE;else if(R instanceof Uint8Array)z=l.UNSIGNED_BYTE;else if(R instanceof Uint8ClampedArray)z=l.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+R);return{buffer:G,type:z,bytesPerElement:R.BYTES_PER_ELEMENT,version:v.version,size:k}}function n(v,I,R){const O=I.array,k=I._updateRange,G=I.updateRanges;if(l.bindBuffer(R,v),k.count===-1&&G.length===0&&l.bufferSubData(R,0,O),G.length!==0){for(let z=0,K=G.length;z<K;z++){const ee=G[z];l.bufferSubData(R,ee.start*O.BYTES_PER_ELEMENT,O,ee.start,ee.count)}I.clearUpdateRanges()}k.count!==-1&&(l.bufferSubData(R,k.offset*O.BYTES_PER_ELEMENT,O,k.offset,k.count),k.count=-1),I.onUploadCallback()}function s(v){return v.isInterleavedBufferAttribute&&(v=v.data),e.get(v)}function a(v){v.isInterleavedBufferAttribute&&(v=v.data);const I=e.get(v);I&&(l.deleteBuffer(I.buffer),e.delete(v))}function d(v,I){if(v.isGLBufferAttribute){const O=e.get(v);(!O||O.version<v.version)&&e.set(v,{buffer:v.buffer,type:v.type,bytesPerElement:v.elementSize,version:v.version});return}v.isInterleavedBufferAttribute&&(v=v.data);const R=e.get(v);if(R===void 0)e.set(v,i(v,I));else if(R.version<v.version){if(R.size!==v.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(R.buffer,v,I),R.version=v.version}}return{get:s,remove:a,update:d}}class xl extends on{constructor(e=1,i=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:n,heightSegments:s};const a=e/2,d=i/2,v=Math.floor(n),I=Math.floor(s),R=v+1,O=I+1,k=e/v,G=i/I,z=[],K=[],ee=[],X=[];for(let Q=0;Q<O;Q++){const ge=Q*G-d;for(let Ae=0;Ae<R;Ae++){const he=Ae*k-a;K.push(he,-ge,0),ee.push(0,0,1),X.push(Ae/v),X.push(1-Q/I)}}for(let Q=0;Q<I;Q++)for(let ge=0;ge<v;ge++){const Ae=ge+R*Q,he=ge+R*(Q+1),Qe=ge+1+R*(Q+1),Be=ge+1+R*Q;z.push(Ae,he,Be),z.push(he,Qe,Be)}this.setIndex(z),this.setAttribute("position",new xi(K,3)),this.setAttribute("normal",new xi(ee,3)),this.setAttribute("uv",new xi(X,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xl(e.width,e.height,e.widthSegments,e.heightSegments)}}var Gy=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Vy=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,zy=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Qy=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Hy=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,jy=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Wy=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Ky=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Xy=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Yy=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,qy=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Jy=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Zy=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,$y=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,e1=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,t1=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,i1=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,n1=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,r1=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,s1=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,o1=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,a1=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,l1=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,c1=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,h1=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,u1=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,d1=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,f1=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,p1=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,A1=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,m1="gl_FragColor = linearToOutputTexel( gl_FragColor );",g1=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,v1=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,y1=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,E1=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,x1=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,C1=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,b1=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,w1=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,M1=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_1=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,S1=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,T1=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,I1=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,B1=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,R1=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,L1=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,D1=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,P1=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,O1=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,F1=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,N1=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,k1=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,U1=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,G1=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,V1=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,z1=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Q1=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,H1=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,j1=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,W1=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,K1=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,X1=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Y1=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,q1=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,J1=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Z1=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,$1=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,eE=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,tE=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,iE=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,nE=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,rE=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,sE=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,oE=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,aE=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,lE=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,cE=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,hE=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,uE=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,dE=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,fE=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,pE=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,AE=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,mE=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,gE=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,vE=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,yE=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,EE=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,xE=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,CE=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,bE=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,wE=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ME=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_E=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,SE=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,TE=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,IE=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,BE=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,RE=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,LE=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,DE=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,PE=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,OE=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,FE=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,NE=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,kE=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const tn={alphahash_fragment:Gy,alphahash_pars_fragment:Vy,alphamap_fragment:zy,alphamap_pars_fragment:Qy,alphatest_fragment:Hy,alphatest_pars_fragment:jy,aomap_fragment:Wy,aomap_pars_fragment:Ky,batching_pars_vertex:Xy,batching_vertex:Yy,begin_vertex:qy,beginnormal_vertex:Jy,bsdfs:Zy,iridescence_fragment:$y,bumpmap_pars_fragment:e1,clipping_planes_fragment:t1,clipping_planes_pars_fragment:i1,clipping_planes_pars_vertex:n1,clipping_planes_vertex:r1,color_fragment:s1,color_pars_fragment:o1,color_pars_vertex:a1,color_vertex:l1,common:c1,cube_uv_reflection_fragment:h1,defaultnormal_vertex:u1,displacementmap_pars_vertex:d1,displacementmap_vertex:f1,emissivemap_fragment:p1,emissivemap_pars_fragment:A1,colorspace_fragment:m1,colorspace_pars_fragment:g1,envmap_fragment:v1,envmap_common_pars_fragment:y1,envmap_pars_fragment:E1,envmap_pars_vertex:x1,envmap_physical_pars_fragment:L1,envmap_vertex:C1,fog_vertex:b1,fog_pars_vertex:w1,fog_fragment:M1,fog_pars_fragment:_1,gradientmap_pars_fragment:S1,lightmap_pars_fragment:T1,lights_lambert_fragment:I1,lights_lambert_pars_fragment:B1,lights_pars_begin:R1,lights_toon_fragment:D1,lights_toon_pars_fragment:P1,lights_phong_fragment:O1,lights_phong_pars_fragment:F1,lights_physical_fragment:N1,lights_physical_pars_fragment:k1,lights_fragment_begin:U1,lights_fragment_maps:G1,lights_fragment_end:V1,logdepthbuf_fragment:z1,logdepthbuf_pars_fragment:Q1,logdepthbuf_pars_vertex:H1,logdepthbuf_vertex:j1,map_fragment:W1,map_pars_fragment:K1,map_particle_fragment:X1,map_particle_pars_fragment:Y1,metalnessmap_fragment:q1,metalnessmap_pars_fragment:J1,morphinstance_vertex:Z1,morphcolor_vertex:$1,morphnormal_vertex:eE,morphtarget_pars_vertex:tE,morphtarget_vertex:iE,normal_fragment_begin:nE,normal_fragment_maps:rE,normal_pars_fragment:sE,normal_pars_vertex:oE,normal_vertex:aE,normalmap_pars_fragment:lE,clearcoat_normal_fragment_begin:cE,clearcoat_normal_fragment_maps:hE,clearcoat_pars_fragment:uE,iridescence_pars_fragment:dE,opaque_fragment:fE,packing:pE,premultiplied_alpha_fragment:AE,project_vertex:mE,dithering_fragment:gE,dithering_pars_fragment:vE,roughnessmap_fragment:yE,roughnessmap_pars_fragment:EE,shadowmap_pars_fragment:xE,shadowmap_pars_vertex:CE,shadowmap_vertex:bE,shadowmask_pars_fragment:wE,skinbase_vertex:ME,skinning_pars_vertex:_E,skinning_vertex:SE,skinnormal_vertex:TE,specularmap_fragment:IE,specularmap_pars_fragment:BE,tonemapping_fragment:RE,tonemapping_pars_fragment:LE,transmission_fragment:DE,transmission_pars_fragment:PE,uv_pars_fragment:OE,uv_pars_vertex:FE,uv_vertex:NE,worldpos_vertex:kE,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},Jt={common:{diffuse:{value:new li(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ji},alphaMap:{value:null},alphaMapTransform:{value:new ji},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ji}},envmap:{envMap:{value:null},envMapRotation:{value:new ji},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ji}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ji}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ji},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ji},normalScale:{value:new xt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ji},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ji}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ji}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ji}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new li(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new li(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ji},alphaTest:{value:0},uvTransform:{value:new ji}},sprite:{diffuse:{value:new li(16777215)},opacity:{value:1},center:{value:new xt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ji},alphaMap:{value:null},alphaMapTransform:{value:new ji},alphaTest:{value:0}}},Ys={basic:{uniforms:hs([Jt.common,Jt.specularmap,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.fog]),vertexShader:tn.meshbasic_vert,fragmentShader:tn.meshbasic_frag},lambert:{uniforms:hs([Jt.common,Jt.specularmap,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.fog,Jt.lights,{emissive:{value:new li(0)}}]),vertexShader:tn.meshlambert_vert,fragmentShader:tn.meshlambert_frag},phong:{uniforms:hs([Jt.common,Jt.specularmap,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.fog,Jt.lights,{emissive:{value:new li(0)},specular:{value:new li(1118481)},shininess:{value:30}}]),vertexShader:tn.meshphong_vert,fragmentShader:tn.meshphong_frag},standard:{uniforms:hs([Jt.common,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.roughnessmap,Jt.metalnessmap,Jt.fog,Jt.lights,{emissive:{value:new li(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag},toon:{uniforms:hs([Jt.common,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.gradientmap,Jt.fog,Jt.lights,{emissive:{value:new li(0)}}]),vertexShader:tn.meshtoon_vert,fragmentShader:tn.meshtoon_frag},matcap:{uniforms:hs([Jt.common,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.fog,{matcap:{value:null}}]),vertexShader:tn.meshmatcap_vert,fragmentShader:tn.meshmatcap_frag},points:{uniforms:hs([Jt.points,Jt.fog]),vertexShader:tn.points_vert,fragmentShader:tn.points_frag},dashed:{uniforms:hs([Jt.common,Jt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tn.linedashed_vert,fragmentShader:tn.linedashed_frag},depth:{uniforms:hs([Jt.common,Jt.displacementmap]),vertexShader:tn.depth_vert,fragmentShader:tn.depth_frag},normal:{uniforms:hs([Jt.common,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,{opacity:{value:1}}]),vertexShader:tn.meshnormal_vert,fragmentShader:tn.meshnormal_frag},sprite:{uniforms:hs([Jt.sprite,Jt.fog]),vertexShader:tn.sprite_vert,fragmentShader:tn.sprite_frag},background:{uniforms:{uvTransform:{value:new ji},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:tn.background_vert,fragmentShader:tn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ji}},vertexShader:tn.backgroundCube_vert,fragmentShader:tn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:tn.cube_vert,fragmentShader:tn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tn.equirect_vert,fragmentShader:tn.equirect_frag},distanceRGBA:{uniforms:hs([Jt.common,Jt.displacementmap,{referencePosition:{value:new Ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tn.distanceRGBA_vert,fragmentShader:tn.distanceRGBA_frag},shadow:{uniforms:hs([Jt.lights,Jt.fog,{color:{value:new li(0)},opacity:{value:1}}]),vertexShader:tn.shadow_vert,fragmentShader:tn.shadow_frag}};Ys.physical={uniforms:hs([Ys.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ji},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ji},clearcoatNormalScale:{value:new xt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ji},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ji},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ji},sheen:{value:0},sheenColor:{value:new li(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ji},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ji},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ji},transmissionSamplerSize:{value:new xt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ji},attenuationDistance:{value:0},attenuationColor:{value:new li(0)},specularColor:{value:new li(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ji},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ji},anisotropyVector:{value:new xt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ji}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag};const Hh={r:0,b:0,g:0},Ta=new Is,UE=new mi;function GE(l,e,i,n,s,a,d){const v=new li(0);let I=a===!0?0:1,R,O,k=null,G=0,z=null;function K(ge){let Ae=ge.isScene===!0?ge.background:null;return Ae&&Ae.isTexture&&(Ae=(ge.backgroundBlurriness>0?i:e).get(Ae)),Ae}function ee(ge){let Ae=!1;const he=K(ge);he===null?Q(v,I):he&&he.isColor&&(Q(he,1),Ae=!0);const Qe=l.xr.getEnvironmentBlendMode();Qe==="additive"?n.buffers.color.setClear(0,0,0,1,d):Qe==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,d),(l.autoClear||Ae)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil)}function X(ge,Ae){const he=K(Ae);he&&(he.isCubeTexture||he.mapping===be)?(O===void 0&&(O=new wr(new _a(1e4,1e4,1e4),new Xs({name:"BackgroundCubeMaterial",uniforms:vl(Ys.backgroundCube.uniforms),vertexShader:Ys.backgroundCube.vertexShader,fragmentShader:Ys.backgroundCube.fragmentShader,side:L,depthTest:!1,depthWrite:!1,fog:!1})),O.geometry.deleteAttribute("normal"),O.geometry.deleteAttribute("uv"),O.onBeforeRender=function(Qe,Be,Oe){this.matrixWorld.copyPosition(Oe.matrixWorld)},Object.defineProperty(O.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(O)),Ta.copy(Ae.backgroundRotation),Ta.x*=-1,Ta.y*=-1,Ta.z*=-1,he.isCubeTexture&&he.isRenderTargetTexture===!1&&(Ta.y*=-1,Ta.z*=-1),O.material.uniforms.envMap.value=he,O.material.uniforms.flipEnvMap.value=he.isCubeTexture&&he.isRenderTargetTexture===!1?-1:1,O.material.uniforms.backgroundBlurriness.value=Ae.backgroundBlurriness,O.material.uniforms.backgroundIntensity.value=Ae.backgroundIntensity,O.material.uniforms.backgroundRotation.value.setFromMatrix4(UE.makeRotationFromEuler(Ta)),O.material.toneMapped=Fn.getTransfer(he.colorSpace)!==jn,(k!==he||G!==he.version||z!==l.toneMapping)&&(O.material.needsUpdate=!0,k=he,G=he.version,z=l.toneMapping),O.layers.enableAll(),ge.unshift(O,O.geometry,O.material,0,0,null)):he&&he.isTexture&&(R===void 0&&(R=new wr(new xl(2,2),new Xs({name:"BackgroundMaterial",uniforms:vl(Ys.background.uniforms),vertexShader:Ys.background.vertexShader,fragmentShader:Ys.background.fragmentShader,side:S,depthTest:!1,depthWrite:!1,fog:!1})),R.geometry.deleteAttribute("normal"),Object.defineProperty(R.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(R)),R.material.uniforms.t2D.value=he,R.material.uniforms.backgroundIntensity.value=Ae.backgroundIntensity,R.material.toneMapped=Fn.getTransfer(he.colorSpace)!==jn,he.matrixAutoUpdate===!0&&he.updateMatrix(),R.material.uniforms.uvTransform.value.copy(he.matrix),(k!==he||G!==he.version||z!==l.toneMapping)&&(R.material.needsUpdate=!0,k=he,G=he.version,z=l.toneMapping),R.layers.enableAll(),ge.unshift(R,R.geometry,R.material,0,0,null))}function Q(ge,Ae){ge.getRGB(Hh,tm(l)),n.buffers.color.setClear(Hh.r,Hh.g,Hh.b,Ae,d)}return{getClearColor:function(){return v},setClearColor:function(ge,Ae=1){v.set(ge),I=Ae,Q(v,I)},getClearAlpha:function(){return I},setClearAlpha:function(ge){I=ge,Q(v,I)},render:ee,addToRenderList:X}}function VE(l,e){const i=l.getParameter(l.MAX_VERTEX_ATTRIBS),n={},s=G(null);let a=s,d=!1;function v(xe,ze,qe,Ke,$e){let at=!1;const vt=k(Ke,qe,ze);a!==vt&&(a=vt,R(a.object)),at=z(xe,Ke,qe,$e),at&&K(xe,Ke,qe,$e),$e!==null&&e.update($e,l.ELEMENT_ARRAY_BUFFER),(at||d)&&(d=!1,he(xe,ze,qe,Ke),$e!==null&&l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,e.get($e).buffer))}function I(){return l.createVertexArray()}function R(xe){return l.bindVertexArray(xe)}function O(xe){return l.deleteVertexArray(xe)}function k(xe,ze,qe){const Ke=qe.wireframe===!0;let $e=n[xe.id];$e===void 0&&($e={},n[xe.id]=$e);let at=$e[ze.id];at===void 0&&(at={},$e[ze.id]=at);let vt=at[Ke];return vt===void 0&&(vt=G(I()),at[Ke]=vt),vt}function G(xe){const ze=[],qe=[],Ke=[];for(let $e=0;$e<i;$e++)ze[$e]=0,qe[$e]=0,Ke[$e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ze,enabledAttributes:qe,attributeDivisors:Ke,object:xe,attributes:{},index:null}}function z(xe,ze,qe,Ke){const $e=a.attributes,at=ze.attributes;let vt=0;const jt=qe.getAttributes();for(const ct in jt)if(jt[ct].location>=0){const Qt=$e[ct];let fi=at[ct];if(fi===void 0&&(ct==="instanceMatrix"&&xe.instanceMatrix&&(fi=xe.instanceMatrix),ct==="instanceColor"&&xe.instanceColor&&(fi=xe.instanceColor)),Qt===void 0||Qt.attribute!==fi||fi&&Qt.data!==fi.data)return!0;vt++}return a.attributesNum!==vt||a.index!==Ke}function K(xe,ze,qe,Ke){const $e={},at=ze.attributes;let vt=0;const jt=qe.getAttributes();for(const ct in jt)if(jt[ct].location>=0){let Qt=at[ct];Qt===void 0&&(ct==="instanceMatrix"&&xe.instanceMatrix&&(Qt=xe.instanceMatrix),ct==="instanceColor"&&xe.instanceColor&&(Qt=xe.instanceColor));const fi={};fi.attribute=Qt,Qt&&Qt.data&&(fi.data=Qt.data),$e[ct]=fi,vt++}a.attributes=$e,a.attributesNum=vt,a.index=Ke}function ee(){const xe=a.newAttributes;for(let ze=0,qe=xe.length;ze<qe;ze++)xe[ze]=0}function X(xe){Q(xe,0)}function Q(xe,ze){const qe=a.newAttributes,Ke=a.enabledAttributes,$e=a.attributeDivisors;qe[xe]=1,Ke[xe]===0&&(l.enableVertexAttribArray(xe),Ke[xe]=1),$e[xe]!==ze&&(l.vertexAttribDivisor(xe,ze),$e[xe]=ze)}function ge(){const xe=a.newAttributes,ze=a.enabledAttributes;for(let qe=0,Ke=ze.length;qe<Ke;qe++)ze[qe]!==xe[qe]&&(l.disableVertexAttribArray(qe),ze[qe]=0)}function Ae(xe,ze,qe,Ke,$e,at,vt){vt===!0?l.vertexAttribIPointer(xe,ze,qe,$e,at):l.vertexAttribPointer(xe,ze,qe,Ke,$e,at)}function he(xe,ze,qe,Ke){ee();const $e=Ke.attributes,at=qe.getAttributes(),vt=ze.defaultAttributeValues;for(const jt in at){const ct=at[jt];if(ct.location>=0){let Ut=$e[jt];if(Ut===void 0&&(jt==="instanceMatrix"&&xe.instanceMatrix&&(Ut=xe.instanceMatrix),jt==="instanceColor"&&xe.instanceColor&&(Ut=xe.instanceColor)),Ut!==void 0){const Qt=Ut.normalized,fi=Ut.itemSize,an=e.get(Ut);if(an===void 0)continue;const Nn=an.buffer,$n=an.type,Dn=an.bytesPerElement,Wn=$n===l.INT||$n===l.UNSIGNED_INT||Ut.gpuType===gs;if(Ut.isInterleavedBufferAttribute){const vi=Ut.data,bt=vi.stride,Kt=Ut.offset;if(vi.isInstancedInterleavedBuffer){for(let Zt=0;Zt<ct.locationSize;Zt++)Q(ct.location+Zt,vi.meshPerAttribute);xe.isInstancedMesh!==!0&&Ke._maxInstanceCount===void 0&&(Ke._maxInstanceCount=vi.meshPerAttribute*vi.count)}else for(let Zt=0;Zt<ct.locationSize;Zt++)X(ct.location+Zt);l.bindBuffer(l.ARRAY_BUFFER,Nn);for(let Zt=0;Zt<ct.locationSize;Zt++)Ae(ct.location+Zt,fi/ct.locationSize,$n,Qt,bt*Dn,(Kt+fi/ct.locationSize*Zt)*Dn,Wn)}else{if(Ut.isInstancedBufferAttribute){for(let vi=0;vi<ct.locationSize;vi++)Q(ct.location+vi,Ut.meshPerAttribute);xe.isInstancedMesh!==!0&&Ke._maxInstanceCount===void 0&&(Ke._maxInstanceCount=Ut.meshPerAttribute*Ut.count)}else for(let vi=0;vi<ct.locationSize;vi++)X(ct.location+vi);l.bindBuffer(l.ARRAY_BUFFER,Nn);for(let vi=0;vi<ct.locationSize;vi++)Ae(ct.location+vi,fi/ct.locationSize,$n,Qt,fi*Dn,fi/ct.locationSize*vi*Dn,Wn)}}else if(vt!==void 0){const Qt=vt[jt];if(Qt!==void 0)switch(Qt.length){case 2:l.vertexAttrib2fv(ct.location,Qt);break;case 3:l.vertexAttrib3fv(ct.location,Qt);break;case 4:l.vertexAttrib4fv(ct.location,Qt);break;default:l.vertexAttrib1fv(ct.location,Qt)}}}}ge()}function Qe(){Ve();for(const xe in n){const ze=n[xe];for(const qe in ze){const Ke=ze[qe];for(const $e in Ke)O(Ke[$e].object),delete Ke[$e];delete ze[qe]}delete n[xe]}}function Be(xe){if(n[xe.id]===void 0)return;const ze=n[xe.id];for(const qe in ze){const Ke=ze[qe];for(const $e in Ke)O(Ke[$e].object),delete Ke[$e];delete ze[qe]}delete n[xe.id]}function Oe(xe){for(const ze in n){const qe=n[ze];if(qe[xe.id]===void 0)continue;const Ke=qe[xe.id];for(const $e in Ke)O(Ke[$e].object),delete Ke[$e];delete qe[xe.id]}}function Ve(){_e(),d=!0,a!==s&&(a=s,R(a.object))}function _e(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:v,reset:Ve,resetDefaultState:_e,dispose:Qe,releaseStatesOfGeometry:Be,releaseStatesOfProgram:Oe,initAttributes:ee,enableAttribute:X,disableUnusedAttributes:ge}}function zE(l,e,i){let n;function s(R){n=R}function a(R,O){l.drawArrays(n,R,O),i.update(O,n,1)}function d(R,O,k){k!==0&&(l.drawArraysInstanced(n,R,O,k),i.update(O,n,k))}function v(R,O,k){if(k===0)return;const G=e.get("WEBGL_multi_draw");if(G===null)for(let z=0;z<k;z++)this.render(R[z],O[z]);else{G.multiDrawArraysWEBGL(n,R,0,O,0,k);let z=0;for(let K=0;K<k;K++)z+=O[K];i.update(z,n,1)}}function I(R,O,k,G){if(k===0)return;const z=e.get("WEBGL_multi_draw");if(z===null)for(let K=0;K<R.length;K++)d(R[K],O[K],G[K]);else{z.multiDrawArraysInstancedWEBGL(n,R,0,O,0,G,0,k);let K=0;for(let ee=0;ee<k;ee++)K+=O[ee];for(let ee=0;ee<G.length;ee++)i.update(K,n,G[ee])}}this.setMode=s,this.render=a,this.renderInstances=d,this.renderMultiDraw=v,this.renderMultiDrawInstances=I}function QE(l,e,i,n){let s;function a(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const Be=e.get("EXT_texture_filter_anisotropic");s=l.getParameter(Be.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function d(Be){return!(Be!==Ne&&n.convert(Be)!==l.getParameter(l.IMPLEMENTATION_COLOR_READ_FORMAT))}function v(Be){const Oe=Be===Bn&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(Be!==Qn&&n.convert(Be)!==l.getParameter(l.IMPLEMENTATION_COLOR_READ_TYPE)&&Be!==Yn&&!Oe)}function I(Be){if(Be==="highp"){if(l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT).precision>0)return"highp";Be="mediump"}return Be==="mediump"&&l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let R=i.precision!==void 0?i.precision:"highp";const O=I(R);O!==R&&(console.warn("THREE.WebGLRenderer:",R,"not supported, using",O,"instead."),R=O);const k=i.logarithmicDepthBuffer===!0,G=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),z=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),K=l.getParameter(l.MAX_TEXTURE_SIZE),ee=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),X=l.getParameter(l.MAX_VERTEX_ATTRIBS),Q=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),ge=l.getParameter(l.MAX_VARYING_VECTORS),Ae=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),he=z>0,Qe=l.getParameter(l.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:I,textureFormatReadable:d,textureTypeReadable:v,precision:R,logarithmicDepthBuffer:k,maxTextures:G,maxVertexTextures:z,maxTextureSize:K,maxCubemapSize:ee,maxAttributes:X,maxVertexUniforms:Q,maxVaryings:ge,maxFragmentUniforms:Ae,vertexTextures:he,maxSamples:Qe}}function HE(l){const e=this;let i=null,n=0,s=!1,a=!1;const d=new Jo,v=new ji,I={value:null,needsUpdate:!1};this.uniform=I,this.numPlanes=0,this.numIntersection=0,this.init=function(k,G){const z=k.length!==0||G||n!==0||s;return s=G,n=k.length,z},this.beginShadows=function(){a=!0,O(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(k,G){i=O(k,G,0)},this.setState=function(k,G,z){const K=k.clippingPlanes,ee=k.clipIntersection,X=k.clipShadows,Q=l.get(k);if(!s||K===null||K.length===0||a&&!X)a?O(null):R();else{const ge=a?0:n,Ae=ge*4;let he=Q.clippingState||null;I.value=he,he=O(K,G,Ae,z);for(let Qe=0;Qe!==Ae;++Qe)he[Qe]=i[Qe];Q.clippingState=he,this.numIntersection=ee?this.numPlanes:0,this.numPlanes+=ge}};function R(){I.value!==i&&(I.value=i,I.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function O(k,G,z,K){const ee=k!==null?k.length:0;let X=null;if(ee!==0){if(X=I.value,K!==!0||X===null){const Q=z+ee*4,ge=G.matrixWorldInverse;v.getNormalMatrix(ge),(X===null||X.length<Q)&&(X=new Float32Array(Q));for(let Ae=0,he=z;Ae!==ee;++Ae,he+=4)d.copy(k[Ae]).applyMatrix4(ge,v),d.normal.toArray(X,he),X[he+3]=d.constant}I.value=X,I.needsUpdate=!0}return e.numPlanes=ee,e.numIntersection=0,X}}function jE(l){let e=new WeakMap;function i(d,v){return v===V?d.mapping=$:v===fe&&(d.mapping=N),d}function n(d){if(d&&d.isTexture){const v=d.mapping;if(v===V||v===fe)if(e.has(d)){const I=e.get(d).texture;return i(I,d.mapping)}else{const I=d.image;if(I&&I.height>0){const R=new om(I.height);return R.fromEquirectangularTexture(l,d),e.set(d,R),d.addEventListener("dispose",s),i(R.texture,d.mapping)}else return null}}return d}function s(d){const v=d.target;v.removeEventListener("dispose",s);const I=e.get(v);I!==void 0&&(e.delete(v),I.dispose())}function a(){e=new WeakMap}return{get:n,dispose:a}}class jh extends zh{constructor(e=-1,i=1,n=1,s=-1,a=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=n,this.bottom=s,this.near=a,this.far=d,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,n,s,a,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=s,this.view.width=a,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let a=n-e,d=n+e,v=s+i,I=s-i;if(this.view!==null&&this.view.enabled){const R=(this.right-this.left)/this.view.fullWidth/this.zoom,O=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=R*this.view.offsetX,d=a+R*this.view.width,v-=O*this.view.offsetY,I=v-O*this.view.height}this.projectionMatrix.makeOrthographic(a,d,v,I,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const Cl=4,am=[.125,.215,.35,.446,.526,.582],Ia=20,Df=new jh,lm=new li;let Pf=null,Of=0,Ff=0,Nf=!1;const Ba=(1+Math.sqrt(5))/2,bl=1/Ba,cm=[new Ie(-Ba,bl,0),new Ie(Ba,bl,0),new Ie(-bl,0,Ba),new Ie(bl,0,Ba),new Ie(0,Ba,-bl),new Ie(0,Ba,bl),new Ie(-1,1,-1),new Ie(1,1,-1),new Ie(-1,1,1),new Ie(1,1,1)];class kf{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,n=.1,s=100){Pf=this._renderer.getRenderTarget(),Of=this._renderer.getActiveCubeFace(),Ff=this._renderer.getActiveMipmapLevel(),Nf=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,n,s,a),i>0&&this._blur(a,0,0,i),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=dm(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=um(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Pf,Of,Ff),this._renderer.xr.enabled=Nf,e.scissorTest=!1,Wh(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===$||e.mapping===N?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Pf=this._renderer.getRenderTarget(),Of=this._renderer.getActiveCubeFace(),Ff=this._renderer.getActiveMipmapLevel(),Nf=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=i||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:wi,minFilter:wi,generateMipmaps:!1,type:Bn,format:Ne,colorSpace:Ws,depthBuffer:!1},s=hm(e,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=hm(e,i,n);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=WE(a)),this._blurMaterial=KE(a,e,i)}return s}_compileMaterial(e){const i=new wr(this._lodPlanes[0],e);this._renderer.compile(i,Df)}_sceneToCubeUV(e,i,n,s){const v=new Rr(90,1,i,n),I=[1,-1,1,1,1,1],R=[1,1,1,-1,-1,-1],O=this._renderer,k=O.autoClear,G=O.toneMapping;O.getClearColor(lm),O.toneMapping=wn,O.autoClear=!1;const z=new Yo({name:"PMREM.Background",side:L,depthWrite:!1,depthTest:!1}),K=new wr(new _a,z);let ee=!1;const X=e.background;X?X.isColor&&(z.color.copy(X),e.background=null,ee=!0):(z.color.copy(lm),ee=!0);for(let Q=0;Q<6;Q++){const ge=Q%3;ge===0?(v.up.set(0,I[Q],0),v.lookAt(R[Q],0,0)):ge===1?(v.up.set(0,0,I[Q]),v.lookAt(0,R[Q],0)):(v.up.set(0,I[Q],0),v.lookAt(0,0,R[Q]));const Ae=this._cubeSize;Wh(s,ge*Ae,Q>2?Ae:0,Ae,Ae),O.setRenderTarget(s),ee&&O.render(K,v),O.render(e,v)}K.geometry.dispose(),K.material.dispose(),O.toneMapping=G,O.autoClear=k,e.background=X}_textureToCubeUV(e,i){const n=this._renderer,s=e.mapping===$||e.mapping===N;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=dm()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=um());const a=s?this._cubemapMaterial:this._equirectMaterial,d=new wr(this._lodPlanes[0],a),v=a.uniforms;v.envMap.value=e;const I=this._cubeSize;Wh(i,0,0,3*I,2*I),n.setRenderTarget(i),n.render(d,Df)}_applyPMREM(e){const i=this._renderer,n=i.autoClear;i.autoClear=!1;const s=this._lodPlanes.length;for(let a=1;a<s;a++){const d=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),v=cm[(s-a-1)%cm.length];this._blur(e,a-1,a,d,v)}i.autoClear=n}_blur(e,i,n,s,a){const d=this._pingPongRenderTarget;this._halfBlur(e,d,i,n,s,"latitudinal",a),this._halfBlur(d,e,n,n,s,"longitudinal",a)}_halfBlur(e,i,n,s,a,d,v){const I=this._renderer,R=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const O=3,k=new wr(this._lodPlanes[s],R),G=R.uniforms,z=this._sizeLods[n]-1,K=isFinite(a)?Math.PI/(2*z):2*Math.PI/(2*Ia-1),ee=a/K,X=isFinite(a)?1+Math.floor(O*ee):Ia;X>Ia&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${X} samples when the maximum is set to ${Ia}`);const Q=[];let ge=0;for(let Oe=0;Oe<Ia;++Oe){const Ve=Oe/ee,_e=Math.exp(-Ve*Ve/2);Q.push(_e),Oe===0?ge+=_e:Oe<X&&(ge+=2*_e)}for(let Oe=0;Oe<Q.length;Oe++)Q[Oe]=Q[Oe]/ge;G.envMap.value=e.texture,G.samples.value=X,G.weights.value=Q,G.latitudinal.value=d==="latitudinal",v&&(G.poleAxis.value=v);const{_lodMax:Ae}=this;G.dTheta.value=K,G.mipInt.value=Ae-n;const he=this._sizeLods[s],Qe=3*he*(s>Ae-Cl?s-Ae+Cl:0),Be=4*(this._cubeSize-he);Wh(i,Qe,Be,3*he,2*he),I.setRenderTarget(i),I.render(k,Df)}}function WE(l){const e=[],i=[],n=[];let s=l;const a=l-Cl+1+am.length;for(let d=0;d<a;d++){const v=Math.pow(2,s);i.push(v);let I=1/v;d>l-Cl?I=am[d-l+Cl-1]:d===0&&(I=0),n.push(I);const R=1/(v-2),O=-R,k=1+R,G=[O,O,k,O,k,k,O,O,k,k,O,k],z=6,K=6,ee=3,X=2,Q=1,ge=new Float32Array(ee*K*z),Ae=new Float32Array(X*K*z),he=new Float32Array(Q*K*z);for(let Be=0;Be<z;Be++){const Oe=Be%3*2/3-1,Ve=Be>2?0:-1,_e=[Oe,Ve,0,Oe+2/3,Ve,0,Oe+2/3,Ve+1,0,Oe,Ve,0,Oe+2/3,Ve+1,0,Oe,Ve+1,0];ge.set(_e,ee*K*Be),Ae.set(G,X*K*Be);const xe=[Be,Be,Be,Be,Be,Be];he.set(xe,Q*K*Be)}const Qe=new on;Qe.setAttribute("position",new zn(ge,ee)),Qe.setAttribute("uv",new zn(Ae,X)),Qe.setAttribute("faceIndex",new zn(he,Q)),e.push(Qe),s>Cl&&s--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function hm(l,e,i){const n=new ys(l,e,i);return n.texture.mapping=be,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Wh(l,e,i,n,s){l.viewport.set(e,i,n,s),l.scissor.set(e,i,n,s)}function KE(l,e,i){const n=new Float32Array(Ia),s=new Ie(0,1,0);return new Xs({name:"SphericalGaussianBlur",defines:{n:Ia,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${l}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:Uf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:D,depthTest:!1,depthWrite:!1})}function um(){return new Xs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Uf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:D,depthTest:!1,depthWrite:!1})}function dm(){return new Xs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Uf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:D,depthTest:!1,depthWrite:!1})}function Uf(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function XE(l){let e=new WeakMap,i=null;function n(v){if(v&&v.isTexture){const I=v.mapping,R=I===V||I===fe,O=I===$||I===N;if(R||O){let k=e.get(v);const G=k!==void 0?k.texture.pmremVersion:0;if(v.isRenderTargetTexture&&v.pmremVersion!==G)return i===null&&(i=new kf(l)),k=R?i.fromEquirectangular(v,k):i.fromCubemap(v,k),k.texture.pmremVersion=v.pmremVersion,e.set(v,k),k.texture;if(k!==void 0)return k.texture;{const z=v.image;return R&&z&&z.height>0||O&&z&&s(z)?(i===null&&(i=new kf(l)),k=R?i.fromEquirectangular(v):i.fromCubemap(v),k.texture.pmremVersion=v.pmremVersion,e.set(v,k),v.addEventListener("dispose",a),k.texture):null}}}return v}function s(v){let I=0;const R=6;for(let O=0;O<R;O++)v[O]!==void 0&&I++;return I===R}function a(v){const I=v.target;I.removeEventListener("dispose",a);const R=e.get(I);R!==void 0&&(e.delete(I),R.dispose())}function d(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:d}}function YE(l){const e={};function i(n){if(e[n]!==void 0)return e[n];let s;switch(n){case"WEBGL_depth_texture":s=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=l.getExtension(n)}return e[n]=s,s}return{has:function(n){return i(n)!==null},init:function(){i("EXT_color_buffer_float"),i("WEBGL_clip_cull_distance"),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture"),i("WEBGL_render_shared_exponent")},get:function(n){const s=i(n);return s===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function qE(l,e,i,n){const s={},a=new WeakMap;function d(k){const G=k.target;G.index!==null&&e.remove(G.index);for(const K in G.attributes)e.remove(G.attributes[K]);for(const K in G.morphAttributes){const ee=G.morphAttributes[K];for(let X=0,Q=ee.length;X<Q;X++)e.remove(ee[X])}G.removeEventListener("dispose",d),delete s[G.id];const z=a.get(G);z&&(e.remove(z),a.delete(G)),n.releaseStatesOfGeometry(G),G.isInstancedBufferGeometry===!0&&delete G._maxInstanceCount,i.memory.geometries--}function v(k,G){return s[G.id]===!0||(G.addEventListener("dispose",d),s[G.id]=!0,i.memory.geometries++),G}function I(k){const G=k.attributes;for(const K in G)e.update(G[K],l.ARRAY_BUFFER);const z=k.morphAttributes;for(const K in z){const ee=z[K];for(let X=0,Q=ee.length;X<Q;X++)e.update(ee[X],l.ARRAY_BUFFER)}}function R(k){const G=[],z=k.index,K=k.attributes.position;let ee=0;if(z!==null){const ge=z.array;ee=z.version;for(let Ae=0,he=ge.length;Ae<he;Ae+=3){const Qe=ge[Ae+0],Be=ge[Ae+1],Oe=ge[Ae+2];G.push(Qe,Be,Be,Oe,Oe,Qe)}}else if(K!==void 0){const ge=K.array;ee=K.version;for(let Ae=0,he=ge.length/3-1;Ae<he;Ae+=3){const Qe=Ae+0,Be=Ae+1,Oe=Ae+2;G.push(Qe,Be,Be,Oe,Oe,Qe)}}else return;const X=new(xh(G)?Tf:Sf)(G,1);X.version=ee;const Q=a.get(k);Q&&e.remove(Q),a.set(k,X)}function O(k){const G=a.get(k);if(G){const z=k.index;z!==null&&G.version<z.version&&R(k)}else R(k);return a.get(k)}return{get:v,update:I,getWireframeAttribute:O}}function JE(l,e,i){let n;function s(G){n=G}let a,d;function v(G){a=G.type,d=G.bytesPerElement}function I(G,z){l.drawElements(n,z,a,G*d),i.update(z,n,1)}function R(G,z,K){K!==0&&(l.drawElementsInstanced(n,z,a,G*d,K),i.update(z,n,K))}function O(G,z,K){if(K===0)return;const ee=e.get("WEBGL_multi_draw");if(ee===null)for(let X=0;X<K;X++)this.render(G[X]/d,z[X]);else{ee.multiDrawElementsWEBGL(n,z,0,a,G,0,K);let X=0;for(let Q=0;Q<K;Q++)X+=z[Q];i.update(X,n,1)}}function k(G,z,K,ee){if(K===0)return;const X=e.get("WEBGL_multi_draw");if(X===null)for(let Q=0;Q<G.length;Q++)R(G[Q]/d,z[Q],ee[Q]);else{X.multiDrawElementsInstancedWEBGL(n,z,0,a,G,0,ee,0,K);let Q=0;for(let ge=0;ge<K;ge++)Q+=z[ge];for(let ge=0;ge<ee.length;ge++)i.update(Q,n,ee[ge])}}this.setMode=s,this.setIndex=v,this.render=I,this.renderInstances=R,this.renderMultiDraw=O,this.renderMultiDrawInstances=k}function ZE(l){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(a,d,v){switch(i.calls++,d){case l.TRIANGLES:i.triangles+=v*(a/3);break;case l.LINES:i.lines+=v*(a/2);break;case l.LINE_STRIP:i.lines+=v*(a-1);break;case l.LINE_LOOP:i.lines+=v*a;break;case l.POINTS:i.points+=v*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d);break}}function s(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:s,update:n}}function $E(l,e,i){const n=new WeakMap,s=new _n;function a(d,v,I){const R=d.morphTargetInfluences,O=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,k=O!==void 0?O.length:0;let G=n.get(v);if(G===void 0||G.count!==k){let z=function(){Ve.dispose(),n.delete(v),v.removeEventListener("dispose",z)};G!==void 0&&G.texture.dispose();const K=v.morphAttributes.position!==void 0,ee=v.morphAttributes.normal!==void 0,X=v.morphAttributes.color!==void 0,Q=v.morphAttributes.position||[],ge=v.morphAttributes.normal||[],Ae=v.morphAttributes.color||[];let he=0;K===!0&&(he=1),ee===!0&&(he=2),X===!0&&(he=3);let Qe=v.attributes.position.count*he,Be=1;Qe>e.maxTextureSize&&(Be=Math.ceil(Qe/e.maxTextureSize),Qe=e.maxTextureSize);const Oe=new Float32Array(Qe*Be*4*k),Ve=new sl(Oe,Qe,Be,k);Ve.type=Yn,Ve.needsUpdate=!0;const _e=he*4;for(let xe=0;xe<k;xe++){const ze=Q[xe],qe=ge[xe],Ke=Ae[xe],$e=Qe*Be*4*xe;for(let at=0;at<ze.count;at++){const vt=at*_e;K===!0&&(s.fromBufferAttribute(ze,at),Oe[$e+vt+0]=s.x,Oe[$e+vt+1]=s.y,Oe[$e+vt+2]=s.z,Oe[$e+vt+3]=0),ee===!0&&(s.fromBufferAttribute(qe,at),Oe[$e+vt+4]=s.x,Oe[$e+vt+5]=s.y,Oe[$e+vt+6]=s.z,Oe[$e+vt+7]=0),X===!0&&(s.fromBufferAttribute(Ke,at),Oe[$e+vt+8]=s.x,Oe[$e+vt+9]=s.y,Oe[$e+vt+10]=s.z,Oe[$e+vt+11]=Ke.itemSize===4?s.w:1)}}G={count:k,texture:Ve,size:new xt(Qe,Be)},n.set(v,G),v.addEventListener("dispose",z)}if(d.isInstancedMesh===!0&&d.morphTexture!==null)I.getUniforms().setValue(l,"morphTexture",d.morphTexture,i);else{let z=0;for(let ee=0;ee<R.length;ee++)z+=R[ee];const K=v.morphTargetsRelative?1:1-z;I.getUniforms().setValue(l,"morphTargetBaseInfluence",K),I.getUniforms().setValue(l,"morphTargetInfluences",R)}I.getUniforms().setValue(l,"morphTargetsTexture",G.texture,i),I.getUniforms().setValue(l,"morphTargetsTextureSize",G.size)}return{update:a}}class ex{constructor(e,i,n){if(this.renderer=e,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=n,this.extensions=i,this.available=this.extensions.has("OCULUS_multiview"),this.available){const a=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(a.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var s=0;s<this.maxNumViews;s++)this.mat4[s]=new mi,this.mat3[s]=new ji}}getCameraArray(e){return e.isArrayCamera?e.cameras:(this.cameraArray[0]=e,this.cameraArray)}updateCameraProjectionMatricesUniform(e,i){for(var n=this.getCameraArray(e),s=0;s<n.length;s++)this.mat4[s].copy(n[s].projectionMatrix);i.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(e,i){for(var n=this.getCameraArray(e),s=0;s<n.length;s++)this.mat4[s].copy(n[s].matrixWorldInverse);i.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(e,i,n){for(var s=this.getCameraArray(i),a=0;a<s.length;a++)this.mat4[a].multiplyMatrices(s[a].matrixWorldInverse,e.matrixWorld),this.mat3[a].getNormalMatrix(this.mat4[a]);n.setValue(this.gl,"modelViewMatrices",this.mat4),n.setValue(this.gl,"normalMatrices",this.mat3)}}function tx(l,e,i,n){let s=new WeakMap;function a(I){const R=n.render.frame,O=I.geometry,k=e.get(I,O);if(s.get(k)!==R&&(e.update(k),s.set(k,R)),I.isInstancedMesh&&(I.hasEventListener("dispose",v)===!1&&I.addEventListener("dispose",v),s.get(I)!==R&&(i.update(I.instanceMatrix,l.ARRAY_BUFFER),I.instanceColor!==null&&i.update(I.instanceColor,l.ARRAY_BUFFER),s.set(I,R))),I.isSkinnedMesh){const G=I.skeleton;s.get(G)!==R&&(G.update(),s.set(G,R))}return k}function d(){s=new WeakMap}function v(I){const R=I.target;R.removeEventListener("dispose",v),i.remove(R.instanceMatrix),R.instanceColor!==null&&i.remove(R.instanceColor)}return{update:a,dispose:d}}class Gf extends qn{constructor(e,i,n,s,a,d,v,I,R,O){if(O=O!==void 0?O:nt,O!==nt&&O!==At)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&O===nt&&(n=Tr),n===void 0&&O===At&&(n=ss),super(null,s,a,d,v,I,O,n,R),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=v!==void 0?v:zt,this.minFilter=I!==void 0?I:zt,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}const fm=new qn,pm=new Gf(1,1);pm.compareFunction=cc;const Am=new sl,mm=new Wi,gm=new yc,vm=[],ym=[],Em=new Float32Array(16),xm=new Float32Array(9),Cm=new Float32Array(4);function wl(l,e,i){const n=l[0];if(n<=0||n>0)return l;const s=e*i;let a=vm[s];if(a===void 0&&(a=new Float32Array(s),vm[s]=a),e!==0){n.toArray(a,0);for(let d=1,v=0;d!==e;++d)v+=i,l[d].toArray(a,v)}return a}function Lr(l,e){if(l.length!==e.length)return!1;for(let i=0,n=l.length;i<n;i++)if(l[i]!==e[i])return!1;return!0}function Dr(l,e){for(let i=0,n=e.length;i<n;i++)l[i]=e[i]}function Kh(l,e){let i=ym[e];i===void 0&&(i=new Int32Array(e),ym[e]=i);for(let n=0;n!==e;++n)i[n]=l.allocateTextureUnit();return i}function ix(l,e){const i=this.cache;i[0]!==e&&(l.uniform1f(this.addr,e),i[0]=e)}function nx(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(l.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Lr(i,e))return;l.uniform2fv(this.addr,e),Dr(i,e)}}function rx(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(l.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(l.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(Lr(i,e))return;l.uniform3fv(this.addr,e),Dr(i,e)}}function sx(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(l.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Lr(i,e))return;l.uniform4fv(this.addr,e),Dr(i,e)}}function ox(l,e){const i=this.cache,n=e.elements;if(n===void 0){if(Lr(i,e))return;l.uniformMatrix2fv(this.addr,!1,e),Dr(i,e)}else{if(Lr(i,n))return;Cm.set(n),l.uniformMatrix2fv(this.addr,!1,Cm),Dr(i,n)}}function ax(l,e){const i=this.cache,n=e.elements;if(n===void 0){if(Lr(i,e))return;l.uniformMatrix3fv(this.addr,!1,e),Dr(i,e)}else{if(Lr(i,n))return;xm.set(n),l.uniformMatrix3fv(this.addr,!1,xm),Dr(i,n)}}function lx(l,e){const i=this.cache,n=e.elements;if(n===void 0){if(Lr(i,e))return;l.uniformMatrix4fv(this.addr,!1,e),Dr(i,e)}else{if(Lr(i,n))return;Em.set(n),l.uniformMatrix4fv(this.addr,!1,Em),Dr(i,n)}}function cx(l,e){const i=this.cache;i[0]!==e&&(l.uniform1i(this.addr,e),i[0]=e)}function hx(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(l.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Lr(i,e))return;l.uniform2iv(this.addr,e),Dr(i,e)}}function ux(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(l.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Lr(i,e))return;l.uniform3iv(this.addr,e),Dr(i,e)}}function dx(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(l.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Lr(i,e))return;l.uniform4iv(this.addr,e),Dr(i,e)}}function fx(l,e){const i=this.cache;i[0]!==e&&(l.uniform1ui(this.addr,e),i[0]=e)}function px(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(l.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Lr(i,e))return;l.uniform2uiv(this.addr,e),Dr(i,e)}}function Ax(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(l.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Lr(i,e))return;l.uniform3uiv(this.addr,e),Dr(i,e)}}function mx(l,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(l.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Lr(i,e))return;l.uniform4uiv(this.addr,e),Dr(i,e)}}function gx(l,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(l.uniform1i(this.addr,s),n[0]=s);const a=this.type===l.SAMPLER_2D_SHADOW?pm:fm;i.setTexture2D(e||a,s)}function vx(l,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(l.uniform1i(this.addr,s),n[0]=s),i.setTexture3D(e||mm,s)}function yx(l,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(l.uniform1i(this.addr,s),n[0]=s),i.setTextureCube(e||gm,s)}function Ex(l,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(l.uniform1i(this.addr,s),n[0]=s),i.setTexture2DArray(e||Am,s)}function xx(l){switch(l){case 5126:return ix;case 35664:return nx;case 35665:return rx;case 35666:return sx;case 35674:return ox;case 35675:return ax;case 35676:return lx;case 5124:case 35670:return cx;case 35667:case 35671:return hx;case 35668:case 35672:return ux;case 35669:case 35673:return dx;case 5125:return fx;case 36294:return px;case 36295:return Ax;case 36296:return mx;case 35678:case 36198:case 36298:case 36306:case 35682:return gx;case 35679:case 36299:case 36307:return vx;case 35680:case 36300:case 36308:case 36293:return yx;case 36289:case 36303:case 36311:case 36292:return Ex}}function Cx(l,e){l.uniform1fv(this.addr,e)}function bx(l,e){const i=wl(e,this.size,2);l.uniform2fv(this.addr,i)}function wx(l,e){const i=wl(e,this.size,3);l.uniform3fv(this.addr,i)}function Mx(l,e){const i=wl(e,this.size,4);l.uniform4fv(this.addr,i)}function _x(l,e){const i=wl(e,this.size,4);l.uniformMatrix2fv(this.addr,!1,i)}function Sx(l,e){const i=wl(e,this.size,9);l.uniformMatrix3fv(this.addr,!1,i)}function Tx(l,e){const i=wl(e,this.size,16);l.uniformMatrix4fv(this.addr,!1,i)}function Ix(l,e){l.uniform1iv(this.addr,e)}function Bx(l,e){l.uniform2iv(this.addr,e)}function Rx(l,e){l.uniform3iv(this.addr,e)}function Lx(l,e){l.uniform4iv(this.addr,e)}function Dx(l,e){l.uniform1uiv(this.addr,e)}function Px(l,e){l.uniform2uiv(this.addr,e)}function Ox(l,e){l.uniform3uiv(this.addr,e)}function Fx(l,e){l.uniform4uiv(this.addr,e)}function Nx(l,e,i){const n=this.cache,s=e.length,a=Kh(i,s);Lr(n,a)||(l.uniform1iv(this.addr,a),Dr(n,a));for(let d=0;d!==s;++d)i.setTexture2D(e[d]||fm,a[d])}function kx(l,e,i){const n=this.cache,s=e.length,a=Kh(i,s);Lr(n,a)||(l.uniform1iv(this.addr,a),Dr(n,a));for(let d=0;d!==s;++d)i.setTexture3D(e[d]||mm,a[d])}function Ux(l,e,i){const n=this.cache,s=e.length,a=Kh(i,s);Lr(n,a)||(l.uniform1iv(this.addr,a),Dr(n,a));for(let d=0;d!==s;++d)i.setTextureCube(e[d]||gm,a[d])}function Gx(l,e,i){const n=this.cache,s=e.length,a=Kh(i,s);Lr(n,a)||(l.uniform1iv(this.addr,a),Dr(n,a));for(let d=0;d!==s;++d)i.setTexture2DArray(e[d]||Am,a[d])}function Vx(l){switch(l){case 5126:return Cx;case 35664:return bx;case 35665:return wx;case 35666:return Mx;case 35674:return _x;case 35675:return Sx;case 35676:return Tx;case 5124:case 35670:return Ix;case 35667:case 35671:return Bx;case 35668:case 35672:return Rx;case 35669:case 35673:return Lx;case 5125:return Dx;case 36294:return Px;case 36295:return Ox;case 36296:return Fx;case 35678:case 36198:case 36298:case 36306:case 35682:return Nx;case 35679:case 36299:case 36307:return kx;case 35680:case 36300:case 36308:case 36293:return Ux;case 36289:case 36303:case 36311:case 36292:return Gx}}class zx{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.type=i.type,this.setValue=xx(i.type)}}class Qx{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.type=i.type,this.size=i.size,this.setValue=Vx(i.type)}}class Hx{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,n){const s=this.seq;for(let a=0,d=s.length;a!==d;++a){const v=s[a];v.setValue(e,i[v.id],n)}}}const Vf=/(\w+)(\])?(\[|\.)?/g;function bm(l,e){l.seq.push(e),l.map[e.id]=e}function jx(l,e,i){const n=l.name,s=n.length;for(Vf.lastIndex=0;;){const a=Vf.exec(n),d=Vf.lastIndex;let v=a[1];const I=a[2]==="]",R=a[3];if(I&&(v=v|0),R===void 0||R==="["&&d+2===s){bm(i,R===void 0?new zx(v,l,e):new Qx(v,l,e));break}else{let k=i.map[v];k===void 0&&(k=new Hx(v),bm(i,k)),i=k}}}class Xh{constructor(e,i){this.seq=[],this.map={};const n=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const a=e.getActiveUniform(i,s),d=e.getUniformLocation(i,a.name);jx(a,d,this)}}setValue(e,i,n,s){const a=this.map[i];a!==void 0&&a.setValue(e,n,s)}setOptional(e,i,n){const s=i[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,i,n,s){for(let a=0,d=i.length;a!==d;++a){const v=i[a],I=n[v.id];I.needsUpdate!==!1&&v.setValue(e,I.value,s)}}static seqWithValue(e,i){const n=[];for(let s=0,a=e.length;s!==a;++s){const d=e[s];d.id in i&&n.push(d)}return n}}function wm(l,e,i){const n=l.createShader(e);return l.shaderSource(n,i),l.compileShader(n),n}const Wx=37297;let Kx=0;function Xx(l,e){const i=l.split(`
`),n=[],s=Math.max(e-6,0),a=Math.min(e+6,i.length);for(let d=s;d<a;d++){const v=d+1;n.push(`${v===e?">":" "} ${v}: ${i[d]}`)}return n.join(`
`)}function Yx(l){const e=Fn.getPrimaries(Fn.workingColorSpace),i=Fn.getPrimaries(l);let n;switch(e===i?n="":e===Ea&&i===ya?n="LinearDisplayP3ToLinearSRGB":e===ya&&i===Ea&&(n="LinearSRGBToLinearDisplayP3"),l){case Ws:case ga:return[n,"LinearTransferOETF"];case yn:case tl:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",l),[n,"LinearTransferOETF"]}}function Mm(l,e,i){const n=l.getShaderParameter(e,l.COMPILE_STATUS),s=l.getShaderInfoLog(e).trim();if(n&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const d=parseInt(a[1]);return i.toUpperCase()+`

`+s+`

`+Xx(l.getShaderSource(e),d)}else return s}function qx(l,e){const i=Yx(e);return`vec4 ${l}( vec4 value ) { return ${i[0]}( ${i[1]}( value ) ); }`}function Jx(l,e){let i;switch(e){case Cr:i="Linear";break;case ar:i="Reinhard";break;case Tn:i="OptimizedCineon";break;case St:i="ACESFilmic";break;case ve:i="AgX";break;case Le:i="Neutral";break;case ye:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+l+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Zx(l){return[l.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",l.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(xc).join(`
`)}function $x(l){const e=[];for(const i in l){const n=l[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function eC(l,e){const i={},n=l.getProgramParameter(e,l.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const a=l.getActiveAttrib(e,s),d=a.name;let v=1;a.type===l.FLOAT_MAT2&&(v=2),a.type===l.FLOAT_MAT3&&(v=3),a.type===l.FLOAT_MAT4&&(v=4),i[d]={type:a.type,location:l.getAttribLocation(e,d),locationSize:v}}return i}function xc(l){return l!==""}function _m(l,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return l.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Sm(l,e){return l.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const tC=/^[ \t]*#include +<([\w\d./]+)>/gm;function zf(l){return l.replace(tC,nC)}const iC=new Map;function nC(l,e){let i=tn[e];if(i===void 0){const n=iC.get(e);if(n!==void 0)i=tn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return zf(i)}const rC=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Tm(l){return l.replace(rC,sC)}function sC(l,e,i,n){let s="";for(let a=parseInt(e);a<parseInt(i);a++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function Im(l){let e=`precision ${l.precision} float;
	precision ${l.precision} int;
	precision ${l.precision} sampler2D;
	precision ${l.precision} samplerCube;
	precision ${l.precision} sampler3D;
	precision ${l.precision} sampler2DArray;
	precision ${l.precision} sampler2DShadow;
	precision ${l.precision} samplerCubeShadow;
	precision ${l.precision} sampler2DArrayShadow;
	precision ${l.precision} isampler2D;
	precision ${l.precision} isampler3D;
	precision ${l.precision} isamplerCube;
	precision ${l.precision} isampler2DArray;
	precision ${l.precision} usampler2D;
	precision ${l.precision} usampler3D;
	precision ${l.precision} usamplerCube;
	precision ${l.precision} usampler2DArray;
	`;return l.precision==="highp"?e+=`
#define HIGH_PRECISION`:l.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:l.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function oC(l){let e="SHADOWMAP_TYPE_BASIC";return l.shadowMapType===T?e="SHADOWMAP_TYPE_PCF":l.shadowMapType===_?e="SHADOWMAP_TYPE_PCF_SOFT":l.shadowMapType===w&&(e="SHADOWMAP_TYPE_VSM"),e}function aC(l){let e="ENVMAP_TYPE_CUBE";if(l.envMap)switch(l.envMapMode){case $:case N:e="ENVMAP_TYPE_CUBE";break;case be:e="ENVMAP_TYPE_CUBE_UV";break}return e}function lC(l){let e="ENVMAP_MODE_REFLECTION";if(l.envMap)switch(l.envMapMode){case N:e="ENVMAP_MODE_REFRACTION";break}return e}function cC(l){let e="ENVMAP_BLENDING_NONE";if(l.envMap)switch(l.combine){case bn:e="ENVMAP_BLENDING_MULTIPLY";break;case cn:e="ENVMAP_BLENDING_MIX";break;case Kn:e="ENVMAP_BLENDING_ADD";break}return e}function hC(l){const e=l.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function uC(l,e,i,n){const s=l.getContext(),a=i.defines;let d=i.vertexShader,v=i.fragmentShader;const I=oC(i),R=aC(i),O=lC(i),k=cC(i),G=hC(i),z=Zx(i),K=$x(a),ee=s.createProgram();let X,Q,ge=i.glslVersion?"#version "+i.glslVersion+`
`:"";const Ae=i.numMultiviewViews;i.isRawShaderMaterial?(X=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,K].filter(xc).join(`
`),X.length>0&&(X+=`
`),Q=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,K].filter(xc).join(`
`),Q.length>0&&(Q+=`
`)):(X=[Im(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,K,i.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",i.batching?"#define USE_BATCHING":"",i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.instancingMorph?"#define USE_INSTANCING_MORPH":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+O:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+I:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(xc).join(`
`),Q=[Im(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,K,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+R:"",i.envMap?"#define "+O:"",i.envMap?"#define "+k:"",G?"#define CUBEUV_TEXEL_WIDTH "+G.texelWidth:"",G?"#define CUBEUV_TEXEL_HEIGHT "+G.texelHeight:"",G?"#define CUBEUV_MAX_MIP "+G.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.dispersion?"#define USE_DISPERSION":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+I:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==wn?"#define TONE_MAPPING":"",i.toneMapping!==wn?tn.tonemapping_pars_fragment:"",i.toneMapping!==wn?Jx("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",tn.colorspace_pars_fragment,qx("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(xc).join(`
`)),d=zf(d),d=_m(d,i),d=Sm(d,i),v=zf(v),v=_m(v,i),v=Sm(v,i),d=Tm(d),v=Tm(v),i.isRawShaderMaterial!==!0&&(ge=`#version 300 es
`,X=[z,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+X,Q=["#define varying in",i.glslVersion===hc?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===hc?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Q,Ae>0&&(X=["#extension GL_OVR_multiview : require","layout(num_views = "+Ae+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+X,X=X.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+Ae+"];","uniform mat4 projectionMatrices["+Ae+"];","uniform mat4 viewMatrices["+Ae+"];","uniform mat3 normalMatrices["+Ae+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),Q=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+Q,Q=Q.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+Ae+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));const he=ge+X+d,Qe=ge+Q+v,Be=wm(s,s.VERTEX_SHADER,he),Oe=wm(s,s.FRAGMENT_SHADER,Qe);s.attachShader(ee,Be),s.attachShader(ee,Oe),i.index0AttributeName!==void 0?s.bindAttribLocation(ee,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(ee,0,"position"),s.linkProgram(ee);function Ve(qe){if(l.debug.checkShaderErrors){const Ke=s.getProgramInfoLog(ee).trim(),$e=s.getShaderInfoLog(Be).trim(),at=s.getShaderInfoLog(Oe).trim();let vt=!0,jt=!0;if(s.getProgramParameter(ee,s.LINK_STATUS)===!1)if(vt=!1,typeof l.debug.onShaderError=="function")l.debug.onShaderError(s,ee,Be,Oe);else{const ct=Mm(s,Be,"vertex"),Ut=Mm(s,Oe,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(ee,s.VALIDATE_STATUS)+`

Material Name: `+qe.name+`
Material Type: `+qe.type+`

Program Info Log: `+Ke+`
`+ct+`
`+Ut)}else Ke!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Ke):($e===""||at==="")&&(jt=!1);jt&&(qe.diagnostics={runnable:vt,programLog:Ke,vertexShader:{log:$e,prefix:X},fragmentShader:{log:at,prefix:Q}})}s.deleteShader(Be),s.deleteShader(Oe),_e=new Xh(s,ee),xe=eC(s,ee)}let _e;this.getUniforms=function(){return _e===void 0&&Ve(this),_e};let xe;this.getAttributes=function(){return xe===void 0&&Ve(this),xe};let ze=i.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return ze===!1&&(ze=s.getProgramParameter(ee,Wx)),ze},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(ee),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=Kx++,this.cacheKey=e,this.usedTimes=1,this.program=ee,this.vertexShader=Be,this.fragmentShader=Oe,this.numMultiviewViews=Ae,this}let dC=0;class fC{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(i),a=this._getShaderStage(n),d=this._getShaderCacheForMaterial(e);return d.has(s)===!1&&(d.add(s),s.usedTimes++),d.has(a)===!1&&(d.add(a),a.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let n=i.get(e);return n===void 0&&(n=new Set,i.set(e,n)),n}_getShaderStage(e){const i=this.shaderCache;let n=i.get(e);return n===void 0&&(n=new pC(e),i.set(e,n)),n}}class pC{constructor(e){this.id=dC++,this.code=e,this.usedTimes=0}}function AC(l,e,i,n,s,a,d){const v=new Bh,I=new fC,R=new Set,O=[],k=s.logarithmicDepthBuffer,G=s.vertexTextures;let z=s.precision;const K={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ee(_e){return R.add(_e),_e===0?"uv":`uv${_e}`}function X(_e,xe,ze,qe,Ke){const $e=qe.fog,at=Ke.geometry,vt=_e.isMeshStandardMaterial?qe.environment:null,jt=(_e.isMeshStandardMaterial?i:e).get(_e.envMap||vt),ct=jt&&jt.mapping===be?jt.image.height:null,Ut=K[_e.type];_e.precision!==null&&(z=s.getMaxPrecision(_e.precision),z!==_e.precision&&console.warn("THREE.WebGLProgram.getParameters:",_e.precision,"not supported, using",z,"instead."));const Qt=at.morphAttributes.position||at.morphAttributes.normal||at.morphAttributes.color,fi=Qt!==void 0?Qt.length:0;let an=0;at.morphAttributes.position!==void 0&&(an=1),at.morphAttributes.normal!==void 0&&(an=2),at.morphAttributes.color!==void 0&&(an=3);let Nn,$n,Dn,Wn;if(Ut){const Pr=Ys[Ut];Nn=Pr.vertexShader,$n=Pr.fragmentShader}else Nn=_e.vertexShader,$n=_e.fragmentShader,I.update(_e),Dn=I.getVertexShaderID(_e),Wn=I.getFragmentShaderID(_e);const vi=l.getRenderTarget(),bt=vi&&vi.isWebGLMultiviewRenderTarget?vi.numViews:0,Kt=Ke.isInstancedMesh===!0,Zt=Ke.isBatchedMesh===!0,et=!!_e.map,wt=!!_e.matcap,gt=!!jt,kt=!!_e.aoMap,Ft=!!_e.lightMap,Dt=!!_e.bumpMap,$t=!!_e.normalMap,ai=!!_e.displacementMap,Qi=!!_e.emissiveMap,qi=!!_e.metalnessMap,Pn=!!_e.roughnessMap,dr=_e.anisotropy>0,er=_e.clearcoat>0,Ue=_e.dispersion>0,Ce=_e.iridescence>0,ut=_e.sheen>0,Ct=_e.transmission>0,It=dr&&!!_e.anisotropyMap,Mt=er&&!!_e.clearcoatMap,Ci=er&&!!_e.clearcoatNormalMap,Wt=er&&!!_e.clearcoatRoughnessMap,ci=Ce&&!!_e.iridescenceMap,Un=Ce&&!!_e.iridescenceThicknessMap,hi=ut&&!!_e.sheenColorMap,Mi=ut&&!!_e.sheenRoughnessMap,nn=!!_e.specularMap,Fi=!!_e.specularColorMap,je=!!_e.specularIntensityMap,Pt=Ct&&!!_e.transmissionMap,Ht=Ct&&!!_e.thicknessMap,bi=!!_e.gradientMap,ri=!!_e.alphaMap,rn=_e.alphaTest>0,si=!!_e.alphaHash,ei=!!_e.extensions;let un=wn;_e.toneMapped&&(vi===null||vi.isXRRenderTarget===!0)&&(un=l.toneMapping);const Ui={shaderID:Ut,shaderType:_e.type,shaderName:_e.name,vertexShader:Nn,fragmentShader:$n,defines:_e.defines,customVertexShaderID:Dn,customFragmentShaderID:Wn,isRawShaderMaterial:_e.isRawShaderMaterial===!0,glslVersion:_e.glslVersion,precision:z,batching:Zt,instancing:Kt,instancingColor:Kt&&Ke.instanceColor!==null,instancingMorph:Kt&&Ke.morphTexture!==null,supportsVertexTextures:G,numMultiviewViews:bt,outputColorSpace:vi===null?l.outputColorSpace:vi.isXRRenderTarget===!0?vi.texture.colorSpace:Ws,alphaToCoverage:!!_e.alphaToCoverage,map:et,matcap:wt,envMap:gt,envMapMode:gt&&jt.mapping,envMapCubeUVHeight:ct,aoMap:kt,lightMap:Ft,bumpMap:Dt,normalMap:$t,displacementMap:G&&ai,emissiveMap:Qi,normalMapObjectSpace:$t&&_e.normalMapType===co,normalMapTangentSpace:$t&&_e.normalMapType===qr,metalnessMap:qi,roughnessMap:Pn,anisotropy:dr,anisotropyMap:It,clearcoat:er,clearcoatMap:Mt,clearcoatNormalMap:Ci,clearcoatRoughnessMap:Wt,dispersion:Ue,iridescence:Ce,iridescenceMap:ci,iridescenceThicknessMap:Un,sheen:ut,sheenColorMap:hi,sheenRoughnessMap:Mi,specularMap:nn,specularColorMap:Fi,specularIntensityMap:je,transmission:Ct,transmissionMap:Pt,thicknessMap:Ht,gradientMap:bi,opaque:_e.transparent===!1&&_e.blending===U&&_e.alphaToCoverage===!1,alphaMap:ri,alphaTest:rn,alphaHash:si,combine:_e.combine,mapUv:et&&ee(_e.map.channel),aoMapUv:kt&&ee(_e.aoMap.channel),lightMapUv:Ft&&ee(_e.lightMap.channel),bumpMapUv:Dt&&ee(_e.bumpMap.channel),normalMapUv:$t&&ee(_e.normalMap.channel),displacementMapUv:ai&&ee(_e.displacementMap.channel),emissiveMapUv:Qi&&ee(_e.emissiveMap.channel),metalnessMapUv:qi&&ee(_e.metalnessMap.channel),roughnessMapUv:Pn&&ee(_e.roughnessMap.channel),anisotropyMapUv:It&&ee(_e.anisotropyMap.channel),clearcoatMapUv:Mt&&ee(_e.clearcoatMap.channel),clearcoatNormalMapUv:Ci&&ee(_e.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Wt&&ee(_e.clearcoatRoughnessMap.channel),iridescenceMapUv:ci&&ee(_e.iridescenceMap.channel),iridescenceThicknessMapUv:Un&&ee(_e.iridescenceThicknessMap.channel),sheenColorMapUv:hi&&ee(_e.sheenColorMap.channel),sheenRoughnessMapUv:Mi&&ee(_e.sheenRoughnessMap.channel),specularMapUv:nn&&ee(_e.specularMap.channel),specularColorMapUv:Fi&&ee(_e.specularColorMap.channel),specularIntensityMapUv:je&&ee(_e.specularIntensityMap.channel),transmissionMapUv:Pt&&ee(_e.transmissionMap.channel),thicknessMapUv:Ht&&ee(_e.thicknessMap.channel),alphaMapUv:ri&&ee(_e.alphaMap.channel),vertexTangents:!!at.attributes.tangent&&($t||dr),vertexColors:_e.vertexColors,vertexAlphas:_e.vertexColors===!0&&!!at.attributes.color&&at.attributes.color.itemSize===4,pointsUvs:Ke.isPoints===!0&&!!at.attributes.uv&&(et||ri),fog:!!$e,useFog:_e.fog===!0,fogExp2:!!$e&&$e.isFogExp2,flatShading:_e.flatShading===!0,sizeAttenuation:_e.sizeAttenuation===!0,logarithmicDepthBuffer:k,skinning:Ke.isSkinnedMesh===!0,morphTargets:at.morphAttributes.position!==void 0,morphNormals:at.morphAttributes.normal!==void 0,morphColors:at.morphAttributes.color!==void 0,morphTargetsCount:fi,morphTextureStride:an,numDirLights:xe.directional.length,numPointLights:xe.point.length,numSpotLights:xe.spot.length,numSpotLightMaps:xe.spotLightMap.length,numRectAreaLights:xe.rectArea.length,numHemiLights:xe.hemi.length,numDirLightShadows:xe.directionalShadowMap.length,numPointLightShadows:xe.pointShadowMap.length,numSpotLightShadows:xe.spotShadowMap.length,numSpotLightShadowsWithMaps:xe.numSpotLightShadowsWithMaps,numLightProbes:xe.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:_e.dithering,shadowMapEnabled:l.shadowMap.enabled&&ze.length>0,shadowMapType:l.shadowMap.type,toneMapping:un,useLegacyLights:l._useLegacyLights,decodeVideoTexture:et&&_e.map.isVideoTexture===!0&&Fn.getTransfer(_e.map.colorSpace)===jn,premultipliedAlpha:_e.premultipliedAlpha,doubleSided:_e.side===P,flipSided:_e.side===L,useDepthPacking:_e.depthPacking>=0,depthPacking:_e.depthPacking||0,index0AttributeName:_e.index0AttributeName,extensionClipCullDistance:ei&&_e.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:ei&&_e.extensions.multiDraw===!0&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:_e.customProgramCacheKey()};return Ui.vertexUv1s=R.has(1),Ui.vertexUv2s=R.has(2),Ui.vertexUv3s=R.has(3),R.clear(),Ui}function Q(_e){const xe=[];if(_e.shaderID?xe.push(_e.shaderID):(xe.push(_e.customVertexShaderID),xe.push(_e.customFragmentShaderID)),_e.defines!==void 0)for(const ze in _e.defines)xe.push(ze),xe.push(_e.defines[ze]);return _e.isRawShaderMaterial===!1&&(ge(xe,_e),Ae(xe,_e),xe.push(l.outputColorSpace)),xe.push(_e.customProgramCacheKey),xe.join()}function ge(_e,xe){_e.push(xe.precision),_e.push(xe.outputColorSpace),_e.push(xe.envMapMode),_e.push(xe.envMapCubeUVHeight),_e.push(xe.mapUv),_e.push(xe.alphaMapUv),_e.push(xe.lightMapUv),_e.push(xe.aoMapUv),_e.push(xe.bumpMapUv),_e.push(xe.normalMapUv),_e.push(xe.displacementMapUv),_e.push(xe.emissiveMapUv),_e.push(xe.metalnessMapUv),_e.push(xe.roughnessMapUv),_e.push(xe.anisotropyMapUv),_e.push(xe.clearcoatMapUv),_e.push(xe.clearcoatNormalMapUv),_e.push(xe.clearcoatRoughnessMapUv),_e.push(xe.iridescenceMapUv),_e.push(xe.iridescenceThicknessMapUv),_e.push(xe.sheenColorMapUv),_e.push(xe.sheenRoughnessMapUv),_e.push(xe.specularMapUv),_e.push(xe.specularColorMapUv),_e.push(xe.specularIntensityMapUv),_e.push(xe.transmissionMapUv),_e.push(xe.thicknessMapUv),_e.push(xe.combine),_e.push(xe.fogExp2),_e.push(xe.sizeAttenuation),_e.push(xe.morphTargetsCount),_e.push(xe.morphAttributeCount),_e.push(xe.numDirLights),_e.push(xe.numPointLights),_e.push(xe.numSpotLights),_e.push(xe.numSpotLightMaps),_e.push(xe.numHemiLights),_e.push(xe.numRectAreaLights),_e.push(xe.numDirLightShadows),_e.push(xe.numPointLightShadows),_e.push(xe.numSpotLightShadows),_e.push(xe.numSpotLightShadowsWithMaps),_e.push(xe.numLightProbes),_e.push(xe.shadowMapType),_e.push(xe.toneMapping),_e.push(xe.numClippingPlanes),_e.push(xe.numClipIntersection),_e.push(xe.depthPacking)}function Ae(_e,xe){v.disableAll(),xe.supportsVertexTextures&&v.enable(0),xe.instancing&&v.enable(1),xe.instancingColor&&v.enable(2),xe.instancingMorph&&v.enable(3),xe.matcap&&v.enable(4),xe.envMap&&v.enable(5),xe.normalMapObjectSpace&&v.enable(6),xe.normalMapTangentSpace&&v.enable(7),xe.clearcoat&&v.enable(8),xe.iridescence&&v.enable(9),xe.alphaTest&&v.enable(10),xe.vertexColors&&v.enable(11),xe.vertexAlphas&&v.enable(12),xe.vertexUv1s&&v.enable(13),xe.vertexUv2s&&v.enable(14),xe.vertexUv3s&&v.enable(15),xe.vertexTangents&&v.enable(16),xe.anisotropy&&v.enable(17),xe.alphaHash&&v.enable(18),xe.batching&&v.enable(19),xe.dispersion&&v.enable(20),_e.push(v.mask),v.disableAll(),xe.fog&&v.enable(0),xe.useFog&&v.enable(1),xe.flatShading&&v.enable(2),xe.logarithmicDepthBuffer&&v.enable(3),xe.skinning&&v.enable(4),xe.morphTargets&&v.enable(5),xe.morphNormals&&v.enable(6),xe.morphColors&&v.enable(7),xe.premultipliedAlpha&&v.enable(8),xe.shadowMapEnabled&&v.enable(9),xe.useLegacyLights&&v.enable(10),xe.doubleSided&&v.enable(11),xe.flipSided&&v.enable(12),xe.useDepthPacking&&v.enable(13),xe.dithering&&v.enable(14),xe.transmission&&v.enable(15),xe.sheen&&v.enable(16),xe.opaque&&v.enable(17),xe.pointsUvs&&v.enable(18),xe.decodeVideoTexture&&v.enable(19),xe.alphaToCoverage&&v.enable(20),xe.numMultiviewViews&&v.enable(21),_e.push(v.mask)}function he(_e){const xe=K[_e.type];let ze;if(xe){const qe=Ys[xe];ze=im.clone(qe.uniforms)}else ze=_e.uniforms;return ze}function Qe(_e,xe){let ze;for(let qe=0,Ke=O.length;qe<Ke;qe++){const $e=O[qe];if($e.cacheKey===xe){ze=$e,++ze.usedTimes;break}}return ze===void 0&&(ze=new uC(l,xe,_e,a),O.push(ze)),ze}function Be(_e){if(--_e.usedTimes===0){const xe=O.indexOf(_e);O[xe]=O[O.length-1],O.pop(),_e.destroy()}}function Oe(_e){I.remove(_e)}function Ve(){I.dispose()}return{getParameters:X,getProgramCacheKey:Q,getUniforms:he,acquireProgram:Qe,releaseProgram:Be,releaseShaderCache:Oe,programs:O,dispose:Ve}}function mC(){let l=new WeakMap;function e(a){let d=l.get(a);return d===void 0&&(d={},l.set(a,d)),d}function i(a){l.delete(a)}function n(a,d,v){l.get(a)[d]=v}function s(){l=new WeakMap}return{get:e,remove:i,update:n,dispose:s}}function gC(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.material.id!==e.material.id?l.material.id-e.material.id:l.z!==e.z?l.z-e.z:l.id-e.id}function Bm(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.z!==e.z?e.z-l.z:l.id-e.id}function Rm(){const l=[];let e=0;const i=[],n=[],s=[];function a(){e=0,i.length=0,n.length=0,s.length=0}function d(k,G,z,K,ee,X){let Q=l[e];return Q===void 0?(Q={id:k.id,object:k,geometry:G,material:z,groupOrder:K,renderOrder:k.renderOrder,z:ee,group:X},l[e]=Q):(Q.id=k.id,Q.object=k,Q.geometry=G,Q.material=z,Q.groupOrder=K,Q.renderOrder=k.renderOrder,Q.z=ee,Q.group=X),e++,Q}function v(k,G,z,K,ee,X){const Q=d(k,G,z,K,ee,X);z.transmission>0?n.push(Q):z.transparent===!0?s.push(Q):i.push(Q)}function I(k,G,z,K,ee,X){const Q=d(k,G,z,K,ee,X);z.transmission>0?n.unshift(Q):z.transparent===!0?s.unshift(Q):i.unshift(Q)}function R(k,G){i.length>1&&i.sort(k||gC),n.length>1&&n.sort(G||Bm),s.length>1&&s.sort(G||Bm)}function O(){for(let k=e,G=l.length;k<G;k++){const z=l[k];if(z.id===null)break;z.id=null,z.object=null,z.geometry=null,z.material=null,z.group=null}}return{opaque:i,transmissive:n,transparent:s,init:a,push:v,unshift:I,finish:O,sort:R}}function vC(){let l=new WeakMap;function e(n,s){const a=l.get(n);let d;return a===void 0?(d=new Rm,l.set(n,[d])):s>=a.length?(d=new Rm,a.push(d)):d=a[s],d}function i(){l=new WeakMap}return{get:e,dispose:i}}function yC(){const l={};return{get:function(e){if(l[e.id]!==void 0)return l[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new Ie,color:new li};break;case"SpotLight":i={position:new Ie,direction:new Ie,color:new li,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new Ie,color:new li,distance:0,decay:0};break;case"HemisphereLight":i={direction:new Ie,skyColor:new li,groundColor:new li};break;case"RectAreaLight":i={color:new li,position:new Ie,halfWidth:new Ie,halfHeight:new Ie};break}return l[e.id]=i,i}}}function EC(){const l={};return{get:function(e){if(l[e.id]!==void 0)return l[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt,shadowCameraNear:1,shadowCameraFar:1e3};break}return l[e.id]=i,i}}}let xC=0;function CC(l,e){return(e.castShadow?2:0)-(l.castShadow?2:0)+(e.map?1:0)-(l.map?1:0)}function bC(l){const e=new yC,i=EC(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let R=0;R<9;R++)n.probe.push(new Ie);const s=new Ie,a=new mi,d=new mi;function v(R,O){let k=0,G=0,z=0;for(let ze=0;ze<9;ze++)n.probe[ze].set(0,0,0);let K=0,ee=0,X=0,Q=0,ge=0,Ae=0,he=0,Qe=0,Be=0,Oe=0,Ve=0;R.sort(CC);const _e=O===!0?Math.PI:1;for(let ze=0,qe=R.length;ze<qe;ze++){const Ke=R[ze],$e=Ke.color,at=Ke.intensity,vt=Ke.distance,jt=Ke.shadow&&Ke.shadow.map?Ke.shadow.map.texture:null;if(Ke.isAmbientLight)k+=$e.r*at*_e,G+=$e.g*at*_e,z+=$e.b*at*_e;else if(Ke.isLightProbe){for(let ct=0;ct<9;ct++)n.probe[ct].addScaledVector(Ke.sh.coefficients[ct],at);Ve++}else if(Ke.isDirectionalLight){const ct=e.get(Ke);if(ct.color.copy(Ke.color).multiplyScalar(Ke.intensity*_e),Ke.castShadow){const Ut=Ke.shadow,Qt=i.get(Ke);Qt.shadowBias=Ut.bias,Qt.shadowNormalBias=Ut.normalBias,Qt.shadowRadius=Ut.radius,Qt.shadowMapSize=Ut.mapSize,n.directionalShadow[K]=Qt,n.directionalShadowMap[K]=jt,n.directionalShadowMatrix[K]=Ke.shadow.matrix,Ae++}n.directional[K]=ct,K++}else if(Ke.isSpotLight){const ct=e.get(Ke);ct.position.setFromMatrixPosition(Ke.matrixWorld),ct.color.copy($e).multiplyScalar(at*_e),ct.distance=vt,ct.coneCos=Math.cos(Ke.angle),ct.penumbraCos=Math.cos(Ke.angle*(1-Ke.penumbra)),ct.decay=Ke.decay,n.spot[X]=ct;const Ut=Ke.shadow;if(Ke.map&&(n.spotLightMap[Be]=Ke.map,Be++,Ut.updateMatrices(Ke),Ke.castShadow&&Oe++),n.spotLightMatrix[X]=Ut.matrix,Ke.castShadow){const Qt=i.get(Ke);Qt.shadowBias=Ut.bias,Qt.shadowNormalBias=Ut.normalBias,Qt.shadowRadius=Ut.radius,Qt.shadowMapSize=Ut.mapSize,n.spotShadow[X]=Qt,n.spotShadowMap[X]=jt,Qe++}X++}else if(Ke.isRectAreaLight){const ct=e.get(Ke);ct.color.copy($e).multiplyScalar(at),ct.halfWidth.set(Ke.width*.5,0,0),ct.halfHeight.set(0,Ke.height*.5,0),n.rectArea[Q]=ct,Q++}else if(Ke.isPointLight){const ct=e.get(Ke);if(ct.color.copy(Ke.color).multiplyScalar(Ke.intensity*_e),ct.distance=Ke.distance,ct.decay=Ke.decay,Ke.castShadow){const Ut=Ke.shadow,Qt=i.get(Ke);Qt.shadowBias=Ut.bias,Qt.shadowNormalBias=Ut.normalBias,Qt.shadowRadius=Ut.radius,Qt.shadowMapSize=Ut.mapSize,Qt.shadowCameraNear=Ut.camera.near,Qt.shadowCameraFar=Ut.camera.far,n.pointShadow[ee]=Qt,n.pointShadowMap[ee]=jt,n.pointShadowMatrix[ee]=Ke.shadow.matrix,he++}n.point[ee]=ct,ee++}else if(Ke.isHemisphereLight){const ct=e.get(Ke);ct.skyColor.copy(Ke.color).multiplyScalar(at*_e),ct.groundColor.copy(Ke.groundColor).multiplyScalar(at*_e),n.hemi[ge]=ct,ge++}}Q>0&&(l.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Jt.LTC_FLOAT_1,n.rectAreaLTC2=Jt.LTC_FLOAT_2):(n.rectAreaLTC1=Jt.LTC_HALF_1,n.rectAreaLTC2=Jt.LTC_HALF_2)),n.ambient[0]=k,n.ambient[1]=G,n.ambient[2]=z;const xe=n.hash;(xe.directionalLength!==K||xe.pointLength!==ee||xe.spotLength!==X||xe.rectAreaLength!==Q||xe.hemiLength!==ge||xe.numDirectionalShadows!==Ae||xe.numPointShadows!==he||xe.numSpotShadows!==Qe||xe.numSpotMaps!==Be||xe.numLightProbes!==Ve)&&(n.directional.length=K,n.spot.length=X,n.rectArea.length=Q,n.point.length=ee,n.hemi.length=ge,n.directionalShadow.length=Ae,n.directionalShadowMap.length=Ae,n.pointShadow.length=he,n.pointShadowMap.length=he,n.spotShadow.length=Qe,n.spotShadowMap.length=Qe,n.directionalShadowMatrix.length=Ae,n.pointShadowMatrix.length=he,n.spotLightMatrix.length=Qe+Be-Oe,n.spotLightMap.length=Be,n.numSpotLightShadowsWithMaps=Oe,n.numLightProbes=Ve,xe.directionalLength=K,xe.pointLength=ee,xe.spotLength=X,xe.rectAreaLength=Q,xe.hemiLength=ge,xe.numDirectionalShadows=Ae,xe.numPointShadows=he,xe.numSpotShadows=Qe,xe.numSpotMaps=Be,xe.numLightProbes=Ve,n.version=xC++)}function I(R,O){let k=0,G=0,z=0,K=0,ee=0;const X=O.matrixWorldInverse;for(let Q=0,ge=R.length;Q<ge;Q++){const Ae=R[Q];if(Ae.isDirectionalLight){const he=n.directional[k];he.direction.setFromMatrixPosition(Ae.matrixWorld),s.setFromMatrixPosition(Ae.target.matrixWorld),he.direction.sub(s),he.direction.transformDirection(X),k++}else if(Ae.isSpotLight){const he=n.spot[z];he.position.setFromMatrixPosition(Ae.matrixWorld),he.position.applyMatrix4(X),he.direction.setFromMatrixPosition(Ae.matrixWorld),s.setFromMatrixPosition(Ae.target.matrixWorld),he.direction.sub(s),he.direction.transformDirection(X),z++}else if(Ae.isRectAreaLight){const he=n.rectArea[K];he.position.setFromMatrixPosition(Ae.matrixWorld),he.position.applyMatrix4(X),d.identity(),a.copy(Ae.matrixWorld),a.premultiply(X),d.extractRotation(a),he.halfWidth.set(Ae.width*.5,0,0),he.halfHeight.set(0,Ae.height*.5,0),he.halfWidth.applyMatrix4(d),he.halfHeight.applyMatrix4(d),K++}else if(Ae.isPointLight){const he=n.point[G];he.position.setFromMatrixPosition(Ae.matrixWorld),he.position.applyMatrix4(X),G++}else if(Ae.isHemisphereLight){const he=n.hemi[ee];he.direction.setFromMatrixPosition(Ae.matrixWorld),he.direction.transformDirection(X),ee++}}}return{setup:v,setupView:I,state:n}}function Lm(l){const e=new bC(l),i=[],n=[];function s(O){R.camera=O,i.length=0,n.length=0}function a(O){i.push(O)}function d(O){n.push(O)}function v(O){e.setup(i,O)}function I(O){e.setupView(i,O)}const R={lightsArray:i,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:R,setupLights:v,setupLightsView:I,pushLight:a,pushShadow:d}}function wC(l){let e=new WeakMap;function i(s,a=0){const d=e.get(s);let v;return d===void 0?(v=new Lm(l),e.set(s,[v])):a>=d.length?(v=new Lm(l),d.push(v)):v=d[a],v}function n(){e=new WeakMap}return{get:i,dispose:n}}class Qf extends $r{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ao,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Hf extends $r{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const MC=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,_C=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function SC(l,e,i){let n=new Ec;const s=new xt,a=new xt,d=new _n,v=new Qf({depthPacking:lo}),I=new Hf,R={},O=i.maxTextureSize,k={[S]:L,[L]:S,[P]:P},G=new Xs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new xt},radius:{value:4}},vertexShader:MC,fragmentShader:_C}),z=G.clone();z.defines.HORIZONTAL_PASS=1;const K=new on;K.setAttribute("position",new zn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ee=new wr(K,G),X=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=T;let Q=this.type;this.render=function(Be,Oe,Ve){if(X.enabled===!1||X.autoUpdate===!1&&X.needsUpdate===!1||Be.length===0)return;const _e=l.getRenderTarget(),xe=l.getActiveCubeFace(),ze=l.getActiveMipmapLevel(),qe=l.state;qe.setBlending(D),qe.buffers.color.setClear(1,1,1,1),qe.buffers.depth.setTest(!0),qe.setScissorTest(!1);const Ke=Q!==w&&this.type===w,$e=Q===w&&this.type!==w;for(let at=0,vt=Be.length;at<vt;at++){const jt=Be[at],ct=jt.shadow;if(ct===void 0){console.warn("THREE.WebGLShadowMap:",jt,"has no shadow.");continue}if(ct.autoUpdate===!1&&ct.needsUpdate===!1)continue;s.copy(ct.mapSize);const Ut=ct.getFrameExtents();if(s.multiply(Ut),a.copy(ct.mapSize),(s.x>O||s.y>O)&&(s.x>O&&(a.x=Math.floor(O/Ut.x),s.x=a.x*Ut.x,ct.mapSize.x=a.x),s.y>O&&(a.y=Math.floor(O/Ut.y),s.y=a.y*Ut.y,ct.mapSize.y=a.y)),ct.map===null||Ke===!0||$e===!0){const fi=this.type!==w?{minFilter:zt,magFilter:zt}:{};ct.map!==null&&ct.map.dispose(),ct.map=new ys(s.x,s.y,fi),ct.map.texture.name=jt.name+".shadowMap",ct.camera.updateProjectionMatrix()}l.setRenderTarget(ct.map),l.clear();const Qt=ct.getViewportCount();for(let fi=0;fi<Qt;fi++){const an=ct.getViewport(fi);d.set(a.x*an.x,a.y*an.y,a.x*an.z,a.y*an.w),qe.viewport(d),ct.updateMatrices(jt,fi),n=ct.getFrustum(),he(Oe,Ve,ct.camera,jt,this.type)}ct.isPointLightShadow!==!0&&this.type===w&&ge(ct,Ve),ct.needsUpdate=!1}Q=this.type,X.needsUpdate=!1,l.setRenderTarget(_e,xe,ze)};function ge(Be,Oe){const Ve=e.update(ee);G.defines.VSM_SAMPLES!==Be.blurSamples&&(G.defines.VSM_SAMPLES=Be.blurSamples,z.defines.VSM_SAMPLES=Be.blurSamples,G.needsUpdate=!0,z.needsUpdate=!0),Be.mapPass===null&&(Be.mapPass=new ys(s.x,s.y)),G.uniforms.shadow_pass.value=Be.map.texture,G.uniforms.resolution.value=Be.mapSize,G.uniforms.radius.value=Be.radius,l.setRenderTarget(Be.mapPass),l.clear(),l.renderBufferDirect(Oe,null,Ve,G,ee,null),z.uniforms.shadow_pass.value=Be.mapPass.texture,z.uniforms.resolution.value=Be.mapSize,z.uniforms.radius.value=Be.radius,l.setRenderTarget(Be.map),l.clear(),l.renderBufferDirect(Oe,null,Ve,z,ee,null)}function Ae(Be,Oe,Ve,_e){let xe=null;const ze=Ve.isPointLight===!0?Be.customDistanceMaterial:Be.customDepthMaterial;if(ze!==void 0)xe=ze;else if(xe=Ve.isPointLight===!0?I:v,l.localClippingEnabled&&Oe.clipShadows===!0&&Array.isArray(Oe.clippingPlanes)&&Oe.clippingPlanes.length!==0||Oe.displacementMap&&Oe.displacementScale!==0||Oe.alphaMap&&Oe.alphaTest>0||Oe.map&&Oe.alphaTest>0){const qe=xe.uuid,Ke=Oe.uuid;let $e=R[qe];$e===void 0&&($e={},R[qe]=$e);let at=$e[Ke];at===void 0&&(at=xe.clone(),$e[Ke]=at,Oe.addEventListener("dispose",Qe)),xe=at}if(xe.visible=Oe.visible,xe.wireframe=Oe.wireframe,_e===w?xe.side=Oe.shadowSide!==null?Oe.shadowSide:Oe.side:xe.side=Oe.shadowSide!==null?Oe.shadowSide:k[Oe.side],xe.alphaMap=Oe.alphaMap,xe.alphaTest=Oe.alphaTest,xe.map=Oe.map,xe.clipShadows=Oe.clipShadows,xe.clippingPlanes=Oe.clippingPlanes,xe.clipIntersection=Oe.clipIntersection,xe.displacementMap=Oe.displacementMap,xe.displacementScale=Oe.displacementScale,xe.displacementBias=Oe.displacementBias,xe.wireframeLinewidth=Oe.wireframeLinewidth,xe.linewidth=Oe.linewidth,Ve.isPointLight===!0&&xe.isMeshDistanceMaterial===!0){const qe=l.properties.get(xe);qe.light=Ve}return xe}function he(Be,Oe,Ve,_e,xe){if(Be.visible===!1)return;if(Be.layers.test(Oe.layers)&&(Be.isMesh||Be.isLine||Be.isPoints)&&(Be.castShadow||Be.receiveShadow&&xe===w)&&(!Be.frustumCulled||n.intersectsObject(Be))){Be.modelViewMatrix.multiplyMatrices(Ve.matrixWorldInverse,Be.matrixWorld);const Ke=e.update(Be),$e=Be.material;if(Array.isArray($e)){const at=Ke.groups;for(let vt=0,jt=at.length;vt<jt;vt++){const ct=at[vt],Ut=$e[ct.materialIndex];if(Ut&&Ut.visible){const Qt=Ae(Be,Ut,_e,xe);Be.onBeforeShadow(l,Be,Oe,Ve,Ke,Qt,ct),l.renderBufferDirect(Ve,null,Ke,Qt,Be,ct),Be.onAfterShadow(l,Be,Oe,Ve,Ke,Qt,ct)}}}else if($e.visible){const at=Ae(Be,$e,_e,xe);Be.onBeforeShadow(l,Be,Oe,Ve,Ke,at,null),l.renderBufferDirect(Ve,null,Ke,at,Be,null),Be.onAfterShadow(l,Be,Oe,Ve,Ke,at,null)}}const qe=Be.children;for(let Ke=0,$e=qe.length;Ke<$e;Ke++)he(qe[Ke],Oe,Ve,_e,xe)}function Qe(Be){Be.target.removeEventListener("dispose",Qe);for(const Ve in R){const _e=R[Ve],xe=Be.target.uuid;xe in _e&&(_e[xe].dispose(),delete _e[xe])}}}function TC(l){function e(){let je=!1;const Pt=new _n;let Ht=null;const bi=new _n(0,0,0,0);return{setMask:function(ri){Ht!==ri&&!je&&(l.colorMask(ri,ri,ri,ri),Ht=ri)},setLocked:function(ri){je=ri},setClear:function(ri,rn,si,ei,un){un===!0&&(ri*=ei,rn*=ei,si*=ei),Pt.set(ri,rn,si,ei),bi.equals(Pt)===!1&&(l.clearColor(ri,rn,si,ei),bi.copy(Pt))},reset:function(){je=!1,Ht=null,bi.set(-1,0,0,0)}}}function i(){let je=!1,Pt=null,Ht=null,bi=null;return{setTest:function(ri){ri?Wn(l.DEPTH_TEST):vi(l.DEPTH_TEST)},setMask:function(ri){Pt!==ri&&!je&&(l.depthMask(ri),Pt=ri)},setFunc:function(ri){if(Ht!==ri){switch(ri){case Ri:l.depthFunc(l.NEVER);break;case Ni:l.depthFunc(l.ALWAYS);break;case Oi:l.depthFunc(l.LESS);break;case yi:l.depthFunc(l.LEQUAL);break;case zi:l.depthFunc(l.EQUAL);break;case Cn:l.depthFunc(l.GEQUAL);break;case gn:l.depthFunc(l.GREATER);break;case rr:l.depthFunc(l.NOTEQUAL);break;default:l.depthFunc(l.LEQUAL)}Ht=ri}},setLocked:function(ri){je=ri},setClear:function(ri){bi!==ri&&(l.clearDepth(ri),bi=ri)},reset:function(){je=!1,Pt=null,Ht=null,bi=null}}}function n(){let je=!1,Pt=null,Ht=null,bi=null,ri=null,rn=null,si=null,ei=null,un=null;return{setTest:function(Ui){je||(Ui?Wn(l.STENCIL_TEST):vi(l.STENCIL_TEST))},setMask:function(Ui){Pt!==Ui&&!je&&(l.stencilMask(Ui),Pt=Ui)},setFunc:function(Ui,Pr,Ao){(Ht!==Ui||bi!==Pr||ri!==Ao)&&(l.stencilFunc(Ui,Pr,Ao),Ht=Ui,bi=Pr,ri=Ao)},setOp:function(Ui,Pr,Ao){(rn!==Ui||si!==Pr||ei!==Ao)&&(l.stencilOp(Ui,Pr,Ao),rn=Ui,si=Pr,ei=Ao)},setLocked:function(Ui){je=Ui},setClear:function(Ui){un!==Ui&&(l.clearStencil(Ui),un=Ui)},reset:function(){je=!1,Pt=null,Ht=null,bi=null,ri=null,rn=null,si=null,ei=null,un=null}}}const s=new e,a=new i,d=new n,v=new WeakMap,I=new WeakMap;let R={},O={},k=new WeakMap,G=[],z=null,K=!1,ee=null,X=null,Q=null,ge=null,Ae=null,he=null,Qe=null,Be=new li(0,0,0),Oe=0,Ve=!1,_e=null,xe=null,ze=null,qe=null,Ke=null;const $e=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let at=!1,vt=0;const jt=l.getParameter(l.VERSION);jt.indexOf("WebGL")!==-1?(vt=parseFloat(/^WebGL (\d)/.exec(jt)[1]),at=vt>=1):jt.indexOf("OpenGL ES")!==-1&&(vt=parseFloat(/^OpenGL ES (\d)/.exec(jt)[1]),at=vt>=2);let ct=null,Ut={};const Qt=l.getParameter(l.SCISSOR_BOX),fi=l.getParameter(l.VIEWPORT),an=new _n().fromArray(Qt),Nn=new _n().fromArray(fi);function $n(je,Pt,Ht,bi){const ri=new Uint8Array(4),rn=l.createTexture();l.bindTexture(je,rn),l.texParameteri(je,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(je,l.TEXTURE_MAG_FILTER,l.NEAREST);for(let si=0;si<Ht;si++)je===l.TEXTURE_3D||je===l.TEXTURE_2D_ARRAY?l.texImage3D(Pt,0,l.RGBA,1,1,bi,0,l.RGBA,l.UNSIGNED_BYTE,ri):l.texImage2D(Pt+si,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,ri);return rn}const Dn={};Dn[l.TEXTURE_2D]=$n(l.TEXTURE_2D,l.TEXTURE_2D,1),Dn[l.TEXTURE_CUBE_MAP]=$n(l.TEXTURE_CUBE_MAP,l.TEXTURE_CUBE_MAP_POSITIVE_X,6),Dn[l.TEXTURE_2D_ARRAY]=$n(l.TEXTURE_2D_ARRAY,l.TEXTURE_2D_ARRAY,1,1),Dn[l.TEXTURE_3D]=$n(l.TEXTURE_3D,l.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),d.setClear(0),Wn(l.DEPTH_TEST),a.setFunc(yi),Ft(!1),Dt(u),Wn(l.CULL_FACE),gt(D);function Wn(je){R[je]!==!0&&(l.enable(je),R[je]=!0)}function vi(je){R[je]!==!1&&(l.disable(je),R[je]=!1)}function bt(je,Pt){return O[je]!==Pt?(l.bindFramebuffer(je,Pt),O[je]=Pt,je===l.DRAW_FRAMEBUFFER&&(O[l.FRAMEBUFFER]=Pt),je===l.FRAMEBUFFER&&(O[l.DRAW_FRAMEBUFFER]=Pt),!0):!1}function Kt(je,Pt){let Ht=G,bi=!1;if(je){Ht=k.get(Pt),Ht===void 0&&(Ht=[],k.set(Pt,Ht));const ri=je.textures;if(Ht.length!==ri.length||Ht[0]!==l.COLOR_ATTACHMENT0){for(let rn=0,si=ri.length;rn<si;rn++)Ht[rn]=l.COLOR_ATTACHMENT0+rn;Ht.length=ri.length,bi=!0}}else Ht[0]!==l.BACK&&(Ht[0]=l.BACK,bi=!0);bi&&l.drawBuffers(Ht)}function Zt(je){return z!==je?(l.useProgram(je),z=je,!0):!1}const et={[te]:l.FUNC_ADD,[pe]:l.FUNC_SUBTRACT,[de]:l.FUNC_REVERSE_SUBTRACT};et[se]=l.MIN,et[J]=l.MAX;const wt={[H]:l.ZERO,[ae]:l.ONE,[ue]:l.SRC_COLOR,[De]:l.SRC_ALPHA,[Gt]:l.SRC_ALPHA_SATURATE,[pt]:l.DST_COLOR,[Xe]:l.DST_ALPHA,[Me]:l.ONE_MINUS_SRC_COLOR,[Ge]:l.ONE_MINUS_SRC_ALPHA,[yt]:l.ONE_MINUS_DST_COLOR,[Je]:l.ONE_MINUS_DST_ALPHA,[Et]:l.CONSTANT_COLOR,[Vt]:l.ONE_MINUS_CONSTANT_COLOR,[Yt]:l.CONSTANT_ALPHA,[gi]:l.ONE_MINUS_CONSTANT_ALPHA};function gt(je,Pt,Ht,bi,ri,rn,si,ei,un,Ui){if(je===D){K===!0&&(vi(l.BLEND),K=!1);return}if(K===!1&&(Wn(l.BLEND),K=!0),je!==oe){if(je!==ee||Ui!==Ve){if((X!==te||Ae!==te)&&(l.blendEquation(l.FUNC_ADD),X=te,Ae=te),Ui)switch(je){case U:l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case F:l.blendFunc(l.ONE,l.ONE);break;case j:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case Y:l.blendFuncSeparate(l.ZERO,l.SRC_COLOR,l.ZERO,l.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",je);break}else switch(je){case U:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case F:l.blendFunc(l.SRC_ALPHA,l.ONE);break;case j:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case Y:l.blendFunc(l.ZERO,l.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",je);break}Q=null,ge=null,he=null,Qe=null,Be.set(0,0,0),Oe=0,ee=je,Ve=Ui}return}ri=ri||Pt,rn=rn||Ht,si=si||bi,(Pt!==X||ri!==Ae)&&(l.blendEquationSeparate(et[Pt],et[ri]),X=Pt,Ae=ri),(Ht!==Q||bi!==ge||rn!==he||si!==Qe)&&(l.blendFuncSeparate(wt[Ht],wt[bi],wt[rn],wt[si]),Q=Ht,ge=bi,he=rn,Qe=si),(ei.equals(Be)===!1||un!==Oe)&&(l.blendColor(ei.r,ei.g,ei.b,un),Be.copy(ei),Oe=un),ee=je,Ve=!1}function kt(je,Pt){je.side===P?vi(l.CULL_FACE):Wn(l.CULL_FACE);let Ht=je.side===L;Pt&&(Ht=!Ht),Ft(Ht),je.blending===U&&je.transparent===!1?gt(D):gt(je.blending,je.blendEquation,je.blendSrc,je.blendDst,je.blendEquationAlpha,je.blendSrcAlpha,je.blendDstAlpha,je.blendColor,je.blendAlpha,je.premultipliedAlpha),a.setFunc(je.depthFunc),a.setTest(je.depthTest),a.setMask(je.depthWrite),s.setMask(je.colorWrite);const bi=je.stencilWrite;d.setTest(bi),bi&&(d.setMask(je.stencilWriteMask),d.setFunc(je.stencilFunc,je.stencilRef,je.stencilFuncMask),d.setOp(je.stencilFail,je.stencilZFail,je.stencilZPass)),ai(je.polygonOffset,je.polygonOffsetFactor,je.polygonOffsetUnits),je.alphaToCoverage===!0?Wn(l.SAMPLE_ALPHA_TO_COVERAGE):vi(l.SAMPLE_ALPHA_TO_COVERAGE)}function Ft(je){_e!==je&&(je?l.frontFace(l.CW):l.frontFace(l.CCW),_e=je)}function Dt(je){je!==g?(Wn(l.CULL_FACE),je!==xe&&(je===u?l.cullFace(l.BACK):je===E?l.cullFace(l.FRONT):l.cullFace(l.FRONT_AND_BACK))):vi(l.CULL_FACE),xe=je}function $t(je){je!==ze&&(at&&l.lineWidth(je),ze=je)}function ai(je,Pt,Ht){je?(Wn(l.POLYGON_OFFSET_FILL),(qe!==Pt||Ke!==Ht)&&(l.polygonOffset(Pt,Ht),qe=Pt,Ke=Ht)):vi(l.POLYGON_OFFSET_FILL)}function Qi(je){je?Wn(l.SCISSOR_TEST):vi(l.SCISSOR_TEST)}function qi(je){je===void 0&&(je=l.TEXTURE0+$e-1),ct!==je&&(l.activeTexture(je),ct=je)}function Pn(je,Pt,Ht){Ht===void 0&&(ct===null?Ht=l.TEXTURE0+$e-1:Ht=ct);let bi=Ut[Ht];bi===void 0&&(bi={type:void 0,texture:void 0},Ut[Ht]=bi),(bi.type!==je||bi.texture!==Pt)&&(ct!==Ht&&(l.activeTexture(Ht),ct=Ht),l.bindTexture(je,Pt||Dn[je]),bi.type=je,bi.texture=Pt)}function dr(){const je=Ut[ct];je!==void 0&&je.type!==void 0&&(l.bindTexture(je.type,null),je.type=void 0,je.texture=void 0)}function er(){try{l.compressedTexImage2D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ue(){try{l.compressedTexImage3D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ce(){try{l.texSubImage2D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function ut(){try{l.texSubImage3D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ct(){try{l.compressedTexSubImage2D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function It(){try{l.compressedTexSubImage3D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Mt(){try{l.texStorage2D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ci(){try{l.texStorage3D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Wt(){try{l.texImage2D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function ci(){try{l.texImage3D.apply(l,arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Un(je){an.equals(je)===!1&&(l.scissor(je.x,je.y,je.z,je.w),an.copy(je))}function hi(je){Nn.equals(je)===!1&&(l.viewport(je.x,je.y,je.z,je.w),Nn.copy(je))}function Mi(je,Pt){let Ht=I.get(Pt);Ht===void 0&&(Ht=new WeakMap,I.set(Pt,Ht));let bi=Ht.get(je);bi===void 0&&(bi=l.getUniformBlockIndex(Pt,je.name),Ht.set(je,bi))}function nn(je,Pt){const bi=I.get(Pt).get(je);v.get(Pt)!==bi&&(l.uniformBlockBinding(Pt,bi,je.__bindingPointIndex),v.set(Pt,bi))}function Fi(){l.disable(l.BLEND),l.disable(l.CULL_FACE),l.disable(l.DEPTH_TEST),l.disable(l.POLYGON_OFFSET_FILL),l.disable(l.SCISSOR_TEST),l.disable(l.STENCIL_TEST),l.disable(l.SAMPLE_ALPHA_TO_COVERAGE),l.blendEquation(l.FUNC_ADD),l.blendFunc(l.ONE,l.ZERO),l.blendFuncSeparate(l.ONE,l.ZERO,l.ONE,l.ZERO),l.blendColor(0,0,0,0),l.colorMask(!0,!0,!0,!0),l.clearColor(0,0,0,0),l.depthMask(!0),l.depthFunc(l.LESS),l.clearDepth(1),l.stencilMask(4294967295),l.stencilFunc(l.ALWAYS,0,4294967295),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.clearStencil(0),l.cullFace(l.BACK),l.frontFace(l.CCW),l.polygonOffset(0,0),l.activeTexture(l.TEXTURE0),l.bindFramebuffer(l.FRAMEBUFFER,null),l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.useProgram(null),l.lineWidth(1),l.scissor(0,0,l.canvas.width,l.canvas.height),l.viewport(0,0,l.canvas.width,l.canvas.height),R={},ct=null,Ut={},O={},k=new WeakMap,G=[],z=null,K=!1,ee=null,X=null,Q=null,ge=null,Ae=null,he=null,Qe=null,Be=new li(0,0,0),Oe=0,Ve=!1,_e=null,xe=null,ze=null,qe=null,Ke=null,an.set(0,0,l.canvas.width,l.canvas.height),Nn.set(0,0,l.canvas.width,l.canvas.height),s.reset(),a.reset(),d.reset()}return{buffers:{color:s,depth:a,stencil:d},enable:Wn,disable:vi,bindFramebuffer:bt,drawBuffers:Kt,useProgram:Zt,setBlending:gt,setMaterial:kt,setFlipSided:Ft,setCullFace:Dt,setLineWidth:$t,setPolygonOffset:ai,setScissorTest:Qi,activeTexture:qi,bindTexture:Pn,unbindTexture:dr,compressedTexImage2D:er,compressedTexImage3D:Ue,texImage2D:Wt,texImage3D:ci,updateUBOMapping:Mi,uniformBlockBinding:nn,texStorage2D:Mt,texStorage3D:Ci,texSubImage2D:Ce,texSubImage3D:ut,compressedTexSubImage2D:Ct,compressedTexSubImage3D:It,scissor:Un,viewport:hi,reset:Fi}}function IC(l,e,i,n,s,a,d){const v=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,I=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),R=e.has("OCULUS_multiview")?e.get("OCULUS_multiview"):null,O=new xt,k=new WeakMap;let G;const z=new WeakMap;let K=[],ee=!1,X=!1;try{X=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function Q(Ue,Ce){return X?new OffscreenCanvas(Ue,Ce):wa("canvas")}function ge(Ue,Ce,ut){let Ct=1;const It=er(Ue);if((It.width>ut||It.height>ut)&&(Ct=ut/Math.max(It.width,It.height)),Ct<1)if(typeof HTMLImageElement<"u"&&Ue instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ue instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ue instanceof ImageBitmap||typeof VideoFrame<"u"&&Ue instanceof VideoFrame){const Mt=Math.floor(Ct*It.width),Ci=Math.floor(Ct*It.height);G===void 0&&(G=Q(Mt,Ci));const Wt=Ce?Q(Mt,Ci):G;return Wt.width=Mt,Wt.height=Ci,Wt.getContext("2d").drawImage(Ue,0,0,Mt,Ci),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+It.width+"x"+It.height+") to ("+Mt+"x"+Ci+")."),Wt}else return"data"in Ue&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+It.width+"x"+It.height+")."),Ue;return Ue}function Ae(Ue){return Ue.generateMipmaps&&Ue.minFilter!==zt&&Ue.minFilter!==wi}function he(Ue){l.generateMipmap(Ue)}function Qe(Ue,Ce,ut,Ct,It=!1){if(Ue!==null){if(l[Ue]!==void 0)return l[Ue];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ue+"'")}let Mt=Ce;if(Ce===l.RED&&(ut===l.FLOAT&&(Mt=l.R32F),ut===l.HALF_FLOAT&&(Mt=l.R16F),ut===l.UNSIGNED_BYTE&&(Mt=l.R8)),Ce===l.RED_INTEGER&&(ut===l.UNSIGNED_BYTE&&(Mt=l.R8UI),ut===l.UNSIGNED_SHORT&&(Mt=l.R16UI),ut===l.UNSIGNED_INT&&(Mt=l.R32UI),ut===l.BYTE&&(Mt=l.R8I),ut===l.SHORT&&(Mt=l.R16I),ut===l.INT&&(Mt=l.R32I)),Ce===l.RG&&(ut===l.FLOAT&&(Mt=l.RG32F),ut===l.HALF_FLOAT&&(Mt=l.RG16F),ut===l.UNSIGNED_BYTE&&(Mt=l.RG8)),Ce===l.RG_INTEGER&&(ut===l.UNSIGNED_BYTE&&(Mt=l.RG8UI),ut===l.UNSIGNED_SHORT&&(Mt=l.RG16UI),ut===l.UNSIGNED_INT&&(Mt=l.RG32UI),ut===l.BYTE&&(Mt=l.RG8I),ut===l.SHORT&&(Mt=l.RG16I),ut===l.INT&&(Mt=l.RG32I)),Ce===l.RGB&&ut===l.UNSIGNED_INT_5_9_9_9_REV&&(Mt=l.RGB9_E5),Ce===l.RGBA){const Ci=It?va:Fn.getTransfer(Ct);ut===l.FLOAT&&(Mt=l.RGBA32F),ut===l.HALF_FLOAT&&(Mt=l.RGBA16F),ut===l.UNSIGNED_BYTE&&(Mt=Ci===jn?l.SRGB8_ALPHA8:l.RGBA8),ut===l.UNSIGNED_SHORT_4_4_4_4&&(Mt=l.RGBA4),ut===l.UNSIGNED_SHORT_5_5_5_1&&(Mt=l.RGB5_A1)}return(Mt===l.R16F||Mt===l.R32F||Mt===l.RG16F||Mt===l.RG32F||Mt===l.RGBA16F||Mt===l.RGBA32F)&&e.get("EXT_color_buffer_float"),Mt}function Be(Ue,Ce){return Ae(Ue)===!0||Ue.isFramebufferTexture&&Ue.minFilter!==zt&&Ue.minFilter!==wi?Math.log2(Math.max(Ce.width,Ce.height))+1:Ue.mipmaps!==void 0&&Ue.mipmaps.length>0?Ue.mipmaps.length:Ue.isCompressedTexture&&Array.isArray(Ue.image)?Ce.mipmaps.length:1}function Oe(Ue){const Ce=Ue.target;Ce.removeEventListener("dispose",Oe),_e(Ce),Ce.isVideoTexture&&k.delete(Ce)}function Ve(Ue){const Ce=Ue.target;Ce.removeEventListener("dispose",Ve),ze(Ce)}function _e(Ue){const Ce=n.get(Ue);if(Ce.__webglInit===void 0)return;const ut=Ue.source,Ct=z.get(ut);if(Ct){const It=Ct[Ce.__cacheKey];It.usedTimes--,It.usedTimes===0&&xe(Ue),Object.keys(Ct).length===0&&z.delete(ut)}n.remove(Ue)}function xe(Ue){const Ce=n.get(Ue);l.deleteTexture(Ce.__webglTexture);const ut=Ue.source,Ct=z.get(ut);delete Ct[Ce.__cacheKey],d.memory.textures--}function ze(Ue){const Ce=n.get(Ue);if(Ue.depthTexture&&Ue.depthTexture.dispose(),Ue.isWebGLCubeRenderTarget)for(let Ct=0;Ct<6;Ct++){if(Array.isArray(Ce.__webglFramebuffer[Ct]))for(let It=0;It<Ce.__webglFramebuffer[Ct].length;It++)l.deleteFramebuffer(Ce.__webglFramebuffer[Ct][It]);else l.deleteFramebuffer(Ce.__webglFramebuffer[Ct]);Ce.__webglDepthbuffer&&l.deleteRenderbuffer(Ce.__webglDepthbuffer[Ct])}else{if(Array.isArray(Ce.__webglFramebuffer))for(let Ct=0;Ct<Ce.__webglFramebuffer.length;Ct++)l.deleteFramebuffer(Ce.__webglFramebuffer[Ct]);else l.deleteFramebuffer(Ce.__webglFramebuffer);if(Ce.__webglDepthbuffer&&l.deleteRenderbuffer(Ce.__webglDepthbuffer),Ce.__webglMultisampledFramebuffer&&l.deleteFramebuffer(Ce.__webglMultisampledFramebuffer),Ce.__webglColorRenderbuffer)for(let Ct=0;Ct<Ce.__webglColorRenderbuffer.length;Ct++)Ce.__webglColorRenderbuffer[Ct]&&l.deleteRenderbuffer(Ce.__webglColorRenderbuffer[Ct]);Ce.__webglDepthRenderbuffer&&l.deleteRenderbuffer(Ce.__webglDepthRenderbuffer)}const ut=Ue.textures;for(let Ct=0,It=ut.length;Ct<It;Ct++){const Mt=n.get(ut[Ct]);Mt.__webglTexture&&(l.deleteTexture(Mt.__webglTexture),d.memory.textures--),n.remove(ut[Ct])}n.remove(Ue)}let qe=0;function Ke(){qe=0}function $e(){const Ue=qe;return Ue>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ue+" texture units while this GPU supports only "+s.maxTextures),qe+=1,Ue}function at(Ue){const Ce=[];return Ce.push(Ue.wrapS),Ce.push(Ue.wrapT),Ce.push(Ue.wrapR||0),Ce.push(Ue.magFilter),Ce.push(Ue.minFilter),Ce.push(Ue.anisotropy),Ce.push(Ue.internalFormat),Ce.push(Ue.format),Ce.push(Ue.type),Ce.push(Ue.generateMipmaps),Ce.push(Ue.premultiplyAlpha),Ce.push(Ue.flipY),Ce.push(Ue.unpackAlignment),Ce.push(Ue.colorSpace),Ce.join()}function vt(Ue,Ce){const ut=n.get(Ue);if(Ue.isVideoTexture&&Pn(Ue),Ue.isRenderTargetTexture===!1&&Ue.version>0&&ut.__version!==Ue.version){const Ct=Ue.image;if(Ct===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ct.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(vi(ut,Ue,Ce))return}i.bindTexture(l.TEXTURE_2D,ut.__webglTexture,l.TEXTURE0+Ce)}function jt(Ue,Ce){const ut=n.get(Ue);if(Ue.version>0&&ut.__version!==Ue.version){vi(ut,Ue,Ce);return}i.bindTexture(l.TEXTURE_2D_ARRAY,ut.__webglTexture,l.TEXTURE0+Ce)}function ct(Ue,Ce){const ut=n.get(Ue);if(Ue.version>0&&ut.__version!==Ue.version){vi(ut,Ue,Ce);return}i.bindTexture(l.TEXTURE_3D,ut.__webglTexture,l.TEXTURE0+Ce)}function Ut(Ue,Ce){const ut=n.get(Ue);if(Ue.version>0&&ut.__version!==Ue.version){bt(ut,Ue,Ce);return}i.bindTexture(l.TEXTURE_CUBE_MAP,ut.__webglTexture,l.TEXTURE0+Ce)}const Qt={[Fe]:l.REPEAT,[We]:l.CLAMP_TO_EDGE,[Rt]:l.MIRRORED_REPEAT},fi={[zt]:l.NEAREST,[Lt]:l.NEAREST_MIPMAP_NEAREST,[ti]:l.NEAREST_MIPMAP_LINEAR,[wi]:l.LINEAR,[Xn]:l.LINEAR_MIPMAP_NEAREST,[In]:l.LINEAR_MIPMAP_LINEAR},an={[fh]:l.NEVER,[yh]:l.ALWAYS,[ph]:l.LESS,[cc]:l.LEQUAL,[Ah]:l.EQUAL,[vh]:l.GEQUAL,[mh]:l.GREATER,[gh]:l.NOTEQUAL};function Nn(Ue,Ce){if(Ce.type===Yn&&e.has("OES_texture_float_linear")===!1&&(Ce.magFilter===wi||Ce.magFilter===Xn||Ce.magFilter===ti||Ce.magFilter===In||Ce.minFilter===wi||Ce.minFilter===Xn||Ce.minFilter===ti||Ce.minFilter===In)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),l.texParameteri(Ue,l.TEXTURE_WRAP_S,Qt[Ce.wrapS]),l.texParameteri(Ue,l.TEXTURE_WRAP_T,Qt[Ce.wrapT]),(Ue===l.TEXTURE_3D||Ue===l.TEXTURE_2D_ARRAY)&&l.texParameteri(Ue,l.TEXTURE_WRAP_R,Qt[Ce.wrapR]),l.texParameteri(Ue,l.TEXTURE_MAG_FILTER,fi[Ce.magFilter]),l.texParameteri(Ue,l.TEXTURE_MIN_FILTER,fi[Ce.minFilter]),Ce.compareFunction&&(l.texParameteri(Ue,l.TEXTURE_COMPARE_MODE,l.COMPARE_REF_TO_TEXTURE),l.texParameteri(Ue,l.TEXTURE_COMPARE_FUNC,an[Ce.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Ce.magFilter===zt||Ce.minFilter!==ti&&Ce.minFilter!==In||Ce.type===Yn&&e.has("OES_texture_float_linear")===!1)return;if(Ce.anisotropy>1||n.get(Ce).__currentAnisotropy){const ut=e.get("EXT_texture_filter_anisotropic");l.texParameterf(Ue,ut.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ce.anisotropy,s.getMaxAnisotropy())),n.get(Ce).__currentAnisotropy=Ce.anisotropy}}}function $n(Ue,Ce){let ut=!1;Ue.__webglInit===void 0&&(Ue.__webglInit=!0,Ce.addEventListener("dispose",Oe));const Ct=Ce.source;let It=z.get(Ct);It===void 0&&(It={},z.set(Ct,It));const Mt=at(Ce);if(Mt!==Ue.__cacheKey){It[Mt]===void 0&&(It[Mt]={texture:l.createTexture(),usedTimes:0},d.memory.textures++,ut=!0),It[Mt].usedTimes++;const Ci=It[Ue.__cacheKey];Ci!==void 0&&(It[Ue.__cacheKey].usedTimes--,Ci.usedTimes===0&&xe(Ce)),Ue.__cacheKey=Mt,Ue.__webglTexture=It[Mt].texture}return ut}function Dn(Ue){ee=Ue}function Wn(){const Ue=ee;ee=!1;for(const Ce of K)vi(Ce.textureProperties,Ce.texture,Ce.slot),Ce.texture.isPendingDeferredUpload=!1;K=[],ee=Ue}function vi(Ue,Ce,ut){if(ee)return Ce.isPendingDeferredUpload||(Ce.isPendingDeferredUpload=!0,K.push({textureProperties:Ue,texture:Ce,slot:ut})),!1;let Ct=l.TEXTURE_2D;(Ce.isDataArrayTexture||Ce.isCompressedArrayTexture)&&(Ct=l.TEXTURE_2D_ARRAY),Ce.isData3DTexture&&(Ct=l.TEXTURE_3D);const It=$n(Ue,Ce),Mt=Ce.source;i.bindTexture(Ct,Ue.__webglTexture,l.TEXTURE0+ut);const Ci=n.get(Mt);if(Mt.version!==Ci.__version||It===!0){i.activeTexture(l.TEXTURE0+ut);const Wt=Fn.getPrimaries(Fn.workingColorSpace),ci=Ce.colorSpace===Hr?null:Fn.getPrimaries(Ce.colorSpace),Un=Ce.colorSpace===Hr||Wt===ci?l.NONE:l.BROWSER_DEFAULT_WEBGL;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,Ce.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,Ce.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,Un);let hi=ge(Ce.image,!1,s.maxTextureSize);hi=dr(Ce,hi);const Mi=a.convert(Ce.format,Ce.colorSpace),nn=a.convert(Ce.type);let Fi=Qe(Ce.internalFormat,Mi,nn,Ce.colorSpace,Ce.isVideoTexture);Nn(Ct,Ce);let je;const Pt=Ce.mipmaps,Ht=Ce.isVideoTexture!==!0,bi=Ci.__version===void 0||It===!0,ri=Mt.dataReady,rn=Be(Ce,hi);if(Ce.isDepthTexture)Fi=l.DEPTH_COMPONENT16,Ce.type===Yn?Fi=l.DEPTH_COMPONENT32F:Ce.type===Tr?Fi=l.DEPTH_COMPONENT24:Ce.type===ss&&(Fi=l.DEPTH24_STENCIL8),bi&&(Ht?i.texStorage2D(l.TEXTURE_2D,1,Fi,hi.width,hi.height):i.texImage2D(l.TEXTURE_2D,0,Fi,hi.width,hi.height,0,Mi,nn,null));else if(Ce.isDataTexture)if(Pt.length>0){Ht&&bi&&i.texStorage2D(l.TEXTURE_2D,rn,Fi,Pt[0].width,Pt[0].height);for(let si=0,ei=Pt.length;si<ei;si++)je=Pt[si],Ht?ri&&i.texSubImage2D(l.TEXTURE_2D,si,0,0,je.width,je.height,Mi,nn,je.data):i.texImage2D(l.TEXTURE_2D,si,Fi,je.width,je.height,0,Mi,nn,je.data);Ce.generateMipmaps=!1}else Ht?(bi&&i.texStorage2D(l.TEXTURE_2D,rn,Fi,hi.width,hi.height),ri&&i.texSubImage2D(l.TEXTURE_2D,0,0,0,hi.width,hi.height,Mi,nn,hi.data)):i.texImage2D(l.TEXTURE_2D,0,Fi,hi.width,hi.height,0,Mi,nn,hi.data);else if(Ce.isCompressedTexture)if(Ce.isCompressedArrayTexture){Ht&&bi&&i.texStorage3D(l.TEXTURE_2D_ARRAY,rn,Fi,Pt[0].width,Pt[0].height,hi.depth);for(let si=0,ei=Pt.length;si<ei;si++)je=Pt[si],Ce.format!==Ne?Mi!==null?Ht?ri&&i.compressedTexSubImage3D(l.TEXTURE_2D_ARRAY,si,0,0,0,je.width,je.height,hi.depth,Mi,je.data,0,0):i.compressedTexImage3D(l.TEXTURE_2D_ARRAY,si,Fi,je.width,je.height,hi.depth,0,je.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ht?ri&&i.texSubImage3D(l.TEXTURE_2D_ARRAY,si,0,0,0,je.width,je.height,hi.depth,Mi,nn,je.data):i.texImage3D(l.TEXTURE_2D_ARRAY,si,Fi,je.width,je.height,hi.depth,0,Mi,nn,je.data)}else{Ht&&bi&&i.texStorage2D(l.TEXTURE_2D,rn,Fi,Pt[0].width,Pt[0].height);for(let si=0,ei=Pt.length;si<ei;si++)je=Pt[si],Ce.format!==Ne?Mi!==null?Ht?ri&&i.compressedTexSubImage2D(l.TEXTURE_2D,si,0,0,je.width,je.height,Mi,je.data):i.compressedTexImage2D(l.TEXTURE_2D,si,Fi,je.width,je.height,0,je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ht?ri&&i.texSubImage2D(l.TEXTURE_2D,si,0,0,je.width,je.height,Mi,nn,je.data):i.texImage2D(l.TEXTURE_2D,si,Fi,je.width,je.height,0,Mi,nn,je.data)}else if(Ce.isDataArrayTexture)Ht?(bi&&i.texStorage3D(l.TEXTURE_2D_ARRAY,rn,Fi,hi.width,hi.height,hi.depth),ri&&i.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,0,hi.width,hi.height,hi.depth,Mi,nn,hi.data)):i.texImage3D(l.TEXTURE_2D_ARRAY,0,Fi,hi.width,hi.height,hi.depth,0,Mi,nn,hi.data);else if(Ce.isData3DTexture)Ht?(bi&&i.texStorage3D(l.TEXTURE_3D,rn,Fi,hi.width,hi.height,hi.depth),ri&&i.texSubImage3D(l.TEXTURE_3D,0,0,0,0,hi.width,hi.height,hi.depth,Mi,nn,hi.data)):i.texImage3D(l.TEXTURE_3D,0,Fi,hi.width,hi.height,hi.depth,0,Mi,nn,hi.data);else if(Ce.isFramebufferTexture){if(bi)if(Ht)i.texStorage2D(l.TEXTURE_2D,rn,Fi,hi.width,hi.height);else{let si=hi.width,ei=hi.height;for(let un=0;un<rn;un++)i.texImage2D(l.TEXTURE_2D,un,Fi,si,ei,0,Mi,nn,null),si>>=1,ei>>=1}}else if(Pt.length>0){if(Ht&&bi){const si=er(Pt[0]);i.texStorage2D(l.TEXTURE_2D,rn,Fi,si.width,si.height)}for(let si=0,ei=Pt.length;si<ei;si++)je=Pt[si],Ht?ri&&i.texSubImage2D(l.TEXTURE_2D,si,0,0,Mi,nn,je):i.texImage2D(l.TEXTURE_2D,si,Fi,Mi,nn,je);Ce.generateMipmaps=!1}else if(Ht){if(bi){const si=er(hi);i.texStorage2D(l.TEXTURE_2D,rn,Fi,si.width,si.height)}ri&&i.texSubImage2D(l.TEXTURE_2D,0,0,0,Mi,nn,hi)}else i.texImage2D(l.TEXTURE_2D,0,Fi,Mi,nn,hi);Ae(Ce)&&he(Ct),Ci.__version=Mt.version,Ce.onUpdate&&Ce.onUpdate(Ce)}return Ue.__version=Ce.version,!0}function bt(Ue,Ce,ut){if(Ce.image.length!==6)return;const Ct=$n(Ue,Ce),It=Ce.source;i.bindTexture(l.TEXTURE_CUBE_MAP,Ue.__webglTexture,l.TEXTURE0+ut);const Mt=n.get(It);if(It.version!==Mt.__version||Ct===!0){i.activeTexture(l.TEXTURE0+ut);const Ci=Fn.getPrimaries(Fn.workingColorSpace),Wt=Ce.colorSpace===Hr?null:Fn.getPrimaries(Ce.colorSpace),ci=Ce.colorSpace===Hr||Ci===Wt?l.NONE:l.BROWSER_DEFAULT_WEBGL;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,Ce.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,Ce.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,ci);const Un=Ce.isCompressedTexture||Ce.image[0].isCompressedTexture,hi=Ce.image[0]&&Ce.image[0].isDataTexture,Mi=[];for(let ei=0;ei<6;ei++)!Un&&!hi?Mi[ei]=ge(Ce.image[ei],!0,s.maxCubemapSize):Mi[ei]=hi?Ce.image[ei].image:Ce.image[ei],Mi[ei]=dr(Ce,Mi[ei]);const nn=Mi[0],Fi=a.convert(Ce.format,Ce.colorSpace),je=a.convert(Ce.type),Pt=Qe(Ce.internalFormat,Fi,je,Ce.colorSpace),Ht=Ce.isVideoTexture!==!0,bi=Mt.__version===void 0||Ct===!0,ri=It.dataReady;let rn=Be(Ce,nn);Nn(l.TEXTURE_CUBE_MAP,Ce);let si;if(Un){Ht&&bi&&i.texStorage2D(l.TEXTURE_CUBE_MAP,rn,Pt,nn.width,nn.height);for(let ei=0;ei<6;ei++){si=Mi[ei].mipmaps;for(let un=0;un<si.length;un++){const Ui=si[un];Ce.format!==Ne?Fi!==null?Ht?ri&&i.compressedTexSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un,0,0,Ui.width,Ui.height,Fi,Ui.data):i.compressedTexImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un,Pt,Ui.width,Ui.height,0,Ui.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ht?ri&&i.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un,0,0,Ui.width,Ui.height,Fi,je,Ui.data):i.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un,Pt,Ui.width,Ui.height,0,Fi,je,Ui.data)}}}else{if(si=Ce.mipmaps,Ht&&bi){si.length>0&&rn++;const ei=er(Mi[0]);i.texStorage2D(l.TEXTURE_CUBE_MAP,rn,Pt,ei.width,ei.height)}for(let ei=0;ei<6;ei++)if(hi){Ht?ri&&i.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,0,0,0,Mi[ei].width,Mi[ei].height,Fi,je,Mi[ei].data):i.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,0,Pt,Mi[ei].width,Mi[ei].height,0,Fi,je,Mi[ei].data);for(let un=0;un<si.length;un++){const Pr=si[un].image[ei].image;Ht?ri&&i.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un+1,0,0,Pr.width,Pr.height,Fi,je,Pr.data):i.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un+1,Pt,Pr.width,Pr.height,0,Fi,je,Pr.data)}}else{Ht?ri&&i.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,0,0,0,Fi,je,Mi[ei]):i.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,0,Pt,Fi,je,Mi[ei]);for(let un=0;un<si.length;un++){const Ui=si[un];Ht?ri&&i.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un+1,0,0,Fi,je,Ui.image[ei]):i.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+ei,un+1,Pt,Fi,je,Ui.image[ei])}}}Ae(Ce)&&he(l.TEXTURE_CUBE_MAP),Mt.__version=It.version,Ce.onUpdate&&Ce.onUpdate(Ce)}Ue.__version=Ce.version}function Kt(Ue,Ce,ut,Ct,It,Mt){const Ci=a.convert(ut.format,ut.colorSpace),Wt=a.convert(ut.type),ci=Qe(ut.internalFormat,Ci,Wt,ut.colorSpace);if(!n.get(Ce).__hasExternalTextures){const Mi=Math.max(1,Ce.width>>Mt),nn=Math.max(1,Ce.height>>Mt);Ce.isWebGLMultiviewRenderTarget===!0?i.texStorage3D(l.TEXTURE_2D_ARRAY,0,ci,Ce.width,Ce.height,Ce.numViews):It===l.TEXTURE_3D||It===l.TEXTURE_2D_ARRAY?i.texImage3D(It,Mt,ci,Mi,nn,Ce.depth,0,Ci,Wt,null):i.texImage2D(It,Mt,ci,Mi,nn,0,Ci,Wt,null)}i.bindFramebuffer(l.FRAMEBUFFER,Ue);const hi=qi(Ce);Ce.isWebGLMultiviewRenderTarget===!0?hi?R.framebufferTextureMultisampleMultiviewOVR(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,n.get(ut).__webglTexture,0,Qi(Ce),0,Ce.numViews):R.framebufferTextureMultiviewOVR(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,n.get(ut).__webglTexture,0,0,Ce.numViews):(It===l.TEXTURE_2D||It>=l.TEXTURE_CUBE_MAP_POSITIVE_X&&It<=l.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(hi?v.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,Ct,It,n.get(ut).__webglTexture,0,Qi(Ce)):l.framebufferTexture2D(l.FRAMEBUFFER,Ct,It,n.get(ut).__webglTexture,Mt)),i.bindFramebuffer(l.FRAMEBUFFER,null)}function Zt(Ue,Ce,ut){if(l.bindRenderbuffer(l.RENDERBUFFER,Ue),Ce.isWebGLMultiviewRenderTarget===!0){const Ct=qi(Ce),It=Ce.numViews,Mt=Ce.depthTexture;let Ci=l.DEPTH_COMPONENT24,Wt=l.DEPTH_ATTACHMENT;Mt&&Mt.isDepthTexture&&(Mt.type===Yn?Ci=l.DEPTH_COMPONENT32F:Mt.type===ss&&(Ci=l.DEPTH24_STENCIL8,Wt=l.DEPTH_STENCIL_ATTACHMENT));let ci=n.get(Ce.depthTexture).__webglTexture;ci===void 0&&(ci=l.createTexture(),l.bindTexture(l.TEXTURE_2D_ARRAY,ci),l.texStorage3D(l.TEXTURE_2D_ARRAY,1,Ci,Ce.width,Ce.height,It)),Ct?R.framebufferTextureMultisampleMultiviewOVR(l.FRAMEBUFFER,Wt,ci,0,Qi(Ce),0,It):R.framebufferTextureMultiviewOVR(l.FRAMEBUFFER,Wt,ci,0,0,It)}else if(Ce.depthBuffer&&!Ce.stencilBuffer){let Ct=l.DEPTH_COMPONENT24;if(ut||qi(Ce)){const It=Ce.depthTexture;It&&It.isDepthTexture&&(It.type===Yn?Ct=l.DEPTH_COMPONENT32F:It.type===Tr&&(Ct=l.DEPTH_COMPONENT24));const Mt=Qi(Ce);qi(Ce)?v.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,Mt,Ct,Ce.width,Ce.height):l.renderbufferStorageMultisample(l.RENDERBUFFER,Mt,Ct,Ce.width,Ce.height)}else l.renderbufferStorage(l.RENDERBUFFER,Ct,Ce.width,Ce.height);l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,Ue)}else if(Ce.depthBuffer&&Ce.stencilBuffer){const Ct=Qi(Ce);ut&&qi(Ce)===!1?l.renderbufferStorageMultisample(l.RENDERBUFFER,Ct,l.DEPTH24_STENCIL8,Ce.width,Ce.height):qi(Ce)?v.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,Ct,l.DEPTH24_STENCIL8,Ce.width,Ce.height):l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,Ce.width,Ce.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,Ue)}else{const Ct=Ce.textures;for(let It=0;It<Ct.length;It++){const Mt=Ct[It],Ci=a.convert(Mt.format,Mt.colorSpace),Wt=a.convert(Mt.type),ci=Qe(Mt.internalFormat,Ci,Wt,Mt.colorSpace),Un=Qi(Ce);ut&&qi(Ce)===!1?l.renderbufferStorageMultisample(l.RENDERBUFFER,Un,ci,Ce.width,Ce.height):qi(Ce)?v.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,Un,ci,Ce.width,Ce.height):l.renderbufferStorage(l.RENDERBUFFER,ci,Ce.width,Ce.height)}}l.bindRenderbuffer(l.RENDERBUFFER,null)}function et(Ue,Ce){if(Ce&&Ce.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(l.FRAMEBUFFER,Ue),!(Ce.depthTexture&&Ce.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(Ce.depthTexture).__webglTexture||Ce.depthTexture.image.width!==Ce.width||Ce.depthTexture.image.height!==Ce.height)&&(Ce.depthTexture.image.width=Ce.width,Ce.depthTexture.image.height=Ce.height,Ce.depthTexture.needsUpdate=!0),vt(Ce.depthTexture,0),Ce.depthTexture.image.depth!=1?jt(Ce.depthTexture,0):vt(Ce.depthTexture,0);const Ct=n.get(Ce.depthTexture).__webglTexture,It=Qi(Ce);if(Ce.isWebGLMultiviewRenderTarget===!0){const Mt=qi(Ce),Ci=Ce.numViews;if(Ce.depthTexture.format===nt)Mt?R.framebufferTextureMultisampleMultiviewOVR(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,Ct,0,It,0,Ci):R.framebufferTextureMultiviewOVR(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,Ct,0,0,Ci);else if(Ce.depthTexture.format===At)Mt?R.framebufferTextureMultisampleMultiviewOVR(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,Ct,0,It,0,Ci):R.framebufferTextureMultiviewOVR(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,Ct,0,0,Ci);else throw new Error("Unknown depthTexture format")}else if(Ce.depthTexture.format===nt)qi(Ce)?v.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,Ct,0,It):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,Ct,0);else if(Ce.depthTexture.format===At)qi(Ce)?v.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,Ct,0,It):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,Ct,0);else throw new Error("Unknown depthTexture format")}function wt(Ue){const Ce=n.get(Ue),ut=Ue.isWebGLCubeRenderTarget===!0;if(Ue.depthTexture&&!Ce.__autoAllocateDepthBuffer){if(ut)throw new Error("target.depthTexture not supported in Cube render targets");et(Ce.__webglFramebuffer,Ue)}else if(ut){Ce.__webglDepthbuffer=[];for(let Ct=0;Ct<6;Ct++)i.bindFramebuffer(l.FRAMEBUFFER,Ce.__webglFramebuffer[Ct]),Ce.__webglDepthbuffer[Ct]=l.createRenderbuffer(),Zt(Ce.__webglDepthbuffer[Ct],Ue,!1)}else i.bindFramebuffer(l.FRAMEBUFFER,Ce.__webglFramebuffer),Ce.__webglDepthbuffer=l.createRenderbuffer(),Zt(Ce.__webglDepthbuffer,Ue,!1);i.bindFramebuffer(l.FRAMEBUFFER,null)}function gt(Ue,Ce,ut){const Ct=n.get(Ue);Ce!==void 0&&Kt(Ct.__webglFramebuffer,Ue,Ue.texture,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,0),ut!==void 0&&wt(Ue)}function kt(Ue){const Ce=Ue.texture,ut=n.get(Ue),Ct=n.get(Ce);Ue.addEventListener("dispose",Ve);const It=Ue.textures,Mt=Ue.isWebGLCubeRenderTarget===!0,Ci=It.length>1;if(Ci||(Ct.__webglTexture===void 0&&(Ct.__webglTexture=l.createTexture()),Ct.__version=Ce.version,d.memory.textures++),Mt){ut.__webglFramebuffer=[];for(let Wt=0;Wt<6;Wt++)if(Ce.mipmaps&&Ce.mipmaps.length>0){ut.__webglFramebuffer[Wt]=[];for(let ci=0;ci<Ce.mipmaps.length;ci++)ut.__webglFramebuffer[Wt][ci]=l.createFramebuffer()}else ut.__webglFramebuffer[Wt]=l.createFramebuffer()}else{if(Ce.mipmaps&&Ce.mipmaps.length>0){ut.__webglFramebuffer=[];for(let Wt=0;Wt<Ce.mipmaps.length;Wt++)ut.__webglFramebuffer[Wt]=l.createFramebuffer()}else ut.__webglFramebuffer=l.createFramebuffer();if(Ci)for(let Wt=0,ci=It.length;Wt<ci;Wt++){const Un=n.get(It[Wt]);Un.__webglTexture===void 0&&(Un.__webglTexture=l.createTexture(),d.memory.textures++)}if(Ue.samples>0&&qi(Ue)===!1){ut.__webglMultisampledFramebuffer=l.createFramebuffer(),ut.__webglColorRenderbuffer=[],i.bindFramebuffer(l.FRAMEBUFFER,ut.__webglMultisampledFramebuffer);for(let Wt=0;Wt<It.length;Wt++){const ci=It[Wt];ut.__webglColorRenderbuffer[Wt]=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,ut.__webglColorRenderbuffer[Wt]);const Un=a.convert(ci.format,ci.colorSpace),hi=a.convert(ci.type),Mi=Qe(ci.internalFormat,Un,hi,ci.colorSpace,Ue.isXRRenderTarget===!0),nn=Qi(Ue);l.renderbufferStorageMultisample(l.RENDERBUFFER,nn,Mi,Ue.width,Ue.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+Wt,l.RENDERBUFFER,ut.__webglColorRenderbuffer[Wt])}l.bindRenderbuffer(l.RENDERBUFFER,null),Ue.depthBuffer&&(ut.__webglDepthRenderbuffer=l.createRenderbuffer(),Zt(ut.__webglDepthRenderbuffer,Ue,!0)),i.bindFramebuffer(l.FRAMEBUFFER,null)}}if(Mt){i.bindTexture(l.TEXTURE_CUBE_MAP,Ct.__webglTexture),Nn(l.TEXTURE_CUBE_MAP,Ce);for(let Wt=0;Wt<6;Wt++)if(Ce.mipmaps&&Ce.mipmaps.length>0)for(let ci=0;ci<Ce.mipmaps.length;ci++)Kt(ut.__webglFramebuffer[Wt][ci],Ue,Ce,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,ci);else Kt(ut.__webglFramebuffer[Wt],Ue,Ce,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,0);Ae(Ce)&&he(l.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(Ci){for(let Wt=0,ci=It.length;Wt<ci;Wt++){const Un=It[Wt],hi=n.get(Un);i.bindTexture(l.TEXTURE_2D,hi.__webglTexture),Nn(l.TEXTURE_2D,Un),Kt(ut.__webglFramebuffer,Ue,Un,l.COLOR_ATTACHMENT0+Wt,l.TEXTURE_2D,0),Ae(Un)&&he(l.TEXTURE_2D)}i.unbindTexture()}else{let Wt=l.TEXTURE_2D;if((Ue.isWebGL3DRenderTarget||Ue.isWebGLArrayRenderTarget)&&(Wt=Ue.isWebGL3DRenderTarget?l.TEXTURE_3D:l.TEXTURE_2D_ARRAY),Ue.isWebGLMultiviewRenderTarget===!0&&(Wt=l.TEXTURE_2D_ARRAY),i.bindTexture(Wt,Ct.__webglTexture),Nn(Wt,Ce),Ce.mipmaps&&Ce.mipmaps.length>0)for(let ci=0;ci<Ce.mipmaps.length;ci++)Kt(ut.__webglFramebuffer[ci],Ue,Ce,l.COLOR_ATTACHMENT0,Wt,ci);else Kt(ut.__webglFramebuffer,Ue,Ce,l.COLOR_ATTACHMENT0,Wt,0);Ae(Ce)&&he(Wt),i.unbindTexture()}(Ue.depthBuffer||Ue.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(Ue)}function Ft(Ue){const Ce=Ue.textures;for(let ut=0,Ct=Ce.length;ut<Ct;ut++){const It=Ce[ut];if(Ae(It)){const Mt=Ue.isWebGLCubeRenderTarget?l.TEXTURE_CUBE_MAP:l.TEXTURE_2D,Ci=n.get(It).__webglTexture;i.bindTexture(Mt,Ci),he(Mt),i.unbindTexture()}}}const Dt=[],$t=[];function ai(Ue){if(Ue.samples>0){if(qi(Ue)===!1){const Ce=Ue.textures,ut=Ue.width,Ct=Ue.height;let It=l.COLOR_BUFFER_BIT;const Mt=Ue.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,Ci=n.get(Ue),Wt=Ce.length>1;if(Wt)for(let ci=0;ci<Ce.length;ci++)i.bindFramebuffer(l.FRAMEBUFFER,Ci.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+ci,l.RENDERBUFFER,null),i.bindFramebuffer(l.FRAMEBUFFER,Ci.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+ci,l.TEXTURE_2D,null,0);i.bindFramebuffer(l.READ_FRAMEBUFFER,Ci.__webglMultisampledFramebuffer),i.bindFramebuffer(l.DRAW_FRAMEBUFFER,Ci.__webglFramebuffer);for(let ci=0;ci<Ce.length;ci++){if(Ue.resolveDepthBuffer&&(Ue.depthBuffer&&(It|=l.DEPTH_BUFFER_BIT),Ue.stencilBuffer&&Ue.resolveStencilBuffer&&(It|=l.STENCIL_BUFFER_BIT)),Wt){l.framebufferRenderbuffer(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,Ci.__webglColorRenderbuffer[ci]);const Un=n.get(Ce[ci]).__webglTexture;l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,Un,0)}l.blitFramebuffer(0,0,ut,Ct,0,0,ut,Ct,It,l.NEAREST),I===!0&&(Dt.length=0,$t.length=0,Dt.push(l.COLOR_ATTACHMENT0+ci),Ue.depthBuffer&&Ue.resolveDepthBuffer===!1&&(Dt.push(Mt),$t.push(Mt),l.invalidateFramebuffer(l.DRAW_FRAMEBUFFER,$t)),l.invalidateFramebuffer(l.READ_FRAMEBUFFER,Dt))}if(i.bindFramebuffer(l.READ_FRAMEBUFFER,null),i.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),Wt)for(let ci=0;ci<Ce.length;ci++){i.bindFramebuffer(l.FRAMEBUFFER,Ci.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+ci,l.RENDERBUFFER,Ci.__webglColorRenderbuffer[ci]);const Un=n.get(Ce[ci]).__webglTexture;i.bindFramebuffer(l.FRAMEBUFFER,Ci.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+ci,l.TEXTURE_2D,Un,0)}i.bindFramebuffer(l.DRAW_FRAMEBUFFER,Ci.__webglMultisampledFramebuffer)}else if(Ue.depthBuffer&&Ue.resolveDepthBuffer===!1&&I){const Ce=Ue.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT;l.invalidateFramebuffer(l.DRAW_FRAMEBUFFER,[Ce])}}}function Qi(Ue){return Math.min(s.maxSamples,Ue.samples)}function qi(Ue){const Ce=n.get(Ue);return Ue.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Ce.__useRenderToTexture!==!1}function Pn(Ue){const Ce=d.render.frame;k.get(Ue)!==Ce&&(k.set(Ue,Ce),Ue.update())}function dr(Ue,Ce){const ut=Ue.colorSpace,Ct=Ue.format,It=Ue.type;return Ue.isCompressedTexture===!0||Ue.isVideoTexture===!0||ut!==Ws&&ut!==Hr&&(Fn.getTransfer(ut)===jn?(Ct!==Ne||It!==Qn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ut)),Ce}function er(Ue){return typeof HTMLImageElement<"u"&&Ue instanceof HTMLImageElement?(O.width=Ue.naturalWidth||Ue.width,O.height=Ue.naturalHeight||Ue.height):typeof VideoFrame<"u"&&Ue instanceof VideoFrame?(O.width=Ue.displayWidth,O.height=Ue.displayHeight):(O.width=Ue.width,O.height=Ue.height),O}this.allocateTextureUnit=$e,this.resetTextureUnits=Ke,this.setTexture2D=vt,this.setTexture2DArray=jt,this.setTexture3D=ct,this.setTextureCube=Ut,this.rebindTextures=gt,this.uploadTexture=vi,this.setupRenderTarget=kt,this.updateRenderTargetMipmap=Ft,this.updateMultisampleRenderTarget=ai,this.setupDepthTexture=et,this.setupDepthRenderbuffer=wt,this.setupFrameBufferTexture=Kt,this.useMultisampledRTT=qi,this.runDeferredUploads=Wn,this.setDeferTextureUploads=Dn}function Dm(l,e){function i(n,s=Hr){let a;const d=Fn.getTransfer(s);if(n===Qn)return l.UNSIGNED_BYTE;if(n===lr)return l.UNSIGNED_SHORT_4_4_4_4;if(n===Hs)return l.UNSIGNED_SHORT_5_5_5_1;if(n===oo)return l.UNSIGNED_INT_5_9_9_9_REV;if(n===ms)return l.BYTE;if(n===sr)return l.SHORT;if(n===Qr)return l.UNSIGNED_SHORT;if(n===gs)return l.INT;if(n===Tr)return l.UNSIGNED_INT;if(n===Yn)return l.FLOAT;if(n===Bn)return l.HALF_FLOAT;if(n===Fs)return l.ALPHA;if(n===we)return l.RGB;if(n===Ne)return l.RGBA;if(n===Ye)return l.LUMINANCE;if(n===ht)return l.LUMINANCE_ALPHA;if(n===nt)return l.DEPTH_COMPONENT;if(n===At)return l.DEPTH_STENCIL;if(n===Bt)return l.RED;if(n===oi)return l.RED_INTEGER;if(n===qt)return l.RG;if(n===mt)return l.RG_INTEGER;if(n===pi)return l.RGBA_INTEGER;if(n===Ai||n===Li||n===Mn||n===Ki)if(d===jn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===Ai)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Li)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Mn)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Ki)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===Ai)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Li)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Mn)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Ki)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===ki||n===sn||n===Gn||n===cr)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===ki)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===sn)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Gn)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===cr)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Nt||n===Xi||n===Zn)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(n===Nt||n===Xi)return d===jn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===Zn)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===hn||n===W||n===Z||n===le||n===me||n===Ee||n===He||n===q||n===ie||n===ce||n===ne||n===re||n===ke||n===Ze)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(n===hn)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===W)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Z)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===le)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===me)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Ee)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===He)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===q)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===ie)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===ce)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===ne)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===re)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===ke)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Ze)return d===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===st||n===dt||n===Ot)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(n===st)return d===jn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===dt)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Ot)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===ft||n===_t||n===di||n===ni)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(n===st)return a.COMPRESSED_RED_RGTC1_EXT;if(n===_t)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===di)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===ni)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===ss?l.UNSIGNED_INT_24_8:l[n]!==void 0?l[n]:null}return{convert:i}}class Ra extends Ln{constructor(){super(),this.isGroup=!0,this.type="Group"}}class jf extends Rr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}var Pm=new Ie,Om=new Ie;function BC(l,e,i){Pm.setFromMatrixPosition(e.matrixWorld),Om.setFromMatrixPosition(i.matrixWorld);var n=Pm.distanceTo(Om),s=e.projectionMatrix.elements,a=i.projectionMatrix.elements,d=s[14]/(s[10]-1),v=s[14]/(s[10]+1),I=(s[9]+1)/s[5],R=(s[9]-1)/s[5],O=(s[8]-1)/s[0],k=(a[8]+1)/a[0],G=d*O,z=d*k,K=n/(-O+k),ee=K*-O;e.matrixWorld.decompose(l.position,l.quaternion,l.scale),l.translateX(ee),l.translateZ(K),l.matrixWorld.compose(l.position,l.quaternion,l.scale),l.matrixWorldInverse.copy(l.matrixWorld).invert();var X=d+K,Q=v+K,ge=G-ee,Ae=z+(n-ee),he=I*v/Q*X,Qe=R*v/Q*X;l.projectionMatrix.makePerspective(ge,Ae,he,Qe,X,Q)}function Fm(l){var e,i,n=this,s=null,a=null,d=null,v=[],I=new mi,R=new mi,O=1,k="local-floor";typeof window<"u"&&"VRFrameData"in window&&(a=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",he,!1));var G=new mi,z=new Rn,K=new Ie,ee=new Rr;ee.viewport=new _n,ee.layers.enable(1);var X=new Rr;X.viewport=new _n,X.layers.enable(2);var Q=new jf([ee,X]);Q.layers.enable(1),Q.layers.enable(2);var ge=new xt,Ae;function he(){var ze=n.isPresenting=s!==null&&s.isPresenting===!0;if(ze){var qe=s.getEyeParameters("left");e=2*qe.renderWidth*O,i=qe.renderHeight*O,Ae=l.getPixelRatio(),l.getSize(ge),l.setDrawingBufferSize(e,i,1),ee.viewport.set(0,0,e/2,i),X.viewport.set(e/2,0,e/2,i),xe.start(),n.dispatchEvent({type:"sessionstart"})}else n.enabled&&l.setDrawingBufferSize(ge.width,ge.height,Ae),xe.stop(),n.dispatchEvent({type:"sessionend"})}var Qe=[],Be=[];function Oe(ze){for(var qe=navigator.getGamepads&&navigator.getGamepads(),Ke=0,$e=qe.length;Ke<$e;Ke++){var at=qe[Ke];if(at&&(at.id==="Daydream Controller"||at.id==="Gear VR Controller"||at.id==="Oculus Go Controller"||at.id==="OpenVR Gamepad"||at.id.startsWith("Oculus Touch")||at.id.startsWith("HTC Vive Focus")||at.id.startsWith("Spatial Controller"))){var vt=at.hand;if(ze===0&&(vt===""||vt==="right")||ze===1&&vt==="left")return at}}}function Ve(){for(var ze=0;ze<v.length;ze++){var qe=v[ze],Ke=Oe(ze);if(Ke!==void 0&&Ke.pose!==void 0){if(Ke.pose===null)return;var $e=Ke.pose;$e.hasPosition===!1&&qe.position.set(.2,-.6,-.05),$e.position!==null&&qe.position.fromArray($e.position),$e.orientation!==null&&qe.quaternion.fromArray($e.orientation),qe.matrix.compose(qe.position,qe.quaternion,qe.scale),qe.matrix.premultiply(I),qe.matrix.decompose(qe.position,qe.quaternion,qe.scale),qe.matrixWorldNeedsUpdate=!0,qe.visible=!0;var at=Ke.id==="Daydream Controller"?0:1;Qe[ze]===void 0&&(Qe[ze]=!1),Qe[ze]!==Ke.buttons[at].pressed&&(Qe[ze]=Ke.buttons[at].pressed,Qe[ze]===!0?qe.dispatchEvent({type:"selectstart"}):(qe.dispatchEvent({type:"selectend"}),qe.dispatchEvent({type:"select"}))),at=2,Be[ze]===void 0&&(Be[ze]=!1),Ke.buttons[at]!==void 0&&Be[ze]!==Ke.buttons[at].pressed&&(Be[ze]=Ke.buttons[at].pressed,Be[ze]===!0?qe.dispatchEvent({type:"squeezestart"}):(qe.dispatchEvent({type:"squeezeend"}),qe.dispatchEvent({type:"squeeze"})))}else qe.visible=!1}}function _e(ze,qe){qe!==null&&qe.length===4&&ze.set(qe[0]*e,qe[1]*i,qe[2]*e,qe[3]*i)}this.enabled=!1,this.getController=function(ze){var qe=v[ze];return qe===void 0&&(qe=new Ra,qe.matrixAutoUpdate=!1,qe.visible=!1,v[ze]=qe),qe},this.getDevice=function(){return s},this.setDevice=function(ze){ze!==void 0&&(s=ze),xe.setContext(ze)},this.setFramebufferScaleFactor=function(ze){O=ze},this.setReferenceSpaceType=function(ze){k=ze},this.setPoseTarget=function(ze){ze!==void 0&&(d=ze)},this.cameraAutoUpdate=!0,this.updateCamera=function(ze){var qe=k==="local-floor"?1.6:0;if(s.depthNear=ze.near,s.depthFar=ze.far,s.getFrameData(a),k==="local-floor"){var Ke=s.stageParameters;Ke?I.fromArray(Ke.sittingToStandingTransform):I.makeTranslation(0,qe,0)}var $e=a.pose,at=d!==null?d:ze;at.matrix.copy(I),at.matrix.decompose(at.position,at.quaternion,at.scale),$e.orientation!==null&&(z.fromArray($e.orientation),at.quaternion.multiply(z)),$e.position!==null&&(z.setFromRotationMatrix(I),K.fromArray($e.position),K.applyQuaternion(z),at.position.add(K)),at.updateMatrixWorld();for(var vt=at.children,jt=0,ct=vt.length;jt<ct;jt++)vt[jt].updateMatrixWorld(!0);ee.near=ze.near,X.near=ze.near,ee.far=ze.far,X.far=ze.far,ee.matrixWorldInverse.fromArray(a.leftViewMatrix),X.matrixWorldInverse.fromArray(a.rightViewMatrix),R.copy(I).invert(),k==="local-floor"&&(ee.matrixWorldInverse.multiply(R),X.matrixWorldInverse.multiply(R));var Ut=at.parent;Ut!==null&&(G.copy(Ut.matrixWorld).invert(),ee.matrixWorldInverse.multiply(G),X.matrixWorldInverse.multiply(G)),ee.matrixWorld.copy(ee.matrixWorldInverse).invert(),X.matrixWorld.copy(X.matrixWorldInverse).invert(),ee.projectionMatrix.fromArray(a.leftProjectionMatrix),X.projectionMatrix.fromArray(a.rightProjectionMatrix),BC(Q,ee,X);var Qt=s.getLayers();if(Qt.length){var fi=Qt[0];_e(ee.viewport,fi.leftBounds),_e(X.viewport,fi.rightBounds)}return Ve(),Q},this.getCamera=function(){return Q},this.getFoveation=function(){return 1},this.setFoveation=function(ze){ze!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(n.isPresenting)return"opaque"},this.getStandingMatrix=function(){return I},this.isPresenting=!1;var xe=new Lf;this.setAnimationLoop=function(ze){xe.setAnimationLoop(ze),this.isPresenting&&xe.start()},this.submitFrame=function(){this.isPresenting&&s.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",he)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(Fm.prototype,{addEventListener:as.prototype.addEventListener,hasEventListener:as.prototype.hasEventListener,removeEventListener:as.prototype.removeEventListener,dispatchEvent:as.prototype.dispatchEvent});class Nm extends ys{constructor(e,i,n,s={}){super(e,i,s),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}copy(e){return super.copy(e),this.numViews=e.numViews,this}}Nm.prototype.isWebGLMultiviewRenderTarget=!0;const RC={type:"move"};class Wf{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ra,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ra,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ra,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const n of e.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,n){let s=null,a=null,d=null;const v=this._targetRay,I=this._grip,R=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(R&&e.hand){d=!0;for(const ee of e.hand.values()){const X=i.getJointPose(ee,n),Q=this._getHandJoint(R,ee);X!==null&&(Q.matrix.fromArray(X.transform.matrix),Q.matrix.decompose(Q.position,Q.rotation,Q.scale),Q.matrixWorldNeedsUpdate=!0,Q.jointRadius=X.radius),Q.visible=X!==null}const O=R.joints["index-finger-tip"],k=R.joints["thumb-tip"],G=O.position.distanceTo(k.position),z=.02,K=.005;R.inputState.pinching&&G>z+K?(R.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!R.inputState.pinching&&G<=z-K&&(R.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else I!==null&&e.gripSpace&&(a=i.getPose(e.gripSpace,n),a!==null&&(I.matrix.fromArray(a.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,a.linearVelocity?(I.hasLinearVelocity=!0,I.linearVelocity.copy(a.linearVelocity)):I.hasLinearVelocity=!1,a.angularVelocity?(I.hasAngularVelocity=!0,I.angularVelocity.copy(a.angularVelocity)):I.hasAngularVelocity=!1));v!==null&&(s=i.getPose(e.targetRaySpace,n),s===null&&a!==null&&(s=a),s!==null&&(v.matrix.fromArray(s.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,s.linearVelocity?(v.hasLinearVelocity=!0,v.linearVelocity.copy(s.linearVelocity)):v.hasLinearVelocity=!1,s.angularVelocity?(v.hasAngularVelocity=!0,v.angularVelocity.copy(s.angularVelocity)):v.hasAngularVelocity=!1,this.dispatchEvent(RC)))}return v!==null&&(v.visible=s!==null),I!==null&&(I.visible=a!==null),R!==null&&(R.visible=d!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const n=new Ra;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[i.jointName]=n,e.add(n)}return e.joints[i.jointName]}}const LC=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,DC=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class PC{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,i,n){if(this.texture===null){const s=new qn,a=e.properties.get(s);a.__webglTexture=i.texture,(i.depthNear!=n.depthNear||i.depthFar!=n.depthFar)&&(this.depthNear=i.depthNear,this.depthFar=i.depthFar),this.texture=s}}render(e,i){if(this.texture!==null){if(this.mesh===null){const n=i.cameras[0].viewport,s=new Xs({vertexShader:LC,fragmentShader:DC,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new wr(new xl(20,20),s)}e.render(this.mesh,i)}}reset(){this.texture=null,this.mesh=null}}class OC extends as{constructor(e,i,n,s){super();const a=this;let d=null,v=1;var I=null;let R=null,O="local-floor",k=1,G=null,z=null;var K=[];let ee=null,X=null,Q=null,ge=null;const Ae=new PC,he=i.getContextAttributes();let Qe=null,Be=null;const Oe=[],Ve=[],_e=new xt;let xe=null;const ze=new Rr;ze.layers.enable(1),ze.viewport=new _n;const qe=new Rr;qe.layers.enable(2),qe.viewport=new _n;const Ke=[ze,qe],$e=new jf;$e.layers.enable(1),$e.layers.enable(2);let at=null,vt=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return z},this.getController=function(bt){let Kt=Oe[bt];return Kt===void 0&&(Kt=new Wf,Oe[bt]=Kt),Kt.getTargetRaySpace()},this.getControllerGrip=function(bt){let Kt=Oe[bt];return Kt===void 0&&(Kt=new Wf,Oe[bt]=Kt),Kt.getGripSpace()},this.getHand=function(bt){let Kt=Oe[bt];return Kt===void 0&&(Kt=new Wf,Oe[bt]=Kt),Kt.getHandSpace()};function jt(bt){const Kt=Ve.indexOf(bt.inputSource);if(Kt===-1)return;const Zt=Oe[Kt];Zt!==void 0&&(Zt.update(bt.inputSource,bt.frame,G||R),Zt.dispatchEvent({type:bt.type,data:bt.inputSource}))}function ct(){d.removeEventListener("select",jt),d.removeEventListener("selectstart",jt),d.removeEventListener("selectend",jt),d.removeEventListener("squeeze",jt),d.removeEventListener("squeezestart",jt),d.removeEventListener("squeezeend",jt),d.removeEventListener("end",ct),d.removeEventListener("inputsourceschange",Ut);for(let bt=0;bt<Oe.length;bt++){const Kt=Ve[bt];Kt!==null&&(Ve[bt]=null,Oe[bt].disconnect(Kt))}at=null,vt=null,Ae.reset(),e.setRenderTarget(Qe),Q=null,X=null,ee=null,d=null,Be=null,vi.stop(),a.isPresenting=!1,e.setPixelRatio(xe),e.setSize(_e.width,_e.height,!1),a.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(bt){v=bt,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(bt){O=bt,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return G||R},this.setReferenceSpace=function(bt){G=bt},this.getBaseLayer=function(){return X!==null?X:Q},this.getBinding=function(){return ee},this.getFrame=function(){return ge},this.getSession=function(){return d},this.setSession=async function(bt){if(d=bt,d!==null){if(Qe=e.getRenderTarget(),d.addEventListener("select",jt),d.addEventListener("selectstart",jt),d.addEventListener("selectend",jt),d.addEventListener("squeeze",jt),d.addEventListener("squeezestart",jt),d.addEventListener("squeezeend",jt),d.addEventListener("end",ct),d.addEventListener("inputsourceschange",Ut),he.xrCompatible!==!0&&await i.makeXRCompatible(),xe=e.getPixelRatio(),e.getSize(_e),d.renderState.layers===void 0){const Kt={antialias:he.antialias,alpha:!0,depth:he.depth,stencil:he.stencil,framebufferScaleFactor:v};Q=new XRWebGLLayer(d,i,Kt),d.updateRenderState({baseLayer:Q}),e.setPixelRatio(1),e.setSize(Q.framebufferWidth,Q.framebufferHeight,!1),Be=new ys(Q.framebufferWidth,Q.framebufferHeight,{format:Ne,type:Qn,colorSpace:e.outputColorSpace,stencilBuffer:he.stencil})}else{let Kt=null,Zt=null,et=null;he.depth&&(et=he.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,Kt=he.stencil?At:nt,Zt=he.stencil?ss:Tr),a.isMultiview=s&&n.has("OCULUS_multiview");const wt={colorFormat:i.RGBA8,depthFormat:et,scaleFactor:v};a.isMultiview&&(wt.textureType="texture-array"),ee=new XRWebGLBinding(d,i),X=ee.createProjectionLayer(wt),d.updateRenderState({layers:[X]}),e.setPixelRatio(1),e.setSize(X.textureWidth,X.textureHeight,!1);const gt={format:Ne,type:Qn,depthTexture:new Gf(X.textureWidth,X.textureHeight,Zt,void 0,void 0,void 0,void 0,void 0,void 0,Kt),stencilBuffer:he.stencil,colorSpace:e.outputColorSpace,samples:he.antialias?4:0,resolveDepthBuffer:X.ignoreDepthValues===!1};if(a.isMultiview){const kt=n.get("OCULUS_multiview");this.maxNumViews=i.getParameter(kt.MAX_VIEWS_OVR),Be=new Nm(X.textureWidth,X.textureHeight,2,gt)}else Be=new ys(X.textureWidth,X.textureHeight,gt)}Be.isXRRenderTarget=!0,this.setFoveation(k),G=null,R=await d.requestReferenceSpace(O),vi.setContext(d),vi.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(d!==null)return d.environmentBlendMode},this.addLayer=function(bt){!window.XRWebGLBinding||!this.layersEnabled||!d||(K.push(bt),this.updateLayers())},this.removeLayer=function(bt){K.splice(K.indexOf(bt),1),!(!window.XRWebGLBinding||!this.layersEnabled||!d)&&this.updateLayers()},this.updateLayers=function(){var bt=K.map(function(Kt){return Kt});bt.unshift(d.renderState.layers[0]),d.updateRenderState({layers:bt})};function Ut(bt){for(let Kt=0;Kt<bt.removed.length;Kt++){const Zt=bt.removed[Kt],et=Ve.indexOf(Zt);et>=0&&(Ve[et]=null,Oe[et].disconnect(Zt))}for(let Kt=0;Kt<bt.added.length;Kt++){const Zt=bt.added[Kt];let et=Ve.indexOf(Zt);if(et===-1){for(let gt=0;gt<Oe.length;gt++)if(gt>=Ve.length){Ve.push(Zt),et=gt;break}else if(Ve[gt]===null){Ve[gt]=Zt,et=gt;break}if(et===-1)break}const wt=Oe[et];wt&&wt.connect(Zt)}}const Qt=new Ie,fi=new Ie;function an(bt,Kt,Zt){Qt.setFromMatrixPosition(Kt.matrixWorld),fi.setFromMatrixPosition(Zt.matrixWorld);const et=Qt.distanceTo(fi),wt=Kt.projectionMatrix.elements,gt=Zt.projectionMatrix.elements,kt=wt[14]/(wt[10]-1),Ft=wt[14]/(wt[10]+1),Dt=(wt[9]+1)/wt[5],$t=(wt[9]-1)/wt[5],ai=(wt[8]-1)/wt[0],Qi=(gt[8]+1)/gt[0],qi=kt*ai,Pn=kt*Qi,dr=et/(-ai+Qi),er=dr*-ai;Kt.matrixWorld.decompose(bt.position,bt.quaternion,bt.scale),bt.translateX(er),bt.translateZ(dr),bt.matrixWorld.compose(bt.position,bt.quaternion,bt.scale),bt.matrixWorldInverse.copy(bt.matrixWorld).invert();const Ue=kt+dr,Ce=Ft+dr,ut=qi-er,Ct=Pn+(et-er),It=Dt*Ft/Ce*Ue,Mt=$t*Ft/Ce*Ue;bt.projectionMatrix.makePerspective(ut,Ct,It,Mt,Ue,Ce),bt.projectionMatrixInverse.copy(bt.projectionMatrix).invert()}function Nn(bt,Kt){Kt===null?bt.matrixWorld.copy(bt.matrix):bt.matrixWorld.multiplyMatrices(Kt.matrixWorld,bt.matrix),bt.matrixWorldInverse.copy(bt.matrixWorld).invert()}this.setPoseTarget=function(bt){bt!==void 0&&(I=bt)},this.updateCamera=function(bt){if(d===null)return;Ae.texture!==null&&(bt.near=Ae.depthNear,bt.far=Ae.depthFar),$e.near=qe.near=ze.near=bt.near,$e.far=qe.far=ze.far=bt.far,(at!==$e.near||vt!==$e.far)&&(d.updateRenderState({depthNear:$e.near,depthFar:$e.far}),at=$e.near,vt=$e.far,ze.near=at,ze.far=vt,qe.near=at,qe.far=vt,ze.updateProjectionMatrix(),qe.updateProjectionMatrix(),bt.updateProjectionMatrix());const Kt=$e.cameras;var Zt=I||bt;const et=Zt.parent;Nn($e,et);for(let wt=0;wt<Kt.length;wt++)Nn(Kt[wt],et);Kt.length===2?an($e,ze,qe):$e.projectionMatrix.copy(ze.projectionMatrix),$n(bt,$e,Zt)};function $n(bt,Kt,Zt){Kt.matrixWorld.decompose(Kt.position,Kt.quaternion,Kt.scale),Zt.parent===null?Zt.matrix.copy(Kt.matrixWorld):(Zt.matrix.copy(Zt.parent.matrixWorld),Zt.matrix.invert(),Zt.matrix.multiply(Kt.matrixWorld)),Zt.matrix.decompose(Zt.position,Zt.quaternion,Zt.scale),Zt.updateMatrixWorld(!0),bt.projectionMatrix.copy(Kt.projectionMatrix),bt.projectionMatrixInverse.copy(Kt.projectionMatrixInverse),bt.isPerspectiveCamera&&(bt.fov=zo*2*Math.atan(1/bt.projectionMatrix.elements[5]),bt.zoom=1)}this.getCamera=function(){return $e},this.getFoveation=function(){if(!(X===null&&Q===null))return k},this.setFoveation=function(bt){k=bt,X!==null&&(X.fixedFoveation=bt),Q!==null&&Q.fixedFoveation!==void 0&&(Q.fixedFoveation=bt)},this.hasDepthSensing=function(){return Ae.texture!==null};let Dn=null;function Wn(bt,Kt){if(z=Kt.getViewerPose(G||R),ge=Kt,z!==null){const Zt=z.views;Q!==null&&(e.setRenderTargetFramebuffer(Be,Q.framebuffer),e.setRenderTarget(Be));let et=!1;Zt.length!==$e.cameras.length&&($e.cameras.length=0,et=!0);for(let gt=0;gt<Zt.length;gt++){const kt=Zt[gt];let Ft=null;if(Q!==null)Ft=Q.getViewport(kt);else{const $t=ee.getViewSubImage(X,kt);Ft=$t.viewport,gt===0&&(e.setRenderTargetTextures(Be,$t.colorTexture,X.ignoreDepthValues?void 0:$t.depthStencilTexture),e.setRenderTarget(Be))}let Dt=Ke[gt];Dt===void 0&&(Dt=new Rr,Dt.layers.enable(gt),Dt.viewport=new _n,Ke[gt]=Dt),Dt.matrix.fromArray(kt.transform.matrix),Dt.matrix.decompose(Dt.position,Dt.quaternion,Dt.scale),Dt.projectionMatrix.fromArray(kt.projectionMatrix),Dt.projectionMatrixInverse.copy(Dt.projectionMatrix).invert(),Dt.viewport.set(Ft.x,Ft.y,Ft.width,Ft.height),gt===0&&($e.matrix.copy(Dt.matrix),$e.matrix.decompose($e.position,$e.quaternion,$e.scale)),et===!0&&$e.cameras.push(Dt)}const wt=d.enabledFeatures;if(wt&&wt.includes("depth-sensing")){const gt=ee.getDepthInformation(Zt[0]);gt&&gt.isValid&&gt.texture&&Ae.init(e,gt,d.renderState)}}for(let Zt=0;Zt<Oe.length;Zt++){const et=Ve[Zt],wt=Oe[Zt];et!==null&&wt!==void 0&&wt.update(et,Kt,G||R)}Ae.render(e,$e),Dn&&Dn(bt,Kt),Kt.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:Kt}),ge=null}const vi=new Lf;vi.setAnimationLoop(Wn),this.setAnimationLoop=function(bt){Dn=bt},this.dispose=function(){}}}const La=new Is,FC=new mi;function NC(l,e){function i(X,Q){X.matrixAutoUpdate===!0&&X.updateMatrix(),Q.value.copy(X.matrix)}function n(X,Q){Q.color.getRGB(X.fogColor.value,tm(l)),Q.isFog?(X.fogNear.value=Q.near,X.fogFar.value=Q.far):Q.isFogExp2&&(X.fogDensity.value=Q.density)}function s(X,Q,ge,Ae,he){Q.isMeshBasicMaterial||Q.isMeshLambertMaterial?a(X,Q):Q.isMeshToonMaterial?(a(X,Q),k(X,Q)):Q.isMeshPhongMaterial?(a(X,Q),O(X,Q)):Q.isMeshStandardMaterial?(a(X,Q),G(X,Q),Q.isMeshPhysicalMaterial&&z(X,Q,he)):Q.isMeshMatcapMaterial?(a(X,Q),K(X,Q)):Q.isMeshDepthMaterial?a(X,Q):Q.isMeshDistanceMaterial?(a(X,Q),ee(X,Q)):Q.isMeshNormalMaterial?a(X,Q):Q.isLineBasicMaterial?(d(X,Q),Q.isLineDashedMaterial&&v(X,Q)):Q.isPointsMaterial?I(X,Q,ge,Ae):Q.isSpriteMaterial?R(X,Q):Q.isShadowMaterial?(X.color.value.copy(Q.color),X.opacity.value=Q.opacity):Q.isShaderMaterial&&(Q.uniformsNeedUpdate=!1)}function a(X,Q){X.opacity.value=Q.opacity,Q.color&&X.diffuse.value.copy(Q.color),Q.emissive&&X.emissive.value.copy(Q.emissive).multiplyScalar(Q.emissiveIntensity),Q.map&&(X.map.value=Q.map,i(Q.map,X.mapTransform)),Q.alphaMap&&(X.alphaMap.value=Q.alphaMap,i(Q.alphaMap,X.alphaMapTransform)),Q.bumpMap&&(X.bumpMap.value=Q.bumpMap,i(Q.bumpMap,X.bumpMapTransform),X.bumpScale.value=Q.bumpScale,Q.side===L&&(X.bumpScale.value*=-1)),Q.normalMap&&(X.normalMap.value=Q.normalMap,i(Q.normalMap,X.normalMapTransform),X.normalScale.value.copy(Q.normalScale),Q.side===L&&X.normalScale.value.negate()),Q.displacementMap&&(X.displacementMap.value=Q.displacementMap,i(Q.displacementMap,X.displacementMapTransform),X.displacementScale.value=Q.displacementScale,X.displacementBias.value=Q.displacementBias),Q.emissiveMap&&(X.emissiveMap.value=Q.emissiveMap,i(Q.emissiveMap,X.emissiveMapTransform)),Q.specularMap&&(X.specularMap.value=Q.specularMap,i(Q.specularMap,X.specularMapTransform)),Q.alphaTest>0&&(X.alphaTest.value=Q.alphaTest);const ge=e.get(Q),Ae=ge.envMap,he=ge.envMapRotation;if(Ae&&(X.envMap.value=Ae,La.copy(he),La.x*=-1,La.y*=-1,La.z*=-1,Ae.isCubeTexture&&Ae.isRenderTargetTexture===!1&&(La.y*=-1,La.z*=-1),X.envMapRotation.value.setFromMatrix4(FC.makeRotationFromEuler(La)),X.flipEnvMap.value=Ae.isCubeTexture&&Ae.isRenderTargetTexture===!1?-1:1,X.reflectivity.value=Q.reflectivity,X.ior.value=Q.ior,X.refractionRatio.value=Q.refractionRatio),Q.lightMap){X.lightMap.value=Q.lightMap;const Qe=l._useLegacyLights===!0?Math.PI:1;X.lightMapIntensity.value=Q.lightMapIntensity*Qe,i(Q.lightMap,X.lightMapTransform)}Q.aoMap&&(X.aoMap.value=Q.aoMap,X.aoMapIntensity.value=Q.aoMapIntensity,i(Q.aoMap,X.aoMapTransform))}function d(X,Q){X.diffuse.value.copy(Q.color),X.opacity.value=Q.opacity,Q.map&&(X.map.value=Q.map,i(Q.map,X.mapTransform))}function v(X,Q){X.dashSize.value=Q.dashSize,X.totalSize.value=Q.dashSize+Q.gapSize,X.scale.value=Q.scale}function I(X,Q,ge,Ae){X.diffuse.value.copy(Q.color),X.opacity.value=Q.opacity,X.size.value=Q.size*ge,X.scale.value=Ae*.5,Q.map&&(X.map.value=Q.map,i(Q.map,X.uvTransform)),Q.alphaMap&&(X.alphaMap.value=Q.alphaMap,i(Q.alphaMap,X.alphaMapTransform)),Q.alphaTest>0&&(X.alphaTest.value=Q.alphaTest)}function R(X,Q){X.diffuse.value.copy(Q.color),X.opacity.value=Q.opacity,X.rotation.value=Q.rotation,Q.map&&(X.map.value=Q.map,i(Q.map,X.mapTransform)),Q.alphaMap&&(X.alphaMap.value=Q.alphaMap,i(Q.alphaMap,X.alphaMapTransform)),Q.alphaTest>0&&(X.alphaTest.value=Q.alphaTest)}function O(X,Q){X.specular.value.copy(Q.specular),X.shininess.value=Math.max(Q.shininess,1e-4)}function k(X,Q){Q.gradientMap&&(X.gradientMap.value=Q.gradientMap)}function G(X,Q){X.metalness.value=Q.metalness,Q.metalnessMap&&(X.metalnessMap.value=Q.metalnessMap,i(Q.metalnessMap,X.metalnessMapTransform)),X.roughness.value=Q.roughness,Q.roughnessMap&&(X.roughnessMap.value=Q.roughnessMap,i(Q.roughnessMap,X.roughnessMapTransform)),Q.envMap&&(X.envMapIntensity.value=Q.envMapIntensity)}function z(X,Q,ge){X.ior.value=Q.ior,Q.sheen>0&&(X.sheenColor.value.copy(Q.sheenColor).multiplyScalar(Q.sheen),X.sheenRoughness.value=Q.sheenRoughness,Q.sheenColorMap&&(X.sheenColorMap.value=Q.sheenColorMap,i(Q.sheenColorMap,X.sheenColorMapTransform)),Q.sheenRoughnessMap&&(X.sheenRoughnessMap.value=Q.sheenRoughnessMap,i(Q.sheenRoughnessMap,X.sheenRoughnessMapTransform))),Q.clearcoat>0&&(X.clearcoat.value=Q.clearcoat,X.clearcoatRoughness.value=Q.clearcoatRoughness,Q.clearcoatMap&&(X.clearcoatMap.value=Q.clearcoatMap,i(Q.clearcoatMap,X.clearcoatMapTransform)),Q.clearcoatRoughnessMap&&(X.clearcoatRoughnessMap.value=Q.clearcoatRoughnessMap,i(Q.clearcoatRoughnessMap,X.clearcoatRoughnessMapTransform)),Q.clearcoatNormalMap&&(X.clearcoatNormalMap.value=Q.clearcoatNormalMap,i(Q.clearcoatNormalMap,X.clearcoatNormalMapTransform),X.clearcoatNormalScale.value.copy(Q.clearcoatNormalScale),Q.side===L&&X.clearcoatNormalScale.value.negate())),Q.dispersion>0&&(X.dispersion.value=Q.dispersion),Q.iridescence>0&&(X.iridescence.value=Q.iridescence,X.iridescenceIOR.value=Q.iridescenceIOR,X.iridescenceThicknessMinimum.value=Q.iridescenceThicknessRange[0],X.iridescenceThicknessMaximum.value=Q.iridescenceThicknessRange[1],Q.iridescenceMap&&(X.iridescenceMap.value=Q.iridescenceMap,i(Q.iridescenceMap,X.iridescenceMapTransform)),Q.iridescenceThicknessMap&&(X.iridescenceThicknessMap.value=Q.iridescenceThicknessMap,i(Q.iridescenceThicknessMap,X.iridescenceThicknessMapTransform))),Q.transmission>0&&(X.transmission.value=Q.transmission,X.transmissionSamplerMap.value=ge.texture,X.transmissionSamplerSize.value.set(ge.width,ge.height),Q.transmissionMap&&(X.transmissionMap.value=Q.transmissionMap,i(Q.transmissionMap,X.transmissionMapTransform)),X.thickness.value=Q.thickness,Q.thicknessMap&&(X.thicknessMap.value=Q.thicknessMap,i(Q.thicknessMap,X.thicknessMapTransform)),X.attenuationDistance.value=Q.attenuationDistance,X.attenuationColor.value.copy(Q.attenuationColor)),Q.anisotropy>0&&(X.anisotropyVector.value.set(Q.anisotropy*Math.cos(Q.anisotropyRotation),Q.anisotropy*Math.sin(Q.anisotropyRotation)),Q.anisotropyMap&&(X.anisotropyMap.value=Q.anisotropyMap,i(Q.anisotropyMap,X.anisotropyMapTransform))),X.specularIntensity.value=Q.specularIntensity,X.specularColor.value.copy(Q.specularColor),Q.specularColorMap&&(X.specularColorMap.value=Q.specularColorMap,i(Q.specularColorMap,X.specularColorMapTransform)),Q.specularIntensityMap&&(X.specularIntensityMap.value=Q.specularIntensityMap,i(Q.specularIntensityMap,X.specularIntensityMapTransform))}function K(X,Q){Q.matcap&&(X.matcap.value=Q.matcap)}function ee(X,Q){const ge=e.get(Q).light;X.referencePosition.value.setFromMatrixPosition(ge.matrixWorld),X.nearDistance.value=ge.shadow.camera.near,X.farDistance.value=ge.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function kC(l,e,i,n){let s={},a={},d=[];const v=l.getParameter(l.MAX_UNIFORM_BUFFER_BINDINGS);function I(ge,Ae){const he=Ae.program;n.uniformBlockBinding(ge,he)}function R(ge,Ae){let he=s[ge.id];he===void 0&&(K(ge),he=O(ge),s[ge.id]=he,ge.addEventListener("dispose",X));const Qe=Ae.program;n.updateUBOMapping(ge,Qe);const Be=e.render.frame;a[ge.id]!==Be&&(G(ge),a[ge.id]=Be)}function O(ge){const Ae=k();ge.__bindingPointIndex=Ae;const he=l.createBuffer(),Qe=ge.__size,Be=ge.usage;return l.bindBuffer(l.UNIFORM_BUFFER,he),l.bufferData(l.UNIFORM_BUFFER,Qe,Be),l.bindBuffer(l.UNIFORM_BUFFER,null),l.bindBufferBase(l.UNIFORM_BUFFER,Ae,he),he}function k(){for(let ge=0;ge<v;ge++)if(d.indexOf(ge)===-1)return d.push(ge),ge;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function G(ge){const Ae=s[ge.id],he=ge.uniforms,Qe=ge.__cache;l.bindBuffer(l.UNIFORM_BUFFER,Ae);for(let Be=0,Oe=he.length;Be<Oe;Be++){const Ve=Array.isArray(he[Be])?he[Be]:[he[Be]];for(let _e=0,xe=Ve.length;_e<xe;_e++){const ze=Ve[_e];if(z(ze,Be,_e,Qe)===!0){const qe=ze.__offset,Ke=Array.isArray(ze.value)?ze.value:[ze.value];let $e=0;for(let at=0;at<Ke.length;at++){const vt=Ke[at],jt=ee(vt);typeof vt=="number"||typeof vt=="boolean"?(ze.__data[0]=vt,l.bufferSubData(l.UNIFORM_BUFFER,qe+$e,ze.__data)):vt.isMatrix3?(ze.__data[0]=vt.elements[0],ze.__data[1]=vt.elements[1],ze.__data[2]=vt.elements[2],ze.__data[3]=0,ze.__data[4]=vt.elements[3],ze.__data[5]=vt.elements[4],ze.__data[6]=vt.elements[5],ze.__data[7]=0,ze.__data[8]=vt.elements[6],ze.__data[9]=vt.elements[7],ze.__data[10]=vt.elements[8],ze.__data[11]=0):(vt.toArray(ze.__data,$e),$e+=jt.storage/Float32Array.BYTES_PER_ELEMENT)}l.bufferSubData(l.UNIFORM_BUFFER,qe,ze.__data)}}}l.bindBuffer(l.UNIFORM_BUFFER,null)}function z(ge,Ae,he,Qe){const Be=ge.value,Oe=Ae+"_"+he;if(Qe[Oe]===void 0)return typeof Be=="number"||typeof Be=="boolean"?Qe[Oe]=Be:Qe[Oe]=Be.clone(),!0;{const Ve=Qe[Oe];if(typeof Be=="number"||typeof Be=="boolean"){if(Ve!==Be)return Qe[Oe]=Be,!0}else if(Ve.equals(Be)===!1)return Ve.copy(Be),!0}return!1}function K(ge){const Ae=ge.uniforms;let he=0;const Qe=16;for(let Oe=0,Ve=Ae.length;Oe<Ve;Oe++){const _e=Array.isArray(Ae[Oe])?Ae[Oe]:[Ae[Oe]];for(let xe=0,ze=_e.length;xe<ze;xe++){const qe=_e[xe],Ke=Array.isArray(qe.value)?qe.value:[qe.value];for(let $e=0,at=Ke.length;$e<at;$e++){const vt=Ke[$e],jt=ee(vt),ct=he%Qe;ct!==0&&Qe-ct<jt.boundary&&(he+=Qe-ct),qe.__data=new Float32Array(jt.storage/Float32Array.BYTES_PER_ELEMENT),qe.__offset=he,he+=jt.storage}}}const Be=he%Qe;return Be>0&&(he+=Qe-Be),ge.__size=he,ge.__cache={},this}function ee(ge){const Ae={boundary:0,storage:0};return typeof ge=="number"||typeof ge=="boolean"?(Ae.boundary=4,Ae.storage=4):ge.isVector2?(Ae.boundary=8,Ae.storage=8):ge.isVector3||ge.isColor?(Ae.boundary=16,Ae.storage=12):ge.isVector4?(Ae.boundary=16,Ae.storage=16):ge.isMatrix3?(Ae.boundary=48,Ae.storage=48):ge.isMatrix4?(Ae.boundary=64,Ae.storage=64):ge.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",ge),Ae}function X(ge){const Ae=ge.target;Ae.removeEventListener("dispose",X);const he=d.indexOf(Ae.__bindingPointIndex);d.splice(he,1),l.deleteBuffer(s[Ae.id]),delete s[Ae.id],delete a[Ae.id]}function Q(){for(const ge in s)l.deleteBuffer(s[ge]);d=[],s={},a={}}return{bind:I,update:R,dispose:Q}}class UC{constructor(e={}){const{canvas:i=Ch(),context:n=null,depth:s=!0,stencil:a=!1,alpha:d=!1,antialias:v=!1,premultipliedAlpha:I=!0,preserveDrawingBuffer:R=!1,powerPreference:O="default",failIfMajorPerformanceCaveat:k=!1,multiviewStereo:G=!1}=e;this.isWebGLRenderer=!0;let z;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");z=n.getContextAttributes().alpha}else z=d;const K=new Uint32Array(4),ee=new Int32Array(4);let X=null,Q=null;const ge=[],Ae=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=yn,this._useLegacyLights=!1,this.toneMapping=wn,this.toneMappingExposure=1;const he=this;let Qe=!1,Be=0,Oe=0,Ve=null,_e=-1,xe=null;const ze=new _n,qe=new _n;let Ke=null;const $e=new li(0);let at=0,vt=i.width,jt=i.height,ct=1,Ut=null,Qt=null;const fi=new _n(0,0,vt,jt),an=new _n(0,0,vt,jt);let Nn=!1;const $n=new Ec;let Dn=!1,Wn=!1;const vi=new mi,bt=new Ie,Kt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Zt(){return Ve===null?ct:1}let et=n;function wt(Te,tt){return i.getContext(Te,tt)}try{const Te={alpha:!0,depth:s,stencil:a,antialias:v,premultipliedAlpha:I,preserveDrawingBuffer:R,powerPreference:O,failIfMajorPerformanceCaveat:k};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${f}`),i.addEventListener("webglcontextlost",Ht,!1),i.addEventListener("webglcontextrestored",bi,!1),i.addEventListener("webglcontextcreationerror",ri,!1),et===null){const tt="webgl2";if(et=wt(tt,Te),et===null)throw wt(tt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Te){throw console.error("THREE.WebGLRenderer: "+Te.message),Te}let gt,kt,Ft,Dt,$t,ai,Qi,qi,Pn,dr,er,Ue,Ce,ut,Ct,It,Mt,Ci,Wt,ci,Un,hi,Mi,nn,Fi;function je(){gt=new YE(et),gt.init(),Mi=new Dm(et,gt),kt=new QE(et,gt,e,Mi),Ft=new TC(et),Dt=new ZE(et),$t=new mC,ai=new IC(et,gt,Ft,$t,kt,Mi,Dt),Qi=new jE(he),qi=new XE(he),Pn=new Uy(et),nn=new VE(et,Pn),dr=new qE(et,Pn,Dt,nn),er=new tx(et,dr,Pn,Dt),ci=new $E(et,kt,ai),It=new HE($t),Ue=new AC(he,Qi,qi,gt,kt,nn,It),Ce=new NC(he,$t),ut=new vC,Ct=new wC(gt),Wt=new GE(he,Qi,qi,Ft,er,z,I),Ci=new ex(he,gt,et),Mt=new SC(he,er,kt),Fi=new kC(et,Dt,kt,Ft),Un=new zE(et,gt,Dt),hi=new JE(et,gt,Dt),Dt.programs=Ue.programs,he.capabilities=kt,he.extensions=gt,he.properties=$t,he.renderLists=ut,he.shadowMap=Mt,he.state=Ft,he.info=Dt}je();const Pt=typeof navigator<"u"&&"xr"in navigator?new OC(he,et,gt,G):new Fm(he);this.xr=Pt,this.getContext=function(){return et},this.getContextAttributes=function(){return et.getContextAttributes()},this.forceContextLoss=function(){const Te=gt.get("WEBGL_lose_context");Te&&Te.loseContext()},this.forceContextRestore=function(){const Te=gt.get("WEBGL_lose_context");Te&&Te.restoreContext()},this.getPixelRatio=function(){return ct},this.setPixelRatio=function(Te){Te!==void 0&&(ct=Te,this.setSize(vt,jt,!1))},this.getSize=function(Te){return Te.set(vt,jt)},this.setSize=function(Te,tt,lt=!0){if(Pt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}vt=Te,jt=tt,i.width=Math.floor(Te*ct),i.height=Math.floor(tt*ct),lt===!0&&(i.style.width=Te+"px",i.style.height=tt+"px"),this.setViewport(0,0,Te,tt)},this.getDrawingBufferSize=function(Te){return Te.set(vt*ct,jt*ct).floor()},this.setDrawingBufferSize=function(Te,tt,lt){vt=Te,jt=tt,ct=lt,i.width=Math.floor(Te*lt),i.height=Math.floor(tt*lt),this.setViewport(0,0,Te,tt)},this.getCurrentViewport=function(Te){return Te.copy(ze)},this.getViewport=function(Te){return Te.copy(fi)},this.setViewport=function(Te,tt,lt,rt){Te.isVector4?fi.set(Te.x,Te.y,Te.z,Te.w):fi.set(Te,tt,lt,rt),Ft.viewport(ze.copy(fi).multiplyScalar(ct).round())},this.getScissor=function(Te){return Te.copy(an)},this.setScissor=function(Te,tt,lt,rt){Te.isVector4?an.set(Te.x,Te.y,Te.z,Te.w):an.set(Te,tt,lt,rt),Ft.scissor(qe.copy(an).multiplyScalar(ct).round())},this.getScissorTest=function(){return Nn},this.setScissorTest=function(Te){Ft.setScissorTest(Nn=Te)},this.setOpaqueSort=function(Te){Ut=Te},this.setTransparentSort=function(Te){Qt=Te},this.getClearColor=function(Te){return Te.copy(Wt.getClearColor())},this.setClearColor=function(){Wt.setClearColor.apply(Wt,arguments)},this.getClearAlpha=function(){return Wt.getClearAlpha()},this.setClearAlpha=function(){Wt.setClearAlpha.apply(Wt,arguments)},this.clear=function(Te=!0,tt=!0,lt=!0){let rt=0;if(Te){let ot=!1;if(Ve!==null){const ii=Ve.texture.format;ot=ii===pi||ii===mt||ii===oi}if(ot){const ii=Ve.texture.type,Si=ii===Qn||ii===Tr||ii===Qr||ii===ss||ii===lr||ii===Hs,Ii=Wt.getClearColor(),Vi=Wt.getClearAlpha(),Zi=Ii.r,ln=Ii.g,pn=Ii.b;Si?(K[0]=Zi,K[1]=ln,K[2]=pn,K[3]=Vi,et.clearBufferuiv(et.COLOR,0,K)):(ee[0]=Zi,ee[1]=ln,ee[2]=pn,ee[3]=Vi,et.clearBufferiv(et.COLOR,0,ee))}else rt|=et.COLOR_BUFFER_BIT}tt&&(rt|=et.DEPTH_BUFFER_BIT),lt&&(rt|=et.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),et.clear(rt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",Ht,!1),i.removeEventListener("webglcontextrestored",bi,!1),i.removeEventListener("webglcontextcreationerror",ri,!1),ut.dispose(),Ct.dispose(),$t.dispose(),Qi.dispose(),qi.dispose(),er.dispose(),nn.dispose(),Fi.dispose(),Ue.dispose(),Pt.dispose(),Pt.removeEventListener("sessionstart",Ao),Pt.removeEventListener("sessionend",w0),ja.stop()};function Ht(Te){Te.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Qe=!0}function bi(){console.log("THREE.WebGLRenderer: Context Restored."),Qe=!1;const Te=Dt.autoReset,tt=Mt.enabled,lt=Mt.autoUpdate,rt=Mt.needsUpdate,ot=Mt.type;je(),Dt.autoReset=Te,Mt.enabled=tt,Mt.autoUpdate=lt,Mt.needsUpdate=rt,Mt.type=ot}function ri(Te){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Te.statusMessage)}function rn(Te){const tt=Te.target;tt.removeEventListener("dispose",rn),si(tt)}function si(Te){ei(Te),$t.remove(Te)}function ei(Te){const tt=$t.get(Te).programs;tt!==void 0&&(tt.forEach(function(lt){Ue.releaseProgram(lt)}),Te.isShaderMaterial&&Ue.releaseShaderCache(Te))}this.renderBufferDirect=function(Te,tt,lt,rt,ot,ii){tt===null&&(tt=Kt);const Si=ot.isMesh&&ot.matrixWorld.determinant()<0,Ii=D2(Te,tt,lt,rt,ot);Ft.setMaterial(rt,Si);let Vi=lt.index,Zi=1;if(rt.wireframe===!0){if(Vi=dr.getWireframeAttribute(lt),Vi===void 0)return;Zi=2}const ln=lt.drawRange,pn=lt.attributes.position;let Mr=ln.start*Zi,ts=(ln.start+ln.count)*Zi;ii!==null&&(Mr=Math.max(Mr,ii.start*Zi),ts=Math.min(ts,(ii.start+ii.count)*Zi)),Vi!==null?(Mr=Math.max(Mr,0),ts=Math.min(ts,Vi.count)):pn!=null&&(Mr=Math.max(Mr,0),ts=Math.min(ts,pn.count));const Ls=ts-Mr;if(Ls<0||Ls===1/0)return;nn.setup(ot,rt,Ii,lt,Vi);let ra,kn=Un;if(Vi!==null&&(ra=Pn.get(Vi),kn=hi,kn.setIndex(ra)),ot.isMesh)rt.wireframe===!0?(Ft.setLineWidth(rt.wireframeLinewidth*Zt()),kn.setMode(et.LINES)):kn.setMode(et.TRIANGLES);else if(ot.isLine){let Ro=rt.linewidth;Ro===void 0&&(Ro=1),Ft.setLineWidth(Ro*Zt()),ot.isLineSegments?kn.setMode(et.LINES):ot.isLineLoop?kn.setMode(et.LINE_LOOP):kn.setMode(et.LINE_STRIP)}else ot.isPoints?kn.setMode(et.POINTS):ot.isSprite&&kn.setMode(et.TRIANGLES);if(ot.isBatchedMesh)ot._multiDrawInstances!==null?kn.renderMultiDrawInstances(ot._multiDrawStarts,ot._multiDrawCounts,ot._multiDrawCount,ot._multiDrawInstances):kn.renderMultiDraw(ot._multiDrawStarts,ot._multiDrawCounts,ot._multiDrawCount);else if(ot.isInstancedMesh)kn.renderInstances(Mr,Ls,ot.count);else if(lt.isInstancedBufferGeometry){const Ro=lt._maxInstanceCount!==void 0?lt._maxInstanceCount:1/0,dn=Math.min(lt.instanceCount,Ro);kn.renderInstances(Mr,Ls,dn)}else kn.render(Mr,Ls)};function un(Te,tt,lt){Te.transparent===!0&&Te.side===P&&Te.forceSinglePass===!1?(Te.side=L,Te.needsUpdate=!0,Hu(Te,tt,lt),Te.side=S,Te.needsUpdate=!0,Hu(Te,tt,lt),Te.side=P):Hu(Te,tt,lt)}this.compile=function(Te,tt,lt=null){lt===null&&(lt=Te),Q=Ct.get(lt),Q.init(tt),Ae.push(Q),lt.traverseVisible(function(ot){ot.isLight&&ot.layers.test(tt.layers)&&(Q.pushLight(ot),ot.castShadow&&Q.pushShadow(ot))}),Te!==lt&&Te.traverseVisible(function(ot){ot.isLight&&ot.layers.test(tt.layers)&&(Q.pushLight(ot),ot.castShadow&&Q.pushShadow(ot))}),Q.setupLights(he._useLegacyLights);const rt=new Set;return Te.traverse(function(ot){const ii=ot.material;if(ii)if(Array.isArray(ii))for(let Si=0;Si<ii.length;Si++){const Ii=ii[Si];un(Ii,lt,ot),rt.add(Ii)}else un(ii,lt,ot),rt.add(ii)}),Ae.pop(),Q=null,rt},this.compileAsync=function(Te,tt,lt=null){const rt=this.compile(Te,tt,lt);return new Promise(ot=>{function ii(){if(rt.forEach(function(Si){$t.get(Si).currentProgram.isReady()&&rt.delete(Si)}),rt.size===0){ot(Te);return}setTimeout(ii,10)}gt.get("KHR_parallel_shader_compile")!==null?ii():setTimeout(ii,10)})};let Ui=null;function Pr(Te){Ui&&Ui(Te)}function Ao(){ja.stop()}function w0(){ja.start()}const ja=new Lf;ja.setAnimationLoop(Pr),typeof self<"u"&&ja.setContext(self),this.setAnimationLoop=function(Te){Ui=Te,Pt.setAnimationLoop(Te),Te===null?ja.stop():ja.start()},Pt.addEventListener("sessionstart",Ao),Pt.addEventListener("sessionend",w0),this.render=function(Te,tt){if(tt!==void 0&&tt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Qe===!0)return;Te.matrixWorldAutoUpdate===!0&&Te.updateMatrixWorld(),tt.parent===null&&tt.matrixWorldAutoUpdate===!0&&tt.updateMatrixWorld(),Pt.enabled===!0&&Pt.isPresenting===!0&&(Pt.cameraAutoUpdate===!0&&Pt.updateCamera(tt),tt=Pt.getCamera()),Te.isScene===!0&&Te.onBeforeRender(he,Te,tt,Ve),Q=Ct.get(Te,Ae.length),Q.init(tt),Ae.push(Q),vi.multiplyMatrices(tt.projectionMatrix,tt.matrixWorldInverse),$n.setFromProjectionMatrix(vi),Wn=this.localClippingEnabled,Dn=It.init(this.clippingPlanes,Wn),X=ut.get(Te,ge.length),X.init(),ge.push(X),M0(Te,tt,0,he.sortObjects),X.finish(),he.sortObjects===!0&&X.sort(Ut,Qt);const lt=Pt.enabled===!1||Pt.isPresenting===!1||Pt.hasDepthSensing()===!1;lt&&Wt.addToRenderList(X,Te),this.info.render.frame++,Dn===!0&&It.beginShadows();const rt=Q.state.shadowsArray;Mt.render(rt,Te,tt),Dn===!0&&It.endShadows(),this.info.autoReset===!0&&this.info.reset();const ot=X.opaque,ii=X.transmissive;if(Q.setupLights(he._useLegacyLights),tt.isArrayCamera){const Si=tt.cameras;if(ii.length>0)for(let Ii=0,Vi=Si.length;Ii<Vi;Ii++){const Zi=Si[Ii];_0(ot,ii,Te,Zi)}if(lt&&Wt.render(Te),Pt.enabled&&Pt.isMultiview)ai.setDeferTextureUploads(!0),Lp(X,Te,tt,tt.cameras[0].viewport);else for(let Ii=0,Vi=Si.length;Ii<Vi;Ii++){const Zi=Si[Ii];Lp(X,Te,Zi,Zi.viewport)}}else ii.length>0&&_0(ot,ii,Te,tt),lt&&Wt.render(Te),Lp(X,Te,tt);Ve!==null&&(ai.updateMultisampleRenderTarget(Ve),ai.updateRenderTargetMipmap(Ve)),Te.isScene===!0&&Te.onAfterRender(he,Te,tt),ai.runDeferredUploads(),Pt.enabled&&Pt.submitFrame&&Pt.submitFrame(),nn.resetDefaultState(),_e=-1,xe=null,Ae.pop(),Ae.length>0?(Q=Ae[Ae.length-1],Dn===!0&&It.setGlobalState(he.clippingPlanes,Q.state.camera)):Q=null,ge.pop(),ge.length>0?X=ge[ge.length-1]:X=null};function M0(Te,tt,lt,rt){if(Te.visible===!1)return;if(Te.layers.test(tt.layers)){if(Te.isGroup)lt=Te.renderOrder;else if(Te.isLOD)Te.autoUpdate===!0&&Te.update(tt);else if(Te.isLight)Q.pushLight(Te),Te.castShadow&&Q.pushShadow(Te);else if(Te.isSprite){if(!Te.frustumCulled||$n.intersectsSprite(Te)){rt&&bt.setFromMatrixPosition(Te.matrixWorld).applyMatrix4(vi);const Si=er.update(Te),Ii=Te.material;Ii.visible&&X.push(Te,Si,Ii,lt,bt.z,null)}}else if((Te.isMesh||Te.isLine||Te.isPoints)&&(!Te.frustumCulled||$n.intersectsObject(Te))){const Si=er.update(Te),Ii=Te.material;if(rt&&(Te.boundingSphere!==void 0?(Te.boundingSphere===null&&Te.computeBoundingSphere(),bt.copy(Te.boundingSphere.center)):(Si.boundingSphere===null&&Si.computeBoundingSphere(),bt.copy(Si.boundingSphere.center)),bt.applyMatrix4(Te.matrixWorld).applyMatrix4(vi)),Array.isArray(Ii)){const Vi=Si.groups;for(let Zi=0,ln=Vi.length;Zi<ln;Zi++){const pn=Vi[Zi],Mr=Ii[pn.materialIndex];Mr&&Mr.visible&&X.push(Te,Si,Mr,lt,bt.z,pn)}}else Ii.visible&&X.push(Te,Si,Ii,lt,bt.z,null)}}const ii=Te.children;for(let Si=0,Ii=ii.length;Si<Ii;Si++)M0(ii[Si],tt,lt,rt)}function Lp(Te,tt,lt,rt){const ot=Te.opaque,ii=Te.transmissive,Si=Te.transparent;Q.setupLightsView(lt),Dn===!0&&It.setGlobalState(he.clippingPlanes,lt),rt&&Ft.viewport(ze.copy(rt)),ot.length>0&&Qu(ot,tt,lt),ii.length>0&&Qu(ii,tt,lt),Si.length>0&&Qu(Si,tt,lt),Ft.buffers.depth.setTest(!0),Ft.buffers.depth.setMask(!0),Ft.buffers.color.setMask(!0),Ft.setPolygonOffset(!1)}function _0(Te,tt,lt,rt){if((lt.isScene===!0?lt.overrideMaterial:null)!==null)return;Q.state.transmissionRenderTarget[rt.id]===void 0&&(Q.state.transmissionRenderTarget[rt.id]=new ys(1,1,{generateMipmaps:!0,type:gt.has("EXT_color_buffer_half_float")||gt.has("EXT_color_buffer_float")?Bn:Qn,minFilter:In,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const ii=Q.state.transmissionRenderTarget[rt.id],Si=rt.viewport||ze;ii.setSize(Si.z,Si.w);const Ii=he.getRenderTarget();he.setRenderTarget(ii),he.getClearColor($e),at=he.getClearAlpha(),at<1&&he.setClearColor(16777215,.5),he.clear();const Vi=he.toneMapping;he.toneMapping=wn;const Zi=rt.viewport;if(rt.viewport!==void 0&&(rt.viewport=void 0),Q.setupLightsView(rt),Dn===!0&&It.setGlobalState(he.clippingPlanes,rt),Qu(Te,lt,rt),ai.updateMultisampleRenderTarget(ii),ai.updateRenderTargetMipmap(ii),gt.has("WEBGL_multisampled_render_to_texture")===!1){let ln=!1;for(let pn=0,Mr=tt.length;pn<Mr;pn++){const ts=tt[pn],Ls=ts.object,ra=ts.geometry,kn=ts.material,Ro=ts.group;if(kn.side===P&&Ls.layers.test(rt.layers)){const dn=kn.side;kn.side=L,kn.needsUpdate=!0,S0(Ls,lt,rt,ra,kn,Ro),kn.side=dn,kn.needsUpdate=!0,ln=!0}}ln===!0&&(ai.updateMultisampleRenderTarget(ii),ai.updateRenderTargetMipmap(ii))}he.setRenderTarget(Ii),he.setClearColor($e,at),Zi!==void 0&&(rt.viewport=Zi),he.toneMapping=Vi}function Qu(Te,tt,lt){const rt=tt.isScene===!0?tt.overrideMaterial:null;for(let ot=0,ii=Te.length;ot<ii;ot++){const Si=Te[ot],Ii=Si.object,Vi=Si.geometry,Zi=rt===null?Si.material:rt,ln=Si.group;Ii.layers.test(lt.layers)&&S0(Ii,tt,lt,Vi,Zi,ln)}}function S0(Te,tt,lt,rt,ot,ii){Te.onBeforeRender(he,tt,lt,rt,ot,ii),Te.modelViewMatrix.multiplyMatrices(lt.matrixWorldInverse,Te.matrixWorld),Te.normalMatrix.getNormalMatrix(Te.modelViewMatrix),ot.onBeforeRender(he,tt,lt,rt,Te,ii),ot.transparent===!0&&ot.side===P&&ot.forceSinglePass===!1?(ot.side=L,ot.needsUpdate=!0,he.renderBufferDirect(lt,tt,rt,ot,Te,ii),ot.side=S,ot.needsUpdate=!0,he.renderBufferDirect(lt,tt,rt,ot,Te,ii),ot.side=P):he.renderBufferDirect(lt,tt,rt,ot,Te,ii),Te.onAfterRender(he,tt,lt,rt,ot,ii)}function Hu(Te,tt,lt){tt.isScene!==!0&&(tt=Kt);const rt=$t.get(Te),ot=Q.state.lights,ii=Q.state.shadowsArray,Si=ot.state.version,Ii=Ue.getParameters(Te,ot.state,ii,tt,lt),Vi=Ue.getProgramCacheKey(Ii);let Zi=rt.programs;rt.environment=Te.isMeshStandardMaterial?tt.environment:null,rt.fog=tt.fog,rt.envMap=(Te.isMeshStandardMaterial?qi:Qi).get(Te.envMap||rt.environment),rt.envMapRotation=rt.environment!==null&&Te.envMap===null?tt.environmentRotation:Te.envMapRotation,Zi===void 0&&(Te.addEventListener("dispose",rn),Zi=new Map,rt.programs=Zi);let ln=Zi.get(Vi);if(ln!==void 0){if(rt.currentProgram===ln&&rt.lightsStateVersion===Si)return I0(Te,Ii),ln}else Ii.uniforms=Ue.getUniforms(Te),Te.onBuild(lt,Ii,he),Te.onBeforeCompile(Ii,he),ln=Ue.acquireProgram(Ii,Vi),Zi.set(Vi,ln),rt.uniforms=Ii.uniforms;const pn=rt.uniforms;return(!Te.isShaderMaterial&&!Te.isRawShaderMaterial||Te.clipping===!0)&&(pn.clippingPlanes=It.uniform),I0(Te,Ii),rt.needsLights=O2(Te),rt.lightsStateVersion=Si,rt.needsLights&&(pn.ambientLightColor.value=ot.state.ambient,pn.lightProbe.value=ot.state.probe,pn.directionalLights.value=ot.state.directional,pn.directionalLightShadows.value=ot.state.directionalShadow,pn.spotLights.value=ot.state.spot,pn.spotLightShadows.value=ot.state.spotShadow,pn.rectAreaLights.value=ot.state.rectArea,pn.ltc_1.value=ot.state.rectAreaLTC1,pn.ltc_2.value=ot.state.rectAreaLTC2,pn.pointLights.value=ot.state.point,pn.pointLightShadows.value=ot.state.pointShadow,pn.hemisphereLights.value=ot.state.hemi,pn.directionalShadowMap.value=ot.state.directionalShadowMap,pn.directionalShadowMatrix.value=ot.state.directionalShadowMatrix,pn.spotShadowMap.value=ot.state.spotShadowMap,pn.spotLightMatrix.value=ot.state.spotLightMatrix,pn.spotLightMap.value=ot.state.spotLightMap,pn.pointShadowMap.value=ot.state.pointShadowMap,pn.pointShadowMatrix.value=ot.state.pointShadowMatrix),rt.currentProgram=ln,rt.uniformsList=null,ln}function T0(Te){if(Te.uniformsList===null){const tt=Te.currentProgram.getUniforms();Te.uniformsList=Xh.seqWithValue(tt.seq,Te.uniforms)}return Te.uniformsList}function I0(Te,tt){const lt=$t.get(Te);lt.outputColorSpace=tt.outputColorSpace,lt.batching=tt.batching,lt.instancing=tt.instancing,lt.instancingColor=tt.instancingColor,lt.instancingMorph=tt.instancingMorph,lt.skinning=tt.skinning,lt.morphTargets=tt.morphTargets,lt.morphNormals=tt.morphNormals,lt.morphColors=tt.morphColors,lt.morphTargetsCount=tt.morphTargetsCount,lt.numClippingPlanes=tt.numClippingPlanes,lt.numIntersection=tt.numClipIntersection,lt.vertexAlphas=tt.vertexAlphas,lt.vertexTangents=tt.vertexTangents,lt.toneMapping=tt.toneMapping,lt.numMultiviewViews=tt.numMultiviewViews}function D2(Te,tt,lt,rt,ot){tt.isScene!==!0&&(tt=Kt),ai.resetTextureUnits();const ii=tt.fog,Si=rt.isMeshStandardMaterial?tt.environment:null,Ii=Ve===null?he.outputColorSpace:Ve.isXRRenderTarget===!0?Ve.texture.colorSpace:Ws,Vi=(rt.isMeshStandardMaterial?qi:Qi).get(rt.envMap||Si),Zi=rt.vertexColors===!0&&!!lt.attributes.color&&lt.attributes.color.itemSize===4,ln=!!lt.attributes.tangent&&(!!rt.normalMap||rt.anisotropy>0),pn=!!lt.morphAttributes.position,Mr=!!lt.morphAttributes.normal,ts=!!lt.morphAttributes.color;let Ls=wn;rt.toneMapped&&(Ve===null||Ve.isXRRenderTarget===!0)&&(Ls=he.toneMapping);const ra=Ve&&Ve.isWebGLMultiviewRenderTarget?Ve.numViews:0,kn=lt.morphAttributes.position||lt.morphAttributes.normal||lt.morphAttributes.color,Ro=kn!==void 0?kn.length:0,dn=$t.get(rt),F2=Q.state.lights;if(Dn===!0&&(Wn===!0||Te!==xe)){const Gs=Te===xe&&rt.id===_e;It.setState(rt,Te,Gs)}let ir=!1;rt.version===dn.__version?(dn.needsLights&&dn.lightsStateVersion!==F2.state.version||dn.outputColorSpace!==Ii||ot.isBatchedMesh&&dn.batching===!1||!ot.isBatchedMesh&&dn.batching===!0||ot.isInstancedMesh&&dn.instancing===!1||!ot.isInstancedMesh&&dn.instancing===!0||ot.isSkinnedMesh&&dn.skinning===!1||!ot.isSkinnedMesh&&dn.skinning===!0||ot.isInstancedMesh&&dn.instancingColor===!0&&ot.instanceColor===null||ot.isInstancedMesh&&dn.instancingColor===!1&&ot.instanceColor!==null||ot.isInstancedMesh&&dn.instancingMorph===!0&&ot.morphTexture===null||ot.isInstancedMesh&&dn.instancingMorph===!1&&ot.morphTexture!==null||dn.envMap!==Vi||rt.fog===!0&&dn.fog!==ii||dn.numClippingPlanes!==void 0&&(dn.numClippingPlanes!==It.numPlanes||dn.numIntersection!==It.numIntersection)||dn.vertexAlphas!==Zi||dn.vertexTangents!==ln||dn.morphTargets!==pn||dn.morphNormals!==Mr||dn.morphColors!==ts||dn.toneMapping!==Ls||dn.morphTargetsCount!==Ro||dn.numMultiviewViews!==ra)&&(ir=!0):(ir=!0,dn.__version=rt.version);let Lo=dn.currentProgram;ir===!0&&(Lo=Hu(rt,tt,ot));let B0=!1,Hc=!1,Dp=!1;const Or=Lo.getUniforms(),sa=dn.uniforms;if(Ft.useProgram(Lo.program)&&(B0=!0,Hc=!0,Dp=!0),rt.id!==_e&&(_e=rt.id,Hc=!0),B0||xe!==Te){Lo.numMultiviewViews>0?(Ci.updateCameraProjectionMatricesUniform(Te,Or),Ci.updateCameraViewMatricesUniform(Te,Or)):(Or.setValue(et,"projectionMatrix",Te.projectionMatrix),Or.setValue(et,"viewMatrix",Te.matrixWorldInverse));const Gs=Or.map.cameraPosition;Gs!==void 0&&Gs.setValue(et,bt.setFromMatrixPosition(Te.matrixWorld)),kt.logarithmicDepthBuffer&&Or.setValue(et,"logDepthBufFC",2/(Math.log(Te.far+1)/Math.LN2)),(rt.isMeshPhongMaterial||rt.isMeshToonMaterial||rt.isMeshLambertMaterial||rt.isMeshBasicMaterial||rt.isMeshStandardMaterial||rt.isShaderMaterial)&&Or.setValue(et,"isOrthographic",Te.isOrthographicCamera===!0),xe!==Te&&(xe=Te,Hc=!0,Dp=!0)}if(ot.isSkinnedMesh){Or.setOptional(et,ot,"bindMatrix"),Or.setOptional(et,ot,"bindMatrixInverse");const Gs=ot.skeleton;Gs&&(Gs.boneTexture===null&&Gs.computeBoneTexture(),Or.setValue(et,"boneTexture",Gs.boneTexture,ai))}ot.isBatchedMesh&&(Or.setOptional(et,ot,"batchingTexture"),Or.setValue(et,"batchingTexture",ot._matricesTexture,ai));const Pp=lt.morphAttributes;if((Pp.position!==void 0||Pp.normal!==void 0||Pp.color!==void 0)&&ci.update(ot,lt,Lo),(Hc||dn.receiveShadow!==ot.receiveShadow)&&(dn.receiveShadow=ot.receiveShadow,Or.setValue(et,"receiveShadow",ot.receiveShadow)),rt.isMeshGouraudMaterial&&rt.envMap!==null&&(sa.envMap.value=Vi,sa.flipEnvMap.value=Vi.isCubeTexture&&Vi.isRenderTargetTexture===!1?-1:1),rt.isMeshStandardMaterial&&rt.envMap===null&&tt.environment!==null&&(sa.envMapIntensity.value=tt.environmentIntensity),Hc&&(Or.setValue(et,"toneMappingExposure",he.toneMappingExposure),dn.needsLights&&P2(sa,Dp),ii&&rt.fog===!0&&Ce.refreshFogUniforms(sa,ii),Ce.refreshMaterialUniforms(sa,rt,ct,jt,Q.state.transmissionRenderTarget[Te.id]),Xh.upload(et,T0(dn),sa,ai)),rt.isShaderMaterial&&rt.uniformsNeedUpdate===!0&&(Xh.upload(et,T0(dn),sa,ai),rt.uniformsNeedUpdate=!1),rt.isSpriteMaterial&&Or.setValue(et,"center",ot.center),Lo.numMultiviewViews>0?Ci.updateObjectMatricesUniforms(ot,Te,Or):(Or.setValue(et,"modelViewMatrix",ot.modelViewMatrix),Or.setValue(et,"normalMatrix",ot.normalMatrix)),Or.setValue(et,"modelMatrix",ot.matrixWorld),rt.isShaderMaterial||rt.isRawShaderMaterial){const Gs=rt.uniformsGroups;for(let Op=0,N2=Gs.length;Op<N2;Op++){const R0=Gs[Op];Fi.update(R0,Lo),Fi.bind(R0,Lo)}}return Lo}function P2(Te,tt){Te.ambientLightColor.needsUpdate=tt,Te.lightProbe.needsUpdate=tt,Te.directionalLights.needsUpdate=tt,Te.directionalLightShadows.needsUpdate=tt,Te.pointLights.needsUpdate=tt,Te.pointLightShadows.needsUpdate=tt,Te.spotLights.needsUpdate=tt,Te.spotLightShadows.needsUpdate=tt,Te.rectAreaLights.needsUpdate=tt,Te.hemisphereLights.needsUpdate=tt}function O2(Te){return Te.isMeshLambertMaterial||Te.isMeshToonMaterial||Te.isMeshPhongMaterial||Te.isMeshStandardMaterial||Te.isShadowMaterial||Te.isShaderMaterial&&Te.lights===!0}this.setTexture2D=function(){var Te=!1;return function(lt,rt){lt&&lt.isWebGLRenderTarget&&(Te||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),Te=!0),lt=lt.texture),ai.setTexture2D(lt,rt)}}(),this.getActiveCubeFace=function(){return Be},this.getActiveMipmapLevel=function(){return Oe},this.getRenderTarget=function(){return Ve},this.setRenderTargetTextures=function(Te,tt,lt){$t.get(Te.texture).__webglTexture=tt,$t.get(Te.depthTexture).__webglTexture=lt;const rt=$t.get(Te);rt.__hasExternalTextures=!0,rt.__autoAllocateDepthBuffer=lt===void 0,!rt.__autoAllocateDepthBuffer&&(!Ve||!Ve.isWebGLMultiviewRenderTarget)&&gt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),rt.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Te,tt){const lt=$t.get(Te);lt.__webglFramebuffer=tt,lt.__useDefaultFramebuffer=tt===void 0},this.setRenderTarget=function(Te,tt=0,lt=0){Ve=Te,Be=tt,Oe=lt;let rt=!0,ot=null,ii=!1,Si=!1;if(Te){const Vi=$t.get(Te);Vi.__useDefaultFramebuffer!==void 0?(Ft.bindFramebuffer(et.FRAMEBUFFER,null),rt=!1):Vi.__webglFramebuffer===void 0?ai.setupRenderTarget(Te):Vi.__hasExternalTextures&&ai.rebindTextures(Te,$t.get(Te.texture).__webglTexture,$t.get(Te.depthTexture).__webglTexture);const Zi=Te.texture;(Zi.isData3DTexture||Zi.isDataArrayTexture||Zi.isCompressedArrayTexture)&&(Si=!0);const ln=$t.get(Te).__webglFramebuffer;Te.isWebGLCubeRenderTarget?(Array.isArray(ln[tt])?ot=ln[tt][lt]:ot=ln[tt],ii=!0):Te.samples>0&&ai.useMultisampledRTT(Te)===!1?ot=$t.get(Te).__webglMultisampledFramebuffer:Array.isArray(ln)?ot=ln[lt]:ot=ln,ze.copy(Te.viewport),qe.copy(Te.scissor),Ke=Te.scissorTest}else ze.copy(fi).multiplyScalar(ct).floor(),qe.copy(an).multiplyScalar(ct).floor(),Ke=Nn;if(Ft.bindFramebuffer(et.FRAMEBUFFER,ot)&&rt&&Ft.drawBuffers(Te,ot),Ft.viewport(ze),Ft.scissor(qe),Ft.setScissorTest(Ke),ii){const Vi=$t.get(Te.texture);et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_CUBE_MAP_POSITIVE_X+tt,Vi.__webglTexture,lt)}else if(Si){const Vi=$t.get(Te.texture),Zi=tt||0;et.framebufferTextureLayer(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,Vi.__webglTexture,lt||0,Zi)}_e=-1},this.readRenderTargetPixels=function(Te,tt,lt,rt,ot,ii,Si){if(!(Te&&Te.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ii=$t.get(Te).__webglFramebuffer;if(Te.isWebGLCubeRenderTarget&&Si!==void 0&&(Ii=Ii[Si]),Ii){Ft.bindFramebuffer(et.FRAMEBUFFER,Ii);try{const Vi=Te.texture,Zi=Vi.format,ln=Vi.type;if(!kt.textureFormatReadable(Zi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!kt.textureTypeReadable(ln)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}tt>=0&&tt<=Te.width-rt&&lt>=0&&lt<=Te.height-ot&&et.readPixels(tt,lt,rt,ot,Mi.convert(Zi),Mi.convert(ln),ii)}finally{const Vi=Ve!==null?$t.get(Ve).__webglFramebuffer:null;Ft.bindFramebuffer(et.FRAMEBUFFER,Vi)}}},this.copyFramebufferToTexture=function(Te,tt,lt=0){const rt=Math.pow(2,-lt),ot=Math.floor(tt.image.width*rt),ii=Math.floor(tt.image.height*rt);ai.setTexture2D(tt,0),et.copyTexSubImage2D(et.TEXTURE_2D,lt,0,0,Te.x,Te.y,ot,ii),Ft.unbindTexture()},this.copyTextureToTexture=function(Te,tt,lt,rt=0){const ot=tt.image.width,ii=tt.image.height,Si=Mi.convert(lt.format),Ii=Mi.convert(lt.type);ai.setTexture2D(lt,0),et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,lt.flipY),et.pixelStorei(et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,lt.premultiplyAlpha),et.pixelStorei(et.UNPACK_ALIGNMENT,lt.unpackAlignment),tt.isDataTexture?et.texSubImage2D(et.TEXTURE_2D,rt,Te.x,Te.y,ot,ii,Si,Ii,tt.image.data):tt.isCompressedTexture?et.compressedTexSubImage2D(et.TEXTURE_2D,rt,Te.x,Te.y,tt.mipmaps[0].width,tt.mipmaps[0].height,Si,tt.mipmaps[0].data):et.texSubImage2D(et.TEXTURE_2D,rt,Te.x,Te.y,Si,Ii,tt.image),rt===0&&lt.generateMipmaps&&et.generateMipmap(et.TEXTURE_2D),Ft.unbindTexture()},this.copyTextureToTexture3D=function(Te,tt,lt,rt,ot=0){const ii=Te.max.x-Te.min.x,Si=Te.max.y-Te.min.y,Ii=Te.max.z-Te.min.z,Vi=Mi.convert(rt.format),Zi=Mi.convert(rt.type);let ln;if(rt.isData3DTexture)ai.setTexture3D(rt,0),ln=et.TEXTURE_3D;else if(rt.isDataArrayTexture||rt.isCompressedArrayTexture)ai.setTexture2DArray(rt,0),ln=et.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,rt.flipY),et.pixelStorei(et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,rt.premultiplyAlpha),et.pixelStorei(et.UNPACK_ALIGNMENT,rt.unpackAlignment);const pn=et.getParameter(et.UNPACK_ROW_LENGTH),Mr=et.getParameter(et.UNPACK_IMAGE_HEIGHT),ts=et.getParameter(et.UNPACK_SKIP_PIXELS),Ls=et.getParameter(et.UNPACK_SKIP_ROWS),ra=et.getParameter(et.UNPACK_SKIP_IMAGES),kn=lt.isCompressedTexture?lt.mipmaps[ot]:lt.image;et.pixelStorei(et.UNPACK_ROW_LENGTH,kn.width),et.pixelStorei(et.UNPACK_IMAGE_HEIGHT,kn.height),et.pixelStorei(et.UNPACK_SKIP_PIXELS,Te.min.x),et.pixelStorei(et.UNPACK_SKIP_ROWS,Te.min.y),et.pixelStorei(et.UNPACK_SKIP_IMAGES,Te.min.z),lt.isDataTexture||lt.isData3DTexture?et.texSubImage3D(ln,ot,tt.x,tt.y,tt.z,ii,Si,Ii,Vi,Zi,kn.data):rt.isCompressedArrayTexture?et.compressedTexSubImage3D(ln,ot,tt.x,tt.y,tt.z,ii,Si,Ii,Vi,kn.data):et.texSubImage3D(ln,ot,tt.x,tt.y,tt.z,ii,Si,Ii,Vi,Zi,kn),et.pixelStorei(et.UNPACK_ROW_LENGTH,pn),et.pixelStorei(et.UNPACK_IMAGE_HEIGHT,Mr),et.pixelStorei(et.UNPACK_SKIP_PIXELS,ts),et.pixelStorei(et.UNPACK_SKIP_ROWS,Ls),et.pixelStorei(et.UNPACK_SKIP_IMAGES,ra),ot===0&&rt.generateMipmaps&&et.generateMipmap(ln),Ft.unbindTexture()},this.initTexture=function(Te){Te.isCubeTexture?ai.setTextureCube(Te,0):Te.isData3DTexture?ai.setTexture3D(Te,0):Te.isDataArrayTexture||Te.isCompressedArrayTexture?ai.setTexture2DArray(Te,0):ai.setTexture2D(Te,0),Ft.unbindTexture()},this.resetState=function(){Be=0,Oe=0,Ve=null,Ft.reset(),nn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ns}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const i=this.getContext();i.drawingBufferColorSpace=e===tl?"display-p3":"srgb",i.unpackColorSpace=Fn.workingColorSpace===ga?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class Yh{constructor(e,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new li(e),this.density=i}clone(){return new Yh(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class qh{constructor(e,i=1,n=1e3){this.isFog=!0,this.name="",this.color=new li(e),this.near=i,this.far=n}clone(){return new qh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class km extends Ln{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Is,this.environmentIntensity=1,this.environmentRotation=new Is,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(i.object.environmentIntensity=this.environmentIntensity),i.object.environmentRotation=this.environmentRotation.toArray(),i}}class Jh{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=xa,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ls()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return wh("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,n){e*=this.stride,n*=i.stride;for(let s=0,a=this.stride;s<a;s++)this.array[e+s]=i.array[n+s];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ls()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(i,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ls()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const us=new Ie;class Da{constructor(e,i,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,n=this.data.count;i<n;i++)us.fromBufferAttribute(this,i),us.applyMatrix4(e),this.setXYZ(i,us.x,us.y,us.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)us.fromBufferAttribute(this,i),us.applyNormalMatrix(e),this.setXYZ(i,us.x,us.y,us.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)us.fromBufferAttribute(this,i),us.transformDirection(e),this.setXYZ(i,us.x,us.y,us.z);return this}getComponent(e,i){let n=this.array[e*this.data.stride+this.offset+i];return this.normalized&&(n=jr(n,this.array)),n}setComponent(e,i,n){return this.normalized&&(n=Yi(n,this.array)),this.data.array[e*this.data.stride+this.offset+i]=n,this}setX(e,i){return this.normalized&&(i=Yi(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=Yi(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=Yi(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=Yi(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=jr(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=jr(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=jr(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=jr(i,this.array)),i}setXY(e,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this}setXYZ(e,i,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array),s=Yi(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,i,n,s,a){return e=e*this.data.stride+this.offset,this.normalized&&(i=Yi(i,this.array),n=Yi(n,this.array),s=Yi(s,this.array),a=Yi(a,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)i.push(this.data.array[s+a])}return new zn(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Da(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)i.push(this.data.array[s+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Kf extends $r{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new li(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ml;const Cc=new Ie,_l=new Ie,Sl=new Ie,Tl=new xt,bc=new xt,Um=new mi,Zh=new Ie,wc=new Ie,$h=new Ie,Gm=new xt,Xf=new xt,Vm=new xt;class zm extends Ln{constructor(e=new Kf){if(super(),this.isSprite=!0,this.type="Sprite",Ml===void 0){Ml=new on;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Jh(i,5);Ml.setIndex([0,1,2,0,2,3]),Ml.setAttribute("position",new Da(n,3,0,!1)),Ml.setAttribute("uv",new Da(n,2,3,!1))}this.geometry=Ml,this.material=e,this.center=new xt(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_l.setFromMatrixScale(this.matrixWorld),Um.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Sl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_l.multiplyScalar(-Sl.z);const n=this.material.rotation;let s,a;n!==0&&(a=Math.cos(n),s=Math.sin(n));const d=this.center;eu(Zh.set(-.5,-.5,0),Sl,d,_l,s,a),eu(wc.set(.5,-.5,0),Sl,d,_l,s,a),eu($h.set(.5,.5,0),Sl,d,_l,s,a),Gm.set(0,0),Xf.set(1,0),Vm.set(1,1);let v=e.ray.intersectTriangle(Zh,wc,$h,!1,Cc);if(v===null&&(eu(wc.set(-.5,.5,0),Sl,d,_l,s,a),Xf.set(0,1),v=e.ray.intersectTriangle(Zh,$h,wc,!1,Cc),v===null))return;const I=e.ray.origin.distanceTo(Cc);I<e.near||I>e.far||i.push({distance:I,point:Cc.clone(),uv:Bs.getInterpolation(Cc,Zh,wc,$h,Gm,Xf,Vm,new xt),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function eu(l,e,i,n,s,a){Tl.subVectors(l,i).addScalar(.5).multiply(n),s!==void 0?(bc.x=a*Tl.x-s*Tl.y,bc.y=s*Tl.x+a*Tl.y):bc.copy(Tl),l.copy(e),l.x+=bc.x,l.y+=bc.y,l.applyMatrix4(Um)}const tu=new Ie,Qm=new Ie;class Hm extends Ln{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let n=0,s=i.length;n<s;n++){const a=i[n];this.addLevel(a.object.clone(),a.distance,a.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0,n=0){i=Math.abs(i);const s=this.levels;let a;for(a=0;a<s.length&&!(i<s[a].distance);a++);return s.splice(a,0,{distance:i,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let n,s;for(n=1,s=i.length;n<s;n++){let a=i[n].distance;if(i[n].object.visible&&(a-=a*i[n].hysteresis),e<a)break}return i[n-1].object}return null}raycast(e,i){if(this.levels.length>0){tu.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(tu);this.getObjectForDistance(s).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){tu.setFromMatrixPosition(e.matrixWorld),Qm.setFromMatrixPosition(this.matrixWorld);const n=tu.distanceTo(Qm)/e.zoom;i[0].object.visible=!0;let s,a;for(s=1,a=i.length;s<a;s++){let d=i[s].distance;if(i[s].object.visible&&(d-=d*i[s].hysteresis),n>=d)i[s-1].object.visible=!1,i[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<a;s++)i[s].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let s=0,a=n.length;s<a;s++){const d=n[s];i.object.levels.push({object:d.object.uuid,distance:d.distance,hysteresis:d.hysteresis})}return i}}const jm=new Ie,Wm=new _n,Km=new _n,GC=new Ie,Xm=new mi,iu=new Ie,Yf=new Ir,Ym=new mi,qf=new Br;class qm extends wr{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Se,this.bindMatrix=new mi,this.bindMatrixInverse=new mi,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new hr),this.boundingBox.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)this.getVertexPosition(n,iu),this.boundingBox.expandByPoint(iu)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ir),this.boundingSphere.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)this.getVertexPosition(n,iu),this.boundingSphere.expandByPoint(iu)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Yf.copy(this.boundingSphere),Yf.applyMatrix4(s),e.ray.intersectsSphere(Yf)!==!1&&(Ym.copy(s).invert(),qf.copy(e.ray).applyMatrix4(Ym),!(this.boundingBox!==null&&qf.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,i,qf)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new _n,i=this.geometry.attributes.skinWeight;for(let n=0,s=i.count;n<s;n++){e.fromBufferAttribute(i,n);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),i.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Se?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Re?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){const n=this.skeleton,s=this.geometry;Wm.fromBufferAttribute(s.attributes.skinIndex,e),Km.fromBufferAttribute(s.attributes.skinWeight,e),jm.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let a=0;a<4;a++){const d=Km.getComponent(a);if(d!==0){const v=Wm.getComponent(a);Xm.multiplyMatrices(n.bones[v].matrixWorld,n.boneInverses[v]),i.addScaledVector(GC.copy(jm).applyMatrix4(Xm),d)}}return i.applyMatrix4(this.bindMatrixInverse)}}class Jf extends Ln{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Zo extends qn{constructor(e=null,i=1,n=1,s,a,d,v,I,R=zt,O=zt,k,G){super(null,d,v,I,R,O,s,a,k,G),this.isDataTexture=!0,this.image={data:e,width:i,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Jm=new mi,VC=new mi;class nu{constructor(e=[],i=[]){this.uuid=ls(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new mi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const n=new mi;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,i=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let a=0,d=e.length;a<d;a++){const v=e[a]?e[a].matrixWorld:VC;Jm.multiplyMatrices(v,i[a]),Jm.toArray(n,a*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new nu(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const n=new Zo(i,e,e,Ne,Yn);return n.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=n,this}getBoneByName(e){for(let i=0,n=this.bones.length;i<n;i++){const s=this.bones[i];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const a=e.bones[n];let d=i[a];d===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),d=new Jf),this.bones.push(d),this.boneInverses.push(new mi().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,n=this.boneInverses;for(let s=0,a=i.length;s<a;s++){const d=i[s];e.bones.push(d.uuid);const v=n[s];e.boneInverses.push(v.toArray())}return e}}class Il extends zn{constructor(e,i,n,s=1){super(e,i,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Bl=new mi,Zm=new mi,ru=[],$m=new hr,zC=new mi,Mc=new wr,_c=new Ir;class eg extends wr{constructor(e,i,n){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new Il(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,zC)}computeBoundingBox(){const e=this.geometry,i=this.count;this.boundingBox===null&&(this.boundingBox=new hr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<i;n++)this.getMatrixAt(n,Bl),$m.copy(e.boundingBox).applyMatrix4(Bl),this.boundingBox.union($m)}computeBoundingSphere(){const e=this.geometry,i=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ir),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<i;n++)this.getMatrixAt(n,Bl),_c.copy(e.boundingSphere).applyMatrix4(Bl),this.boundingSphere.union(_c)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,i){const n=i.morphTargetInfluences,s=this.morphTexture.source.data.data,a=n.length+1,d=e*a+1;for(let v=0;v<n.length;v++)n[v]=s[d+v]}raycast(e,i){const n=this.matrixWorld,s=this.count;if(Mc.geometry=this.geometry,Mc.material=this.material,Mc.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_c.copy(this.boundingSphere),_c.applyMatrix4(n),e.ray.intersectsSphere(_c)!==!1))for(let a=0;a<s;a++){this.getMatrixAt(a,Bl),Zm.multiplyMatrices(n,Bl),Mc.matrixWorld=Zm,Mc.raycast(e,ru);for(let d=0,v=ru.length;d<v;d++){const I=ru[d];I.instanceId=a,I.object=this,i.push(I)}ru.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new Il(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,i){const n=i.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new Zo(new Float32Array(s*this.count),s,this.count,Bt,Yn));const a=this.morphTexture.source.data.data;let d=0;for(let R=0;R<n.length;R++)d+=n[R];const v=this.geometry.morphTargetsRelative?1:1-d,I=s*e;a[I]=v,a.set(n,I+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function QC(l,e){return l.z-e.z}function HC(l,e){return e.z-l.z}class jC{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,i){const n=this.pool,s=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});const a=n[this.index];s.push(a),this.index++,a.start=e.start,a.count=e.count,a.z=i}reset(){this.list.length=0,this.index=0}}const Rl="batchId",$o=new mi,tg=new mi,WC=new mi,ig=new mi,Zf=new Ec,su=new hr,Pa=new Ir,Sc=new Ie,$f=new jC,es=new wr,ou=[];function KC(l,e,i=0){const n=e.itemSize;if(l.isInterleavedBufferAttribute||l.array.constructor!==e.array.constructor){const s=l.count;for(let a=0;a<s;a++)for(let d=0;d<n;d++)e.setComponent(a+i,d,l.getComponent(a,d))}else e.array.set(l.array,i*n);e.needsUpdate=!0}class ng extends wr{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,i,n=i*2,s){super(new on,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=i,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const i=new Float32Array(e*e*4),n=new Zo(i,e,e,Ne,Yn);this._matricesTexture=n}_initializeGeometry(e){const i=this.geometry,n=this._maxVertexCount,s=this._maxGeometryCount,a=this._maxIndexCount;if(this._geometryInitialized===!1){for(const v in e.attributes){const I=e.getAttribute(v),{array:R,itemSize:O,normalized:k}=I,G=new R.constructor(n*O),z=new zn(G,O,k);i.setAttribute(v,z)}if(e.getIndex()!==null){const v=n>65536?new Uint32Array(a):new Uint16Array(a);i.setIndex(new zn(v,1))}const d=s>65536?new Uint32Array(n):new Uint16Array(n);i.setAttribute(Rl,new zn(d,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(Rl))throw new Error(`BatchedMesh: Geometry cannot use attribute "${Rl}"`);const i=this.geometry;if(!!e.getIndex()!=!!i.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in i.attributes){if(n===Rl)continue;if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),a=i.getAttribute(n);if(s.itemSize!==a.itemSize||s.normalized!==a.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hr);const e=this._geometryCount,i=this.boundingBox,n=this._active;i.makeEmpty();for(let s=0;s<e;s++)n[s]!==!1&&(this.getMatrixAt(s,$o),this.getBoundingBoxAt(s,su).applyMatrix4($o),i.union(su))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ir);const e=this._geometryCount,i=this.boundingSphere,n=this._active;i.makeEmpty();for(let s=0;s<e;s++)n[s]!==!1&&(this.getMatrixAt(s,$o),this.getBoundingSphereAt(s,Pa).applyMatrix4($o),i.union(Pa))}addGeometry(e,i=-1,n=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const s={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let a=null;const d=this._reservedRanges,v=this._drawRanges,I=this._bounds;this._geometryCount!==0&&(a=d[d.length-1]),i===-1?s.vertexCount=e.getAttribute("position").count:s.vertexCount=i,a===null?s.vertexStart=0:s.vertexStart=a.vertexStart+a.vertexCount;const R=e.getIndex(),O=R!==null;if(O&&(n===-1?s.indexCount=R.count:s.indexCount=n,a===null?s.indexStart=0:s.indexStart=a.indexStart+a.indexCount),s.indexStart!==-1&&s.indexStart+s.indexCount>this._maxIndexCount||s.vertexStart+s.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const k=this._visibility,G=this._active,z=this._matricesTexture,K=this._matricesTexture.image.data;k.push(!0),G.push(!0);const ee=this._geometryCount;this._geometryCount++,WC.toArray(K,ee*16),z.needsUpdate=!0,d.push(s),v.push({start:O?s.indexStart:s.vertexStart,count:-1}),I.push({boxInitialized:!1,box:new hr,sphereInitialized:!1,sphere:new Ir});const X=this.geometry.getAttribute(Rl);for(let Q=0;Q<s.vertexCount;Q++)X.setX(s.vertexStart+Q,ee);return X.needsUpdate=!0,this.setGeometryAt(ee,e),ee}setGeometryAt(e,i){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(i);const n=this.geometry,s=n.getIndex()!==null,a=n.getIndex(),d=i.getIndex(),v=this._reservedRanges[e];if(s&&d.count>v.indexCount||i.attributes.position.count>v.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const I=v.vertexStart,R=v.vertexCount;for(const z in n.attributes){if(z===Rl)continue;const K=i.getAttribute(z),ee=n.getAttribute(z);KC(K,ee,I);const X=K.itemSize;for(let Q=K.count,ge=R;Q<ge;Q++){const Ae=I+Q;for(let he=0;he<X;he++)ee.setComponent(Ae,he,0)}ee.needsUpdate=!0,ee.addUpdateRange(I*X,R*X)}if(s){const z=v.indexStart;for(let K=0;K<d.count;K++)a.setX(z+K,I+d.getX(K));for(let K=d.count,ee=v.indexCount;K<ee;K++)a.setX(z+K,I);a.needsUpdate=!0,a.addUpdateRange(z,v.indexCount)}const O=this._bounds[e];i.boundingBox!==null?(O.box.copy(i.boundingBox),O.boxInitialized=!0):O.boxInitialized=!1,i.boundingSphere!==null?(O.sphere.copy(i.boundingSphere),O.sphereInitialized=!0):O.sphereInitialized=!1;const k=this._drawRanges[e],G=i.getAttribute("position");return k.count=s?d.count:G.count,this._visibilityChanged=!0,e}deleteGeometry(e){const i=this._active;return e>=i.length||i[e]===!1?this:(i[e]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(e){return this._multiDrawInstances===null?null:this._multiDrawInstances[e]}setInstanceCountAt(e,i){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[e]=i,e}getBoundingBoxAt(e,i){if(this._active[e]===!1)return null;const s=this._bounds[e],a=s.box,d=this.geometry;if(s.boxInitialized===!1){a.makeEmpty();const v=d.index,I=d.attributes.position,R=this._drawRanges[e];for(let O=R.start,k=R.start+R.count;O<k;O++){let G=O;v&&(G=v.getX(G)),a.expandByPoint(Sc.fromBufferAttribute(I,G))}s.boxInitialized=!0}return i.copy(a),i}getBoundingSphereAt(e,i){if(this._active[e]===!1)return null;const s=this._bounds[e],a=s.sphere,d=this.geometry;if(s.sphereInitialized===!1){a.makeEmpty(),this.getBoundingBoxAt(e,su),su.getCenter(a.center);const v=d.index,I=d.attributes.position,R=this._drawRanges[e];let O=0;for(let k=R.start,G=R.start+R.count;k<G;k++){let z=k;v&&(z=v.getX(z)),Sc.fromBufferAttribute(I,z),O=Math.max(O,a.center.distanceToSquared(Sc))}a.radius=Math.sqrt(O),s.sphereInitialized=!0}return i.copy(a),i}setMatrixAt(e,i){const n=this._active,s=this._matricesTexture,a=this._matricesTexture.image.data,d=this._geometryCount;return e>=d||n[e]===!1?this:(i.toArray(a,e*16),s.needsUpdate=!0,this)}getMatrixAt(e,i){const n=this._active,s=this._matricesTexture.image.data,a=this._geometryCount;return e>=a||n[e]===!1?null:i.fromArray(s,e*16)}setVisibleAt(e,i){const n=this._visibility,s=this._active,a=this._geometryCount;return e>=a||s[e]===!1||n[e]===i?this:(n[e]=i,this._visibilityChanged=!0,this)}getVisibleAt(e){const i=this._visibility,n=this._active,s=this._geometryCount;return e>=s||n[e]===!1?!1:i[e]}raycast(e,i){const n=this._visibility,s=this._active,a=this._drawRanges,d=this._geometryCount,v=this.matrixWorld,I=this.geometry;es.material=this.material,es.geometry.index=I.index,es.geometry.attributes=I.attributes,es.geometry.boundingBox===null&&(es.geometry.boundingBox=new hr),es.geometry.boundingSphere===null&&(es.geometry.boundingSphere=new Ir);for(let R=0;R<d;R++){if(!n[R]||!s[R])continue;const O=a[R];es.geometry.setDrawRange(O.start,O.count),this.getMatrixAt(R,es.matrixWorld).premultiply(v),this.getBoundingBoxAt(R,es.geometry.boundingBox),this.getBoundingSphereAt(R,es.geometry.boundingSphere),es.raycast(e,ou);for(let k=0,G=ou.length;k<G;k++){const z=ou[k];z.object=this,z.batchId=R,i.push(z)}ou.length=0}es.material=null,es.geometry.index=null,es.geometry.attributes={},es.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(i=>({...i})),this._reservedRanges=e._reservedRanges.map(i=>({...i})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(i=>({boxInitialized:i.boxInitialized,box:i.box.clone(),sphereInitialized:i.sphereInitialized,sphere:i.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,i,n,s,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const d=s.getIndex(),v=d===null?1:d.array.BYTES_PER_ELEMENT,I=this._active,R=this._visibility,O=this._multiDrawStarts,k=this._multiDrawCounts,G=this._drawRanges,z=this.perObjectFrustumCulled;z&&(ig.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),Zf.setFromProjectionMatrix(ig,e.coordinateSystem));let K=0;if(this.sortObjects){tg.copy(this.matrixWorld).invert(),Sc.setFromMatrixPosition(n.matrixWorld).applyMatrix4(tg);for(let Q=0,ge=R.length;Q<ge;Q++)if(R[Q]&&I[Q]){this.getMatrixAt(Q,$o),this.getBoundingSphereAt(Q,Pa).applyMatrix4($o);let Ae=!1;if(z&&(Ae=!Zf.intersectsSphere(Pa)),!Ae){const he=Sc.distanceTo(Pa.center);$f.push(G[Q],he)}}const ee=$f.list,X=this.customSort;X===null?ee.sort(a.transparent?HC:QC):X.call(this,ee,n);for(let Q=0,ge=ee.length;Q<ge;Q++){const Ae=ee[Q];O[K]=Ae.start*v,k[K]=Ae.count,K++}$f.reset()}else for(let ee=0,X=R.length;ee<X;ee++)if(R[ee]&&I[ee]){let Q=!1;if(z&&(this.getMatrixAt(ee,$o),this.getBoundingSphereAt(ee,Pa).applyMatrix4($o),Q=!Zf.intersectsSphere(Pa)),!Q){const ge=G[ee];O[K]=ge.start*v,k[K]=ge.count,K++}}this._multiDrawCount=K,this._visibilityChanged=!1}onBeforeShadow(e,i,n,s,a,d){this.onBeforeRender(e,null,s,a,d)}}class ds extends $r{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new li(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const au=new Ie,lu=new Ie,rg=new mi,Tc=new Br,cu=new Ir,ep=new Ie,sg=new Ie;class ea extends Ln{constructor(e=new on,i=new ds){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[0];for(let s=1,a=i.count;s<a;s++)au.fromBufferAttribute(i,s-1),lu.fromBufferAttribute(i,s),n[s]=n[s-1],n[s]+=au.distanceTo(lu);e.setAttribute("lineDistance",new xi(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const n=this.geometry,s=this.matrixWorld,a=e.params.Line.threshold,d=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cu.copy(n.boundingSphere),cu.applyMatrix4(s),cu.radius+=a,e.ray.intersectsSphere(cu)===!1)return;rg.copy(s).invert(),Tc.copy(e.ray).applyMatrix4(rg);const v=a/((this.scale.x+this.scale.y+this.scale.z)/3),I=v*v,R=this.isLineSegments?2:1,O=n.index,G=n.attributes.position;if(O!==null){const z=Math.max(0,d.start),K=Math.min(O.count,d.start+d.count);for(let ee=z,X=K-1;ee<X;ee+=R){const Q=O.getX(ee),ge=O.getX(ee+1),Ae=hu(this,e,Tc,I,Q,ge);Ae&&i.push(Ae)}if(this.isLineLoop){const ee=O.getX(K-1),X=O.getX(z),Q=hu(this,e,Tc,I,ee,X);Q&&i.push(Q)}}else{const z=Math.max(0,d.start),K=Math.min(G.count,d.start+d.count);for(let ee=z,X=K-1;ee<X;ee+=R){const Q=hu(this,e,Tc,I,ee,ee+1);Q&&i.push(Q)}if(this.isLineLoop){const ee=hu(this,e,Tc,I,K-1,z);ee&&i.push(ee)}}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const s=i[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,d=s.length;a<d;a++){const v=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=a}}}}}function hu(l,e,i,n,s,a){const d=l.geometry.attributes.position;if(au.fromBufferAttribute(d,s),lu.fromBufferAttribute(d,a),i.distanceSqToSegment(au,lu,ep,sg)>n)return;ep.applyMatrix4(l.matrixWorld);const I=e.ray.origin.distanceTo(ep);if(!(I<e.near||I>e.far))return{distance:I,point:sg.clone().applyMatrix4(l.matrixWorld),index:s,face:null,faceIndex:null,object:l}}const og=new Ie,ag=new Ie;class fo extends ea{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[];for(let s=0,a=i.count;s<a;s+=2)og.fromBufferAttribute(i,s),ag.fromBufferAttribute(i,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+og.distanceTo(ag);e.setAttribute("lineDistance",new xi(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class lg extends ea{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}}class tp extends $r{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new li(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const cg=new mi,ip=new Br,uu=new Ir,du=new Ie;class hg extends Ln{constructor(e=new on,i=new tp){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,i){const n=this.geometry,s=this.matrixWorld,a=e.params.Points.threshold,d=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),uu.copy(n.boundingSphere),uu.applyMatrix4(s),uu.radius+=a,e.ray.intersectsSphere(uu)===!1)return;cg.copy(s).invert(),ip.copy(e.ray).applyMatrix4(cg);const v=a/((this.scale.x+this.scale.y+this.scale.z)/3),I=v*v,R=n.index,k=n.attributes.position;if(R!==null){const G=Math.max(0,d.start),z=Math.min(R.count,d.start+d.count);for(let K=G,ee=z;K<ee;K++){const X=R.getX(K);du.fromBufferAttribute(k,X),ug(du,X,I,s,e,i,this)}}else{const G=Math.max(0,d.start),z=Math.min(k.count,d.start+d.count);for(let K=G,ee=z;K<ee;K++)du.fromBufferAttribute(k,K),ug(du,K,I,s,e,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const s=i[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,d=s.length;a<d;a++){const v=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=a}}}}}function ug(l,e,i,n,s,a,d){const v=ip.distanceSqToPoint(l);if(v<i){const I=new Ie;ip.closestPointToPoint(l,I),I.applyMatrix4(n);const R=s.ray.origin.distanceTo(I);if(R<s.near||R>s.far)return;a.push({distance:R,distanceToRay:Math.sqrt(v),point:I,index:e,face:null,object:d})}}class XC extends qn{constructor(e,i,n,s,a,d,v,I,R){super(e,i,n,s,a,d,v,I,R),this.isVideoTexture=!0,this.minFilter=d!==void 0?d:wi,this.magFilter=a!==void 0?a:wi,this.generateMipmaps=!1;const O=this;function k(){O.needsUpdate=!0,e.requestVideoFrameCallback(k)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(k)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class YC extends qn{constructor(e,i){super({width:e,height:i}),this.isFramebufferTexture=!0,this.magFilter=zt,this.minFilter=zt,this.generateMipmaps=!1,this.needsUpdate=!0}}class fu extends qn{constructor(e,i,n,s,a,d,v,I,R,O,k,G){super(null,d,v,I,R,O,s,a,k,G),this.isCompressedTexture=!0,this.image={width:i,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class qC extends fu{constructor(e,i,n,s,a,d){super(e,i,n,a,d),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=We}}class JC extends fu{constructor(e,i,n){super(void 0,e[0].width,e[0].height,i,n,$),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class ZC extends qn{constructor(e,i,n,s,a,d,v,I,R){super(e,i,n,s,a,d,v,I,R),this.isCanvasTexture=!0,this.needsUpdate=!0}}class qs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const n=this.getUtoTmapping(e);return this.getPoint(n,i)}getPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return i}getSpacedPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPointAt(n/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,s=this.getPoint(0),a=0;i.push(0);for(let d=1;d<=e;d++)n=this.getPoint(d/e),a+=n.distanceTo(s),i.push(a),s=n;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const n=this.getLengths();let s=0;const a=n.length;let d;i?d=i:d=e*n[a-1];let v=0,I=a-1,R;for(;v<=I;)if(s=Math.floor(v+(I-v)/2),R=n[s]-d,R<0)v=s+1;else if(R>0)I=s-1;else{I=s;break}if(s=I,n[s]===d)return s/(a-1);const O=n[s],G=n[s+1]-O,z=(d-O)/G;return(s+z)/(a-1)}getTangent(e,i){let s=e-1e-4,a=e+1e-4;s<0&&(s=0),a>1&&(a=1);const d=this.getPoint(s),v=this.getPoint(a),I=i||(d.isVector2?new xt:new Ie);return I.copy(v).sub(d).normalize(),I}getTangentAt(e,i){const n=this.getUtoTmapping(e);return this.getTangent(n,i)}computeFrenetFrames(e,i){const n=new Ie,s=[],a=[],d=[],v=new Ie,I=new mi;for(let z=0;z<=e;z++){const K=z/e;s[z]=this.getTangentAt(K,new Ie)}a[0]=new Ie,d[0]=new Ie;let R=Number.MAX_VALUE;const O=Math.abs(s[0].x),k=Math.abs(s[0].y),G=Math.abs(s[0].z);O<=R&&(R=O,n.set(1,0,0)),k<=R&&(R=k,n.set(0,1,0)),G<=R&&n.set(0,0,1),v.crossVectors(s[0],n).normalize(),a[0].crossVectors(s[0],v),d[0].crossVectors(s[0],a[0]);for(let z=1;z<=e;z++){if(a[z]=a[z-1].clone(),d[z]=d[z-1].clone(),v.crossVectors(s[z-1],s[z]),v.length()>Number.EPSILON){v.normalize();const K=Math.acos(or(s[z-1].dot(s[z]),-1,1));a[z].applyMatrix4(I.makeRotationAxis(v,K))}d[z].crossVectors(s[z],a[z])}if(i===!0){let z=Math.acos(or(a[0].dot(a[e]),-1,1));z/=e,s[0].dot(v.crossVectors(a[0],a[e]))>0&&(z=-z);for(let K=1;K<=e;K++)a[K].applyMatrix4(I.makeRotationAxis(s[K],z*K)),d[K].crossVectors(s[K],a[K])}return{tangents:s,normals:a,binormals:d}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class pu extends qs{constructor(e=0,i=0,n=1,s=1,a=0,d=Math.PI*2,v=!1,I=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=n,this.yRadius=s,this.aStartAngle=a,this.aEndAngle=d,this.aClockwise=v,this.aRotation=I}getPoint(e,i=new xt){const n=i,s=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const d=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=s;for(;a>s;)a-=s;a<Number.EPSILON&&(d?a=0:a=s),this.aClockwise===!0&&!d&&(a===s?a=-s:a=a-s);const v=this.aStartAngle+e*a;let I=this.aX+this.xRadius*Math.cos(v),R=this.aY+this.yRadius*Math.sin(v);if(this.aRotation!==0){const O=Math.cos(this.aRotation),k=Math.sin(this.aRotation),G=I-this.aX,z=R-this.aY;I=G*O-z*k+this.aX,R=G*k+z*O+this.aY}return n.set(I,R)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class dg extends pu{constructor(e,i,n,s,a,d){super(e,i,n,n,s,a,d),this.isArcCurve=!0,this.type="ArcCurve"}}function np(){let l=0,e=0,i=0,n=0;function s(a,d,v,I){l=a,e=v,i=-3*a+3*d-2*v-I,n=2*a-2*d+v+I}return{initCatmullRom:function(a,d,v,I,R){s(d,v,R*(v-a),R*(I-d))},initNonuniformCatmullRom:function(a,d,v,I,R,O,k){let G=(d-a)/R-(v-a)/(R+O)+(v-d)/O,z=(v-d)/O-(I-d)/(O+k)+(I-v)/k;G*=O,z*=O,s(d,v,G,z)},calc:function(a){const d=a*a,v=d*a;return l+e*a+i*d+n*v}}}const Au=new Ie,rp=new np,sp=new np,op=new np;class fg extends qs{constructor(e=[],i=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=n,this.tension=s}getPoint(e,i=new Ie){const n=i,s=this.points,a=s.length,d=(a-(this.closed?0:1))*e;let v=Math.floor(d),I=d-v;this.closed?v+=v>0?0:(Math.floor(Math.abs(v)/a)+1)*a:I===0&&v===a-1&&(v=a-2,I=1);let R,O;this.closed||v>0?R=s[(v-1)%a]:(Au.subVectors(s[0],s[1]).add(s[0]),R=Au);const k=s[v%a],G=s[(v+1)%a];if(this.closed||v+2<a?O=s[(v+2)%a]:(Au.subVectors(s[a-1],s[a-2]).add(s[a-1]),O=Au),this.curveType==="centripetal"||this.curveType==="chordal"){const z=this.curveType==="chordal"?.5:.25;let K=Math.pow(R.distanceToSquared(k),z),ee=Math.pow(k.distanceToSquared(G),z),X=Math.pow(G.distanceToSquared(O),z);ee<1e-4&&(ee=1),K<1e-4&&(K=ee),X<1e-4&&(X=ee),rp.initNonuniformCatmullRom(R.x,k.x,G.x,O.x,K,ee,X),sp.initNonuniformCatmullRom(R.y,k.y,G.y,O.y,K,ee,X),op.initNonuniformCatmullRom(R.z,k.z,G.z,O.z,K,ee,X)}else this.curveType==="catmullrom"&&(rp.initCatmullRom(R.x,k.x,G.x,O.x,this.tension),sp.initCatmullRom(R.y,k.y,G.y,O.y,this.tension),op.initCatmullRom(R.z,k.z,G.z,O.z,this.tension));return n.set(rp.calc(I),sp.calc(I),op.calc(I)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const s=this.points[i];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(new Ie().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function pg(l,e,i,n,s){const a=(n-e)*.5,d=(s-i)*.5,v=l*l,I=l*v;return(2*i-2*n+a+d)*I+(-3*i+3*n-2*a-d)*v+a*l+i}function $C(l,e){const i=1-l;return i*i*e}function eb(l,e){return 2*(1-l)*l*e}function tb(l,e){return l*l*e}function Ic(l,e,i,n){return $C(l,e)+eb(l,i)+tb(l,n)}function ib(l,e){const i=1-l;return i*i*i*e}function nb(l,e){const i=1-l;return 3*i*i*l*e}function rb(l,e){return 3*(1-l)*l*l*e}function sb(l,e){return l*l*l*e}function Bc(l,e,i,n,s){return ib(l,e)+nb(l,i)+rb(l,n)+sb(l,s)}class ap extends qs{constructor(e=new xt,i=new xt,n=new xt,s=new xt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=n,this.v3=s}getPoint(e,i=new xt){const n=i,s=this.v0,a=this.v1,d=this.v2,v=this.v3;return n.set(Bc(e,s.x,a.x,d.x,v.x),Bc(e,s.y,a.y,d.y,v.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Ag extends qs{constructor(e=new Ie,i=new Ie,n=new Ie,s=new Ie){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=n,this.v3=s}getPoint(e,i=new Ie){const n=i,s=this.v0,a=this.v1,d=this.v2,v=this.v3;return n.set(Bc(e,s.x,a.x,d.x,v.x),Bc(e,s.y,a.y,d.y,v.y),Bc(e,s.z,a.z,d.z,v.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lp extends qs{constructor(e=new xt,i=new xt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new xt){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new xt){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mg extends qs{constructor(e=new Ie,i=new Ie){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new Ie){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new Ie){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class cp extends qs{constructor(e=new xt,i=new xt,n=new xt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new xt){const n=i,s=this.v0,a=this.v1,d=this.v2;return n.set(Ic(e,s.x,a.x,d.x),Ic(e,s.y,a.y,d.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hp extends qs{constructor(e=new Ie,i=new Ie,n=new Ie){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new Ie){const n=i,s=this.v0,a=this.v1,d=this.v2;return n.set(Ic(e,s.x,a.x,d.x),Ic(e,s.y,a.y,d.y),Ic(e,s.z,a.z,d.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class up extends qs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new xt){const n=i,s=this.points,a=(s.length-1)*e,d=Math.floor(a),v=a-d,I=s[d===0?d:d-1],R=s[d],O=s[d>s.length-2?s.length-1:d+1],k=s[d>s.length-3?s.length-1:d+2];return n.set(pg(v,I.x,R.x,O.x,k.x),pg(v,I.y,R.y,O.y,k.y)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const s=this.points[i];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(new xt().fromArray(s))}return this}}var mu=Object.freeze({__proto__:null,ArcCurve:dg,CatmullRomCurve3:fg,CubicBezierCurve:ap,CubicBezierCurve3:Ag,EllipseCurve:pu,LineCurve:lp,LineCurve3:mg,QuadraticBezierCurve:cp,QuadraticBezierCurve3:hp,SplineCurve:up});class gg extends qs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(i)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new mu[n](i,e))}return this}getPoint(e,i){const n=e*this.getLength(),s=this.getCurveLengths();let a=0;for(;a<s.length;){if(s[a]>=n){const d=s[a]-n,v=this.curves[a],I=v.getLength(),R=I===0?0:1-d/I;return v.getPointAt(R,i)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let n=0,s=this.curves.length;n<s;n++)i+=this.curves[n].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let n;for(let s=0,a=this.curves;s<a.length;s++){const d=a[s],v=d.isEllipseCurve?e*2:d.isLineCurve||d.isLineCurve3?1:d.isSplineCurve?e*d.points.length:e,I=d.getPoints(v);for(let R=0;R<I.length;R++){const O=I[R];n&&n.equals(O)||(i.push(O),n=O)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const s=e.curves[i];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const s=this.curves[i];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const s=e.curves[i];this.curves.push(new mu[s.type]().fromJSON(s))}return this}}class Rc extends gg{constructor(e){super(),this.type="Path",this.currentPoint=new xt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,n=e.length;i<n;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const n=new lp(this.currentPoint.clone(),new xt(e,i));return this.curves.push(n),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,n,s){const a=new cp(this.currentPoint.clone(),new xt(e,i),new xt(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}bezierCurveTo(e,i,n,s,a,d){const v=new ap(this.currentPoint.clone(),new xt(e,i),new xt(n,s),new xt(a,d));return this.curves.push(v),this.currentPoint.set(a,d),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),n=new up(i);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,n,s,a,d){const v=this.currentPoint.x,I=this.currentPoint.y;return this.absarc(e+v,i+I,n,s,a,d),this}absarc(e,i,n,s,a,d){return this.absellipse(e,i,n,n,s,a,d),this}ellipse(e,i,n,s,a,d,v,I){const R=this.currentPoint.x,O=this.currentPoint.y;return this.absellipse(e+R,i+O,n,s,a,d,v,I),this}absellipse(e,i,n,s,a,d,v,I){const R=new pu(e,i,n,s,a,d,v,I);if(this.curves.length>0){const k=R.getPoint(0);k.equals(this.currentPoint)||this.lineTo(k.x,k.y)}this.curves.push(R);const O=R.getPoint(1);return this.currentPoint.copy(O),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Lc extends on{constructor(e=[new xt(0,-.5),new xt(.5,0),new xt(0,.5)],i=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:n,phiLength:s},i=Math.floor(i),s=or(s,0,Math.PI*2);const a=[],d=[],v=[],I=[],R=[],O=1/i,k=new Ie,G=new xt,z=new Ie,K=new Ie,ee=new Ie;let X=0,Q=0;for(let ge=0;ge<=e.length-1;ge++)switch(ge){case 0:X=e[ge+1].x-e[ge].x,Q=e[ge+1].y-e[ge].y,z.x=Q*1,z.y=-X,z.z=Q*0,ee.copy(z),z.normalize(),I.push(z.x,z.y,z.z);break;case e.length-1:I.push(ee.x,ee.y,ee.z);break;default:X=e[ge+1].x-e[ge].x,Q=e[ge+1].y-e[ge].y,z.x=Q*1,z.y=-X,z.z=Q*0,K.copy(z),z.x+=ee.x,z.y+=ee.y,z.z+=ee.z,z.normalize(),I.push(z.x,z.y,z.z),ee.copy(K)}for(let ge=0;ge<=i;ge++){const Ae=n+ge*O*s,he=Math.sin(Ae),Qe=Math.cos(Ae);for(let Be=0;Be<=e.length-1;Be++){k.x=e[Be].x*he,k.y=e[Be].y,k.z=e[Be].x*Qe,d.push(k.x,k.y,k.z),G.x=ge/i,G.y=Be/(e.length-1),v.push(G.x,G.y);const Oe=I[3*Be+0]*he,Ve=I[3*Be+1],_e=I[3*Be+0]*Qe;R.push(Oe,Ve,_e)}}for(let ge=0;ge<i;ge++)for(let Ae=0;Ae<e.length-1;Ae++){const he=Ae+ge*e.length,Qe=he,Be=he+e.length,Oe=he+e.length+1,Ve=he+1;a.push(Qe,Be,Ve),a.push(Oe,Ve,Be)}this.setIndex(a),this.setAttribute("position",new xi(d,3)),this.setAttribute("uv",new xi(v,2)),this.setAttribute("normal",new xi(R,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lc(e.points,e.segments,e.phiStart,e.phiLength)}}class gu extends Lc{constructor(e=1,i=1,n=4,s=8){const a=new Rc;a.absarc(0,-i/2,e,Math.PI*1.5,0),a.absarc(0,i/2,e,0,Math.PI*.5),super(a.getPoints(n),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:i,capSegments:n,radialSegments:s}}static fromJSON(e){return new gu(e.radius,e.length,e.capSegments,e.radialSegments)}}class vu extends on{constructor(e=1,i=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:n,thetaLength:s},i=Math.max(3,i);const a=[],d=[],v=[],I=[],R=new Ie,O=new xt;d.push(0,0,0),v.push(0,0,1),I.push(.5,.5);for(let k=0,G=3;k<=i;k++,G+=3){const z=n+k/i*s;R.x=e*Math.cos(z),R.y=e*Math.sin(z),d.push(R.x,R.y,R.z),v.push(0,0,1),O.x=(d[G]/e+1)/2,O.y=(d[G+1]/e+1)/2,I.push(O.x,O.y)}for(let k=1;k<=i;k++)a.push(k,k+1,0);this.setIndex(a),this.setAttribute("position",new xi(d,3)),this.setAttribute("normal",new xi(v,3)),this.setAttribute("uv",new xi(I,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vu(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ll extends on{constructor(e=1,i=1,n=1,s=32,a=1,d=!1,v=0,I=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:n,radialSegments:s,heightSegments:a,openEnded:d,thetaStart:v,thetaLength:I};const R=this;s=Math.floor(s),a=Math.floor(a);const O=[],k=[],G=[],z=[];let K=0;const ee=[],X=n/2;let Q=0;ge(),d===!1&&(e>0&&Ae(!0),i>0&&Ae(!1)),this.setIndex(O),this.setAttribute("position",new xi(k,3)),this.setAttribute("normal",new xi(G,3)),this.setAttribute("uv",new xi(z,2));function ge(){const he=new Ie,Qe=new Ie;let Be=0;const Oe=(i-e)/n;for(let Ve=0;Ve<=a;Ve++){const _e=[],xe=Ve/a,ze=xe*(i-e)+e;for(let qe=0;qe<=s;qe++){const Ke=qe/s,$e=Ke*I+v,at=Math.sin($e),vt=Math.cos($e);Qe.x=ze*at,Qe.y=-xe*n+X,Qe.z=ze*vt,k.push(Qe.x,Qe.y,Qe.z),he.set(at,Oe,vt).normalize(),G.push(he.x,he.y,he.z),z.push(Ke,1-xe),_e.push(K++)}ee.push(_e)}for(let Ve=0;Ve<s;Ve++)for(let _e=0;_e<a;_e++){const xe=ee[_e][Ve],ze=ee[_e+1][Ve],qe=ee[_e+1][Ve+1],Ke=ee[_e][Ve+1];O.push(xe,ze,Ke),O.push(ze,qe,Ke),Be+=6}R.addGroup(Q,Be,0),Q+=Be}function Ae(he){const Qe=K,Be=new xt,Oe=new Ie;let Ve=0;const _e=he===!0?e:i,xe=he===!0?1:-1;for(let qe=1;qe<=s;qe++)k.push(0,X*xe,0),G.push(0,xe,0),z.push(.5,.5),K++;const ze=K;for(let qe=0;qe<=s;qe++){const $e=qe/s*I+v,at=Math.cos($e),vt=Math.sin($e);Oe.x=_e*vt,Oe.y=X*xe,Oe.z=_e*at,k.push(Oe.x,Oe.y,Oe.z),G.push(0,xe,0),Be.x=at*.5+.5,Be.y=vt*.5*xe+.5,z.push(Be.x,Be.y),K++}for(let qe=0;qe<s;qe++){const Ke=Qe+qe,$e=ze+qe;he===!0?O.push($e,$e+1,Ke):O.push($e+1,$e,Ke),Ve+=3}R.addGroup(Q,Ve,he===!0?1:2),Q+=Ve}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ll(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class yu extends Ll{constructor(e=1,i=1,n=32,s=1,a=!1,d=0,v=Math.PI*2){super(0,e,i,n,s,a,d,v),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:d,thetaLength:v}}static fromJSON(e){return new yu(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ta extends on{constructor(e=[],i=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:n,detail:s};const a=[],d=[];v(s),R(n),O(),this.setAttribute("position",new xi(a,3)),this.setAttribute("normal",new xi(a.slice(),3)),this.setAttribute("uv",new xi(d,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function v(ge){const Ae=new Ie,he=new Ie,Qe=new Ie;for(let Be=0;Be<i.length;Be+=3)z(i[Be+0],Ae),z(i[Be+1],he),z(i[Be+2],Qe),I(Ae,he,Qe,ge)}function I(ge,Ae,he,Qe){const Be=Qe+1,Oe=[];for(let Ve=0;Ve<=Be;Ve++){Oe[Ve]=[];const _e=ge.clone().lerp(he,Ve/Be),xe=Ae.clone().lerp(he,Ve/Be),ze=Be-Ve;for(let qe=0;qe<=ze;qe++)qe===0&&Ve===Be?Oe[Ve][qe]=_e:Oe[Ve][qe]=_e.clone().lerp(xe,qe/ze)}for(let Ve=0;Ve<Be;Ve++)for(let _e=0;_e<2*(Be-Ve)-1;_e++){const xe=Math.floor(_e/2);_e%2===0?(G(Oe[Ve][xe+1]),G(Oe[Ve+1][xe]),G(Oe[Ve][xe])):(G(Oe[Ve][xe+1]),G(Oe[Ve+1][xe+1]),G(Oe[Ve+1][xe]))}}function R(ge){const Ae=new Ie;for(let he=0;he<a.length;he+=3)Ae.x=a[he+0],Ae.y=a[he+1],Ae.z=a[he+2],Ae.normalize().multiplyScalar(ge),a[he+0]=Ae.x,a[he+1]=Ae.y,a[he+2]=Ae.z}function O(){const ge=new Ie;for(let Ae=0;Ae<a.length;Ae+=3){ge.x=a[Ae+0],ge.y=a[Ae+1],ge.z=a[Ae+2];const he=X(ge)/2/Math.PI+.5,Qe=Q(ge)/Math.PI+.5;d.push(he,1-Qe)}K(),k()}function k(){for(let ge=0;ge<d.length;ge+=6){const Ae=d[ge+0],he=d[ge+2],Qe=d[ge+4],Be=Math.max(Ae,he,Qe),Oe=Math.min(Ae,he,Qe);Be>.9&&Oe<.1&&(Ae<.2&&(d[ge+0]+=1),he<.2&&(d[ge+2]+=1),Qe<.2&&(d[ge+4]+=1))}}function G(ge){a.push(ge.x,ge.y,ge.z)}function z(ge,Ae){const he=ge*3;Ae.x=e[he+0],Ae.y=e[he+1],Ae.z=e[he+2]}function K(){const ge=new Ie,Ae=new Ie,he=new Ie,Qe=new Ie,Be=new xt,Oe=new xt,Ve=new xt;for(let _e=0,xe=0;_e<a.length;_e+=9,xe+=6){ge.set(a[_e+0],a[_e+1],a[_e+2]),Ae.set(a[_e+3],a[_e+4],a[_e+5]),he.set(a[_e+6],a[_e+7],a[_e+8]),Be.set(d[xe+0],d[xe+1]),Oe.set(d[xe+2],d[xe+3]),Ve.set(d[xe+4],d[xe+5]),Qe.copy(ge).add(Ae).add(he).divideScalar(3);const ze=X(Qe);ee(Be,xe+0,ge,ze),ee(Oe,xe+2,Ae,ze),ee(Ve,xe+4,he,ze)}}function ee(ge,Ae,he,Qe){Qe<0&&ge.x===1&&(d[Ae]=ge.x-1),he.x===0&&he.z===0&&(d[Ae]=Qe/2/Math.PI+.5)}function X(ge){return Math.atan2(ge.z,-ge.x)}function Q(ge){return Math.atan2(-ge.y,Math.sqrt(ge.x*ge.x+ge.z*ge.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ta(e.vertices,e.indices,e.radius,e.details)}}class Eu extends ta{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,s=1/n,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],d=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(a,d,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Eu(e.radius,e.detail)}}const xu=new Ie,Cu=new Ie,dp=new Ie,bu=new Bs;class vg extends on{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const s=Math.pow(10,4),a=Math.cos(Eo*i),d=e.getIndex(),v=e.getAttribute("position"),I=d?d.count:v.count,R=[0,0,0],O=["a","b","c"],k=new Array(3),G={},z=[];for(let K=0;K<I;K+=3){d?(R[0]=d.getX(K),R[1]=d.getX(K+1),R[2]=d.getX(K+2)):(R[0]=K,R[1]=K+1,R[2]=K+2);const{a:ee,b:X,c:Q}=bu;if(ee.fromBufferAttribute(v,R[0]),X.fromBufferAttribute(v,R[1]),Q.fromBufferAttribute(v,R[2]),bu.getNormal(dp),k[0]=`${Math.round(ee.x*s)},${Math.round(ee.y*s)},${Math.round(ee.z*s)}`,k[1]=`${Math.round(X.x*s)},${Math.round(X.y*s)},${Math.round(X.z*s)}`,k[2]=`${Math.round(Q.x*s)},${Math.round(Q.y*s)},${Math.round(Q.z*s)}`,!(k[0]===k[1]||k[1]===k[2]||k[2]===k[0]))for(let ge=0;ge<3;ge++){const Ae=(ge+1)%3,he=k[ge],Qe=k[Ae],Be=bu[O[ge]],Oe=bu[O[Ae]],Ve=`${he}_${Qe}`,_e=`${Qe}_${he}`;_e in G&&G[_e]?(dp.dot(G[_e].normal)<=a&&(z.push(Be.x,Be.y,Be.z),z.push(Oe.x,Oe.y,Oe.z)),G[_e]=null):Ve in G||(G[Ve]={index0:R[ge],index1:R[Ae],normal:dp.clone()})}}for(const K in G)if(G[K]){const{index0:ee,index1:X}=G[K];xu.fromBufferAttribute(v,ee),Cu.fromBufferAttribute(v,X),z.push(xu.x,xu.y,xu.z),z.push(Cu.x,Cu.y,Cu.z)}this.setAttribute("position",new xi(z,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Oa extends Rc{constructor(e){super(e),this.uuid=ls(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let n=0,s=this.holes.length;n<s;n++)i[n]=this.holes[n].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const s=e.holes[i];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const s=this.holes[i];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const s=e.holes[i];this.holes.push(new Rc().fromJSON(s))}return this}}const ob={triangulate:function(l,e,i=2){const n=e&&e.length,s=n?e[0]*i:l.length;let a=yg(l,0,s,i,!0);const d=[];if(!a||a.next===a.prev)return d;let v,I,R,O,k,G,z;if(n&&(a=ub(l,e,a,i)),l.length>80*i){v=R=l[0],I=O=l[1];for(let K=i;K<s;K+=i)k=l[K],G=l[K+1],k<v&&(v=k),G<I&&(I=G),k>R&&(R=k),G>O&&(O=G);z=Math.max(R-v,O-I),z=z!==0?32767/z:0}return Dc(a,d,i,v,I,z,0),d}};function yg(l,e,i,n,s){let a,d;if(s===Cb(l,e,i,n)>0)for(a=e;a<i;a+=n)d=Cg(a,l[a],l[a+1],d);else for(a=i-n;a>=e;a-=n)d=Cg(a,l[a],l[a+1],d);return d&&wu(d,d.next)&&(Oc(d),d=d.next),d}function Fa(l,e){if(!l)return l;e||(e=l);let i=l,n;do if(n=!1,!i.steiner&&(wu(i,i.next)||ur(i.prev,i,i.next)===0)){if(Oc(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function Dc(l,e,i,n,s,a,d){if(!l)return;!d&&a&&mb(l,n,s,a);let v=l,I,R;for(;l.prev!==l.next;){if(I=l.prev,R=l.next,a?lb(l,n,s,a):ab(l)){e.push(I.i/i|0),e.push(l.i/i|0),e.push(R.i/i|0),Oc(l),l=R.next,v=R.next;continue}if(l=R,l===v){d?d===1?(l=cb(Fa(l),e,i),Dc(l,e,i,n,s,a,2)):d===2&&hb(l,e,i,n,s,a):Dc(Fa(l),e,i,n,s,a,1);break}}}function ab(l){const e=l.prev,i=l,n=l.next;if(ur(e,i,n)>=0)return!1;const s=e.x,a=i.x,d=n.x,v=e.y,I=i.y,R=n.y,O=s<a?s<d?s:d:a<d?a:d,k=v<I?v<R?v:R:I<R?I:R,G=s>a?s>d?s:d:a>d?a:d,z=v>I?v>R?v:R:I>R?I:R;let K=n.next;for(;K!==e;){if(K.x>=O&&K.x<=G&&K.y>=k&&K.y<=z&&Dl(s,v,a,I,d,R,K.x,K.y)&&ur(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function lb(l,e,i,n){const s=l.prev,a=l,d=l.next;if(ur(s,a,d)>=0)return!1;const v=s.x,I=a.x,R=d.x,O=s.y,k=a.y,G=d.y,z=v<I?v<R?v:R:I<R?I:R,K=O<k?O<G?O:G:k<G?k:G,ee=v>I?v>R?v:R:I>R?I:R,X=O>k?O>G?O:G:k>G?k:G,Q=fp(z,K,e,i,n),ge=fp(ee,X,e,i,n);let Ae=l.prevZ,he=l.nextZ;for(;Ae&&Ae.z>=Q&&he&&he.z<=ge;){if(Ae.x>=z&&Ae.x<=ee&&Ae.y>=K&&Ae.y<=X&&Ae!==s&&Ae!==d&&Dl(v,O,I,k,R,G,Ae.x,Ae.y)&&ur(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,he.x>=z&&he.x<=ee&&he.y>=K&&he.y<=X&&he!==s&&he!==d&&Dl(v,O,I,k,R,G,he.x,he.y)&&ur(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;Ae&&Ae.z>=Q;){if(Ae.x>=z&&Ae.x<=ee&&Ae.y>=K&&Ae.y<=X&&Ae!==s&&Ae!==d&&Dl(v,O,I,k,R,G,Ae.x,Ae.y)&&ur(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;he&&he.z<=ge;){if(he.x>=z&&he.x<=ee&&he.y>=K&&he.y<=X&&he!==s&&he!==d&&Dl(v,O,I,k,R,G,he.x,he.y)&&ur(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function cb(l,e,i){let n=l;do{const s=n.prev,a=n.next.next;!wu(s,a)&&Eg(s,n,n.next,a)&&Pc(s,a)&&Pc(a,s)&&(e.push(s.i/i|0),e.push(n.i/i|0),e.push(a.i/i|0),Oc(n),Oc(n.next),n=l=a),n=n.next}while(n!==l);return Fa(n)}function hb(l,e,i,n,s,a){let d=l;do{let v=d.next.next;for(;v!==d.prev;){if(d.i!==v.i&&yb(d,v)){let I=xg(d,v);d=Fa(d,d.next),I=Fa(I,I.next),Dc(d,e,i,n,s,a,0),Dc(I,e,i,n,s,a,0);return}v=v.next}d=d.next}while(d!==l)}function ub(l,e,i,n){const s=[];let a,d,v,I,R;for(a=0,d=e.length;a<d;a++)v=e[a]*n,I=a<d-1?e[a+1]*n:l.length,R=yg(l,v,I,n,!1),R===R.next&&(R.steiner=!0),s.push(vb(R));for(s.sort(db),a=0;a<s.length;a++)i=fb(s[a],i);return i}function db(l,e){return l.x-e.x}function fb(l,e){const i=pb(l,e);if(!i)return e;const n=xg(i,l);return Fa(n,n.next),Fa(i,i.next)}function pb(l,e){let i=e,n=-1/0,s;const a=l.x,d=l.y;do{if(d<=i.y&&d>=i.next.y&&i.next.y!==i.y){const G=i.x+(d-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(G<=a&&G>n&&(n=G,s=i.x<i.next.x?i:i.next,G===a))return s}i=i.next}while(i!==e);if(!s)return null;const v=s,I=s.x,R=s.y;let O=1/0,k;i=s;do a>=i.x&&i.x>=I&&a!==i.x&&Dl(d<R?a:n,d,I,R,d<R?n:a,d,i.x,i.y)&&(k=Math.abs(d-i.y)/(a-i.x),Pc(i,l)&&(k<O||k===O&&(i.x>s.x||i.x===s.x&&Ab(s,i)))&&(s=i,O=k)),i=i.next;while(i!==v);return s}function Ab(l,e){return ur(l.prev,l,e.prev)<0&&ur(e.next,l,l.next)<0}function mb(l,e,i,n){let s=l;do s.z===0&&(s.z=fp(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==l);s.prevZ.nextZ=null,s.prevZ=null,gb(s)}function gb(l){let e,i,n,s,a,d,v,I,R=1;do{for(i=l,l=null,a=null,d=0;i;){for(d++,n=i,v=0,e=0;e<R&&(v++,n=n.nextZ,!!n);e++);for(I=R;v>0||I>0&&n;)v!==0&&(I===0||!n||i.z<=n.z)?(s=i,i=i.nextZ,v--):(s=n,n=n.nextZ,I--),a?a.nextZ=s:l=s,s.prevZ=a,a=s;i=n}a.nextZ=null,R*=2}while(d>1);return l}function fp(l,e,i,n,s){return l=(l-i)*s|0,e=(e-n)*s|0,l=(l|l<<8)&16711935,l=(l|l<<4)&252645135,l=(l|l<<2)&858993459,l=(l|l<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,l|e<<1}function vb(l){let e=l,i=l;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==l);return i}function Dl(l,e,i,n,s,a,d,v){return(s-d)*(e-v)>=(l-d)*(a-v)&&(l-d)*(n-v)>=(i-d)*(e-v)&&(i-d)*(a-v)>=(s-d)*(n-v)}function yb(l,e){return l.next.i!==e.i&&l.prev.i!==e.i&&!Eb(l,e)&&(Pc(l,e)&&Pc(e,l)&&xb(l,e)&&(ur(l.prev,l,e.prev)||ur(l,e.prev,e))||wu(l,e)&&ur(l.prev,l,l.next)>0&&ur(e.prev,e,e.next)>0)}function ur(l,e,i){return(e.y-l.y)*(i.x-e.x)-(e.x-l.x)*(i.y-e.y)}function wu(l,e){return l.x===e.x&&l.y===e.y}function Eg(l,e,i,n){const s=_u(ur(l,e,i)),a=_u(ur(l,e,n)),d=_u(ur(i,n,l)),v=_u(ur(i,n,e));return!!(s!==a&&d!==v||s===0&&Mu(l,i,e)||a===0&&Mu(l,n,e)||d===0&&Mu(i,l,n)||v===0&&Mu(i,e,n))}function Mu(l,e,i){return e.x<=Math.max(l.x,i.x)&&e.x>=Math.min(l.x,i.x)&&e.y<=Math.max(l.y,i.y)&&e.y>=Math.min(l.y,i.y)}function _u(l){return l>0?1:l<0?-1:0}function Eb(l,e){let i=l;do{if(i.i!==l.i&&i.next.i!==l.i&&i.i!==e.i&&i.next.i!==e.i&&Eg(i,i.next,l,e))return!0;i=i.next}while(i!==l);return!1}function Pc(l,e){return ur(l.prev,l,l.next)<0?ur(l,e,l.next)>=0&&ur(l,l.prev,e)>=0:ur(l,e,l.prev)<0||ur(l,l.next,e)<0}function xb(l,e){let i=l,n=!1;const s=(l.x+e.x)/2,a=(l.y+e.y)/2;do i.y>a!=i.next.y>a&&i.next.y!==i.y&&s<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==l);return n}function xg(l,e){const i=new pp(l.i,l.x,l.y),n=new pp(e.i,e.x,e.y),s=l.next,a=e.prev;return l.next=e,e.prev=l,i.next=s,s.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function Cg(l,e,i,n){const s=new pp(l,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function Oc(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function pp(l,e,i){this.i=l,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cb(l,e,i,n){let s=0;for(let a=e,d=i-n;a<i;a+=n)s+=(l[d]-l[a])*(l[a+1]+l[d+1]),d=a;return s}class po{static area(e){const i=e.length;let n=0;for(let s=i-1,a=0;a<i;s=a++)n+=e[s].x*e[a].y-e[a].x*e[s].y;return n*.5}static isClockWise(e){return po.area(e)<0}static triangulateShape(e,i){const n=[],s=[],a=[];bg(e),wg(n,e);let d=e.length;i.forEach(bg);for(let I=0;I<i.length;I++)s.push(d),d+=i[I].length,wg(n,i[I]);const v=ob.triangulate(n,s);for(let I=0;I<v.length;I+=3)a.push(v.slice(I,I+3));return a}}function bg(l){const e=l.length;e>2&&l[e-1].equals(l[0])&&l.pop()}function wg(l,e){for(let i=0;i<e.length;i++)l.push(e[i].x),l.push(e[i].y)}class Su extends on{constructor(e=new Oa([new xt(.5,.5),new xt(-.5,.5),new xt(-.5,-.5),new xt(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const n=this,s=[],a=[];for(let v=0,I=e.length;v<I;v++){const R=e[v];d(R)}this.setAttribute("position",new xi(s,3)),this.setAttribute("uv",new xi(a,2)),this.computeVertexNormals();function d(v){const I=[],R=i.curveSegments!==void 0?i.curveSegments:12,O=i.steps!==void 0?i.steps:1,k=i.depth!==void 0?i.depth:1;let G=i.bevelEnabled!==void 0?i.bevelEnabled:!0,z=i.bevelThickness!==void 0?i.bevelThickness:.2,K=i.bevelSize!==void 0?i.bevelSize:z-.1,ee=i.bevelOffset!==void 0?i.bevelOffset:0,X=i.bevelSegments!==void 0?i.bevelSegments:3;const Q=i.extrudePath,ge=i.UVGenerator!==void 0?i.UVGenerator:bb;let Ae,he=!1,Qe,Be,Oe,Ve;Q&&(Ae=Q.getSpacedPoints(O),he=!0,G=!1,Qe=Q.computeFrenetFrames(O,!1),Be=new Ie,Oe=new Ie,Ve=new Ie),G||(X=0,z=0,K=0,ee=0);const _e=v.extractPoints(R);let xe=_e.shape;const ze=_e.holes;if(!po.isClockWise(xe)){xe=xe.reverse();for(let wt=0,gt=ze.length;wt<gt;wt++){const kt=ze[wt];po.isClockWise(kt)&&(ze[wt]=kt.reverse())}}const Ke=po.triangulateShape(xe,ze),$e=xe;for(let wt=0,gt=ze.length;wt<gt;wt++){const kt=ze[wt];xe=xe.concat(kt)}function at(wt,gt,kt){return gt||console.error("THREE.ExtrudeGeometry: vec does not exist"),wt.clone().addScaledVector(gt,kt)}const vt=xe.length,jt=Ke.length;function ct(wt,gt,kt){let Ft,Dt,$t;const ai=wt.x-gt.x,Qi=wt.y-gt.y,qi=kt.x-wt.x,Pn=kt.y-wt.y,dr=ai*ai+Qi*Qi,er=ai*Pn-Qi*qi;if(Math.abs(er)>Number.EPSILON){const Ue=Math.sqrt(dr),Ce=Math.sqrt(qi*qi+Pn*Pn),ut=gt.x-Qi/Ue,Ct=gt.y+ai/Ue,It=kt.x-Pn/Ce,Mt=kt.y+qi/Ce,Ci=((It-ut)*Pn-(Mt-Ct)*qi)/(ai*Pn-Qi*qi);Ft=ut+ai*Ci-wt.x,Dt=Ct+Qi*Ci-wt.y;const Wt=Ft*Ft+Dt*Dt;if(Wt<=2)return new xt(Ft,Dt);$t=Math.sqrt(Wt/2)}else{let Ue=!1;ai>Number.EPSILON?qi>Number.EPSILON&&(Ue=!0):ai<-Number.EPSILON?qi<-Number.EPSILON&&(Ue=!0):Math.sign(Qi)===Math.sign(Pn)&&(Ue=!0),Ue?(Ft=-Qi,Dt=ai,$t=Math.sqrt(dr)):(Ft=ai,Dt=Qi,$t=Math.sqrt(dr/2))}return new xt(Ft/$t,Dt/$t)}const Ut=[];for(let wt=0,gt=$e.length,kt=gt-1,Ft=wt+1;wt<gt;wt++,kt++,Ft++)kt===gt&&(kt=0),Ft===gt&&(Ft=0),Ut[wt]=ct($e[wt],$e[kt],$e[Ft]);const Qt=[];let fi,an=Ut.concat();for(let wt=0,gt=ze.length;wt<gt;wt++){const kt=ze[wt];fi=[];for(let Ft=0,Dt=kt.length,$t=Dt-1,ai=Ft+1;Ft<Dt;Ft++,$t++,ai++)$t===Dt&&($t=0),ai===Dt&&(ai=0),fi[Ft]=ct(kt[Ft],kt[$t],kt[ai]);Qt.push(fi),an=an.concat(fi)}for(let wt=0;wt<X;wt++){const gt=wt/X,kt=z*Math.cos(gt*Math.PI/2),Ft=K*Math.sin(gt*Math.PI/2)+ee;for(let Dt=0,$t=$e.length;Dt<$t;Dt++){const ai=at($e[Dt],Ut[Dt],Ft);vi(ai.x,ai.y,-kt)}for(let Dt=0,$t=ze.length;Dt<$t;Dt++){const ai=ze[Dt];fi=Qt[Dt];for(let Qi=0,qi=ai.length;Qi<qi;Qi++){const Pn=at(ai[Qi],fi[Qi],Ft);vi(Pn.x,Pn.y,-kt)}}}const Nn=K+ee;for(let wt=0;wt<vt;wt++){const gt=G?at(xe[wt],an[wt],Nn):xe[wt];he?(Oe.copy(Qe.normals[0]).multiplyScalar(gt.x),Be.copy(Qe.binormals[0]).multiplyScalar(gt.y),Ve.copy(Ae[0]).add(Oe).add(Be),vi(Ve.x,Ve.y,Ve.z)):vi(gt.x,gt.y,0)}for(let wt=1;wt<=O;wt++)for(let gt=0;gt<vt;gt++){const kt=G?at(xe[gt],an[gt],Nn):xe[gt];he?(Oe.copy(Qe.normals[wt]).multiplyScalar(kt.x),Be.copy(Qe.binormals[wt]).multiplyScalar(kt.y),Ve.copy(Ae[wt]).add(Oe).add(Be),vi(Ve.x,Ve.y,Ve.z)):vi(kt.x,kt.y,k/O*wt)}for(let wt=X-1;wt>=0;wt--){const gt=wt/X,kt=z*Math.cos(gt*Math.PI/2),Ft=K*Math.sin(gt*Math.PI/2)+ee;for(let Dt=0,$t=$e.length;Dt<$t;Dt++){const ai=at($e[Dt],Ut[Dt],Ft);vi(ai.x,ai.y,k+kt)}for(let Dt=0,$t=ze.length;Dt<$t;Dt++){const ai=ze[Dt];fi=Qt[Dt];for(let Qi=0,qi=ai.length;Qi<qi;Qi++){const Pn=at(ai[Qi],fi[Qi],Ft);he?vi(Pn.x,Pn.y+Ae[O-1].y,Ae[O-1].x+kt):vi(Pn.x,Pn.y,k+kt)}}}$n(),Dn();function $n(){const wt=s.length/3;if(G){let gt=0,kt=vt*gt;for(let Ft=0;Ft<jt;Ft++){const Dt=Ke[Ft];bt(Dt[2]+kt,Dt[1]+kt,Dt[0]+kt)}gt=O+X*2,kt=vt*gt;for(let Ft=0;Ft<jt;Ft++){const Dt=Ke[Ft];bt(Dt[0]+kt,Dt[1]+kt,Dt[2]+kt)}}else{for(let gt=0;gt<jt;gt++){const kt=Ke[gt];bt(kt[2],kt[1],kt[0])}for(let gt=0;gt<jt;gt++){const kt=Ke[gt];bt(kt[0]+vt*O,kt[1]+vt*O,kt[2]+vt*O)}}n.addGroup(wt,s.length/3-wt,0)}function Dn(){const wt=s.length/3;let gt=0;Wn($e,gt),gt+=$e.length;for(let kt=0,Ft=ze.length;kt<Ft;kt++){const Dt=ze[kt];Wn(Dt,gt),gt+=Dt.length}n.addGroup(wt,s.length/3-wt,1)}function Wn(wt,gt){let kt=wt.length;for(;--kt>=0;){const Ft=kt;let Dt=kt-1;Dt<0&&(Dt=wt.length-1);for(let $t=0,ai=O+X*2;$t<ai;$t++){const Qi=vt*$t,qi=vt*($t+1),Pn=gt+Ft+Qi,dr=gt+Dt+Qi,er=gt+Dt+qi,Ue=gt+Ft+qi;Kt(Pn,dr,er,Ue)}}}function vi(wt,gt,kt){I.push(wt),I.push(gt),I.push(kt)}function bt(wt,gt,kt){Zt(wt),Zt(gt),Zt(kt);const Ft=s.length/3,Dt=ge.generateTopUV(n,s,Ft-3,Ft-2,Ft-1);et(Dt[0]),et(Dt[1]),et(Dt[2])}function Kt(wt,gt,kt,Ft){Zt(wt),Zt(gt),Zt(Ft),Zt(gt),Zt(kt),Zt(Ft);const Dt=s.length/3,$t=ge.generateSideWallUV(n,s,Dt-6,Dt-3,Dt-2,Dt-1);et($t[0]),et($t[1]),et($t[3]),et($t[1]),et($t[2]),et($t[3])}function Zt(wt){s.push(I[wt*3+0]),s.push(I[wt*3+1]),s.push(I[wt*3+2])}function et(wt){a.push(wt.x),a.push(wt.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,n=this.parameters.options;return wb(i,n,e)}static fromJSON(e,i){const n=[];for(let a=0,d=e.shapes.length;a<d;a++){const v=i[e.shapes[a]];n.push(v)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new mu[s.type]().fromJSON(s)),new Su(n,e.options)}}const bb={generateTopUV:function(l,e,i,n,s){const a=e[i*3],d=e[i*3+1],v=e[n*3],I=e[n*3+1],R=e[s*3],O=e[s*3+1];return[new xt(a,d),new xt(v,I),new xt(R,O)]},generateSideWallUV:function(l,e,i,n,s,a){const d=e[i*3],v=e[i*3+1],I=e[i*3+2],R=e[n*3],O=e[n*3+1],k=e[n*3+2],G=e[s*3],z=e[s*3+1],K=e[s*3+2],ee=e[a*3],X=e[a*3+1],Q=e[a*3+2];return Math.abs(v-O)<Math.abs(d-R)?[new xt(d,1-I),new xt(R,1-k),new xt(G,1-K),new xt(ee,1-Q)]:[new xt(v,1-I),new xt(O,1-k),new xt(z,1-K),new xt(X,1-Q)]}};function wb(l,e,i){if(i.shapes=[],Array.isArray(l))for(let n=0,s=l.length;n<s;n++){const a=l[n];i.shapes.push(a.uuid)}else i.shapes.push(l.uuid);return i.options=Object.assign({},e),e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class Tu extends ta{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,a,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Tu(e.radius,e.detail)}}class Fc extends ta{constructor(e=1,i=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Fc(e.radius,e.detail)}}class Iu extends on{constructor(e=.5,i=1,n=32,s=1,a=0,d=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:n,phiSegments:s,thetaStart:a,thetaLength:d},n=Math.max(3,n),s=Math.max(1,s);const v=[],I=[],R=[],O=[];let k=e;const G=(i-e)/s,z=new Ie,K=new xt;for(let ee=0;ee<=s;ee++){for(let X=0;X<=n;X++){const Q=a+X/n*d;z.x=k*Math.cos(Q),z.y=k*Math.sin(Q),I.push(z.x,z.y,z.z),R.push(0,0,1),K.x=(z.x/i+1)/2,K.y=(z.y/i+1)/2,O.push(K.x,K.y)}k+=G}for(let ee=0;ee<s;ee++){const X=ee*(n+1);for(let Q=0;Q<n;Q++){const ge=Q+X,Ae=ge,he=ge+n+1,Qe=ge+n+2,Be=ge+1;v.push(Ae,he,Be),v.push(he,Qe,Be)}}this.setIndex(v),this.setAttribute("position",new xi(I,3)),this.setAttribute("normal",new xi(R,3)),this.setAttribute("uv",new xi(O,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Iu(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Bu extends on{constructor(e=new Oa([new xt(0,.5),new xt(-.5,-.5),new xt(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const n=[],s=[],a=[],d=[];let v=0,I=0;if(Array.isArray(e)===!1)R(e);else for(let O=0;O<e.length;O++)R(e[O]),this.addGroup(v,I,O),v+=I,I=0;this.setIndex(n),this.setAttribute("position",new xi(s,3)),this.setAttribute("normal",new xi(a,3)),this.setAttribute("uv",new xi(d,2));function R(O){const k=s.length/3,G=O.extractPoints(i);let z=G.shape;const K=G.holes;po.isClockWise(z)===!1&&(z=z.reverse());for(let X=0,Q=K.length;X<Q;X++){const ge=K[X];po.isClockWise(ge)===!0&&(K[X]=ge.reverse())}const ee=po.triangulateShape(z,K);for(let X=0,Q=K.length;X<Q;X++){const ge=K[X];z=z.concat(ge)}for(let X=0,Q=z.length;X<Q;X++){const ge=z[X];s.push(ge.x,ge.y,0),a.push(0,0,1),d.push(ge.x,ge.y)}for(let X=0,Q=ee.length;X<Q;X++){const ge=ee[X],Ae=ge[0]+k,he=ge[1]+k,Qe=ge[2]+k;n.push(Ae,he,Qe),I+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return Mb(i,e)}static fromJSON(e,i){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const d=i[e.shapes[s]];n.push(d)}return new Bu(n,e.curveSegments)}}function Mb(l,e){if(e.shapes=[],Array.isArray(l))for(let i=0,n=l.length;i<n;i++){const s=l[i];e.shapes.push(s.uuid)}else e.shapes.push(l.uuid);return e}class Nc extends on{constructor(e=1,i=32,n=16,s=0,a=Math.PI*2,d=0,v=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:n,phiStart:s,phiLength:a,thetaStart:d,thetaLength:v},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const I=Math.min(d+v,Math.PI);let R=0;const O=[],k=new Ie,G=new Ie,z=[],K=[],ee=[],X=[];for(let Q=0;Q<=n;Q++){const ge=[],Ae=Q/n;let he=0;Q===0&&d===0?he=.5/i:Q===n&&I===Math.PI&&(he=-.5/i);for(let Qe=0;Qe<=i;Qe++){const Be=Qe/i;k.x=-e*Math.cos(s+Be*a)*Math.sin(d+Ae*v),k.y=e*Math.cos(d+Ae*v),k.z=e*Math.sin(s+Be*a)*Math.sin(d+Ae*v),K.push(k.x,k.y,k.z),G.copy(k).normalize(),ee.push(G.x,G.y,G.z),X.push(Be+he,1-Ae),ge.push(R++)}O.push(ge)}for(let Q=0;Q<n;Q++)for(let ge=0;ge<i;ge++){const Ae=O[Q][ge+1],he=O[Q][ge],Qe=O[Q+1][ge],Be=O[Q+1][ge+1];(Q!==0||d>0)&&z.push(Ae,he,Be),(Q!==n-1||I<Math.PI)&&z.push(he,Qe,Be)}this.setIndex(z),this.setAttribute("position",new xi(K,3)),this.setAttribute("normal",new xi(ee,3)),this.setAttribute("uv",new xi(X,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Ru extends ta{constructor(e=1,i=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Ru(e.radius,e.detail)}}class Lu extends on{constructor(e=1,i=.4,n=12,s=48,a=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:n,tubularSegments:s,arc:a},n=Math.floor(n),s=Math.floor(s);const d=[],v=[],I=[],R=[],O=new Ie,k=new Ie,G=new Ie;for(let z=0;z<=n;z++)for(let K=0;K<=s;K++){const ee=K/s*a,X=z/n*Math.PI*2;k.x=(e+i*Math.cos(X))*Math.cos(ee),k.y=(e+i*Math.cos(X))*Math.sin(ee),k.z=i*Math.sin(X),v.push(k.x,k.y,k.z),O.x=e*Math.cos(ee),O.y=e*Math.sin(ee),G.subVectors(k,O).normalize(),I.push(G.x,G.y,G.z),R.push(K/s),R.push(z/n)}for(let z=1;z<=n;z++)for(let K=1;K<=s;K++){const ee=(s+1)*z+K-1,X=(s+1)*(z-1)+K-1,Q=(s+1)*(z-1)+K,ge=(s+1)*z+K;d.push(ee,X,ge),d.push(X,Q,ge)}this.setIndex(d),this.setAttribute("position",new xi(v,3)),this.setAttribute("normal",new xi(I,3)),this.setAttribute("uv",new xi(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lu(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Du extends on{constructor(e=1,i=.4,n=64,s=8,a=2,d=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:n,radialSegments:s,p:a,q:d},n=Math.floor(n),s=Math.floor(s);const v=[],I=[],R=[],O=[],k=new Ie,G=new Ie,z=new Ie,K=new Ie,ee=new Ie,X=new Ie,Q=new Ie;for(let Ae=0;Ae<=n;++Ae){const he=Ae/n*a*Math.PI*2;ge(he,a,d,e,z),ge(he+.01,a,d,e,K),X.subVectors(K,z),Q.addVectors(K,z),ee.crossVectors(X,Q),Q.crossVectors(ee,X),ee.normalize(),Q.normalize();for(let Qe=0;Qe<=s;++Qe){const Be=Qe/s*Math.PI*2,Oe=-i*Math.cos(Be),Ve=i*Math.sin(Be);k.x=z.x+(Oe*Q.x+Ve*ee.x),k.y=z.y+(Oe*Q.y+Ve*ee.y),k.z=z.z+(Oe*Q.z+Ve*ee.z),I.push(k.x,k.y,k.z),G.subVectors(k,z).normalize(),R.push(G.x,G.y,G.z),O.push(Ae/n),O.push(Qe/s)}}for(let Ae=1;Ae<=n;Ae++)for(let he=1;he<=s;he++){const Qe=(s+1)*(Ae-1)+(he-1),Be=(s+1)*Ae+(he-1),Oe=(s+1)*Ae+he,Ve=(s+1)*(Ae-1)+he;v.push(Qe,Be,Ve),v.push(Be,Oe,Ve)}this.setIndex(v),this.setAttribute("position",new xi(I,3)),this.setAttribute("normal",new xi(R,3)),this.setAttribute("uv",new xi(O,2));function ge(Ae,he,Qe,Be,Oe){const Ve=Math.cos(Ae),_e=Math.sin(Ae),xe=Qe/he*Ae,ze=Math.cos(xe);Oe.x=Be*(2+ze)*.5*Ve,Oe.y=Be*(2+ze)*_e*.5,Oe.z=Be*Math.sin(xe)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Du(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Pu extends on{constructor(e=new hp(new Ie(-1,-1,0),new Ie(-1,1,0),new Ie(1,1,0)),i=64,n=1,s=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:n,radialSegments:s,closed:a};const d=e.computeFrenetFrames(i,a);this.tangents=d.tangents,this.normals=d.normals,this.binormals=d.binormals;const v=new Ie,I=new Ie,R=new xt;let O=new Ie;const k=[],G=[],z=[],K=[];ee(),this.setIndex(K),this.setAttribute("position",new xi(k,3)),this.setAttribute("normal",new xi(G,3)),this.setAttribute("uv",new xi(z,2));function ee(){for(let Ae=0;Ae<i;Ae++)X(Ae);X(a===!1?i:0),ge(),Q()}function X(Ae){O=e.getPointAt(Ae/i,O);const he=d.normals[Ae],Qe=d.binormals[Ae];for(let Be=0;Be<=s;Be++){const Oe=Be/s*Math.PI*2,Ve=Math.sin(Oe),_e=-Math.cos(Oe);I.x=_e*he.x+Ve*Qe.x,I.y=_e*he.y+Ve*Qe.y,I.z=_e*he.z+Ve*Qe.z,I.normalize(),G.push(I.x,I.y,I.z),v.x=O.x+n*I.x,v.y=O.y+n*I.y,v.z=O.z+n*I.z,k.push(v.x,v.y,v.z)}}function Q(){for(let Ae=1;Ae<=i;Ae++)for(let he=1;he<=s;he++){const Qe=(s+1)*(Ae-1)+(he-1),Be=(s+1)*Ae+(he-1),Oe=(s+1)*Ae+he,Ve=(s+1)*(Ae-1)+he;K.push(Qe,Be,Ve),K.push(Be,Oe,Ve)}}function ge(){for(let Ae=0;Ae<=i;Ae++)for(let he=0;he<=s;he++)R.x=Ae/i,R.y=he/s,z.push(R.x,R.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Pu(new mu[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Mg extends on{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],n=new Set,s=new Ie,a=new Ie;if(e.index!==null){const d=e.attributes.position,v=e.index;let I=e.groups;I.length===0&&(I=[{start:0,count:v.count,materialIndex:0}]);for(let R=0,O=I.length;R<O;++R){const k=I[R],G=k.start,z=k.count;for(let K=G,ee=G+z;K<ee;K+=3)for(let X=0;X<3;X++){const Q=v.getX(K+X),ge=v.getX(K+(X+1)%3);s.fromBufferAttribute(d,Q),a.fromBufferAttribute(d,ge),_g(s,a,n)===!0&&(i.push(s.x,s.y,s.z),i.push(a.x,a.y,a.z))}}}else{const d=e.attributes.position;for(let v=0,I=d.count/3;v<I;v++)for(let R=0;R<3;R++){const O=3*v+R,k=3*v+(R+1)%3;s.fromBufferAttribute(d,O),a.fromBufferAttribute(d,k),_g(s,a,n)===!0&&(i.push(s.x,s.y,s.z),i.push(a.x,a.y,a.z))}}this.setAttribute("position",new xi(i,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function _g(l,e,i){const n=`${l.x},${l.y},${l.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${l.x},${l.y},${l.z}`;return i.has(n)===!0||i.has(s)===!0?!1:(i.add(n),i.add(s),!0)}var Sg=Object.freeze({__proto__:null,BoxGeometry:_a,CapsuleGeometry:gu,CircleGeometry:vu,ConeGeometry:yu,CylinderGeometry:Ll,DodecahedronGeometry:Eu,EdgesGeometry:vg,ExtrudeGeometry:Su,IcosahedronGeometry:Tu,LatheGeometry:Lc,OctahedronGeometry:Fc,PlaneGeometry:xl,PolyhedronGeometry:ta,RingGeometry:Iu,ShapeGeometry:Bu,SphereGeometry:Nc,TetrahedronGeometry:Ru,TorusGeometry:Lu,TorusKnotGeometry:Du,TubeGeometry:Pu,WireframeGeometry:Mg});class Tg extends $r{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new li(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Ig extends Xs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ap extends $r{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new li(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new li(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Is,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bg extends Ap{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new xt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return or(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new li(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new li(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new li(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Rg extends $r{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new li(16777215),this.specular=new li(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new li(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Is,this.combine=bn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Lg extends $r{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new li(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new li(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Dg extends $r{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Pg extends $r{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new li(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new li(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Is,this.combine=bn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Og extends $r{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new li(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Fg extends ds{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Na(l,e,i){return!l||!i&&l.constructor===e?l:typeof e.BYTES_PER_ELEMENT=="number"?new e(l):Array.prototype.slice.call(l)}function Ng(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)}function kg(l){function e(s,a){return l[s]-l[a]}const i=l.length,n=new Array(i);for(let s=0;s!==i;++s)n[s]=s;return n.sort(e),n}function mp(l,e,i){const n=l.length,s=new l.constructor(n);for(let a=0,d=0;d!==n;++a){const v=i[a]*e;for(let I=0;I!==e;++I)s[d++]=l[v+I]}return s}function gp(l,e,i,n){let s=1,a=l[0];for(;a!==void 0&&a[n]===void 0;)a=l[s++];if(a===void 0)return;let d=a[n];if(d!==void 0)if(Array.isArray(d))do d=a[n],d!==void 0&&(e.push(a.time),i.push.apply(i,d)),a=l[s++];while(a!==void 0);else if(d.toArray!==void 0)do d=a[n],d!==void 0&&(e.push(a.time),d.toArray(i,i.length)),a=l[s++];while(a!==void 0);else do d=a[n],d!==void 0&&(e.push(a.time),i.push(d)),a=l[s++];while(a!==void 0)}function _b(l,e,i,n,s=30){const a=l.clone();a.name=e;const d=[];for(let I=0;I<a.tracks.length;++I){const R=a.tracks[I],O=R.getValueSize(),k=[],G=[];for(let z=0;z<R.times.length;++z){const K=R.times[z]*s;if(!(K<i||K>=n)){k.push(R.times[z]);for(let ee=0;ee<O;++ee)G.push(R.values[z*O+ee])}}k.length!==0&&(R.times=Na(k,R.times.constructor),R.values=Na(G,R.values.constructor),d.push(R))}a.tracks=d;let v=1/0;for(let I=0;I<a.tracks.length;++I)v>a.tracks[I].times[0]&&(v=a.tracks[I].times[0]);for(let I=0;I<a.tracks.length;++I)a.tracks[I].shift(-1*v);return a.resetDuration(),a}function Sb(l,e=0,i=l,n=30){n<=0&&(n=30);const s=i.tracks.length,a=e/n;for(let d=0;d<s;++d){const v=i.tracks[d],I=v.ValueTypeName;if(I==="bool"||I==="string")continue;const R=l.tracks.find(function(Q){return Q.name===v.name&&Q.ValueTypeName===I});if(R===void 0)continue;let O=0;const k=v.getValueSize();v.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(O=k/3);let G=0;const z=R.getValueSize();R.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(G=z/3);const K=v.times.length-1;let ee;if(a<=v.times[0]){const Q=O,ge=k-O;ee=v.values.slice(Q,ge)}else if(a>=v.times[K]){const Q=K*k+O,ge=Q+k-O;ee=v.values.slice(Q,ge)}else{const Q=v.createInterpolant(),ge=O,Ae=k-O;Q.evaluate(a),ee=Q.resultBuffer.slice(ge,Ae)}I==="quaternion"&&new Rn().fromArray(ee).normalize().conjugate().toArray(ee);const X=R.times.length;for(let Q=0;Q<X;++Q){const ge=Q*z+G;if(I==="quaternion")Rn.multiplyQuaternionsFlat(R.values,ge,ee,0,R.values,ge);else{const Ae=z-G*2;for(let he=0;he<Ae;++he)R.values[ge+he]-=ee[he]}}}return l.blendMode=os,l}const Tb={convertArray:Na,isTypedArray:Ng,getKeyframeOrder:kg,sortedArray:mp,flattenJSON:gp,subclip:_b,makeClipAdditive:Sb};class kc{constructor(e,i,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new i.constructor(n),this.sampleValues=i,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let n=this._cachedIndex,s=i[n],a=i[n-1];i:{e:{let d;t:{n:if(!(e<s)){for(let v=n+2;;){if(s===void 0){if(e<a)break n;return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===v)break;if(a=s,s=i[++n],e<s)break e}d=i.length;break t}if(!(e>=a)){const v=i[1];e<v&&(n=2,a=v);for(let I=n-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===I)break;if(s=a,a=i[--n-1],e>=a)break e}d=n,n=0;break t}break i}for(;n<d;){const v=n+d>>>1;e<i[v]?d=v:n=v+1}if(s=i[n],a=i[n-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,s)}return this.interpolate_(n,a,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,n=this.sampleValues,s=this.valueSize,a=e*s;for(let d=0;d!==s;++d)i[d]=n[a+d];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Ug extends kc{constructor(e,i,n,s){super(e,i,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ji,endingEnd:Ji}}intervalChanged_(e,i,n){const s=this.parameterPositions;let a=e-2,d=e+1,v=s[a],I=s[d];if(v===void 0)switch(this.getSettings_().endingStart){case Bi:a=e,v=2*i-n;break;case Hn:a=s.length-2,v=i+s[a]-s[a+1];break;default:a=e,v=n}if(I===void 0)switch(this.getSettings_().endingEnd){case Bi:d=e,I=2*n-i;break;case Hn:d=1,I=n+s[1]-s[0];break;default:d=e-1,I=i}const R=(n-i)*.5,O=this.valueSize;this._weightPrev=R/(i-v),this._weightNext=R/(I-n),this._offsetPrev=a*O,this._offsetNext=d*O}interpolate_(e,i,n,s){const a=this.resultBuffer,d=this.sampleValues,v=this.valueSize,I=e*v,R=I-v,O=this._offsetPrev,k=this._offsetNext,G=this._weightPrev,z=this._weightNext,K=(n-i)/(s-i),ee=K*K,X=ee*K,Q=-G*X+2*G*ee-G*K,ge=(1+G)*X+(-1.5-2*G)*ee+(-.5+G)*K+1,Ae=(-1-z)*X+(1.5+z)*ee+.5*K,he=z*X-z*ee;for(let Qe=0;Qe!==v;++Qe)a[Qe]=Q*d[O+Qe]+ge*d[R+Qe]+Ae*d[I+Qe]+he*d[k+Qe];return a}}class vp extends kc{constructor(e,i,n,s){super(e,i,n,s)}interpolate_(e,i,n,s){const a=this.resultBuffer,d=this.sampleValues,v=this.valueSize,I=e*v,R=I-v,O=(n-i)/(s-i),k=1-O;for(let G=0;G!==v;++G)a[G]=d[R+G]*k+d[I+G]*O;return a}}class Gg extends kc{constructor(e,i,n,s){super(e,i,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Js{constructor(e,i,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Na(i,this.TimeBufferType),this.values=Na(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let n;if(i.toJSON!==this.toJSON)n=i.toJSON(e);else{n={name:e.name,times:Na(e.times,Array),values:Na(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Gg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new vp(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ug(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case Ti:i=this.InterpolantFactoryMethodDiscrete;break;case Pi:i=this.InterpolantFactoryMethodLinear;break;case Hi:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ti;case this.InterpolantFactoryMethodLinear:return Pi;case this.InterpolantFactoryMethodSmooth:return Hi}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let n=0,s=i.length;n!==s;++n)i[n]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let n=0,s=i.length;n!==s;++n)i[n]*=e}return this}trim(e,i){const n=this.times,s=n.length;let a=0,d=s-1;for(;a!==s&&n[a]<e;)++a;for(;d!==-1&&n[d]>i;)--d;if(++d,a!==0||d!==s){a>=d&&(d=Math.max(d,1),a=d-1);const v=this.getValueSize();this.times=n.slice(a,d),this.values=this.values.slice(a*v,d*v)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,a=n.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let v=0;v!==a;v++){const I=n[v];if(typeof I=="number"&&isNaN(I)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,v,I),e=!1;break}if(d!==null&&d>I){console.error("THREE.KeyframeTrack: Out of order keys.",this,v,I,d),e=!1;break}d=I}if(s!==void 0&&Ng(s))for(let v=0,I=s.length;v!==I;++v){const R=s[v];if(isNaN(R)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,v,R),e=!1;break}}return e}optimize(){const e=this.times.slice(),i=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===Hi,a=e.length-1;let d=1;for(let v=1;v<a;++v){let I=!1;const R=e[v],O=e[v+1];if(R!==O&&(v!==1||R!==e[0]))if(s)I=!0;else{const k=v*n,G=k-n,z=k+n;for(let K=0;K!==n;++K){const ee=i[k+K];if(ee!==i[G+K]||ee!==i[z+K]){I=!0;break}}}if(I){if(v!==d){e[d]=e[v];const k=v*n,G=d*n;for(let z=0;z!==n;++z)i[G+z]=i[k+z]}++d}}if(a>0){e[d]=e[a];for(let v=a*n,I=d*n,R=0;R!==n;++R)i[I+R]=i[v+R];++d}return d!==e.length?(this.times=e.slice(0,d),this.values=i.slice(0,d*n)):(this.times=e,this.values=i),this}clone(){const e=this.times.slice(),i=this.values.slice(),n=this.constructor,s=new n(this.name,e,i);return s.createInterpolant=this.createInterpolant,s}}Js.prototype.TimeBufferType=Float32Array,Js.prototype.ValueBufferType=Float32Array,Js.prototype.DefaultInterpolation=Pi;class ka extends Js{}ka.prototype.ValueTypeName="bool",ka.prototype.ValueBufferType=Array,ka.prototype.DefaultInterpolation=Ti,ka.prototype.InterpolantFactoryMethodLinear=void 0,ka.prototype.InterpolantFactoryMethodSmooth=void 0;class yp extends Js{}yp.prototype.ValueTypeName="color";class Uc extends Js{}Uc.prototype.ValueTypeName="number";class Vg extends kc{constructor(e,i,n,s){super(e,i,n,s)}interpolate_(e,i,n,s){const a=this.resultBuffer,d=this.sampleValues,v=this.valueSize,I=(n-i)/(s-i);let R=e*v;for(let O=R+v;R!==O;R+=4)Rn.slerpFlat(a,0,d,R-v,d,R,I);return a}}class Pl extends Js{InterpolantFactoryMethodLinear(e){return new Vg(this.times,this.values,this.getValueSize(),e)}}Pl.prototype.ValueTypeName="quaternion",Pl.prototype.DefaultInterpolation=Pi,Pl.prototype.InterpolantFactoryMethodSmooth=void 0;class Ua extends Js{}Ua.prototype.ValueTypeName="string",Ua.prototype.ValueBufferType=Array,Ua.prototype.DefaultInterpolation=Ti,Ua.prototype.InterpolantFactoryMethodLinear=void 0,Ua.prototype.InterpolantFactoryMethodSmooth=void 0;class Gc extends Js{}Gc.prototype.ValueTypeName="vector";class Vc{constructor(e="",i=-1,n=[],s=Di){this.name=e,this.tracks=n,this.duration=i,this.blendMode=s,this.uuid=ls(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],n=e.tracks,s=1/(e.fps||1);for(let d=0,v=n.length;d!==v;++d)i.push(Bb(n[d]).scale(s));const a=new this(e.name,e.duration,i,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const i=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,d=n.length;a!==d;++a)i.push(Js.toJSON(n[a]));return s}static CreateFromMorphTargetSequence(e,i,n,s){const a=i.length,d=[];for(let v=0;v<a;v++){let I=[],R=[];I.push((v+a-1)%a,v,(v+1)%a),R.push(0,1,0);const O=kg(I);I=mp(I,1,O),R=mp(R,1,O),!s&&I[0]===0&&(I.push(a),R.push(R[0])),d.push(new Uc(".morphTargetInfluences["+i[v].name+"]",I,R).scale(1/n))}return new this(e,-1,d)}static findByName(e,i){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===i)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,i,n){const s={},a=/^([\w-]*?)([\d]+)$/;for(let v=0,I=e.length;v<I;v++){const R=e[v],O=R.name.match(a);if(O&&O.length>1){const k=O[1];let G=s[k];G||(s[k]=G=[]),G.push(R)}}const d=[];for(const v in s)d.push(this.CreateFromMorphTargetSequence(v,s[v],i,n));return d}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(k,G,z,K,ee){if(z.length!==0){const X=[],Q=[];gp(z,X,Q,K),X.length!==0&&ee.push(new k(G,X,Q))}},s=[],a=e.name||"default",d=e.fps||30,v=e.blendMode;let I=e.length||-1;const R=e.hierarchy||[];for(let k=0;k<R.length;k++){const G=R[k].keys;if(!(!G||G.length===0))if(G[0].morphTargets){const z={};let K;for(K=0;K<G.length;K++)if(G[K].morphTargets)for(let ee=0;ee<G[K].morphTargets.length;ee++)z[G[K].morphTargets[ee]]=-1;for(const ee in z){const X=[],Q=[];for(let ge=0;ge!==G[K].morphTargets.length;++ge){const Ae=G[K];X.push(Ae.time),Q.push(Ae.morphTarget===ee?1:0)}s.push(new Uc(".morphTargetInfluence["+ee+"]",X,Q))}I=z.length*d}else{const z=".bones["+i[k].name+"]";n(Gc,z+".position",G,"pos",s),n(Pl,z+".quaternion",G,"rot",s),n(Gc,z+".scale",G,"scl",s)}}return s.length===0?null:new this(a,I,s,v)}resetDuration(){const e=this.tracks;let i=0;for(let n=0,s=e.length;n!==s;++n){const a=this.tracks[n];i=Math.max(i,a.times[a.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ib(l){switch(l.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Uc;case"vector":case"vector2":case"vector3":case"vector4":return Gc;case"color":return yp;case"quaternion":return Pl;case"bool":case"boolean":return ka;case"string":return Ua}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+l)}function Bb(l){if(l.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Ib(l.type);if(l.times===void 0){const i=[],n=[];gp(l.keys,i,n,"value"),l.times=i,l.values=n}return e.parse!==void 0?e.parse(l):new e(l.name,l.times,l.values,l.interpolation)}const To={enabled:!1,files:{},add:function(l,e){this.enabled!==!1&&(this.files[l]=e)},get:function(l){if(this.enabled!==!1)return this.files[l]},remove:function(l){delete this.files[l]},clear:function(){this.files={}}};class Ep{constructor(e,i,n){const s=this;let a=!1,d=0,v=0,I;const R=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=n,this.itemStart=function(O){v++,a===!1&&s.onStart!==void 0&&s.onStart(O,d,v),a=!0},this.itemEnd=function(O){d++,s.onProgress!==void 0&&s.onProgress(O,d,v),d===v&&(a=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(O){s.onError!==void 0&&s.onError(O)},this.resolveURL=function(O){return I?I(O):O},this.setURLModifier=function(O){return I=O,this},this.addHandler=function(O,k){return R.push(O,k),this},this.removeHandler=function(O){const k=R.indexOf(O);return k!==-1&&R.splice(k,2),this},this.getHandler=function(O){for(let k=0,G=R.length;k<G;k+=2){const z=R[k],K=R[k+1];if(z.global&&(z.lastIndex=0),z.test(O))return K}return null}}}const zg=new Ep;class bs{constructor(e){this.manager=e!==void 0?e:zg,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const n=this;return new Promise(function(s,a){n.load(e,s,i,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}bs.DEFAULT_MATERIAL_NAME="__DEFAULT";const Io={};class Rb extends Error{constructor(e,i){super(e),this.response=i}}class Bo extends bs{constructor(e){super(e)}load(e,i,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=To.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(a),this.manager.itemEnd(e)},0),a;if(Io[e]!==void 0){Io[e].push({onLoad:i,onProgress:n,onError:s});return}Io[e]=[],Io[e].push({onLoad:i,onProgress:n,onError:s});const d=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),v=this.mimeType,I=this.responseType;fetch(d).then(R=>{if(R.status===200||R.status===0){if(R.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||R.body===void 0||R.body.getReader===void 0)return R;const O=Io[e],k=R.body.getReader(),G=R.headers.get("X-File-Size")||R.headers.get("Content-Length"),z=G?parseInt(G):0,K=z!==0;let ee=0;const X=new ReadableStream({start(Q){ge();function ge(){k.read().then(({done:Ae,value:he})=>{if(Ae)Q.close();else{ee+=he.byteLength;const Qe=new ProgressEvent("progress",{lengthComputable:K,loaded:ee,total:z});for(let Be=0,Oe=O.length;Be<Oe;Be++){const Ve=O[Be];Ve.onProgress&&Ve.onProgress(Qe)}Q.enqueue(he),ge()}})}}});return new Response(X)}else throw new Rb(`fetch for "${R.url}" responded with ${R.status}: ${R.statusText}`,R)}).then(R=>{switch(I){case"arraybuffer":return R.arrayBuffer();case"blob":return R.blob();case"document":return R.text().then(O=>new DOMParser().parseFromString(O,v));case"json":return R.json();default:if(v===void 0)return R.text();{const k=/charset="?([^;"\s]*)"?/i.exec(v),G=k&&k[1]?k[1].toLowerCase():void 0,z=new TextDecoder(G);return R.arrayBuffer().then(K=>z.decode(K))}}}).then(R=>{To.add(e,R);const O=Io[e];delete Io[e];for(let k=0,G=O.length;k<G;k++){const z=O[k];z.onLoad&&z.onLoad(R)}}).catch(R=>{const O=Io[e];if(O===void 0)throw this.manager.itemError(e),R;delete Io[e];for(let k=0,G=O.length;k<G;k++){const z=O[k];z.onError&&z.onError(R)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Lb extends bs{constructor(e){super(e)}load(e,i,n,s){const a=this,d=new Bo(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(v){try{i(a.parse(JSON.parse(v)))}catch(I){s?s(I):console.error(I),a.manager.itemError(e)}},n,s)}parse(e){const i=[];for(let n=0;n<e.length;n++){const s=Vc.parse(e[n]);i.push(s)}return i}}class Db extends bs{constructor(e){super(e)}load(e,i,n,s){const a=this,d=[],v=new fu,I=new Bo(this.manager);I.setPath(this.path),I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setWithCredentials(a.withCredentials);let R=0;function O(k){I.load(e[k],function(G){const z=a.parse(G,!0);d[k]={width:z.width,height:z.height,format:z.format,mipmaps:z.mipmaps},R+=1,R===6&&(z.mipmapCount===1&&(v.minFilter=wi),v.image=d,v.format=z.format,v.needsUpdate=!0,i&&i(v))},n,s)}if(Array.isArray(e))for(let k=0,G=e.length;k<G;++k)O(k);else I.load(e,function(k){const G=a.parse(k,!0);if(G.isCubemap){const z=G.mipmaps.length/G.mipmapCount;for(let K=0;K<z;K++){d[K]={mipmaps:[]};for(let ee=0;ee<G.mipmapCount;ee++)d[K].mipmaps.push(G.mipmaps[K*G.mipmapCount+ee]),d[K].format=G.format,d[K].width=G.width,d[K].height=G.height}v.image=d}else v.image.width=G.width,v.image.height=G.height,v.mipmaps=G.mipmaps;G.mipmapCount===1&&(v.minFilter=wi),v.format=G.format,v.needsUpdate=!0,i&&i(v)},n,s);return v}}class zc extends bs{constructor(e){super(e)}load(e,i,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,d=To.get(e);if(d!==void 0)return a.manager.itemStart(e),setTimeout(function(){i&&i(d),a.manager.itemEnd(e)},0),d;const v=wa("img");function I(){O(),To.add(e,this),i&&i(this),a.manager.itemEnd(e)}function R(k){O(),s&&s(k),a.manager.itemError(e),a.manager.itemEnd(e)}function O(){v.removeEventListener("load",I,!1),v.removeEventListener("error",R,!1)}return v.addEventListener("load",I,!1),v.addEventListener("error",R,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(v.crossOrigin=this.crossOrigin),a.manager.itemStart(e),v.src=e,v}}class Pb extends bs{constructor(e){super(e)}load(e,i,n,s){const a=new yc;a.colorSpace=yn;const d=new zc(this.manager);d.setCrossOrigin(this.crossOrigin),d.setPath(this.path);let v=0;function I(R){d.load(e[R],function(O){a.images[R]=O,v++,v===6&&(a.needsUpdate=!0,i&&i(a))},void 0,s)}for(let R=0;R<e.length;++R)I(R);return a}}class Ob extends bs{constructor(e){super(e)}load(e,i,n,s){const a=this,d=new Zo,v=new Bo(this.manager);return v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setPath(this.path),v.setWithCredentials(a.withCredentials),v.load(e,function(I){let R;try{R=a.parse(I)}catch(O){if(s!==void 0)s(O);else{console.error(O);return}}R.image!==void 0?d.image=R.image:R.data!==void 0&&(d.image.width=R.width,d.image.height=R.height,d.image.data=R.data),d.wrapS=R.wrapS!==void 0?R.wrapS:We,d.wrapT=R.wrapT!==void 0?R.wrapT:We,d.magFilter=R.magFilter!==void 0?R.magFilter:wi,d.minFilter=R.minFilter!==void 0?R.minFilter:wi,d.anisotropy=R.anisotropy!==void 0?R.anisotropy:1,R.colorSpace!==void 0&&(d.colorSpace=R.colorSpace),R.flipY!==void 0&&(d.flipY=R.flipY),R.format!==void 0&&(d.format=R.format),R.type!==void 0&&(d.type=R.type),R.mipmaps!==void 0&&(d.mipmaps=R.mipmaps,d.minFilter=In),R.mipmapCount===1&&(d.minFilter=wi),R.generateMipmaps!==void 0&&(d.generateMipmaps=R.generateMipmaps),d.needsUpdate=!0,i&&i(d,R)},n,s),d}}class Fb extends bs{constructor(e){super(e)}load(e,i,n,s){const a=new qn,d=new zc(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(v){a.image=v,a.needsUpdate=!0,i!==void 0&&i(a)},n,s),a}}class ia extends Ln{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new li(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class Qg extends ia{constructor(e,i,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.groundColor=new li(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const xp=new mi,Hg=new Ie,jg=new Ie;class Cp{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new xt(512,512),this.map=null,this.mapPass=null,this.matrix=new mi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ec,this._frameExtents=new xt(1,1),this._viewportCount=1,this._viewports=[new _n(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,n=this.matrix;Hg.setFromMatrixPosition(e.matrixWorld),i.position.copy(Hg),jg.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(jg),i.updateMatrixWorld(),xp.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(xp),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(xp)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Nb extends Cp{constructor(){super(new Rr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,n=zo*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,a=e.distance||i.far;(n!==i.fov||s!==i.aspect||a!==i.far)&&(i.fov=n,i.aspect=s,i.far=a,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Wg extends ia{constructor(e,i,n=0,s=Math.PI/3,a=0,d=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.target=new Ln,this.distance=n,this.angle=s,this.penumbra=a,this.decay=d,this.map=null,this.shadow=new Nb}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Kg=new mi,Qc=new Ie,bp=new Ie;class kb extends Cp{constructor(){super(new Rr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new xt(4,2),this._viewportCount=6,this._viewports=[new _n(2,1,1,1),new _n(0,1,1,1),new _n(3,1,1,1),new _n(1,1,1,1),new _n(3,0,1,1),new _n(1,0,1,1)],this._cubeDirections=[new Ie(1,0,0),new Ie(-1,0,0),new Ie(0,0,1),new Ie(0,0,-1),new Ie(0,1,0),new Ie(0,-1,0)],this._cubeUps=[new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,0,1),new Ie(0,0,-1)]}updateMatrices(e,i=0){const n=this.camera,s=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),Qc.setFromMatrixPosition(e.matrixWorld),n.position.copy(Qc),bp.copy(n.position),bp.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(bp),n.updateMatrixWorld(),s.makeTranslation(-Qc.x,-Qc.y,-Qc.z),Kg.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Kg)}}class Xg extends ia{constructor(e,i,n=0,s=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new kb}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Ub extends Cp{constructor(){super(new jh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Yg extends ia{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.target=new Ln,this.shadow=new Ub}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class qg extends ia{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class Jg extends ia{constructor(e,i,n=10,s=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class Zg{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ie)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const n=e.x,s=e.y,a=e.z,d=this.coefficients;return i.copy(d[0]).multiplyScalar(.282095),i.addScaledVector(d[1],.488603*s),i.addScaledVector(d[2],.488603*a),i.addScaledVector(d[3],.488603*n),i.addScaledVector(d[4],1.092548*(n*s)),i.addScaledVector(d[5],1.092548*(s*a)),i.addScaledVector(d[6],.315392*(3*a*a-1)),i.addScaledVector(d[7],1.092548*(n*a)),i.addScaledVector(d[8],.546274*(n*n-s*s)),i}getIrradianceAt(e,i){const n=e.x,s=e.y,a=e.z,d=this.coefficients;return i.copy(d[0]).multiplyScalar(.886227),i.addScaledVector(d[1],1.023328*s),i.addScaledVector(d[2],1.023328*a),i.addScaledVector(d[3],1.023328*n),i.addScaledVector(d[4],.858086*n*s),i.addScaledVector(d[5],.858086*s*a),i.addScaledVector(d[6],.743125*a*a-.247708),i.addScaledVector(d[7],.858086*n*a),i.addScaledVector(d[8],.429043*(n*n-s*s)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,i+s*3);return this}toArray(e=[],i=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,i+s*3);return e}static getBasisAt(e,i){const n=e.x,s=e.y,a=e.z;i[0]=.282095,i[1]=.488603*s,i[2]=.488603*a,i[3]=.488603*n,i[4]=1.092548*n*s,i[5]=1.092548*s*a,i[6]=.315392*(3*a*a-1),i[7]=1.092548*n*a,i[8]=.546274*(n*n-s*s)}}class $g extends ia{constructor(e=new Zg,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class Ou extends bs{constructor(e){super(e),this.textures={}}load(e,i,n,s){const a=this,d=new Bo(a.manager);d.setPath(a.path),d.setRequestHeader(a.requestHeader),d.setWithCredentials(a.withCredentials),d.load(e,function(v){try{i(a.parse(JSON.parse(v)))}catch(I){s?s(I):console.error(I),a.manager.itemError(e)}},n,s)}parse(e){const i=this.textures;function n(a){return i[a]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",a),i[a]}const s=Ou.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new li().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const a in e.uniforms){const d=e.uniforms[a];switch(s.uniforms[a]={},d.type){case"t":s.uniforms[a].value=n(d.value);break;case"c":s.uniforms[a].value=new li().setHex(d.value);break;case"v2":s.uniforms[a].value=new xt().fromArray(d.value);break;case"v3":s.uniforms[a].value=new Ie().fromArray(d.value);break;case"v4":s.uniforms[a].value=new _n().fromArray(d.value);break;case"m3":s.uniforms[a].value=new ji().fromArray(d.value);break;case"m4":s.uniforms[a].value=new mi().fromArray(d.value);break;default:s.uniforms[a].value=d.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const a in e.extensions)s.extensions[a]=e.extensions[a];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let a=e.normalScale;Array.isArray(a)===!1&&(a=[a,a]),s.normalScale=new xt().fromArray(a)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new xt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const i={ShadowMaterial:Tg,SpriteMaterial:Kf,RawShaderMaterial:Ig,ShaderMaterial:Xs,PointsMaterial:tp,MeshPhysicalMaterial:Bg,MeshStandardMaterial:Ap,MeshPhongMaterial:Rg,MeshToonMaterial:Lg,MeshNormalMaterial:Dg,MeshLambertMaterial:Pg,MeshDepthMaterial:Qf,MeshDistanceMaterial:Hf,MeshBasicMaterial:Yo,MeshMatcapMaterial:Og,LineDashedMaterial:Fg,LineBasicMaterial:ds,Material:$r};return new i[e]}}class wp{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let n=0,s=e.length;n<s;n++)i+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class e0 extends on{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class t0 extends bs{constructor(e){super(e)}load(e,i,n,s){const a=this,d=new Bo(a.manager);d.setPath(a.path),d.setRequestHeader(a.requestHeader),d.setWithCredentials(a.withCredentials),d.load(e,function(v){try{i(a.parse(JSON.parse(v)))}catch(I){s?s(I):console.error(I),a.manager.itemError(e)}},n,s)}parse(e){const i={},n={};function s(z,K){if(i[K]!==void 0)return i[K];const X=z.interleavedBuffers[K],Q=a(z,X.buffer),ge=Qo(X.type,Q),Ae=new Jh(ge,X.stride);return Ae.uuid=X.uuid,i[K]=Ae,Ae}function a(z,K){if(n[K]!==void 0)return n[K];const X=z.arrayBuffers[K],Q=new Uint32Array(X).buffer;return n[K]=Q,Q}const d=e.isInstancedBufferGeometry?new e0:new on,v=e.data.index;if(v!==void 0){const z=Qo(v.type,v.array);d.setIndex(new zn(z,1))}const I=e.data.attributes;for(const z in I){const K=I[z];let ee;if(K.isInterleavedBufferAttribute){const X=s(e.data,K.data);ee=new Da(X,K.itemSize,K.offset,K.normalized)}else{const X=Qo(K.type,K.array),Q=K.isInstancedBufferAttribute?Il:zn;ee=new Q(X,K.itemSize,K.normalized)}K.name!==void 0&&(ee.name=K.name),K.usage!==void 0&&ee.setUsage(K.usage),d.setAttribute(z,ee)}const R=e.data.morphAttributes;if(R)for(const z in R){const K=R[z],ee=[];for(let X=0,Q=K.length;X<Q;X++){const ge=K[X];let Ae;if(ge.isInterleavedBufferAttribute){const he=s(e.data,ge.data);Ae=new Da(he,ge.itemSize,ge.offset,ge.normalized)}else{const he=Qo(ge.type,ge.array);Ae=new zn(he,ge.itemSize,ge.normalized)}ge.name!==void 0&&(Ae.name=ge.name),ee.push(Ae)}d.morphAttributes[z]=ee}e.data.morphTargetsRelative&&(d.morphTargetsRelative=!0);const k=e.data.groups||e.data.drawcalls||e.data.offsets;if(k!==void 0)for(let z=0,K=k.length;z!==K;++z){const ee=k[z];d.addGroup(ee.start,ee.count,ee.materialIndex)}const G=e.data.boundingSphere;if(G!==void 0){const z=new Ie;G.center!==void 0&&z.fromArray(G.center),d.boundingSphere=new Ir(z,G.radius)}return e.name&&(d.name=e.name),e.userData&&(d.userData=e.userData),d}}class Gb extends bs{constructor(e){super(e)}load(e,i,n,s){const a=this,d=this.path===""?wp.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;const v=new Bo(this.manager);v.setPath(this.path),v.setRequestHeader(this.requestHeader),v.setWithCredentials(this.withCredentials),v.load(e,function(I){let R=null;try{R=JSON.parse(I)}catch(k){s!==void 0&&s(k),console.error("THREE:ObjectLoader: Can't parse "+e+".",k.message);return}const O=R.metadata;if(O===void 0||O.type===void 0||O.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}a.parse(R,i)},n,s)}async loadAsync(e,i){const n=this,s=this.path===""?wp.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const a=new Bo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials);const d=await a.loadAsync(e,i),v=JSON.parse(d),I=v.metadata;if(I===void 0||I.type===void 0||I.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(v)}parse(e,i){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,s),d=this.parseImages(e.images,function(){i!==void 0&&i(R)}),v=this.parseTextures(e.textures,d),I=this.parseMaterials(e.materials,v),R=this.parseObject(e.object,a,I,v,n),O=this.parseSkeletons(e.skeletons,R);if(this.bindSkeletons(R,O),i!==void 0){let k=!1;for(const G in d)if(d[G].data instanceof HTMLImageElement){k=!0;break}k===!1&&i(R)}return R}async parseAsync(e){const i=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),a=await this.parseImagesAsync(e.images),d=this.parseTextures(e.textures,a),v=this.parseMaterials(e.materials,d),I=this.parseObject(e.object,s,v,d,i),R=this.parseSkeletons(e.skeletons,I);return this.bindSkeletons(I,R),I}parseShapes(e){const i={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const a=new Oa().fromJSON(e[n]);i[a.uuid]=a}return i}parseSkeletons(e,i){const n={},s={};if(i.traverse(function(a){a.isBone&&(s[a.uuid]=a)}),e!==void 0)for(let a=0,d=e.length;a<d;a++){const v=new nu().fromJSON(e[a],s);n[v.uuid]=v}return n}parseGeometries(e,i){const n={};if(e!==void 0){const a=new t0;for(let d=0,v=e.length;d<v;d++){let I;const R=e[d];switch(R.type){case"BufferGeometry":case"InstancedBufferGeometry":I=a.parse(R);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var s=new THREE.LegacyJSONLoader;I=s.parse(R,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:R.type in Sg?I=Sg[R.type].fromJSON(R,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${R.type}"`)}I.uuid=R.uuid,R.name!==void 0&&(I.name=R.name),R.userData!==void 0&&(I.userData=R.userData),n[R.uuid]=I}}return n}parseMaterials(e,i){const n={},s={};if(e!==void 0){const a=new Ou;a.setTextures(i);for(let d=0,v=e.length;d<v;d++){const I=e[d];n[I.uuid]===void 0&&(n[I.uuid]=a.parse(I)),s[I.uuid]=n[I.uuid]}}return s}parseAnimations(e){const i={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],a=Vc.parse(s);i[a.uuid]=a}return i}parseImages(e,i){const n=this,s={};let a;function d(I){return n.manager.itemStart(I),a.load(I,function(){n.manager.itemEnd(I)},void 0,function(){n.manager.itemError(I),n.manager.itemEnd(I)})}function v(I){if(typeof I=="string"){const R=I,O=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(R)?R:n.resourcePath+R;return d(O)}else return I.data?{data:Qo(I.type,I.data),width:I.width,height:I.height}:null}if(e!==void 0&&e.length>0){const I=new Ep(i);a=new zc(I),a.setCrossOrigin(this.crossOrigin);for(let R=0,O=e.length;R<O;R++){const k=e[R],G=k.url;if(Array.isArray(G)){const z=[];for(let K=0,ee=G.length;K<ee;K++){const X=G[K],Q=v(X);Q!==null&&(Q instanceof HTMLImageElement?z.push(Q):z.push(new Zo(Q.data,Q.width,Q.height)))}s[k.uuid]=new tr(z)}else{const z=v(k.url);s[k.uuid]=new tr(z)}}}return s}async parseImagesAsync(e){const i=this,n={};let s;async function a(d){if(typeof d=="string"){const v=d,I=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(v)?v:i.resourcePath+v;return await s.loadAsync(I)}else return d.data?{data:Qo(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){s=new zc(this.manager),s.setCrossOrigin(this.crossOrigin);for(let d=0,v=e.length;d<v;d++){const I=e[d],R=I.url;if(Array.isArray(R)){const O=[];for(let k=0,G=R.length;k<G;k++){const z=R[k],K=await a(z);K!==null&&(K instanceof HTMLImageElement?O.push(K):O.push(new Zo(K.data,K.width,K.height)))}n[I.uuid]=new tr(O)}else{const O=await a(I.url);n[I.uuid]=new tr(O)}}}return n}parseTextures(e,i){function n(a,d){return typeof a=="number"?a:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a),d[a])}const s={};if(e!==void 0)for(let a=0,d=e.length;a<d;a++){const v=e[a];v.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',v.uuid),i[v.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",v.image);const I=i[v.image],R=I.data;let O;Array.isArray(R)?(O=new yc,R.length===6&&(O.needsUpdate=!0)):(R&&R.data?O=new Zo:O=new qn,R&&(O.needsUpdate=!0)),O.source=I,O.uuid=v.uuid,v.name!==void 0&&(O.name=v.name),v.mapping!==void 0&&(O.mapping=n(v.mapping,Vb)),v.channel!==void 0&&(O.channel=v.channel),v.offset!==void 0&&O.offset.fromArray(v.offset),v.repeat!==void 0&&O.repeat.fromArray(v.repeat),v.center!==void 0&&O.center.fromArray(v.center),v.rotation!==void 0&&(O.rotation=v.rotation),v.wrap!==void 0&&(O.wrapS=n(v.wrap[0],i0),O.wrapT=n(v.wrap[1],i0)),v.format!==void 0&&(O.format=v.format),v.internalFormat!==void 0&&(O.internalFormat=v.internalFormat),v.type!==void 0&&(O.type=v.type),v.colorSpace!==void 0&&(O.colorSpace=v.colorSpace),v.minFilter!==void 0&&(O.minFilter=n(v.minFilter,n0)),v.magFilter!==void 0&&(O.magFilter=n(v.magFilter,n0)),v.anisotropy!==void 0&&(O.anisotropy=v.anisotropy),v.flipY!==void 0&&(O.flipY=v.flipY),v.generateMipmaps!==void 0&&(O.generateMipmaps=v.generateMipmaps),v.premultiplyAlpha!==void 0&&(O.premultiplyAlpha=v.premultiplyAlpha),v.unpackAlignment!==void 0&&(O.unpackAlignment=v.unpackAlignment),v.compareFunction!==void 0&&(O.compareFunction=v.compareFunction),v.userData!==void 0&&(O.userData=v.userData),s[v.uuid]=O}return s}parseObject(e,i,n,s,a){let d;function v(G){return i[G]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",G),i[G]}function I(G){if(G!==void 0){if(Array.isArray(G)){const z=[];for(let K=0,ee=G.length;K<ee;K++){const X=G[K];n[X]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",X),z.push(n[X])}return z}return n[G]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",G),n[G]}}function R(G){return s[G]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",G),s[G]}let O,k;switch(e.type){case"Scene":d=new km,e.background!==void 0&&(Number.isInteger(e.background)?d.background=new li(e.background):d.background=R(e.background)),e.environment!==void 0&&(d.environment=R(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?d.fog=new qh(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(d.fog=new Yh(e.fog.color,e.fog.density)),e.fog.name!==""&&(d.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(d.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(d.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&d.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(d.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&d.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":d=new Rr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(d.focus=e.focus),e.zoom!==void 0&&(d.zoom=e.zoom),e.filmGauge!==void 0&&(d.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(d.filmOffset=e.filmOffset),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"OrthographicCamera":d=new jh(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(d.zoom=e.zoom),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"AmbientLight":d=new qg(e.color,e.intensity);break;case"DirectionalLight":d=new Yg(e.color,e.intensity);break;case"PointLight":d=new Xg(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":d=new Jg(e.color,e.intensity,e.width,e.height);break;case"SpotLight":d=new Wg(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":d=new Qg(e.color,e.groundColor,e.intensity);break;case"LightProbe":d=new $g().fromJSON(e);break;case"SkinnedMesh":O=v(e.geometry),k=I(e.material),d=new qm(O,k),e.bindMode!==void 0&&(d.bindMode=e.bindMode),e.bindMatrix!==void 0&&d.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(d.skeleton=e.skeleton);break;case"Mesh":O=v(e.geometry),k=I(e.material),d=new wr(O,k);break;case"InstancedMesh":O=v(e.geometry),k=I(e.material);const G=e.count,z=e.instanceMatrix,K=e.instanceColor;d=new eg(O,k,G),d.instanceMatrix=new Il(new Float32Array(z.array),16),K!==void 0&&(d.instanceColor=new Il(new Float32Array(K.array),K.itemSize));break;case"BatchedMesh":O=v(e.geometry),k=I(e.material),d=new ng(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,k),d.geometry=O,d.perObjectFrustumCulled=e.perObjectFrustumCulled,d.sortObjects=e.sortObjects,d._drawRanges=e.drawRanges,d._reservedRanges=e.reservedRanges,d._visibility=e.visibility,d._active=e.active,d._bounds=e.bounds.map(ee=>{const X=new hr;X.min.fromArray(ee.boxMin),X.max.fromArray(ee.boxMax);const Q=new Ir;return Q.radius=ee.sphereRadius,Q.center.fromArray(ee.sphereCenter),{boxInitialized:ee.boxInitialized,box:X,sphereInitialized:ee.sphereInitialized,sphere:Q}}),d._maxGeometryCount=e.maxGeometryCount,d._maxVertexCount=e.maxVertexCount,d._maxIndexCount=e.maxIndexCount,d._geometryInitialized=e.geometryInitialized,d._geometryCount=e.geometryCount,d._matricesTexture=R(e.matricesTexture.uuid);break;case"LOD":d=new Hm;break;case"Line":d=new ea(v(e.geometry),I(e.material));break;case"LineLoop":d=new lg(v(e.geometry),I(e.material));break;case"LineSegments":d=new fo(v(e.geometry),I(e.material));break;case"PointCloud":case"Points":d=new hg(v(e.geometry),I(e.material));break;case"Sprite":d=new zm(I(e.material));break;case"Group":d=new Ra;break;case"Bone":d=new Jf;break;default:d=new Ln}if(d.uuid=e.uuid,e.name!==void 0&&(d.name=e.name),e.matrix!==void 0?(d.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(d.matrixAutoUpdate=e.matrixAutoUpdate),d.matrixAutoUpdate&&d.matrix.decompose(d.position,d.quaternion,d.scale)):(e.position!==void 0&&d.position.fromArray(e.position),e.rotation!==void 0&&d.rotation.fromArray(e.rotation),e.quaternion!==void 0&&d.quaternion.fromArray(e.quaternion),e.scale!==void 0&&d.scale.fromArray(e.scale)),e.up!==void 0&&d.up.fromArray(e.up),e.castShadow!==void 0&&(d.castShadow=e.castShadow),e.receiveShadow!==void 0&&(d.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(d.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(d.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(d.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&d.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(d.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(d.visible=e.visible),e.frustumCulled!==void 0&&(d.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(d.renderOrder=e.renderOrder),e.userData!==void 0&&(d.userData=e.userData),e.layers!==void 0&&(d.layers.mask=e.layers),e.children!==void 0){const G=e.children;for(let z=0;z<G.length;z++)d.add(this.parseObject(G[z],i,n,s,a))}if(e.animations!==void 0){const G=e.animations;for(let z=0;z<G.length;z++){const K=G[z];d.animations.push(a[K])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(d.autoUpdate=e.autoUpdate);const G=e.levels;for(let z=0;z<G.length;z++){const K=G[z],ee=d.getObjectByProperty("uuid",K.object);ee!==void 0&&d.addLevel(ee,K.distance,K.hysteresis)}}return d}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=i[n.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}}const Vb={UVMapping:Pe,CubeReflectionMapping:$,CubeRefractionMapping:N,EquirectangularReflectionMapping:V,EquirectangularRefractionMapping:fe,CubeUVReflectionMapping:be},i0={RepeatWrapping:Fe,ClampToEdgeWrapping:We,MirroredRepeatWrapping:Rt},n0={NearestFilter:zt,NearestMipmapNearestFilter:Lt,NearestMipmapLinearFilter:ti,LinearFilter:wi,LinearMipmapNearestFilter:Xn,LinearMipmapLinearFilter:In};class zb extends bs{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,d=To.get(e);if(d!==void 0){if(a.manager.itemStart(e),d.then){d.then(R=>{i&&i(R),a.manager.itemEnd(e)}).catch(R=>{s&&s(R)});return}return setTimeout(function(){i&&i(d),a.manager.itemEnd(e)},0),d}const v={};v.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",v.headers=this.requestHeader;const I=fetch(e,v).then(function(R){return R.blob()}).then(function(R){return createImageBitmap(R,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(R){return To.add(e,R),i&&i(R),a.manager.itemEnd(e),R}).catch(function(R){s&&s(R),To.remove(e),a.manager.itemError(e),a.manager.itemEnd(e)});To.add(e,I),a.manager.itemStart(e)}}let Fu;class Mp{static getContext(){return Fu===void 0&&(Fu=new(window.AudioContext||window.webkitAudioContext)),Fu}static setContext(e){Fu=e}}class Qb extends bs{constructor(e){super(e)}load(e,i,n,s){const a=this,d=new Bo(this.manager);d.setResponseType("arraybuffer"),d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(I){try{const R=I.slice(0);Mp.getContext().decodeAudioData(R,function(k){i(k)}).catch(v)}catch(R){v(R)}},n,s);function v(I){s?s(I):console.error(I),a.manager.itemError(e)}}}const r0=new mi,s0=new mi,Ga=new mi;class Hb{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Rr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Rr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,Ga.copy(e.projectionMatrix);const s=i.eyeSep/2,a=s*i.near/i.focus,d=i.near*Math.tan(Eo*i.fov*.5)/i.zoom;let v,I;s0.elements[12]=-s,r0.elements[12]=s,v=-d*i.aspect+a,I=d*i.aspect+a,Ga.elements[0]=2*i.near/(I-v),Ga.elements[8]=(I+v)/(I-v),this.cameraL.projectionMatrix.copy(Ga),v=-d*i.aspect-a,I=d*i.aspect-a,Ga.elements[0]=2*i.near/(I-v),Ga.elements[8]=(I+v)/(I-v),this.cameraR.projectionMatrix.copy(Ga)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(s0),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(r0)}}class o0{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=a0(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=a0();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function a0(){return(typeof performance>"u"?Date:performance).now()}const Va=new Ie,l0=new Rn,jb=new Ie,za=new Ie;class Wb extends Ln{constructor(){super(),this.type="AudioListener",this.context=Mp.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new o0}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Va,l0,jb),za.set(0,0,-1).applyQuaternion(l0),i.positionX){const s=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(Va.x,s),i.positionY.linearRampToValueAtTime(Va.y,s),i.positionZ.linearRampToValueAtTime(Va.z,s),i.forwardX.linearRampToValueAtTime(za.x,s),i.forwardY.linearRampToValueAtTime(za.y,s),i.forwardZ.linearRampToValueAtTime(za.z,s),i.upX.linearRampToValueAtTime(n.x,s),i.upY.linearRampToValueAtTime(n.y,s),i.upZ.linearRampToValueAtTime(n.z,s)}else i.setPosition(Va.x,Va.y,Va.z),i.setOrientation(za.x,za.y,za.z,n.x,n.y,n.z)}}class c0 extends Ln{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Qa=new Ie,h0=new Rn,Kb=new Ie,Ha=new Ie;class Xb extends c0{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Qa,h0,Kb),Ha.set(0,0,1).applyQuaternion(h0);const i=this.panner;if(i.positionX){const n=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(Qa.x,n),i.positionY.linearRampToValueAtTime(Qa.y,n),i.positionZ.linearRampToValueAtTime(Qa.z,n),i.orientationX.linearRampToValueAtTime(Ha.x,n),i.orientationY.linearRampToValueAtTime(Ha.y,n),i.orientationZ.linearRampToValueAtTime(Ha.z,n)}else i.setPosition(Qa.x,Qa.y,Qa.z),i.setOrientation(Ha.x,Ha.y,Ha.z)}}class Yb{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let n=0;n<i.length;n++)e+=i[n];return e/i.length}}class u0{constructor(e,i,n){this.binding=e,this.valueSize=n;let s,a,d;switch(i){case"quaternion":s=this._slerp,a=this._slerpAdditive,d=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,a=this._select,d=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,a=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=a,this._setIdentity=d,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const n=this.buffer,s=this.valueSize,a=e*s+s;let d=this.cumulativeWeight;if(d===0){for(let v=0;v!==s;++v)n[a+v]=n[v];d=i}else{d+=i;const v=i/d;this._mixBufferRegion(n,a,0,v,s)}this.cumulativeWeight=d}accumulateAdditive(e){const i=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,n=this.buffer,s=e*i+i,a=this.cumulativeWeight,d=this.cumulativeWeightAdditive,v=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const I=i*this._origIndex;this._mixBufferRegion(n,s,I,1-a,i)}d>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*i,1,i);for(let I=i,R=i+i;I!==R;++I)if(n[I]!==n[I+i]){v.setValue(n,s);break}}saveOriginalState(){const e=this.binding,i=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(i,s);for(let a=n,d=s;a!==d;++a)i[a]=i[s+a%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let n=e;n<i;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[e+n]}_select(e,i,n,s,a){if(s>=.5)for(let d=0;d!==a;++d)e[i+d]=e[n+d]}_slerp(e,i,n,s){Rn.slerpFlat(e,i,e,i,e,n,s)}_slerpAdditive(e,i,n,s,a){const d=this._workIndex*a;Rn.multiplyQuaternionsFlat(e,d,e,i,e,n),Rn.slerpFlat(e,i,e,i,e,d,s)}_lerp(e,i,n,s,a){const d=1-s;for(let v=0;v!==a;++v){const I=i+v;e[I]=e[I]*d+e[n+v]*s}}_lerpAdditive(e,i,n,s,a){for(let d=0;d!==a;++d){const v=i+d;e[v]=e[v]+e[n+d]*s}}}const _p="\\[\\]\\.:\\/",qb=new RegExp("["+_p+"]","g"),Sp="[^"+_p+"]",Jb="[^"+_p.replace("\\.","")+"]",Zb=/((?:WC+[\/:])*)/.source.replace("WC",Sp),$b=/(WCOD+)?/.source.replace("WCOD",Jb),e2=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Sp),t2=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Sp),i2=new RegExp("^"+Zb+$b+e2+t2+"$"),n2=["material","materials","bones","map"];class r2{constructor(e,i,n){const s=n||Sn.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,s)}getValue(e,i){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,i)}setValue(e,i){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=n.length;s!==a;++s)n[s].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].unbind()}}class Sn{constructor(e,i,n){this.path=i,this.parsedPath=n||Sn.parseTrackName(i),this.node=Sn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,n){return e&&e.isAnimationObjectGroup?new Sn.Composite(e,i,n):new Sn(e,i,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(qb,"")}static parseTrackName(e){const i=i2.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const a=n.nodeName.substring(s+1);n2.indexOf(a)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=a)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(i);if(n!==void 0)return n}if(e.children){const n=function(a){for(let d=0;d<a.length;d++){const v=a[d];if(v.name===i||v.uuid===i)return v;const I=n(v.children);if(I)return I}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)e[i++]=n[s]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)n[s]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)n[s]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)n[s]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,n=i.objectName,s=i.propertyName;let a=i.propertyIndex;if(e||(e=Sn.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let R=i.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let O=0;O<e.length;O++)if(e[O].name===R){R=O;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(R!==void 0){if(e[R]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[R]}}const d=e[s];if(d===void 0){const R=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+R+"."+s+" but it wasn't found.",e);return}let v=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?v=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(v=this.Versioning.MatrixWorldNeedsUpdate);let I=this.BindingType.Direct;if(a!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}I=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=a}else d.fromArray!==void 0&&d.toArray!==void 0?(I=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(I=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=s;this.getValue=this.GetterByBindingType[I],this.setValue=this.SetterByBindingTypeAndVersioning[I][v]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Sn.Composite=r2,Sn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Sn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Sn.prototype.GetterByBindingType=[Sn.prototype._getValue_direct,Sn.prototype._getValue_array,Sn.prototype._getValue_arrayElement,Sn.prototype._getValue_toArray],Sn.prototype.SetterByBindingTypeAndVersioning=[[Sn.prototype._setValue_direct,Sn.prototype._setValue_direct_setNeedsUpdate,Sn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_array,Sn.prototype._setValue_array_setNeedsUpdate,Sn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_arrayElement,Sn.prototype._setValue_arrayElement_setNeedsUpdate,Sn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_fromArray,Sn.prototype._setValue_fromArray_setNeedsUpdate,Sn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class s2{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ls(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,n=this._paths,s=this._parsedPaths,a=this._bindings,d=a.length;let v,I=e.length,R=this.nCachedObjects_;for(let O=0,k=arguments.length;O!==k;++O){const G=arguments[O],z=G.uuid;let K=i[z];if(K===void 0){K=I++,i[z]=K,e.push(G);for(let ee=0,X=d;ee!==X;++ee)a[ee].push(new Sn(G,n[ee],s[ee]))}else if(K<R){v=e[K];const ee=--R,X=e[ee];i[X.uuid]=K,e[K]=X,i[z]=ee,e[ee]=G;for(let Q=0,ge=d;Q!==ge;++Q){const Ae=a[Q],he=Ae[ee];let Qe=Ae[K];Ae[K]=he,Qe===void 0&&(Qe=new Sn(G,n[Q],s[Q])),Ae[ee]=Qe}}else e[K]!==v&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=R}remove(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,s=n.length;let a=this.nCachedObjects_;for(let d=0,v=arguments.length;d!==v;++d){const I=arguments[d],R=I.uuid,O=i[R];if(O!==void 0&&O>=a){const k=a++,G=e[k];i[G.uuid]=O,e[O]=G,i[R]=k,e[k]=I;for(let z=0,K=s;z!==K;++z){const ee=n[z],X=ee[k],Q=ee[O];ee[O]=X,ee[k]=Q}}}this.nCachedObjects_=a}uncache(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,s=n.length;let a=this.nCachedObjects_,d=e.length;for(let v=0,I=arguments.length;v!==I;++v){const R=arguments[v],O=R.uuid,k=i[O];if(k!==void 0)if(delete i[O],k<a){const G=--a,z=e[G],K=--d,ee=e[K];i[z.uuid]=k,e[k]=z,i[ee.uuid]=G,e[G]=ee,e.pop();for(let X=0,Q=s;X!==Q;++X){const ge=n[X],Ae=ge[G],he=ge[K];ge[k]=Ae,ge[G]=he,ge.pop()}}else{const G=--d,z=e[G];G>0&&(i[z.uuid]=k),e[k]=z,e.pop();for(let K=0,ee=s;K!==ee;++K){const X=n[K];X[k]=X[G],X.pop()}}}this.nCachedObjects_=a}subscribe_(e,i){const n=this._bindingsIndicesByPath;let s=n[e];const a=this._bindings;if(s!==void 0)return a[s];const d=this._paths,v=this._parsedPaths,I=this._objects,R=I.length,O=this.nCachedObjects_,k=new Array(R);s=a.length,n[e]=s,d.push(e),v.push(i),a.push(k);for(let G=O,z=I.length;G!==z;++G){const K=I[G];k[G]=new Sn(K,e,i)}return k}unsubscribe_(e){const i=this._bindingsIndicesByPath,n=i[e];if(n!==void 0){const s=this._paths,a=this._parsedPaths,d=this._bindings,v=d.length-1,I=d[v],R=e[v];i[R]=n,d[n]=I,d.pop(),a[n]=a[v],a.pop(),s[n]=s[v],s.pop()}}}class d0{constructor(e,i,n=null,s=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=n,this.blendMode=s;const a=i.tracks,d=a.length,v=new Array(d),I={endingStart:Ji,endingEnd:Ji};for(let R=0;R!==d;++R){const O=a[R].createInterpolant(null);v[R]=O,O.settings=I}this._interpolantSettings=I,this._interpolants=v,this._propertyBindings=new Array(d),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Xt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,n){if(e.fadeOut(i),this.fadeIn(i),n){const s=this._clip.duration,a=e._clip.duration,d=a/s,v=s/a;e.warp(1,d,i),this.warp(v,1,i)}return this}crossFadeTo(e,i,n){return e.crossFadeFrom(this,i,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,n){const s=this._mixer,a=s.time,d=this.timeScale;let v=this._timeScaleInterpolant;v===null&&(v=s._lendControlInterpolant(),this._timeScaleInterpolant=v);const I=v.parameterPositions,R=v.sampleValues;return I[0]=a,I[1]=a+n,R[0]=e/d,R[1]=i/d,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,n,s){if(!this.enabled){this._updateWeight(e);return}const a=this._startTime;if(a!==null){const I=(e-a)*n;I<0||n===0?i=0:(this._startTime=null,i=n*I)}i*=this._updateTimeScale(e);const d=this._updateTime(i),v=this._updateWeight(e);if(v>0){const I=this._interpolants,R=this._propertyBindings;switch(this.blendMode){case os:for(let O=0,k=I.length;O!==k;++O)I[O].evaluate(d),R[O].accumulateAdditive(v);break;case Di:default:for(let O=0,k=I.length;O!==k;++O)I[O].evaluate(d),R[O].accumulate(s,v)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];i*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];i*=s,e>n.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,n=this.loop;let s=this.time+e,a=this._loopCount;const d=n===_i;if(e===0)return a===-1?s:d&&(a&1)===1?i-s:s;if(n===Ei){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));i:{if(s>=i)s=i;else if(s<0)s=0;else{this.time=s;break i}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),s>=i||s<0){const v=Math.floor(s/i);s-=i*v,a+=Math.abs(v);const I=this.repetitions-a;if(I<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?i:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(I===1){const R=e<0;this._setEndings(R,!R,d)}else this._setEndings(!1,!1,d);this._loopCount=a,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:v})}}else this.time=s;if(d&&(a&1)===1)return i-s}return s}_setEndings(e,i,n){const s=this._interpolantSettings;n?(s.endingStart=Bi,s.endingEnd=Bi):(e?s.endingStart=this.zeroSlopeAtStart?Bi:Ji:s.endingStart=Hn,i?s.endingEnd=this.zeroSlopeAtEnd?Bi:Ji:s.endingEnd=Hn)}_scheduleFading(e,i,n){const s=this._mixer,a=s.time;let d=this._weightInterpolant;d===null&&(d=s._lendControlInterpolant(),this._weightInterpolant=d);const v=d.parameterPositions,I=d.sampleValues;return v[0]=a,I[0]=i,v[1]=a+e,I[1]=n,this}}const o2=new Float32Array(1);class a2 extends as{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const n=e._localRoot||this._root,s=e._clip.tracks,a=s.length,d=e._propertyBindings,v=e._interpolants,I=n.uuid,R=this._bindingsByRootAndName;let O=R[I];O===void 0&&(O={},R[I]=O);for(let k=0;k!==a;++k){const G=s[k],z=G.name;let K=O[z];if(K!==void 0)++K.referenceCount,d[k]=K;else{if(K=d[k],K!==void 0){K._cacheIndex===null&&(++K.referenceCount,this._addInactiveBinding(K,I,z));continue}const ee=i&&i._propertyBindings[k].binding.parsedPath;K=new u0(Sn.create(n,z,ee),G.ValueTypeName,G.getValueSize()),++K.referenceCount,this._addInactiveBinding(K,I,z),d[k]=K}v[k].resultBuffer=K.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,a=this._actionsByClip[s];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,s,n)}const i=e._propertyBindings;for(let n=0,s=i.length;n!==s;++n){const a=i[n];a.useCount++===0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let n=0,s=i.length;n!==s;++n){const a=i[n];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,n){const s=this._actions,a=this._actionsByClip;let d=a[i];if(d===void 0)d={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[i]=d;else{const v=d.knownActions;e._byClipCacheIndex=v.length,v.push(e)}e._cacheIndex=s.length,s.push(e),d.actionByRoot[n]=e}_removeInactiveAction(e){const i=this._actions,n=i[i.length-1],s=e._cacheIndex;n._cacheIndex=s,i[s]=n,i.pop(),e._cacheIndex=null;const a=e._clip.uuid,d=this._actionsByClip,v=d[a],I=v.knownActions,R=I[I.length-1],O=e._byClipCacheIndex;R._byClipCacheIndex=O,I[O]=R,I.pop(),e._byClipCacheIndex=null;const k=v.actionByRoot,G=(e._localRoot||this._root).uuid;delete k[G],I.length===0&&delete d[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let n=0,s=i.length;n!==s;++n){const a=i[n];--a.referenceCount===0&&this._removeInactiveBinding(a)}}_lendAction(e){const i=this._actions,n=e._cacheIndex,s=this._nActiveActions++,a=i[s];e._cacheIndex=s,i[s]=e,a._cacheIndex=n,i[n]=a}_takeBackAction(e){const i=this._actions,n=e._cacheIndex,s=--this._nActiveActions,a=i[s];e._cacheIndex=s,i[s]=e,a._cacheIndex=n,i[n]=a}_addInactiveBinding(e,i,n){const s=this._bindingsByRootAndName,a=this._bindings;let d=s[i];d===void 0&&(d={},s[i]=d),d[n]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const i=this._bindings,n=e.binding,s=n.rootNode.uuid,a=n.path,d=this._bindingsByRootAndName,v=d[s],I=i[i.length-1],R=e._cacheIndex;I._cacheIndex=R,i[R]=I,i.pop(),delete v[a],Object.keys(v).length===0&&delete d[s]}_lendBinding(e){const i=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,a=i[s];e._cacheIndex=s,i[s]=e,a._cacheIndex=n,i[n]=a}_takeBackBinding(e){const i=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,a=i[s];e._cacheIndex=s,i[s]=e,a._cacheIndex=n,i[n]=a}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=e[i];return n===void 0&&(n=new vp(new Float32Array(2),new Float32Array(2),1,o2),n.__cacheIndex=i,e[i]=n),n}_takeBackControlInterpolant(e){const i=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,a=i[s];e.__cacheIndex=s,i[s]=e,a.__cacheIndex=n,i[n]=a}clipAction(e,i,n){const s=i||this._root,a=s.uuid;let d=typeof e=="string"?Vc.findByName(s,e):e;const v=d!==null?d.uuid:e,I=this._actionsByClip[v];let R=null;if(n===void 0&&(d!==null?n=d.blendMode:n=Di),I!==void 0){const k=I.actionByRoot[a];if(k!==void 0&&k.blendMode===n)return k;R=I.knownActions[0],d===null&&(d=R._clip)}if(d===null)return null;const O=new d0(this,d,i,n);return this._bindAction(O,R),this._addInactiveAction(O,v,a),O}existingAction(e,i){const n=i||this._root,s=n.uuid,a=typeof e=="string"?Vc.findByName(n,e):e,d=a?a.uuid:e,v=this._actionsByClip[d];return v!==void 0&&v.actionByRoot[s]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const i=this._actions,n=this._nActiveActions,s=this.time+=e,a=Math.sign(e),d=this._accuIndex^=1;for(let R=0;R!==n;++R)i[R]._update(s,e,a,d);const v=this._bindings,I=this._nActiveBindings;for(let R=0;R!==I;++R)v[R].apply(d);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,n=e.uuid,s=this._actionsByClip,a=s[n];if(a!==void 0){const d=a.knownActions;for(let v=0,I=d.length;v!==I;++v){const R=d[v];this._deactivateAction(R);const O=R._cacheIndex,k=i[i.length-1];R._cacheIndex=null,R._byClipCacheIndex=null,k._cacheIndex=O,i[O]=k,i.pop(),this._removeInactiveBindingsForAction(R)}delete s[n]}}uncacheRoot(e){const i=e.uuid,n=this._actionsByClip;for(const d in n){const v=n[d].actionByRoot,I=v[i];I!==void 0&&(this._deactivateAction(I),this._removeInactiveAction(I))}const s=this._bindingsByRootAndName,a=s[i];if(a!==void 0)for(const d in a){const v=a[d];v.restoreOriginalState(),this._removeInactiveBinding(v)}}uncacheAction(e,i){const n=this.existingAction(e,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Tp{constructor(e){this.value=e}clone(){return new Tp(this.value.clone===void 0?this.value:this.value.clone())}}let l2=0;class c2 extends as{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:l2++}),this.name="",this.usage=xa,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const i=e.uniforms;this.uniforms.length=0;for(let n=0,s=i.length;n<s;n++){const a=Array.isArray(i[n])?i[n]:[i[n]];for(let d=0;d<a.length;d++)this.uniforms.push(a[d].clone())}return this}clone(){return new this.constructor().copy(this)}}class h2 extends Jh{constructor(e,i,n=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class u2{constructor(e,i,n,s,a){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=i,this.itemSize=n,this.elementSize=s,this.count=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const f0=new mi;class d2{constructor(e,i,n=0,s=1/0){this.ray=new Br(e,i),this.near=n,this.far=s,this.camera=null,this.layers=new Bh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}setFromXRController(e){return f0.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(f0),this}intersectObject(e,i=!0,n=[]){return Ip(e,this,n,i),n.sort(p0),n}intersectObjects(e,i=!0,n=[]){for(let s=0,a=e.length;s<a;s++)Ip(e[s],this,n,i);return n.sort(p0),n}}function p0(l,e){return l.distance-e.distance}function Ip(l,e,i,n){if(l.layers.test(e.layers)&&l.raycast(e,i),n===!0){const s=l.children;for(let a=0,d=s.length;a<d;a++)Ip(s[a],e,i,!0)}}class f2{constructor(e=1,i=0,n=0){return this.radius=e,this.phi=i,this.theta=n,this}set(e,i,n){return this.radius=e,this.phi=i,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+i*i+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(or(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class p2{constructor(e=1,i=0,n=0){return this.radius=e,this.theta=i,this.y=n,this}set(e,i,n){return this.radius=e,this.theta=i,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=i,this}clone(){return new this.constructor().copy(this)}}const A0=new xt;class A2{constructor(e=new xt(1/0,1/0),i=new xt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=A0.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,A0).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const m0=new Ie,Nu=new Ie;class m2{constructor(e=new Ie,i=new Ie){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){m0.subVectors(e,this.start),Nu.subVectors(this.end,this.start);const n=Nu.dot(Nu);let a=Nu.dot(m0)/n;return i&&(a=or(a,0,1)),a}closestPointToPoint(e,i,n){const s=this.closestPointToPointParameter(e,i);return this.delta(n).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const g0=new Ie;class g2 extends Ln{constructor(e,i){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const n=new on,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let d=0,v=1,I=32;d<I;d++,v++){const R=d/I*Math.PI*2,O=v/I*Math.PI*2;s.push(Math.cos(R),Math.sin(R),1,Math.cos(O),Math.sin(O),1)}n.setAttribute("position",new xi(s,3));const a=new ds({fog:!1,toneMapped:!1});this.cone=new fo(n,a),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),g0.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(g0),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const na=new Ie,ku=new mi,Bp=new mi;class v2 extends fo{constructor(e){const i=v0(e),n=new on,s=[],a=[],d=new li(0,0,1),v=new li(0,1,0);for(let R=0;R<i.length;R++){const O=i[R];O.parent&&O.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),a.push(d.r,d.g,d.b),a.push(v.r,v.g,v.b))}n.setAttribute("position",new xi(s,3)),n.setAttribute("color",new xi(a,3));const I=new ds({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,I),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,n=this.geometry,s=n.getAttribute("position");Bp.copy(this.root.matrixWorld).invert();for(let a=0,d=0;a<i.length;a++){const v=i[a];v.parent&&v.parent.isBone&&(ku.multiplyMatrices(Bp,v.matrixWorld),na.setFromMatrixPosition(ku),s.setXYZ(d,na.x,na.y,na.z),ku.multiplyMatrices(Bp,v.parent.matrixWorld),na.setFromMatrixPosition(ku),s.setXYZ(d+1,na.x,na.y,na.z),d+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function v0(l){const e=[];l.isBone===!0&&e.push(l);for(let i=0;i<l.children.length;i++)e.push.apply(e,v0(l.children[i]));return e}class y2 extends wr{constructor(e,i,n){const s=new Nc(i,4,2),a=new Yo({wireframe:!0,fog:!1,toneMapped:!1});super(s,a),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const E2=new Ie,y0=new li,E0=new li;class x2 extends Ln{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new Fc(i);s.rotateY(Math.PI*.5),this.material=new Yo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const a=s.getAttribute("position"),d=new Float32Array(a.count*3);s.setAttribute("color",new zn(d,3)),this.add(new wr(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");y0.copy(this.light.color),E0.copy(this.light.groundColor);for(let n=0,s=i.count;n<s;n++){const a=n<s/2?y0:E0;i.setXYZ(n,a.r,a.g,a.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(E2.setFromMatrixPosition(this.light.matrixWorld).negate())}}class C2 extends fo{constructor(e=10,i=10,n=4473924,s=8947848){n=new li(n),s=new li(s);const a=i/2,d=e/i,v=e/2,I=[],R=[];for(let G=0,z=0,K=-v;G<=i;G++,K+=d){I.push(-v,0,K,v,0,K),I.push(K,0,-v,K,0,v);const ee=G===a?n:s;ee.toArray(R,z),z+=3,ee.toArray(R,z),z+=3,ee.toArray(R,z),z+=3,ee.toArray(R,z),z+=3}const O=new on;O.setAttribute("position",new xi(I,3)),O.setAttribute("color",new xi(R,3));const k=new ds({vertexColors:!0,toneMapped:!1});super(O,k),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class b2 extends fo{constructor(e=10,i=16,n=8,s=64,a=4473924,d=8947848){a=new li(a),d=new li(d);const v=[],I=[];if(i>1)for(let k=0;k<i;k++){const G=k/i*(Math.PI*2),z=Math.sin(G)*e,K=Math.cos(G)*e;v.push(0,0,0),v.push(z,0,K);const ee=k&1?a:d;I.push(ee.r,ee.g,ee.b),I.push(ee.r,ee.g,ee.b)}for(let k=0;k<n;k++){const G=k&1?a:d,z=e-e/n*k;for(let K=0;K<s;K++){let ee=K/s*(Math.PI*2),X=Math.sin(ee)*z,Q=Math.cos(ee)*z;v.push(X,0,Q),I.push(G.r,G.g,G.b),ee=(K+1)/s*(Math.PI*2),X=Math.sin(ee)*z,Q=Math.cos(ee)*z,v.push(X,0,Q),I.push(G.r,G.g,G.b)}}const R=new on;R.setAttribute("position",new xi(v,3)),R.setAttribute("color",new xi(I,3));const O=new ds({vertexColors:!0,toneMapped:!1});super(R,O),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const x0=new Ie,Uu=new Ie,C0=new Ie;class w2 extends Ln{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",i===void 0&&(i=1);let s=new on;s.setAttribute("position",new xi([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const a=new ds({fog:!1,toneMapped:!1});this.lightPlane=new ea(s,a),this.add(this.lightPlane),s=new on,s.setAttribute("position",new xi([0,0,0,0,0,1],3)),this.targetLine=new ea(s,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),x0.setFromMatrixPosition(this.light.matrixWorld),Uu.setFromMatrixPosition(this.light.target.matrixWorld),C0.subVectors(Uu,x0),this.lightPlane.lookAt(Uu),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Uu),this.targetLine.scale.z=C0.length()}}const Gu=new Ie,gr=new zh;class M2 extends fo{constructor(e){const i=new on,n=new ds({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],a=[],d={};v("n1","n2"),v("n2","n4"),v("n4","n3"),v("n3","n1"),v("f1","f2"),v("f2","f4"),v("f4","f3"),v("f3","f1"),v("n1","f1"),v("n2","f2"),v("n3","f3"),v("n4","f4"),v("p","n1"),v("p","n2"),v("p","n3"),v("p","n4"),v("u1","u2"),v("u2","u3"),v("u3","u1"),v("c","t"),v("p","c"),v("cn1","cn2"),v("cn3","cn4"),v("cf1","cf2"),v("cf3","cf4");function v(K,ee){I(K),I(ee)}function I(K){s.push(0,0,0),a.push(0,0,0),d[K]===void 0&&(d[K]=[]),d[K].push(s.length/3-1)}i.setAttribute("position",new xi(s,3)),i.setAttribute("color",new xi(a,3)),super(i,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=d,this.update();const R=new li(16755200),O=new li(16711680),k=new li(43775),G=new li(16777215),z=new li(3355443);this.setColors(R,O,k,G,z)}setColors(e,i,n,s,a){const v=this.geometry.getAttribute("color");v.setXYZ(0,e.r,e.g,e.b),v.setXYZ(1,e.r,e.g,e.b),v.setXYZ(2,e.r,e.g,e.b),v.setXYZ(3,e.r,e.g,e.b),v.setXYZ(4,e.r,e.g,e.b),v.setXYZ(5,e.r,e.g,e.b),v.setXYZ(6,e.r,e.g,e.b),v.setXYZ(7,e.r,e.g,e.b),v.setXYZ(8,e.r,e.g,e.b),v.setXYZ(9,e.r,e.g,e.b),v.setXYZ(10,e.r,e.g,e.b),v.setXYZ(11,e.r,e.g,e.b),v.setXYZ(12,e.r,e.g,e.b),v.setXYZ(13,e.r,e.g,e.b),v.setXYZ(14,e.r,e.g,e.b),v.setXYZ(15,e.r,e.g,e.b),v.setXYZ(16,e.r,e.g,e.b),v.setXYZ(17,e.r,e.g,e.b),v.setXYZ(18,e.r,e.g,e.b),v.setXYZ(19,e.r,e.g,e.b),v.setXYZ(20,e.r,e.g,e.b),v.setXYZ(21,e.r,e.g,e.b),v.setXYZ(22,e.r,e.g,e.b),v.setXYZ(23,e.r,e.g,e.b),v.setXYZ(24,i.r,i.g,i.b),v.setXYZ(25,i.r,i.g,i.b),v.setXYZ(26,i.r,i.g,i.b),v.setXYZ(27,i.r,i.g,i.b),v.setXYZ(28,i.r,i.g,i.b),v.setXYZ(29,i.r,i.g,i.b),v.setXYZ(30,i.r,i.g,i.b),v.setXYZ(31,i.r,i.g,i.b),v.setXYZ(32,n.r,n.g,n.b),v.setXYZ(33,n.r,n.g,n.b),v.setXYZ(34,n.r,n.g,n.b),v.setXYZ(35,n.r,n.g,n.b),v.setXYZ(36,n.r,n.g,n.b),v.setXYZ(37,n.r,n.g,n.b),v.setXYZ(38,s.r,s.g,s.b),v.setXYZ(39,s.r,s.g,s.b),v.setXYZ(40,a.r,a.g,a.b),v.setXYZ(41,a.r,a.g,a.b),v.setXYZ(42,a.r,a.g,a.b),v.setXYZ(43,a.r,a.g,a.b),v.setXYZ(44,a.r,a.g,a.b),v.setXYZ(45,a.r,a.g,a.b),v.setXYZ(46,a.r,a.g,a.b),v.setXYZ(47,a.r,a.g,a.b),v.setXYZ(48,a.r,a.g,a.b),v.setXYZ(49,a.r,a.g,a.b),v.needsUpdate=!0}update(){const e=this.geometry,i=this.pointMap,n=1,s=1;gr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),vr("c",i,e,gr,0,0,-1),vr("t",i,e,gr,0,0,1),vr("n1",i,e,gr,-n,-s,-1),vr("n2",i,e,gr,n,-s,-1),vr("n3",i,e,gr,-n,s,-1),vr("n4",i,e,gr,n,s,-1),vr("f1",i,e,gr,-n,-s,1),vr("f2",i,e,gr,n,-s,1),vr("f3",i,e,gr,-n,s,1),vr("f4",i,e,gr,n,s,1),vr("u1",i,e,gr,n*.7,s*1.1,-1),vr("u2",i,e,gr,-n*.7,s*1.1,-1),vr("u3",i,e,gr,0,s*2,-1),vr("cf1",i,e,gr,-n,0,1),vr("cf2",i,e,gr,n,0,1),vr("cf3",i,e,gr,0,-s,1),vr("cf4",i,e,gr,0,s,1),vr("cn1",i,e,gr,-n,0,-1),vr("cn2",i,e,gr,n,0,-1),vr("cn3",i,e,gr,0,-s,-1),vr("cn4",i,e,gr,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function vr(l,e,i,n,s,a,d){Gu.set(s,a,d).unproject(n);const v=e[l];if(v!==void 0){const I=i.getAttribute("position");for(let R=0,O=v.length;R<O;R++)I.setXYZ(v[R],Gu.x,Gu.y,Gu.z)}}const Vu=new hr;class _2 extends fo{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),a=new on;a.setIndex(new zn(n,1)),a.setAttribute("position",new zn(s,3)),super(a,new ds({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Vu.setFromObject(this.object),Vu.isEmpty())return;const i=Vu.min,n=Vu.max,s=this.geometry.attributes.position,a=s.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=i.x,a[4]=n.y,a[5]=n.z,a[6]=i.x,a[7]=i.y,a[8]=n.z,a[9]=n.x,a[10]=i.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=i.z,a[15]=i.x,a[16]=n.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=n.x,a[22]=i.y,a[23]=i.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,i){return super.copy(e,i),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class S2 extends fo{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],a=new on;a.setIndex(new zn(n,1)),a.setAttribute("position",new xi(s,3)),super(a,new ds({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class T2 extends ea{constructor(e,i=1,n=16776960){const s=n,a=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],d=new on;d.setAttribute("position",new xi(a,3)),d.computeBoundingSphere(),super(d,new ds({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const v=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],I=new on;I.setAttribute("position",new xi(v,3)),I.computeBoundingSphere(),this.add(new wr(I,new Yo({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const b0=new Ie;let zu,Rp;class I2 extends Ln{constructor(e=new Ie(0,0,1),i=new Ie(0,0,0),n=1,s=16776960,a=n*.2,d=a*.2){super(),this.type="ArrowHelper",zu===void 0&&(zu=new on,zu.setAttribute("position",new xi([0,0,0,0,1,0],3)),Rp=new Ll(0,.5,1,5,1),Rp.translate(0,-.5,0)),this.position.copy(i),this.line=new ea(zu,new ds({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new wr(Rp,new Yo({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,a,d)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{b0.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(b0,i)}}setLength(e,i=e*.2,n=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(n,i,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class B2 extends fo{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new on;s.setAttribute("position",new xi(i,3)),s.setAttribute("color",new xi(n,3));const a=new ds({vertexColors:!0,toneMapped:!1});super(s,a),this.type="AxesHelper"}setColors(e,i,n){const s=new li,a=this.geometry.attributes.color.array;return s.set(e),s.toArray(a,0),s.toArray(a,3),s.set(i),s.toArray(a,6),s.toArray(a,9),s.set(n),s.toArray(a,12),s.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class R2{constructor(){this.type="ShapePath",this.color=new li,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new Rc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,n,s){return this.currentPath.quadraticCurveTo(e,i,n,s),this}bezierCurveTo(e,i,n,s,a,d){return this.currentPath.bezierCurveTo(e,i,n,s,a,d),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(Q){const ge=[];for(let Ae=0,he=Q.length;Ae<he;Ae++){const Qe=Q[Ae],Be=new Oa;Be.curves=Qe.curves,ge.push(Be)}return ge}function n(Q,ge){const Ae=ge.length;let he=!1;for(let Qe=Ae-1,Be=0;Be<Ae;Qe=Be++){let Oe=ge[Qe],Ve=ge[Be],_e=Ve.x-Oe.x,xe=Ve.y-Oe.y;if(Math.abs(xe)>Number.EPSILON){if(xe<0&&(Oe=ge[Be],_e=-_e,Ve=ge[Qe],xe=-xe),Q.y<Oe.y||Q.y>Ve.y)continue;if(Q.y===Oe.y){if(Q.x===Oe.x)return!0}else{const ze=xe*(Q.x-Oe.x)-_e*(Q.y-Oe.y);if(ze===0)return!0;if(ze<0)continue;he=!he}}else{if(Q.y!==Oe.y)continue;if(Ve.x<=Q.x&&Q.x<=Oe.x||Oe.x<=Q.x&&Q.x<=Ve.x)return!0}}return he}const s=po.isClockWise,a=this.subPaths;if(a.length===0)return[];let d,v,I;const R=[];if(a.length===1)return v=a[0],I=new Oa,I.curves=v.curves,R.push(I),R;let O=!s(a[0].getPoints());O=e?!O:O;const k=[],G=[];let z=[],K=0,ee;G[K]=void 0,z[K]=[];for(let Q=0,ge=a.length;Q<ge;Q++)v=a[Q],ee=v.getPoints(),d=s(ee),d=e?!d:d,d?(!O&&G[K]&&K++,G[K]={s:new Oa,p:ee},G[K].s.curves=v.curves,O&&K++,z[K]=[]):z[K].push({h:v,p:ee[0]});if(!G[0])return i(a);if(G.length>1){let Q=!1,ge=0;for(let Ae=0,he=G.length;Ae<he;Ae++)k[Ae]=[];for(let Ae=0,he=G.length;Ae<he;Ae++){const Qe=z[Ae];for(let Be=0;Be<Qe.length;Be++){const Oe=Qe[Be];let Ve=!0;for(let _e=0;_e<G.length;_e++)n(Oe.p,G[_e].p)&&(Ae!==_e&&ge++,Ve?(Ve=!1,k[_e].push(Oe)):Q=!0);Ve&&k[Ae].push(Oe)}}ge>0&&Q===!1&&(z=k)}let X;for(let Q=0,ge=G.length;Q<ge;Q++){I=G[Q].s,R.push(I),X=z[Q];for(let Ae=0,he=X.length;Ae<he;Ae++)I.holes.push(X[Ae].h)}return R}}class L2 extends ys{constructor(e=1,i=1,n=1,s={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,i,{...s,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:f}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=f)},"./node_modules/three/examples/jsm/libs/ktx-parse.module.js":(m,M,h)=>{h.r(M),h.d(M,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>Cr,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>cn,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>wn,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>bn,KHR_DF_CHANNEL_RGBSDA_RED:()=>rr,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>Kn,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>U,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>D,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>E,KHR_DF_MODEL_ASTC:()=>L,KHR_DF_MODEL_ETC1:()=>w,KHR_DF_MODEL_ETC1S:()=>P,KHR_DF_MODEL_ETC2:()=>S,KHR_DF_MODEL_RGBSDA:()=>_,KHR_DF_MODEL_UNSPECIFIED:()=>T,KHR_DF_PRIMARIES_ACES:()=>Ni,KHR_DF_PRIMARIES_ACESCC:()=>Oi,KHR_DF_PRIMARIES_ADOBERGB:()=>gn,KHR_DF_PRIMARIES_BT2020:()=>gi,KHR_DF_PRIMARIES_BT601_EBU:()=>Vt,KHR_DF_PRIMARIES_BT601_SMPTE:()=>Yt,KHR_DF_PRIMARIES_BT709:()=>Et,KHR_DF_PRIMARIES_CIEXYZ:()=>Ri,KHR_DF_PRIMARIES_DISPLAYP3:()=>Cn,KHR_DF_PRIMARIES_NTSC1953:()=>yi,KHR_DF_PRIMARIES_PAL525:()=>zi,KHR_DF_PRIMARIES_UNSPECIFIED:()=>Gt,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>St,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>ar,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>ye,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>Tn,KHR_DF_TRANSFER_ACESCC:()=>Je,KHR_DF_TRANSFER_ACESCCT:()=>pt,KHR_DF_TRANSFER_ADOBERGB:()=>yt,KHR_DF_TRANSFER_BT1886:()=>se,KHR_DF_TRANSFER_DCIP3:()=>Me,KHR_DF_TRANSFER_HLG_EOTF:()=>H,KHR_DF_TRANSFER_HLG_OETF:()=>J,KHR_DF_TRANSFER_ITU:()=>oe,KHR_DF_TRANSFER_LINEAR:()=>j,KHR_DF_TRANSFER_NTSC:()=>te,KHR_DF_TRANSFER_PAL625_EOTF:()=>Ge,KHR_DF_TRANSFER_PAL_OETF:()=>De,KHR_DF_TRANSFER_PQ_EOTF:()=>ae,KHR_DF_TRANSFER_PQ_OETF:()=>ue,KHR_DF_TRANSFER_SLOG:()=>pe,KHR_DF_TRANSFER_SLOG2:()=>de,KHR_DF_TRANSFER_SRGB:()=>Y,KHR_DF_TRANSFER_ST240:()=>Xe,KHR_DF_TRANSFER_UNSPECIFIED:()=>F,KHR_DF_VENDORID_KHRONOS:()=>b,KHR_DF_VERSION:()=>x,KHR_SUPERCOMPRESSION_BASISLZ:()=>p,KHR_SUPERCOMPRESSION_NONE:()=>C,KHR_SUPERCOMPRESSION_ZLIB:()=>u,KHR_SUPERCOMPRESSION_ZSTD:()=>g,KTX2Container:()=>xo,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>fe,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>pi,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>qt,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>mt,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>oi,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>Bt,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>nt,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>At,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>ht,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>fc,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>Ho,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>il,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>or,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>ls,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>wh,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>as,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>Ca,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>Mh,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>Eh,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Nr,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>_h,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>zo,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Eo,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>Ef,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>tf,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>uc,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>Fn,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>ba,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>nf,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>ji,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>gh,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>mh,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>dc,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>yh,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>vh,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>xh,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>Wd,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>xa,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>yf,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>Xd,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>Kd,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>Qo,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>qd,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>Yd,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>wa,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>Zd,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>Jd,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>Ch,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>ef,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>$d,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>bh,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>Ns,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>hc,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>js,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>lf,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>ff,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>Re,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>V,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>$,VK_FORMAT_B8G8R8A8_SINT:()=>Ne,VK_FORMAT_B8G8R8A8_SNORM:()=>Fs,VK_FORMAT_B8G8R8A8_SRGB:()=>Ye,VK_FORMAT_B8G8R8A8_UINT:()=>we,VK_FORMAT_B8G8R8A8_UNORM:()=>oo,VK_FORMAT_B8G8R8_SINT:()=>gs,VK_FORMAT_B8G8R8_SNORM:()=>sr,VK_FORMAT_B8G8R8_SRGB:()=>Tr,VK_FORMAT_B8G8R8_UINT:()=>Qr,VK_FORMAT_B8G8R8_UNORM:()=>ms,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>jn,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>va,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>ga,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>tl,VK_FORMAT_BC2_SRGB_BLOCK:()=>Ea,VK_FORMAT_BC2_UNORM_BLOCK:()=>ya,VK_FORMAT_BC3_SRGB_BLOCK:()=>yo,VK_FORMAT_BC3_UNORM_BLOCK:()=>Ld,VK_FORMAT_BC4_SNORM_BLOCK:()=>Pd,VK_FORMAT_BC4_UNORM_BLOCK:()=>Dd,VK_FORMAT_BC5_SNORM_BLOCK:()=>Fd,VK_FORMAT_BC5_UNORM_BLOCK:()=>Od,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>kd,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>Nd,VK_FORMAT_BC7_SRGB_BLOCK:()=>Gd,VK_FORMAT_BC7_UNORM_BLOCK:()=>Ud,VK_FORMAT_D16_UNORM:()=>ao,VK_FORMAT_D16_UNORM_S8_UINT:()=>Hr,VK_FORMAT_D24_UNORM_S8_UINT:()=>yn,VK_FORMAT_D32_SFLOAT:()=>qr,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>Ws,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>vo,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>cc,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>Ah,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>ph,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>fh,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>Hd,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>Qd,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>lc,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>jd,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>zd,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>Vd,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>af,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>df,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>jr,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>pf,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Yi,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>Af,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>vf,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>mf,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>xt,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>gf,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>of,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>sf,VK_FORMAT_R10X6_UNORM_PACK16:()=>rf,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>uf,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>hf,VK_FORMAT_R12X4_UNORM_PACK16:()=>cf,VK_FORMAT_R16G16B16A16_SFLOAT:()=>ie,VK_FORMAT_R16G16B16A16_SINT:()=>q,VK_FORMAT_R16G16B16A16_SNORM:()=>Ee,VK_FORMAT_R16G16B16A16_UINT:()=>He,VK_FORMAT_R16G16B16A16_UNORM:()=>me,VK_FORMAT_R16G16B16_SFLOAT:()=>le,VK_FORMAT_R16G16B16_SINT:()=>Z,VK_FORMAT_R16G16B16_SNORM:()=>hn,VK_FORMAT_R16G16B16_UINT:()=>W,VK_FORMAT_R16G16B16_UNORM:()=>Zn,VK_FORMAT_R16G16_SFLOAT:()=>Xi,VK_FORMAT_R16G16_SINT:()=>Nt,VK_FORMAT_R16G16_SNORM:()=>Gn,VK_FORMAT_R16G16_UINT:()=>cr,VK_FORMAT_R16G16_UNORM:()=>sn,VK_FORMAT_R16_SFLOAT:()=>ki,VK_FORMAT_R16_SINT:()=>Ki,VK_FORMAT_R16_SNORM:()=>Li,VK_FORMAT_R16_UINT:()=>Mn,VK_FORMAT_R16_UNORM:()=>Ai,VK_FORMAT_R32G32B32A32_SFLOAT:()=>ni,VK_FORMAT_R32G32B32A32_SINT:()=>di,VK_FORMAT_R32G32B32A32_UINT:()=>_t,VK_FORMAT_R32G32B32_SFLOAT:()=>ft,VK_FORMAT_R32G32B32_SINT:()=>Ot,VK_FORMAT_R32G32B32_UINT:()=>dt,VK_FORMAT_R32G32_SFLOAT:()=>st,VK_FORMAT_R32G32_SINT:()=>Ze,VK_FORMAT_R32G32_UINT:()=>ke,VK_FORMAT_R32_SFLOAT:()=>re,VK_FORMAT_R32_SINT:()=>ne,VK_FORMAT_R32_UINT:()=>ce,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>Se,VK_FORMAT_R4G4_UNORM_PACK8:()=>Le,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>N,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>Pe,VK_FORMAT_R64G64B64A64_SFLOAT:()=>vs,VK_FORMAT_R64G64B64A64_SINT:()=>os,VK_FORMAT_R64G64B64A64_UINT:()=>Di,VK_FORMAT_R64G64B64_SFLOAT:()=>Hn,VK_FORMAT_R64G64B64_SINT:()=>Bi,VK_FORMAT_R64G64B64_UINT:()=>Ji,VK_FORMAT_R64G64_SFLOAT:()=>Hi,VK_FORMAT_R64G64_SINT:()=>Pi,VK_FORMAT_R64G64_UINT:()=>Ti,VK_FORMAT_R64_SFLOAT:()=>_i,VK_FORMAT_R64_SINT:()=>Xt,VK_FORMAT_R64_UINT:()=>Ei,VK_FORMAT_R8G8B8A8_SINT:()=>Hs,VK_FORMAT_R8G8B8A8_SNORM:()=>Bn,VK_FORMAT_R8G8B8A8_SRGB:()=>ss,VK_FORMAT_R8G8B8A8_UINT:()=>lr,VK_FORMAT_R8G8B8A8_UNORM:()=>Yn,VK_FORMAT_R8G8B8_SINT:()=>Yr,VK_FORMAT_R8G8B8_SNORM:()=>mn,VK_FORMAT_R8G8B8_SRGB:()=>Qn,VK_FORMAT_R8G8B8_UINT:()=>In,VK_FORMAT_R8G8B8_UNORM:()=>Xn,VK_FORMAT_R8G8_SINT:()=>Jn,VK_FORMAT_R8G8_SNORM:()=>Tt,VK_FORMAT_R8G8_SRGB:()=>wi,VK_FORMAT_R8G8_UINT:()=>ti,VK_FORMAT_R8G8_UNORM:()=>Lt,VK_FORMAT_R8_SINT:()=>Rt,VK_FORMAT_R8_SNORM:()=>Fe,VK_FORMAT_R8_SRGB:()=>zt,VK_FORMAT_R8_UINT:()=>We,VK_FORMAT_R8_UNORM:()=>be,VK_FORMAT_S8_UINT:()=>co,VK_FORMAT_UNDEFINED:()=>ve,VK_FORMAT_X8_D24_UNORM_PACK32:()=>lo,read:()=>_n,write:()=>sl});var f=h("./node_modules/buffer/index.js").Buffer;const C=0,p=1,g=2,u=3,E=0,b=0,x=2,T=0,_=1,w=160,S=161,L=162,P=163,D=0,U=1,F=0,j=1,Y=2,oe=3,te=4,pe=5,de=6,se=7,J=8,H=9,ae=10,ue=11,Me=12,De=13,Ge=14,Xe=15,Je=16,pt=17,yt=18,Gt=0,Et=1,Vt=2,Yt=3,gi=4,Ri=5,Ni=6,Oi=7,yi=8,zi=9,Cn=10,gn=11,rr=0,bn=1,cn=2,Kn=13,wn=14,Cr=15,ar=128,Tn=64,St=32,ye=16,ve=0,Le=1,Se=2,Re=3,Pe=4,$=5,N=6,V=7,fe=8,be=9,Fe=10,We=13,Rt=14,zt=15,Lt=16,Tt=17,ti=20,Jn=21,wi=22,Xn=23,mn=24,In=27,Yr=28,Qn=29,ms=30,sr=31,Qr=34,gs=35,Tr=36,Yn=37,Bn=38,lr=41,Hs=42,ss=43,oo=44,Fs=45,we=48,Ne=49,Ye=50,ht=58,nt=59,At=62,Bt=63,oi=64,qt=65,mt=68,pi=69,Ai=70,Li=71,Mn=74,Ki=75,ki=76,sn=77,Gn=78,cr=81,Nt=82,Xi=83,Zn=84,hn=85,W=88,Z=89,le=90,me=91,Ee=92,He=95,q=96,ie=97,ce=98,ne=99,re=100,ke=101,Ze=102,st=103,dt=104,Ot=105,ft=106,_t=107,di=108,ni=109,Ei=110,Xt=111,_i=112,Ti=113,Pi=114,Hi=115,Ji=116,Bi=117,Hn=118,Di=119,os=120,vs=121,js=122,vo=123,ao=124,lo=125,qr=126,co=127,Hr=128,yn=129,Ws=130,tl=131,ga=132,va=133,jn=134,ya=135,Ea=136,Ld=137,yo=138,Dd=139,Pd=140,Od=141,Fd=142,Nd=143,kd=144,Ud=145,Gd=146,Vd=147,zd=148,Qd=149,Hd=150,jd=151,lc=152,fh=153,ph=154,Ah=155,cc=156,mh=157,gh=158,vh=159,yh=160,xa=161,Wd=162,Kd=163,Xd=164,Yd=165,qd=166,Jd=167,Zd=168,$d=169,ef=170,hc=171,Ns=172,Ca=173,as=174,Nr=175,Eh=176,Eo=177,zo=178,ls=179,or=180,uc=181,tf=182,nf=183,ba=184,rf=1000156007,sf=1000156008,of=1000156009,af=1000156010,lf=1000156011,cf=1000156017,hf=1000156018,uf=1000156019,df=1000156020,ff=1000156021,pf=1000054e3,Af=1000054001,mf=1000054002,gf=1000054003,jr=1000054004,Yi=1000054005,vf=1000054006,xt=1000054007,ji=1000066e3,dc=1000066001,xh=1000066002,yf=1000066003,Qo=1000066004,wa=1000066005,Ch=1000066006,bh=1000066007,wh=1000066008,Mh=1000066009,_h=1000066010,il=1000066011,Ef=1000066012,Fn=1000066013,Ho=100034e4,fc=1000340001;class xo{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class jo{constructor(Wi,vn,Rn,Ie){this._dataView=new DataView(Wi.buffer,Wi.byteOffset+vn,Rn),this._littleEndian=Ie,this._offset=0}_nextUint8(){const Wi=this._dataView.getUint8(this._offset);return this._offset+=1,Wi}_nextUint16(){const Wi=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,Wi}_nextUint32(){const Wi=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,Wi}_nextUint64(){const Wi=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,Wi}_nextInt32(){const Wi=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,Wi}_skip(Wi){return this._offset+=Wi,this}_scan(Wi,vn=0){const Rn=this._offset;let Ie=0;for(;this._dataView.getUint8(this._offset)!==vn&&Ie<Wi;)Ie++,this._offset++;return Ie<Wi&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+Rn,Ie)}}const Sh=new Uint8Array([0]),tr=[171,75,84,88,32,50,48,187,13,10,26,10];function nl(ui){return typeof TextEncoder<"u"?new TextEncoder().encode(ui):f.from(ui)}function Th(ui){return typeof TextDecoder<"u"?new TextDecoder().decode(ui):f.from(ui).toString("utf8")}function qn(ui){let Wi=0;for(const Ie of ui)Wi+=Ie.byteLength;const vn=new Uint8Array(Wi);let Rn=0;for(const Ie of ui)vn.set(new Uint8Array(Ie),Rn),Rn+=Ie.byteLength;return vn}function _n(ui){const Wi=new Uint8Array(ui.buffer,ui.byteOffset,tr.length);if(Wi[0]!==tr[0]||Wi[1]!==tr[1]||Wi[2]!==tr[2]||Wi[3]!==tr[3]||Wi[4]!==tr[4]||Wi[5]!==tr[5]||Wi[6]!==tr[6]||Wi[7]!==tr[7]||Wi[8]!==tr[8]||Wi[9]!==tr[9]||Wi[10]!==tr[10]||Wi[11]!==tr[11])throw new Error("Missing KTX 2.0 identifier.");const vn=new xo,Rn=17*Uint32Array.BYTES_PER_ELEMENT,Ie=new jo(ui,tr.length,Rn,!0);vn.vkFormat=Ie._nextUint32(),vn.typeSize=Ie._nextUint32(),vn.pixelWidth=Ie._nextUint32(),vn.pixelHeight=Ie._nextUint32(),vn.pixelDepth=Ie._nextUint32(),vn.layerCount=Ie._nextUint32(),vn.faceCount=Ie._nextUint32();const _s=Ie._nextUint32();vn.supercompressionScheme=Ie._nextUint32();const mr=Ie._nextUint32(),hr=Ie._nextUint32(),An=Ie._nextUint32(),Jr=Ie._nextUint32(),ho=Ie._nextUint64(),Es=Ie._nextUint64(),kr=new jo(ui,tr.length+Rn,3*_s*8,!0);for(let Br=0;Br<_s;Br++)vn.levels.push({levelData:new Uint8Array(ui.buffer,ui.byteOffset+kr._nextUint64(),kr._nextUint64()),uncompressedByteLength:kr._nextUint64()});const $i=new jo(ui,mr,hr,!0),Wr={vendorId:$i._skip(4)._nextUint16(),descriptorType:$i._nextUint16(),versionNumber:$i._nextUint16(),descriptorBlockSize:$i._nextUint16(),colorModel:$i._nextUint8(),colorPrimaries:$i._nextUint8(),transferFunction:$i._nextUint8(),flags:$i._nextUint8(),texelBlockDimension:[$i._nextUint8(),$i._nextUint8(),$i._nextUint8(),$i._nextUint8()],bytesPlane:[$i._nextUint8(),$i._nextUint8(),$i._nextUint8(),$i._nextUint8(),$i._nextUint8(),$i._nextUint8(),$i._nextUint8(),$i._nextUint8()],samples:[]},Ss=(Wr.descriptorBlockSize/4-6)/4;for(let Br=0;Br<Ss;Br++){const mi={bitOffset:$i._nextUint16(),bitLength:$i._nextUint8(),channelType:$i._nextUint8(),samplePosition:[$i._nextUint8(),$i._nextUint8(),$i._nextUint8(),$i._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&mi.channelType?(mi.sampleLower=$i._nextInt32(),mi.sampleUpper=$i._nextInt32()):(mi.sampleLower=$i._nextUint32(),mi.sampleUpper=$i._nextUint32()),Wr.samples[Br]=mi}vn.dataFormatDescriptor.length=0,vn.dataFormatDescriptor.push(Wr);const Ur=new jo(ui,An,Jr,!0);for(;Ur._offset<Jr;){const Br=Ur._nextUint32(),mi=Ur._scan(Br),bo=Th(mi),xs=Ur._scan(Br-mi.byteLength);vn.keyValue[bo]=bo.match(/^ktx/i)?Th(xs):xs,Ur._offset%4&&Ur._skip(4-Ur._offset%4)}if(Es<=0)return vn;const En=new jo(ui,ho,Es,!0),Vn=En._nextUint16(),en=En._nextUint16(),xn=En._nextUint32(),cs=En._nextUint32(),Wo=En._nextUint32(),Co=En._nextUint32(),ol=[];for(let Br=0;Br<_s;Br++)ol.push({imageFlags:En._nextUint32(),rgbSliceByteOffset:En._nextUint32(),rgbSliceByteLength:En._nextUint32(),alphaSliceByteOffset:En._nextUint32(),alphaSliceByteLength:En._nextUint32()});const Ir=ho+En._offset,ks=Ir+xn,al=ks+cs,ll=al+Wo,uo=new Uint8Array(ui.buffer,ui.byteOffset+Ir,xn),pc=new Uint8Array(ui.buffer,ui.byteOffset+ks,cs),cl=new Uint8Array(ui.buffer,ui.byteOffset+al,Wo),Ac=new Uint8Array(ui.buffer,ui.byteOffset+ll,Co);return vn.globalData={endpointCount:Vn,selectorCount:en,imageDescs:ol,endpointsData:uo,selectorsData:pc,tablesData:cl,extendedData:Ac},vn}function rl(){return(rl=Object.assign||function(ui){for(var Wi=1;Wi<arguments.length;Wi++){var vn=arguments[Wi];for(var Rn in vn)Object.prototype.hasOwnProperty.call(vn,Rn)&&(ui[Rn]=vn[Rn])}return ui}).apply(this,arguments)}const ys={keepWriter:!1};function sl(ui,Wi={}){Wi=rl({},ys,Wi);let vn=new ArrayBuffer(0);if(ui.globalData){const Vn=new ArrayBuffer(20+5*ui.globalData.imageDescs.length*4),en=new DataView(Vn);en.setUint16(0,ui.globalData.endpointCount,!0),en.setUint16(2,ui.globalData.selectorCount,!0),en.setUint32(4,ui.globalData.endpointsData.byteLength,!0),en.setUint32(8,ui.globalData.selectorsData.byteLength,!0),en.setUint32(12,ui.globalData.tablesData.byteLength,!0),en.setUint32(16,ui.globalData.extendedData.byteLength,!0);for(let xn=0;xn<ui.globalData.imageDescs.length;xn++){const cs=ui.globalData.imageDescs[xn];en.setUint32(20+5*xn*4+0,cs.imageFlags,!0),en.setUint32(20+5*xn*4+4,cs.rgbSliceByteOffset,!0),en.setUint32(20+5*xn*4+8,cs.rgbSliceByteLength,!0),en.setUint32(20+5*xn*4+12,cs.alphaSliceByteOffset,!0),en.setUint32(20+5*xn*4+16,cs.alphaSliceByteLength,!0)}vn=qn([Vn,ui.globalData.endpointsData,ui.globalData.selectorsData,ui.globalData.tablesData,ui.globalData.extendedData])}const Rn=[];let Ie=ui.keyValue;Wi.keepWriter||(Ie=rl({},ui.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const Vn in Ie){const en=Ie[Vn],xn=nl(Vn),cs=typeof en=="string"?nl(en):en,Wo=xn.byteLength+1+cs.byteLength+1,Co=Wo%4?4-Wo%4:0;Rn.push(qn([new Uint32Array([Wo]),xn,Sh,cs,Sh,new Uint8Array(Co).fill(0)]))}const _s=qn(Rn);if(ui.dataFormatDescriptor.length!==1||ui.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const mr=ui.dataFormatDescriptor[0],hr=new ArrayBuffer(28+16*mr.samples.length),An=new DataView(hr),Jr=24+16*mr.samples.length;if(An.setUint32(0,hr.byteLength,!0),An.setUint16(4,mr.vendorId,!0),An.setUint16(6,mr.descriptorType,!0),An.setUint16(8,mr.versionNumber,!0),An.setUint16(10,Jr,!0),An.setUint8(12,mr.colorModel),An.setUint8(13,mr.colorPrimaries),An.setUint8(14,mr.transferFunction),An.setUint8(15,mr.flags),!Array.isArray(mr.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");An.setUint8(16,mr.texelBlockDimension[0]),An.setUint8(17,mr.texelBlockDimension[1]),An.setUint8(18,mr.texelBlockDimension[2]),An.setUint8(19,mr.texelBlockDimension[3]);for(let Vn=0;Vn<8;Vn++)An.setUint8(20+Vn,mr.bytesPlane[Vn]);for(let Vn=0;Vn<mr.samples.length;Vn++){const en=mr.samples[Vn],xn=28+16*Vn;if(en.channelID)throw new Error("channelID has been renamed to channelType.");An.setUint16(xn+0,en.bitOffset,!0),An.setUint8(xn+2,en.bitLength),An.setUint8(xn+3,en.channelType),An.setUint8(xn+4,en.samplePosition[0]),An.setUint8(xn+5,en.samplePosition[1]),An.setUint8(xn+6,en.samplePosition[2]),An.setUint8(xn+7,en.samplePosition[3]),64&en.channelType?(An.setInt32(xn+8,en.sampleLower,!0),An.setInt32(xn+12,en.sampleUpper,!0)):(An.setUint32(xn+8,en.sampleLower,!0),An.setUint32(xn+12,en.sampleUpper,!0))}const ho=tr.length+68+3*ui.levels.length*8,Es=ho+hr.byteLength;let kr=vn.byteLength>0?Es+_s.byteLength:0;kr%8&&(kr+=8-kr%8);const $i=[],Wr=new DataView(new ArrayBuffer(3*ui.levels.length*8));let Ss=(kr||Es+_s.byteLength)+vn.byteLength;for(let Vn=0;Vn<ui.levels.length;Vn++){const en=ui.levels[Vn];$i.push(en.levelData),Wr.setBigUint64(24*Vn+0,BigInt(Ss),!0),Wr.setBigUint64(24*Vn+8,BigInt(en.levelData.byteLength),!0),Wr.setBigUint64(24*Vn+16,BigInt(en.uncompressedByteLength),!0),Ss+=en.levelData.byteLength}const Ur=new ArrayBuffer(68),En=new DataView(Ur);return En.setUint32(0,ui.vkFormat,!0),En.setUint32(4,ui.typeSize,!0),En.setUint32(8,ui.pixelWidth,!0),En.setUint32(12,ui.pixelHeight,!0),En.setUint32(16,ui.pixelDepth,!0),En.setUint32(20,ui.layerCount,!0),En.setUint32(24,ui.faceCount,!0),En.setUint32(28,ui.levels.length,!0),En.setUint32(32,ui.supercompressionScheme,!0),En.setUint32(36,ho,!0),En.setUint32(40,hr.byteLength,!0),En.setUint32(44,Es,!0),En.setUint32(48,_s.byteLength,!0),En.setBigUint64(52,BigInt(vn.byteLength>0?kr:0),!0),En.setBigUint64(60,BigInt(vn.byteLength),!0),new Uint8Array(qn([new Uint8Array(tr).buffer,Ur,Wr.buffer,hr,_s,kr>0?new ArrayBuffer(kr-(Es+_s.byteLength)):new ArrayBuffer(0),vn,...$i]))}},"./node_modules/three/examples/jsm/libs/zstddec.module.js":(m,M,h)=>{h.r(M),h.d(M,{ZSTDDecoder:()=>E});var f=h("./node_modules/buffer/index.js").Buffer;let C,p,g;const u={env:{emscripten_notify_memory_growth:function(x){g=new Uint8Array(p.exports.memory.buffer)}}};class E{init(){return C||(C=typeof fetch<"u"?fetch("data:application/wasm;base64,"+b).then(T=>T.arrayBuffer()).then(T=>WebAssembly.instantiate(T,u)).then(this._init):WebAssembly.instantiate(f.from(b,"base64"),u).then(this._init),C)}_init(T){p=T.instance,u.env.emscripten_notify_memory_growth(0)}decode(T,_=0){if(!p)throw new Error("ZSTDDecoder: Await .init() before decoding.");const w=T.byteLength,S=p.exports.malloc(w);g.set(T,S),_=_||Number(p.exports.ZSTD_findDecompressedSize(S,w));const L=p.exports.malloc(_),P=p.exports.ZSTD_decompress(L,_,S,w),D=g.slice(L,L+P);return p.exports.free(S),p.exports.free(L),D}}const b="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/three/examples/jsm/lights/LightProbeGenerator.js":(m,M,h)=>{h.r(M),h.d(M,{LightProbeGenerator:()=>C});var f=h("./node_modules/three/build/three.module.js");class C{static fromCubeTexture(u){let E=0;const b=new f.Vector3,x=new f.Vector3,T=new f.Color,_=[0,0,0,0,0,0,0,0,0],w=new f.SphericalHarmonics3,S=w.coefficients;for(let P=0;P<6;P++){const D=u.image[P],U=D.width,F=D.height,j=document.createElement("canvas");j.width=U,j.height=F;const Y=j.getContext("2d");Y.drawImage(D,0,0,U,F);const oe=Y.getImageData(0,0,U,F),te=oe.data,pe=oe.width,de=2/pe;for(let se=0,J=te.length;se<J;se+=4){T.setRGB(te[se]/255,te[se+1]/255,te[se+2]/255),p(T,u.colorSpace);const H=se/4,ae=-1+(H%pe+.5)*de,ue=1-(Math.floor(H/pe)+.5)*de;switch(P){case 0:b.set(-1,ue,-ae);break;case 1:b.set(1,ue,ae);break;case 2:b.set(-ae,1,-ue);break;case 3:b.set(-ae,-1,ue);break;case 4:b.set(-ae,ue,1);break;case 5:b.set(ae,ue,-1);break}const Me=b.lengthSq(),De=4/(Math.sqrt(Me)*Me);E+=De,x.copy(b).normalize(),f.SphericalHarmonics3.getBasisAt(x,_);for(let Ge=0;Ge<9;Ge++)S[Ge].x+=_[Ge]*T.r*De,S[Ge].y+=_[Ge]*T.g*De,S[Ge].z+=_[Ge]*T.b*De}}const L=4*Math.PI/E;for(let P=0;P<9;P++)S[P].x*=L,S[P].y*=L,S[P].z*=L;return new f.LightProbe(w)}static fromCubeRenderTarget(u,E){let b=0;const x=new f.Vector3,T=new f.Vector3,_=new f.Color,w=[0,0,0,0,0,0,0,0,0],S=new f.SphericalHarmonics3,L=S.coefficients,P=E.texture.type;for(let U=0;U<6;U++){const F=E.width;let j;P===f.HalfFloatType?j=new Uint16Array(F*F*4):j=new Uint8Array(F*F*4),u.readRenderTargetPixels(E,0,0,F,F,j,U);const Y=2/F;for(let oe=0,te=j.length;oe<te;oe+=4){let pe,de,se;P===f.HalfFloatType?(pe=f.DataUtils.fromHalfFloat(j[oe]),de=f.DataUtils.fromHalfFloat(j[oe+1]),se=f.DataUtils.fromHalfFloat(j[oe+2])):(pe=j[oe]/255,de=j[oe+1]/255,se=j[oe+2]/255),_.setRGB(pe,de,se),p(_,E.texture.colorSpace);const J=oe/4,H=-1+(J%F+.5)*Y,ae=1-(Math.floor(J/F)+.5)*Y;switch(U){case 0:x.set(1,ae,-H);break;case 1:x.set(-1,ae,H);break;case 2:x.set(H,1,-ae);break;case 3:x.set(H,-1,ae);break;case 4:x.set(H,ae,1);break;case 5:x.set(-H,ae,-1);break}const ue=x.lengthSq(),Me=4/(Math.sqrt(ue)*ue);b+=Me,T.copy(x).normalize(),f.SphericalHarmonics3.getBasisAt(T,w);for(let De=0;De<9;De++)L[De].x+=w[De]*_.r*Me,L[De].y+=w[De]*_.g*Me,L[De].z+=w[De]*_.b*Me}}const D=4*Math.PI/b;for(let U=0;U<9;U++)L[U].x*=D,L[U].y*=D,L[U].z*=D;return new f.LightProbe(S)}}function p(g,u){switch(u){case f.SRGBColorSpace:g.convertSRGBToLinear();break;case f.LinearSRGBColorSpace:case f.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return g}},"./node_modules/three/examples/jsm/loaders/DRACOLoader.js":(m,M,h)=>{h.r(M),h.d(M,{DRACOLoader:()=>p});var f=h("./node_modules/three/build/three.module.js");const C=new WeakMap;class p extends f.Loader{constructor(E){super(E),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(E){return this.decoderPath=E,this}setDecoderConfig(E){return this.decoderConfig=E,this}setWorkerLimit(E){return this.workerLimit=E,this}load(E,b,x,T){const _=new f.FileLoader(this.manager);_.setPath(this.path),_.setResponseType("arraybuffer"),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials),_.load(E,w=>{this.parse(w,b,T)},x,T)}parse(E,b,x=()=>{}){this.decodeDracoFile(E,b,null,null,f.SRGBColorSpace).catch(x)}decodeDracoFile(E,b,x,T,_=f.LinearSRGBColorSpace,w=()=>{}){const S={attributeIDs:x||this.defaultAttributeIDs,attributeTypes:T||this.defaultAttributeTypes,useUniqueIDs:!!x,vertexColorSpace:_};return this.decodeGeometry(E,S).then(b).catch(w)}decodeGeometry(E,b){const x=JSON.stringify(b);if(C.has(E)){const L=C.get(E);if(L.key===x)return L.promise;if(E.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let T;const _=this.workerNextTaskID++,w=E.byteLength,S=this._getWorker(_,w).then(L=>(T=L,new Promise((P,D)=>{T._callbacks[_]={resolve:P,reject:D},T.postMessage({type:"decode",id:_,taskConfig:b,buffer:E},[E])}))).then(L=>this._createGeometry(L.geometry));return S.catch(()=>!0).then(()=>{T&&_&&this._releaseTask(T,_)}),C.set(E,{key:x,promise:S}),S}_createGeometry(E){const b=new f.BufferGeometry;E.index&&b.setIndex(new f.BufferAttribute(E.index.array,1));for(let x=0;x<E.attributes.length;x++){const T=E.attributes[x],_=T.name,w=T.array,S=T.itemSize,L=new f.BufferAttribute(w,S);_==="color"&&(this._assignVertexColorSpace(L,T.vertexColorSpace),L.normalized=!(w instanceof Float32Array)),b.setAttribute(_,L)}return b}_assignVertexColorSpace(E,b){if(b!==f.SRGBColorSpace)return;const x=new f.Color;for(let T=0,_=E.count;T<_;T++)x.fromBufferAttribute(E,T).convertSRGBToLinear(),E.setXYZ(T,x.r,x.g,x.b)}_loadLibrary(E,b){const x=new f.FileLoader(this.manager);return x.setPath(this.decoderPath),x.setResponseType(b),x.setWithCredentials(this.withCredentials),new Promise((T,_)=>{x.load(E,T,void 0,_)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const E=typeof WebAssembly!="object"||this.decoderConfig.type==="js",b=[];return E?b.push(this._loadLibrary("draco_decoder.js","text")):(b.push(this._loadLibrary("draco_wasm_wrapper.js","text")),b.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(b).then(x=>{const T=x[0];E||(this.decoderConfig.wasmBinary=x[1]);const _=g.toString(),w=["/* draco decoder */",T,"","/* worker */",_.substring(_.indexOf("{")+1,_.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([w]))}),this.decoderPending}_getWorker(E,b){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const T=new Worker(this.workerSourceURL);T._callbacks={},T._taskCosts={},T._taskLoad=0,T.postMessage({type:"init",decoderConfig:this.decoderConfig}),T.onmessage=function(_){const w=_.data;switch(w.type){case"decode":T._callbacks[w.id].resolve(w);break;case"error":T._callbacks[w.id].reject(w);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+w.type+'"')}},this.workerPool.push(T)}else this.workerPool.sort(function(T,_){return T._taskLoad>_._taskLoad?-1:1});const x=this.workerPool[this.workerPool.length-1];return x._taskCosts[E]=b,x._taskLoad+=b,x})}_releaseTask(E,b){E._taskLoad-=E._taskCosts[b],delete E._callbacks[b],delete E._taskCosts[b]}debug(){console.log("Task load: ",this.workerPool.map(E=>E._taskLoad))}dispose(){for(let E=0;E<this.workerPool.length;++E)this.workerPool[E].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function g(){let u,E;onmessage=function(w){const S=w.data;switch(S.type){case"init":u=S.decoderConfig,E=new Promise(function(D){u.onModuleLoaded=function(U){D({draco:U})},DracoDecoderModule(u)});break;case"decode":const L=S.buffer,P=S.taskConfig;E.then(D=>{const U=D.draco,F=new U.Decoder;try{const j=b(U,F,new Int8Array(L),P),Y=j.attributes.map(oe=>oe.array.buffer);j.index&&Y.push(j.index.array.buffer),self.postMessage({type:"decode",id:S.id,geometry:j},Y)}catch(j){console.error(j),self.postMessage({type:"error",id:S.id,error:j.message})}finally{U.destroy(F)}});break}};function b(w,S,L,P){const D=P.attributeIDs,U=P.attributeTypes;let F,j;const Y=S.GetEncodedGeometryType(L);if(Y===w.TRIANGULAR_MESH)F=new w.Mesh,j=S.DecodeArrayToMesh(L,L.byteLength,F);else if(Y===w.POINT_CLOUD)F=new w.PointCloud,j=S.DecodeArrayToPointCloud(L,L.byteLength,F);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!j.ok()||F.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+j.error_msg());const oe={index:null,attributes:[]};for(const te in D){const pe=self[U[te]];let de,se;if(P.useUniqueIDs)se=D[te],de=S.GetAttributeByUniqueId(F,se);else{if(se=S.GetAttributeId(F,w[D[te]]),se===-1)continue;de=S.GetAttribute(F,se)}const J=T(w,S,F,te,pe,de);te==="color"&&(J.vertexColorSpace=P.vertexColorSpace),oe.attributes.push(J)}return Y===w.TRIANGULAR_MESH&&(oe.index=x(w,S,F)),w.destroy(F),oe}function x(w,S,L){const D=L.num_faces()*3,U=D*4,F=w._malloc(U);S.GetTrianglesUInt32Array(L,U,F);const j=new Uint32Array(w.HEAPF32.buffer,F,D).slice();return w._free(F),{array:j,itemSize:1}}function T(w,S,L,P,D,U){const F=U.num_components(),Y=L.num_points()*F,oe=Y*D.BYTES_PER_ELEMENT,te=_(w,D),pe=w._malloc(oe);S.GetAttributeDataArrayForAllPoints(L,U,te,oe,pe);const de=new D(w.HEAPF32.buffer,pe,Y).slice();return w._free(pe),{name:P,array:de,itemSize:F}}function _(w,S){switch(S){case Float32Array:return w.DT_FLOAT32;case Int8Array:return w.DT_INT8;case Int16Array:return w.DT_INT16;case Int32Array:return w.DT_INT32;case Uint8Array:return w.DT_UINT8;case Uint16Array:return w.DT_UINT16;case Uint32Array:return w.DT_UINT32}}}},"./node_modules/three/examples/jsm/loaders/GLTFLoader.js":(m,M,h)=>{h.r(M),h.d(M,{GLTFLoader:()=>p});var f=h("./node_modules/three/build/three.module.js"),C=h("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");class p extends f.Loader{constructor(ye){super(ye),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ve){return new T(ve)}),this.register(function(ve){return new _(ve)}),this.register(function(ve){return new Y(ve)}),this.register(function(ve){return new oe(ve)}),this.register(function(ve){return new te(ve)}),this.register(function(ve){return new S(ve)}),this.register(function(ve){return new L(ve)}),this.register(function(ve){return new P(ve)}),this.register(function(ve){return new D(ve)}),this.register(function(ve){return new x(ve)}),this.register(function(ve){return new U(ve)}),this.register(function(ve){return new w(ve)}),this.register(function(ve){return new j(ve)}),this.register(function(ve){return new F(ve)}),this.register(function(ve){return new E(ve)}),this.register(function(ve){return new pe(ve)}),this.register(function(ve){return new de(ve)})}load(ye,ve,Le,Se){const Re=this;let Pe;if(this.resourcePath!=="")Pe=this.resourcePath;else if(this.path!==""){const V=f.LoaderUtils.extractUrlBase(ye);Pe=f.LoaderUtils.resolveURL(V,this.path)}else Pe=f.LoaderUtils.extractUrlBase(ye);this.manager.itemStart(ye);const $=function(V){Se?Se(V):console.error(V),Re.manager.itemError(ye),Re.manager.itemEnd(ye)},N=new f.FileLoader(this.manager);N.setPath(this.path),N.setResponseType("arraybuffer"),N.setRequestHeader(this.requestHeader),N.setWithCredentials(this.withCredentials),N.load(ye,function(V){try{Re.parse(V,Pe,function(fe){ve(fe),Re.manager.itemEnd(ye)},$)}catch(fe){$(fe)}},Le,$)}setDRACOLoader(ye){return this.dracoLoader=ye,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(ye){return this.ktx2Loader=ye,this}setMeshoptDecoder(ye){return this.meshoptDecoder=ye,this}register(ye){return this.pluginCallbacks.indexOf(ye)===-1&&this.pluginCallbacks.push(ye),this}unregister(ye){return this.pluginCallbacks.indexOf(ye)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ye),1),this}parse(ye,ve,Le,Se){let Re;const Pe={},$={},N=new TextDecoder;if(typeof ye=="string")Re=JSON.parse(ye);else if(ye instanceof ArrayBuffer)if(N.decode(new Uint8Array(ye,0,4))===se){try{Pe[u.KHR_BINARY_GLTF]=new ae(ye)}catch(be){Se&&Se(be);return}Re=JSON.parse(Pe[u.KHR_BINARY_GLTF].content)}else Re=JSON.parse(N.decode(ye));else Re=ye;if(Re.asset===void 0||Re.asset.version[0]<2){Se&&Se(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const V=new Cr(Re,{path:ve||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});V.fileLoader.setRequestHeader(this.requestHeader);for(let fe=0;fe<this.pluginCallbacks.length;fe++){const be=this.pluginCallbacks[fe](V);be.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),$[be.name]=be,Pe[be.name]=!0}if(Re.extensionsUsed)for(let fe=0;fe<Re.extensionsUsed.length;++fe){const be=Re.extensionsUsed[fe],Fe=Re.extensionsRequired||[];switch(be){case u.KHR_MATERIALS_UNLIT:Pe[be]=new b;break;case u.KHR_DRACO_MESH_COMPRESSION:Pe[be]=new ue(Re,this.dracoLoader);break;case u.KHR_TEXTURE_TRANSFORM:Pe[be]=new Me;break;case u.KHR_MESH_QUANTIZATION:Pe[be]=new De;break;default:Fe.indexOf(be)>=0&&$[be]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+be+'".')}}V.setExtensions(Pe),V.setPlugins($),V.parse(Le,Se)}parseAsync(ye,ve){const Le=this;return new Promise(function(Se,Re){Le.parse(ye,ve,Se,Re)})}}function g(){let St={};return{get:function(ye){return St[ye]},add:function(ye,ve){St[ye]=ve},remove:function(ye){delete St[ye]},removeAll:function(){St={}}}}const u={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class E{constructor(ye){this.parser=ye,this.name=u.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const ye=this.parser,ve=this.parser.json.nodes||[];for(let Le=0,Se=ve.length;Le<Se;Le++){const Re=ve[Le];Re.extensions&&Re.extensions[this.name]&&Re.extensions[this.name].light!==void 0&&ye._addNodeRef(this.cache,Re.extensions[this.name].light)}}_loadLight(ye){const ve=this.parser,Le="light:"+ye;let Se=ve.cache.get(Le);if(Se)return Se;const Re=ve.json,N=((Re.extensions&&Re.extensions[this.name]||{}).lights||[])[ye];let V;const fe=new f.Color(16777215);N.color!==void 0&&fe.setRGB(N.color[0],N.color[1],N.color[2],f.LinearSRGBColorSpace);const be=N.range!==void 0?N.range:0;switch(N.type){case"directional":V=new f.DirectionalLight(fe),V.target.position.set(0,0,-1),V.add(V.target);break;case"point":V=new f.PointLight(fe),V.distance=be;break;case"spot":V=new f.SpotLight(fe),V.distance=be,N.spot=N.spot||{},N.spot.innerConeAngle=N.spot.innerConeAngle!==void 0?N.spot.innerConeAngle:0,N.spot.outerConeAngle=N.spot.outerConeAngle!==void 0?N.spot.outerConeAngle:Math.PI/4,V.angle=N.spot.outerConeAngle,V.penumbra=1-N.spot.innerConeAngle/N.spot.outerConeAngle,V.target.position.set(0,0,-1),V.add(V.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+N.type)}return V.position.set(0,0,0),V.decay=2,zi(V,N),N.intensity!==void 0&&(V.intensity=N.intensity),V.name=ve.createUniqueName(N.name||"light_"+ye),Se=Promise.resolve(V),ve.cache.add(Le,Se),Se}getDependency(ye,ve){if(ye==="light")return this._loadLight(ve)}createNodeAttachment(ye){const ve=this,Le=this.parser,Re=Le.json.nodes[ye],$=(Re.extensions&&Re.extensions[this.name]||{}).light;return $===void 0?null:this._loadLight($).then(function(N){return Le._getNodeRef(ve.cache,$,N)})}}class b{constructor(){this.name=u.KHR_MATERIALS_UNLIT}getMaterialType(){return f.MeshBasicMaterial}extendParams(ye,ve,Le){const Se=[];ye.color=new f.Color(1,1,1),ye.opacity=1;const Re=ve.pbrMetallicRoughness;if(Re){if(Array.isArray(Re.baseColorFactor)){const Pe=Re.baseColorFactor;ye.color.setRGB(Pe[0],Pe[1],Pe[2],f.LinearSRGBColorSpace),ye.opacity=Pe[3]}Re.baseColorTexture!==void 0&&Se.push(Le.assignTexture(ye,"map",Re.baseColorTexture,f.SRGBColorSpace))}return Promise.all(Se)}}class x{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(ye,ve){const Se=this.parser.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=Se.extensions[this.name].emissiveStrength;return Re!==void 0&&(ve.emissiveIntensity=Re),Promise.resolve()}}class T{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_CLEARCOAT}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Pe=Se.extensions[this.name];if(Pe.clearcoatFactor!==void 0&&(ve.clearcoat=Pe.clearcoatFactor),Pe.clearcoatTexture!==void 0&&Re.push(Le.assignTexture(ve,"clearcoatMap",Pe.clearcoatTexture)),Pe.clearcoatRoughnessFactor!==void 0&&(ve.clearcoatRoughness=Pe.clearcoatRoughnessFactor),Pe.clearcoatRoughnessTexture!==void 0&&Re.push(Le.assignTexture(ve,"clearcoatRoughnessMap",Pe.clearcoatRoughnessTexture)),Pe.clearcoatNormalTexture!==void 0&&(Re.push(Le.assignTexture(ve,"clearcoatNormalMap",Pe.clearcoatNormalTexture)),Pe.clearcoatNormalTexture.scale!==void 0)){const $=Pe.clearcoatNormalTexture.scale;ve.clearcoatNormalScale=new f.Vector2($,$)}return Promise.all(Re)}}class _{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_DISPERSION}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Se=this.parser.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=Se.extensions[this.name];return ve.dispersion=Re.dispersion!==void 0?Re.dispersion:0,Promise.resolve()}}class w{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_IRIDESCENCE}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Pe=Se.extensions[this.name];return Pe.iridescenceFactor!==void 0&&(ve.iridescence=Pe.iridescenceFactor),Pe.iridescenceTexture!==void 0&&Re.push(Le.assignTexture(ve,"iridescenceMap",Pe.iridescenceTexture)),Pe.iridescenceIor!==void 0&&(ve.iridescenceIOR=Pe.iridescenceIor),ve.iridescenceThicknessRange===void 0&&(ve.iridescenceThicknessRange=[100,400]),Pe.iridescenceThicknessMinimum!==void 0&&(ve.iridescenceThicknessRange[0]=Pe.iridescenceThicknessMinimum),Pe.iridescenceThicknessMaximum!==void 0&&(ve.iridescenceThicknessRange[1]=Pe.iridescenceThicknessMaximum),Pe.iridescenceThicknessTexture!==void 0&&Re.push(Le.assignTexture(ve,"iridescenceThicknessMap",Pe.iridescenceThicknessTexture)),Promise.all(Re)}}class S{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_SHEEN}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[];ve.sheenColor=new f.Color(0,0,0),ve.sheenRoughness=0,ve.sheen=1;const Pe=Se.extensions[this.name];if(Pe.sheenColorFactor!==void 0){const $=Pe.sheenColorFactor;ve.sheenColor.setRGB($[0],$[1],$[2],f.LinearSRGBColorSpace)}return Pe.sheenRoughnessFactor!==void 0&&(ve.sheenRoughness=Pe.sheenRoughnessFactor),Pe.sheenColorTexture!==void 0&&Re.push(Le.assignTexture(ve,"sheenColorMap",Pe.sheenColorTexture,f.SRGBColorSpace)),Pe.sheenRoughnessTexture!==void 0&&Re.push(Le.assignTexture(ve,"sheenRoughnessMap",Pe.sheenRoughnessTexture)),Promise.all(Re)}}class L{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_TRANSMISSION}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Pe=Se.extensions[this.name];return Pe.transmissionFactor!==void 0&&(ve.transmission=Pe.transmissionFactor),Pe.transmissionTexture!==void 0&&Re.push(Le.assignTexture(ve,"transmissionMap",Pe.transmissionTexture)),Promise.all(Re)}}class P{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_VOLUME}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Pe=Se.extensions[this.name];ve.thickness=Pe.thicknessFactor!==void 0?Pe.thicknessFactor:0,Pe.thicknessTexture!==void 0&&Re.push(Le.assignTexture(ve,"thicknessMap",Pe.thicknessTexture)),ve.attenuationDistance=Pe.attenuationDistance||1/0;const $=Pe.attenuationColor||[1,1,1];return ve.attenuationColor=new f.Color().setRGB($[0],$[1],$[2],f.LinearSRGBColorSpace),Promise.all(Re)}}class D{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_IOR}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Se=this.parser.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=Se.extensions[this.name];return ve.ior=Re.ior!==void 0?Re.ior:1.5,Promise.resolve()}}class U{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_SPECULAR}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Pe=Se.extensions[this.name];ve.specularIntensity=Pe.specularFactor!==void 0?Pe.specularFactor:1,Pe.specularTexture!==void 0&&Re.push(Le.assignTexture(ve,"specularIntensityMap",Pe.specularTexture));const $=Pe.specularColorFactor||[1,1,1];return ve.specularColor=new f.Color().setRGB($[0],$[1],$[2],f.LinearSRGBColorSpace),Pe.specularColorTexture!==void 0&&Re.push(Le.assignTexture(ve,"specularColorMap",Pe.specularColorTexture,f.SRGBColorSpace)),Promise.all(Re)}}class F{constructor(ye){this.parser=ye,this.name=u.EXT_MATERIALS_BUMP}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Pe=Se.extensions[this.name];return ve.bumpScale=Pe.bumpFactor!==void 0?Pe.bumpFactor:1,Pe.bumpTexture!==void 0&&Re.push(Le.assignTexture(ve,"bumpMap",Pe.bumpTexture)),Promise.all(Re)}}class j{constructor(ye){this.parser=ye,this.name=u.KHR_MATERIALS_ANISOTROPY}getMaterialType(ye){const Le=this.parser.json.materials[ye];return!Le.extensions||!Le.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Se=Le.json.materials[ye];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Pe=Se.extensions[this.name];return Pe.anisotropyStrength!==void 0&&(ve.anisotropy=Pe.anisotropyStrength),Pe.anisotropyRotation!==void 0&&(ve.anisotropyRotation=Pe.anisotropyRotation),Pe.anisotropyTexture!==void 0&&Re.push(Le.assignTexture(ve,"anisotropyMap",Pe.anisotropyTexture)),Promise.all(Re)}}class Y{constructor(ye){this.parser=ye,this.name=u.KHR_TEXTURE_BASISU}loadTexture(ye){const ve=this.parser,Le=ve.json,Se=Le.textures[ye];if(!Se.extensions||!Se.extensions[this.name])return null;const Re=Se.extensions[this.name],Pe=ve.options.ktx2Loader;if(!Pe){if(Le.extensionsRequired&&Le.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ve.loadTextureImage(ye,Re.source,Pe)}}class oe{constructor(ye){this.parser=ye,this.name=u.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(ye){const ve=this.name,Le=this.parser,Se=Le.json,Re=Se.textures[ye];if(!Re.extensions||!Re.extensions[ve])return null;const Pe=Re.extensions[ve],$=Se.images[Pe.source];let N=Le.textureLoader;if($.uri){const V=Le.options.manager.getHandler($.uri);V!==null&&(N=V)}return this.detectSupport().then(function(V){if(V)return Le.loadTextureImage(ye,Pe.source,N);if(Se.extensionsRequired&&Se.extensionsRequired.indexOf(ve)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Le.loadTexture(ye)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ye){const ve=new Image;ve.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ve.onload=ve.onerror=function(){ye(ve.height===1)}})),this.isSupported}}class te{constructor(ye){this.parser=ye,this.name=u.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(ye){const ve=this.name,Le=this.parser,Se=Le.json,Re=Se.textures[ye];if(!Re.extensions||!Re.extensions[ve])return null;const Pe=Re.extensions[ve],$=Se.images[Pe.source];let N=Le.textureLoader;if($.uri){const V=Le.options.manager.getHandler($.uri);V!==null&&(N=V)}return this.detectSupport().then(function(V){if(V)return Le.loadTextureImage(ye,Pe.source,N);if(Se.extensionsRequired&&Se.extensionsRequired.indexOf(ve)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return Le.loadTexture(ye)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ye){const ve=new Image;ve.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",ve.onload=ve.onerror=function(){ye(ve.height===1)}})),this.isSupported}}class pe{constructor(ye){this.name=u.EXT_MESHOPT_COMPRESSION,this.parser=ye}loadBufferView(ye){const ve=this.parser.json,Le=ve.bufferViews[ye];if(Le.extensions&&Le.extensions[this.name]){const Se=Le.extensions[this.name],Re=this.parser.getDependency("buffer",Se.buffer),Pe=this.parser.options.meshoptDecoder;if(!Pe||!Pe.supported){if(ve.extensionsRequired&&ve.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Re.then(function($){const N=Se.byteOffset||0,V=Se.byteLength||0,fe=Se.count,be=Se.byteStride,Fe=new Uint8Array($,N,V);return Pe.decodeGltfBufferAsync?Pe.decodeGltfBufferAsync(fe,be,Fe,Se.mode,Se.filter).then(function(We){return We.buffer}):Pe.ready.then(function(){const We=new ArrayBuffer(fe*be);return Pe.decodeGltfBuffer(new Uint8Array(We),fe,be,Fe,Se.mode,Se.filter),We})})}else return null}}class de{constructor(ye){this.name=u.EXT_MESH_GPU_INSTANCING,this.parser=ye}createNodeMesh(ye){const ve=this.parser.json,Le=ve.nodes[ye];if(!Le.extensions||!Le.extensions[this.name]||Le.mesh===void 0)return null;const Se=ve.meshes[Le.mesh];for(const V of Se.primitives)if(V.mode!==pt.TRIANGLES&&V.mode!==pt.TRIANGLE_STRIP&&V.mode!==pt.TRIANGLE_FAN&&V.mode!==void 0)return null;const Pe=Le.extensions[this.name].attributes,$=[],N={};for(const V in Pe)$.push(this.parser.getDependency("accessor",Pe[V]).then(fe=>(N[V]=fe,N[V])));return $.length<1?null:($.push(this.parser.createNodeMesh(ye)),Promise.all($).then(V=>{const fe=V.pop(),be=fe.isGroup?fe.children:[fe],Fe=V[0].count,We=[];for(const Rt of be){const zt=new f.Matrix4,Lt=new f.Vector3,Tt=new f.Quaternion,ti=new f.Vector3(1,1,1),Jn=new f.InstancedMesh(Rt.geometry,Rt.material,Fe);for(let wi=0;wi<Fe;wi++)N.TRANSLATION&&Lt.fromBufferAttribute(N.TRANSLATION,wi),N.ROTATION&&Tt.fromBufferAttribute(N.ROTATION,wi),N.SCALE&&ti.fromBufferAttribute(N.SCALE,wi),Jn.setMatrixAt(wi,zt.compose(Lt,Tt,ti));for(const wi in N)if(wi==="_COLOR_0"){const Xn=N[wi];Jn.instanceColor=new f.InstancedBufferAttribute(Xn.array,Xn.itemSize,Xn.normalized)}else wi!=="TRANSLATION"&&wi!=="ROTATION"&&wi!=="SCALE"&&Rt.geometry.setAttribute(wi,N[wi]);f.Object3D.prototype.copy.call(Jn,Rt),this.parser.assignFinalMaterial(Jn),We.push(Jn)}return fe.isGroup?(fe.clear(),fe.add(...We),fe):We[0]}))}}const se="glTF",J=12,H={JSON:1313821514,BIN:5130562};class ae{constructor(ye){this.name=u.KHR_BINARY_GLTF,this.content=null,this.body=null;const ve=new DataView(ye,0,J),Le=new TextDecoder;if(this.header={magic:Le.decode(new Uint8Array(ye.slice(0,4))),version:ve.getUint32(4,!0),length:ve.getUint32(8,!0)},this.header.magic!==se)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const Se=this.header.length-J,Re=new DataView(ye,J);let Pe=0;for(;Pe<Se;){const $=Re.getUint32(Pe,!0);Pe+=4;const N=Re.getUint32(Pe,!0);if(Pe+=4,N===H.JSON){const V=new Uint8Array(ye,J+Pe,$);this.content=Le.decode(V)}else if(N===H.BIN){const V=J+Pe;this.body=ye.slice(V,V+$)}Pe+=$}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ue{constructor(ye,ve){if(!ve)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=u.KHR_DRACO_MESH_COMPRESSION,this.json=ye,this.dracoLoader=ve,this.dracoLoader.preload()}decodePrimitive(ye,ve){const Le=this.json,Se=this.dracoLoader,Re=ye.extensions[this.name].bufferView,Pe=ye.extensions[this.name].attributes,$={},N={},V={};for(const fe in Pe){const be=Yt[fe]||fe.toLowerCase();$[be]=Pe[fe]}for(const fe in ye.attributes){const be=Yt[fe]||fe.toLowerCase();if(Pe[fe]!==void 0){const Fe=Le.accessors[ye.attributes[fe]],We=yt[Fe.componentType];V[be]=We.name,N[be]=Fe.normalized===!0}}return ve.getDependency("bufferView",Re).then(function(fe){return new Promise(function(be,Fe){Se.decodeDracoFile(fe,function(We){for(const Rt in We.attributes){const zt=We.attributes[Rt],Lt=N[Rt];Lt!==void 0&&(zt.normalized=Lt)}be(We)},$,V,f.LinearSRGBColorSpace,Fe)})})}}class Me{constructor(){this.name=u.KHR_TEXTURE_TRANSFORM}extendTexture(ye,ve){return(ve.texCoord===void 0||ve.texCoord===ye.channel)&&ve.offset===void 0&&ve.rotation===void 0&&ve.scale===void 0||(ye=ye.clone(),ve.texCoord!==void 0&&(ye.channel=ve.texCoord),ve.offset!==void 0&&ye.offset.fromArray(ve.offset),ve.rotation!==void 0&&(ye.rotation=ve.rotation),ve.scale!==void 0&&ye.repeat.fromArray(ve.scale),ye.needsUpdate=!0),ye}}class De{constructor(){this.name=u.KHR_MESH_QUANTIZATION}}class Ge extends f.Interpolant{constructor(ye,ve,Le,Se){super(ye,ve,Le,Se)}copySampleValue_(ye){const ve=this.resultBuffer,Le=this.sampleValues,Se=this.valueSize,Re=ye*Se*3+Se;for(let Pe=0;Pe!==Se;Pe++)ve[Pe]=Le[Re+Pe];return ve}interpolate_(ye,ve,Le,Se){const Re=this.resultBuffer,Pe=this.sampleValues,$=this.valueSize,N=$*2,V=$*3,fe=Se-ve,be=(Le-ve)/fe,Fe=be*be,We=Fe*be,Rt=ye*V,zt=Rt-V,Lt=-2*We+3*Fe,Tt=We-Fe,ti=1-Lt,Jn=Tt-Fe+be;for(let wi=0;wi!==$;wi++){const Xn=Pe[zt+wi+$],mn=Pe[zt+wi+N]*fe,In=Pe[Rt+wi+$],Yr=Pe[Rt+wi]*fe;Re[wi]=ti*Xn+Jn*mn+Lt*In+Tt*Yr}return Re}}const Xe=new f.Quaternion;class Je extends Ge{interpolate_(ye,ve,Le,Se){const Re=super.interpolate_(ye,ve,Le,Se);return Xe.fromArray(Re).normalize().toArray(Re),Re}}const pt={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},yt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Gt={9728:f.NearestFilter,9729:f.LinearFilter,9984:f.NearestMipmapNearestFilter,9985:f.LinearMipmapNearestFilter,9986:f.NearestMipmapLinearFilter,9987:f.LinearMipmapLinearFilter},Et={33071:f.ClampToEdgeWrapping,33648:f.MirroredRepeatWrapping,10497:f.RepeatWrapping},Vt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Yt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},gi={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Ri={CUBICSPLINE:void 0,LINEAR:f.InterpolateLinear,STEP:f.InterpolateDiscrete},Ni={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Oi(St){return St.DefaultMaterial===void 0&&(St.DefaultMaterial=new f.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:f.FrontSide})),St.DefaultMaterial}function yi(St,ye,ve){for(const Le in ve.extensions)St[Le]===void 0&&(ye.userData.gltfExtensions=ye.userData.gltfExtensions||{},ye.userData.gltfExtensions[Le]=ve.extensions[Le])}function zi(St,ye){ye.extras!==void 0&&(typeof ye.extras=="object"?Object.assign(St.userData,ye.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+ye.extras))}function Cn(St,ye,ve){let Le=!1,Se=!1,Re=!1;for(let V=0,fe=ye.length;V<fe;V++){const be=ye[V];if(be.POSITION!==void 0&&(Le=!0),be.NORMAL!==void 0&&(Se=!0),be.COLOR_0!==void 0&&(Re=!0),Le&&Se&&Re)break}if(!Le&&!Se&&!Re)return Promise.resolve(St);const Pe=[],$=[],N=[];for(let V=0,fe=ye.length;V<fe;V++){const be=ye[V];if(Le){const Fe=be.POSITION!==void 0?ve.getDependency("accessor",be.POSITION):St.attributes.position;Pe.push(Fe)}if(Se){const Fe=be.NORMAL!==void 0?ve.getDependency("accessor",be.NORMAL):St.attributes.normal;$.push(Fe)}if(Re){const Fe=be.COLOR_0!==void 0?ve.getDependency("accessor",be.COLOR_0):St.attributes.color;N.push(Fe)}}return Promise.all([Promise.all(Pe),Promise.all($),Promise.all(N)]).then(function(V){const fe=V[0],be=V[1],Fe=V[2];return Le&&(St.morphAttributes.position=fe),Se&&(St.morphAttributes.normal=be),Re&&(St.morphAttributes.color=Fe),St.morphTargetsRelative=!0,St})}function gn(St,ye){if(St.updateMorphTargets(),ye.weights!==void 0)for(let ve=0,Le=ye.weights.length;ve<Le;ve++)St.morphTargetInfluences[ve]=ye.weights[ve];if(ye.extras&&Array.isArray(ye.extras.targetNames)){const ve=ye.extras.targetNames;if(St.morphTargetInfluences.length===ve.length){St.morphTargetDictionary={};for(let Le=0,Se=ve.length;Le<Se;Le++)St.morphTargetDictionary[ve[Le]]=Le}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function rr(St){let ye;const ve=St.extensions&&St.extensions[u.KHR_DRACO_MESH_COMPRESSION];if(ve?ye="draco:"+ve.bufferView+":"+ve.indices+":"+bn(ve.attributes):ye=St.indices+":"+bn(St.attributes)+":"+St.mode,St.targets!==void 0)for(let Le=0,Se=St.targets.length;Le<Se;Le++)ye+=":"+bn(St.targets[Le]);return ye}function bn(St){let ye="";const ve=Object.keys(St).sort();for(let Le=0,Se=ve.length;Le<Se;Le++)ye+=ve[Le]+":"+St[ve[Le]]+";";return ye}function cn(St){switch(St){case Int8Array:return .007874015748031496;case Uint8Array:return .00392156862745098;case Int16Array:return 3051850947599719e-20;case Uint16Array:return 15259021896696422e-21;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Kn(St){return St.search(/\.jpe?g($|\?)/i)>0||St.search(/^data\:image\/jpeg/)===0?"image/jpeg":St.search(/\.webp($|\?)/i)>0||St.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const wn=new f.Matrix4;class Cr{constructor(ye={},ve={}){this.json=ye,this.extensions={},this.plugins={},this.options=ve,this.cache=new g,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let Le=!1,Se=!1,Re=-1;typeof navigator<"u"&&(Le=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,Se=navigator.userAgent.indexOf("Firefox")>-1,Re=Se?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||Le||Se&&Re<98?this.textureLoader=new f.TextureLoader(this.options.manager):this.textureLoader=new f.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new f.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(ye){this.extensions=ye}setPlugins(ye){this.plugins=ye}parse(ye,ve){const Le=this,Se=this.json,Re=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(Pe){return Pe._markDefs&&Pe._markDefs()}),Promise.all(this._invokeAll(function(Pe){return Pe.beforeRoot&&Pe.beforeRoot()})).then(function(){return Promise.all([Le.getDependencies("scene"),Le.getDependencies("animation"),Le.getDependencies("camera")])}).then(function(Pe){const $={scene:Pe[0][Se.scene||0],scenes:Pe[0],animations:Pe[1],cameras:Pe[2],asset:Se.asset,parser:Le,userData:{}};return yi(Re,$,Se),zi($,Se),Promise.all(Le._invokeAll(function(N){return N.afterRoot&&N.afterRoot($)})).then(function(){for(const N of $.scenes)N.updateMatrixWorld();ye($)})}).catch(ve)}_markDefs(){const ye=this.json.nodes||[],ve=this.json.skins||[],Le=this.json.meshes||[];for(let Se=0,Re=ve.length;Se<Re;Se++){const Pe=ve[Se].joints;for(let $=0,N=Pe.length;$<N;$++)ye[Pe[$]].isBone=!0}for(let Se=0,Re=ye.length;Se<Re;Se++){const Pe=ye[Se];Pe.mesh!==void 0&&(this._addNodeRef(this.meshCache,Pe.mesh),Pe.skin!==void 0&&(Le[Pe.mesh].isSkinnedMesh=!0)),Pe.camera!==void 0&&this._addNodeRef(this.cameraCache,Pe.camera)}}_addNodeRef(ye,ve){ve!==void 0&&(ye.refs[ve]===void 0&&(ye.refs[ve]=ye.uses[ve]=0),ye.refs[ve]++)}_getNodeRef(ye,ve,Le){if(ye.refs[ve]<=1)return Le;const Se=Le.clone(),Re=(Pe,$)=>{const N=this.associations.get(Pe);N!=null&&this.associations.set($,N);for(const[V,fe]of Pe.children.entries())Re(fe,$.children[V])};return Re(Le,Se),Se.name+="_instance_"+ye.uses[ve]++,Se}_invokeOne(ye){const ve=Object.values(this.plugins);ve.push(this);for(let Le=0;Le<ve.length;Le++){const Se=ye(ve[Le]);if(Se)return Se}return null}_invokeAll(ye){const ve=Object.values(this.plugins);ve.unshift(this);const Le=[];for(let Se=0;Se<ve.length;Se++){const Re=ye(ve[Se]);Re&&Le.push(Re)}return Le}getDependency(ye,ve){const Le=ye+":"+ve;let Se=this.cache.get(Le);if(!Se){switch(ye){case"scene":Se=this.loadScene(ve);break;case"node":Se=this._invokeOne(function(Re){return Re.loadNode&&Re.loadNode(ve)});break;case"mesh":Se=this._invokeOne(function(Re){return Re.loadMesh&&Re.loadMesh(ve)});break;case"accessor":Se=this.loadAccessor(ve);break;case"bufferView":Se=this._invokeOne(function(Re){return Re.loadBufferView&&Re.loadBufferView(ve)});break;case"buffer":Se=this.loadBuffer(ve);break;case"material":Se=this._invokeOne(function(Re){return Re.loadMaterial&&Re.loadMaterial(ve)});break;case"texture":Se=this._invokeOne(function(Re){return Re.loadTexture&&Re.loadTexture(ve)});break;case"skin":Se=this.loadSkin(ve);break;case"animation":Se=this._invokeOne(function(Re){return Re.loadAnimation&&Re.loadAnimation(ve)});break;case"camera":Se=this.loadCamera(ve);break;default:if(Se=this._invokeOne(function(Re){return Re!=this&&Re.getDependency&&Re.getDependency(ye,ve)}),!Se)throw new Error("Unknown type: "+ye);break}this.cache.add(Le,Se)}return Se}getDependencies(ye){let ve=this.cache.get(ye);if(!ve){const Le=this,Se=this.json[ye+(ye==="mesh"?"es":"s")]||[];ve=Promise.all(Se.map(function(Re,Pe){return Le.getDependency(ye,Pe)})),this.cache.add(ye,ve)}return ve}loadBuffer(ye){const ve=this.json.buffers[ye],Le=this.fileLoader;if(ve.type&&ve.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ve.type+" buffer type is not supported.");if(ve.uri===void 0&&ye===0)return Promise.resolve(this.extensions[u.KHR_BINARY_GLTF].body);const Se=this.options;return new Promise(function(Re,Pe){Le.load(f.LoaderUtils.resolveURL(ve.uri,Se.path),Re,void 0,function(){Pe(new Error('THREE.GLTFLoader: Failed to load buffer "'+ve.uri+'".'))})})}loadBufferView(ye){const ve=this.json.bufferViews[ye];return this.getDependency("buffer",ve.buffer).then(function(Le){const Se=ve.byteLength||0,Re=ve.byteOffset||0;return Le.slice(Re,Re+Se)})}loadAccessor(ye){const ve=this,Le=this.json,Se=this.json.accessors[ye];if(Se.bufferView===void 0&&Se.sparse===void 0){const Pe=Vt[Se.type],$=yt[Se.componentType],N=Se.normalized===!0,V=new $(Se.count*Pe);return Promise.resolve(new f.BufferAttribute(V,Pe,N))}const Re=[];return Se.bufferView!==void 0?Re.push(this.getDependency("bufferView",Se.bufferView)):Re.push(null),Se.sparse!==void 0&&(Re.push(this.getDependency("bufferView",Se.sparse.indices.bufferView)),Re.push(this.getDependency("bufferView",Se.sparse.values.bufferView))),Promise.all(Re).then(function(Pe){const $=Pe[0],N=Vt[Se.type],V=yt[Se.componentType],fe=V.BYTES_PER_ELEMENT,be=fe*N,Fe=Se.byteOffset||0,We=Se.bufferView!==void 0?Le.bufferViews[Se.bufferView].byteStride:void 0,Rt=Se.normalized===!0;let zt,Lt;if(We&&We!==be){const Tt=Math.floor(Fe/We),ti="InterleavedBuffer:"+Se.bufferView+":"+Se.componentType+":"+Tt+":"+Se.count;let Jn=ve.cache.get(ti);Jn||(zt=new V($,Tt*We,Se.count*We/fe),Jn=new f.InterleavedBuffer(zt,We/fe),ve.cache.add(ti,Jn)),Lt=new f.InterleavedBufferAttribute(Jn,N,Fe%We/fe,Rt)}else $===null?zt=new V(Se.count*N):zt=new V($,Fe,Se.count*N),Lt=new f.BufferAttribute(zt,N,Rt);if(Se.sparse!==void 0){const Tt=Vt.SCALAR,ti=yt[Se.sparse.indices.componentType],Jn=Se.sparse.indices.byteOffset||0,wi=Se.sparse.values.byteOffset||0,Xn=new ti(Pe[1],Jn,Se.sparse.count*Tt),mn=new V(Pe[2],wi,Se.sparse.count*N);$!==null&&(Lt=new f.BufferAttribute(Lt.array.slice(),Lt.itemSize,Lt.normalized));for(let In=0,Yr=Xn.length;In<Yr;In++){const Qn=Xn[In];if(Lt.setX(Qn,mn[In*N]),N>=2&&Lt.setY(Qn,mn[In*N+1]),N>=3&&Lt.setZ(Qn,mn[In*N+2]),N>=4&&Lt.setW(Qn,mn[In*N+3]),N>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Lt})}loadTexture(ye){const ve=this.json,Le=this.options,Re=ve.textures[ye].source,Pe=ve.images[Re];let $=this.textureLoader;if(Pe.uri){const N=Le.manager.getHandler(Pe.uri);N!==null&&($=N)}return this.loadTextureImage(ye,Re,$)}loadTextureImage(ye,ve,Le){const Se=this,Re=this.json,Pe=Re.textures[ye],$=Re.images[ve],N=($.uri||$.bufferView)+":"+Pe.sampler;if(this.textureCache[N])return this.textureCache[N];const V=this.loadImageSource(ve,Le).then(function(fe){fe.flipY=!1,fe.name=Pe.name||$.name||"",fe.name===""&&typeof $.uri=="string"&&$.uri.startsWith("data:image/")===!1&&(fe.name=$.uri);const Fe=(Re.samplers||{})[Pe.sampler]||{};return fe.magFilter=Gt[Fe.magFilter]||f.LinearFilter,fe.minFilter=Gt[Fe.minFilter]||f.LinearMipmapLinearFilter,fe.wrapS=Et[Fe.wrapS]||f.RepeatWrapping,fe.wrapT=Et[Fe.wrapT]||f.RepeatWrapping,Se.associations.set(fe,{textures:ye}),fe}).catch(function(){return null});return this.textureCache[N]=V,V}loadImageSource(ye,ve){const Le=this,Se=this.json,Re=this.options;if(this.sourceCache[ye]!==void 0)return this.sourceCache[ye].then(be=>be.clone());const Pe=Se.images[ye],$=self.URL||self.webkitURL;let N=Pe.uri||"",V=!1;if(Pe.bufferView!==void 0)N=Le.getDependency("bufferView",Pe.bufferView).then(function(be){V=!0;const Fe=new Blob([be],{type:Pe.mimeType});return N=$.createObjectURL(Fe),N});else if(Pe.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+ye+" is missing URI and bufferView");const fe=Promise.resolve(N).then(function(be){return new Promise(function(Fe,We){let Rt=Fe;ve.isImageBitmapLoader===!0&&(Rt=function(zt){const Lt=new f.Texture(zt);Lt.needsUpdate=!0,Fe(Lt)}),ve.load(f.LoaderUtils.resolveURL(be,Re.path),Rt,void 0,We)})}).then(function(be){return V===!0&&$.revokeObjectURL(N),be.userData.mimeType=Pe.mimeType||Kn(Pe.uri),be}).catch(function(be){throw console.error("THREE.GLTFLoader: Couldn't load texture",N),be});return this.sourceCache[ye]=fe,fe}assignTexture(ye,ve,Le,Se){const Re=this;return this.getDependency("texture",Le.index).then(function(Pe){if(!Pe)return null;if(Le.texCoord!==void 0&&Le.texCoord>0&&(Pe=Pe.clone(),Pe.channel=Le.texCoord),Re.extensions[u.KHR_TEXTURE_TRANSFORM]){const $=Le.extensions!==void 0?Le.extensions[u.KHR_TEXTURE_TRANSFORM]:void 0;if($){const N=Re.associations.get(Pe);Pe=Re.extensions[u.KHR_TEXTURE_TRANSFORM].extendTexture(Pe,$),Re.associations.set(Pe,N)}}return Se!==void 0&&(Pe.colorSpace=Se),ye[ve]=Pe,Pe})}assignFinalMaterial(ye){const ve=ye.geometry;let Le=ye.material;const Se=ve.attributes.tangent===void 0,Re=ve.attributes.color!==void 0,Pe=ve.attributes.normal===void 0;if(ye.isPoints){const $="PointsMaterial:"+Le.uuid;let N=this.cache.get($);N||(N=new f.PointsMaterial,f.Material.prototype.copy.call(N,Le),N.color.copy(Le.color),N.map=Le.map,N.sizeAttenuation=!1,this.cache.add($,N)),Le=N}else if(ye.isLine){const $="LineBasicMaterial:"+Le.uuid;let N=this.cache.get($);N||(N=new f.LineBasicMaterial,f.Material.prototype.copy.call(N,Le),N.color.copy(Le.color),N.map=Le.map,this.cache.add($,N)),Le=N}if(Se||Re||Pe){let $="ClonedMaterial:"+Le.uuid+":";Se&&($+="derivative-tangents:"),Re&&($+="vertex-colors:"),Pe&&($+="flat-shading:");let N=this.cache.get($);N||(N=Le.clone(),Re&&(N.vertexColors=!0),Pe&&(N.flatShading=!0),Se&&(N.normalScale&&(N.normalScale.y*=-1),N.clearcoatNormalScale&&(N.clearcoatNormalScale.y*=-1)),this.cache.add($,N),this.associations.set(N,this.associations.get(Le))),Le=N}ye.material=Le}getMaterialType(){return f.MeshStandardMaterial}loadMaterial(ye){const ve=this,Le=this.json,Se=this.extensions,Re=Le.materials[ye];let Pe;const $={},N=Re.extensions||{},V=[];if(N[u.KHR_MATERIALS_UNLIT]){const be=Se[u.KHR_MATERIALS_UNLIT];Pe=be.getMaterialType(),V.push(be.extendParams($,Re,ve))}else{const be=Re.pbrMetallicRoughness||{};if($.color=new f.Color(1,1,1),$.opacity=1,Array.isArray(be.baseColorFactor)){const Fe=be.baseColorFactor;$.color.setRGB(Fe[0],Fe[1],Fe[2],f.LinearSRGBColorSpace),$.opacity=Fe[3]}be.baseColorTexture!==void 0&&V.push(ve.assignTexture($,"map",be.baseColorTexture,f.SRGBColorSpace)),$.metalness=be.metallicFactor!==void 0?be.metallicFactor:1,$.roughness=be.roughnessFactor!==void 0?be.roughnessFactor:1,be.metallicRoughnessTexture!==void 0&&(V.push(ve.assignTexture($,"metalnessMap",be.metallicRoughnessTexture)),V.push(ve.assignTexture($,"roughnessMap",be.metallicRoughnessTexture))),Pe=this._invokeOne(function(Fe){return Fe.getMaterialType&&Fe.getMaterialType(ye)}),V.push(Promise.all(this._invokeAll(function(Fe){return Fe.extendMaterialParams&&Fe.extendMaterialParams(ye,$)})))}Re.doubleSided===!0&&($.side=f.DoubleSide);const fe=Re.alphaMode||Ni.OPAQUE;if(fe===Ni.BLEND?($.transparent=!0,$.depthWrite=!1):($.transparent=!1,fe===Ni.MASK&&($.alphaTest=Re.alphaCutoff!==void 0?Re.alphaCutoff:.5)),Re.normalTexture!==void 0&&Pe!==f.MeshBasicMaterial&&(V.push(ve.assignTexture($,"normalMap",Re.normalTexture)),$.normalScale=new f.Vector2(1,1),Re.normalTexture.scale!==void 0)){const be=Re.normalTexture.scale;$.normalScale.set(be,be)}if(Re.occlusionTexture!==void 0&&Pe!==f.MeshBasicMaterial&&(V.push(ve.assignTexture($,"aoMap",Re.occlusionTexture)),Re.occlusionTexture.strength!==void 0&&($.aoMapIntensity=Re.occlusionTexture.strength)),Re.emissiveFactor!==void 0&&Pe!==f.MeshBasicMaterial){const be=Re.emissiveFactor;$.emissive=new f.Color().setRGB(be[0],be[1],be[2],f.LinearSRGBColorSpace)}return Re.emissiveTexture!==void 0&&Pe!==f.MeshBasicMaterial&&V.push(ve.assignTexture($,"emissiveMap",Re.emissiveTexture,f.SRGBColorSpace)),Promise.all(V).then(function(){const be=new Pe($);return Re.name&&(be.name=Re.name),zi(be,Re),ve.associations.set(be,{materials:ye}),Re.extensions&&yi(Se,be,Re),be})}createUniqueName(ye){const ve=f.PropertyBinding.sanitizeNodeName(ye||"");return ve in this.nodeNamesUsed?ve+"_"+ ++this.nodeNamesUsed[ve]:(this.nodeNamesUsed[ve]=0,ve)}loadGeometries(ye){const ve=this,Le=this.extensions,Se=this.primitiveCache;function Re($){return Le[u.KHR_DRACO_MESH_COMPRESSION].decodePrimitive($,ve).then(function(N){return Tn(N,$,ve)})}const Pe=[];for(let $=0,N=ye.length;$<N;$++){const V=ye[$],fe=rr(V),be=Se[fe];if(be)Pe.push(be.promise);else{let Fe;V.extensions&&V.extensions[u.KHR_DRACO_MESH_COMPRESSION]?Fe=Re(V):Fe=Tn(new f.BufferGeometry,V,ve),Se[fe]={primitive:V,promise:Fe},Pe.push(Fe)}}return Promise.all(Pe)}loadMesh(ye){const ve=this,Le=this.json,Se=this.extensions,Re=Le.meshes[ye],Pe=Re.primitives,$=[];for(let N=0,V=Pe.length;N<V;N++){const fe=Pe[N].material===void 0?Oi(this.cache):this.getDependency("material",Pe[N].material);$.push(fe)}return $.push(ve.loadGeometries(Pe)),Promise.all($).then(function(N){const V=N.slice(0,N.length-1),fe=N[N.length-1],be=[];for(let We=0,Rt=fe.length;We<Rt;We++){const zt=fe[We],Lt=Pe[We];let Tt;const ti=V[We];if(Lt.mode===pt.TRIANGLES||Lt.mode===pt.TRIANGLE_STRIP||Lt.mode===pt.TRIANGLE_FAN||Lt.mode===void 0)Tt=Re.isSkinnedMesh===!0?new f.SkinnedMesh(zt,ti):new f.Mesh(zt,ti),Tt.isSkinnedMesh===!0&&Tt.normalizeSkinWeights(),Lt.mode===pt.TRIANGLE_STRIP?Tt.geometry=(0,C.toTrianglesDrawMode)(Tt.geometry,f.TriangleStripDrawMode):Lt.mode===pt.TRIANGLE_FAN&&(Tt.geometry=(0,C.toTrianglesDrawMode)(Tt.geometry,f.TriangleFanDrawMode));else if(Lt.mode===pt.LINES)Tt=new f.LineSegments(zt,ti);else if(Lt.mode===pt.LINE_STRIP)Tt=new f.Line(zt,ti);else if(Lt.mode===pt.LINE_LOOP)Tt=new f.LineLoop(zt,ti);else if(Lt.mode===pt.POINTS)Tt=new f.Points(zt,ti);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Lt.mode);Object.keys(Tt.geometry.morphAttributes).length>0&&gn(Tt,Re),Tt.name=ve.createUniqueName(Re.name||"mesh_"+ye),zi(Tt,Re),Lt.extensions&&yi(Se,Tt,Lt),ve.assignFinalMaterial(Tt),be.push(Tt)}for(let We=0,Rt=be.length;We<Rt;We++)ve.associations.set(be[We],{meshes:ye,primitives:We});if(be.length===1)return Re.extensions&&yi(Se,be[0],Re),be[0];const Fe=new f.Group;Re.extensions&&yi(Se,Fe,Re),ve.associations.set(Fe,{meshes:ye});for(let We=0,Rt=be.length;We<Rt;We++)Fe.add(be[We]);return Fe})}loadCamera(ye){let ve;const Le=this.json.cameras[ye],Se=Le[Le.type];if(!Se){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Le.type==="perspective"?ve=new f.PerspectiveCamera(f.MathUtils.radToDeg(Se.yfov),Se.aspectRatio||1,Se.znear||1,Se.zfar||2e6):Le.type==="orthographic"&&(ve=new f.OrthographicCamera(-Se.xmag,Se.xmag,Se.ymag,-Se.ymag,Se.znear,Se.zfar)),Le.name&&(ve.name=this.createUniqueName(Le.name)),zi(ve,Le),Promise.resolve(ve)}loadSkin(ye){const ve=this.json.skins[ye],Le=[];for(let Se=0,Re=ve.joints.length;Se<Re;Se++)Le.push(this._loadNodeShallow(ve.joints[Se]));return ve.inverseBindMatrices!==void 0?Le.push(this.getDependency("accessor",ve.inverseBindMatrices)):Le.push(null),Promise.all(Le).then(function(Se){const Re=Se.pop(),Pe=Se,$=[],N=[];for(let V=0,fe=Pe.length;V<fe;V++){const be=Pe[V];if(be){$.push(be);const Fe=new f.Matrix4;Re!==null&&Fe.fromArray(Re.array,V*16),N.push(Fe)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',ve.joints[V])}return new f.Skeleton($,N)})}loadAnimation(ye){const ve=this.json,Le=this,Se=ve.animations[ye],Re=Se.name?Se.name:"animation_"+ye,Pe=[],$=[],N=[],V=[],fe=[];for(let be=0,Fe=Se.channels.length;be<Fe;be++){const We=Se.channels[be],Rt=Se.samplers[We.sampler],zt=We.target,Lt=zt.node,Tt=Se.parameters!==void 0?Se.parameters[Rt.input]:Rt.input,ti=Se.parameters!==void 0?Se.parameters[Rt.output]:Rt.output;zt.node!==void 0&&(Pe.push(this.getDependency("node",Lt)),$.push(this.getDependency("accessor",Tt)),N.push(this.getDependency("accessor",ti)),V.push(Rt),fe.push(zt))}return Promise.all([Promise.all(Pe),Promise.all($),Promise.all(N),Promise.all(V),Promise.all(fe)]).then(function(be){const Fe=be[0],We=be[1],Rt=be[2],zt=be[3],Lt=be[4],Tt=[];for(let ti=0,Jn=Fe.length;ti<Jn;ti++){const wi=Fe[ti],Xn=We[ti],mn=Rt[ti],In=zt[ti],Yr=Lt[ti];if(wi===void 0)continue;wi.updateMatrix&&wi.updateMatrix();const Qn=Le._createAnimationTracks(wi,Xn,mn,In,Yr);if(Qn)for(let ms=0;ms<Qn.length;ms++)Tt.push(Qn[ms])}return new f.AnimationClip(Re,void 0,Tt)})}createNodeMesh(ye){const ve=this.json,Le=this,Se=ve.nodes[ye];return Se.mesh===void 0?null:Le.getDependency("mesh",Se.mesh).then(function(Re){const Pe=Le._getNodeRef(Le.meshCache,Se.mesh,Re);return Se.weights!==void 0&&Pe.traverse(function($){if($.isMesh)for(let N=0,V=Se.weights.length;N<V;N++)$.morphTargetInfluences[N]=Se.weights[N]}),Pe})}loadNode(ye){const ve=this.json,Le=this,Se=ve.nodes[ye],Re=Le._loadNodeShallow(ye),Pe=[],$=Se.children||[];for(let V=0,fe=$.length;V<fe;V++)Pe.push(Le.getDependency("node",$[V]));const N=Se.skin===void 0?Promise.resolve(null):Le.getDependency("skin",Se.skin);return Promise.all([Re,Promise.all(Pe),N]).then(function(V){const fe=V[0],be=V[1],Fe=V[2];Fe!==null&&fe.traverse(function(We){We.isSkinnedMesh&&We.bind(Fe,wn)});for(let We=0,Rt=be.length;We<Rt;We++)fe.add(be[We]);return fe})}_loadNodeShallow(ye){const ve=this.json,Le=this.extensions,Se=this;if(this.nodeCache[ye]!==void 0)return this.nodeCache[ye];const Re=ve.nodes[ye],Pe=Re.name?Se.createUniqueName(Re.name):"",$=[],N=Se._invokeOne(function(V){return V.createNodeMesh&&V.createNodeMesh(ye)});return N&&$.push(N),Re.camera!==void 0&&$.push(Se.getDependency("camera",Re.camera).then(function(V){return Se._getNodeRef(Se.cameraCache,Re.camera,V)})),Se._invokeAll(function(V){return V.createNodeAttachment&&V.createNodeAttachment(ye)}).forEach(function(V){$.push(V)}),this.nodeCache[ye]=Promise.all($).then(function(V){let fe;if(Re.isBone===!0?fe=new f.Bone:V.length>1?fe=new f.Group:V.length===1?fe=V[0]:fe=new f.Object3D,fe!==V[0])for(let be=0,Fe=V.length;be<Fe;be++)fe.add(V[be]);if(Re.name&&(fe.userData.name=Re.name,fe.name=Pe),zi(fe,Re),Re.extensions&&yi(Le,fe,Re),Re.matrix!==void 0){const be=new f.Matrix4;be.fromArray(Re.matrix),fe.applyMatrix4(be)}else Re.translation!==void 0&&fe.position.fromArray(Re.translation),Re.rotation!==void 0&&fe.quaternion.fromArray(Re.rotation),Re.scale!==void 0&&fe.scale.fromArray(Re.scale);return Se.associations.has(fe)||Se.associations.set(fe,{}),Se.associations.get(fe).nodes=ye,fe}),this.nodeCache[ye]}loadScene(ye){const ve=this.extensions,Le=this.json.scenes[ye],Se=this,Re=new f.Group;Le.name&&(Re.name=Se.createUniqueName(Le.name)),zi(Re,Le),Le.extensions&&yi(ve,Re,Le);const Pe=Le.nodes||[],$=[];for(let N=0,V=Pe.length;N<V;N++)$.push(Se.getDependency("node",Pe[N]));return Promise.all($).then(function(N){for(let fe=0,be=N.length;fe<be;fe++)Re.add(N[fe]);const V=fe=>{const be=new Map;for(const[Fe,We]of Se.associations)(Fe instanceof f.Material||Fe instanceof f.Texture)&&be.set(Fe,We);return fe.traverse(Fe=>{const We=Se.associations.get(Fe);We!=null&&be.set(Fe,We)}),be};return Se.associations=V(Re),Re})}_createAnimationTracks(ye,ve,Le,Se,Re){const Pe=[],$=ye.name?ye.name:ye.uuid,N=[];gi[Re.path]===gi.weights?ye.traverse(function(Fe){Fe.morphTargetInfluences&&N.push(Fe.name?Fe.name:Fe.uuid)}):N.push($);let V;switch(gi[Re.path]){case gi.weights:V=f.NumberKeyframeTrack;break;case gi.rotation:V=f.QuaternionKeyframeTrack;break;case gi.position:case gi.scale:V=f.VectorKeyframeTrack;break;default:switch(Le.itemSize){case 1:V=f.NumberKeyframeTrack;break;case 2:case 3:default:V=f.VectorKeyframeTrack;break}break}const fe=Se.interpolation!==void 0?Ri[Se.interpolation]:f.InterpolateLinear,be=this._getArrayFromAccessor(Le);for(let Fe=0,We=N.length;Fe<We;Fe++){const Rt=new V(N[Fe]+"."+gi[Re.path],ve.array,be,fe);Se.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(Rt),Pe.push(Rt)}return Pe}_getArrayFromAccessor(ye){let ve=ye.array;if(ye.normalized){const Le=cn(ve.constructor),Se=new Float32Array(ve.length);for(let Re=0,Pe=ve.length;Re<Pe;Re++)Se[Re]=ve[Re]*Le;ve=Se}return ve}_createCubicSplineTrackInterpolant(ye){ye.createInterpolant=function(Le){const Se=this instanceof f.QuaternionKeyframeTrack?Je:Ge;return new Se(this.times,this.values,this.getValueSize()/3,Le)},ye.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ar(St,ye,ve){const Le=ye.attributes,Se=new f.Box3;if(Le.POSITION!==void 0){const $=ve.json.accessors[Le.POSITION],N=$.min,V=$.max;if(N!==void 0&&V!==void 0){if(Se.set(new f.Vector3(N[0],N[1],N[2]),new f.Vector3(V[0],V[1],V[2])),$.normalized){const fe=cn(yt[$.componentType]);Se.min.multiplyScalar(fe),Se.max.multiplyScalar(fe)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const Re=ye.targets;if(Re!==void 0){const $=new f.Vector3,N=new f.Vector3;for(let V=0,fe=Re.length;V<fe;V++){const be=Re[V];if(be.POSITION!==void 0){const Fe=ve.json.accessors[be.POSITION],We=Fe.min,Rt=Fe.max;if(We!==void 0&&Rt!==void 0){if(N.setX(Math.max(Math.abs(We[0]),Math.abs(Rt[0]))),N.setY(Math.max(Math.abs(We[1]),Math.abs(Rt[1]))),N.setZ(Math.max(Math.abs(We[2]),Math.abs(Rt[2]))),Fe.normalized){const zt=cn(yt[Fe.componentType]);N.multiplyScalar(zt)}$.max(N)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Se.expandByVector($)}St.boundingBox=Se;const Pe=new f.Sphere;Se.getCenter(Pe.center),Pe.radius=Se.min.distanceTo(Se.max)/2,St.boundingSphere=Pe}function Tn(St,ye,ve){const Le=ye.attributes,Se=[];function Re(Pe,$){return ve.getDependency("accessor",Pe).then(function(N){St.setAttribute($,N)})}for(const Pe in Le){const $=Yt[Pe]||Pe.toLowerCase();$ in St.attributes||Se.push(Re(Le[Pe],$))}if(ye.indices!==void 0&&!St.index){const Pe=ve.getDependency("accessor",ye.indices).then(function($){St.setIndex($)});Se.push(Pe)}return f.ColorManagement.workingColorSpace!==f.LinearSRGBColorSpace&&"COLOR_0"in Le&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${f.ColorManagement.workingColorSpace}" not supported.`),zi(St,ye),ar(St,ye,ve),Promise.all(Se).then(function(){return ye.targets!==void 0?Cn(St,ye.targets,ve):St})}},"./node_modules/three/examples/jsm/loaders/KTX2Loader.js":(m,M,h)=>{h.r(M),h.d(M,{KTX2Loader:()=>x});var f=h("./node_modules/three/build/three.module.js"),C=h("./node_modules/three/examples/jsm/utils/WorkerPool.js"),p=h("./node_modules/three/examples/jsm/libs/ktx-parse.module.js"),g=h("./node_modules/three/examples/jsm/libs/zstddec.module.js");const u=new WeakMap;let E=0,b;class x extends f.Loader{constructor(D){super(D),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new C.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(D){return this.transcoderPath=D,this}setWorkerLimit(D){return this.workerPool.setWorkerLimit(D),this}async detectSupportAsync(D){return this.workerConfig={astcSupported:await D.hasFeatureAsync("texture-compression-astc"),etc1Supported:await D.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await D.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await D.hasFeatureAsync("texture-compression-bc"),bptcSupported:await D.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await D.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(D){return D.isWebGPURenderer===!0?this.workerConfig={astcSupported:D.hasFeature("texture-compression-astc"),etc1Supported:D.hasFeature("texture-compression-etc1"),etc2Supported:D.hasFeature("texture-compression-etc2"),dxtSupported:D.hasFeature("texture-compression-bc"),bptcSupported:D.hasFeature("texture-compression-bptc"),pvrtcSupported:D.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:D.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:D.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:D.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:D.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:D.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:D.extensions.has("WEBGL_compressed_texture_pvrtc")||D.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const D=new f.FileLoader(this.manager);D.setPath(this.transcoderPath),D.setWithCredentials(this.withCredentials);const U=D.loadAsync("basis_transcoder.js"),F=new f.FileLoader(this.manager);F.setPath(this.transcoderPath),F.setResponseType("arraybuffer"),F.setWithCredentials(this.withCredentials);const j=F.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([U,j]).then(([Y,oe])=>{const te=x.BasisWorker.toString(),pe=["/* constants */","let _EngineFormat = "+JSON.stringify(x.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(x.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(x.BasisFormat),"/* basis_transcoder.js */",Y,"/* worker */",te.substring(te.indexOf("{")+1,te.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([pe])),this.transcoderBinary=oe,this.workerPool.setWorkerCreator(()=>{const de=new Worker(this.workerSourceURL),se=this.transcoderBinary.slice(0);return de.postMessage({type:"init",config:this.workerConfig,transcoderBinary:se},[se]),de})}),E>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),E++}return this.transcoderPending}load(D,U,F,j){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const Y=new f.FileLoader(this.manager);Y.setResponseType("arraybuffer"),Y.setWithCredentials(this.withCredentials),Y.load(D,oe=>{if(u.has(oe))return u.get(oe).promise.then(U).catch(j);this._createTexture(oe).then(te=>U?U(te):null).catch(j)},F,j)}_createTextureFrom(D,U){const{faces:F,width:j,height:Y,format:oe,type:te,error:pe,dfdFlags:de}=D;if(te==="error")return Promise.reject(pe);let se;if(U.faceCount===6)se=new f.CompressedCubeTexture(F,oe,f.UnsignedByteType);else{const J=F[0].mipmaps;se=U.layerCount>1?new f.CompressedArrayTexture(J,j,Y,U.layerCount,oe,f.UnsignedByteType):new f.CompressedTexture(J,j,Y,oe,f.UnsignedByteType)}return se.minFilter=F[0].mipmaps.length===1?f.LinearFilter:f.LinearMipmapLinearFilter,se.magFilter=f.LinearFilter,se.generateMipmaps=!1,se.needsUpdate=!0,se.colorSpace=L(U),se.premultiplyAlpha=!!(de&p.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),se}async _createTexture(D,U={}){const F=(0,p.read)(new Uint8Array(D));if(F.vkFormat!==p.VK_FORMAT_UNDEFINED)return S(F);const j=U,Y=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:D,taskConfig:j},[D])).then(oe=>this._createTextureFrom(oe.data,F));return u.set(D,{promise:Y}),Y}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),E--,this}}x.BasisFormat={ETC1S:0,UASTC_4x4:1},x.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},x.EngineFormat={RGBAFormat:f.RGBAFormat,RGBA_ASTC_4x4_Format:f.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:f.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:f.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:f.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:f.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:f.RGB_ETC1_Format,RGB_ETC2_Format:f.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:f.RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:f.RGBA_S3TC_DXT1_Format},x.BasisWorker=function(){let P,D,U;const F=_EngineFormat,j=_TranscoderFormat,Y=_BasisFormat;self.addEventListener("message",function(ue){const Me=ue.data;switch(Me.type){case"init":P=Me.config,oe(Me.transcoderBinary);break;case"transcode":D.then(()=>{try{const{faces:De,buffers:Ge,width:Xe,height:Je,hasAlpha:pt,format:yt,dfdFlags:Gt}=te(Me.buffer);self.postMessage({type:"transcode",id:Me.id,faces:De,width:Xe,height:Je,hasAlpha:pt,format:yt,dfdFlags:Gt},Ge)}catch(De){console.error(De),self.postMessage({type:"error",id:Me.id,error:De.message})}});break}});function oe(ue){D=new Promise(Me=>{U={wasmBinary:ue,onRuntimeInitialized:Me},BASIS(U)}).then(()=>{U.initializeBasis(),U.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function te(ue){const Me=new U.KTX2File(new Uint8Array(ue));function De(){Me.close(),Me.delete()}if(!Me.isValid())throw De(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const Ge=Me.isUASTC()?Y.UASTC_4x4:Y.ETC1S,Xe=Me.getWidth(),Je=Me.getHeight(),pt=Me.getLayers()||1,yt=Me.getLevels(),Gt=Me.getFaces(),Et=Me.getHasAlpha(),Vt=Me.getDFDFlags(),{transcoderFormat:Yt,engineFormat:gi}=J(Ge,Xe,Je,Et);if(!Xe||!Je||!yt)throw De(),new Error("THREE.KTX2Loader:	Invalid texture");if(!Me.startTranscoding())throw De(),new Error("THREE.KTX2Loader: .startTranscoding failed");const Ri=[],Ni=[];for(let Oi=0;Oi<Gt;Oi++){const yi=[];for(let zi=0;zi<yt;zi++){const Cn=[];let gn,rr;for(let cn=0;cn<pt;cn++){const Kn=Me.getImageLevelInfo(zi,cn,Oi);Oi===0&&zi===0&&cn===0&&(Kn.origWidth%4!==0||Kn.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),yt>1?(gn=Kn.origWidth,rr=Kn.origHeight):(gn=Kn.width,rr=Kn.height);const wn=new Uint8Array(Me.getImageTranscodedSizeInBytes(zi,cn,0,Yt));if(!Me.transcodeImage(wn,zi,cn,Oi,Yt,0,-1,-1))throw De(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Cn.push(wn)}const bn=ae(Cn);yi.push({data:bn,width:gn,height:rr}),Ni.push(bn.buffer)}Ri.push({mipmaps:yi,width:Xe,height:Je,format:gi})}return De(),{faces:Ri,buffers:Ni,width:Xe,height:Je,hasAlpha:Et,format:gi,dfdFlags:Vt}}const pe=[{if:"astcSupported",basisFormat:[Y.UASTC_4x4],transcoderFormat:[j.ASTC_4x4,j.ASTC_4x4],engineFormat:[F.RGBA_ASTC_4x4_Format,F.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[Y.ETC1S,Y.UASTC_4x4],transcoderFormat:[j.BC7_M5,j.BC7_M5],engineFormat:[F.RGBA_BPTC_Format,F.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[Y.ETC1S,Y.UASTC_4x4],transcoderFormat:[j.BC1,j.BC3],engineFormat:[F.RGBA_S3TC_DXT1_Format,F.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[Y.ETC1S,Y.UASTC_4x4],transcoderFormat:[j.ETC1,j.ETC2],engineFormat:[F.RGB_ETC2_Format,F.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[Y.ETC1S,Y.UASTC_4x4],transcoderFormat:[j.ETC1],engineFormat:[F.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[Y.ETC1S,Y.UASTC_4x4],transcoderFormat:[j.PVRTC1_4_RGB,j.PVRTC1_4_RGBA],engineFormat:[F.RGB_PVRTC_4BPPV1_Format,F.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],de=pe.sort(function(ue,Me){return ue.priorityETC1S-Me.priorityETC1S}),se=pe.sort(function(ue,Me){return ue.priorityUASTC-Me.priorityUASTC});function J(ue,Me,De,Ge){let Xe,Je;const pt=ue===Y.ETC1S?de:se;for(let yt=0;yt<pt.length;yt++){const Gt=pt[yt];if(P[Gt.if]&&Gt.basisFormat.includes(ue)&&!(Ge&&Gt.transcoderFormat.length<2)&&!(Gt.needsPowerOfTwo&&!(H(Me)&&H(De))))return Xe=Gt.transcoderFormat[Ge?1:0],Je=Gt.engineFormat[Ge?1:0],{transcoderFormat:Xe,engineFormat:Je}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),Xe=j.RGBA32,Je=F.RGBAFormat,{transcoderFormat:Xe,engineFormat:Je}}function H(ue){return ue<=2?!0:(ue&ue-1)===0&&ue!==0}function ae(ue){if(ue.length===1)return ue[0];let Me=0;for(let Xe=0;Xe<ue.length;Xe++){const Je=ue[Xe];Me+=Je.byteLength}const De=new Uint8Array(Me);let Ge=0;for(let Xe=0;Xe<ue.length;Xe++){const Je=ue[Xe];De.set(Je,Ge),Ge+=Je.byteLength}return De}};const T=new Set([f.RGBAFormat,f.RGFormat,f.RedFormat]),_={[p.VK_FORMAT_R32G32B32A32_SFLOAT]:f.RGBAFormat,[p.VK_FORMAT_R16G16B16A16_SFLOAT]:f.RGBAFormat,[p.VK_FORMAT_R8G8B8A8_UNORM]:f.RGBAFormat,[p.VK_FORMAT_R8G8B8A8_SRGB]:f.RGBAFormat,[p.VK_FORMAT_R32G32_SFLOAT]:f.RGFormat,[p.VK_FORMAT_R16G16_SFLOAT]:f.RGFormat,[p.VK_FORMAT_R8G8_UNORM]:f.RGFormat,[p.VK_FORMAT_R8G8_SRGB]:f.RGFormat,[p.VK_FORMAT_R32_SFLOAT]:f.RedFormat,[p.VK_FORMAT_R16_SFLOAT]:f.RedFormat,[p.VK_FORMAT_R8_SRGB]:f.RedFormat,[p.VK_FORMAT_R8_UNORM]:f.RedFormat,[p.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:f.RGBA_ASTC_6x6_Format,[p.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:f.RGBA_ASTC_6x6_Format},w={[p.VK_FORMAT_R32G32B32A32_SFLOAT]:f.FloatType,[p.VK_FORMAT_R16G16B16A16_SFLOAT]:f.HalfFloatType,[p.VK_FORMAT_R8G8B8A8_UNORM]:f.UnsignedByteType,[p.VK_FORMAT_R8G8B8A8_SRGB]:f.UnsignedByteType,[p.VK_FORMAT_R32G32_SFLOAT]:f.FloatType,[p.VK_FORMAT_R16G16_SFLOAT]:f.HalfFloatType,[p.VK_FORMAT_R8G8_UNORM]:f.UnsignedByteType,[p.VK_FORMAT_R8G8_SRGB]:f.UnsignedByteType,[p.VK_FORMAT_R32_SFLOAT]:f.FloatType,[p.VK_FORMAT_R16_SFLOAT]:f.HalfFloatType,[p.VK_FORMAT_R8_SRGB]:f.UnsignedByteType,[p.VK_FORMAT_R8_UNORM]:f.UnsignedByteType,[p.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:f.UnsignedByteType,[p.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:f.UnsignedByteType};async function S(P){const{vkFormat:D}=P;if(_[D]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let U;P.supercompressionScheme===p.KHR_SUPERCOMPRESSION_ZSTD&&(b||(b=new Promise(async Y=>{const oe=new g.ZSTDDecoder;await oe.init(),Y(oe)})),U=await b);const F=[];for(let Y=0;Y<P.levels.length;Y++){const oe=Math.max(1,P.pixelWidth>>Y),te=Math.max(1,P.pixelHeight>>Y),pe=P.pixelDepth?Math.max(1,P.pixelDepth>>Y):0,de=P.levels[Y];let se;if(P.supercompressionScheme===p.KHR_SUPERCOMPRESSION_NONE)se=de.levelData;else if(P.supercompressionScheme===p.KHR_SUPERCOMPRESSION_ZSTD)se=U.decode(de.levelData,de.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let J;w[D]===f.FloatType?J=new Float32Array(se.buffer,se.byteOffset,se.byteLength/Float32Array.BYTES_PER_ELEMENT):w[D]===f.HalfFloatType?J=new Uint16Array(se.buffer,se.byteOffset,se.byteLength/Uint16Array.BYTES_PER_ELEMENT):J=se,F.push({data:J,width:oe,height:te,depth:pe})}let j;if(T.has(_[D]))j=P.pixelDepth===0?new f.DataTexture(F[0].data,P.pixelWidth,P.pixelHeight):new f.Data3DTexture(F[0].data,P.pixelWidth,P.pixelHeight,P.pixelDepth);else{if(P.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");j=new f.CompressedTexture(F,P.pixelWidth,P.pixelHeight)}return j.mipmaps=F,j.type=w[D],j.format=_[D],j.colorSpace=L(P),j.needsUpdate=!0,Promise.resolve(j)}function L(P){const D=P.dataFormatDescriptor[0];return D.colorPrimaries===p.KHR_DF_PRIMARIES_BT709?D.transferFunction===p.KHR_DF_TRANSFER_SRGB?f.SRGBColorSpace:f.LinearSRGBColorSpace:D.colorPrimaries===p.KHR_DF_PRIMARIES_DISPLAYP3?D.transferFunction===p.KHR_DF_TRANSFER_SRGB?f.DisplayP3ColorSpace:f.LinearDisplayP3ColorSpace:(D.colorPrimaries===p.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${D.colorPrimaries}"`),f.NoColorSpace)}},"./node_modules/three/examples/jsm/loaders/MTLLoader.js":(m,M,h)=>{h.r(M),h.d(M,{MTLLoader:()=>C});var f=h("./node_modules/three/build/three.module.js");class C extends f.Loader{constructor(u){super(u)}load(u,E,b,x){const T=this,_=this.path===""?f.LoaderUtils.extractUrlBase(u):this.path,w=new f.FileLoader(this.manager);w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials),w.load(u,function(S){try{E(T.parse(S,_))}catch(L){x?x(L):console.error(L),T.manager.itemError(u)}},b,x)}setMaterialOptions(u){return this.materialOptions=u,this}parse(u,E){const b=u.split(`
`);let x={};const T=/\s+/,_={};for(let S=0;S<b.length;S++){let L=b[S];if(L=L.trim(),L.length===0||L.charAt(0)==="#")continue;const P=L.indexOf(" ");let D=P>=0?L.substring(0,P):L;D=D.toLowerCase();let U=P>=0?L.substring(P+1):"";if(U=U.trim(),D==="newmtl")x={name:U},_[U]=x;else if(D==="ka"||D==="kd"||D==="ks"||D==="ke"){const F=U.split(T,3);x[D]=[parseFloat(F[0]),parseFloat(F[1]),parseFloat(F[2])]}else x[D]=U}const w=new p(this.resourcePath||E,this.materialOptions);return w.setCrossOrigin(this.crossOrigin),w.setManager(this.manager),w.setMaterials(_),w}}class p{constructor(u="",E={}){this.baseUrl=u,this.options=E,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:f.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:f.RepeatWrapping}setCrossOrigin(u){return this.crossOrigin=u,this}setManager(u){this.manager=u}setMaterials(u){this.materialsInfo=this.convert(u),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(u){if(!this.options)return u;const E={};for(const b in u){const x=u[b],T={};E[b]=T;for(const _ in x){let w=!0,S=x[_];const L=_.toLowerCase();switch(L){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(S=[S[0]/255,S[1]/255,S[2]/255]),this.options&&this.options.ignoreZeroRGBs&&S[0]===0&&S[1]===0&&S[2]===0&&(w=!1);break}w&&(T[L]=S)}}return E}preload(){for(const u in this.materialsInfo)this.create(u)}getIndex(u){return this.nameLookup[u]}getAsArray(){let u=0;for(const E in this.materialsInfo)this.materialsArray[u]=this.create(E),this.nameLookup[E]=u,u++;return this.materialsArray}create(u){return this.materials[u]===void 0&&this.createMaterial_(u),this.materials[u]}createMaterial_(u){const E=this,b=this.materialsInfo[u],x={name:u,side:this.side};function T(w,S){return typeof S!="string"||S===""?"":/^https?:\/\//i.test(S)?S:w+S}function _(w,S){if(x[w])return;const L=E.getTextureParams(S,x),P=E.loadTexture(T(E.baseUrl,L.url));P.repeat.copy(L.scale),P.offset.copy(L.offset),P.wrapS=E.wrap,P.wrapT=E.wrap,(w==="map"||w==="emissiveMap")&&(P.colorSpace=f.SRGBColorSpace),x[w]=P}for(const w in b){const S=b[w];let L;if(S!=="")switch(w.toLowerCase()){case"kd":x.color=new f.Color().fromArray(S).convertSRGBToLinear();break;case"ks":x.specular=new f.Color().fromArray(S).convertSRGBToLinear();break;case"ke":x.emissive=new f.Color().fromArray(S).convertSRGBToLinear();break;case"map_kd":_("map",S);break;case"map_ks":_("specularMap",S);break;case"map_ke":_("emissiveMap",S);break;case"norm":_("normalMap",S);break;case"map_bump":case"bump":_("bumpMap",S);break;case"map_d":_("alphaMap",S),x.transparent=!0;break;case"ns":x.shininess=parseFloat(S);break;case"d":L=parseFloat(S),L<1&&(x.opacity=L,x.transparent=!0);break;case"tr":L=parseFloat(S),this.options&&this.options.invertTrProperty&&(L=1-L),L>0&&(x.opacity=1-L,x.transparent=!0);break}}return this.materials[u]=new f.MeshPhongMaterial(x),this.materials[u]}getTextureParams(u,E){const b={scale:new f.Vector2(1,1),offset:new f.Vector2(0,0)},x=u.split(/\s+/);let T;return T=x.indexOf("-bm"),T>=0&&(E.bumpScale=parseFloat(x[T+1]),x.splice(T,2)),T=x.indexOf("-s"),T>=0&&(b.scale.set(parseFloat(x[T+1]),parseFloat(x[T+2])),x.splice(T,4)),T=x.indexOf("-o"),T>=0&&(b.offset.set(parseFloat(x[T+1]),parseFloat(x[T+2])),x.splice(T,4)),b.url=x.join(" ").trim(),b}loadTexture(u,E,b,x,T){const _=this.manager!==void 0?this.manager:f.DefaultLoadingManager;let w=_.getHandler(u);w===null&&(w=new f.TextureLoader(_)),w.setCrossOrigin&&w.setCrossOrigin(this.crossOrigin);const S=w.load(u,b,x,T);return E!==void 0&&(S.mapping=E),S}}},"./node_modules/three/examples/jsm/loaders/OBJLoader.js":(m,M,h)=>{h.r(M),h.d(M,{OBJLoader:()=>P});var f=h("./node_modules/three/build/three.module.js");const C=/^[og]\s*(.+)?/,p=/^mtllib /,g=/^usemtl /,u=/^usemap /,E=/\s+/,b=new f.Vector3,x=new f.Vector3,T=new f.Vector3,_=new f.Vector3,w=new f.Vector3,S=new f.Color;function L(){const D={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(U,F){if(this.object&&this.object.fromDeclaration===!1){this.object.name=U,this.object.fromDeclaration=F!==!1;return}const j=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:U||"",fromDeclaration:F!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(Y,oe){const te=this._finalize(!1);te&&(te.inherited||te.groupCount<=0)&&this.materials.splice(te.index,1);const pe={index:this.materials.length,name:Y||"",mtllib:Array.isArray(oe)&&oe.length>0?oe[oe.length-1]:"",smooth:te!==void 0?te.smooth:this.smooth,groupStart:te!==void 0?te.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(de){const se={index:typeof de=="number"?de:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return se.clone=this.clone.bind(se),se}};return this.materials.push(pe),pe},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(Y){const oe=this.currentMaterial();if(oe&&oe.groupEnd===-1&&(oe.groupEnd=this.geometry.vertices.length/3,oe.groupCount=oe.groupEnd-oe.groupStart,oe.inherited=!1),Y&&this.materials.length>1)for(let te=this.materials.length-1;te>=0;te--)this.materials[te].groupCount<=0&&this.materials.splice(te,1);return Y&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),oe}},j&&j.name&&typeof j.clone=="function"){const Y=j.clone(0);Y.inherited=!0,this.object.materials.push(Y)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(U,F){const j=parseInt(U,10);return(j>=0?j-1:j+F/3)*3},parseNormalIndex:function(U,F){const j=parseInt(U,10);return(j>=0?j-1:j+F/3)*3},parseUVIndex:function(U,F){const j=parseInt(U,10);return(j>=0?j-1:j+F/2)*2},addVertex:function(U,F,j){const Y=this.vertices,oe=this.object.geometry.vertices;oe.push(Y[U+0],Y[U+1],Y[U+2]),oe.push(Y[F+0],Y[F+1],Y[F+2]),oe.push(Y[j+0],Y[j+1],Y[j+2])},addVertexPoint:function(U){const F=this.vertices;this.object.geometry.vertices.push(F[U+0],F[U+1],F[U+2])},addVertexLine:function(U){const F=this.vertices;this.object.geometry.vertices.push(F[U+0],F[U+1],F[U+2])},addNormal:function(U,F,j){const Y=this.normals,oe=this.object.geometry.normals;oe.push(Y[U+0],Y[U+1],Y[U+2]),oe.push(Y[F+0],Y[F+1],Y[F+2]),oe.push(Y[j+0],Y[j+1],Y[j+2])},addFaceNormal:function(U,F,j){const Y=this.vertices,oe=this.object.geometry.normals;b.fromArray(Y,U),x.fromArray(Y,F),T.fromArray(Y,j),w.subVectors(T,x),_.subVectors(b,x),w.cross(_),w.normalize(),oe.push(w.x,w.y,w.z),oe.push(w.x,w.y,w.z),oe.push(w.x,w.y,w.z)},addColor:function(U,F,j){const Y=this.colors,oe=this.object.geometry.colors;Y[U]!==void 0&&oe.push(Y[U+0],Y[U+1],Y[U+2]),Y[F]!==void 0&&oe.push(Y[F+0],Y[F+1],Y[F+2]),Y[j]!==void 0&&oe.push(Y[j+0],Y[j+1],Y[j+2])},addUV:function(U,F,j){const Y=this.uvs,oe=this.object.geometry.uvs;oe.push(Y[U+0],Y[U+1]),oe.push(Y[F+0],Y[F+1]),oe.push(Y[j+0],Y[j+1])},addDefaultUV:function(){const U=this.object.geometry.uvs;U.push(0,0),U.push(0,0),U.push(0,0)},addUVLine:function(U){const F=this.uvs;this.object.geometry.uvs.push(F[U+0],F[U+1])},addFace:function(U,F,j,Y,oe,te,pe,de,se){const J=this.vertices.length;let H=this.parseVertexIndex(U,J),ae=this.parseVertexIndex(F,J),ue=this.parseVertexIndex(j,J);if(this.addVertex(H,ae,ue),this.addColor(H,ae,ue),pe!==void 0&&pe!==""){const Me=this.normals.length;H=this.parseNormalIndex(pe,Me),ae=this.parseNormalIndex(de,Me),ue=this.parseNormalIndex(se,Me),this.addNormal(H,ae,ue)}else this.addFaceNormal(H,ae,ue);if(Y!==void 0&&Y!==""){const Me=this.uvs.length;H=this.parseUVIndex(Y,Me),ae=this.parseUVIndex(oe,Me),ue=this.parseUVIndex(te,Me),this.addUV(H,ae,ue),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(U){this.object.geometry.type="Points";const F=this.vertices.length;for(let j=0,Y=U.length;j<Y;j++){const oe=this.parseVertexIndex(U[j],F);this.addVertexPoint(oe),this.addColor(oe)}},addLineGeometry:function(U,F){this.object.geometry.type="Line";const j=this.vertices.length,Y=this.uvs.length;for(let oe=0,te=U.length;oe<te;oe++)this.addVertexLine(this.parseVertexIndex(U[oe],j));for(let oe=0,te=F.length;oe<te;oe++)this.addUVLine(this.parseUVIndex(F[oe],Y))}};return D.startObject("",!1),D}class P extends f.Loader{constructor(U){super(U),this.materials=null}load(U,F,j,Y){const oe=this,te=new f.FileLoader(this.manager);te.setPath(this.path),te.setRequestHeader(this.requestHeader),te.setWithCredentials(this.withCredentials),te.load(U,function(pe){try{F(oe.parse(pe))}catch(de){Y?Y(de):console.error(de),oe.manager.itemError(U)}},j,Y)}setMaterials(U){return this.materials=U,this}parse(U){const F=new L;U.indexOf(`\r
`)!==-1&&(U=U.replace(/\r\n/g,`
`)),U.indexOf(`\\
`)!==-1&&(U=U.replace(/\\\n/g,""));const j=U.split(`
`);let Y=[];for(let pe=0,de=j.length;pe<de;pe++){const se=j[pe].trimStart();if(se.length===0)continue;const J=se.charAt(0);if(J!=="#")if(J==="v"){const H=se.split(E);switch(H[0]){case"v":F.vertices.push(parseFloat(H[1]),parseFloat(H[2]),parseFloat(H[3])),H.length>=7?(S.setRGB(parseFloat(H[4]),parseFloat(H[5]),parseFloat(H[6])).convertSRGBToLinear(),F.colors.push(S.r,S.g,S.b)):F.colors.push(void 0,void 0,void 0);break;case"vn":F.normals.push(parseFloat(H[1]),parseFloat(H[2]),parseFloat(H[3]));break;case"vt":F.uvs.push(parseFloat(H[1]),parseFloat(H[2]));break}}else if(J==="f"){const ae=se.slice(1).trim().split(E),ue=[];for(let De=0,Ge=ae.length;De<Ge;De++){const Xe=ae[De];if(Xe.length>0){const Je=Xe.split("/");ue.push(Je)}}const Me=ue[0];for(let De=1,Ge=ue.length-1;De<Ge;De++){const Xe=ue[De],Je=ue[De+1];F.addFace(Me[0],Xe[0],Je[0],Me[1],Xe[1],Je[1],Me[2],Xe[2],Je[2])}}else if(J==="l"){const H=se.substring(1).trim().split(" ");let ae=[];const ue=[];if(se.indexOf("/")===-1)ae=H;else for(let Me=0,De=H.length;Me<De;Me++){const Ge=H[Me].split("/");Ge[0]!==""&&ae.push(Ge[0]),Ge[1]!==""&&ue.push(Ge[1])}F.addLineGeometry(ae,ue)}else if(J==="p"){const ae=se.slice(1).trim().split(" ");F.addPointGeometry(ae)}else if((Y=C.exec(se))!==null){const H=(" "+Y[0].slice(1).trim()).slice(1);F.startObject(H)}else if(g.test(se))F.object.startMaterial(se.substring(7).trim(),F.materialLibraries);else if(p.test(se))F.materialLibraries.push(se.substring(7).trim());else if(u.test(se))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(J==="s"){if(Y=se.split(" "),Y.length>1){const ae=Y[1].trim().toLowerCase();F.object.smooth=ae!=="0"&&ae!=="off"}else F.object.smooth=!0;const H=F.object.currentMaterial();H&&(H.smooth=F.object.smooth)}else{if(se==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+se+'"')}}F.finalize();const oe=new f.Group;if(oe.materialLibraries=[].concat(F.materialLibraries),!(F.objects.length===1&&F.objects[0].geometry.vertices.length===0)===!0)for(let pe=0,de=F.objects.length;pe<de;pe++){const se=F.objects[pe],J=se.geometry,H=se.materials,ae=J.type==="Line",ue=J.type==="Points";let Me=!1;if(J.vertices.length===0)continue;const De=new f.BufferGeometry;De.setAttribute("position",new f.Float32BufferAttribute(J.vertices,3)),J.normals.length>0&&De.setAttribute("normal",new f.Float32BufferAttribute(J.normals,3)),J.colors.length>0&&(Me=!0,De.setAttribute("color",new f.Float32BufferAttribute(J.colors,3))),J.hasUVIndices===!0&&De.setAttribute("uv",new f.Float32BufferAttribute(J.uvs,2));const Ge=[];for(let Je=0,pt=H.length;Je<pt;Je++){const yt=H[Je],Gt=yt.name+"_"+yt.smooth+"_"+Me;let Et=F.materials[Gt];if(this.materials!==null){if(Et=this.materials.create(yt.name),ae&&Et&&!(Et instanceof f.LineBasicMaterial)){const Vt=new f.LineBasicMaterial;f.Material.prototype.copy.call(Vt,Et),Vt.color.copy(Et.color),Et=Vt}else if(ue&&Et&&!(Et instanceof f.PointsMaterial)){const Vt=new f.PointsMaterial({size:10,sizeAttenuation:!1});f.Material.prototype.copy.call(Vt,Et),Vt.color.copy(Et.color),Vt.map=Et.map,Et=Vt}}Et===void 0&&(ae?Et=new f.LineBasicMaterial:ue?Et=new f.PointsMaterial({size:1,sizeAttenuation:!1}):Et=new f.MeshPhongMaterial,Et.name=yt.name,Et.flatShading=!yt.smooth,Et.vertexColors=Me,F.materials[Gt]=Et),Ge.push(Et)}let Xe;if(Ge.length>1){for(let Je=0,pt=H.length;Je<pt;Je++){const yt=H[Je];De.addGroup(yt.groupStart,yt.groupCount,Je)}ae?Xe=new f.LineSegments(De,Ge):ue?Xe=new f.Points(De,Ge):Xe=new f.Mesh(De,Ge)}else ae?Xe=new f.LineSegments(De,Ge[0]):ue?Xe=new f.Points(De,Ge[0]):Xe=new f.Mesh(De,Ge[0]);Xe.name=se.name,oe.add(Xe)}else if(F.vertices.length>0){const pe=new f.PointsMaterial({size:1,sizeAttenuation:!1}),de=new f.BufferGeometry;de.setAttribute("position",new f.Float32BufferAttribute(F.vertices,3)),F.colors.length>0&&F.colors[0]!==void 0&&(de.setAttribute("color",new f.Float32BufferAttribute(F.colors,3)),pe.vertexColors=!0);const se=new f.Points(de,pe);oe.add(se)}return oe}}},"./node_modules/three/examples/jsm/math/OBB.js":(m,M,h)=>{h.r(M),h.d(M,{OBB:()=>j});var f=h("./node_modules/three/build/three.module.js");const C={c:null,u:[new f.Vector3,new f.Vector3,new f.Vector3],e:[]},p={c:null,u:[new f.Vector3,new f.Vector3,new f.Vector3],e:[]},g=[[],[],[]],u=[[],[],[]],E=[],b=new f.Vector3,x=new f.Vector3,T=new f.Vector3,_=new f.Vector3,w=new f.Vector3,S=new f.Vector3,L=new f.Matrix3,P=new f.Box3,D=new f.Matrix4,U=new f.Matrix4,F=new f.Ray;class j{constructor(te=new f.Vector3,pe=new f.Vector3,de=new f.Matrix3){this.center=te,this.halfSize=pe,this.rotation=de}set(te,pe,de){return this.center=te,this.halfSize=pe,this.rotation=de,this}copy(te){return this.center.copy(te.center),this.halfSize.copy(te.halfSize),this.rotation.copy(te.rotation),this}clone(){return new this.constructor().copy(this)}getSize(te){return te.copy(this.halfSize).multiplyScalar(2)}clampPoint(te,pe){const de=this.halfSize;_.subVectors(te,this.center),this.rotation.extractBasis(b,x,T),pe.copy(this.center);const se=f.MathUtils.clamp(_.dot(b),-de.x,de.x);pe.add(b.multiplyScalar(se));const J=f.MathUtils.clamp(_.dot(x),-de.y,de.y);pe.add(x.multiplyScalar(J));const H=f.MathUtils.clamp(_.dot(T),-de.z,de.z);return pe.add(T.multiplyScalar(H)),pe}containsPoint(te){return _.subVectors(te,this.center),this.rotation.extractBasis(b,x,T),Math.abs(_.dot(b))<=this.halfSize.x&&Math.abs(_.dot(x))<=this.halfSize.y&&Math.abs(_.dot(T))<=this.halfSize.z}intersectsBox3(te){return this.intersectsOBB(Y.fromBox3(te))}intersectsSphere(te){return this.clampPoint(te.center,S),S.distanceToSquared(te.center)<=te.radius*te.radius}intersectsOBB(te,pe=Number.EPSILON){C.c=this.center,C.e[0]=this.halfSize.x,C.e[1]=this.halfSize.y,C.e[2]=this.halfSize.z,this.rotation.extractBasis(C.u[0],C.u[1],C.u[2]),p.c=te.center,p.e[0]=te.halfSize.x,p.e[1]=te.halfSize.y,p.e[2]=te.halfSize.z,te.rotation.extractBasis(p.u[0],p.u[1],p.u[2]);for(let J=0;J<3;J++)for(let H=0;H<3;H++)g[J][H]=C.u[J].dot(p.u[H]);_.subVectors(p.c,C.c),E[0]=_.dot(C.u[0]),E[1]=_.dot(C.u[1]),E[2]=_.dot(C.u[2]);for(let J=0;J<3;J++)for(let H=0;H<3;H++)u[J][H]=Math.abs(g[J][H])+pe;let de,se;for(let J=0;J<3;J++)if(de=C.e[J],se=p.e[0]*u[J][0]+p.e[1]*u[J][1]+p.e[2]*u[J][2],Math.abs(E[J])>de+se)return!1;for(let J=0;J<3;J++)if(de=C.e[0]*u[0][J]+C.e[1]*u[1][J]+C.e[2]*u[2][J],se=p.e[J],Math.abs(E[0]*g[0][J]+E[1]*g[1][J]+E[2]*g[2][J])>de+se)return!1;return de=C.e[1]*u[2][0]+C.e[2]*u[1][0],se=p.e[1]*u[0][2]+p.e[2]*u[0][1],!(Math.abs(E[2]*g[1][0]-E[1]*g[2][0])>de+se||(de=C.e[1]*u[2][1]+C.e[2]*u[1][1],se=p.e[0]*u[0][2]+p.e[2]*u[0][0],Math.abs(E[2]*g[1][1]-E[1]*g[2][1])>de+se)||(de=C.e[1]*u[2][2]+C.e[2]*u[1][2],se=p.e[0]*u[0][1]+p.e[1]*u[0][0],Math.abs(E[2]*g[1][2]-E[1]*g[2][2])>de+se)||(de=C.e[0]*u[2][0]+C.e[2]*u[0][0],se=p.e[1]*u[1][2]+p.e[2]*u[1][1],Math.abs(E[0]*g[2][0]-E[2]*g[0][0])>de+se)||(de=C.e[0]*u[2][1]+C.e[2]*u[0][1],se=p.e[0]*u[1][2]+p.e[2]*u[1][0],Math.abs(E[0]*g[2][1]-E[2]*g[0][1])>de+se)||(de=C.e[0]*u[2][2]+C.e[2]*u[0][2],se=p.e[0]*u[1][1]+p.e[1]*u[1][0],Math.abs(E[0]*g[2][2]-E[2]*g[0][2])>de+se)||(de=C.e[0]*u[1][0]+C.e[1]*u[0][0],se=p.e[1]*u[2][2]+p.e[2]*u[2][1],Math.abs(E[1]*g[0][0]-E[0]*g[1][0])>de+se)||(de=C.e[0]*u[1][1]+C.e[1]*u[0][1],se=p.e[0]*u[2][2]+p.e[2]*u[2][0],Math.abs(E[1]*g[0][1]-E[0]*g[1][1])>de+se)||(de=C.e[0]*u[1][2]+C.e[1]*u[0][2],se=p.e[0]*u[2][1]+p.e[1]*u[2][0],Math.abs(E[1]*g[0][2]-E[0]*g[1][2])>de+se))}intersectsPlane(te){this.rotation.extractBasis(b,x,T);const pe=this.halfSize.x*Math.abs(te.normal.dot(b))+this.halfSize.y*Math.abs(te.normal.dot(x))+this.halfSize.z*Math.abs(te.normal.dot(T)),de=te.normal.dot(this.center)-te.constant;return Math.abs(de)<=pe}intersectRay(te,pe){return this.getSize(w),P.setFromCenterAndSize(_.set(0,0,0),w),D.setFromMatrix3(this.rotation),D.setPosition(this.center),U.copy(D).invert(),F.copy(te).applyMatrix4(U),F.intersectBox(P,pe)?pe.applyMatrix4(D):null}intersectsRay(te){return this.intersectRay(te,_)!==null}fromBox3(te){return te.getCenter(this.center),te.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(te){return te.center.equals(this.center)&&te.halfSize.equals(this.halfSize)&&te.rotation.equals(this.rotation)}applyMatrix4(te){const pe=te.elements;let de=_.set(pe[0],pe[1],pe[2]).length();const se=_.set(pe[4],pe[5],pe[6]).length(),J=_.set(pe[8],pe[9],pe[10]).length();te.determinant()<0&&(de=-de),L.setFromMatrix4(te);const ae=1/de,ue=1/se,Me=1/J;return L.elements[0]*=ae,L.elements[1]*=ae,L.elements[2]*=ae,L.elements[3]*=ue,L.elements[4]*=ue,L.elements[5]*=ue,L.elements[6]*=Me,L.elements[7]*=Me,L.elements[8]*=Me,this.rotation.multiply(L),this.halfSize.x*=de,this.halfSize.y*=se,this.halfSize.z*=J,_.setFromMatrixPosition(te),this.center.add(_),this}}const Y=new j},"./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js":(m,M,h)=>{h.r(M),h.d(M,{computeMikkTSpaceTangents:()=>C,computeMorphedAttributes:()=>S,deepCloneAttribute:()=>u,deinterleaveAttribute:()=>b,deinterleaveGeometry:()=>x,estimateBytesUsed:()=>T,interleaveAttributes:()=>E,mergeAttributes:()=>g,mergeGeometries:()=>p,mergeGroups:()=>L,mergeVertices:()=>_,toCreasedNormals:()=>P,toTrianglesDrawMode:()=>w});var f=h("./node_modules/three/build/three.module.js");function C(D,U,F=!0){if(!U||!U.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!D.hasAttribute("position")||!D.hasAttribute("normal")||!D.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function j(te){if(te.normalized||te.isInterleavedBufferAttribute){const pe=new Float32Array(te.count*te.itemSize);for(let de=0,se=0;de<te.count;de++)pe[se++]=te.getX(de),pe[se++]=te.getY(de),te.itemSize>2&&(pe[se++]=te.getZ(de));return pe}return te.array instanceof Float32Array?te.array:new Float32Array(te.array)}const Y=D.index?D.toNonIndexed():D,oe=U.generateTangents(j(Y.attributes.position),j(Y.attributes.normal),j(Y.attributes.uv));if(F)for(let te=3;te<oe.length;te+=4)oe[te]*=-1;return Y.setAttribute("tangent",new f.BufferAttribute(oe,4)),D!==Y&&D.copy(Y),D}function p(D,U=!1){const F=D[0].index!==null,j=new Set(Object.keys(D[0].attributes)),Y=new Set(Object.keys(D[0].morphAttributes)),oe={},te={},pe=D[0].morphTargetsRelative,de=new f.BufferGeometry;let se=0;for(let J=0;J<D.length;++J){const H=D[J];let ae=0;if(F!==(H.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+J+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const ue in H.attributes){if(!j.has(ue))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+J+'. All geometries must have compatible attributes; make sure "'+ue+'" attribute exists among all geometries, or in none of them.'),null;oe[ue]===void 0&&(oe[ue]=[]),oe[ue].push(H.attributes[ue]),ae++}if(ae!==j.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+J+". Make sure all geometries have the same number of attributes."),null;if(pe!==H.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+J+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const ue in H.morphAttributes){if(!Y.has(ue))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+J+".  .morphAttributes must be consistent throughout all geometries."),null;te[ue]===void 0&&(te[ue]=[]),te[ue].push(H.morphAttributes[ue])}if(U){let ue;if(F)ue=H.index.count;else if(H.attributes.position!==void 0)ue=H.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+J+". The geometry must have either an index or a position attribute"),null;de.addGroup(se,ue,J),se+=ue}}if(F){let J=0;const H=[];for(let ae=0;ae<D.length;++ae){const ue=D[ae].index;for(let Me=0;Me<ue.count;++Me)H.push(ue.getX(Me)+J);J+=D[ae].attributes.position.count}de.setIndex(H)}for(const J in oe){const H=g(oe[J]);if(!H)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+J+" attribute."),null;de.setAttribute(J,H)}for(const J in te){const H=te[J][0].length;if(H===0)break;de.morphAttributes=de.morphAttributes||{},de.morphAttributes[J]=[];for(let ae=0;ae<H;++ae){const ue=[];for(let De=0;De<te[J].length;++De)ue.push(te[J][De][ae]);const Me=g(ue);if(!Me)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+J+" morphAttribute."),null;de.morphAttributes[J].push(Me)}}return de}function g(D){let U,F,j,Y=-1,oe=0;for(let se=0;se<D.length;++se){const J=D[se];if(U===void 0&&(U=J.array.constructor),U!==J.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(F===void 0&&(F=J.itemSize),F!==J.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(j===void 0&&(j=J.normalized),j!==J.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(Y===-1&&(Y=J.gpuType),Y!==J.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;oe+=J.count*F}const te=new U(oe),pe=new f.BufferAttribute(te,F,j);let de=0;for(let se=0;se<D.length;++se){const J=D[se];if(J.isInterleavedBufferAttribute){const H=de/F;for(let ae=0,ue=J.count;ae<ue;ae++)for(let Me=0;Me<F;Me++){const De=J.getComponent(ae,Me);pe.setComponent(ae+H,Me,De)}}else te.set(J.array,de);de+=J.count*F}return Y!==void 0&&(pe.gpuType=Y),pe}function u(D){return D.isInstancedInterleavedBufferAttribute||D.isInterleavedBufferAttribute?b(D):D.isInstancedBufferAttribute?new f.InstancedBufferAttribute().copy(D):new f.BufferAttribute().copy(D)}function E(D){let U,F=0,j=0;for(let se=0,J=D.length;se<J;++se){const H=D[se];if(U===void 0&&(U=H.array.constructor),U!==H.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;F+=H.array.length,j+=H.itemSize}const Y=new f.InterleavedBuffer(new U(F),j);let oe=0;const te=[],pe=["getX","getY","getZ","getW"],de=["setX","setY","setZ","setW"];for(let se=0,J=D.length;se<J;se++){const H=D[se],ae=H.itemSize,ue=H.count,Me=new f.InterleavedBufferAttribute(Y,ae,oe,H.normalized);te.push(Me),oe+=ae;for(let De=0;De<ue;De++)for(let Ge=0;Ge<ae;Ge++)Me[de[Ge]](De,H[pe[Ge]](De))}return te}function b(D){const U=D.data.array.constructor,F=D.count,j=D.itemSize,Y=D.normalized,oe=new U(F*j);let te;D.isInstancedInterleavedBufferAttribute?te=new f.InstancedBufferAttribute(oe,j,Y,D.meshPerAttribute):te=new f.BufferAttribute(oe,j,Y);for(let pe=0;pe<F;pe++)te.setX(pe,D.getX(pe)),j>=2&&te.setY(pe,D.getY(pe)),j>=3&&te.setZ(pe,D.getZ(pe)),j>=4&&te.setW(pe,D.getW(pe));return te}function x(D){const U=D.attributes,F=D.morphTargets,j=new Map;for(const Y in U){const oe=U[Y];oe.isInterleavedBufferAttribute&&(j.has(oe)||j.set(oe,b(oe)),U[Y]=j.get(oe))}for(const Y in F){const oe=F[Y];oe.isInterleavedBufferAttribute&&(j.has(oe)||j.set(oe,b(oe)),F[Y]=j.get(oe))}}function T(D){let U=0;for(const j in D.attributes){const Y=D.getAttribute(j);U+=Y.count*Y.itemSize*Y.array.BYTES_PER_ELEMENT}const F=D.getIndex();return U+=F?F.count*F.itemSize*F.array.BYTES_PER_ELEMENT:0,U}function _(D,U=1e-4){U=Math.max(U,Number.EPSILON);const F={},j=D.getIndex(),Y=D.getAttribute("position"),oe=j?j.count:Y.count;let te=0;const pe=Object.keys(D.attributes),de={},se={},J=[],H=["getX","getY","getZ","getW"],ae=["setX","setY","setZ","setW"];for(let Je=0,pt=pe.length;Je<pt;Je++){const yt=pe[Je],Gt=D.attributes[yt];de[yt]=new f.BufferAttribute(new Gt.array.constructor(Gt.count*Gt.itemSize),Gt.itemSize,Gt.normalized);const Et=D.morphAttributes[yt];Et&&(se[yt]=new f.BufferAttribute(new Et.array.constructor(Et.count*Et.itemSize),Et.itemSize,Et.normalized))}const ue=U*.5,Me=Math.log10(1/U),De=Math.pow(10,Me),Ge=ue*De;for(let Je=0;Je<oe;Je++){const pt=j?j.getX(Je):Je;let yt="";for(let Gt=0,Et=pe.length;Gt<Et;Gt++){const Vt=pe[Gt],Yt=D.getAttribute(Vt),gi=Yt.itemSize;for(let Ri=0;Ri<gi;Ri++)yt+=`${~~(Yt[H[Ri]](pt)*De+Ge)},`}if(yt in F)J.push(F[yt]);else{for(let Gt=0,Et=pe.length;Gt<Et;Gt++){const Vt=pe[Gt],Yt=D.getAttribute(Vt),gi=D.morphAttributes[Vt],Ri=Yt.itemSize,Ni=de[Vt],Oi=se[Vt];for(let yi=0;yi<Ri;yi++){const zi=H[yi],Cn=ae[yi];if(Ni[Cn](te,Yt[zi](pt)),gi)for(let gn=0,rr=gi.length;gn<rr;gn++)Oi[gn][Cn](te,gi[gn][zi](pt))}}F[yt]=te,J.push(te),te++}}const Xe=D.clone();for(const Je in D.attributes){const pt=de[Je];if(Xe.setAttribute(Je,new f.BufferAttribute(pt.array.slice(0,te*pt.itemSize),pt.itemSize,pt.normalized)),Je in se)for(let yt=0;yt<se[Je].length;yt++){const Gt=se[Je][yt];Xe.morphAttributes[Je][yt]=new f.BufferAttribute(Gt.array.slice(0,te*Gt.itemSize),Gt.itemSize,Gt.normalized)}}return Xe.setIndex(J),Xe}function w(D,U){if(U===f.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),D;if(U===f.TriangleFanDrawMode||U===f.TriangleStripDrawMode){let F=D.getIndex();if(F===null){const te=[],pe=D.getAttribute("position");if(pe!==void 0){for(let de=0;de<pe.count;de++)te.push(de);D.setIndex(te),F=D.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),D}const j=F.count-2,Y=[];if(U===f.TriangleFanDrawMode)for(let te=1;te<=j;te++)Y.push(F.getX(0)),Y.push(F.getX(te)),Y.push(F.getX(te+1));else for(let te=0;te<j;te++)te%2===0?(Y.push(F.getX(te)),Y.push(F.getX(te+1)),Y.push(F.getX(te+2))):(Y.push(F.getX(te+2)),Y.push(F.getX(te+1)),Y.push(F.getX(te)));Y.length/3!==j&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const oe=D.clone();return oe.setIndex(Y),oe.clearGroups(),oe}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",U),D}function S(D){const U=new f.Vector3,F=new f.Vector3,j=new f.Vector3,Y=new f.Vector3,oe=new f.Vector3,te=new f.Vector3,pe=new f.Vector3,de=new f.Vector3,se=new f.Vector3;function J(cn,Kn,wn,Cr,ar,Tn,St,ye){U.fromBufferAttribute(Kn,ar),F.fromBufferAttribute(Kn,Tn),j.fromBufferAttribute(Kn,St);const ve=cn.morphTargetInfluences;if(wn&&ve){pe.set(0,0,0),de.set(0,0,0),se.set(0,0,0);for(let Le=0,Se=wn.length;Le<Se;Le++){const Re=ve[Le],Pe=wn[Le];Re!==0&&(Y.fromBufferAttribute(Pe,ar),oe.fromBufferAttribute(Pe,Tn),te.fromBufferAttribute(Pe,St),Cr?(pe.addScaledVector(Y,Re),de.addScaledVector(oe,Re),se.addScaledVector(te,Re)):(pe.addScaledVector(Y.sub(U),Re),de.addScaledVector(oe.sub(F),Re),se.addScaledVector(te.sub(j),Re)))}U.add(pe),F.add(de),j.add(se)}cn.isSkinnedMesh&&(cn.applyBoneTransform(ar,U),cn.applyBoneTransform(Tn,F),cn.applyBoneTransform(St,j)),ye[ar*3+0]=U.x,ye[ar*3+1]=U.y,ye[ar*3+2]=U.z,ye[Tn*3+0]=F.x,ye[Tn*3+1]=F.y,ye[Tn*3+2]=F.z,ye[St*3+0]=j.x,ye[St*3+1]=j.y,ye[St*3+2]=j.z}const H=D.geometry,ae=D.material;let ue,Me,De;const Ge=H.index,Xe=H.attributes.position,Je=H.morphAttributes.position,pt=H.morphTargetsRelative,yt=H.attributes.normal,Gt=H.morphAttributes.position,Et=H.groups,Vt=H.drawRange;let Yt,gi,Ri,Ni,Oi,yi,zi;const Cn=new Float32Array(Xe.count*Xe.itemSize),gn=new Float32Array(yt.count*yt.itemSize);if(Ge!==null)if(Array.isArray(ae))for(Yt=0,Ri=Et.length;Yt<Ri;Yt++)for(Oi=Et[Yt],yi=Math.max(Oi.start,Vt.start),zi=Math.min(Oi.start+Oi.count,Vt.start+Vt.count),gi=yi,Ni=zi;gi<Ni;gi+=3)ue=Ge.getX(gi),Me=Ge.getX(gi+1),De=Ge.getX(gi+2),J(D,Xe,Je,pt,ue,Me,De,Cn),J(D,yt,Gt,pt,ue,Me,De,gn);else for(yi=Math.max(0,Vt.start),zi=Math.min(Ge.count,Vt.start+Vt.count),Yt=yi,Ri=zi;Yt<Ri;Yt+=3)ue=Ge.getX(Yt),Me=Ge.getX(Yt+1),De=Ge.getX(Yt+2),J(D,Xe,Je,pt,ue,Me,De,Cn),J(D,yt,Gt,pt,ue,Me,De,gn);else if(Array.isArray(ae))for(Yt=0,Ri=Et.length;Yt<Ri;Yt++)for(Oi=Et[Yt],yi=Math.max(Oi.start,Vt.start),zi=Math.min(Oi.start+Oi.count,Vt.start+Vt.count),gi=yi,Ni=zi;gi<Ni;gi+=3)ue=gi,Me=gi+1,De=gi+2,J(D,Xe,Je,pt,ue,Me,De,Cn),J(D,yt,Gt,pt,ue,Me,De,gn);else for(yi=Math.max(0,Vt.start),zi=Math.min(Xe.count,Vt.start+Vt.count),Yt=yi,Ri=zi;Yt<Ri;Yt+=3)ue=Yt,Me=Yt+1,De=Yt+2,J(D,Xe,Je,pt,ue,Me,De,Cn),J(D,yt,Gt,pt,ue,Me,De,gn);const rr=new f.Float32BufferAttribute(Cn,3),bn=new f.Float32BufferAttribute(gn,3);return{positionAttribute:Xe,normalAttribute:yt,morphedPositionAttribute:rr,morphedNormalAttribute:bn}}function L(D){if(D.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),D;let U=D.groups;if(U=U.sort((te,pe)=>te.materialIndex!==pe.materialIndex?te.materialIndex-pe.materialIndex:te.start-pe.start),D.getIndex()===null){const te=D.getAttribute("position"),pe=[];for(let de=0;de<te.count;de+=3)pe.push(de,de+1,de+2);D.setIndex(pe)}const F=D.getIndex(),j=[];for(let te=0;te<U.length;te++){const pe=U[te],de=pe.start,se=de+pe.count;for(let J=de;J<se;J++)j.push(F.getX(J))}D.dispose(),D.setIndex(j);let Y=0;for(let te=0;te<U.length;te++){const pe=U[te];pe.start=Y,Y+=pe.count}let oe=U[0];D.groups=[oe];for(let te=1;te<U.length;te++){const pe=U[te];oe.materialIndex===pe.materialIndex?oe.count+=pe.count:(oe=pe,D.groups.push(oe))}return D}function P(D,U=Math.PI/3){const F=Math.cos(U),j=(1+1e-10)*100,Y=[new f.Vector3,new f.Vector3,new f.Vector3],oe=new f.Vector3,te=new f.Vector3,pe=new f.Vector3,de=new f.Vector3;function se(De){const Ge=~~(De.x*j),Xe=~~(De.y*j),Je=~~(De.z*j);return`${Ge},${Xe},${Je}`}const J=D.index?D.toNonIndexed():D,H=J.attributes.position,ae={};for(let De=0,Ge=H.count/3;De<Ge;De++){const Xe=3*De,Je=Y[0].fromBufferAttribute(H,Xe+0),pt=Y[1].fromBufferAttribute(H,Xe+1),yt=Y[2].fromBufferAttribute(H,Xe+2);oe.subVectors(yt,pt),te.subVectors(Je,pt);const Gt=new f.Vector3().crossVectors(oe,te).normalize();for(let Et=0;Et<3;Et++){const Vt=Y[Et],Yt=se(Vt);Yt in ae||(ae[Yt]=[]),ae[Yt].push(Gt)}}const ue=new Float32Array(H.count*3),Me=new f.BufferAttribute(ue,3,!1);for(let De=0,Ge=H.count/3;De<Ge;De++){const Xe=3*De,Je=Y[0].fromBufferAttribute(H,Xe+0),pt=Y[1].fromBufferAttribute(H,Xe+1),yt=Y[2].fromBufferAttribute(H,Xe+2);oe.subVectors(yt,pt),te.subVectors(Je,pt),pe.crossVectors(oe,te).normalize();for(let Gt=0;Gt<3;Gt++){const Et=Y[Gt],Vt=se(Et),Yt=ae[Vt];de.set(0,0,0);for(let gi=0,Ri=Yt.length;gi<Ri;gi++){const Ni=Yt[gi];pe.dot(Ni)>F&&de.add(Ni)}de.normalize(),Me.setXYZ(Xe+Gt,de.x,de.y,de.z)}}return J.setAttribute("normal",Me),J}},"./node_modules/three/examples/jsm/utils/WorkerPool.js":(m,M,h)=>{h.r(M),h.d(M,{WorkerPool:()=>f});class f{constructor(p=4){this.pool=p,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(p){if(!this.workers[p]){const g=this.workerCreator();g.addEventListener("message",this._onMessage.bind(this,p)),this.workers[p]=g}}_getIdleWorker(){for(let p=0;p<this.pool;p++)if(!(this.workerStatus&1<<p))return p;return-1}_onMessage(p,g){const u=this.workersResolve[p];if(u&&u(g),this.queue.length){const{resolve:E,msg:b,transfer:x}=this.queue.shift();this.workersResolve[p]=E,this.workers[p].postMessage(b,x)}else this.workerStatus^=1<<p}setWorkerCreator(p){this.workerCreator=p}setWorkerLimit(p){this.pool=p}postMessage(p,g){return new Promise(u=>{const E=this._getIdleWorker();E!==-1?(this._initWorker(E),this.workerStatus|=1<<E,this.workersResolve[E]=u,this.workers[E].postMessage(p,g)):this.queue.push({resolve:u,msg:p,transfer:g})})}dispose(){this.workers.forEach(p=>p.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./src/lib/three.mjs":(m,M,h)=>{h.r(M),h.d(M,{default:()=>w});var f=h("./node_modules/three/build/three.module.js"),C=h("./node_modules/three/examples/jsm/loaders/DRACOLoader.js"),p=h("./node_modules/three/examples/jsm/loaders/GLTFLoader.js"),g=h("./node_modules/three/examples/jsm/loaders/KTX2Loader.js"),u=h("./node_modules/three/examples/jsm/math/OBB.js"),E=h("./node_modules/three/examples/jsm/loaders/OBJLoader.js"),b=h("./node_modules/three/examples/jsm/loaders/MTLLoader.js"),x=h("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js"),T=h("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js"),_={...f};_.DRACOLoader=C.DRACOLoader,_.GLTFLoader=p.GLTFLoader,_.KTX2Loader=g.KTX2Loader,_.OBJLoader=E.OBJLoader,_.MTLLoader=b.MTLLoader,_.OBB=u.OBB,_.BufferGeometryUtils=x,_.LightProbeGenerator=T.LightProbeGenerator;const w=_},"./package.json":m=>{m.exports=JSON.parse('{"name":"aframe","version":"1.6.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.5.0 1.6.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"node --experimental-require-module ./node_modules/mocha/bin/mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"buffer":"^6.0.3","debug":"^4.3.4","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","super-animejs":"^3.1.0","three":"npm:super-three@0.164.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^24.0.0","jsdom-global":"^3.0.2","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},c={};function A(m){var M=c[m];if(M!==void 0)return M.exports;var h=c[m]={id:m,exports:{}};return o[m].call(h.exports,h,h.exports,A),h.exports}A.m=o,A.n=m=>{var M=m&&m.__esModule?()=>m.default:()=>m;return A.d(M,{a:M}),M},A.d=(m,M)=>{for(var h in M)A.o(M,h)&&!A.o(m,h)&&Object.defineProperty(m,h,{enumerable:!0,get:M[h]})},A.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),A.o=(m,M)=>Object.prototype.hasOwnProperty.call(m,M),A.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})},A.b=document.baseURI||self.location.href,A.nc=void 0;var B=A("./src/index.js");return B})())})(U2);const L0=.1;AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(y){const t=this.el;if(this.active&&this.checkpoint!==y){if(this.checkpoint&&t.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=y,this.sync(),this.position.distanceTo(this.targetPosition)<L0){this.checkpoint=null;return}t.emit("navigation-start",{checkpoint:y}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,t.emit("navigation-end",{checkpoint:y}),t.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const y=this.data,t=this.offset,r=this.position,o=this.targetPosition,c=this.checkpoint;return this.sync(),r.distanceTo(o)<L0?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:c}),t.set(0,0,0)):(t.setLength(y.animateSpeed),t)},sync:function(){const y=this.offset,t=this.position,r=this.targetPosition;t.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(r),r.add(this.checkpoint.components.checkpoint.getOffset()),y.copy(r).sub(t)}});var G2=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16});function V2(y,t,r){this.type=y,this.index=t,this.pressed=r.pressed,this.value=r.value}var z2=V2;const Ol=G2,Fp=z2,oa=.2,Do={LEFT:"left",RIGHT:"right"},Po={MOVEMENT:1,ROTATION:2};AFRAME.registerComponent("gamepad-controls",{GamepadButton:Ol,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){const y=this.el.sceneEl;this.system=y.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const t=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=t.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=t.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,y.addBehavior(this)},update:function(){this.tick()},tick:function(y,t){this.updateButtonState(),this.updateRotation(t)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const y=this._dpadVector,t=this._moveVector;this.getDpad(y),this.getJoystick(Po.MOVEMENT,t);const r=y.x||t.x,o=y.y||t.y;return Math.abs(r)>oa||Math.abs(o)>oa},getVelocityDelta:function(){const y=this._dpadVector,t=this._moveVector;this.getDpad(y),this.getJoystick(Po.MOVEMENT,t);const r=y.x||t.x,o=y.y||t.y,c=new THREE.Vector3;return Math.abs(r)>oa&&(c.x+=r),Math.abs(o)>oa&&(c.z+=o),c},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const y=this._lookVector;return this.getJoystick(Po.ROTATION,y),Math.abs(y.x)>oa||Math.abs(y.y)>oa},updateRotation:function(y){if(!this.isRotationActive())return;const t=this.data,r=this.yaw,o=this.pitch;r.rotation.y=this.el.object3D.rotation.y,o.rotation.x=this.el.object3D.rotation.x;const c=this._lookVector;this.getJoystick(Po.ROTATION,c),Math.abs(c.x)<=oa&&(c.x=0),Math.abs(c.y)<=oa&&(c.y=0),c.multiplyScalar(t.rotationSensitivity*y/1e3),r.rotation.y-=c.x,o.rotation.x-=c.y,o.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,o.rotation.x)),this.el.object3D.rotation.set(o.rotation.x,r.rotation.y,0)},updateButtonState:function(){const y=this.getGamepad(Do.RIGHT);if(this.data.enabled&&y)for(var t=0;t<y.buttons.length;t++)y.buttons[t].pressed&&!this.buttons[t]?this.emit(new Fp("gamepadbuttondown",t,y.buttons[t])):!y.buttons[t].pressed&&this.buttons[t]&&this.emit(new Fp("gamepadbuttonup",t,y.buttons[t])),this.buttons[t]=y.buttons[t].pressed;else for(const r in this.buttons)this.buttons[r]=!1},emit:function(y){this.el.emit(y.type,y),this.el.emit(y.type+":"+y.index,new Fp(y.type,y.index,y))},getGamepad:function(){const y=[],t=[];return function(r){const o=this.el.sceneEl.components["proxy-controls"],c=o&&o.isConnected()&&o.getGamepad(0);if(c)return c;y.length=0;for(let B=0;B<this.system.controllers.length;B++){const m=this.system.controllers[B],M=m?m.gamepad:null;if(y.push(M),M&&m.handedness===r)return M}const A=navigator.getGamepads?navigator.getGamepads():t;for(let B=0;B<A.length;B++){const m=A[B];if(m&&m.hand===r)return m}return y[0]||A[0]}}(),getButton:function(y){return this.getGamepad(Do.RIGHT).buttons[y]},getAxis:function(y){return this.getGamepad(y>1?Do.RIGHT:Do.LEFT).axes[y]},getJoystick:function(y,t){const r=this.getGamepad(y===Po.MOVEMENT?Do.LEFT:Do.RIGHT);if(!r)return t.set(0,0);if(r.mapping==="xr-standard")switch(y){case Po.MOVEMENT:return t.set(r.axes[2],r.axes[3]);case Po.ROTATION:return t.set(r.axes[2],0)}else switch(y){case Po.MOVEMENT:return t.set(r.axes[0],r.axes[1]);case Po.ROTATION:return t.set(r.axes[2],r.axes[3])}throw new Error('Unexpected joystick index "%d".',y)},getDpad:function(y){const t=this.getGamepad(Do.LEFT);return!t||!t.buttons[Ol.DPAD_RIGHT]?y.set(0,0):y.set((t.buttons[Ol.DPAD_RIGHT].pressed?1:0)+(t.buttons[Ol.DPAD_LEFT].pressed?-1:0),(t.buttons[Ol.DPAD_UP].pressed?-1:0)+(t.buttons[Ol.DPAD_DOWN].pressed?1:0))},isConnected:function(){const y=this.getGamepad(Do.LEFT);return!!(y&&y.connected)},getID:function(){return this.getGamepad(Do.LEFT).id}});(function(y){var t="KeyboardEvent"in y;t||(y.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in y.KeyboardEvent||(y.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in y.KeyboardEvent||(y.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in y.KeyboardEvent||(y.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in y.KeyboardEvent||(y.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var r=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,o=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,c=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,A=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function B(S,L){return String(S).indexOf(L)!==-1}var m=function(){return B(navigator.platform,"Win")?"win":B(navigator.platform,"Mac")?"mac":B(navigator.platform,"CrOS")?"cros":B(navigator.platform,"Linux")?"linux":B(navigator.userAgent,"iPad")||B(navigator.platform,"iPod")||B(navigator.platform,"iPhone")?"ios":""}(),M=function(){return B(navigator.userAgent,"Chrome/")?"chrome":B(navigator.vendor,"Apple")?"safari":B(navigator.userAgent,"MSIE")?"ie":B(navigator.userAgent,"Gecko/")?"moz":B(navigator.userAgent,"Opera/")?"opera":""}(),h=M+"-"+m;function f(S,L,P){(h===L||M===L||m===L)&&Object.keys(P).forEach(function(D){S[D]=P[D]})}function C(S,L){var P={};return Object.keys(S).forEach(function(D){var U=S[D];L in U&&(P[U[L]]=U)}),P}var p={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:o},92:{code:"OSRight",location:c},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:A},97:{code:"Numpad1",keyCap:"1",location:A},98:{code:"Numpad2",keyCap:"2",location:A},99:{code:"Numpad3",keyCap:"3",location:A},100:{code:"Numpad4",keyCap:"4",location:A},101:{code:"Numpad5",keyCap:"5",location:A},102:{code:"Numpad6",keyCap:"6",location:A},103:{code:"Numpad7",keyCap:"7",location:A},104:{code:"Numpad8",keyCap:"8",location:A},105:{code:"Numpad9",keyCap:"9",location:A},106:{code:"NumpadMultiply",keyCap:"*",location:A},107:{code:"NumpadAdd",keyCap:"+",location:A},108:{code:"NumpadComma",keyCap:",",location:A},109:{code:"NumpadSubtract",keyCap:"-",location:A},110:{code:"NumpadDecimal",keyCap:".",location:A},111:{code:"NumpadDivide",keyCap:"/",location:A},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:A},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:o},161:{code:"ShiftRight",location:c},162:{code:"ControlLeft",location:o},163:{code:"ControlRight",location:c},164:{code:"AltLeft",location:o},165:{code:"AltRight",location:c},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};f(p,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:A},189:{code:"NumpadSubtract",keyCap:"-",location:A}}),f(p,"moz-mac",{12:{code:"NumLock",location:A},173:{code:"Minus",keyCap:"-"}}),f(p,"moz-win",{173:{code:"Minus",keyCap:"-"}}),f(p,"chrome-mac",{93:{code:"OSRight",location:c}}),f(p,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),f(p,"ios",{10:{code:"Enter",location:r}}),f(p,"safari-mac",{91:{code:"OSLeft",location:o},93:{code:"OSRight",location:c},229:{code:"KeyQ",keyCap:"Q"}});var g={};m==="cros"&&(g["U+00A0"]={code:"ShiftLeft",location:o},g["U+00A1"]={code:"ShiftRight",location:c},g["U+00A2"]={code:"ControlLeft",location:o},g["U+00A3"]={code:"ControlRight",location:c},g["U+00A4"]={code:"AltLeft",location:o},g["U+00A5"]={code:"AltRight",location:c}),h==="chrome-mac"&&(g["U+0010"]={code:"ContextMenu"}),h==="safari-mac"&&(g["U+0010"]={code:"ContextMenu"}),m==="ios"&&(g["U+0010"]={code:"Function"},g["U+001C"]={code:"ArrowLeft"},g["U+001D"]={code:"ArrowRight"},g["U+001E"]={code:"ArrowUp"},g["U+001F"]={code:"ArrowDown"},g["U+0001"]={code:"Home"},g["U+0004"]={code:"End"},g["U+000B"]={code:"PageUp"},g["U+000C"]={code:"PageDown"});var u=[];u[o]={16:{code:"ShiftLeft",location:o},17:{code:"ControlLeft",location:o},18:{code:"AltLeft",location:o}},u[c]={16:{code:"ShiftRight",location:c},17:{code:"ControlRight",location:c},18:{code:"AltRight",location:c}},u[A]={13:{code:"NumpadEnter",location:A}},f(u[A],"moz",{109:{code:"NumpadSubtract",location:A},107:{code:"NumpadAdd",location:A}}),f(u[o],"moz-mac",{224:{code:"OSLeft",location:o}}),f(u[c],"moz-mac",{224:{code:"OSRight",location:c}}),f(u[c],"moz-win",{91:{code:"OSRight",location:c}}),f(u[c],"mac",{93:{code:"OSRight",location:c}}),f(u[A],"chrome-mac",{12:{code:"NumLock",location:A}}),f(u[A],"safari-mac",{12:{code:"NumLock",location:A},187:{code:"NumpadAdd",location:A},189:{code:"NumpadSubtract",location:A},190:{code:"NumpadDecimal",location:A},191:{code:"NumpadDivide",location:A}});var E={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};f(E,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var b={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},x=C(p,"code");try{var T=t&&"location"in new KeyboardEvent("")}catch{}function _(S){var L="keyCode"in S?S.keyCode:"which"in S?S.which:0,P=function(){if(T||"keyLocation"in S){var U=T?S.location:S.keyLocation;if(U&&L in u[U])return u[U][L]}return"keyIdentifier"in S&&S.keyIdentifier in g?g[S.keyIdentifier]:L in p?p[L]:null}();if(!P)return null;var D=function(){var U=E[P.code];return U?S.shiftKey&&"shiftKey"in U?U.shiftKey:U.key:P.code}();return{code:P.code,key:D,location:P.location,keyCap:P.keyCap}}function w(S,L){if(S=String(S),!x.hasOwnProperty(S))return"Undefined";if(L&&String(L).toLowerCase()!=="en-us")throw Error("Unsupported locale");var P=x[S];return P.keyCap||P.code||"Undefined"}"KeyboardEvent"in y&&"defineProperty"in Object&&function(){function S(P,D,U){D in P||Object.defineProperty(P,D,U)}if(S(KeyboardEvent.prototype,"code",{get:function(){var P=_(this);return P?P.code:""}}),"key"in KeyboardEvent.prototype){var L=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var P=L.get.call(this);return b.hasOwnProperty(P)?b[P]:P}})}S(KeyboardEvent.prototype,"key",{get:function(){var P=_(this);return P&&"key"in P?P.key:"Unidentified"}}),S(KeyboardEvent.prototype,"location",{get:function(){var P=_(this);return P&&"location"in P?P.location:r}}),S(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in y.KeyboardEvent||(y.KeyboardEvent.queryKeyCap=w),y.identifyKey=function(S){if(!("code"in S)){var L=_(S);S.code=L?L.code:"",S.key=L&&"key"in L?L.key:"Unidentified",S.location="location"in S?S.location:"keyLocation"in S?S.keyLocation:L&&"location"in L?L.location:r,S.locale=""}}})(window);const Q2="__keyboard-controls-proxy",H2=window.KeyboardEvent;AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const y=this.data,t=this.getKeys();return this.dVelocity.set(0,0,0),y.enabled&&((t.KeyW||t.ArrowUp)&&(this.dVelocity.z-=1),(t.KeyA||t.ArrowLeft)&&(this.dVelocity.x-=1),(t.KeyS||t.ArrowDown)&&(this.dVelocity.z+=1),(t.KeyD||t.ArrowRight)&&(this.dVelocity.x+=1),t.ShiftLeft&&(this.dVelocity=this.dVelocity.multiplyScalar(2))),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(const y in this.localKeys)this.localKeys.hasOwnProperty(y)&&delete this.localKeys[y]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(y){AFRAME.utils.shouldCaptureKeyEvent(y)&&(this.localKeys[y.code]=!0,this.emit(y))},onKeyUp:function(y){AFRAME.utils.shouldCaptureKeyEvent(y)&&(delete this.localKeys[y.code],this.emit(y))},onBlur:function(){for(const y in this.localKeys)this.localKeys.hasOwnProperty(y)&&delete this.localKeys[y]},emit:function(y){Q2 in y&&this.el.emit(y.type,y),this.el.emit(y.type+":"+y.code,new H2(y.type,y)),this.data.debug&&console.log(y.type+":"+y.code)},isPressed:function(y){return y in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const y=this.el.sceneEl.components["proxy-controls"];return y&&y.isConnected()}});AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const y=this.el.sceneEl,t=y.canvas;if(!t){y.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd,{passive:!0});const r=y.getAttribute("vr-mode-ui");r&&r.cardboardModeEnabled&&y.addEventListener("enter-vr",this.onEnterVR)},removeEventListeners:function(){const y=this.el.sceneEl&&this.el.sceneEl.canvas;y&&(y.removeEventListener("touchstart",this.onTouchStart),y.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function(y){this.direction=-1,this.data.reverseEnabled&&y.touches&&y.touches.length===2&&(this.direction=1),y.preventDefault()},onTouchEnd:function(y){this.direction=0,y.preventDefault()},onEnterVR:function(){const y=this.el.sceneEl.xrSession;y&&(y.addEventListener("selectstart",this.onTouchStart),y.addEventListener("selectend",this.onTouchEnd))}});const Np="-controls",j2=.2,W2=1e-5,K2="moved";AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const y=this.el;this.data.camera||(this.data.camera=y.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.eventDetail={},this.navGroup=null,this.navNode=null,y.sceneEl.hasLoaded?this.injectControls():y.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(y){const t=this.el,r=this.data,o=t.sceneEl.systems.nav;if(t.sceneEl.hasLoaded&&this.injectControls(),o&&r.constrainToNavMesh!==y.constrainToNavMesh&&(r.constrainToNavMesh?o.addAgent(this):o.removeAgent(this)),r.enabled!==y.enabled)for(let c=0;c<r.controls.length;c++){const A=r.controls[c]+Np;this.el.setAttribute(A,{enabled:this.data.enabled})}},injectControls:function(){const y=this.data;for(let t=0;t<y.controls.length;t++){const r=y.controls[t]+Np;this.el.setAttribute(r,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const y=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Vector3;return function(o,c){if(!c)return;const A=this.el,B=this.data;if(!B.enabled)return;this.updateVelocityCtrl();const m=this.velocityCtrl,M=this.velocity;if(m)if(c/1e3>j2?M.set(0,0,0):this.updateVelocity(c),B.constrainToNavMesh&&m.isNavMeshConstrained!==!1){if(M.lengthSq()<W2)return;y.copy(A.object3D.position),t.copy(M).multiplyScalar(c/1e3).add(y);const h=A.sceneEl.systems.nav;this.navGroup=this.navGroup===null?h.getGroup(y):this.navGroup,this.navNode=this.navNode||h.getNode(y,this.navGroup),this.navNode=h.clampStep(y,t,this.navGroup,this.navNode,r),A.object3D.position.copy(r)}else A.hasAttribute("velocity")?A.setAttribute("velocity",M):(A.object3D.position.x+=M.x*c/1e3,A.object3D.position.y+=M.y*c/1e3,A.object3D.position.z+=M.z*c/1e3)}}(),updateVelocityCtrl:function(){const y=this.data;if(y.enabled){for(let t=0,r=y.controls.length;t<r;t++){const o=this.el.components[y.controls[t]+Np];if(o&&o.isVelocityActive()){this.velocityCtrl=o;return}}this.velocityCtrl=null}},updateVelocity:function(){const y=new THREE.Vector2,t=new THREE.Quaternion;return function(r){let o;const c=this.el,A=this.velocityCtrl,B=this.velocity,m=this.data;if(A)if(A.getVelocityDelta)o=A.getVelocityDelta(r);else if(A.getVelocity){B.copy(A.getVelocity());return}else if(A.getPositionDelta){B.copy(A.getPositionDelta(r).multiplyScalar(1e3/r));return}else throw new Error("Incompatible movement controls: ",A);if(c.hasAttribute("velocity")&&!m.constrainToNavMesh&&B.copy(this.el.getAttribute("velocity")),o&&m.enabled){const M=m.camera;t.copy(M.object3D.quaternion),t.premultiply(c.object3D.quaternion),o.applyQuaternion(t);const h=o.length();m.fly?(B.copy(o),B.multiplyScalar(this.data.speed*16.66667)):(y.set(o.x,o.z),y.setLength(h*this.data.speed*16.66667),B.x=y.x,B.y=0,B.z=y.y),(B.x!==0||B.y!==0||B.z!==0)&&(this.eventDetail.velocity=B,this.el.emit(K2,this.eventDetail))}}}()});AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const y=this.data,t=this.el.sceneEl;switch(t.addEventListener("axismove",this.onAxisMove),y.mode){case"swipe":case"touch":t.addEventListener("trackpadtouchstart",this.onTouchStart),t.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":t.addEventListener("trackpaddown",this.onTouchStart),t.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const y=this.el.sceneEl;y.removeEventListener("axismove",this.onAxisMove),y.removeEventListener("trackpadtouchstart",this.onTouchStart),y.removeEventListener("trackpadtouchend",this.onTouchEnd),y.removeEventListener("trackpaddown",this.onTouchStart),y.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(y){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}y.preventDefault()},onTouchEnd:function(y){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,y.preventDefault()},onAxisMove:function(y){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(y);case"touch":case"press":return this.handleTouchAxis(y)}},handleSwipeAxis:function(y){const t=this.data,r=y.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=r[0],this.startingAxisData[1]=r[1]),this.startingAxisData.length>0){let o=0,c=0;t.enableNegX&&r[0]<this.startingAxisData[0]&&(o=-1),t.enablePosX&&r[0]>this.startingAxisData[0]&&(o=1),t.enablePosZ&&r[1]>this.startingAxisData[1]&&(c=-1),t.enableNegZ&&r[1]<this.startingAxisData[1]&&(c=1);const A=Math.abs(this.startingAxisData[1]-r[1]);Math.abs(this.startingAxisData[0]-r[0])>A?(this.zVel=0,this.xVel=o,this.isMoving=!0):(this.xVel=0,this.zVel=c,this.isMoving=!0)}},handleTouchAxis:function(y){const t=this.data,r=y.detail.axis;let o=0,c=0;t.enableNegX&&r[0]<0&&(o=-1),t.enablePosX&&r[0]>0&&(o=1),t.enablePosZ&&r[1]>0&&(c=-1),t.enableNegZ&&r[1]<0&&(c=1),Math.abs(r[0])>Math.abs(r[1])?(this.zVel=0,this.xVel=o):(this.xVel=0,this.zVel=c)}});const gd=(y,t)=>{const r=t.x-y.x,o=t.y-y.y;return Math.sqrt(r*r+o*o)},X2=(y,t)=>{const r=t.x-y.x,o=t.y-y.y;return q2(Math.atan2(o,r))},Y2=(y,t,r)=>{const o={x:0,y:0};return r=vA(r),o.x=y.x-t*Math.cos(r),o.y=y.y-t*Math.sin(r),o},vA=y=>y*(Math.PI/180),q2=y=>y*(180/Math.PI),J2=y=>isNaN(y.buttons)?y.pressure!==0:y.buttons!==0,kp=new Map,D0=y=>{kp.has(y)&&clearTimeout(kp.get(y)),kp.set(y,setTimeout(y,100))},vd=(y,t,r)=>{const o=t.split(/[ ,]+/g);let c;for(let A=0;A<o.length;A+=1)c=o[A],y.addEventListener?y.addEventListener(c,r,!1):y.attachEvent&&y.attachEvent(c,r)},P0=(y,t,r)=>{const o=t.split(/[ ,]+/g);let c;for(let A=0;A<o.length;A+=1)c=o[A],y.removeEventListener?y.removeEventListener(c,r):y.detachEvent&&y.detachEvent(c,r)},Gv=y=>(y.preventDefault(),y.type.match(/^touch/)?y.changedTouches:y),O0=()=>{const y=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:y,y:t}},F0=(y,t)=>{t.top||t.right||t.bottom||t.left?(y.style.top=t.top,y.style.right=t.right,y.style.bottom=t.bottom,y.style.left=t.left):(y.style.left=t.x+"px",y.style.top=t.y+"px")},IA=(y,t,r)=>{const o=Vv(y);for(let c in o)if(o.hasOwnProperty(c))if(typeof t=="string")o[c]=t+" "+r;else{let A="";for(let B=0,m=t.length;B<m;B+=1)A+=t[B]+" "+r+", ";o[c]=A.slice(0,-2)}return o},Z2=(y,t)=>{const r=Vv(y);for(let o in r)r.hasOwnProperty(o)&&(r[o]=t);return r},Vv=y=>{const t={};return t[y]="",["webkit","Moz","o"].forEach(function(o){t[o+y.charAt(0).toUpperCase()+y.slice(1)]=""}),t},Up=(y,t)=>{for(let r in t)t.hasOwnProperty(r)&&(y[r]=t[r]);return y},$2=(y,t)=>{const r={};for(let o in y)y.hasOwnProperty(o)&&t.hasOwnProperty(o)?r[o]=t[o]:y.hasOwnProperty(o)&&(r[o]=y[o]);return r},yA=(y,t)=>{if(y.length)for(let r=0,o=y.length;r<o;r+=1)t(y[r]);else t(y)},ew=(y,t,r)=>({x:Math.min(Math.max(y.x,t.x-r),t.x+r),y:Math.min(Math.max(y.y,t.y-r),t.y+r)});var tw="ontouchstart"in window,iw=!!window.PointerEvent,nw=!!window.MSPointerEvent,jc={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},$l,sh={};iw?$l=jc.pointer:nw?$l=jc.MSPointer:tw?($l=jc.touch,sh=jc.mouse):$l=jc.mouse;function Vo(){}Vo.prototype.on=function(y,t){var r=this,o=y.split(/[ ,]+/g),c;r._handlers_=r._handlers_||{};for(var A=0;A<o.length;A+=1)c=o[A],r._handlers_[c]=r._handlers_[c]||[],r._handlers_[c].push(t);return r};Vo.prototype.off=function(y,t){var r=this;return r._handlers_=r._handlers_||{},y===void 0?r._handlers_={}:t===void 0?r._handlers_[y]=null:r._handlers_[y]&&r._handlers_[y].indexOf(t)>=0&&r._handlers_[y].splice(r._handlers_[y].indexOf(t),1),r};Vo.prototype.trigger=function(y,t){var r=this,o=y.split(/[ ,]+/g),c;r._handlers_=r._handlers_||{};for(var A=0;A<o.length;A+=1)c=o[A],r._handlers_[c]&&r._handlers_[c].length&&r._handlers_[c].forEach(function(B){B.call(r,{type:c,target:r},t)})};Vo.prototype.config=function(y){var t=this;t.options=t.defaults||{},y&&(t.options=$2(t.options,y))};Vo.prototype.bindEvt=function(y,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},vd(y,$l[t],r._domHandlers_[t]),sh[t]&&vd(y,sh[t],r._domHandlers_[t]),r};Vo.prototype.unbindEvt=function(y,t){var r=this;return r._domHandlers_=r._domHandlers_||{},P0(y,$l[t],r._domHandlers_[t]),sh[t]&&P0(y,sh[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};function Fr(y,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=y,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Fr.id,Fr.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Fr.prototype=new Vo;Fr.constructor=Fr;Fr.id=0;Fr.prototype.buildEl=function(y){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Fr.prototype.stylize=function(){if(this.options.dataOnly)return this;var y=this.options.fadeTime+"ms",t=Z2("borderRadius","50%"),r=IA("transition","opacity",y),o={};return o.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},o.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},o.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},Up(o.el,r),this.options.shape==="circle"&&Up(o.back,t),Up(o.front,t),this.applyStyles(o),this};Fr.prototype.applyStyles=function(y){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in y[t])this.ui[t].style[r]=y[t][r];return this};Fr.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Fr.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Fr.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Fr.prototype.show=function(y){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof y=="function"&&y.call(this)},t.options.fadeTime)),t};Fr.prototype.hide=function(y){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof y=="function"&&y.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){const r=t.options.restJoystick,o={};o.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,o.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(y,o)}return t};Fr.prototype.setPosition=function(y,t){var r=this;r.frontPosition={x:t.x,y:t.y};var o=r.options.fadeTime+"ms",c={};c.front=IA("transition",["transform"],o);var A={front:{}};A.front={transform:"translate("+r.frontPosition.x+"px,"+r.frontPosition.y+"px)"},r.applyStyles(c),r.applyStyles(A),r.restTimeout=setTimeout(function(){typeof y=="function"&&y.call(r),r.restCallback()},r.options.fadeTime)};Fr.prototype.restCallback=function(){var y=this,t={};t.front=IA("transition","none",""),y.applyStyles(t),y.trigger("rested",y.instance)};Fr.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Fr.prototype.computeDirection=function(y){var t=y.angle.radian,r=Math.PI/4,o=Math.PI/2,c,A,B;if(t>r&&t<r*3&&!y.lockX?c="up":t>-r&&t<=r&&!y.lockY?c="left":t>-r*3&&t<=-r&&!y.lockX?c="down":y.lockY||(c="right"),y.lockY||(t>-o&&t<o?A="left":A="right"),y.lockX||(t>0?B="up":B="down"),y.force>this.options.threshold){var m={},M;for(M in this.direction)this.direction.hasOwnProperty(M)&&(m[M]=this.direction[M]);var h={};this.direction={x:A,y:B,angle:c},y.direction=this.direction;for(M in m)m[M]===this.direction[M]&&(h[M]=!0);if(h.x&&h.y&&h.angle)return y;(!h.x||!h.y)&&this.trigger("plain",y),h.x||this.trigger("plain:"+A,y),h.y||this.trigger("plain:"+B,y),h.angle||this.trigger("dir dir:"+c,y)}else this.resetDirection();return y};function xr(y,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=y,r.id=xr.id,xr.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);const o=getComputedStyle(r.options.zone.parentElement);return o&&o.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}xr.prototype=new Vo;xr.constructor=xr;xr.id=0;xr.prototype.prepareNipples=function(){var y=this,t=y.nipples;t.on=y.on.bind(y),t.off=y.off.bind(y),t.options=y.options,t.destroy=y.destroy.bind(y),t.ids=y.ids,t.id=y.id,t.processOnMove=y.processOnMove.bind(y),t.processOnEnd=y.processOnEnd.bind(y),t.get=function(r){if(r===void 0)return t[0];for(var o=0,c=t.length;o<c;o+=1)if(t[o].identifier===r)return t[o];return!1}};xr.prototype.bindings=function(){var y=this;y.bindEvt(y.options.zone,"start"),y.options.zone.style.touchAction="none",y.options.zone.style.msTouchAction="none"};xr.prototype.begin=function(){var y=this,t=y.options;if(t.mode==="static"){var r=y.createNipple(t.position,y.manager.getIdentifier());r.add(),y.idles.push(r)}};xr.prototype.createNipple=function(y,t){var r=this,o=r.manager.scroll,c={},A=r.options,B={x:r.parentIsFlex?o.x:o.x+r.box.left,y:r.parentIsFlex?o.y:o.y+r.box.top};if(y.x&&y.y)c={x:y.x-B.x,y:y.y-B.y};else if(y.top||y.right||y.bottom||y.left){var m=document.createElement("DIV");m.style.display="hidden",m.style.top=y.top,m.style.right=y.right,m.style.bottom=y.bottom,m.style.left=y.left,m.style.position="absolute",A.zone.appendChild(m);var M=m.getBoundingClientRect();A.zone.removeChild(m),c=y,y={x:M.left+o.x,y:M.top+o.y}}var h=new Fr(r,{color:A.color,size:A.size,threshold:A.threshold,fadeTime:A.fadeTime,dataOnly:A.dataOnly,restJoystick:A.restJoystick,restOpacity:A.restOpacity,mode:A.mode,identifier:t,position:y,zone:A.zone,frontPosition:{x:0,y:0},shape:A.shape});return A.dataOnly||(F0(h.ui.el,c),F0(h.ui.front,h.frontPosition)),r.nipples.push(h),r.trigger("added "+h.identifier+":added",h),r.manager.trigger("added "+h.identifier+":added",h),r.bindNipple(h),h};xr.prototype.updateBox=function(){var y=this;y.box=y.options.zone.getBoundingClientRect()};xr.prototype.bindNipple=function(y){var t=this,r,o=function(c,A){r=c.type+" "+A.id+":"+c.type,t.trigger(r,A)};y.on("destroyed",t.onDestroyed.bind(t)),y.on("shown hidden rested dir plain",o),y.on("dir:up dir:right dir:down dir:left",o),y.on("plain:up plain:right plain:down plain:left",o)};xr.prototype.pressureFn=function(y,t,r){var o=this,c=0;clearInterval(o.pressureIntervals[r]),o.pressureIntervals[r]=setInterval((function(){var A=y.force||y.pressure||y.webkitForce||0;A!==c&&(t.trigger("pressure",A),o.trigger("pressure "+t.identifier+":pressure",A),c=A)}).bind(o),100)};xr.prototype.onstart=function(y){var t=this,r=t.options,o=y;y=Gv(y),t.updateBox();var c=function(A){t.actives.length<r.maxNumberOfNipples?t.processOnStart(A):o.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(B){if(Object.values(o.touches).findIndex(function(M){return M.identifier===B})<0){var m=[y[0]];m.identifier=B,t.processOnEnd(m)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(A))};return yA(y,c),t.manager.bindDocument(),!1};xr.prototype.processOnStart=function(y){var t=this,r=t.options,o,c=t.manager.getIdentifier(y),A=y.force||y.pressure||y.webkitForce||0,B={x:y.pageX,y:y.pageY},m=t.getOrCreate(c,B);m.identifier!==c&&t.manager.removeIdentifier(m.identifier),m.identifier=c;var M=function(f){f.trigger("start",f),t.trigger("start "+f.id+":start",f),f.show(),A>0&&t.pressureFn(y,f,f.identifier),t.processOnMove(y)};if((o=t.idles.indexOf(m))>=0&&t.idles.splice(o,1),t.actives.push(m),t.ids.push(m.identifier),r.mode!=="semi")M(m);else{var h=gd(B,m.position);if(h<=r.catchDistance)M(m);else{m.destroy(),t.processOnStart(y);return}}return m};xr.prototype.getOrCreate=function(y,t){var r=this,o=r.options,c;return/(semi|static)/.test(o.mode)?(c=r.idles[0],c?(r.idles.splice(0,1),c):o.mode==="semi"?r.createNipple(t,y):(console.warn("Coudln't find the needed nipple."),!1)):(c=r.createNipple(t,y),c)};xr.prototype.processOnMove=function(y){var t=this,r=t.options,o=t.manager.getIdentifier(y),c=t.nipples.get(o),A=t.manager.scroll;if(!J2(y)){this.processOnEnd(y);return}if(!c){console.error("Found zombie joystick with ID "+o),t.manager.removeIdentifier(o);return}if(r.dynamicPage){var B=c.el.getBoundingClientRect();c.position={x:A.x+B.left,y:A.y+B.top}}c.identifier=o;var m=c.options.size/2,M={x:y.pageX,y:y.pageY};r.lockX&&(M.y=c.position.y),r.lockY&&(M.x=c.position.x);var h=gd(M,c.position),f=X2(M,c.position),C=vA(f),p=h/m,g={distance:h,position:M},u,E;if(c.options.shape==="circle"?(u=Math.min(h,m),E=Y2(c.position,u,f)):(E=ew(M,c.position,m),u=gd(E,c.position)),r.follow){if(h>m){let _=M.x-E.x,w=M.y-E.y;c.position.x+=_,c.position.y+=w,c.el.style.top=c.position.y-(t.box.top+A.y)+"px",c.el.style.left=c.position.x-(t.box.left+A.x)+"px",h=gd(M,c.position)}}else M=E,h=u;var b=M.x-c.position.x,x=M.y-c.position.y;c.frontPosition={x:b,y:x},r.dataOnly||(c.ui.front.style.transform="translate("+b+"px,"+x+"px)");var T={identifier:c.identifier,position:M,force:p,pressure:y.force||y.pressure||y.webkitForce||0,distance:h,angle:{radian:C,degree:f},vector:{x:b/m,y:-x/m},raw:g,instance:c,lockX:r.lockX,lockY:r.lockY};T=c.computeDirection(T),T.angle={radian:vA(180-f),degree:180-f},c.trigger("move",T),t.trigger("move "+c.id+":move",T)};xr.prototype.processOnEnd=function(y){var t=this,r=t.options,o=t.manager.getIdentifier(y),c=t.nipples.get(o),A=t.manager.removeIdentifier(c.identifier);c&&(r.dataOnly||c.hide(function(){r.mode==="dynamic"&&(c.trigger("removed",c),t.trigger("removed "+c.id+":removed",c),t.manager.trigger("removed "+c.id+":removed",c),c.destroy())}),clearInterval(t.pressureIntervals[c.identifier]),c.resetDirection(),c.trigger("end",c),t.trigger("end "+c.id+":end",c),t.ids.indexOf(c.identifier)>=0&&t.ids.splice(t.ids.indexOf(c.identifier),1),t.actives.indexOf(c)>=0&&t.actives.splice(t.actives.indexOf(c),1),/(semi|static)/.test(r.mode)?t.idles.push(c):t.nipples.indexOf(c)>=0&&t.nipples.splice(t.nipples.indexOf(c),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[A.id]=A.identifier))};xr.prototype.onDestroyed=function(y,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};xr.prototype.destroy=function(){var y=this;y.unbindEvt(y.options.zone,"start"),y.nipples.forEach(function(r){r.destroy()});for(var t in y.pressureIntervals)y.pressureIntervals.hasOwnProperty(t)&&clearInterval(y.pressureIntervals[t]);y.trigger("destroyed",y.nipples),y.manager.unbindDocument(),y.off()};function zr(y){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=O0(),t.config(y),t.prepareCollections();var r=function(){var c;t.collections.forEach(function(A){A.forEach(function(B){c=B.el.getBoundingClientRect(),B.position={x:t.scroll.x+c.left,y:t.scroll.y+c.top}})})};vd(window,"resize",function(){D0(r)});var o=function(){t.scroll=O0()};return vd(window,"scroll",function(){D0(o)}),t.collections}zr.prototype=new Vo;zr.constructor=zr;zr.prototype.prepareCollections=function(){var y=this;y.collections.create=y.create.bind(y),y.collections.on=y.on.bind(y),y.collections.off=y.off.bind(y),y.collections.destroy=y.destroy.bind(y),y.collections.get=function(t){var r;return y.collections.every(function(o){return r=o.get(t),!r}),r}};zr.prototype.create=function(y){return this.createCollection(y)};zr.prototype.createCollection=function(y){var t=this,r=new xr(t,y);return t.bindCollection(r),t.collections.push(r),r};zr.prototype.bindCollection=function(y){var t=this,r,o=function(c,A){r=c.type+" "+A.id+":"+c.type,t.trigger(r,A)};y.on("destroyed",t.onDestroyed.bind(t)),y.on("shown hidden rested dir plain",o),y.on("dir:up dir:right dir:down dir:left",o),y.on("plain:up plain:right plain:down plain:left",o)};zr.prototype.bindDocument=function(){var y=this;y.binded||(y.bindEvt(document,"move").bindEvt(document,"end"),y.binded=!0)};zr.prototype.unbindDocument=function(y){var t=this;(!Object.keys(t.ids).length||y===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};zr.prototype.getIdentifier=function(y){var t;return y?(t=y.identifier===void 0?y.pointerId:y.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};zr.prototype.removeIdentifier=function(y){var t={};for(var r in this.ids)if(this.ids[r]===y){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};zr.prototype.onmove=function(y){var t=this;return t.onAny("move",y),!1};zr.prototype.onend=function(y){var t=this;return t.onAny("end",y),!1};zr.prototype.oncancel=function(y){var t=this;return t.onAny("end",y),!1};zr.prototype.onAny=function(y,t){var r=this,o,c="processOn"+y.charAt(0).toUpperCase()+y.slice(1);t=Gv(t);var A=function(m,M,h){h.ids.indexOf(M)>=0&&(h[c](m),m._found_=!0)},B=function(m){o=r.getIdentifier(m),yA(r.collections,A.bind(null,m,o)),m._found_||r.removeIdentifier(o)};return yA(t,B),!1};zr.prototype.destroy=function(){var y=this;y.unbindDocument(!0),y.ids={},y.index=0,y.collections.forEach(function(t){t.destroy()}),y.off()};zr.prototype.onDestroyed=function(y,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};const N0=new zr,k0={create:function(y){return N0.create(y)},factory:N0};AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;const y=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=y.pitchObject,this.yawObject=y.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update(y){(this.data.moveJoystickPosition!==y.moveJoystickPosition||this.data.sideMargin!==y.sideMargin||this.data.bottomMargin!==y.bottomMargin||this.data.mode!==y.mode)&&this.removeMoveJoystick(),(this.data.lookJoystickPosition!==y.lookJoystickPosition||this.data.sideMargin!==y.sideMargin||this.data.bottomMargin!==y.bottomMargin||this.data.mode!==y.mode)&&this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause(){this.moving=!1,this.rotating=!1},remove(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive(){return this.data.enabled&&this.moving},getVelocityDelta(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){const y=this.moveData.force<1?this.moveData.force:1,t=this.moveData.angle.radian,r=Math.cos(t)*y,o=-Math.sin(t)*y;this.dVelocity.set(r,0,o)}return this.dVelocity},isRotationActive(){return this.data.enabled&&this.rotating},updateRotation(y){if(!this.isRotationActive())return;const t=this.lookData.force<1?this.lookData.force:1,r=this.lookData.angle.radian,o=this.lookVector;o.x=Math.cos(r)*t,o.y=Math.sin(r)*t,o.multiplyScalar(this.data.rotationSensitivity*y/1e3),this.yawObject.rotation.y-=o.x;let c=this.pitchObject.rotation.x+o.y;c=Math.max(-Math.PI/2,Math.min(Math.PI/2,c)),this.pitchObject.rotation.x=c},tick:function(y,t){this.updateRotation(t)},initLeftZone(){const y=document.createElement("div");y.setAttribute("id","joystickLeftZone"),y.setAttribute("style",`position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(y),this.leftZone=y},initRightZone(){const y=document.createElement("div");y.setAttribute("id","joystickRightZone"),y.setAttribute("style",`position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(y),this.rightZone=y},createMoveJoystick(){if(this.moveJoystick)return;this.initLeftZone();const y={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",y.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=k0.create(y),this.moveJoystick.on("move",(t,r)=>{this.moveData=r,this.moving=!0}),this.moveJoystick.on("end",(t,r)=>{this.moving=!1})},createLookJoystick(){if(this.lookJoystick)return;this.initRightZone();const y={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",y.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=k0.create(y),this.lookJoystick.on("move",(t,r)=>{this.lookData=r,this.rotating=!0}),this.lookJoystick.on("end",(t,r)=>{this.rotating=!1})},removeMoveJoystick(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}});const Gp={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(Gp)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const y=this.el.getObject3D("mesh");y?this.load(y):this.el.addEventListener("model-loaded",t=>{this.load(t.detail.model)})},load:function(y){const t=this.el;this.model=y,this.mixer=new THREE.AnimationMixer(y),this.mixer.addEventListener("loop",r=>{t.emit("animation-loop",{action:r.action,loopDelta:r.loopDelta})}),this.mixer.addEventListener("finished",r=>{t.emit("animation-finished",{action:r.action,direction:r.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(y){if(!y)return;const t=this.data,r=AFRAME.utils.diff(t,y);if("clip"in r){this.stopAction(),t.clip&&this.playAction();return}this.activeActions.forEach(o=>{"duration"in r&&t.duration&&o.setDuration(t.duration),"clampWhenFinished"in r&&(o.clampWhenFinished=t.clampWhenFinished),("loop"in r||"repetitions"in r)&&o.setLoop(Gp[t.loop],t.repetitions),"timeScale"in r&&o.setEffectiveTimeScale(t.timeScale)})},stopAction:function(){const y=this.data;for(let t=0;t<this.activeActions.length;t++)y.crossFadeDuration?this.activeActions[t].fadeOut(y.crossFadeDuration):this.activeActions[t].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const y=this.model,t=this.data,r=y.animations||(y.geometry||{}).animations||[];if(!r.length)return;const o=t.useRegExp?t.clip:rw(t.clip);for(let c,A=0;c=r[A];A++)if(c.name.match(o)){const B=this.mixer.clipAction(c,y);B.enabled=!0,B.clampWhenFinished=t.clampWhenFinished,t.duration&&B.setDuration(t.duration),t.timeScale!==1&&B.setEffectiveTimeScale(t.timeScale),B.startAt(this.mixer.time-t.startAt/1e3),B.setLoop(Gp[t.loop],t.repetitions).fadeIn(t.crossFadeDuration).play(),this.activeActions.push(B)}},tick:function(y,t){this.mixer&&!isNaN(t)&&this.mixer.update(t/1e3)}});function rw(y){return new RegExp("^"+y.split(/\*+/).map(sw).join(".*")+"$")}function sw(y){return y.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}var ow=THREE.ColladaLoader=function(y){this.manager=y!==void 0?y:THREE.DefaultLoadingManager};THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(y,t,r,o){var c=this,A=c.path===void 0?THREE.LoaderUtils.extractUrlBase(y):c.path,B=new THREE.FileLoader(c.manager);B.setPath(c.path),B.load(y,function(m){t(c.parse(m,A))},r,o)},setPath:function(y){return this.path=y,this},setResourcePath:function(y){return this.resourcePath=y,this},options:{set convertUpAxis(y){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(y){return this.crossOrigin=y,this},parse:function(y,t){function r(q,ie){for(var ce=[],ne=q.childNodes,re=0,ke=ne.length;re<ke;re++){var Ze=ne[re];Ze.nodeName===ie&&ce.push(Ze)}return ce}function o(q){if(q.length===0)return[];for(var ie=q.trim().split(/\s+/),ce=new Array(ie.length),ne=0,re=ie.length;ne<re;ne++)ce[ne]=ie[ne];return ce}function c(q){if(q.length===0)return[];for(var ie=q.trim().split(/\s+/),ce=new Array(ie.length),ne=0,re=ie.length;ne<re;ne++)ce[ne]=parseFloat(ie[ne]);return ce}function A(q){if(q.length===0)return[];for(var ie=q.trim().split(/\s+/),ce=new Array(ie.length),ne=0,re=ie.length;ne<re;ne++)ce[ne]=parseInt(ie[ne]);return ce}function B(q){return q.substring(1)}function m(){return"three_default_"+me++}function M(q){return Object.keys(q).length===0}function h(q){return{unit:f(r(q,"unit")[0]),upAxis:C(r(q,"up_axis")[0])}}function f(q){return q!==void 0&&q.hasAttribute("meter")===!0?parseFloat(q.getAttribute("meter")):1}function C(q){return q!==void 0?q.textContent:"Y_UP"}function p(q,ie,ce,ne){var re=r(q,ie)[0];if(re!==void 0)for(var ke=r(re,ce),Ze=0;Ze<ke.length;Ze++)ne(ke[Ze])}function g(q,ie){for(var ce in q){var ne=q[ce];ne.build=ie(q[ce])}}function u(q,ie){return q.build!==void 0||(q.build=ie(q)),q.build}function E(q){for(var ie={sources:{},samplers:{},channels:{}},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1){var ke;switch(re.nodeName){case"source":ke=re.getAttribute("id"),ie.sources[ke]=fe(re);break;case"sampler":ke=re.getAttribute("id"),ie.samplers[ke]=b(re);break;case"channel":ke=re.getAttribute("target"),ie.channels[ke]=x(re);break;default:console.log(re)}}}Ee.animations[q.getAttribute("id")]=ie}function b(q){for(var ie={inputs:{}},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"input":var ke=B(re.getAttribute("source")),Ze=re.getAttribute("semantic");ie.inputs[Ze]=ke;break}}return ie}function x(q){var ie={},ce=q.getAttribute("target"),ne=ce.split("/"),re=ne.shift(),ke=ne.shift(),Ze=ke.indexOf("(")!==-1,st=ke.indexOf(".")!==-1;if(st)ne=ke.split("."),ke=ne.shift(),ie.member=ne.shift();else if(Ze){var dt=ke.split("(");ke=dt.shift();for(var Ot=0;Ot<dt.length;Ot++)dt[Ot]=parseInt(dt[Ot].replace(/\)/,""));ie.indices=dt}return ie.id=re,ie.sid=ke,ie.arraySyntax=Ze,ie.memberSyntax=st,ie.sampler=B(q.getAttribute("source")),ie}function T(q){var ie=[],ce=q.channels,ne=q.samplers,re=q.sources;for(var ke in ce)if(ce.hasOwnProperty(ke)){var Ze=ce[ke],st=ne[Ze.sampler],dt=st.inputs.INPUT,Ot=st.inputs.OUTPUT,ft=re[dt],_t=re[Ot],di=w(Ze,ft,_t);U(di,ie)}return ie}function _(q){return u(Ee.animations[q],T)}function w(q,ie,ce){var ne=Ee.nodes[q.id],re=Ai(ne.id),ke=ne.transforms[q.sid],Ze=ne.matrix.clone().transpose(),st,dt,Ot,ft,_t,di,ni={};switch(ke){case"matrix":for(Ot=0,ft=ie.array.length;Ot<ft;Ot++)if(st=ie.array[Ot],dt=Ot*ce.stride,ni[st]===void 0&&(ni[st]={}),q.arraySyntax===!0){var Ei=ce.array[dt],Xt=q.indices[0]+4*q.indices[1];ni[st][Xt]=Ei}else for(_t=0,di=ce.stride;_t<di;_t++)ni[st][_t]=ce.array[dt+_t];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ke);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ke);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ke);break}var _i=S(ni,Ze),Ti={name:re.uuid,keyframes:_i};return Ti}function S(q,ie){var ce=[];for(var ne in q)ce.push({time:parseFloat(ne),value:q[ne]});ce.sort(ke);for(var re=0;re<16;re++)F(ce,re,ie.elements[re]);return ce;function ke(Ze,st){return Ze.time-st.time}}var L=new THREE.Vector3,P=new THREE.Vector3,D=new THREE.Quaternion;function U(q,ie){for(var ce=q.keyframes,ne=q.name,re=[],ke=[],Ze=[],st=[],dt=0,Ot=ce.length;dt<Ot;dt++){var ft=ce[dt],_t=ft.time,di=ft.value;we.fromArray(di).transpose(),we.decompose(L,D,P),re.push(_t),ke.push(L.x,L.y,L.z),Ze.push(D.x,D.y,D.z,D.w),st.push(P.x,P.y,P.z)}return ke.length>0&&ie.push(new THREE.VectorKeyframeTrack(ne+".position",re,ke)),Ze.length>0&&ie.push(new THREE.QuaternionKeyframeTrack(ne+".quaternion",re,Ze)),st.length>0&&ie.push(new THREE.VectorKeyframeTrack(ne+".scale",re,st)),ie}function F(q,ie,ce){var ne,re=!0,ke,Ze;for(ke=0,Ze=q.length;ke<Ze;ke++)ne=q[ke],ne.value[ie]===void 0?ne.value[ie]=null:re=!1;if(re===!0)for(ke=0,Ze=q.length;ke<Ze;ke++)ne=q[ke],ne.value[ie]=ce;else j(q,ie)}function j(q,ie){for(var ce,ne,re=0,ke=q.length;re<ke;re++){var Ze=q[re];if(Ze.value[ie]===null){if(ce=Y(q,re,ie),ne=oe(q,re,ie),ce===null){Ze.value[ie]=ne.value[ie];continue}if(ne===null){Ze.value[ie]=ce.value[ie];continue}te(Ze,ce,ne,ie)}}}function Y(q,ie,ce){for(;ie>=0;){var ne=q[ie];if(ne.value[ce]!==null)return ne;ie--}return null}function oe(q,ie,ce){for(;ie<q.length;){var ne=q[ie];if(ne.value[ce]!==null)return ne;ie++}return null}function te(q,ie,ce,ne){if(ce.time-ie.time===0){q.value[ne]=ie.value[ne];return}q.value[ne]=(q.time-ie.time)*(ce.value[ne]-ie.value[ne])/(ce.time-ie.time)+ie.value[ne]}function pe(q){for(var ie={name:q.getAttribute("id")||"default",start:parseFloat(q.getAttribute("start")||0),end:parseFloat(q.getAttribute("end")||0),animations:[]},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"instance_animation":ie.animations.push(B(re.getAttribute("url")));break}}Ee.clips[q.getAttribute("id")]=ie}function de(q){for(var ie=[],ce=q.name,ne=q.end-q.start||-1,re=q.animations,ke=0,Ze=re.length;ke<Ze;ke++)for(var st=_(re[ke]),dt=0,Ot=st.length;dt<Ot;dt++)ie.push(st[dt]);return new THREE.AnimationClip(ce,ne,ie)}function se(q){return u(Ee.clips[q],de)}function J(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"skin":ie.id=B(re.getAttribute("source")),ie.skin=H(re);break;case"morph":ie.id=B(re.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Ee.controllers[q.getAttribute("id")]=ie}function H(q){for(var ie={sources:{}},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"bind_shape_matrix":ie.bindShapeMatrix=c(re.textContent);break;case"source":var ke=re.getAttribute("id");ie.sources[ke]=fe(re);break;case"joints":ie.joints=ae(re);break;case"vertex_weights":ie.vertexWeights=ue(re);break}}return ie}function ae(q){for(var ie={inputs:{}},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"input":var ke=re.getAttribute("semantic"),Ze=B(re.getAttribute("source"));ie.inputs[ke]=Ze;break}}return ie}function ue(q){for(var ie={inputs:{}},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"input":var ke=re.getAttribute("semantic"),Ze=B(re.getAttribute("source")),st=parseInt(re.getAttribute("offset"));ie.inputs[ke]={id:Ze,offset:st};break;case"vcount":ie.vcount=A(re.textContent);break;case"v":ie.v=A(re.textContent);break}}return ie}function Me(q){var ie={id:q.id},ce=Ee.geometries[ie.id];return q.skin!==void 0&&(ie.skin=De(q.skin),ce.sources.skinIndices=ie.skin.indices,ce.sources.skinWeights=ie.skin.weights),ie}function De(q){var ie=4,ce={joints:[],indices:{array:[],stride:ie},weights:{array:[],stride:ie}},ne=q.sources,re=q.vertexWeights,ke=re.vcount,Ze=re.v,st=re.inputs.JOINT.offset,dt=re.inputs.WEIGHT.offset,Ot=q.sources[q.joints.inputs.JOINT],ft=q.sources[q.joints.inputs.INV_BIND_MATRIX],_t=ne[re.inputs.WEIGHT.id].array,di=0,ni,Ei,Xt;for(ni=0,Xt=ke.length;ni<Xt;ni++){var _i=ke[ni],Ti=[];for(Ei=0;Ei<_i;Ei++){var Pi=Ze[di+st],Hi=Ze[di+dt],Ji=_t[Hi];Ti.push({index:Pi,weight:Ji}),di+=2}for(Ti.sort(os),Ei=0;Ei<ie;Ei++){var Bi=Ti[Ei];Bi!==void 0?(ce.indices.array.push(Bi.index),ce.weights.array.push(Bi.weight)):(ce.indices.array.push(0),ce.weights.array.push(0))}}for(q.bindShapeMatrix?ce.bindMatrix=new THREE.Matrix4().fromArray(q.bindShapeMatrix).transpose():ce.bindMatrix=new THREE.Matrix4().identity(),ni=0,Xt=Ot.array.length;ni<Xt;ni++){var Hn=Ot.array[ni],Di=new THREE.Matrix4().fromArray(ft.array,ni*ft.stride).transpose();ce.joints.push({name:Hn,boneInverse:Di})}return ce;function os(vs,js){return js.weight-vs.weight}}function Ge(q){return u(Ee.controllers[q],Me)}function Xe(q){var ie={init_from:r(q,"init_from")[0].textContent};Ee.images[q.getAttribute("id")]=ie}function Je(q){return q.build!==void 0?q.build:q.init_from}function pt(q){var ie=Ee.images[q];return ie!==void 0?u(ie,Je):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",q),null)}function yt(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"profile_COMMON":ie.profile=Gt(re);break}}Ee.effects[q.getAttribute("id")]=ie}function Gt(q){for(var ie={surfaces:{},samplers:{}},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"newparam":Et(re,ie);break;case"technique":ie.technique=gi(re);break;case"extra":ie.extra=Cn(re);break}}return ie}function Et(q,ie){for(var ce=q.getAttribute("sid"),ne=0,re=q.childNodes.length;ne<re;ne++){var ke=q.childNodes[ne];if(ke.nodeType===1)switch(ke.nodeName){case"surface":ie.surfaces[ce]=Vt(ke);break;case"sampler2D":ie.samplers[ce]=Yt(ke);break}}}function Vt(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"init_from":ie.init_from=re.textContent;break}}return ie}function Yt(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"source":ie.source=re.textContent;break}}return ie}function gi(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"constant":case"lambert":case"blinn":case"phong":ie.type=re.nodeName,ie.parameters=Ri(re);break}}return ie}function Ri(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":ie[re.nodeName]=Ni(re);break;case"transparent":ie[re.nodeName]={opaque:re.getAttribute("opaque"),data:Ni(re)};break}}return ie}function Ni(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"color":ie[re.nodeName]=c(re.textContent);break;case"float":ie[re.nodeName]=parseFloat(re.textContent);break;case"texture":ie[re.nodeName]={id:re.getAttribute("texture"),extra:Oi(re)};break}}return ie}function Oi(q){for(var ie={technique:{}},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"extra":yi(re,ie);break}}return ie}function yi(q,ie){for(var ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"technique":zi(re,ie);break}}}function zi(q,ie){for(var ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":ie.technique[re.nodeName]=parseFloat(re.textContent);break;case"wrapU":case"wrapV":re.textContent.toUpperCase()==="TRUE"?ie.technique[re.nodeName]=1:re.textContent.toUpperCase()==="FALSE"?ie.technique[re.nodeName]=0:ie.technique[re.nodeName]=parseInt(re.textContent);break}}}function Cn(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"technique":ie.technique=gn(re);break}}return ie}function gn(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"double_sided":ie[re.nodeName]=parseInt(re.textContent);break}}return ie}function rr(q){return q}function bn(q){return u(Ee.effects[q],rr)}function cn(q){for(var ie={name:q.getAttribute("name")},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"instance_effect":ie.url=B(re.getAttribute("url"));break}}Ee.materials[q.getAttribute("id")]=ie}function Kn(q){var ie,ce=q.slice((q.lastIndexOf(".")-1>>>0)+2);switch(ce=ce.toLowerCase(),ce){case"tga":ie=W;break;default:ie=hn}return ie}function wn(q){var ie=bn(q.url),ce=ie.profile.technique,ne=ie.profile.extra,re;switch(ce.type){case"phong":case"blinn":re=new THREE.MeshPhongMaterial;break;case"lambert":re=new THREE.MeshLambertMaterial;break;default:re=new THREE.MeshBasicMaterial;break}re.name=q.name;function ke(di){var ni=ie.profile.samplers[di.id],Ei=null;if(ni!==void 0){var Xt=ie.profile.surfaces[ni.source];Ei=pt(Xt.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),Ei=pt(di.id);if(Ei!==null){var _i=Kn(Ei);if(_i!==void 0){var Ti=_i.load(Ei),Pi=di.extra;if(Pi!==void 0&&Pi.technique!==void 0&&M(Pi.technique)===!1){var Hi=Pi.technique;Ti.wrapS=Hi.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Ti.wrapT=Hi.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Ti.offset.set(Hi.offsetU||0,Hi.offsetV||0),Ti.repeat.set(Hi.repeatU||1,Hi.repeatV||1)}else Ti.wrapS=THREE.RepeatWrapping,Ti.wrapT=THREE.RepeatWrapping;return Ti}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",Ei),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",di.id),null}var Ze=ce.parameters;for(var st in Ze){var dt=Ze[st];switch(st){case"diffuse":dt.color&&re.color.fromArray(dt.color),dt.texture&&(re.map=ke(dt.texture));break;case"specular":dt.color&&re.specular&&re.specular.fromArray(dt.color),dt.texture&&(re.specularMap=ke(dt.texture));break;case"bump":dt.texture&&(re.normalMap=ke(dt.texture));break;case"ambient":dt.texture&&(re.lightMap=ke(dt.texture));break;case"shininess":dt.float&&re.shininess&&(re.shininess=dt.float);break;case"emission":dt.color&&re.emissive&&re.emissive.fromArray(dt.color),dt.texture&&(re.emissiveMap=ke(dt.texture));break}}var Ot=Ze.transparent,ft=Ze.transparency;if(ft===void 0&&Ot&&(ft={float:1}),Ot===void 0&&ft&&(Ot={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Ot&&ft)if(Ot.data.texture)re.transparent=!0;else{var _t=Ot.data.color;switch(Ot.opaque){case"A_ONE":re.opacity=_t[3]*ft.float;break;case"RGB_ZERO":re.opacity=1-_t[0]*ft.float;break;case"A_ZERO":re.opacity=1-_t[3]*ft.float;break;case"RGB_ONE":re.opacity=_t[0]*ft.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Ot.opaque)}re.opacity<1&&(re.transparent=!0)}return ne!==void 0&&ne.technique!==void 0&&ne.technique.double_sided===1&&(re.side=THREE.DoubleSide),re}function Cr(q){return u(Ee.materials[q],wn)}function ar(q){for(var ie={name:q.getAttribute("name")},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"optics":ie.optics=Tn(re);break}}Ee.cameras[q.getAttribute("id")]=ie}function Tn(q){for(var ie=0;ie<q.childNodes.length;ie++){var ce=q.childNodes[ie];switch(ce.nodeName){case"technique_common":return St(ce)}}return{}}function St(q){for(var ie={},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];switch(ne.nodeName){case"perspective":case"orthographic":ie.technique=ne.nodeName,ie.parameters=ye(ne);break}}return ie}function ye(q){for(var ie={},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];switch(ne.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":ie[ne.nodeName]=parseFloat(ne.textContent);break}}return ie}function ve(q){var ie;switch(q.optics.technique){case"perspective":ie=new THREE.PerspectiveCamera(q.optics.parameters.yfov,q.optics.parameters.aspect_ratio,q.optics.parameters.znear,q.optics.parameters.zfar);break;case"orthographic":var ce=q.optics.parameters.ymag,ne=q.optics.parameters.xmag,re=q.optics.parameters.aspect_ratio;ne=ne===void 0?ce*re:ne,ce=ce===void 0?ne/re:ce,ne*=.5,ce*=.5,ie=new THREE.OrthographicCamera(-ne,ne,ce,-ce,q.optics.parameters.znear,q.optics.parameters.zfar);break;default:ie=new THREE.PerspectiveCamera;break}return ie.name=q.name,ie}function Le(q){var ie=Ee.cameras[q];return ie!==void 0?u(ie,ve):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",q),null)}function Se(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"technique_common":ie=Re(re);break}}Ee.lights[q.getAttribute("id")]=ie}function Re(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"directional":case"point":case"spot":case"ambient":ie.technique=re.nodeName,ie.parameters=Pe(re)}}return ie}function Pe(q){for(var ie={},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"color":var ke=c(re.textContent);ie.color=new THREE.Color().fromArray(ke);break;case"falloff_angle":ie.falloffAngle=parseFloat(re.textContent);break;case"quadratic_attenuation":var Ze=parseFloat(re.textContent);ie.distance=Ze?Math.sqrt(1/Ze):0;break}}return ie}function $(q){var ie;switch(q.technique){case"directional":ie=new THREE.DirectionalLight;break;case"point":ie=new THREE.PointLight;break;case"spot":ie=new THREE.SpotLight;break;case"ambient":ie=new THREE.AmbientLight;break}return q.parameters.color&&ie.color.copy(q.parameters.color),q.parameters.distance&&(ie.distance=q.parameters.distance),ie}function N(q){var ie=Ee.lights[q];return ie!==void 0?u(ie,$):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",q),null)}function V(q){var ie={name:q.getAttribute("name"),sources:{},vertices:{},primitives:[]},ce=r(q,"mesh")[0];if(ce!==void 0){for(var ne=0;ne<ce.childNodes.length;ne++){var re=ce.childNodes[ne];if(re.nodeType===1){var ke=re.getAttribute("id");switch(re.nodeName){case"source":ie.sources[ke]=fe(re);break;case"vertices":ie.vertices=be(re);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",re.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":ie.primitives.push(Fe(re));break;default:console.log(re)}}}Ee.geometries[q.getAttribute("id")]=ie}}function fe(q){for(var ie={array:[],stride:3},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"float_array":ie.array=c(ne.textContent);break;case"Name_array":ie.array=o(ne.textContent);break;case"technique_common":var re=r(ne,"accessor")[0];re!==void 0&&(ie.stride=parseInt(re.getAttribute("stride")));break}}return ie}function be(q){for(var ie={},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];ne.nodeType===1&&(ie[ne.getAttribute("semantic")]=B(ne.getAttribute("source")))}return ie}function Fe(q){for(var ie={type:q.nodeName,material:q.getAttribute("material"),count:parseInt(q.getAttribute("count")),inputs:{},stride:0,hasUV:!1},ce=0,ne=q.childNodes.length;ce<ne;ce++){var re=q.childNodes[ce];if(re.nodeType===1)switch(re.nodeName){case"input":var ke=B(re.getAttribute("source")),Ze=re.getAttribute("semantic"),st=parseInt(re.getAttribute("offset")),dt=parseInt(re.getAttribute("set")),Ot=dt>0?Ze+dt:Ze;ie.inputs[Ot]={id:ke,offset:st},ie.stride=Math.max(ie.stride,st+1),Ze==="TEXCOORD"&&(ie.hasUV=!0);break;case"vcount":ie.vcount=A(re.textContent);break;case"p":ie.p=A(re.textContent);break}}return ie}function We(q){for(var ie={},ce=0;ce<q.length;ce++){var ne=q[ce];ie[ne.type]===void 0&&(ie[ne.type]=[]),ie[ne.type].push(ne)}return ie}function Rt(q){for(var ie=0,ce=0,ne=q.length;ce<ne;ce++){var re=q[ce];re.hasUV===!0&&ie++}ie>0&&ie<q.length&&(q.uvsNeedsFix=!0)}function zt(q){var ie={},ce=q.sources,ne=q.vertices,re=q.primitives;if(re.length===0)return{};var ke=We(re);for(var Ze in ke){var st=ke[Ze];Rt(st),ie[Ze]=Lt(st,ce,ne)}return ie}function Lt(q,ie,ce){for(var ne={},re={array:[],stride:0},ke={array:[],stride:0},Ze={array:[],stride:0},st={array:[],stride:0},dt={array:[],stride:0},Ot={array:[],stride:4},ft={array:[],stride:4},_t=new THREE.BufferGeometry,di=[],ni=0,Ei=0;Ei<q.length;Ei++){var Xt=q[Ei],_i=Xt.inputs,Ti=0;switch(Xt.type){case"lines":case"linestrips":Ti=Xt.count*2;break;case"triangles":Ti=Xt.count*3;break;case"polylist":for(var Pi=0;Pi<Xt.count;Pi++){var Hi=Xt.vcount[Pi];switch(Hi){case 3:Ti+=3;break;case 4:Ti+=6;break;default:Ti+=(Hi-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",Xt.type)}_t.addGroup(ni,Ti,Ei),ni+=Ti,Xt.material&&di.push(Xt.material);for(var Ji in _i){var Bi=_i[Ji];switch(Ji){case"VERTEX":for(var Hn in ce){var Di=ce[Hn];switch(Hn){case"POSITION":var os=re.array.length;if(Tt(Xt,ie[Di],Bi.offset,re.array),re.stride=ie[Di].stride,ie.skinWeights&&ie.skinIndices&&(Tt(Xt,ie.skinIndices,Bi.offset,Ot.array),Tt(Xt,ie.skinWeights,Bi.offset,ft.array)),Xt.hasUV===!1&&q.uvsNeedsFix===!0)for(var Ti=(re.array.length-os)/re.stride,vs=0;vs<Ti;vs++)Ze.array.push(0,0);break;case"NORMAL":Tt(Xt,ie[Di],Bi.offset,ke.array),ke.stride=ie[Di].stride;break;case"COLOR":Tt(Xt,ie[Di],Bi.offset,dt.array),dt.stride=ie[Di].stride;break;case"TEXCOORD":Tt(Xt,ie[Di],Bi.offset,Ze.array),Ze.stride=ie[Di].stride;break;case"TEXCOORD1":Tt(Xt,ie[Di],Bi.offset,st.array),Ze.stride=ie[Di].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Hn)}}break;case"NORMAL":Tt(Xt,ie[Bi.id],Bi.offset,ke.array),ke.stride=ie[Bi.id].stride;break;case"COLOR":Tt(Xt,ie[Bi.id],Bi.offset,dt.array),dt.stride=ie[Bi.id].stride;break;case"TEXCOORD":Tt(Xt,ie[Bi.id],Bi.offset,Ze.array),Ze.stride=ie[Bi.id].stride;break;case"TEXCOORD1":Tt(Xt,ie[Bi.id],Bi.offset,st.array),st.stride=ie[Bi.id].stride;break}}}return re.array.length>0&&_t.addAttribute("position",new THREE.Float32BufferAttribute(re.array,re.stride)),ke.array.length>0&&_t.addAttribute("normal",new THREE.Float32BufferAttribute(ke.array,ke.stride)),dt.array.length>0&&_t.addAttribute("color",new THREE.Float32BufferAttribute(dt.array,dt.stride)),Ze.array.length>0&&_t.addAttribute("uv",new THREE.Float32BufferAttribute(Ze.array,Ze.stride)),st.array.length>0&&_t.addAttribute("uv2",new THREE.Float32BufferAttribute(st.array,st.stride)),Ot.array.length>0&&_t.addAttribute("skinIndex",new THREE.Float32BufferAttribute(Ot.array,Ot.stride)),ft.array.length>0&&_t.addAttribute("skinWeight",new THREE.Float32BufferAttribute(ft.array,ft.stride)),ne.data=_t,ne.type=q[0].type,ne.materialKeys=di,ne}function Tt(q,ie,ce,ne){var re=q.p,ke=q.stride,Ze=q.vcount;function st(Ji){for(var Bi=re[Ji+ce]*Ot,Hn=Bi+Ot;Bi<Hn;Bi++)ne.push(dt[Bi])}var dt=ie.array,Ot=ie.stride;if(q.vcount!==void 0)for(var ft=0,_t=0,di=Ze.length;_t<di;_t++){var ni=Ze[_t];if(ni===4){var Ei=ft+ke*0,Xt=ft+ke*1,_i=ft+ke*2,Ti=ft+ke*3;st(Ei),st(Xt),st(Ti),st(Xt),st(_i),st(Ti)}else if(ni===3){var Ei=ft+ke*0,Xt=ft+ke*1,_i=ft+ke*2;st(Ei),st(Xt),st(_i)}else if(ni>4)for(var Pi=1,Hi=ni-2;Pi<=Hi;Pi++){var Ei=ft+ke*0,Xt=ft+ke*Pi,_i=ft+ke*(Pi+1);st(Ei),st(Xt),st(_i)}ft+=ke*ni}else for(var _t=0,di=re.length;_t<di;_t+=ke)st(_t)}function ti(q){return u(Ee.geometries[q],zt)}function Jn(q){for(var ie={name:q.getAttribute("name")||"",joints:{},links:[]},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"technique_common":mn(ne,ie);break}}Ee.kinematicsModels[q.getAttribute("id")]=ie}function wi(q){return q.build!==void 0?q.build:q}function Xn(q){return u(Ee.kinematicsModels[q],wi)}function mn(q,ie){for(var ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"joint":ie.joints[ne.getAttribute("sid")]=In(ne);break;case"link":ie.links.push(Qn(ne));break}}}function In(q){for(var ie,ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"prismatic":case"revolute":ie=Yr(ne);break}}return ie}function Yr(q,ce){for(var ce={sid:q.getAttribute("sid"),name:q.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:q.nodeName,static:!1,zeroPosition:0,middlePosition:0},ne=0;ne<q.childNodes.length;ne++){var re=q.childNodes[ne];if(re.nodeType===1)switch(re.nodeName){case"axis":var ke=c(re.textContent);ce.axis.fromArray(ke);break;case"limits":var Ze=re.getElementsByTagName("max")[0],st=re.getElementsByTagName("min")[0];ce.limits.max=parseFloat(Ze.textContent),ce.limits.min=parseFloat(st.textContent);break}}return ce.limits.min>=ce.limits.max&&(ce.static=!0),ce.middlePosition=(ce.limits.min+ce.limits.max)/2,ce}function Qn(q){for(var ie={sid:q.getAttribute("sid"),name:q.getAttribute("name")||"",attachments:[],transforms:[]},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"attachment_full":ie.attachments.push(ms(ne));break;case"matrix":case"translate":case"rotate":ie.transforms.push(sr(ne));break}}return ie}function ms(q){for(var ie={joint:q.getAttribute("joint").split("/").pop(),transforms:[],links:[]},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"link":ie.links.push(Qn(ne));break;case"matrix":case"translate":case"rotate":ie.transforms.push(sr(ne));break}}return ie}function sr(q){var ie={type:q.nodeName},ce=c(q.textContent);switch(ie.type){case"matrix":ie.obj=new THREE.Matrix4,ie.obj.fromArray(ce).transpose();break;case"translate":ie.obj=new THREE.Vector3,ie.obj.fromArray(ce);break;case"rotate":ie.obj=new THREE.Vector3,ie.obj.fromArray(ce),ie.angle=THREE.MathUtils.degToRad(ce[3]);break}return ie}function Qr(q){for(var ie={name:q.getAttribute("name")||"",rigidBodies:{}},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"rigid_body":ie.rigidBodies[ne.getAttribute("name")]={},gs(ne,ie.rigidBodies[ne.getAttribute("name")]);break}}Ee.physicsModels[q.getAttribute("id")]=ie}function gs(q,ie){for(var ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"technique_common":Tr(ne,ie);break}}}function Tr(q,ie){for(var ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"inertia":ie.inertia=c(ne.textContent);break;case"mass":ie.mass=c(ne.textContent)[0];break}}}function Yn(q){for(var ie={bindJointAxis:[]},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"bind_joint_axis":ie.bindJointAxis.push(Bn(ne));break}}Ee.kinematicsScenes[B(q.getAttribute("url"))]=ie}function Bn(q){for(var ie={target:q.getAttribute("target").split("/").pop()},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"axis":var re=ne.getElementsByTagName("param")[0];ie.axis=re.textContent;var ke=ie.axis.split("inst_").pop().split("axis")[0];ie.jointIndex=ke.substr(0,ke.length-1);break}}return ie}function lr(q){return q.build!==void 0?q.build:q}function Hs(q){return u(Ee.kinematicsScenes[q],lr)}function ss(){var q=Object.keys(Ee.kinematicsModels)[0],ie=Object.keys(Ee.kinematicsScenes)[0],ce=Object.keys(Ee.visualScenes)[0];if(q===void 0||ie===void 0)return;for(var ne=Xn(q),re=Hs(ie),ke=ki(ce),Ze=re.bindJointAxis,st={},dt=0,Ot=Ze.length;dt<Ot;dt++){var ft=Ze[dt],_t=Nt.querySelector('[sid="'+ft.target+'"]');if(_t){var di=_t.parentElement;ni(ft.jointIndex,di)}}function ni(Xt,_i){var Ti=_i.getAttribute("name"),Pi=ne.joints[Xt];ke.traverse(function(Hi){Hi.name===Ti&&(st[Xt]={object:Hi,transforms:oo(_i),joint:Pi,position:Pi.zeroPosition})})}var Ei=new THREE.Matrix4;le={joints:ne&&ne.joints,getJointValue:function(Xt){var _i=st[Xt];if(_i)return _i.position;console.warn("THREE.ColladaLoader: Joint "+Xt+" doesn't exist.")},setJointValue:function(Xt,_i){var Ti=st[Xt];if(Ti){var Pi=Ti.joint;if(_i>Pi.limits.max||_i<Pi.limits.min)console.warn("THREE.ColladaLoader: Joint "+Xt+" value "+_i+" outside of limits (min: "+Pi.limits.min+", max: "+Pi.limits.max+").");else if(Pi.static)console.warn("THREE.ColladaLoader: Joint "+Xt+" is static.");else{var Hi=Ti.object,Ji=Pi.axis,Bi=Ti.transforms;we.identity();for(var Hn=0;Hn<Bi.length;Hn++){var Di=Bi[Hn];if(Di.sid&&Di.sid.indexOf(Xt)!==-1)switch(Pi.type){case"revolute":we.multiply(Ei.makeRotationAxis(Ji,THREE.MathUtils.degToRad(_i)));break;case"prismatic":we.multiply(Ei.makeTranslation(Ji.x*_i,Ji.y*_i,Ji.z*_i));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+Pi.type);break}else switch(Di.type){case"matrix":we.multiply(Di.obj);break;case"translate":we.multiply(Ei.makeTranslation(Di.obj.x,Di.obj.y,Di.obj.z));break;case"scale":we.scale(Di.obj);break;case"rotate":we.multiply(Ei.makeRotationAxis(Di.obj,Di.angle));break}}Hi.matrix.copy(we),Hi.matrix.decompose(Hi.position,Hi.quaternion,Hi.scale),st[Xt].position=_i}}else console.log("THREE.ColladaLoader: "+Xt+" does not exist.")}}}function oo(q){for(var ie=[],ce=Nt.querySelector('[id="'+q.id+'"]'),ne=0;ne<ce.childNodes.length;ne++){var re=ce.childNodes[ne];if(re.nodeType===1)switch(re.nodeName){case"matrix":var Ze=c(re.textContent),ke=new THREE.Matrix4().fromArray(Ze).transpose();ie.push({sid:re.getAttribute("sid"),type:re.nodeName,obj:ke});break;case"translate":case"scale":var Ze=c(re.textContent),st=new THREE.Vector3().fromArray(Ze);ie.push({sid:re.getAttribute("sid"),type:re.nodeName,obj:st});break;case"rotate":var Ze=c(re.textContent),st=new THREE.Vector3().fromArray(Ze),dt=THREE.MathUtils.degToRad(Ze[3]);ie.push({sid:re.getAttribute("sid"),type:re.nodeName,obj:st,angle:dt});break}}return ie}function Fs(q){for(var ie=q.getElementsByTagName("node"),ce=0;ce<ie.length;ce++){var ne=ie[ce];ne.hasAttribute("id")===!1&&ne.setAttribute("id",m())}}var we=new THREE.Matrix4,Ne=new THREE.Vector3;function Ye(q){for(var ie={name:q.getAttribute("name")||"",type:q.getAttribute("type"),id:q.getAttribute("id"),sid:q.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];if(ne.nodeType===1)switch(ne.nodeName){case"node":ie.nodes.push(ne.getAttribute("id")),Ye(ne);break;case"instance_camera":ie.instanceCameras.push(B(ne.getAttribute("url")));break;case"instance_controller":ie.instanceControllers.push(ht(ne));break;case"instance_light":ie.instanceLights.push(B(ne.getAttribute("url")));break;case"instance_geometry":ie.instanceGeometries.push(ht(ne));break;case"instance_node":ie.instanceNodes.push(B(ne.getAttribute("url")));break;case"matrix":var ke=c(ne.textContent);ie.matrix.multiply(we.fromArray(ke).transpose()),ie.transforms[ne.getAttribute("sid")]=ne.nodeName;break;case"translate":var ke=c(ne.textContent);Ne.fromArray(ke),ie.matrix.multiply(we.makeTranslation(Ne.x,Ne.y,Ne.z)),ie.transforms[ne.getAttribute("sid")]=ne.nodeName;break;case"rotate":var ke=c(ne.textContent),re=THREE.MathUtils.degToRad(ke[3]);ie.matrix.multiply(we.makeRotationAxis(Ne.fromArray(ke),re)),ie.transforms[ne.getAttribute("sid")]=ne.nodeName;break;case"scale":var ke=c(ne.textContent);ie.matrix.scale(Ne.fromArray(ke)),ie.transforms[ne.getAttribute("sid")]=ne.nodeName;break;case"extra":break;default:console.log(ne)}}return pi(ie.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",ie.id):Ee.nodes[ie.id]=ie,ie}function ht(q){for(var ie={id:B(q.getAttribute("url")),materials:{},skeletons:[]},ce=0;ce<q.childNodes.length;ce++){var ne=q.childNodes[ce];switch(ne.nodeName){case"bind_material":for(var re=ne.getElementsByTagName("instance_material"),ke=0;ke<re.length;ke++){var Ze=re[ke],st=Ze.getAttribute("symbol"),dt=Ze.getAttribute("target");ie.materials[st]=B(dt)}break;case"skeleton":ie.skeletons.push(B(ne.textContent));break}}return ie}function nt(q,ie){var ce=[],ne=[],re,ke,Ze;for(re=0;re<q.length;re++){var st=q[re],dt;if(pi(st))dt=Ai(st),At(dt,ie,ce);else if(Ki(st))for(var Ot=Ee.visualScenes[st],ft=Ot.children,ke=0;ke<ft.length;ke++){var _t=ft[ke];if(_t.type==="JOINT"){var dt=Ai(_t.id);At(dt,ie,ce)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",st)}for(re=0;re<ie.length;re++)for(ke=0;ke<ce.length;ke++)if(Ze=ce[ke],Ze.bone.name===ie[re].name){ne[re]=Ze,Ze.processed=!0;break}for(re=0;re<ce.length;re++)Ze=ce[re],Ze.processed===!1&&(ne.push(Ze),Ze.processed=!0);var di=[],ni=[];for(re=0;re<ne.length;re++)Ze=ne[re],di.push(Ze.bone),ni.push(Ze.boneInverse);return new THREE.Skeleton(di,ni)}function At(q,ie,ce){q.traverse(function(ne){if(ne.isBone===!0){for(var re,ke=0;ke<ie.length;ke++){var Ze=ie[ke];if(Ze.name===ne.name){re=Ze.boneInverse;break}}re===void 0&&(re=new THREE.Matrix4),ce.push({bone:ne,boneInverse:re,processed:!1})}})}function Bt(q){for(var ie=[],ce=q.matrix,ne=q.nodes,re=q.type,ke=q.instanceCameras,Ze=q.instanceControllers,st=q.instanceLights,dt=q.instanceGeometries,Ot=q.instanceNodes,ft=0,_t=ne.length;ft<_t;ft++)ie.push(Ai(ne[ft]));for(var ft=0,_t=ke.length;ft<_t;ft++){var di=Le(ke[ft]);di!==null&&ie.push(di.clone())}for(var ft=0,_t=Ze.length;ft<_t;ft++)for(var ni=Ze[ft],Ei=Ge(ni.id),Xt=ti(Ei.id),_i=mt(Xt,ni.materials),Ti=ni.skeletons,Pi=Ei.skin.joints,Hi=nt(Ti,Pi),Ji=0,Bi=_i.length;Ji<Bi;Ji++){var Di=_i[Ji];Di.isSkinnedMesh&&(Di.bind(Hi,Ei.skin.bindMatrix),Di.normalizeSkinWeights()),ie.push(Di)}for(var ft=0,_t=st.length;ft<_t;ft++){var Hn=N(st[ft]);Hn!==null&&ie.push(Hn.clone())}for(var ft=0,_t=dt.length;ft<_t;ft++)for(var ni=dt[ft],Xt=ti(ni.id),_i=mt(Xt,ni.materials),Ji=0,Bi=_i.length;Ji<Bi;Ji++)ie.push(_i[Ji]);for(var ft=0,_t=Ot.length;ft<_t;ft++)ie.push(Ai(Ot[ft]).clone());var Di;if(ne.length===0&&ie.length===1)Di=ie[0];else{Di=re==="JOINT"?new THREE.Bone:new THREE.Group;for(var ft=0;ft<ie.length;ft++)Di.add(ie[ft])}return Di.name===""&&(Di.name=re==="JOINT"?q.sid:q.name),Di.matrix.copy(ce),Di.matrix.decompose(Di.position,Di.quaternion,Di.scale),Di}var oi=new THREE.MeshBasicMaterial({color:16711935});function qt(q,ie){for(var ce=[],ne=0,re=q.length;ne<re;ne++){var ke=ie[q[ne]];ke===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",q[ne]),ce.push(oi)):ce.push(Cr(ke))}return ce}function mt(q,ie){var ce=[];for(var ne in q){var re=q[ne],ke=qt(re.materialKeys,ie);ke.length===0&&(ne==="lines"||ne==="linestrips"?ke.push(new THREE.LineBasicMaterial):ke.push(new THREE.MeshPhongMaterial));var Ze=re.data.attributes.skinIndex!==void 0;if(Ze)for(var st=0,dt=ke.length;st<dt;st++)ke[st].skinning=!0;var Ot=ke.length===1?ke[0]:ke,ft;switch(ne){case"lines":ft=new THREE.LineSegments(re.data,Ot);break;case"linestrips":ft=new THREE.Line(re.data,Ot);break;case"triangles":case"polylist":Ze?ft=new THREE.SkinnedMesh(re.data,Ot):ft=new THREE.Mesh(re.data,Ot);break}ce.push(ft)}return ce}function pi(q){return Ee.nodes[q]!==void 0}function Ai(q){return u(Ee.nodes[q],Bt)}function Li(q){var ie={name:q.getAttribute("name"),children:[]};Fs(q);for(var ce=r(q,"node"),ne=0;ne<ce.length;ne++)ie.children.push(Ye(ce[ne]));Ee.visualScenes[q.getAttribute("id")]=ie}function Mn(q){var ie=new THREE.Group;ie.name=q.name;for(var ce=q.children,ne=0;ne<ce.length;ne++){var re=ce[ne];ie.add(Ai(re.id))}return ie}function Ki(q){return Ee.visualScenes[q]!==void 0}function ki(q){return u(Ee.visualScenes[q],Mn)}function sn(q){var ie=r(q,"instance_visual_scene")[0];return ki(B(ie.getAttribute("url")))}function Gn(){var q=Ee.clips;if(M(q)===!0){if(M(Ee.animations)===!1){var ie=[];for(var ce in Ee.animations)for(var ne=_(ce),re=0,ke=ne.length;re<ke;re++)ie.push(ne[re]);Z.push(new THREE.AnimationClip("default",-1,ie))}}else for(var ce in q)Z.push(se(ce))}if(y.length===0)return{scene:new THREE.Scene};var cr=new DOMParser().parseFromString(y,"application/xml"),Nt=r(cr,"COLLADA")[0],Xi=Nt.getAttribute("version");console.log("THREE.ColladaLoader: File version",Xi);var Zn=h(r(Nt,"asset")[0]),hn=new THREE.TextureLoader(this.manager);hn.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);var W;THREE.TGALoader&&(W=new THREE.TGALoader(this.manager),W.setPath(this.resourcePath||t));var Z=[],le={},me=0,Ee={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};p(Nt,"library_animations","animation",E),p(Nt,"library_animation_clips","animation_clip",pe),p(Nt,"library_controllers","controller",J),p(Nt,"library_images","image",Xe),p(Nt,"library_effects","effect",yt),p(Nt,"library_materials","material",cn),p(Nt,"library_cameras","camera",ar),p(Nt,"library_lights","light",Se),p(Nt,"library_geometries","geometry",V),p(Nt,"library_nodes","node",Ye),p(Nt,"library_visual_scenes","visual_scene",Li),p(Nt,"library_kinematics_models","kinematics_model",Jn),p(Nt,"library_physics_models","physics_model",Qr),p(Nt,"scene","instance_kinematics_scene",Yn),g(Ee.animations,T),g(Ee.clips,de),g(Ee.controllers,Me),g(Ee.images,Je),g(Ee.effects,rr),g(Ee.materials,wn),g(Ee.cameras,ve),g(Ee.lights,$),g(Ee.geometries,zt),g(Ee.visualScenes,Mn),Gn(),ss();var He=sn(r(Nt,"scene")[0]);return Zn.upAxis==="Z_UP"&&He.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),He.scale.multiplyScalar(Zn.unit),{animations:Z,kinematics:le,library:Ee,scene:He}}};THREE.ColladaLoader=ow;AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var y=this,t=this.el,r=this.data,o=this.el.sceneEl.systems.renderer;r&&(this.remove(),this.loader.load(r,function(c){y.model=c.scene,y.model.traverse(function(A){if(A.isMesh){var B=A.material;B.color&&o.applyColorCorrection(B.color),B.map&&o.applyColorCorrection(B.map),B.emissive&&o.applyColorCorrection(B.emissive),B.emissiveMap&&o.applyColorCorrection(B.emissiveMap)}}),t.setObject3D("mesh",y.model),t.emit("model-loaded",{format:"collada",model:y.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const zv="164",EA=0,aw=1,U0=1,G0=100,V0=204,z0=205,Q0=3,BA=0,H0="attached",lw="detached",Qv=300,cw=303,yd=1e3,ec=1001,j0=1002,Ed=1003,hw=1006,uw=1008,dw=1009,fw=1014,Hv=1015,pw=1020,jv=1023,Vp=1026,W0=1027,xd=2300,Cd=2301,zp=2302,K0=2400,X0=2401,Y0=2402,Aw=2500,Wv=0,Kv="",zs="srgb",RA="srgb-linear",mw="display-p3",Xv="display-p3-linear",xA="linear",q0="srgb",J0="rec709",Z0="p3",Fl=7680,$0=519,gw=515,ev=35044,Ja=2e3,CA=2001;class Sd{addEventListener(t,r){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[t]===void 0&&(o[t]=[]),o[t].indexOf(r)===-1&&o[t].push(r)}hasEventListener(t,r){if(this._listeners===void 0)return!1;const o=this._listeners;return o[t]!==void 0&&o[t].indexOf(r)!==-1}removeEventListener(t,r){if(this._listeners===void 0)return;const c=this._listeners[t];if(c!==void 0){const A=c.indexOf(r);A!==-1&&c.splice(A,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const o=this._listeners[t.type];if(o!==void 0){t.target=this;const c=o.slice(0);for(let A=0,B=c.length;A<B;A++)c[A].call(this,t);t.target=null}}}const is=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let tv=1234567;const th=Math.PI/180,oh=180/Math.PI;function ma(){const y=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(is[y&255]+is[y>>8&255]+is[y>>16&255]+is[y>>24&255]+"-"+is[t&255]+is[t>>8&255]+"-"+is[t>>16&15|64]+is[t>>24&255]+"-"+is[r&63|128]+is[r>>8&255]+"-"+is[r>>16&255]+is[r>>24&255]+is[o&255]+is[o>>8&255]+is[o>>16&255]+is[o>>24&255]).toLowerCase()}function Kr(y,t,r){return Math.max(t,Math.min(r,y))}function LA(y,t){return(y%t+t)%t}function vw(y,t,r,o,c){return o+(y-t)*(c-o)/(r-t)}function yw(y,t,r){return y!==t?(r-y)/(t-y):0}function ih(y,t,r){return(1-r)*y+r*t}function Ew(y,t,r,o){return ih(y,t,1-Math.exp(-r*o))}function xw(y,t=1){return t-Math.abs(LA(y,t*2)-t)}function Cw(y,t,r){return y<=t?0:y>=r?1:(y=(y-t)/(r-t),y*y*(3-2*y))}function bw(y,t,r){return y<=t?0:y>=r?1:(y=(y-t)/(r-t),y*y*y*(y*(y*6-15)+10))}function ww(y,t){return y+Math.floor(Math.random()*(t-y+1))}function Mw(y,t){return y+Math.random()*(t-y)}function _w(y){return y*(.5-Math.random())}function Sw(y){y!==void 0&&(tv=y);let t=tv+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function Tw(y){return y*th}function Iw(y){return y*oh}function Bw(y){return(y&y-1)===0&&y!==0}function Rw(y){return Math.pow(2,Math.ceil(Math.log(y)/Math.LN2))}function Lw(y){return Math.pow(2,Math.floor(Math.log(y)/Math.LN2))}function Dw(y,t,r,o,c){const A=Math.cos,B=Math.sin,m=A(r/2),M=B(r/2),h=A((t+o)/2),f=B((t+o)/2),C=A((t-o)/2),p=B((t-o)/2),g=A((o-t)/2),u=B((o-t)/2);switch(c){case"XYX":y.set(m*f,M*C,M*p,m*h);break;case"YZY":y.set(M*p,m*f,M*C,m*h);break;case"ZXZ":y.set(M*C,M*p,m*f,m*h);break;case"XZX":y.set(m*f,M*u,M*g,m*h);break;case"YXY":y.set(M*g,m*f,M*u,m*h);break;case"ZYZ":y.set(M*u,M*g,m*f,m*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+c)}}function Jl(y,t){switch(t.constructor){case Float32Array:return y;case Uint32Array:return y/4294967295;case Uint16Array:return y/65535;case Uint8Array:return y/255;case Int32Array:return Math.max(y/2147483647,-1);case Int16Array:return Math.max(y/32767,-1);case Int8Array:return Math.max(y/127,-1);default:throw new Error("Invalid component type.")}}function fs(y,t){switch(t.constructor){case Float32Array:return y;case Uint32Array:return Math.round(y*4294967295);case Uint16Array:return Math.round(y*65535);case Uint8Array:return Math.round(y*255);case Int32Array:return Math.round(y*2147483647);case Int16Array:return Math.round(y*32767);case Int8Array:return Math.round(y*127);default:throw new Error("Invalid component type.")}}const As={DEG2RAD:th,RAD2DEG:oh,generateUUID:ma,clamp:Kr,euclideanModulo:LA,mapLinear:vw,inverseLerp:yw,lerp:ih,damp:Ew,pingpong:xw,smoothstep:Cw,smootherstep:bw,randInt:ww,randFloat:Mw,randFloatSpread:_w,seededRandom:Sw,degToRad:Tw,radToDeg:Iw,isPowerOfTwo:Bw,ceilPowerOfTwo:Rw,floorPowerOfTwo:Lw,setQuaternionFromProperEuler:Dw,normalize:fs,denormalize:Jl};class pr{constructor(t=0,r=0){pr.prototype.isVector2=!0,this.x=t,this.y=r}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,r){return this.x=t,this.y=r,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const r=this.x,o=this.y,c=t.elements;return this.x=c[0]*r+c[3]*o+c[6],this.y=c[1]*r+c[4]*o+c[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this}clampScalar(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this}clampLength(t,r){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(r,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const r=Math.sqrt(this.lengthSq()*t.lengthSq());if(r===0)return Math.PI/2;const o=this.dot(t)/r;return Math.acos(Kr(o,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const r=this.x-t.x,o=this.y-t.y;return r*r+o*o}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this}lerpVectors(t,r,o){return this.x=t.x+(r.x-t.x)*o,this.y=t.y+(r.y-t.y)*o,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this}rotateAround(t,r){const o=Math.cos(r),c=Math.sin(r),A=this.x-t.x,B=this.y-t.y;return this.x=A*o-B*c+t.x,this.y=A*c+B*o+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class mo{constructor(t,r,o,c,A,B,m,M,h){mo.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,r,o,c,A,B,m,M,h)}set(t,r,o,c,A,B,m,M,h){const f=this.elements;return f[0]=t,f[1]=c,f[2]=m,f[3]=r,f[4]=A,f[5]=M,f[6]=o,f[7]=B,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const r=this.elements,o=t.elements;return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],this}extractBasis(t,r,o){return t.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const r=t.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,r){const o=t.elements,c=r.elements,A=this.elements,B=o[0],m=o[3],M=o[6],h=o[1],f=o[4],C=o[7],p=o[2],g=o[5],u=o[8],E=c[0],b=c[3],x=c[6],T=c[1],_=c[4],w=c[7],S=c[2],L=c[5],P=c[8];return A[0]=B*E+m*T+M*S,A[3]=B*b+m*_+M*L,A[6]=B*x+m*w+M*P,A[1]=h*E+f*T+C*S,A[4]=h*b+f*_+C*L,A[7]=h*x+f*w+C*P,A[2]=p*E+g*T+u*S,A[5]=p*b+g*_+u*L,A[8]=p*x+g*w+u*P,this}multiplyScalar(t){const r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=t,r[4]*=t,r[7]*=t,r[2]*=t,r[5]*=t,r[8]*=t,this}determinant(){const t=this.elements,r=t[0],o=t[1],c=t[2],A=t[3],B=t[4],m=t[5],M=t[6],h=t[7],f=t[8];return r*B*f-r*m*h-o*A*f+o*m*M+c*A*h-c*B*M}invert(){const t=this.elements,r=t[0],o=t[1],c=t[2],A=t[3],B=t[4],m=t[5],M=t[6],h=t[7],f=t[8],C=f*B-m*h,p=m*M-f*A,g=h*A-B*M,u=r*C+o*p+c*g;if(u===0)return this.set(0,0,0,0,0,0,0,0,0);const E=1/u;return t[0]=C*E,t[1]=(c*h-f*o)*E,t[2]=(m*o-c*B)*E,t[3]=p*E,t[4]=(f*r-c*M)*E,t[5]=(c*A-m*r)*E,t[6]=g*E,t[7]=(o*M-h*r)*E,t[8]=(B*r-o*A)*E,this}transpose(){let t;const r=this.elements;return t=r[1],r[1]=r[3],r[3]=t,t=r[2],r[2]=r[6],r[6]=t,t=r[5],r[5]=r[7],r[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const r=this.elements;return t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8],this}setUvTransform(t,r,o,c,A,B,m){const M=Math.cos(A),h=Math.sin(A);return this.set(o*M,o*h,-o*(M*B+h*m)+B+t,-c*h,c*M,-c*(-h*B+M*m)+m+r,0,0,1),this}scale(t,r){return this.premultiply(Qp.makeScale(t,r)),this}rotate(t){return this.premultiply(Qp.makeRotation(-t)),this}translate(t,r){return this.premultiply(Qp.makeTranslation(t,r)),this}makeTranslation(t,r){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,r,0,0,1),this}makeRotation(t){const r=Math.cos(t),o=Math.sin(t);return this.set(r,-o,0,o,r,0,0,0,1),this}makeScale(t,r){return this.set(t,0,0,0,r,0,0,0,1),this}equals(t){const r=this.elements,o=t.elements;for(let c=0;c<9;c++)if(r[c]!==o[c])return!1;return!0}fromArray(t,r=0){for(let o=0;o<9;o++)this.elements[o]=t[o+r];return this}toArray(t=[],r=0){const o=this.elements;return t[r]=o[0],t[r+1]=o[1],t[r+2]=o[2],t[r+3]=o[3],t[r+4]=o[4],t[r+5]=o[5],t[r+6]=o[6],t[r+7]=o[7],t[r+8]=o[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const Qp=new mo;function Pw(y){for(let t=y.length-1;t>=0;--t)if(y[t]>=65535)return!0;return!1}function bA(y){return document.createElementNS("http://www.w3.org/1999/xhtml",y)}const iv={};function Ow(y){y in iv||(iv[y]=!0,console.warn(y))}const nv=new mo().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),rv=new mo().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),ju={[RA]:{transfer:xA,primaries:J0,toReference:y=>y,fromReference:y=>y},[zs]:{transfer:q0,primaries:J0,toReference:y=>y.convertSRGBToLinear(),fromReference:y=>y.convertLinearToSRGB()},[Xv]:{transfer:xA,primaries:Z0,toReference:y=>y.applyMatrix3(rv),fromReference:y=>y.applyMatrix3(nv)},[mw]:{transfer:q0,primaries:Z0,toReference:y=>y.convertSRGBToLinear().applyMatrix3(rv),fromReference:y=>y.applyMatrix3(nv).convertLinearToSRGB()}},Fw=new Set([RA,Xv]),Zs={enabled:!0,_workingColorSpace:RA,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(y){if(!Fw.has(y))throw new Error(`Unsupported working color space, "${y}".`);this._workingColorSpace=y},convert:function(y,t,r){if(this.enabled===!1||t===r||!t||!r)return y;const o=ju[t].toReference,c=ju[r].fromReference;return c(o(y))},fromWorkingColorSpace:function(y,t){return this.convert(y,this._workingColorSpace,t)},toWorkingColorSpace:function(y,t){return this.convert(y,t,this._workingColorSpace)},getPrimaries:function(y){return ju[y].primaries},getTransfer:function(y){return y===Kv?xA:ju[y].transfer}};function nc(y){return y<.04045?y*.0773993808:Math.pow(y*.9478672986+.0521327014,2.4)}function Hp(y){return y<.0031308?y*12.92:1.055*Math.pow(y,.41666)-.055}let Nl;class Nw{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let r;if(t instanceof HTMLCanvasElement)r=t;else{Nl===void 0&&(Nl=bA("canvas")),Nl.width=t.width,Nl.height=t.height;const o=Nl.getContext("2d");t instanceof ImageData?o.putImageData(t,0,0):o.drawImage(t,0,0,t.width,t.height),r=Nl}return r.width>2048||r.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),r.toDataURL("image/jpeg",.6)):r.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const r=bA("canvas");r.width=t.width,r.height=t.height;const o=r.getContext("2d");o.drawImage(t,0,0,t.width,t.height);const c=o.getImageData(0,0,t.width,t.height),A=c.data;for(let B=0;B<A.length;B++)A[B]=nc(A[B]/255)*255;return o.putImageData(c,0,0),r}else if(t.data){const r=t.data.slice(0);for(let o=0;o<r.length;o++)r instanceof Uint8Array||r instanceof Uint8ClampedArray?r[o]=Math.floor(nc(r[o]/255)*255):r[o]=nc(r[o]);return{data:r,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let kw=0;class Uw{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:kw++}),this.uuid=ma(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const r=t===void 0||typeof t=="string";if(!r&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const o={uuid:this.uuid,url:""},c=this.data;if(c!==null){let A;if(Array.isArray(c)){A=[];for(let B=0,m=c.length;B<m;B++)c[B].isDataTexture?A.push(jp(c[B].image)):A.push(jp(c[B]))}else A=jp(c);o.url=A}return r||(t.images[this.uuid]=o),o}}function jp(y){return typeof HTMLImageElement<"u"&&y instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&y instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&y instanceof ImageBitmap?Nw.getDataURL(y):y.data?{data:Array.from(y.data),width:y.width,height:y.height,type:y.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Gw=0;class Os extends Sd{constructor(t=Os.DEFAULT_IMAGE,r=Os.DEFAULT_MAPPING,o=ec,c=ec,A=hw,B=uw,m=jv,M=dw,h=Os.DEFAULT_ANISOTROPY,f=Kv){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Gw++}),this.uuid=ma(),this.name="",this.source=new Uw(t),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=o,this.wrapT=c,this.magFilter=A,this.minFilter=B,this.anisotropy=h,this.format=m,this.internalFormat=null,this.type=M,this.offset=new pr(0,0),this.repeat=new pr(1,1),this.center=new pr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new mo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const r=t===void 0||typeof t=="string";if(!r&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),r||(t.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Qv)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case yd:t.x=t.x-Math.floor(t.x);break;case ec:t.x=t.x<0?0:1;break;case j0:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case yd:t.y=t.y-Math.floor(t.y);break;case ec:t.y=t.y<0?0:1;break;case j0:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}Os.DEFAULT_IMAGE=null;Os.DEFAULT_MAPPING=Qv;Os.DEFAULT_ANISOTROPY=1;class rs{constructor(t=0,r=0,o=0,c=1){rs.prototype.isVector4=!0,this.x=t,this.y=r,this.z=o,this.w=c}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,r,o,c){return this.x=t,this.y=r,this.z=o,this.w=c,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this.w=t.w+r.w,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this.w+=t.w*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this.w=t.w-r.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const r=this.x,o=this.y,c=this.z,A=this.w,B=t.elements;return this.x=B[0]*r+B[4]*o+B[8]*c+B[12]*A,this.y=B[1]*r+B[5]*o+B[9]*c+B[13]*A,this.z=B[2]*r+B[6]*o+B[10]*c+B[14]*A,this.w=B[3]*r+B[7]*o+B[11]*c+B[15]*A,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const r=Math.sqrt(1-t.w*t.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/r,this.y=t.y/r,this.z=t.z/r),this}setAxisAngleFromRotationMatrix(t){let r,o,c,A;const M=t.elements,h=M[0],f=M[4],C=M[8],p=M[1],g=M[5],u=M[9],E=M[2],b=M[6],x=M[10];if(Math.abs(f-p)<.01&&Math.abs(C-E)<.01&&Math.abs(u-b)<.01){if(Math.abs(f+p)<.1&&Math.abs(C+E)<.1&&Math.abs(u+b)<.1&&Math.abs(h+g+x-3)<.1)return this.set(1,0,0,0),this;r=Math.PI;const _=(h+1)/2,w=(g+1)/2,S=(x+1)/2,L=(f+p)/4,P=(C+E)/4,D=(u+b)/4;return _>w&&_>S?_<.01?(o=0,c=.707106781,A=.707106781):(o=Math.sqrt(_),c=L/o,A=P/o):w>S?w<.01?(o=.707106781,c=0,A=.707106781):(c=Math.sqrt(w),o=L/c,A=D/c):S<.01?(o=.707106781,c=.707106781,A=0):(A=Math.sqrt(S),o=P/A,c=D/A),this.set(o,c,A,r),this}let T=Math.sqrt((b-u)*(b-u)+(C-E)*(C-E)+(p-f)*(p-f));return Math.abs(T)<.001&&(T=1),this.x=(b-u)/T,this.y=(C-E)/T,this.z=(p-f)/T,this.w=Math.acos((h+g+x-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this.w=Math.max(t.w,Math.min(r.w,this.w)),this}clampScalar(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this.w=Math.max(t,Math.min(r,this.w)),this}clampLength(t,r){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(r,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this.w+=(t.w-this.w)*r,this}lerpVectors(t,r,o){return this.x=t.x+(r.x-t.x)*o,this.y=t.y+(r.y-t.y)*o,this.z=t.z+(r.z-t.z)*o,this.w=t.w+(r.w-t.w)*o,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this.z=t[r+2],this.w=t[r+3],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this.w=t.getW(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ws{constructor(t=0,r=0,o=0,c=1){this.isQuaternion=!0,this._x=t,this._y=r,this._z=o,this._w=c}static slerpFlat(t,r,o,c,A,B,m){let M=o[c+0],h=o[c+1],f=o[c+2],C=o[c+3];const p=A[B+0],g=A[B+1],u=A[B+2],E=A[B+3];if(m===0){t[r+0]=M,t[r+1]=h,t[r+2]=f,t[r+3]=C;return}if(m===1){t[r+0]=p,t[r+1]=g,t[r+2]=u,t[r+3]=E;return}if(C!==E||M!==p||h!==g||f!==u){let b=1-m;const x=M*p+h*g+f*u+C*E,T=x>=0?1:-1,_=1-x*x;if(_>Number.EPSILON){const S=Math.sqrt(_),L=Math.atan2(S,x*T);b=Math.sin(b*L)/S,m=Math.sin(m*L)/S}const w=m*T;if(M=M*b+p*w,h=h*b+g*w,f=f*b+u*w,C=C*b+E*w,b===1-m){const S=1/Math.sqrt(M*M+h*h+f*f+C*C);M*=S,h*=S,f*=S,C*=S}}t[r]=M,t[r+1]=h,t[r+2]=f,t[r+3]=C}static multiplyQuaternionsFlat(t,r,o,c,A,B){const m=o[c],M=o[c+1],h=o[c+2],f=o[c+3],C=A[B],p=A[B+1],g=A[B+2],u=A[B+3];return t[r]=m*u+f*C+M*g-h*p,t[r+1]=M*u+f*p+h*C-m*g,t[r+2]=h*u+f*g+m*p-M*C,t[r+3]=f*u-m*C-M*p-h*g,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,r,o,c){return this._x=t,this._y=r,this._z=o,this._w=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,r=!0){const o=t._x,c=t._y,A=t._z,B=t._order,m=Math.cos,M=Math.sin,h=m(o/2),f=m(c/2),C=m(A/2),p=M(o/2),g=M(c/2),u=M(A/2);switch(B){case"XYZ":this._x=p*f*C+h*g*u,this._y=h*g*C-p*f*u,this._z=h*f*u+p*g*C,this._w=h*f*C-p*g*u;break;case"YXZ":this._x=p*f*C+h*g*u,this._y=h*g*C-p*f*u,this._z=h*f*u-p*g*C,this._w=h*f*C+p*g*u;break;case"ZXY":this._x=p*f*C-h*g*u,this._y=h*g*C+p*f*u,this._z=h*f*u+p*g*C,this._w=h*f*C-p*g*u;break;case"ZYX":this._x=p*f*C-h*g*u,this._y=h*g*C+p*f*u,this._z=h*f*u-p*g*C,this._w=h*f*C+p*g*u;break;case"YZX":this._x=p*f*C+h*g*u,this._y=h*g*C+p*f*u,this._z=h*f*u-p*g*C,this._w=h*f*C-p*g*u;break;case"XZY":this._x=p*f*C-h*g*u,this._y=h*g*C-p*f*u,this._z=h*f*u+p*g*C,this._w=h*f*C+p*g*u;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+B)}return r===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,r){const o=r/2,c=Math.sin(o);return this._x=t.x*c,this._y=t.y*c,this._z=t.z*c,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(t){const r=t.elements,o=r[0],c=r[4],A=r[8],B=r[1],m=r[5],M=r[9],h=r[2],f=r[6],C=r[10],p=o+m+C;if(p>0){const g=.5/Math.sqrt(p+1);this._w=.25/g,this._x=(f-M)*g,this._y=(A-h)*g,this._z=(B-c)*g}else if(o>m&&o>C){const g=2*Math.sqrt(1+o-m-C);this._w=(f-M)/g,this._x=.25*g,this._y=(c+B)/g,this._z=(A+h)/g}else if(m>C){const g=2*Math.sqrt(1+m-o-C);this._w=(A-h)/g,this._x=(c+B)/g,this._y=.25*g,this._z=(M+f)/g}else{const g=2*Math.sqrt(1+C-o-m);this._w=(B-c)/g,this._x=(A+h)/g,this._y=(M+f)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(t,r){let o=t.dot(r)+1;return o<Number.EPSILON?(o=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=o):(this._x=0,this._y=-t.z,this._z=t.y,this._w=o)):(this._x=t.y*r.z-t.z*r.y,this._y=t.z*r.x-t.x*r.z,this._z=t.x*r.y-t.y*r.x,this._w=o),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Kr(this.dot(t),-1,1)))}rotateTowards(t,r){const o=this.angleTo(t);if(o===0)return this;const c=Math.min(1,r/o);return this.slerp(t,c),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,r){const o=t._x,c=t._y,A=t._z,B=t._w,m=r._x,M=r._y,h=r._z,f=r._w;return this._x=o*f+B*m+c*h-A*M,this._y=c*f+B*M+A*m-o*h,this._z=A*f+B*h+o*M-c*m,this._w=B*f-o*m-c*M-A*h,this._onChangeCallback(),this}slerp(t,r){if(r===0)return this;if(r===1)return this.copy(t);const o=this._x,c=this._y,A=this._z,B=this._w;let m=B*t._w+o*t._x+c*t._y+A*t._z;if(m<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,m=-m):this.copy(t),m>=1)return this._w=B,this._x=o,this._y=c,this._z=A,this;const M=1-m*m;if(M<=Number.EPSILON){const g=1-r;return this._w=g*B+r*this._w,this._x=g*o+r*this._x,this._y=g*c+r*this._y,this._z=g*A+r*this._z,this.normalize(),this}const h=Math.sqrt(M),f=Math.atan2(h,m),C=Math.sin((1-r)*f)/h,p=Math.sin(r*f)/h;return this._w=B*C+this._w*p,this._x=o*C+this._x*p,this._y=c*C+this._y*p,this._z=A*C+this._z*p,this._onChangeCallback(),this}slerpQuaternions(t,r,o){return this.copy(t).slerp(r,o)}random(){const t=2*Math.PI*Math.random(),r=2*Math.PI*Math.random(),o=Math.random(),c=Math.sqrt(1-o),A=Math.sqrt(o);return this.set(c*Math.sin(t),c*Math.cos(t),A*Math.sin(r),A*Math.cos(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,r=0){return this._x=t[r],this._y=t[r+1],this._z=t[r+2],this._w=t[r+3],this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._w,t}fromBufferAttribute(t,r){return this._x=t.getX(r),this._y=t.getY(r),this._z=t.getZ(r),this._w=t.getW(r),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class it{constructor(t=0,r=0,o=0){it.prototype.isVector3=!0,this.x=t,this.y=r,this.z=o}set(t,r,o){return o===void 0&&(o=this.z),this.x=t,this.y=r,this.z=o,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,r){return this.x=t.x*r.x,this.y=t.y*r.y,this.z=t.z*r.z,this}applyEuler(t){return this.applyQuaternion(sv.setFromEuler(t))}applyAxisAngle(t,r){return this.applyQuaternion(sv.setFromAxisAngle(t,r))}applyMatrix3(t){const r=this.x,o=this.y,c=this.z,A=t.elements;return this.x=A[0]*r+A[3]*o+A[6]*c,this.y=A[1]*r+A[4]*o+A[7]*c,this.z=A[2]*r+A[5]*o+A[8]*c,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const r=this.x,o=this.y,c=this.z,A=t.elements,B=1/(A[3]*r+A[7]*o+A[11]*c+A[15]);return this.x=(A[0]*r+A[4]*o+A[8]*c+A[12])*B,this.y=(A[1]*r+A[5]*o+A[9]*c+A[13])*B,this.z=(A[2]*r+A[6]*o+A[10]*c+A[14])*B,this}applyQuaternion(t){const r=this.x,o=this.y,c=this.z,A=t.x,B=t.y,m=t.z,M=t.w,h=2*(B*c-m*o),f=2*(m*r-A*c),C=2*(A*o-B*r);return this.x=r+M*h+B*C-m*f,this.y=o+M*f+m*h-A*C,this.z=c+M*C+A*f-B*h,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const r=this.x,o=this.y,c=this.z,A=t.elements;return this.x=A[0]*r+A[4]*o+A[8]*c,this.y=A[1]*r+A[5]*o+A[9]*c,this.z=A[2]*r+A[6]*o+A[10]*c,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this}clampScalar(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this}clampLength(t,r){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(r,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this}lerpVectors(t,r,o){return this.x=t.x+(r.x-t.x)*o,this.y=t.y+(r.y-t.y)*o,this.z=t.z+(r.z-t.z)*o,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){const o=t.x,c=t.y,A=t.z,B=r.x,m=r.y,M=r.z;return this.x=c*M-A*m,this.y=A*B-o*M,this.z=o*m-c*B,this}projectOnVector(t){const r=t.lengthSq();if(r===0)return this.set(0,0,0);const o=t.dot(this)/r;return this.copy(t).multiplyScalar(o)}projectOnPlane(t){return Wp.copy(this).projectOnVector(t),this.sub(Wp)}reflect(t){return this.sub(Wp.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const r=Math.sqrt(this.lengthSq()*t.lengthSq());if(r===0)return Math.PI/2;const o=this.dot(t)/r;return Math.acos(Kr(o,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const r=this.x-t.x,o=this.y-t.y,c=this.z-t.z;return r*r+o*o+c*c}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,r,o){const c=Math.sin(r)*t;return this.x=c*Math.sin(o),this.y=Math.cos(r)*t,this.z=c*Math.cos(o),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,r,o){return this.x=t*Math.sin(r),this.y=o,this.z=t*Math.cos(r),this}setFromMatrixPosition(t){const r=t.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(t){const r=this.setFromMatrixColumn(t,0).length(),o=this.setFromMatrixColumn(t,1).length(),c=this.setFromMatrixColumn(t,2).length();return this.x=r,this.y=o,this.z=c,this}setFromMatrixColumn(t,r){return this.fromArray(t.elements,r*4)}setFromMatrix3Column(t,r){return this.fromArray(t.elements,r*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this.z=t[r+2],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,r=Math.random()*2-1,o=Math.sqrt(1-r*r);return this.x=o*Math.cos(t),this.y=r,this.z=o*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Wp=new it,sv=new ws;class rc{constructor(t=new it(1/0,1/0,1/0),r=new it(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=r}set(t,r){return this.min.copy(t),this.max.copy(r),this}setFromArray(t){this.makeEmpty();for(let r=0,o=t.length;r<o;r+=3)this.expandByPoint($s.fromArray(t,r));return this}setFromBufferAttribute(t){this.makeEmpty();for(let r=0,o=t.count;r<o;r++)this.expandByPoint($s.fromBufferAttribute(t,r));return this}setFromPoints(t){this.makeEmpty();for(let r=0,o=t.length;r<o;r++)this.expandByPoint(t[r]);return this}setFromCenterAndSize(t,r){const o=$s.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(o),this.max.copy(t).add(o),this}setFromObject(t,r=!1){return this.makeEmpty(),this.expandByObject(t,r)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,r=!1){t.updateWorldMatrix(!1,!1);const o=t.geometry;if(o!==void 0){const A=o.getAttribute("position");if(r===!0&&A!==void 0&&t.isInstancedMesh!==!0)for(let B=0,m=A.count;B<m;B++)t.isMesh===!0?t.getVertexPosition(B,$s):$s.fromBufferAttribute(A,B),$s.applyMatrix4(t.matrixWorld),this.expandByPoint($s);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),Wu.copy(t.boundingBox)):(o.boundingBox===null&&o.computeBoundingBox(),Wu.copy(o.boundingBox)),Wu.applyMatrix4(t.matrixWorld),this.union(Wu)}const c=t.children;for(let A=0,B=c.length;A<B;A++)this.expandByObject(c[A],r);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,r){return r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,$s),$s.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let r,o;return t.normal.x>0?(r=t.normal.x*this.min.x,o=t.normal.x*this.max.x):(r=t.normal.x*this.max.x,o=t.normal.x*this.min.x),t.normal.y>0?(r+=t.normal.y*this.min.y,o+=t.normal.y*this.max.y):(r+=t.normal.y*this.max.y,o+=t.normal.y*this.min.y),t.normal.z>0?(r+=t.normal.z*this.min.z,o+=t.normal.z*this.max.z):(r+=t.normal.z*this.max.z,o+=t.normal.z*this.min.z),r<=-t.constant&&o>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Wc),Ku.subVectors(this.max,Wc),kl.subVectors(t.a,Wc),Ul.subVectors(t.b,Wc),Gl.subVectors(t.c,Wc),aa.subVectors(Ul,kl),la.subVectors(Gl,Ul),Wa.subVectors(kl,Gl);let r=[0,-aa.z,aa.y,0,-la.z,la.y,0,-Wa.z,Wa.y,aa.z,0,-aa.x,la.z,0,-la.x,Wa.z,0,-Wa.x,-aa.y,aa.x,0,-la.y,la.x,0,-Wa.y,Wa.x,0];return!Kp(r,kl,Ul,Gl,Ku)||(r=[1,0,0,0,1,0,0,0,1],!Kp(r,kl,Ul,Gl,Ku))?!1:(Xu.crossVectors(aa,la),r=[Xu.x,Xu.y,Xu.z],Kp(r,kl,Ul,Gl,Ku))}clampPoint(t,r){return r.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,$s).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize($s).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Oo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Oo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Oo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Oo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Oo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Oo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Oo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Oo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Oo),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Oo=[new it,new it,new it,new it,new it,new it,new it,new it],$s=new it,Wu=new rc,kl=new it,Ul=new it,Gl=new it,aa=new it,la=new it,Wa=new it,Wc=new it,Ku=new it,Xu=new it,Ka=new it;function Kp(y,t,r,o,c){for(let A=0,B=y.length-3;A<=B;A+=3){Ka.fromArray(y,A);const m=c.x*Math.abs(Ka.x)+c.y*Math.abs(Ka.y)+c.z*Math.abs(Ka.z),M=t.dot(Ka),h=r.dot(Ka),f=o.dot(Ka);if(Math.max(-Math.max(M,h,f),Math.min(M,h,f))>m)return!1}return!0}const Vw=new rc,Kc=new it,Xp=new it;class sc{constructor(t=new it,r=-1){this.isSphere=!0,this.center=t,this.radius=r}set(t,r){return this.center.copy(t),this.radius=r,this}setFromPoints(t,r){const o=this.center;r!==void 0?o.copy(r):Vw.setFromPoints(t).getCenter(o);let c=0;for(let A=0,B=t.length;A<B;A++)c=Math.max(c,o.distanceToSquared(t[A]));return this.radius=Math.sqrt(c),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const r=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=r*r}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,r){const o=this.center.distanceToSquared(t);return r.copy(t),o>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Kc.subVectors(t,this.center);const r=Kc.lengthSq();if(r>this.radius*this.radius){const o=Math.sqrt(r),c=(o-this.radius)*.5;this.center.addScaledVector(Kc,c/o),this.radius+=c}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(Xp.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Kc.copy(t.center).add(Xp)),this.expandByPoint(Kc.copy(t.center).sub(Xp))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Fo=new it,Yp=new it,Yu=new it,ca=new it,qp=new it,qu=new it,Jp=new it;class DA{constructor(t=new it,r=new it(0,0,-1)){this.origin=t,this.direction=r}set(t,r){return this.origin.copy(t),this.direction.copy(r),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,r){return r.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Fo)),this}closestPointToPoint(t,r){r.subVectors(t,this.origin);const o=r.dot(this.direction);return o<0?r.copy(this.origin):r.copy(this.origin).addScaledVector(this.direction,o)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const r=Fo.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(Fo.copy(this.origin).addScaledVector(this.direction,r),Fo.distanceToSquared(t))}distanceSqToSegment(t,r,o,c){Yp.copy(t).add(r).multiplyScalar(.5),Yu.copy(r).sub(t).normalize(),ca.copy(this.origin).sub(Yp);const A=t.distanceTo(r)*.5,B=-this.direction.dot(Yu),m=ca.dot(this.direction),M=-ca.dot(Yu),h=ca.lengthSq(),f=Math.abs(1-B*B);let C,p,g,u;if(f>0)if(C=B*M-m,p=B*m-M,u=A*f,C>=0)if(p>=-u)if(p<=u){const E=1/f;C*=E,p*=E,g=C*(C+B*p+2*m)+p*(B*C+p+2*M)+h}else p=A,C=Math.max(0,-(B*p+m)),g=-C*C+p*(p+2*M)+h;else p=-A,C=Math.max(0,-(B*p+m)),g=-C*C+p*(p+2*M)+h;else p<=-u?(C=Math.max(0,-(-B*A+m)),p=C>0?-A:Math.min(Math.max(-A,-M),A),g=-C*C+p*(p+2*M)+h):p<=u?(C=0,p=Math.min(Math.max(-A,-M),A),g=p*(p+2*M)+h):(C=Math.max(0,-(B*A+m)),p=C>0?A:Math.min(Math.max(-A,-M),A),g=-C*C+p*(p+2*M)+h);else p=B>0?-A:A,C=Math.max(0,-(B*p+m)),g=-C*C+p*(p+2*M)+h;return o&&o.copy(this.origin).addScaledVector(this.direction,C),c&&c.copy(Yp).addScaledVector(Yu,p),g}intersectSphere(t,r){Fo.subVectors(t.center,this.origin);const o=Fo.dot(this.direction),c=Fo.dot(Fo)-o*o,A=t.radius*t.radius;if(c>A)return null;const B=Math.sqrt(A-c),m=o-B,M=o+B;return M<0?null:m<0?this.at(M,r):this.at(m,r)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const r=t.normal.dot(this.direction);if(r===0)return t.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(t.normal)+t.constant)/r;return o>=0?o:null}intersectPlane(t,r){const o=this.distanceToPlane(t);return o===null?null:this.at(o,r)}intersectsPlane(t){const r=t.distanceToPoint(this.origin);return r===0||t.normal.dot(this.direction)*r<0}intersectBox(t,r){let o,c,A,B,m,M;const h=1/this.direction.x,f=1/this.direction.y,C=1/this.direction.z,p=this.origin;return h>=0?(o=(t.min.x-p.x)*h,c=(t.max.x-p.x)*h):(o=(t.max.x-p.x)*h,c=(t.min.x-p.x)*h),f>=0?(A=(t.min.y-p.y)*f,B=(t.max.y-p.y)*f):(A=(t.max.y-p.y)*f,B=(t.min.y-p.y)*f),o>B||A>c||((A>o||isNaN(o))&&(o=A),(B<c||isNaN(c))&&(c=B),C>=0?(m=(t.min.z-p.z)*C,M=(t.max.z-p.z)*C):(m=(t.max.z-p.z)*C,M=(t.min.z-p.z)*C),o>M||m>c)||((m>o||o!==o)&&(o=m),(M<c||c!==c)&&(c=M),c<0)?null:this.at(o>=0?o:c,r)}intersectsBox(t){return this.intersectBox(t,Fo)!==null}intersectTriangle(t,r,o,c,A){qp.subVectors(r,t),qu.subVectors(o,t),Jp.crossVectors(qp,qu);let B=this.direction.dot(Jp),m;if(B>0){if(c)return null;m=1}else if(B<0)m=-1,B=-B;else return null;ca.subVectors(this.origin,t);const M=m*this.direction.dot(qu.crossVectors(ca,qu));if(M<0)return null;const h=m*this.direction.dot(qp.cross(ca));if(h<0||M+h>B)return null;const f=-m*ca.dot(Jp);return f<0?null:this.at(f/B,A)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Gi{constructor(t,r,o,c,A,B,m,M,h,f,C,p,g,u,E,b){Gi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,r,o,c,A,B,m,M,h,f,C,p,g,u,E,b)}set(t,r,o,c,A,B,m,M,h,f,C,p,g,u,E,b){const x=this.elements;return x[0]=t,x[4]=r,x[8]=o,x[12]=c,x[1]=A,x[5]=B,x[9]=m,x[13]=M,x[2]=h,x[6]=f,x[10]=C,x[14]=p,x[3]=g,x[7]=u,x[11]=E,x[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Gi().fromArray(this.elements)}copy(t){const r=this.elements,o=t.elements;return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r[9]=o[9],r[10]=o[10],r[11]=o[11],r[12]=o[12],r[13]=o[13],r[14]=o[14],r[15]=o[15],this}copyPosition(t){const r=this.elements,o=t.elements;return r[12]=o[12],r[13]=o[13],r[14]=o[14],this}setFromMatrix3(t){const r=t.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(t,r,o){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(t,r,o){return this.set(t.x,r.x,o.x,0,t.y,r.y,o.y,0,t.z,r.z,o.z,0,0,0,0,1),this}extractRotation(t){const r=this.elements,o=t.elements,c=1/Vl.setFromMatrixColumn(t,0).length(),A=1/Vl.setFromMatrixColumn(t,1).length(),B=1/Vl.setFromMatrixColumn(t,2).length();return r[0]=o[0]*c,r[1]=o[1]*c,r[2]=o[2]*c,r[3]=0,r[4]=o[4]*A,r[5]=o[5]*A,r[6]=o[6]*A,r[7]=0,r[8]=o[8]*B,r[9]=o[9]*B,r[10]=o[10]*B,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(t){const r=this.elements,o=t.x,c=t.y,A=t.z,B=Math.cos(o),m=Math.sin(o),M=Math.cos(c),h=Math.sin(c),f=Math.cos(A),C=Math.sin(A);if(t.order==="XYZ"){const p=B*f,g=B*C,u=m*f,E=m*C;r[0]=M*f,r[4]=-M*C,r[8]=h,r[1]=g+u*h,r[5]=p-E*h,r[9]=-m*M,r[2]=E-p*h,r[6]=u+g*h,r[10]=B*M}else if(t.order==="YXZ"){const p=M*f,g=M*C,u=h*f,E=h*C;r[0]=p+E*m,r[4]=u*m-g,r[8]=B*h,r[1]=B*C,r[5]=B*f,r[9]=-m,r[2]=g*m-u,r[6]=E+p*m,r[10]=B*M}else if(t.order==="ZXY"){const p=M*f,g=M*C,u=h*f,E=h*C;r[0]=p-E*m,r[4]=-B*C,r[8]=u+g*m,r[1]=g+u*m,r[5]=B*f,r[9]=E-p*m,r[2]=-B*h,r[6]=m,r[10]=B*M}else if(t.order==="ZYX"){const p=B*f,g=B*C,u=m*f,E=m*C;r[0]=M*f,r[4]=u*h-g,r[8]=p*h+E,r[1]=M*C,r[5]=E*h+p,r[9]=g*h-u,r[2]=-h,r[6]=m*M,r[10]=B*M}else if(t.order==="YZX"){const p=B*M,g=B*h,u=m*M,E=m*h;r[0]=M*f,r[4]=E-p*C,r[8]=u*C+g,r[1]=C,r[5]=B*f,r[9]=-m*f,r[2]=-h*f,r[6]=g*C+u,r[10]=p-E*C}else if(t.order==="XZY"){const p=B*M,g=B*h,u=m*M,E=m*h;r[0]=M*f,r[4]=-C,r[8]=h*f,r[1]=p*C+E,r[5]=B*f,r[9]=g*C-u,r[2]=u*C-g,r[6]=m*f,r[10]=E*C+p}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(t){return this.compose(zw,t,Qw)}lookAt(t,r,o){const c=this.elements;return Ds.subVectors(t,r),Ds.lengthSq()===0&&(Ds.z=1),Ds.normalize(),ha.crossVectors(o,Ds),ha.lengthSq()===0&&(Math.abs(o.z)===1?Ds.x+=1e-4:Ds.z+=1e-4,Ds.normalize(),ha.crossVectors(o,Ds)),ha.normalize(),Ju.crossVectors(Ds,ha),c[0]=ha.x,c[4]=Ju.x,c[8]=Ds.x,c[1]=ha.y,c[5]=Ju.y,c[9]=Ds.y,c[2]=ha.z,c[6]=Ju.z,c[10]=Ds.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,r){const o=t.elements,c=r.elements,A=this.elements,B=o[0],m=o[4],M=o[8],h=o[12],f=o[1],C=o[5],p=o[9],g=o[13],u=o[2],E=o[6],b=o[10],x=o[14],T=o[3],_=o[7],w=o[11],S=o[15],L=c[0],P=c[4],D=c[8],U=c[12],F=c[1],j=c[5],Y=c[9],oe=c[13],te=c[2],pe=c[6],de=c[10],se=c[14],J=c[3],H=c[7],ae=c[11],ue=c[15];return A[0]=B*L+m*F+M*te+h*J,A[4]=B*P+m*j+M*pe+h*H,A[8]=B*D+m*Y+M*de+h*ae,A[12]=B*U+m*oe+M*se+h*ue,A[1]=f*L+C*F+p*te+g*J,A[5]=f*P+C*j+p*pe+g*H,A[9]=f*D+C*Y+p*de+g*ae,A[13]=f*U+C*oe+p*se+g*ue,A[2]=u*L+E*F+b*te+x*J,A[6]=u*P+E*j+b*pe+x*H,A[10]=u*D+E*Y+b*de+x*ae,A[14]=u*U+E*oe+b*se+x*ue,A[3]=T*L+_*F+w*te+S*J,A[7]=T*P+_*j+w*pe+S*H,A[11]=T*D+_*Y+w*de+S*ae,A[15]=T*U+_*oe+w*se+S*ue,this}multiplyScalar(t){const r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this}determinant(){const t=this.elements,r=t[0],o=t[4],c=t[8],A=t[12],B=t[1],m=t[5],M=t[9],h=t[13],f=t[2],C=t[6],p=t[10],g=t[14],u=t[3],E=t[7],b=t[11],x=t[15];return u*(+A*M*C-c*h*C-A*m*p+o*h*p+c*m*g-o*M*g)+E*(+r*M*g-r*h*p+A*B*p-c*B*g+c*h*f-A*M*f)+b*(+r*h*C-r*m*g-A*B*C+o*B*g+A*m*f-o*h*f)+x*(-c*m*f-r*M*C+r*m*p+c*B*C-o*B*p+o*M*f)}transpose(){const t=this.elements;let r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this}setPosition(t,r,o){const c=this.elements;return t.isVector3?(c[12]=t.x,c[13]=t.y,c[14]=t.z):(c[12]=t,c[13]=r,c[14]=o),this}invert(){const t=this.elements,r=t[0],o=t[1],c=t[2],A=t[3],B=t[4],m=t[5],M=t[6],h=t[7],f=t[8],C=t[9],p=t[10],g=t[11],u=t[12],E=t[13],b=t[14],x=t[15],T=C*b*h-E*p*h+E*M*g-m*b*g-C*M*x+m*p*x,_=u*p*h-f*b*h-u*M*g+B*b*g+f*M*x-B*p*x,w=f*E*h-u*C*h+u*m*g-B*E*g-f*m*x+B*C*x,S=u*C*M-f*E*M-u*m*p+B*E*p+f*m*b-B*C*b,L=r*T+o*_+c*w+A*S;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const P=1/L;return t[0]=T*P,t[1]=(E*p*A-C*b*A-E*c*g+o*b*g+C*c*x-o*p*x)*P,t[2]=(m*b*A-E*M*A+E*c*h-o*b*h-m*c*x+o*M*x)*P,t[3]=(C*M*A-m*p*A-C*c*h+o*p*h+m*c*g-o*M*g)*P,t[4]=_*P,t[5]=(f*b*A-u*p*A+u*c*g-r*b*g-f*c*x+r*p*x)*P,t[6]=(u*M*A-B*b*A-u*c*h+r*b*h+B*c*x-r*M*x)*P,t[7]=(B*p*A-f*M*A+f*c*h-r*p*h-B*c*g+r*M*g)*P,t[8]=w*P,t[9]=(u*C*A-f*E*A-u*o*g+r*E*g+f*o*x-r*C*x)*P,t[10]=(B*E*A-u*m*A+u*o*h-r*E*h-B*o*x+r*m*x)*P,t[11]=(f*m*A-B*C*A-f*o*h+r*C*h+B*o*g-r*m*g)*P,t[12]=S*P,t[13]=(f*E*c-u*C*c+u*o*p-r*E*p-f*o*b+r*C*b)*P,t[14]=(u*m*c-B*E*c-u*o*M+r*E*M+B*o*b-r*m*b)*P,t[15]=(B*C*c-f*m*c+f*o*M-r*C*M-B*o*p+r*m*p)*P,this}scale(t){const r=this.elements,o=t.x,c=t.y,A=t.z;return r[0]*=o,r[4]*=c,r[8]*=A,r[1]*=o,r[5]*=c,r[9]*=A,r[2]*=o,r[6]*=c,r[10]*=A,r[3]*=o,r[7]*=c,r[11]*=A,this}getMaxScaleOnAxis(){const t=this.elements,r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],o=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],c=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(r,o,c))}makeTranslation(t,r,o){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,r,0,0,1,o,0,0,0,1),this}makeRotationX(t){const r=Math.cos(t),o=Math.sin(t);return this.set(1,0,0,0,0,r,-o,0,0,o,r,0,0,0,0,1),this}makeRotationY(t){const r=Math.cos(t),o=Math.sin(t);return this.set(r,0,o,0,0,1,0,0,-o,0,r,0,0,0,0,1),this}makeRotationZ(t){const r=Math.cos(t),o=Math.sin(t);return this.set(r,-o,0,0,o,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,r){const o=Math.cos(r),c=Math.sin(r),A=1-o,B=t.x,m=t.y,M=t.z,h=A*B,f=A*m;return this.set(h*B+o,h*m-c*M,h*M+c*m,0,h*m+c*M,f*m+o,f*M-c*B,0,h*M-c*m,f*M+c*B,A*M*M+o,0,0,0,0,1),this}makeScale(t,r,o){return this.set(t,0,0,0,0,r,0,0,0,0,o,0,0,0,0,1),this}makeShear(t,r,o,c,A,B){return this.set(1,o,A,0,t,1,B,0,r,c,1,0,0,0,0,1),this}compose(t,r,o){const c=this.elements,A=r._x,B=r._y,m=r._z,M=r._w,h=A+A,f=B+B,C=m+m,p=A*h,g=A*f,u=A*C,E=B*f,b=B*C,x=m*C,T=M*h,_=M*f,w=M*C,S=o.x,L=o.y,P=o.z;return c[0]=(1-(E+x))*S,c[1]=(g+w)*S,c[2]=(u-_)*S,c[3]=0,c[4]=(g-w)*L,c[5]=(1-(p+x))*L,c[6]=(b+T)*L,c[7]=0,c[8]=(u+_)*P,c[9]=(b-T)*P,c[10]=(1-(p+E))*P,c[11]=0,c[12]=t.x,c[13]=t.y,c[14]=t.z,c[15]=1,this}decompose(t,r,o){const c=this.elements;let A=Vl.set(c[0],c[1],c[2]).length();const B=Vl.set(c[4],c[5],c[6]).length(),m=Vl.set(c[8],c[9],c[10]).length();this.determinant()<0&&(A=-A),t.x=c[12],t.y=c[13],t.z=c[14],eo.copy(this);const h=1/A,f=1/B,C=1/m;return eo.elements[0]*=h,eo.elements[1]*=h,eo.elements[2]*=h,eo.elements[4]*=f,eo.elements[5]*=f,eo.elements[6]*=f,eo.elements[8]*=C,eo.elements[9]*=C,eo.elements[10]*=C,r.setFromRotationMatrix(eo),o.x=A,o.y=B,o.z=m,this}makePerspective(t,r,o,c,A,B,m=Ja){const M=this.elements,h=2*A/(r-t),f=2*A/(o-c),C=(r+t)/(r-t),p=(o+c)/(o-c);let g,u;if(m===Ja)g=-(B+A)/(B-A),u=-2*B*A/(B-A);else if(m===CA)g=-B/(B-A),u=-B*A/(B-A);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+m);return M[0]=h,M[4]=0,M[8]=C,M[12]=0,M[1]=0,M[5]=f,M[9]=p,M[13]=0,M[2]=0,M[6]=0,M[10]=g,M[14]=u,M[3]=0,M[7]=0,M[11]=-1,M[15]=0,this}makeOrthographic(t,r,o,c,A,B,m=Ja){const M=this.elements,h=1/(r-t),f=1/(o-c),C=1/(B-A),p=(r+t)*h,g=(o+c)*f;let u,E;if(m===Ja)u=(B+A)*C,E=-2*C;else if(m===CA)u=A*C,E=-1*C;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+m);return M[0]=2*h,M[4]=0,M[8]=0,M[12]=-p,M[1]=0,M[5]=2*f,M[9]=0,M[13]=-g,M[2]=0,M[6]=0,M[10]=E,M[14]=-u,M[3]=0,M[7]=0,M[11]=0,M[15]=1,this}equals(t){const r=this.elements,o=t.elements;for(let c=0;c<16;c++)if(r[c]!==o[c])return!1;return!0}fromArray(t,r=0){for(let o=0;o<16;o++)this.elements[o]=t[o+r];return this}toArray(t=[],r=0){const o=this.elements;return t[r]=o[0],t[r+1]=o[1],t[r+2]=o[2],t[r+3]=o[3],t[r+4]=o[4],t[r+5]=o[5],t[r+6]=o[6],t[r+7]=o[7],t[r+8]=o[8],t[r+9]=o[9],t[r+10]=o[10],t[r+11]=o[11],t[r+12]=o[12],t[r+13]=o[13],t[r+14]=o[14],t[r+15]=o[15],t}}const Vl=new it,eo=new Gi,zw=new it(0,0,0),Qw=new it(1,1,1),ha=new it,Ju=new it,Ds=new it,ov=new Gi,av=new ws;class Xr{constructor(t=0,r=0,o=0,c=Xr.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=r,this._z=o,this._order=c}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,r,o,c=this._order){return this._x=t,this._y=r,this._z=o,this._order=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,r=this._order,o=!0){const c=t.elements,A=c[0],B=c[4],m=c[8],M=c[1],h=c[5],f=c[9],C=c[2],p=c[6],g=c[10];switch(r){case"XYZ":this._y=Math.asin(Kr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-f,g),this._z=Math.atan2(-B,A)):(this._x=Math.atan2(p,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Kr(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(m,g),this._z=Math.atan2(M,h)):(this._y=Math.atan2(-C,A),this._z=0);break;case"ZXY":this._x=Math.asin(Kr(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-C,g),this._z=Math.atan2(-B,h)):(this._y=0,this._z=Math.atan2(M,A));break;case"ZYX":this._y=Math.asin(-Kr(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(p,g),this._z=Math.atan2(M,A)):(this._x=0,this._z=Math.atan2(-B,h));break;case"YZX":this._z=Math.asin(Kr(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-C,A)):(this._x=0,this._y=Math.atan2(m,g));break;case"XZY":this._z=Math.asin(-Kr(B,-1,1)),Math.abs(B)<.9999999?(this._x=Math.atan2(p,h),this._y=Math.atan2(m,A)):(this._x=Math.atan2(-f,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,o===!0&&this._onChangeCallback(),this}setFromQuaternion(t,r,o){return ov.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ov,r,o)}setFromVector3(t,r=this._order){return this.set(t.x,t.y,t.z,r)}reorder(t){return av.setFromEuler(this),this.setFromQuaternion(av,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Xr.DEFAULT_ORDER="XYZ";class Hw{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let jw=0;const lv=new it,zl=new ws,No=new Gi,Zu=new it,Xc=new it,Ww=new it,Kw=new ws,cv=new it(1,0,0),hv=new it(0,1,0),uv=new it(0,0,1),dv={type:"added"},Xw={type:"removed"},Ql={type:"childadded",child:null},Zp={type:"childremoved",child:null};class Ar extends Sd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:jw++}),this.uuid=ma(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ar.DEFAULT_UP.clone();const t=new it,r=new Xr,o=new ws,c=new it(1,1,1);function A(){o.setFromEuler(r,!1)}function B(){r.setFromQuaternion(o,void 0,!1)}r._onChange(A),o._onChange(B),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:c},modelViewMatrix:{value:new Gi},normalMatrix:{value:new mo}}),this.matrix=new Gi,this.matrixWorld=new Gi,this.matrixAutoUpdate=Ar.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ar.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Hw,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,r){this.quaternion.setFromAxisAngle(t,r)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,r){return zl.setFromAxisAngle(t,r),this.quaternion.multiply(zl),this}rotateOnWorldAxis(t,r){return zl.setFromAxisAngle(t,r),this.quaternion.premultiply(zl),this}rotateX(t){return this.rotateOnAxis(cv,t)}rotateY(t){return this.rotateOnAxis(hv,t)}rotateZ(t){return this.rotateOnAxis(uv,t)}translateOnAxis(t,r){return lv.copy(t).applyQuaternion(this.quaternion),this.position.add(lv.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(cv,t)}translateY(t){return this.translateOnAxis(hv,t)}translateZ(t){return this.translateOnAxis(uv,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(No.copy(this.matrixWorld).invert())}lookAt(t,r,o){t.isVector3?Zu.copy(t):Zu.set(t,r,o);const c=this.parent;this.updateWorldMatrix(!0,!1),Xc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?No.lookAt(Xc,Zu,this.up):No.lookAt(Zu,Xc,this.up),this.quaternion.setFromRotationMatrix(No),c&&(No.extractRotation(c.matrixWorld),zl.setFromRotationMatrix(No),this.quaternion.premultiply(zl.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(dv),Ql.child=t,this.dispatchEvent(Ql),Ql.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const r=this.children.indexOf(t);return r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(Xw),Zp.child=t,this.dispatchEvent(Zp),Zp.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),No.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),No.multiply(t.parent.matrixWorld)),t.applyMatrix4(No),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(dv),Ql.child=t,this.dispatchEvent(Ql),Ql.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let o=0,c=this.children.length;o<c;o++){const B=this.children[o].getObjectByProperty(t,r);if(B!==void 0)return B}}getObjectsByProperty(t,r,o=[]){this[t]===r&&o.push(this);const c=this.children;for(let A=0,B=c.length;A<B;A++)c[A].getObjectsByProperty(t,r,o);return o}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Xc,t,Ww),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Xc,Kw,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(t){t(this);const r=this.children;for(let o=0,c=r.length;o<c;o++)r[o].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const r=this.children;for(let o=0,c=r.length;o<c;o++)r[o].traverseVisible(t)}traverseAncestors(t){const r=this.parent;r!==null&&(t(r),r.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const r=this.children;for(let o=0,c=r.length;o<c;o++){const A=r[o];(A.matrixWorldAutoUpdate===!0||t===!0)&&A.updateMatrixWorld(t)}}updateWorldMatrix(t,r){const o=this.parent;if(t===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),r===!0){const c=this.children;for(let A=0,B=c.length;A<B;A++){const m=c[A];m.matrixWorldAutoUpdate===!0&&m.updateWorldMatrix(!1,!0)}}}toJSON(t){const r=t===void 0||typeof t=="string",o={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const c={};c.uuid=this.uuid,c.type=this.type,this.name!==""&&(c.name=this.name),this.castShadow===!0&&(c.castShadow=!0),this.receiveShadow===!0&&(c.receiveShadow=!0),this.visible===!1&&(c.visible=!1),this.frustumCulled===!1&&(c.frustumCulled=!1),this.renderOrder!==0&&(c.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(c.userData=this.userData),c.layers=this.layers.mask,c.matrix=this.matrix.toArray(),c.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(c.matrixAutoUpdate=!1),this.isInstancedMesh&&(c.type="InstancedMesh",c.count=this.count,c.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(c.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(c.type="BatchedMesh",c.perObjectFrustumCulled=this.perObjectFrustumCulled,c.sortObjects=this.sortObjects,c.drawRanges=this._drawRanges,c.reservedRanges=this._reservedRanges,c.visibility=this._visibility,c.active=this._active,c.bounds=this._bounds.map(m=>({boxInitialized:m.boxInitialized,boxMin:m.box.min.toArray(),boxMax:m.box.max.toArray(),sphereInitialized:m.sphereInitialized,sphereRadius:m.sphere.radius,sphereCenter:m.sphere.center.toArray()})),c.maxGeometryCount=this._maxGeometryCount,c.maxVertexCount=this._maxVertexCount,c.maxIndexCount=this._maxIndexCount,c.geometryInitialized=this._geometryInitialized,c.geometryCount=this._geometryCount,c.matricesTexture=this._matricesTexture.toJSON(t),this.boundingSphere!==null&&(c.boundingSphere={center:c.boundingSphere.center.toArray(),radius:c.boundingSphere.radius}),this.boundingBox!==null&&(c.boundingBox={min:c.boundingBox.min.toArray(),max:c.boundingBox.max.toArray()}));function A(m,M){return m[M.uuid]===void 0&&(m[M.uuid]=M.toJSON(t)),M.uuid}if(this.isScene)this.background&&(this.background.isColor?c.background=this.background.toJSON():this.background.isTexture&&(c.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(c.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){c.geometry=A(t.geometries,this.geometry);const m=this.geometry.parameters;if(m!==void 0&&m.shapes!==void 0){const M=m.shapes;if(Array.isArray(M))for(let h=0,f=M.length;h<f;h++){const C=M[h];A(t.shapes,C)}else A(t.shapes,M)}}if(this.isSkinnedMesh&&(c.bindMode=this.bindMode,c.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(A(t.skeletons,this.skeleton),c.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const m=[];for(let M=0,h=this.material.length;M<h;M++)m.push(A(t.materials,this.material[M]));c.material=m}else c.material=A(t.materials,this.material);if(this.children.length>0){c.children=[];for(let m=0;m<this.children.length;m++)c.children.push(this.children[m].toJSON(t).object)}if(this.animations.length>0){c.animations=[];for(let m=0;m<this.animations.length;m++){const M=this.animations[m];c.animations.push(A(t.animations,M))}}if(r){const m=B(t.geometries),M=B(t.materials),h=B(t.textures),f=B(t.images),C=B(t.shapes),p=B(t.skeletons),g=B(t.animations),u=B(t.nodes);m.length>0&&(o.geometries=m),M.length>0&&(o.materials=M),h.length>0&&(o.textures=h),f.length>0&&(o.images=f),C.length>0&&(o.shapes=C),p.length>0&&(o.skeletons=p),g.length>0&&(o.animations=g),u.length>0&&(o.nodes=u)}return o.object=c,o;function B(m){const M=[];for(const h in m){const f=m[h];delete f.metadata,M.push(f)}return M}}clone(t){return new this.constructor().copy(this,t)}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),r===!0)for(let o=0;o<t.children.length;o++){const c=t.children[o];this.add(c.clone())}return this}}Ar.DEFAULT_UP=new it(0,1,0);Ar.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ar.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const to=new it,ko=new it,$p=new it,Uo=new it,Hl=new it,jl=new it,fv=new it,eA=new it,tA=new it,iA=new it;class ro{constructor(t=new it,r=new it,o=new it){this.a=t,this.b=r,this.c=o}static getNormal(t,r,o,c){c.subVectors(o,r),to.subVectors(t,r),c.cross(to);const A=c.lengthSq();return A>0?c.multiplyScalar(1/Math.sqrt(A)):c.set(0,0,0)}static getBarycoord(t,r,o,c,A){to.subVectors(c,r),ko.subVectors(o,r),$p.subVectors(t,r);const B=to.dot(to),m=to.dot(ko),M=to.dot($p),h=ko.dot(ko),f=ko.dot($p),C=B*h-m*m;if(C===0)return A.set(0,0,0),null;const p=1/C,g=(h*M-m*f)*p,u=(B*f-m*M)*p;return A.set(1-g-u,u,g)}static containsPoint(t,r,o,c){return this.getBarycoord(t,r,o,c,Uo)===null?!1:Uo.x>=0&&Uo.y>=0&&Uo.x+Uo.y<=1}static getInterpolation(t,r,o,c,A,B,m,M){return this.getBarycoord(t,r,o,c,Uo)===null?(M.x=0,M.y=0,"z"in M&&(M.z=0),"w"in M&&(M.w=0),null):(M.setScalar(0),M.addScaledVector(A,Uo.x),M.addScaledVector(B,Uo.y),M.addScaledVector(m,Uo.z),M)}static isFrontFacing(t,r,o,c){return to.subVectors(o,r),ko.subVectors(t,r),to.cross(ko).dot(c)<0}set(t,r,o){return this.a.copy(t),this.b.copy(r),this.c.copy(o),this}setFromPointsAndIndices(t,r,o,c){return this.a.copy(t[r]),this.b.copy(t[o]),this.c.copy(t[c]),this}setFromAttributeAndIndices(t,r,o,c){return this.a.fromBufferAttribute(t,r),this.b.fromBufferAttribute(t,o),this.c.fromBufferAttribute(t,c),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return to.subVectors(this.c,this.b),ko.subVectors(this.a,this.b),to.cross(ko).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ro.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,r){return ro.getBarycoord(t,this.a,this.b,this.c,r)}getInterpolation(t,r,o,c,A){return ro.getInterpolation(t,this.a,this.b,this.c,r,o,c,A)}containsPoint(t){return ro.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ro.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,r){const o=this.a,c=this.b,A=this.c;let B,m;Hl.subVectors(c,o),jl.subVectors(A,o),eA.subVectors(t,o);const M=Hl.dot(eA),h=jl.dot(eA);if(M<=0&&h<=0)return r.copy(o);tA.subVectors(t,c);const f=Hl.dot(tA),C=jl.dot(tA);if(f>=0&&C<=f)return r.copy(c);const p=M*C-f*h;if(p<=0&&M>=0&&f<=0)return B=M/(M-f),r.copy(o).addScaledVector(Hl,B);iA.subVectors(t,A);const g=Hl.dot(iA),u=jl.dot(iA);if(u>=0&&g<=u)return r.copy(A);const E=g*h-M*u;if(E<=0&&h>=0&&u<=0)return m=h/(h-u),r.copy(o).addScaledVector(jl,m);const b=f*u-g*C;if(b<=0&&C-f>=0&&g-u>=0)return fv.subVectors(A,c),m=(C-f)/(C-f+(g-u)),r.copy(c).addScaledVector(fv,m);const x=1/(b+E+p);return B=E*x,m=p*x,r.copy(o).addScaledVector(Hl,B).addScaledVector(jl,m)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const Yv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ua={h:0,s:0,l:0},$u={h:0,s:0,l:0};function nA(y,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?y+(t-y)*6*r:r<1/2?t:r<2/3?y+(t-y)*6*(2/3-r):y}class Sr{constructor(t,r,o){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,r,o)}set(t,r,o){if(r===void 0&&o===void 0){const c=t;c&&c.isColor?this.copy(c):typeof c=="number"?this.setHex(c):typeof c=="string"&&this.setStyle(c)}else this.setRGB(t,r,o);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,r=zs){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Zs.toWorkingColorSpace(this,r),this}setRGB(t,r,o,c=Zs.workingColorSpace){return this.r=t,this.g=r,this.b=o,Zs.toWorkingColorSpace(this,c),this}setHSL(t,r,o,c=Zs.workingColorSpace){if(t=LA(t,1),r=Kr(r,0,1),o=Kr(o,0,1),r===0)this.r=this.g=this.b=o;else{const A=o<=.5?o*(1+r):o+r-o*r,B=2*o-A;this.r=nA(B,A,t+1/3),this.g=nA(B,A,t),this.b=nA(B,A,t-1/3)}return Zs.toWorkingColorSpace(this,c),this}setStyle(t,r=zs){function o(A){A!==void 0&&parseFloat(A)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let c;if(c=/^(\w+)\(([^\)]*)\)/.exec(t)){let A;const B=c[1],m=c[2];switch(B){case"rgb":case"rgba":if(A=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return o(A[4]),this.setRGB(Math.min(255,parseInt(A[1],10))/255,Math.min(255,parseInt(A[2],10))/255,Math.min(255,parseInt(A[3],10))/255,r);if(A=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return o(A[4]),this.setRGB(Math.min(100,parseInt(A[1],10))/100,Math.min(100,parseInt(A[2],10))/100,Math.min(100,parseInt(A[3],10))/100,r);break;case"hsl":case"hsla":if(A=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return o(A[4]),this.setHSL(parseFloat(A[1])/360,parseFloat(A[2])/100,parseFloat(A[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(c=/^\#([A-Fa-f\d]+)$/.exec(t)){const A=c[1],B=A.length;if(B===3)return this.setRGB(parseInt(A.charAt(0),16)/15,parseInt(A.charAt(1),16)/15,parseInt(A.charAt(2),16)/15,r);if(B===6)return this.setHex(parseInt(A,16),r);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,r);return this}setColorName(t,r=zs){const o=Yv[t.toLowerCase()];return o!==void 0?this.setHex(o,r):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=nc(t.r),this.g=nc(t.g),this.b=nc(t.b),this}copyLinearToSRGB(t){return this.r=Hp(t.r),this.g=Hp(t.g),this.b=Hp(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=zs){return Zs.fromWorkingColorSpace(ns.copy(this),t),Math.round(Kr(ns.r*255,0,255))*65536+Math.round(Kr(ns.g*255,0,255))*256+Math.round(Kr(ns.b*255,0,255))}getHexString(t=zs){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,r=Zs.workingColorSpace){Zs.fromWorkingColorSpace(ns.copy(this),r);const o=ns.r,c=ns.g,A=ns.b,B=Math.max(o,c,A),m=Math.min(o,c,A);let M,h;const f=(m+B)/2;if(m===B)M=0,h=0;else{const C=B-m;switch(h=f<=.5?C/(B+m):C/(2-B-m),B){case o:M=(c-A)/C+(c<A?6:0);break;case c:M=(A-o)/C+2;break;case A:M=(o-c)/C+4;break}M/=6}return t.h=M,t.s=h,t.l=f,t}getRGB(t,r=Zs.workingColorSpace){return Zs.fromWorkingColorSpace(ns.copy(this),r),t.r=ns.r,t.g=ns.g,t.b=ns.b,t}getStyle(t=zs){Zs.fromWorkingColorSpace(ns.copy(this),t);const r=ns.r,o=ns.g,c=ns.b;return t!==zs?`color(${t} ${r.toFixed(3)} ${o.toFixed(3)} ${c.toFixed(3)})`:`rgb(${Math.round(r*255)},${Math.round(o*255)},${Math.round(c*255)})`}offsetHSL(t,r,o){return this.getHSL(ua),this.setHSL(ua.h+t,ua.s+r,ua.l+o)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this}lerpColors(t,r,o){return this.r=t.r+(r.r-t.r)*o,this.g=t.g+(r.g-t.g)*o,this.b=t.b+(r.b-t.b)*o,this}lerpHSL(t,r){this.getHSL(ua),t.getHSL($u);const o=ih(ua.h,$u.h,r),c=ih(ua.s,$u.s,r),A=ih(ua.l,$u.l,r);return this.setHSL(o,c,A),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const r=this.r,o=this.g,c=this.b,A=t.elements;return this.r=A[0]*r+A[3]*o+A[6]*c,this.g=A[1]*r+A[4]*o+A[7]*c,this.b=A[2]*r+A[5]*o+A[8]*c,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,r=0){return this.r=t[r],this.g=t[r+1],this.b=t[r+2],this}toArray(t=[],r=0){return t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t}fromBufferAttribute(t,r){return this.r=t.getX(r),this.g=t.getY(r),this.b=t.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ns=new Sr;Sr.NAMES=Yv;let Yw=0;class Td extends Sd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Yw++}),this.uuid=ma(),this.name="",this.type="Material",this.blending=U0,this.side=EA,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=V0,this.blendDst=z0,this.blendEquation=G0,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Sr(0,0,0),this.blendAlpha=0,this.depthFunc=Q0,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=$0,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Fl,this.stencilZFail=Fl,this.stencilZPass=Fl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const r in t){const o=t[r];if(o===void 0){console.warn(`THREE.Material: parameter '${r}' has value of undefined.`);continue}const c=this[r];if(c===void 0){console.warn(`THREE.Material: '${r}' is not a property of THREE.${this.type}.`);continue}c&&c.isColor?c.set(o):c&&c.isVector3&&o&&o.isVector3?c.copy(o):this[r]=o}}toJSON(t){const r=t===void 0||typeof t=="string";r&&(t={textures:{},images:{}});const o={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),this.roughness!==void 0&&(o.roughness=this.roughness),this.metalness!==void 0&&(o.metalness=this.metalness),this.sheen!==void 0&&(o.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(o.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(o.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(o.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(o.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(o.shininess=this.shininess),this.clearcoat!==void 0&&(o.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(o.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(o.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(o.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,o.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(o.dispersion=this.dispersion),this.iridescence!==void 0&&(o.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(o.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(o.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(o.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(o.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(o.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(o.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(o.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(t).uuid,o.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(t).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(t).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(t).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(t).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(o.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(o.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(o.combine=this.combine)),this.envMapRotation!==void 0&&(o.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(o.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(o.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(o.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(o.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(o.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(o.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(o.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(o.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(o.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(o.size=this.size),this.shadowSide!==null&&(o.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==U0&&(o.blending=this.blending),this.side!==EA&&(o.side=this.side),this.vertexColors===!0&&(o.vertexColors=!0),this.opacity<1&&(o.opacity=this.opacity),this.transparent===!0&&(o.transparent=!0),this.blendSrc!==V0&&(o.blendSrc=this.blendSrc),this.blendDst!==z0&&(o.blendDst=this.blendDst),this.blendEquation!==G0&&(o.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(o.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(o.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(o.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(o.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(o.blendAlpha=this.blendAlpha),this.depthFunc!==Q0&&(o.depthFunc=this.depthFunc),this.depthTest===!1&&(o.depthTest=this.depthTest),this.depthWrite===!1&&(o.depthWrite=this.depthWrite),this.colorWrite===!1&&(o.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(o.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==$0&&(o.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(o.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(o.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Fl&&(o.stencilFail=this.stencilFail),this.stencilZFail!==Fl&&(o.stencilZFail=this.stencilZFail),this.stencilZPass!==Fl&&(o.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(o.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(o.rotation=this.rotation),this.polygonOffset===!0&&(o.polygonOffset=!0),this.polygonOffsetFactor!==0&&(o.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(o.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(o.linewidth=this.linewidth),this.dashSize!==void 0&&(o.dashSize=this.dashSize),this.gapSize!==void 0&&(o.gapSize=this.gapSize),this.scale!==void 0&&(o.scale=this.scale),this.dithering===!0&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),this.alphaHash===!0&&(o.alphaHash=!0),this.alphaToCoverage===!0&&(o.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(o.premultipliedAlpha=!0),this.forceSinglePass===!0&&(o.forceSinglePass=!0),this.wireframe===!0&&(o.wireframe=!0),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(o.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(o.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(o.flatShading=!0),this.visible===!1&&(o.visible=!1),this.toneMapped===!1&&(o.toneMapped=!1),this.fog===!1&&(o.fog=!1),Object.keys(this.userData).length>0&&(o.userData=this.userData);function c(A){const B=[];for(const m in A){const M=A[m];delete M.metadata,B.push(M)}return B}if(r){const A=c(t.textures),B=c(t.images);A.length>0&&(o.textures=A),B.length>0&&(o.images=B)}return o}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const r=t.clippingPlanes;let o=null;if(r!==null){const c=r.length;o=new Array(c);for(let A=0;A!==c;++A)o[A]=r[A].clone()}return this.clippingPlanes=o,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}class Zl extends Td{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Sr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xr,this.combine=BA,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const _r=new it,ed=new pr;class Aa{constructor(t,r,o=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=r,this.count=t!==void 0?t.length/r:0,this.normalized=o,this.usage=ev,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Hv,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}get updateRange(){return Ow("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,r){this.updateRanges.push({start:t,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,r,o){t*=this.itemSize,o*=r.itemSize;for(let c=0,A=this.itemSize;c<A;c++)this.array[t+c]=r.array[o+c];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let r=0,o=this.count;r<o;r++)ed.fromBufferAttribute(this,r),ed.applyMatrix3(t),this.setXY(r,ed.x,ed.y);else if(this.itemSize===3)for(let r=0,o=this.count;r<o;r++)_r.fromBufferAttribute(this,r),_r.applyMatrix3(t),this.setXYZ(r,_r.x,_r.y,_r.z);return this}applyMatrix4(t){for(let r=0,o=this.count;r<o;r++)_r.fromBufferAttribute(this,r),_r.applyMatrix4(t),this.setXYZ(r,_r.x,_r.y,_r.z);return this}applyNormalMatrix(t){for(let r=0,o=this.count;r<o;r++)_r.fromBufferAttribute(this,r),_r.applyNormalMatrix(t),this.setXYZ(r,_r.x,_r.y,_r.z);return this}transformDirection(t){for(let r=0,o=this.count;r<o;r++)_r.fromBufferAttribute(this,r),_r.transformDirection(t),this.setXYZ(r,_r.x,_r.y,_r.z);return this}set(t,r=0){return this.array.set(t,r),this}getComponent(t,r){let o=this.array[t*this.itemSize+r];return this.normalized&&(o=Jl(o,this.array)),o}setComponent(t,r,o){return this.normalized&&(o=fs(o,this.array)),this.array[t*this.itemSize+r]=o,this}getX(t){let r=this.array[t*this.itemSize];return this.normalized&&(r=Jl(r,this.array)),r}setX(t,r){return this.normalized&&(r=fs(r,this.array)),this.array[t*this.itemSize]=r,this}getY(t){let r=this.array[t*this.itemSize+1];return this.normalized&&(r=Jl(r,this.array)),r}setY(t,r){return this.normalized&&(r=fs(r,this.array)),this.array[t*this.itemSize+1]=r,this}getZ(t){let r=this.array[t*this.itemSize+2];return this.normalized&&(r=Jl(r,this.array)),r}setZ(t,r){return this.normalized&&(r=fs(r,this.array)),this.array[t*this.itemSize+2]=r,this}getW(t){let r=this.array[t*this.itemSize+3];return this.normalized&&(r=Jl(r,this.array)),r}setW(t,r){return this.normalized&&(r=fs(r,this.array)),this.array[t*this.itemSize+3]=r,this}setXY(t,r,o){return t*=this.itemSize,this.normalized&&(r=fs(r,this.array),o=fs(o,this.array)),this.array[t+0]=r,this.array[t+1]=o,this}setXYZ(t,r,o,c){return t*=this.itemSize,this.normalized&&(r=fs(r,this.array),o=fs(o,this.array),c=fs(c,this.array)),this.array[t+0]=r,this.array[t+1]=o,this.array[t+2]=c,this}setXYZW(t,r,o,c,A){return t*=this.itemSize,this.normalized&&(r=fs(r,this.array),o=fs(o,this.array),c=fs(c,this.array),A=fs(A,this.array)),this.array[t+0]=r,this.array[t+1]=o,this.array[t+2]=c,this.array[t+3]=A,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==ev&&(t.usage=this.usage),t}}class qv extends Aa{constructor(t,r,o){super(new Uint16Array(t),r,o)}}class qw extends Aa{constructor(t,r,o){super(new Uint32Array(t),r,o)}}class Ms extends Aa{constructor(t,r,o){super(new Float32Array(t),r,o)}}let Jw=0;const Vs=new Gi,rA=new Ar,Wl=new it,Ps=new rc,Yc=new rc,Vr=new it;class so extends Sd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Jw++}),this.uuid=ma(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Pw(t)?qw:qv)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,r){return this.attributes[t]=r,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,r,o=0){this.groups.push({start:t,count:r,materialIndex:o})}clearGroups(){this.groups=[]}setDrawRange(t,r){this.drawRange.start=t,this.drawRange.count=r}applyMatrix4(t){const r=this.attributes.position;r!==void 0&&(r.applyMatrix4(t),r.needsUpdate=!0);const o=this.attributes.normal;if(o!==void 0){const A=new mo().getNormalMatrix(t);o.applyNormalMatrix(A),o.needsUpdate=!0}const c=this.attributes.tangent;return c!==void 0&&(c.transformDirection(t),c.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Vs.makeRotationFromQuaternion(t),this.applyMatrix4(Vs),this}rotateX(t){return Vs.makeRotationX(t),this.applyMatrix4(Vs),this}rotateY(t){return Vs.makeRotationY(t),this.applyMatrix4(Vs),this}rotateZ(t){return Vs.makeRotationZ(t),this.applyMatrix4(Vs),this}translate(t,r,o){return Vs.makeTranslation(t,r,o),this.applyMatrix4(Vs),this}scale(t,r,o){return Vs.makeScale(t,r,o),this.applyMatrix4(Vs),this}lookAt(t){return rA.lookAt(t),rA.updateMatrix(),this.applyMatrix4(rA.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wl).negate(),this.translate(Wl.x,Wl.y,Wl.z),this}setFromPoints(t){const r=[];for(let o=0,c=t.length;o<c;o++){const A=t[o];r.push(A.x,A.y,A.z||0)}return this.setAttribute("position",new Ms(r,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new rc);const t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new it(-1/0,-1/0,-1/0),new it(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),r)for(let o=0,c=r.length;o<c;o++){const A=r[o];Ps.setFromBufferAttribute(A),this.morphTargetsRelative?(Vr.addVectors(this.boundingBox.min,Ps.min),this.boundingBox.expandByPoint(Vr),Vr.addVectors(this.boundingBox.max,Ps.max),this.boundingBox.expandByPoint(Vr)):(this.boundingBox.expandByPoint(Ps.min),this.boundingBox.expandByPoint(Ps.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sc);const t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new it,1/0);return}if(t){const o=this.boundingSphere.center;if(Ps.setFromBufferAttribute(t),r)for(let A=0,B=r.length;A<B;A++){const m=r[A];Yc.setFromBufferAttribute(m),this.morphTargetsRelative?(Vr.addVectors(Ps.min,Yc.min),Ps.expandByPoint(Vr),Vr.addVectors(Ps.max,Yc.max),Ps.expandByPoint(Vr)):(Ps.expandByPoint(Yc.min),Ps.expandByPoint(Yc.max))}Ps.getCenter(o);let c=0;for(let A=0,B=t.count;A<B;A++)Vr.fromBufferAttribute(t,A),c=Math.max(c,o.distanceToSquared(Vr));if(r)for(let A=0,B=r.length;A<B;A++){const m=r[A],M=this.morphTargetsRelative;for(let h=0,f=m.count;h<f;h++)Vr.fromBufferAttribute(m,h),M&&(Wl.fromBufferAttribute(t,h),Vr.add(Wl)),c=Math.max(c,o.distanceToSquared(Vr))}this.boundingSphere.radius=Math.sqrt(c),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,r=this.attributes;if(t===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const o=r.position,c=r.normal,A=r.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Aa(new Float32Array(4*o.count),4));const B=this.getAttribute("tangent"),m=[],M=[];for(let D=0;D<o.count;D++)m[D]=new it,M[D]=new it;const h=new it,f=new it,C=new it,p=new pr,g=new pr,u=new pr,E=new it,b=new it;function x(D,U,F){h.fromBufferAttribute(o,D),f.fromBufferAttribute(o,U),C.fromBufferAttribute(o,F),p.fromBufferAttribute(A,D),g.fromBufferAttribute(A,U),u.fromBufferAttribute(A,F),f.sub(h),C.sub(h),g.sub(p),u.sub(p);const j=1/(g.x*u.y-u.x*g.y);isFinite(j)&&(E.copy(f).multiplyScalar(u.y).addScaledVector(C,-g.y).multiplyScalar(j),b.copy(C).multiplyScalar(g.x).addScaledVector(f,-u.x).multiplyScalar(j),m[D].add(E),m[U].add(E),m[F].add(E),M[D].add(b),M[U].add(b),M[F].add(b))}let T=this.groups;T.length===0&&(T=[{start:0,count:t.count}]);for(let D=0,U=T.length;D<U;++D){const F=T[D],j=F.start,Y=F.count;for(let oe=j,te=j+Y;oe<te;oe+=3)x(t.getX(oe+0),t.getX(oe+1),t.getX(oe+2))}const _=new it,w=new it,S=new it,L=new it;function P(D){S.fromBufferAttribute(c,D),L.copy(S);const U=m[D];_.copy(U),_.sub(S.multiplyScalar(S.dot(U))).normalize(),w.crossVectors(L,U);const j=w.dot(M[D])<0?-1:1;B.setXYZW(D,_.x,_.y,_.z,j)}for(let D=0,U=T.length;D<U;++D){const F=T[D],j=F.start,Y=F.count;for(let oe=j,te=j+Y;oe<te;oe+=3)P(t.getX(oe+0)),P(t.getX(oe+1)),P(t.getX(oe+2))}}computeVertexNormals(){const t=this.index,r=this.getAttribute("position");if(r!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new Aa(new Float32Array(r.count*3),3),this.setAttribute("normal",o);else for(let p=0,g=o.count;p<g;p++)o.setXYZ(p,0,0,0);const c=new it,A=new it,B=new it,m=new it,M=new it,h=new it,f=new it,C=new it;if(t)for(let p=0,g=t.count;p<g;p+=3){const u=t.getX(p+0),E=t.getX(p+1),b=t.getX(p+2);c.fromBufferAttribute(r,u),A.fromBufferAttribute(r,E),B.fromBufferAttribute(r,b),f.subVectors(B,A),C.subVectors(c,A),f.cross(C),m.fromBufferAttribute(o,u),M.fromBufferAttribute(o,E),h.fromBufferAttribute(o,b),m.add(f),M.add(f),h.add(f),o.setXYZ(u,m.x,m.y,m.z),o.setXYZ(E,M.x,M.y,M.z),o.setXYZ(b,h.x,h.y,h.z)}else for(let p=0,g=r.count;p<g;p+=3)c.fromBufferAttribute(r,p+0),A.fromBufferAttribute(r,p+1),B.fromBufferAttribute(r,p+2),f.subVectors(B,A),C.subVectors(c,A),f.cross(C),o.setXYZ(p+0,f.x,f.y,f.z),o.setXYZ(p+1,f.x,f.y,f.z),o.setXYZ(p+2,f.x,f.y,f.z);this.normalizeNormals(),o.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let r=0,o=t.count;r<o;r++)Vr.fromBufferAttribute(t,r),Vr.normalize(),t.setXYZ(r,Vr.x,Vr.y,Vr.z)}toNonIndexed(){function t(m,M){const h=m.array,f=m.itemSize,C=m.normalized,p=new h.constructor(M.length*f);let g=0,u=0;for(let E=0,b=M.length;E<b;E++){m.isInterleavedBufferAttribute?g=M[E]*m.data.stride+m.offset:g=M[E]*f;for(let x=0;x<f;x++)p[u++]=h[g++]}return new Aa(p,f,C)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const r=new so,o=this.index.array,c=this.attributes;for(const m in c){const M=c[m],h=t(M,o);r.setAttribute(m,h)}const A=this.morphAttributes;for(const m in A){const M=[],h=A[m];for(let f=0,C=h.length;f<C;f++){const p=h[f],g=t(p,o);M.push(g)}r.morphAttributes[m]=M}r.morphTargetsRelative=this.morphTargetsRelative;const B=this.groups;for(let m=0,M=B.length;m<M;m++){const h=B[m];r.addGroup(h.start,h.count,h.materialIndex)}return r}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const M=this.parameters;for(const h in M)M[h]!==void 0&&(t[h]=M[h]);return t}t.data={attributes:{}};const r=this.index;r!==null&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});const o=this.attributes;for(const M in o){const h=o[M];t.data.attributes[M]=h.toJSON(t.data)}const c={};let A=!1;for(const M in this.morphAttributes){const h=this.morphAttributes[M],f=[];for(let C=0,p=h.length;C<p;C++){const g=h[C];f.push(g.toJSON(t.data))}f.length>0&&(c[M]=f,A=!0)}A&&(t.data.morphAttributes=c,t.data.morphTargetsRelative=this.morphTargetsRelative);const B=this.groups;B.length>0&&(t.data.groups=JSON.parse(JSON.stringify(B)));const m=this.boundingSphere;return m!==null&&(t.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const r={};this.name=t.name;const o=t.index;o!==null&&this.setIndex(o.clone(r));const c=t.attributes;for(const h in c){const f=c[h];this.setAttribute(h,f.clone(r))}const A=t.morphAttributes;for(const h in A){const f=[],C=A[h];for(let p=0,g=C.length;p<g;p++)f.push(C[p].clone(r));this.morphAttributes[h]=f}this.morphTargetsRelative=t.morphTargetsRelative;const B=t.groups;for(let h=0,f=B.length;h<f;h++){const C=B[h];this.addGroup(C.start,C.count,C.materialIndex)}const m=t.boundingBox;m!==null&&(this.boundingBox=m.clone());const M=t.boundingSphere;return M!==null&&(this.boundingSphere=M.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const pv=new Gi,Xa=new DA,td=new sc,Av=new it,Kl=new it,Xl=new it,Yl=new it,sA=new it,id=new it,nd=new pr,rd=new pr,sd=new pr,mv=new it,gv=new it,vv=new it,od=new it,ad=new it;class qa extends Ar{constructor(t=new so,r=new Zl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=r,this.updateMorphTargets()}copy(t,r){return super.copy(t,r),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const r=this.geometry.morphAttributes,o=Object.keys(r);if(o.length>0){const c=r[o[0]];if(c!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let A=0,B=c.length;A<B;A++){const m=c[A].name||String(A);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=A}}}}getVertexPosition(t,r){const o=this.geometry,c=o.attributes.position,A=o.morphAttributes.position,B=o.morphTargetsRelative;r.fromBufferAttribute(c,t);const m=this.morphTargetInfluences;if(A&&m){id.set(0,0,0);for(let M=0,h=A.length;M<h;M++){const f=m[M],C=A[M];f!==0&&(sA.fromBufferAttribute(C,t),B?id.addScaledVector(sA,f):id.addScaledVector(sA.sub(r),f))}r.add(id)}return r}raycast(t,r){const o=this.geometry,c=this.material,A=this.matrixWorld;c!==void 0&&(o.boundingSphere===null&&o.computeBoundingSphere(),td.copy(o.boundingSphere),td.applyMatrix4(A),Xa.copy(t.ray).recast(t.near),!(td.containsPoint(Xa.origin)===!1&&(Xa.intersectSphere(td,Av)===null||Xa.origin.distanceToSquared(Av)>(t.far-t.near)**2))&&(pv.copy(A).invert(),Xa.copy(t.ray).applyMatrix4(pv),!(o.boundingBox!==null&&Xa.intersectsBox(o.boundingBox)===!1)&&this._computeIntersections(t,r,Xa)))}_computeIntersections(t,r,o){let c;const A=this.geometry,B=this.material,m=A.index,M=A.attributes.position,h=A.attributes.uv,f=A.attributes.uv1,C=A.attributes.normal,p=A.groups,g=A.drawRange;if(m!==null)if(Array.isArray(B))for(let u=0,E=p.length;u<E;u++){const b=p[u],x=B[b.materialIndex],T=Math.max(b.start,g.start),_=Math.min(m.count,Math.min(b.start+b.count,g.start+g.count));for(let w=T,S=_;w<S;w+=3){const L=m.getX(w),P=m.getX(w+1),D=m.getX(w+2);c=ld(this,x,t,o,h,f,C,L,P,D),c&&(c.faceIndex=Math.floor(w/3),c.face.materialIndex=b.materialIndex,r.push(c))}}else{const u=Math.max(0,g.start),E=Math.min(m.count,g.start+g.count);for(let b=u,x=E;b<x;b+=3){const T=m.getX(b),_=m.getX(b+1),w=m.getX(b+2);c=ld(this,B,t,o,h,f,C,T,_,w),c&&(c.faceIndex=Math.floor(b/3),r.push(c))}}else if(M!==void 0)if(Array.isArray(B))for(let u=0,E=p.length;u<E;u++){const b=p[u],x=B[b.materialIndex],T=Math.max(b.start,g.start),_=Math.min(M.count,Math.min(b.start+b.count,g.start+g.count));for(let w=T,S=_;w<S;w+=3){const L=w,P=w+1,D=w+2;c=ld(this,x,t,o,h,f,C,L,P,D),c&&(c.faceIndex=Math.floor(w/3),c.face.materialIndex=b.materialIndex,r.push(c))}}else{const u=Math.max(0,g.start),E=Math.min(M.count,g.start+g.count);for(let b=u,x=E;b<x;b+=3){const T=b,_=b+1,w=b+2;c=ld(this,B,t,o,h,f,C,T,_,w),c&&(c.faceIndex=Math.floor(b/3),r.push(c))}}}}function Zw(y,t,r,o,c,A,B,m){let M;if(t.side===aw?M=o.intersectTriangle(B,A,c,!0,m):M=o.intersectTriangle(c,A,B,t.side===EA,m),M===null)return null;ad.copy(m),ad.applyMatrix4(y.matrixWorld);const h=r.ray.origin.distanceTo(ad);return h<r.near||h>r.far?null:{distance:h,point:ad.clone(),object:y}}function ld(y,t,r,o,c,A,B,m,M,h){y.getVertexPosition(m,Kl),y.getVertexPosition(M,Xl),y.getVertexPosition(h,Yl);const f=Zw(y,t,r,o,Kl,Xl,Yl,od);if(f){c&&(nd.fromBufferAttribute(c,m),rd.fromBufferAttribute(c,M),sd.fromBufferAttribute(c,h),f.uv=ro.getInterpolation(od,Kl,Xl,Yl,nd,rd,sd,new pr)),A&&(nd.fromBufferAttribute(A,m),rd.fromBufferAttribute(A,M),sd.fromBufferAttribute(A,h),f.uv1=ro.getInterpolation(od,Kl,Xl,Yl,nd,rd,sd,new pr)),B&&(mv.fromBufferAttribute(B,m),gv.fromBufferAttribute(B,M),vv.fromBufferAttribute(B,h),f.normal=ro.getInterpolation(od,Kl,Xl,Yl,mv,gv,vv,new it),f.normal.dot(o.direction)>0&&f.normal.multiplyScalar(-1));const C={a:m,b:M,c:h,normal:new it,materialIndex:0};ro.getNormal(Kl,Xl,Yl,C.normal),f.face=C}return f}class nh extends so{constructor(t=1,r=1,o=1,c=1,A=1,B=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:r,depth:o,widthSegments:c,heightSegments:A,depthSegments:B};const m=this;c=Math.floor(c),A=Math.floor(A),B=Math.floor(B);const M=[],h=[],f=[],C=[];let p=0,g=0;u("z","y","x",-1,-1,o,r,t,B,A,0),u("z","y","x",1,-1,o,r,-t,B,A,1),u("x","z","y",1,1,t,o,r,c,B,2),u("x","z","y",1,-1,t,o,-r,c,B,3),u("x","y","z",1,-1,t,r,o,c,A,4),u("x","y","z",-1,-1,t,r,-o,c,A,5),this.setIndex(M),this.setAttribute("position",new Ms(h,3)),this.setAttribute("normal",new Ms(f,3)),this.setAttribute("uv",new Ms(C,2));function u(E,b,x,T,_,w,S,L,P,D,U){const F=w/P,j=S/D,Y=w/2,oe=S/2,te=L/2,pe=P+1,de=D+1;let se=0,J=0;const H=new it;for(let ae=0;ae<de;ae++){const ue=ae*j-oe;for(let Me=0;Me<pe;Me++){const De=Me*F-Y;H[E]=De*T,H[b]=ue*_,H[x]=te,h.push(H.x,H.y,H.z),H[E]=0,H[b]=0,H[x]=L>0?1:-1,f.push(H.x,H.y,H.z),C.push(Me/P),C.push(1-ae/D),se+=1}}for(let ae=0;ae<D;ae++)for(let ue=0;ue<P;ue++){const Me=p+ue+pe*ae,De=p+ue+pe*(ae+1),Ge=p+(ue+1)+pe*(ae+1),Xe=p+(ue+1)+pe*ae;M.push(Me,De,Xe),M.push(De,Ge,Xe),J+=6}m.addGroup(g,J,U),g+=J,p+=se}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new nh(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}class Jv extends Ar{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Gi,this.projectionMatrix=new Gi,this.projectionMatrixInverse=new Gi,this.coordinateSystem=Ja}copy(t,r){return super.copy(t,r),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,r){super.updateWorldMatrix(t,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const da=new it,yv=new pr,Ev=new pr;class PA extends Jv{constructor(t=50,r=1,o=.1,c=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=o,this.far=c,this.focus=10,this.aspect=r,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,r){return super.copy(t,r),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const r=.5*this.getFilmHeight()/t;this.fov=oh*2*Math.atan(r),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(th*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return oh*2*Math.atan(Math.tan(th*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,r,o){da.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(da.x,da.y).multiplyScalar(-t/da.z),da.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),o.set(da.x,da.y).multiplyScalar(-t/da.z)}getViewSize(t,r){return this.getViewBounds(t,yv,Ev),r.subVectors(Ev,yv)}setViewOffset(t,r,o,c,A,B){this.aspect=t/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=o,this.view.offsetY=c,this.view.width=A,this.view.height=B,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let r=t*Math.tan(th*.5*this.fov)/this.zoom,o=2*r,c=this.aspect*o,A=-.5*c;const B=this.view;if(this.view!==null&&this.view.enabled){const M=B.fullWidth,h=B.fullHeight;A+=B.offsetX*c/M,r-=B.offsetY*o/h,c*=B.width/M,o*=B.height/h}const m=this.filmOffset;m!==0&&(A+=t*m/this.getFilmWidth()),this.projectionMatrix.makePerspective(A,A+c,r,r-o,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const r=super.toJSON(t);return r.object.fov=this.fov,r.object.zoom=this.zoom,r.object.near=this.near,r.object.far=this.far,r.object.focus=this.focus,r.object.aspect=this.aspect,this.view!==null&&(r.object.view=Object.assign({},this.view)),r.object.filmGauge=this.filmGauge,r.object.filmOffset=this.filmOffset,r}}const oA=new it,$w=new it,eM=new mo;class pa{constructor(t=new it(1,0,0),r=0){this.isPlane=!0,this.normal=t,this.constant=r}set(t,r){return this.normal.copy(t),this.constant=r,this}setComponents(t,r,o,c){return this.normal.set(t,r,o),this.constant=c,this}setFromNormalAndCoplanarPoint(t,r){return this.normal.copy(t),this.constant=-r.dot(this.normal),this}setFromCoplanarPoints(t,r,o){const c=oA.subVectors(o,r).cross($w.subVectors(t,r)).normalize();return this.setFromNormalAndCoplanarPoint(c,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,r){return r.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,r){const o=t.delta(oA),c=this.normal.dot(o);if(c===0)return this.distanceToPoint(t.start)===0?r.copy(t.start):null;const A=-(t.start.dot(this.normal)+this.constant)/c;return A<0||A>1?null:r.copy(t.start).addScaledVector(o,A)}intersectsLine(t){const r=this.distanceToPoint(t.start),o=this.distanceToPoint(t.end);return r<0&&o>0||o<0&&r>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,r){const o=r||eM.getNormalMatrix(t),c=this.coplanarPoint(oA).applyMatrix4(t),A=this.normal.applyMatrix3(o).normalize();return this.constant=-c.dot(A),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Ya=new sc,cd=new it;class tM{constructor(t=new pa,r=new pa,o=new pa,c=new pa,A=new pa,B=new pa){this.planes=[t,r,o,c,A,B]}set(t,r,o,c,A,B){const m=this.planes;return m[0].copy(t),m[1].copy(r),m[2].copy(o),m[3].copy(c),m[4].copy(A),m[5].copy(B),this}copy(t){const r=this.planes;for(let o=0;o<6;o++)r[o].copy(t.planes[o]);return this}setFromProjectionMatrix(t,r=Ja){const o=this.planes,c=t.elements,A=c[0],B=c[1],m=c[2],M=c[3],h=c[4],f=c[5],C=c[6],p=c[7],g=c[8],u=c[9],E=c[10],b=c[11],x=c[12],T=c[13],_=c[14],w=c[15];if(o[0].setComponents(M-A,p-h,b-g,w-x).normalize(),o[1].setComponents(M+A,p+h,b+g,w+x).normalize(),o[2].setComponents(M+B,p+f,b+u,w+T).normalize(),o[3].setComponents(M-B,p-f,b-u,w-T).normalize(),o[4].setComponents(M-m,p-C,b-E,w-_).normalize(),r===Ja)o[5].setComponents(M+m,p+C,b+E,w+_).normalize();else if(r===CA)o[5].setComponents(m,C,E,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+r);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),Ya.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const r=t.geometry;r.boundingSphere===null&&r.computeBoundingSphere(),Ya.copy(r.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Ya)}intersectsSprite(t){return Ya.center.set(0,0,0),Ya.radius=.7071067811865476,Ya.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ya)}intersectsSphere(t){const r=this.planes,o=t.center,c=-t.radius;for(let A=0;A<6;A++)if(r[A].distanceToPoint(o)<c)return!1;return!0}intersectsBox(t){const r=this.planes;for(let o=0;o<6;o++){const c=r[o];if(cd.x=c.normal.x>0?t.max.x:t.min.x,cd.y=c.normal.y>0?t.max.y:t.min.y,cd.z=c.normal.z>0?t.max.z:t.min.z,c.distanceToPoint(cd)<0)return!1}return!0}containsPoint(t){const r=this.planes;for(let o=0;o<6;o++)if(r[o].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Zv extends Jv{constructor(t=-1,r=1,o=1,c=-1,A=.1,B=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=r,this.top=o,this.bottom=c,this.near=A,this.far=B,this.updateProjectionMatrix()}copy(t,r){return super.copy(t,r),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,r,o,c,A,B){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=o,this.view.offsetY=c,this.view.width=A,this.view.height=B,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,c=(this.top+this.bottom)/2;let A=o-t,B=o+t,m=c+r,M=c-r;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;A+=h*this.view.offsetX,B=A+h*this.view.width,m-=f*this.view.offsetY,M=m-f*this.view.height}this.projectionMatrix.makeOrthographic(A,B,m,M,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const r=super.toJSON(t);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,this.view!==null&&(r.object.view=Object.assign({},this.view)),r}}class iM extends Os{constructor(t,r,o,c,A,B,m,M,h,f){if(f=f!==void 0?f:Vp,f!==Vp&&f!==W0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&f===Vp&&(o=fw),o===void 0&&f===W0&&(o=pw),super(null,c,A,B,m,M,f,o,h),this.isDepthTexture=!0,this.image={width:t,height:r},this.magFilter=m!==void 0?m:Ed,this.minFilter=M!==void 0?M:Ed,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const r=super.toJSON(t);return this.compareFunction!==null&&(r.compareFunction=this.compareFunction),r}}const nM=new iM(1,1);nM.compareFunction=gw;class xv extends Ar{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Cv=new it,bv=new rs,wv=new rs,rM=new it,Mv=new Gi,hd=new it,aA=new sc,_v=new Gi,lA=new DA;class sM extends qa{constructor(t,r){super(t,r),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=H0,this.bindMatrix=new Gi,this.bindMatrixInverse=new Gi,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;this.boundingBox===null&&(this.boundingBox=new rc),this.boundingBox.makeEmpty();const r=t.getAttribute("position");for(let o=0;o<r.count;o++)this.getVertexPosition(o,hd),this.boundingBox.expandByPoint(hd)}computeBoundingSphere(){const t=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new sc),this.boundingSphere.makeEmpty();const r=t.getAttribute("position");for(let o=0;o<r.count;o++)this.getVertexPosition(o,hd),this.boundingSphere.expandByPoint(hd)}copy(t,r){return super.copy(t,r),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}raycast(t,r){const o=this.material,c=this.matrixWorld;o!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),aA.copy(this.boundingSphere),aA.applyMatrix4(c),t.ray.intersectsSphere(aA)!==!1&&(_v.copy(c).invert(),lA.copy(t.ray).applyMatrix4(_v),!(this.boundingBox!==null&&lA.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(t,r,lA)))}getVertexPosition(t,r){return super.getVertexPosition(t,r),this.applyBoneTransform(t,r),r}bind(t,r){this.skeleton=t,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.copy(r).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new rs,r=this.geometry.attributes.skinWeight;for(let o=0,c=r.count;o<c;o++){t.fromBufferAttribute(r,o);const A=1/t.manhattanLength();A!==1/0?t.multiplyScalar(A):t.set(1,0,0,0),r.setXYZW(o,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode===H0?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===lw?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(t,r){const o=this.skeleton,c=this.geometry;bv.fromBufferAttribute(c.attributes.skinIndex,t),wv.fromBufferAttribute(c.attributes.skinWeight,t),Cv.copy(r).applyMatrix4(this.bindMatrix),r.set(0,0,0);for(let A=0;A<4;A++){const B=wv.getComponent(A);if(B!==0){const m=bv.getComponent(A);Mv.multiplyMatrices(o.bones[m].matrixWorld,o.boneInverses[m]),r.addScaledVector(rM.copy(Cv).applyMatrix4(Mv),B)}}return r.applyMatrix4(this.bindMatrixInverse)}}class wA extends Ar{constructor(){super(),this.isBone=!0,this.type="Bone"}}class oM extends Os{constructor(t=null,r=1,o=1,c,A,B,m,M,h=Ed,f=Ed,C,p){super(null,B,m,M,h,f,c,A,C,p),this.isDataTexture=!0,this.image={data:t,width:r,height:o},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Sv=new Gi,aM=new Gi;class OA{constructor(t=[],r=[]){this.uuid=ma(),this.bones=t.slice(0),this.boneInverses=r,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const t=this.bones,r=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),r.length===0)this.calculateInverses();else if(t.length!==r.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let o=0,c=this.bones.length;o<c;o++)this.boneInverses.push(new Gi)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,r=this.bones.length;t<r;t++){const o=new Gi;this.bones[t]&&o.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(o)}}pose(){for(let t=0,r=this.bones.length;t<r;t++){const o=this.bones[t];o&&o.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,r=this.bones.length;t<r;t++){const o=this.bones[t];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}}update(){const t=this.bones,r=this.boneInverses,o=this.boneMatrices,c=this.boneTexture;for(let A=0,B=t.length;A<B;A++){const m=t[A]?t[A].matrixWorld:aM;Sv.multiplyMatrices(m,r[A]),Sv.toArray(o,A*16)}c!==null&&(c.needsUpdate=!0)}clone(){return new OA(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=Math.ceil(t/4)*4,t=Math.max(t,4);const r=new Float32Array(t*t*4);r.set(this.boneMatrices);const o=new oM(r,t,t,jv,Hv);return o.needsUpdate=!0,this.boneMatrices=r,this.boneTexture=o,this}getBoneByName(t){for(let r=0,o=this.bones.length;r<o;r++){const c=this.bones[r];if(c.name===t)return c}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,r){this.uuid=t.uuid;for(let o=0,c=t.bones.length;o<c;o++){const A=t.bones[o];let B=r[A];B===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",A),B=new wA),this.bones.push(B),this.boneInverses.push(new Gi().fromArray(t.boneInverses[o]))}return this.init(),this}toJSON(){const t={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const r=this.bones,o=this.boneInverses;for(let c=0,A=r.length;c<A;c++){const B=r[c];t.bones.push(B.uuid);const m=o[c];t.boneInverses.push(m.toArray())}return t}}class FA extends Td{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Sr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const bd=new it,wd=new it,Tv=new Gi,qc=new DA,ud=new sc,cA=new it,Iv=new it;class $v extends Ar{constructor(t=new so,r=new FA){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=r,this.updateMorphTargets()}copy(t,r){return super.copy(t,r),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const r=t.attributes.position,o=[0];for(let c=1,A=r.count;c<A;c++)bd.fromBufferAttribute(r,c-1),wd.fromBufferAttribute(r,c),o[c]=o[c-1],o[c]+=bd.distanceTo(wd);t.setAttribute("lineDistance",new Ms(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,r){const o=this.geometry,c=this.matrixWorld,A=t.params.Line.threshold,B=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),ud.copy(o.boundingSphere),ud.applyMatrix4(c),ud.radius+=A,t.ray.intersectsSphere(ud)===!1)return;Tv.copy(c).invert(),qc.copy(t.ray).applyMatrix4(Tv);const m=A/((this.scale.x+this.scale.y+this.scale.z)/3),M=m*m,h=this.isLineSegments?2:1,f=o.index,p=o.attributes.position;if(f!==null){const g=Math.max(0,B.start),u=Math.min(f.count,B.start+B.count);for(let E=g,b=u-1;E<b;E+=h){const x=f.getX(E),T=f.getX(E+1),_=dd(this,t,qc,M,x,T);_&&r.push(_)}if(this.isLineLoop){const E=f.getX(u-1),b=f.getX(g),x=dd(this,t,qc,M,E,b);x&&r.push(x)}}else{const g=Math.max(0,B.start),u=Math.min(p.count,B.start+B.count);for(let E=g,b=u-1;E<b;E+=h){const x=dd(this,t,qc,M,E,E+1);x&&r.push(x)}if(this.isLineLoop){const E=dd(this,t,qc,M,u-1,g);E&&r.push(E)}}}updateMorphTargets(){const r=this.geometry.morphAttributes,o=Object.keys(r);if(o.length>0){const c=r[o[0]];if(c!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let A=0,B=c.length;A<B;A++){const m=c[A].name||String(A);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=A}}}}}function dd(y,t,r,o,c,A){const B=y.geometry.attributes.position;if(bd.fromBufferAttribute(B,c),wd.fromBufferAttribute(B,A),r.distanceSqToSegment(bd,wd,cA,Iv)>o)return;cA.applyMatrix4(y.matrixWorld);const M=t.ray.origin.distanceTo(cA);if(!(M<t.near||M>t.far))return{distance:M,point:Iv.clone().applyMatrix4(y.matrixWorld),index:c,face:null,faceIndex:null,object:y}}class lM{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,r){const o=this.getUtoTmapping(t);return this.getPoint(o,r)}getPoints(t=5){const r=[];for(let o=0;o<=t;o++)r.push(this.getPoint(o/t));return r}getSpacedPoints(t=5){const r=[];for(let o=0;o<=t;o++)r.push(this.getPointAt(o/t));return r}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const r=[];let o,c=this.getPoint(0),A=0;r.push(0);for(let B=1;B<=t;B++)o=this.getPoint(B/t),A+=o.distanceTo(c),r.push(A),c=o;return this.cacheArcLengths=r,r}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,r){const o=this.getLengths();let c=0;const A=o.length;let B;r?B=r:B=t*o[A-1];let m=0,M=A-1,h;for(;m<=M;)if(c=Math.floor(m+(M-m)/2),h=o[c]-B,h<0)m=c+1;else if(h>0)M=c-1;else{M=c;break}if(c=M,o[c]===B)return c/(A-1);const f=o[c],p=o[c+1]-f,g=(B-f)/p;return(c+g)/(A-1)}getTangent(t,r){let c=t-1e-4,A=t+1e-4;c<0&&(c=0),A>1&&(A=1);const B=this.getPoint(c),m=this.getPoint(A),M=r||(B.isVector2?new pr:new it);return M.copy(m).sub(B).normalize(),M}getTangentAt(t,r){const o=this.getUtoTmapping(t);return this.getTangent(o,r)}computeFrenetFrames(t,r){const o=new it,c=[],A=[],B=[],m=new it,M=new Gi;for(let g=0;g<=t;g++){const u=g/t;c[g]=this.getTangentAt(u,new it)}A[0]=new it,B[0]=new it;let h=Number.MAX_VALUE;const f=Math.abs(c[0].x),C=Math.abs(c[0].y),p=Math.abs(c[0].z);f<=h&&(h=f,o.set(1,0,0)),C<=h&&(h=C,o.set(0,1,0)),p<=h&&o.set(0,0,1),m.crossVectors(c[0],o).normalize(),A[0].crossVectors(c[0],m),B[0].crossVectors(c[0],A[0]);for(let g=1;g<=t;g++){if(A[g]=A[g-1].clone(),B[g]=B[g-1].clone(),m.crossVectors(c[g-1],c[g]),m.length()>Number.EPSILON){m.normalize();const u=Math.acos(Kr(c[g-1].dot(c[g]),-1,1));A[g].applyMatrix4(M.makeRotationAxis(m,u))}B[g].crossVectors(c[g],A[g])}if(r===!0){let g=Math.acos(Kr(A[0].dot(A[t]),-1,1));g/=t,c[0].dot(m.crossVectors(A[0],A[t]))>0&&(g=-g);for(let u=1;u<=t;u++)A[u].applyMatrix4(M.makeRotationAxis(c[u],g*u)),B[u].crossVectors(c[u],A[u])}return{tangents:c,normals:A,binormals:B}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}const cM={triangulate:function(y,t,r=2){const o=t&&t.length,c=o?t[0]*r:y.length;let A=ey(y,0,c,r,!0);const B=[];if(!A||A.next===A.prev)return B;let m,M,h,f,C,p,g;if(o&&(A=pM(y,t,A,r)),y.length>80*r){m=h=y[0],M=f=y[1];for(let u=r;u<c;u+=r)C=y[u],p=y[u+1],C<m&&(m=C),p<M&&(M=p),C>h&&(h=C),p>f&&(f=p);g=Math.max(h-m,f-M),g=g!==0?32767/g:0}return ah(A,B,r,m,M,g,0),B}};function ey(y,t,r,o,c){let A,B;if(c===MM(y,t,r,o)>0)for(A=t;A<r;A+=o)B=Bv(A,y[A],y[A+1],B);else for(A=r-o;A>=t;A-=o)B=Bv(A,y[A],y[A+1],B);return B&&Id(B,B.next)&&(ch(B),B=B.next),B}function Za(y,t){if(!y)return y;t||(t=y);let r=y,o;do if(o=!1,!r.steiner&&(Id(r,r.next)||fr(r.prev,r,r.next)===0)){if(ch(r),r=t=r.prev,r===r.next)break;o=!0}else r=r.next;while(o||r!==t);return t}function ah(y,t,r,o,c,A,B){if(!y)return;!B&&A&&yM(y,o,c,A);let m=y,M,h;for(;y.prev!==y.next;){if(M=y.prev,h=y.next,A?uM(y,o,c,A):hM(y)){t.push(M.i/r|0),t.push(y.i/r|0),t.push(h.i/r|0),ch(y),y=h.next,m=h.next;continue}if(y=h,y===m){B?B===1?(y=dM(Za(y),t,r),ah(y,t,r,o,c,A,2)):B===2&&fM(y,t,r,o,c,A):ah(Za(y),t,r,o,c,A,1);break}}}function hM(y){const t=y.prev,r=y,o=y.next;if(fr(t,r,o)>=0)return!1;const c=t.x,A=r.x,B=o.x,m=t.y,M=r.y,h=o.y,f=c<A?c<B?c:B:A<B?A:B,C=m<M?m<h?m:h:M<h?M:h,p=c>A?c>B?c:B:A>B?A:B,g=m>M?m>h?m:h:M>h?M:h;let u=o.next;for(;u!==t;){if(u.x>=f&&u.x<=p&&u.y>=C&&u.y<=g&&tc(c,m,A,M,B,h,u.x,u.y)&&fr(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function uM(y,t,r,o){const c=y.prev,A=y,B=y.next;if(fr(c,A,B)>=0)return!1;const m=c.x,M=A.x,h=B.x,f=c.y,C=A.y,p=B.y,g=m<M?m<h?m:h:M<h?M:h,u=f<C?f<p?f:p:C<p?C:p,E=m>M?m>h?m:h:M>h?M:h,b=f>C?f>p?f:p:C>p?C:p,x=MA(g,u,t,r,o),T=MA(E,b,t,r,o);let _=y.prevZ,w=y.nextZ;for(;_&&_.z>=x&&w&&w.z<=T;){if(_.x>=g&&_.x<=E&&_.y>=u&&_.y<=b&&_!==c&&_!==B&&tc(m,f,M,C,h,p,_.x,_.y)&&fr(_.prev,_,_.next)>=0||(_=_.prevZ,w.x>=g&&w.x<=E&&w.y>=u&&w.y<=b&&w!==c&&w!==B&&tc(m,f,M,C,h,p,w.x,w.y)&&fr(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;_&&_.z>=x;){if(_.x>=g&&_.x<=E&&_.y>=u&&_.y<=b&&_!==c&&_!==B&&tc(m,f,M,C,h,p,_.x,_.y)&&fr(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;w&&w.z<=T;){if(w.x>=g&&w.x<=E&&w.y>=u&&w.y<=b&&w!==c&&w!==B&&tc(m,f,M,C,h,p,w.x,w.y)&&fr(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function dM(y,t,r){let o=y;do{const c=o.prev,A=o.next.next;!Id(c,A)&&ty(c,o,o.next,A)&&lh(c,A)&&lh(A,c)&&(t.push(c.i/r|0),t.push(o.i/r|0),t.push(A.i/r|0),ch(o),ch(o.next),o=y=A),o=o.next}while(o!==y);return Za(o)}function fM(y,t,r,o,c,A){let B=y;do{let m=B.next.next;for(;m!==B.prev;){if(B.i!==m.i&&CM(B,m)){let M=iy(B,m);B=Za(B,B.next),M=Za(M,M.next),ah(B,t,r,o,c,A,0),ah(M,t,r,o,c,A,0);return}m=m.next}B=B.next}while(B!==y)}function pM(y,t,r,o){const c=[];let A,B,m,M,h;for(A=0,B=t.length;A<B;A++)m=t[A]*o,M=A<B-1?t[A+1]*o:y.length,h=ey(y,m,M,o,!1),h===h.next&&(h.steiner=!0),c.push(xM(h));for(c.sort(AM),A=0;A<c.length;A++)r=mM(c[A],r);return r}function AM(y,t){return y.x-t.x}function mM(y,t){const r=gM(y,t);if(!r)return t;const o=iy(r,y);return Za(o,o.next),Za(r,r.next)}function gM(y,t){let r=t,o=-1/0,c;const A=y.x,B=y.y;do{if(B<=r.y&&B>=r.next.y&&r.next.y!==r.y){const p=r.x+(B-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(p<=A&&p>o&&(o=p,c=r.x<r.next.x?r:r.next,p===A))return c}r=r.next}while(r!==t);if(!c)return null;const m=c,M=c.x,h=c.y;let f=1/0,C;r=c;do A>=r.x&&r.x>=M&&A!==r.x&&tc(B<h?A:o,B,M,h,B<h?o:A,B,r.x,r.y)&&(C=Math.abs(B-r.y)/(A-r.x),lh(r,y)&&(C<f||C===f&&(r.x>c.x||r.x===c.x&&vM(c,r)))&&(c=r,f=C)),r=r.next;while(r!==m);return c}function vM(y,t){return fr(y.prev,y,t.prev)<0&&fr(t.next,y,y.next)<0}function yM(y,t,r,o){let c=y;do c.z===0&&(c.z=MA(c.x,c.y,t,r,o)),c.prevZ=c.prev,c.nextZ=c.next,c=c.next;while(c!==y);c.prevZ.nextZ=null,c.prevZ=null,EM(c)}function EM(y){let t,r,o,c,A,B,m,M,h=1;do{for(r=y,y=null,A=null,B=0;r;){for(B++,o=r,m=0,t=0;t<h&&(m++,o=o.nextZ,!!o);t++);for(M=h;m>0||M>0&&o;)m!==0&&(M===0||!o||r.z<=o.z)?(c=r,r=r.nextZ,m--):(c=o,o=o.nextZ,M--),A?A.nextZ=c:y=c,c.prevZ=A,A=c;r=o}A.nextZ=null,h*=2}while(B>1);return y}function MA(y,t,r,o,c){return y=(y-r)*c|0,t=(t-o)*c|0,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,y|t<<1}function xM(y){let t=y,r=y;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==y);return r}function tc(y,t,r,o,c,A,B,m){return(c-B)*(t-m)>=(y-B)*(A-m)&&(y-B)*(o-m)>=(r-B)*(t-m)&&(r-B)*(A-m)>=(c-B)*(o-m)}function CM(y,t){return y.next.i!==t.i&&y.prev.i!==t.i&&!bM(y,t)&&(lh(y,t)&&lh(t,y)&&wM(y,t)&&(fr(y.prev,y,t.prev)||fr(y,t.prev,t))||Id(y,t)&&fr(y.prev,y,y.next)>0&&fr(t.prev,t,t.next)>0)}function fr(y,t,r){return(t.y-y.y)*(r.x-t.x)-(t.x-y.x)*(r.y-t.y)}function Id(y,t){return y.x===t.x&&y.y===t.y}function ty(y,t,r,o){const c=pd(fr(y,t,r)),A=pd(fr(y,t,o)),B=pd(fr(r,o,y)),m=pd(fr(r,o,t));return!!(c!==A&&B!==m||c===0&&fd(y,r,t)||A===0&&fd(y,o,t)||B===0&&fd(r,y,o)||m===0&&fd(r,t,o))}function fd(y,t,r){return t.x<=Math.max(y.x,r.x)&&t.x>=Math.min(y.x,r.x)&&t.y<=Math.max(y.y,r.y)&&t.y>=Math.min(y.y,r.y)}function pd(y){return y>0?1:y<0?-1:0}function bM(y,t){let r=y;do{if(r.i!==y.i&&r.next.i!==y.i&&r.i!==t.i&&r.next.i!==t.i&&ty(r,r.next,y,t))return!0;r=r.next}while(r!==y);return!1}function lh(y,t){return fr(y.prev,y,y.next)<0?fr(y,t,y.next)>=0&&fr(y,y.prev,t)>=0:fr(y,t,y.prev)<0||fr(y,y.next,t)<0}function wM(y,t){let r=y,o=!1;const c=(y.x+t.x)/2,A=(y.y+t.y)/2;do r.y>A!=r.next.y>A&&r.next.y!==r.y&&c<(r.next.x-r.x)*(A-r.y)/(r.next.y-r.y)+r.x&&(o=!o),r=r.next;while(r!==y);return o}function iy(y,t){const r=new _A(y.i,y.x,y.y),o=new _A(t.i,t.x,t.y),c=y.next,A=t.prev;return y.next=t,t.prev=y,r.next=c,c.prev=r,o.next=r,r.prev=o,A.next=o,o.prev=A,o}function Bv(y,t,r,o){const c=new _A(y,t,r);return o?(c.next=o.next,c.prev=o,o.next.prev=c,o.next=c):(c.prev=c,c.next=c),c}function ch(y){y.next.prev=y.prev,y.prev.next=y.next,y.prevZ&&(y.prevZ.nextZ=y.nextZ),y.nextZ&&(y.nextZ.prevZ=y.prevZ)}function _A(y,t,r){this.i=y,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function MM(y,t,r,o){let c=0;for(let A=t,B=r-o;A<r;A+=o)c+=(y[B]-y[A])*(y[A+1]+y[B+1]),B=A;return c}class NA{static area(t){const r=t.length;let o=0;for(let c=r-1,A=0;A<r;c=A++)o+=t[c].x*t[A].y-t[A].x*t[c].y;return o*.5}static isClockWise(t){return NA.area(t)<0}static triangulateShape(t,r){const o=[],c=[],A=[];Rv(t),Lv(o,t);let B=t.length;r.forEach(Rv);for(let M=0;M<r.length;M++)c.push(B),B+=r[M].length,Lv(o,r[M]);const m=cM.triangulate(o,c);for(let M=0;M<m.length;M+=3)A.push(m.slice(M,M+3));return A}}function Rv(y){const t=y.length;t>2&&y[t-1].equals(y[0])&&y.pop()}function Lv(y,t){for(let r=0;r<t.length;r++)y.push(t[r].x),y.push(t[r].y)}class Md extends so{constructor(t=1,r=32,o=16,c=0,A=Math.PI*2,B=0,m=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:o,phiStart:c,phiLength:A,thetaStart:B,thetaLength:m},r=Math.max(3,Math.floor(r)),o=Math.max(2,Math.floor(o));const M=Math.min(B+m,Math.PI);let h=0;const f=[],C=new it,p=new it,g=[],u=[],E=[],b=[];for(let x=0;x<=o;x++){const T=[],_=x/o;let w=0;x===0&&B===0?w=.5/r:x===o&&M===Math.PI&&(w=-.5/r);for(let S=0;S<=r;S++){const L=S/r;C.x=-t*Math.cos(c+L*A)*Math.sin(B+_*m),C.y=t*Math.cos(B+_*m),C.z=t*Math.sin(c+L*A)*Math.sin(B+_*m),u.push(C.x,C.y,C.z),p.copy(C).normalize(),E.push(p.x,p.y,p.z),b.push(L+w,1-_),T.push(h++)}f.push(T)}for(let x=0;x<o;x++)for(let T=0;T<r;T++){const _=f[x][T+1],w=f[x][T],S=f[x+1][T],L=f[x+1][T+1];(x!==0||B>0)&&g.push(_,w,L),(x!==o-1||M<Math.PI)&&g.push(w,S,L)}this.setIndex(g),this.setAttribute("position",new Ms(u,3)),this.setAttribute("normal",new Ms(E,3)),this.setAttribute("uv",new Ms(b,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Md(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class hA extends Td{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Sr(16777215),this.specular=new Sr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wv,this.normalScale=new pr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xr,this.combine=BA,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class _M extends Td{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Sr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wv,this.normalScale=new pr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xr,this.combine=BA,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}function Ad(y,t,r){return!y||!r&&y.constructor===t?y:typeof t.BYTES_PER_ELEMENT=="number"?new t(y):Array.prototype.slice.call(y)}function SM(y){return ArrayBuffer.isView(y)&&!(y instanceof DataView)}function TM(y){function t(c,A){return y[c]-y[A]}const r=y.length,o=new Array(r);for(let c=0;c!==r;++c)o[c]=c;return o.sort(t),o}function Dv(y,t,r){const o=y.length,c=new y.constructor(o);for(let A=0,B=0;B!==o;++A){const m=r[A]*t;for(let M=0;M!==t;++M)c[B++]=y[m+M]}return c}function ny(y,t,r,o){let c=1,A=y[0];for(;A!==void 0&&A[o]===void 0;)A=y[c++];if(A===void 0)return;let B=A[o];if(B!==void 0)if(Array.isArray(B))do B=A[o],B!==void 0&&(t.push(A.time),r.push.apply(r,B)),A=y[c++];while(A!==void 0);else if(B.toArray!==void 0)do B=A[o],B!==void 0&&(t.push(A.time),B.toArray(r,r.length)),A=y[c++];while(A!==void 0);else do B=A[o],B!==void 0&&(t.push(A.time),r.push(B)),A=y[c++];while(A!==void 0)}class Bd{constructor(t,r,o,c){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=c!==void 0?c:new r.constructor(o),this.sampleValues=r,this.valueSize=o,this.settings=null,this.DefaultSettings_={}}evaluate(t){const r=this.parameterPositions;let o=this._cachedIndex,c=r[o],A=r[o-1];i:{e:{let B;t:{n:if(!(t<c)){for(let m=o+2;;){if(c===void 0){if(t<A)break n;return o=r.length,this._cachedIndex=o,this.copySampleValue_(o-1)}if(o===m)break;if(A=c,c=r[++o],t<c)break e}B=r.length;break t}if(!(t>=A)){const m=r[1];t<m&&(o=2,A=m);for(let M=o-2;;){if(A===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(o===M)break;if(c=A,A=r[--o-1],t>=A)break e}B=o,o=0;break t}break i}for(;o<B;){const m=o+B>>>1;t<r[m]?B=m:o=m+1}if(c=r[o],A=r[o-1],A===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(c===void 0)return o=r.length,this._cachedIndex=o,this.copySampleValue_(o-1)}this._cachedIndex=o,this.intervalChanged_(o,A,c)}return this.interpolate_(o,A,t,c)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,A=t*c;for(let B=0;B!==c;++B)r[B]=o[A+B];return r}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class IM extends Bd{constructor(t,r,o,c){super(t,r,o,c),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:K0,endingEnd:K0}}intervalChanged_(t,r,o){const c=this.parameterPositions;let A=t-2,B=t+1,m=c[A],M=c[B];if(m===void 0)switch(this.getSettings_().endingStart){case X0:A=t,m=2*r-o;break;case Y0:A=c.length-2,m=r+c[A]-c[A+1];break;default:A=t,m=o}if(M===void 0)switch(this.getSettings_().endingEnd){case X0:B=t,M=2*o-r;break;case Y0:B=1,M=o+c[1]-c[0];break;default:B=t-1,M=r}const h=(o-r)*.5,f=this.valueSize;this._weightPrev=h/(r-m),this._weightNext=h/(M-o),this._offsetPrev=A*f,this._offsetNext=B*f}interpolate_(t,r,o,c){const A=this.resultBuffer,B=this.sampleValues,m=this.valueSize,M=t*m,h=M-m,f=this._offsetPrev,C=this._offsetNext,p=this._weightPrev,g=this._weightNext,u=(o-r)/(c-r),E=u*u,b=E*u,x=-p*b+2*p*E-p*u,T=(1+p)*b+(-1.5-2*p)*E+(-.5+p)*u+1,_=(-1-g)*b+(1.5+g)*E+.5*u,w=g*b-g*E;for(let S=0;S!==m;++S)A[S]=x*B[f+S]+T*B[h+S]+_*B[M+S]+w*B[C+S];return A}}class BM extends Bd{constructor(t,r,o,c){super(t,r,o,c)}interpolate_(t,r,o,c){const A=this.resultBuffer,B=this.sampleValues,m=this.valueSize,M=t*m,h=M-m,f=(o-r)/(c-r),C=1-f;for(let p=0;p!==m;++p)A[p]=B[h+p]*C+B[M+p]*f;return A}}class RM extends Bd{constructor(t,r,o,c){super(t,r,o,c)}interpolate_(t){return this.copySampleValue_(t-1)}}class go{constructor(t,r,o,c){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ad(r,this.TimeBufferType),this.values=Ad(o,this.ValueBufferType),this.setInterpolation(c||this.DefaultInterpolation)}static toJSON(t){const r=t.constructor;let o;if(r.toJSON!==this.toJSON)o=r.toJSON(t);else{o={name:t.name,times:Ad(t.times,Array),values:Ad(t.values,Array)};const c=t.getInterpolation();c!==t.DefaultInterpolation&&(o.interpolation=c)}return o.type=t.ValueTypeName,o}InterpolantFactoryMethodDiscrete(t){return new RM(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new BM(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new IM(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let r;switch(t){case xd:r=this.InterpolantFactoryMethodDiscrete;break;case Cd:r=this.InterpolantFactoryMethodLinear;break;case zp:r=this.InterpolantFactoryMethodSmooth;break}if(r===void 0){const o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(o);return console.warn("THREE.KeyframeTrack:",o),this}return this.createInterpolant=r,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return xd;case this.InterpolantFactoryMethodLinear:return Cd;case this.InterpolantFactoryMethodSmooth:return zp}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const r=this.times;for(let o=0,c=r.length;o!==c;++o)r[o]+=t}return this}scale(t){if(t!==1){const r=this.times;for(let o=0,c=r.length;o!==c;++o)r[o]*=t}return this}trim(t,r){const o=this.times,c=o.length;let A=0,B=c-1;for(;A!==c&&o[A]<t;)++A;for(;B!==-1&&o[B]>r;)--B;if(++B,A!==0||B!==c){A>=B&&(B=Math.max(B,1),A=B-1);const m=this.getValueSize();this.times=o.slice(A,B),this.values=this.values.slice(A*m,B*m)}return this}validate(){let t=!0;const r=this.getValueSize();r-Math.floor(r)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const o=this.times,c=this.values,A=o.length;A===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let B=null;for(let m=0;m!==A;m++){const M=o[m];if(typeof M=="number"&&isNaN(M)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,m,M),t=!1;break}if(B!==null&&B>M){console.error("THREE.KeyframeTrack: Out of order keys.",this,m,M,B),t=!1;break}B=M}if(c!==void 0&&SM(c))for(let m=0,M=c.length;m!==M;++m){const h=c[m];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,m,h),t=!1;break}}return t}optimize(){const t=this.times.slice(),r=this.values.slice(),o=this.getValueSize(),c=this.getInterpolation()===zp,A=t.length-1;let B=1;for(let m=1;m<A;++m){let M=!1;const h=t[m],f=t[m+1];if(h!==f&&(m!==1||h!==t[0]))if(c)M=!0;else{const C=m*o,p=C-o,g=C+o;for(let u=0;u!==o;++u){const E=r[C+u];if(E!==r[p+u]||E!==r[g+u]){M=!0;break}}}if(M){if(m!==B){t[B]=t[m];const C=m*o,p=B*o;for(let g=0;g!==o;++g)r[p+g]=r[C+g]}++B}}if(A>0){t[B]=t[A];for(let m=A*o,M=B*o,h=0;h!==o;++h)r[M+h]=r[m+h];++B}return B!==t.length?(this.times=t.slice(0,B),this.values=r.slice(0,B*o)):(this.times=t,this.values=r),this}clone(){const t=this.times.slice(),r=this.values.slice(),o=this.constructor,c=new o(this.name,t,r);return c.createInterpolant=this.createInterpolant,c}}go.prototype.TimeBufferType=Float32Array;go.prototype.ValueBufferType=Float32Array;go.prototype.DefaultInterpolation=Cd;class oc extends go{}oc.prototype.ValueTypeName="bool";oc.prototype.ValueBufferType=Array;oc.prototype.DefaultInterpolation=xd;oc.prototype.InterpolantFactoryMethodLinear=void 0;oc.prototype.InterpolantFactoryMethodSmooth=void 0;class ry extends go{}ry.prototype.ValueTypeName="color";class hh extends go{}hh.prototype.ValueTypeName="number";class LM extends Bd{constructor(t,r,o,c){super(t,r,o,c)}interpolate_(t,r,o,c){const A=this.resultBuffer,B=this.sampleValues,m=this.valueSize,M=(o-r)/(c-r);let h=t*m;for(let f=h+m;h!==f;h+=4)ws.slerpFlat(A,0,B,h-m,B,h,M);return A}}class $a extends go{InterpolantFactoryMethodLinear(t){return new LM(this.times,this.values,this.getValueSize(),t)}}$a.prototype.ValueTypeName="quaternion";$a.prototype.DefaultInterpolation=Cd;$a.prototype.InterpolantFactoryMethodSmooth=void 0;class ac extends go{}ac.prototype.ValueTypeName="string";ac.prototype.ValueBufferType=Array;ac.prototype.DefaultInterpolation=xd;ac.prototype.InterpolantFactoryMethodLinear=void 0;ac.prototype.InterpolantFactoryMethodSmooth=void 0;class uh extends go{}uh.prototype.ValueTypeName="vector";class DM{constructor(t="",r=-1,o=[],c=Aw){this.name=t,this.tracks=o,this.duration=r,this.blendMode=c,this.uuid=ma(),this.duration<0&&this.resetDuration()}static parse(t){const r=[],o=t.tracks,c=1/(t.fps||1);for(let B=0,m=o.length;B!==m;++B)r.push(OM(o[B]).scale(c));const A=new this(t.name,t.duration,r,t.blendMode);return A.uuid=t.uuid,A}static toJSON(t){const r=[],o=t.tracks,c={name:t.name,duration:t.duration,tracks:r,uuid:t.uuid,blendMode:t.blendMode};for(let A=0,B=o.length;A!==B;++A)r.push(go.toJSON(o[A]));return c}static CreateFromMorphTargetSequence(t,r,o,c){const A=r.length,B=[];for(let m=0;m<A;m++){let M=[],h=[];M.push((m+A-1)%A,m,(m+1)%A),h.push(0,1,0);const f=TM(M);M=Dv(M,1,f),h=Dv(h,1,f),!c&&M[0]===0&&(M.push(A),h.push(h[0])),B.push(new hh(".morphTargetInfluences["+r[m].name+"]",M,h).scale(1/o))}return new this(t,-1,B)}static findByName(t,r){let o=t;if(!Array.isArray(t)){const c=t;o=c.geometry&&c.geometry.animations||c.animations}for(let c=0;c<o.length;c++)if(o[c].name===r)return o[c];return null}static CreateClipsFromMorphTargetSequences(t,r,o){const c={},A=/^([\w-]*?)([\d]+)$/;for(let m=0,M=t.length;m<M;m++){const h=t[m],f=h.name.match(A);if(f&&f.length>1){const C=f[1];let p=c[C];p||(c[C]=p=[]),p.push(h)}}const B=[];for(const m in c)B.push(this.CreateFromMorphTargetSequence(m,c[m],r,o));return B}static parseAnimation(t,r){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const o=function(C,p,g,u,E){if(g.length!==0){const b=[],x=[];ny(g,b,x,u),b.length!==0&&E.push(new C(p,b,x))}},c=[],A=t.name||"default",B=t.fps||30,m=t.blendMode;let M=t.length||-1;const h=t.hierarchy||[];for(let C=0;C<h.length;C++){const p=h[C].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const g={};let u;for(u=0;u<p.length;u++)if(p[u].morphTargets)for(let E=0;E<p[u].morphTargets.length;E++)g[p[u].morphTargets[E]]=-1;for(const E in g){const b=[],x=[];for(let T=0;T!==p[u].morphTargets.length;++T){const _=p[u];b.push(_.time),x.push(_.morphTarget===E?1:0)}c.push(new hh(".morphTargetInfluence["+E+"]",b,x))}M=g.length*B}else{const g=".bones["+r[C].name+"]";o(uh,g+".position",p,"pos",c),o($a,g+".quaternion",p,"rot",c),o(uh,g+".scale",p,"scl",c)}}return c.length===0?null:new this(A,M,c,m)}resetDuration(){const t=this.tracks;let r=0;for(let o=0,c=t.length;o!==c;++o){const A=this.tracks[o];r=Math.max(r,A.times[A.times.length-1])}return this.duration=r,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let r=0;r<this.tracks.length;r++)t=t&&this.tracks[r].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let r=0;r<this.tracks.length;r++)t.push(this.tracks[r].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function PM(y){switch(y.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hh;case"vector":case"vector2":case"vector3":case"vector4":return uh;case"color":return ry;case"quaternion":return $a;case"bool":case"boolean":return oc;case"string":return ac}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+y)}function OM(y){if(y.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=PM(y.type);if(y.times===void 0){const r=[],o=[];ny(y.keys,r,o,"value"),y.times=r,y.values=o}return t.parse!==void 0?t.parse(y):new t(y.name,y.times,y.values,y.interpolation)}const _d={enabled:!1,files:{},add:function(y,t){this.enabled!==!1&&(this.files[y]=t)},get:function(y){if(this.enabled!==!1)return this.files[y]},remove:function(y){delete this.files[y]},clear:function(){this.files={}}};class FM{constructor(t,r,o){const c=this;let A=!1,B=0,m=0,M;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=r,this.onError=o,this.itemStart=function(f){m++,A===!1&&c.onStart!==void 0&&c.onStart(f,B,m),A=!0},this.itemEnd=function(f){B++,c.onProgress!==void 0&&c.onProgress(f,B,m),B===m&&(A=!1,c.onLoad!==void 0&&c.onLoad())},this.itemError=function(f){c.onError!==void 0&&c.onError(f)},this.resolveURL=function(f){return M?M(f):f},this.setURLModifier=function(f){return M=f,this},this.addHandler=function(f,C){return h.push(f,C),this},this.removeHandler=function(f){const C=h.indexOf(f);return C!==-1&&h.splice(C,2),this},this.getHandler=function(f){for(let C=0,p=h.length;C<p;C+=2){const g=h[C],u=h[C+1];if(g.global&&(g.lastIndex=0),g.test(f))return u}return null}}}const NM=new FM;class el{constructor(t){this.manager=t!==void 0?t:NM,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,r){const o=this;return new Promise(function(c,A){o.load(t,c,r,A)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}el.DEFAULT_MATERIAL_NAME="__DEFAULT";const Go={};class kM extends Error{constructor(t,r){super(t),this.response=r}}class UM extends el{constructor(t){super(t)}load(t,r,o,c){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const A=_d.get(t);if(A!==void 0)return this.manager.itemStart(t),setTimeout(()=>{r&&r(A),this.manager.itemEnd(t)},0),A;if(Go[t]!==void 0){Go[t].push({onLoad:r,onProgress:o,onError:c});return}Go[t]=[],Go[t].push({onLoad:r,onProgress:o,onError:c});const B=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),m=this.mimeType,M=this.responseType;fetch(B).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const f=Go[t],C=h.body.getReader(),p=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),g=p?parseInt(p):0,u=g!==0;let E=0;const b=new ReadableStream({start(x){T();function T(){C.read().then(({done:_,value:w})=>{if(_)x.close();else{E+=w.byteLength;const S=new ProgressEvent("progress",{lengthComputable:u,loaded:E,total:g});for(let L=0,P=f.length;L<P;L++){const D=f[L];D.onProgress&&D.onProgress(S)}x.enqueue(w),T()}})}}});return new Response(b)}else throw new kM(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(M){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(f=>new DOMParser().parseFromString(f,m));case"json":return h.json();default:if(m===void 0)return h.text();{const C=/charset="?([^;"\s]*)"?/i.exec(m),p=C&&C[1]?C[1].toLowerCase():void 0,g=new TextDecoder(p);return h.arrayBuffer().then(u=>g.decode(u))}}}).then(h=>{_d.add(t,h);const f=Go[t];delete Go[t];for(let C=0,p=f.length;C<p;C++){const g=f[C];g.onLoad&&g.onLoad(h)}}).catch(h=>{const f=Go[t];if(f===void 0)throw this.manager.itemError(t),h;delete Go[t];for(let C=0,p=f.length;C<p;C++){const g=f[C];g.onError&&g.onError(h)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class GM extends el{constructor(t){super(t)}load(t,r,o,c){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const A=this,B=_d.get(t);if(B!==void 0)return A.manager.itemStart(t),setTimeout(function(){r&&r(B),A.manager.itemEnd(t)},0),B;const m=bA("img");function M(){f(),_d.add(t,this),r&&r(this),A.manager.itemEnd(t)}function h(C){f(),c&&c(C),A.manager.itemError(t),A.manager.itemEnd(t)}function f(){m.removeEventListener("load",M,!1),m.removeEventListener("error",h,!1)}return m.addEventListener("load",M,!1),m.addEventListener("error",h,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(m.crossOrigin=this.crossOrigin),A.manager.itemStart(t),m.src=t,m}}class VM extends el{constructor(t){super(t)}load(t,r,o,c){const A=new Os,B=new GM(this.manager);return B.setCrossOrigin(this.crossOrigin),B.setPath(this.path),B.load(t,function(m){A.image=m,A.needsUpdate=!0,r!==void 0&&r(A)},o,c),A}}class Rd extends Ar{constructor(t,r=1){super(),this.isLight=!0,this.type="Light",this.color=new Sr(t),this.intensity=r}dispose(){}copy(t,r){return super.copy(t,r),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const r=super.toJSON(t);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,this.groundColor!==void 0&&(r.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(r.object.distance=this.distance),this.angle!==void 0&&(r.object.angle=this.angle),this.decay!==void 0&&(r.object.decay=this.decay),this.penumbra!==void 0&&(r.object.penumbra=this.penumbra),this.shadow!==void 0&&(r.object.shadow=this.shadow.toJSON()),r}}const uA=new Gi,Pv=new it,Ov=new it;class kA{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new pr(512,512),this.map=null,this.mapPass=null,this.matrix=new Gi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tM,this._frameExtents=new pr(1,1),this._viewportCount=1,this._viewports=[new rs(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const r=this.camera,o=this.matrix;Pv.setFromMatrixPosition(t.matrixWorld),r.position.copy(Pv),Ov.setFromMatrixPosition(t.target.matrixWorld),r.lookAt(Ov),r.updateMatrixWorld(),uA.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(uA),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(uA)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class zM extends kA{constructor(){super(new PA(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const r=this.camera,o=oh*2*t.angle*this.focus,c=this.mapSize.width/this.mapSize.height,A=t.distance||r.far;(o!==r.fov||c!==r.aspect||A!==r.far)&&(r.fov=o,r.aspect=c,r.far=A,r.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class QM extends Rd{constructor(t,r,o=0,c=Math.PI/3,A=0,B=2){super(t,r),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ar.DEFAULT_UP),this.updateMatrix(),this.target=new Ar,this.distance=o,this.angle=c,this.penumbra=A,this.decay=B,this.map=null,this.shadow=new zM}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,r){return super.copy(t,r),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const Fv=new Gi,Jc=new it,dA=new it;class HM extends kA{constructor(){super(new PA(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new pr(4,2),this._viewportCount=6,this._viewports=[new rs(2,1,1,1),new rs(0,1,1,1),new rs(3,1,1,1),new rs(1,1,1,1),new rs(3,0,1,1),new rs(1,0,1,1)],this._cubeDirections=[new it(1,0,0),new it(-1,0,0),new it(0,0,1),new it(0,0,-1),new it(0,1,0),new it(0,-1,0)],this._cubeUps=[new it(0,1,0),new it(0,1,0),new it(0,1,0),new it(0,1,0),new it(0,0,1),new it(0,0,-1)]}updateMatrices(t,r=0){const o=this.camera,c=this.matrix,A=t.distance||o.far;A!==o.far&&(o.far=A,o.updateProjectionMatrix()),Jc.setFromMatrixPosition(t.matrixWorld),o.position.copy(Jc),dA.copy(o.position),dA.add(this._cubeDirections[r]),o.up.copy(this._cubeUps[r]),o.lookAt(dA),o.updateMatrixWorld(),c.makeTranslation(-Jc.x,-Jc.y,-Jc.z),Fv.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Fv)}}class Nv extends Rd{constructor(t,r,o=0,c=2){super(t,r),this.isPointLight=!0,this.type="PointLight",this.distance=o,this.decay=c,this.shadow=new HM}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,r){return super.copy(t,r),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class jM extends kA{constructor(){super(new Zv(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class WM extends Rd{constructor(t,r){super(t,r),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ar.DEFAULT_UP),this.updateMatrix(),this.target=new Ar,this.shadow=new jM}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class KM extends Rd{constructor(t,r){super(t,r),this.isAmbientLight=!0,this.type="AmbientLight"}}class XM{static decodeText(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);let r="";for(let o=0,c=t.length;o<c;o++)r+=String.fromCharCode(t[o]);try{return decodeURIComponent(escape(r))}catch{return r}}static extractUrlBase(t){const r=t.lastIndexOf("/");return r===-1?"./":t.slice(0,r+1)}static resolveURL(t,r){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(r)&&/^\//.test(t)&&(r=r.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:r+t)}}const UA="\\[\\]\\.:\\/",YM=new RegExp("["+UA+"]","g"),GA="[^"+UA+"]",qM="[^"+UA.replace("\\.","")+"]",JM=/((?:WC+[\/:])*)/.source.replace("WC",GA),ZM=/(WCOD+)?/.source.replace("WCOD",qM),$M=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",GA),e_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",GA),t_=new RegExp("^"+JM+ZM+$M+e_+"$"),i_=["material","materials","bones","map"];class n_{constructor(t,r,o){const c=o||On.parseTrackName(r);this._targetGroup=t,this._bindings=t.subscribe_(r,c)}getValue(t,r){this.bind();const o=this._targetGroup.nCachedObjects_,c=this._bindings[o];c!==void 0&&c.getValue(t,r)}setValue(t,r){const o=this._bindings;for(let c=this._targetGroup.nCachedObjects_,A=o.length;c!==A;++c)o[c].setValue(t,r)}bind(){const t=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=t.length;r!==o;++r)t[r].bind()}unbind(){const t=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=t.length;r!==o;++r)t[r].unbind()}}class On{constructor(t,r,o){this.path=r,this.parsedPath=o||On.parseTrackName(r),this.node=On.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,r,o){return t&&t.isAnimationObjectGroup?new On.Composite(t,r,o):new On(t,r,o)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(YM,"")}static parseTrackName(t){const r=t_.exec(t);if(r===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const o={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},c=o.nodeName&&o.nodeName.lastIndexOf(".");if(c!==void 0&&c!==-1){const A=o.nodeName.substring(c+1);i_.indexOf(A)!==-1&&(o.nodeName=o.nodeName.substring(0,c),o.objectName=A)}if(o.propertyName===null||o.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return o}static findNode(t,r){if(r===void 0||r===""||r==="."||r===-1||r===t.name||r===t.uuid)return t;if(t.skeleton){const o=t.skeleton.getBoneByName(r);if(o!==void 0)return o}if(t.children){const o=function(A){for(let B=0;B<A.length;B++){const m=A[B];if(m.name===r||m.uuid===r)return m;const M=o(m.children);if(M)return M}return null},c=o(t.children);if(c)return c}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,r){t[r]=this.targetObject[this.propertyName]}_getValue_array(t,r){const o=this.resolvedProperty;for(let c=0,A=o.length;c!==A;++c)t[r++]=o[c]}_getValue_arrayElement(t,r){t[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,r){this.resolvedProperty.toArray(t,r)}_setValue_direct(t,r){this.targetObject[this.propertyName]=t[r]}_setValue_direct_setNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,r){const o=this.resolvedProperty;for(let c=0,A=o.length;c!==A;++c)o[c]=t[r++]}_setValue_array_setNeedsUpdate(t,r){const o=this.resolvedProperty;for(let c=0,A=o.length;c!==A;++c)o[c]=t[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,r){const o=this.resolvedProperty;for(let c=0,A=o.length;c!==A;++c)o[c]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,r){this.resolvedProperty[this.propertyIndex]=t[r]}_setValue_arrayElement_setNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,r){this.resolvedProperty.fromArray(t,r)}_setValue_fromArray_setNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,r){this.bind(),this.getValue(t,r)}_setValue_unbound(t,r){this.bind(),this.setValue(t,r)}bind(){let t=this.node;const r=this.parsedPath,o=r.objectName,c=r.propertyName;let A=r.propertyIndex;if(t||(t=On.findNode(this.rootNode,r.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(o){let h=r.objectIndex;switch(o){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let f=0;f<t.length;f++)if(t[f].name===h){h=f;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[o]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[o]}if(h!==void 0){if(t[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[h]}}const B=t[c];if(B===void 0){const h=r.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+c+" but it wasn't found.",t);return}let m=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?m=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(m=this.Versioning.MatrixWorldNeedsUpdate);let M=this.BindingType.Direct;if(A!==void 0){if(c==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[A]!==void 0&&(A=t.morphTargetDictionary[A])}M=this.BindingType.ArrayElement,this.resolvedProperty=B,this.propertyIndex=A}else B.fromArray!==void 0&&B.toArray!==void 0?(M=this.BindingType.HasFromToArray,this.resolvedProperty=B):Array.isArray(B)?(M=this.BindingType.EntireArray,this.resolvedProperty=B):this.propertyName=c;this.getValue=this.GetterByBindingType[M],this.setValue=this.SetterByBindingTypeAndVersioning[M][m]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}On.Composite=n_;On.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};On.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};On.prototype.GetterByBindingType=[On.prototype._getValue_direct,On.prototype._getValue_array,On.prototype._getValue_arrayElement,On.prototype._getValue_toArray];On.prototype.SetterByBindingTypeAndVersioning=[[On.prototype._setValue_direct,On.prototype._setValue_direct_setNeedsUpdate,On.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[On.prototype._setValue_array,On.prototype._setValue_array_setNeedsUpdate,On.prototype._setValue_array_setMatrixWorldNeedsUpdate],[On.prototype._setValue_arrayElement,On.prototype._setValue_arrayElement_setNeedsUpdate,On.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[On.prototype._setValue_fromArray,On.prototype._setValue_fromArray_setNeedsUpdate,On.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:zv}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=zv);/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var Qs=Uint8Array,ic=Uint16Array,r_=Int32Array,sy=new Qs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),oy=new Qs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s_=new Qs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ay=function(y,t){for(var r=new ic(31),o=0;o<31;++o)r[o]=t+=1<<y[o-1];for(var c=new r_(r[30]),o=1;o<30;++o)for(var A=r[o];A<r[o+1];++A)c[A]=A-r[o]<<5|o;return{b:r,r:c}},ly=ay(sy,2),cy=ly.b,o_=ly.r;cy[28]=258,o_[258]=28;var a_=ay(oy,0),l_=a_.b,SA=new ic(32768);for(var nr=0;nr<32768;++nr){var fa=(nr&43690)>>1|(nr&21845)<<1;fa=(fa&52428)>>2|(fa&13107)<<2,fa=(fa&61680)>>4|(fa&3855)<<4,SA[nr]=((fa&65280)>>8|(fa&255)<<8)>>1}var rh=function(y,t,r){for(var o=y.length,c=0,A=new ic(t);c<o;++c)y[c]&&++A[y[c]-1];var B=new ic(t);for(c=1;c<t;++c)B[c]=B[c-1]+A[c-1]<<1;var m;if(r){m=new ic(1<<t);var M=15-t;for(c=0;c<o;++c)if(y[c])for(var h=c<<4|y[c],f=t-y[c],C=B[y[c]-1]++<<f,p=C|(1<<f)-1;C<=p;++C)m[SA[C]>>M]=h}else for(m=new ic(o),c=0;c<o;++c)y[c]&&(m[c]=SA[B[y[c]-1]++]>>15-y[c]);return m},dh=new Qs(288);for(var nr=0;nr<144;++nr)dh[nr]=8;for(var nr=144;nr<256;++nr)dh[nr]=9;for(var nr=256;nr<280;++nr)dh[nr]=7;for(var nr=280;nr<288;++nr)dh[nr]=8;var hy=new Qs(32);for(var nr=0;nr<32;++nr)hy[nr]=5;var c_=rh(dh,9,1),h_=rh(hy,5,1),fA=function(y){for(var t=y[0],r=1;r<y.length;++r)y[r]>t&&(t=y[r]);return t},io=function(y,t,r){var o=t/8|0;return(y[o]|y[o+1]<<8)>>(t&7)&r},pA=function(y,t){var r=t/8|0;return(y[r]|y[r+1]<<8|y[r+2]<<16)>>(t&7)},u_=function(y){return(y+7)/8|0},d_=function(y,t,r){return(r==null||r>y.length)&&(r=y.length),new Qs(y.subarray(t,r))},f_=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],no=function(y,t,r){var o=new Error(t||f_[y]);if(o.code=y,Error.captureStackTrace&&Error.captureStackTrace(o,no),!r)throw o;return o},p_=function(y,t,r,o){var c=y.length,A=0;if(!c||t.f&&!t.l)return r||new Qs(0);var B=!r,m=B||t.i!=2,M=t.i;B&&(r=new Qs(c*3));var h=function(Vt){var Yt=r.length;if(Vt>Yt){var gi=new Qs(Math.max(Yt*2,Vt));gi.set(r),r=gi}},f=t.f||0,C=t.p||0,p=t.b||0,g=t.l,u=t.d,E=t.m,b=t.n,x=c*8;do{if(!g){f=io(y,C,1);var T=io(y,C+1,3);if(C+=3,T)if(T==1)g=c_,u=h_,E=9,b=5;else if(T==2){var L=io(y,C,31)+257,P=io(y,C+10,15)+4,D=L+io(y,C+5,31)+1;C+=14;for(var U=new Qs(D),F=new Qs(19),j=0;j<P;++j)F[s_[j]]=io(y,C+j*3,7);C+=P*3;for(var Y=fA(F),oe=(1<<Y)-1,te=rh(F,Y,1),j=0;j<D;){var pe=te[io(y,C,oe)];C+=pe&15;var _=pe>>4;if(_<16)U[j++]=_;else{var de=0,se=0;for(_==16?(se=3+io(y,C,3),C+=2,de=U[j-1]):_==17?(se=3+io(y,C,7),C+=3):_==18&&(se=11+io(y,C,127),C+=7);se--;)U[j++]=de}}var J=U.subarray(0,L),H=U.subarray(L);E=fA(J),b=fA(H),g=rh(J,E,1),u=rh(H,b,1)}else no(1);else{var _=u_(C)+4,w=y[_-4]|y[_-3]<<8,S=_+w;if(S>c){M&&no(0);break}m&&h(p+w),r.set(y.subarray(_,S),p),t.b=p+=w,t.p=C=S*8,t.f=f;continue}if(C>x){M&&no(0);break}}m&&h(p+131072);for(var ae=(1<<E)-1,ue=(1<<b)-1,Me=C;;Me=C){var de=g[pA(y,C)&ae],De=de>>4;if(C+=de&15,C>x){M&&no(0);break}if(de||no(2),De<256)r[p++]=De;else if(De==256){Me=C,g=null;break}else{var Ge=De-254;if(De>264){var j=De-257,Xe=sy[j];Ge=io(y,C,(1<<Xe)-1)+cy[j],C+=Xe}var Je=u[pA(y,C)&ue],pt=Je>>4;Je||no(3),C+=Je&15;var H=l_[pt];if(pt>3){var Xe=oy[pt];H+=pA(y,C)&(1<<Xe)-1,C+=Xe}if(C>x){M&&no(0);break}m&&h(p+131072);var yt=p+Ge;if(p<H){var Gt=A-H,Et=Math.min(H,yt);for(Gt+p<0&&no(3);p<Et;++p)r[p]=o[Gt+p]}for(;p<yt;++p)r[p]=r[p-H]}}t.l=g,t.p=Me,t.b=p,t.f=f,g&&(f=1,t.m=E,t.d=u,t.n=b)}while(!f);return p!=r.length&&B?d_(r,0,p):r.subarray(0,p)},A_=new Qs(0),m_=function(y,t){return((y[0]&15)!=8||y[0]>>4>7||(y[0]<<8|y[1])%31)&&no(6,"invalid zlib data"),(y[1]>>5&1)==+!t&&no(6,"invalid zlib data: "+(y[1]&32?"need":"unexpected")+" dictionary"),(y[1]>>3&4)+2};function g_(y,t){return p_(y.subarray(m_(y,t),-4),{i:2},t,t)}var v_=typeof TextDecoder<"u"&&new TextDecoder,y_=0;try{v_.decode(A_,{stream:!0}),y_=1}catch{}function uy(y,t,r){const o=r.length-y-1;if(t>=r[o])return o-1;if(t<=r[y])return y;let c=y,A=o,B=Math.floor((c+A)/2);for(;t<r[B]||t>=r[B+1];)t<r[B]?A=B:c=B,B=Math.floor((c+A)/2);return B}function E_(y,t,r,o){const c=[],A=[],B=[];c[0]=1;for(let m=1;m<=r;++m){A[m]=t-o[y+1-m],B[m]=o[y+m]-t;let M=0;for(let h=0;h<m;++h){const f=B[h+1],C=A[m-h],p=c[h]/(f+C);c[h]=M+f*p,M=C*p}c[m]=M}return c}function x_(y,t,r,o){const c=uy(y,o,t),A=E_(c,o,y,t),B=new rs(0,0,0,0);for(let m=0;m<=y;++m){const M=r[c-y+m],h=A[m],f=M.w*h;B.x+=M.x*f,B.y+=M.y*f,B.z+=M.z*f,B.w+=M.w*h}return B}function C_(y,t,r,o,c){const A=[];for(let C=0;C<=r;++C)A[C]=0;const B=[];for(let C=0;C<=o;++C)B[C]=A.slice(0);const m=[];for(let C=0;C<=r;++C)m[C]=A.slice(0);m[0][0]=1;const M=A.slice(0),h=A.slice(0);for(let C=1;C<=r;++C){M[C]=t-c[y+1-C],h[C]=c[y+C]-t;let p=0;for(let g=0;g<C;++g){const u=h[g+1],E=M[C-g];m[C][g]=u+E;const b=m[g][C-1]/m[C][g];m[g][C]=p+u*b,p=E*b}m[C][C]=p}for(let C=0;C<=r;++C)B[0][C]=m[C][r];for(let C=0;C<=r;++C){let p=0,g=1;const u=[];for(let E=0;E<=r;++E)u[E]=A.slice(0);u[0][0]=1;for(let E=1;E<=o;++E){let b=0;const x=C-E,T=r-E;C>=E&&(u[g][0]=u[p][0]/m[T+1][x],b=u[g][0]*m[x][T]);const _=x>=-1?1:-x,w=C-1<=T?E-1:r-C;for(let L=_;L<=w;++L)u[g][L]=(u[p][L]-u[p][L-1])/m[T+1][x+L],b+=u[g][L]*m[x+L][T];C<=T&&(u[g][E]=-u[p][E-1]/m[T+1][C],b+=u[g][E]*m[C][T]),B[E][C]=b;const S=p;p=g,g=S}}let f=r;for(let C=1;C<=o;++C){for(let p=0;p<=r;++p)B[C][p]*=f;f*=r-C}return B}function b_(y,t,r,o,c){const A=c<y?c:y,B=[],m=uy(y,o,t),M=C_(m,o,y,A,t),h=[];for(let f=0;f<r.length;++f){const C=r[f].clone(),p=C.w;C.x*=p,C.y*=p,C.z*=p,h[f]=C}for(let f=0;f<=A;++f){const C=h[m-y].clone().multiplyScalar(M[f][0]);for(let p=1;p<=y;++p)C.add(h[m-y+p].clone().multiplyScalar(M[f][p]));B[f]=C}for(let f=A+1;f<=c+1;++f)B[f]=new rs(0,0,0);return B}function w_(y,t){let r=1;for(let c=2;c<=y;++c)r*=c;let o=1;for(let c=2;c<=t;++c)o*=c;for(let c=2;c<=y-t;++c)o*=c;return r/o}function M_(y){const t=y.length,r=[],o=[];for(let A=0;A<t;++A){const B=y[A];r[A]=new it(B.x,B.y,B.z),o[A]=B.w}const c=[];for(let A=0;A<t;++A){const B=r[A].clone();for(let m=1;m<=A;++m)B.sub(c[A-m].clone().multiplyScalar(w_(A,m)*o[m]));c[A]=B.divideScalar(o[0])}return c}function __(y,t,r,o,c){const A=b_(y,t,r,o,c);return M_(A)}class S_ extends lM{constructor(t,r,o,c,A){super(),this.degree=t,this.knots=r,this.controlPoints=[],this.startKnot=c||0,this.endKnot=A||this.knots.length-1;for(let B=0;B<o.length;++B){const m=o[B];this.controlPoints[B]=new rs(m.x,m.y,m.z,m.w)}}getPoint(t,r=new it){const o=r,c=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),A=x_(this.degree,this.knots,this.controlPoints,c);return A.w!==1&&A.divideScalar(A.w),o.set(A.x,A.y,A.z)}getTangent(t,r=new it){const o=r,c=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),A=__(this.degree,this.knots,this.controlPoints,c,1);return o.copy(A[1]).normalize(),o}}let fn,yr,ps;class T_ extends el{constructor(t){super(t)}load(t,r,o,c){const A=this,B=A.path===""?XM.extractUrlBase(t):A.path,m=new UM(this.manager);m.setPath(A.path),m.setResponseType("arraybuffer"),m.setRequestHeader(A.requestHeader),m.setWithCredentials(A.withCredentials),m.load(t,function(M){try{r(A.parse(M,B))}catch(h){c?c(h):console.error(h),A.manager.itemError(t)}},o,c)}parse(t,r){if(P_(t))fn=new D_().parse(t);else{const c=Ay(t);if(!O_(c))throw new Error("THREE.FBXLoader: Unknown format.");if(Uv(c)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Uv(c));fn=new L_().parse(c)}const o=new VM(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin);return new I_(o,this.manager).parse(fn)}}class I_{constructor(t,r){this.textureLoader=t,this.manager=r}parse(){yr=this.parseConnections();const t=this.parseImages(),r=this.parseTextures(t),o=this.parseMaterials(r),c=this.parseDeformers(),A=new B_().parse(c);return this.parseScene(c,A,o),ps}parseConnections(){const t=new Map;return"Connections"in fn&&fn.Connections.connections.forEach(function(o){const c=o[0],A=o[1],B=o[2];t.has(c)||t.set(c,{parents:[],children:[]});const m={ID:A,relationship:B};t.get(c).parents.push(m),t.has(A)||t.set(A,{parents:[],children:[]});const M={ID:c,relationship:B};t.get(A).children.push(M)}),t}parseImages(){const t={},r={};if("Video"in fn.Objects){const o=fn.Objects.Video;for(const c in o){const A=o[c],B=parseInt(c);if(t[B]=A.RelativeFilename||A.Filename,"Content"in A){const m=A.Content instanceof ArrayBuffer&&A.Content.byteLength>0,M=typeof A.Content=="string"&&A.Content!=="";if(m||M){const h=this.parseImage(o[c]);r[A.RelativeFilename||A.Filename]=h}}}}for(const o in t){const c=t[o];r[c]!==void 0?t[o]=r[c]:t[o]=t[o].split("\\").pop()}return t}parseImage(t){const r=t.Content,o=t.RelativeFilename||t.Filename,c=o.slice(o.lastIndexOf(".")+1).toLowerCase();let A;switch(c){case"bmp":A="image/bmp";break;case"jpg":case"jpeg":A="image/jpeg";break;case"png":A="image/png";break;case"tif":A="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",o),A="image/tga";break;default:console.warn('FBXLoader: Image type "'+c+'" is not supported.');return}if(typeof r=="string")return"data:"+A+";base64,"+r;{const B=new Uint8Array(r);return window.URL.createObjectURL(new Blob([B],{type:A}))}}parseTextures(t){const r=new Map;if("Texture"in fn.Objects){const o=fn.Objects.Texture;for(const c in o){const A=this.parseTexture(o[c],t);r.set(parseInt(c),A)}}return r}parseTexture(t,r){const o=this.loadTexture(t,r);o.ID=t.id,o.name=t.attrName;const c=t.WrapModeU,A=t.WrapModeV,B=c!==void 0?c.value:0,m=A!==void 0?A.value:0;if(o.wrapS=B===0?yd:ec,o.wrapT=m===0?yd:ec,"Scaling"in t){const M=t.Scaling.value;o.repeat.x=M[0],o.repeat.y=M[1]}if("Translation"in t){const M=t.Translation.value;o.offset.x=M[0],o.offset.y=M[1]}return o}loadTexture(t,r){let o;const c=this.textureLoader.path,A=yr.get(t.id).children;A!==void 0&&A.length>0&&r[A[0].ID]!==void 0&&(o=r[A[0].ID],(o.indexOf("blob:")===0||o.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let B;const m=t.FileName.slice(-3).toLowerCase();if(m==="tga"){const M=this.manager.getHandler(".tga");M===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),B=new Os):(M.setPath(this.textureLoader.path),B=M.load(o))}else if(m==="dds"){const M=this.manager.getHandler(".dds");M===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",t.RelativeFilename),B=new Os):(M.setPath(this.textureLoader.path),B=M.load(o))}else m==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),B=new Os):B=this.textureLoader.load(o);return this.textureLoader.setPath(c),B}parseMaterials(t){const r=new Map;if("Material"in fn.Objects){const o=fn.Objects.Material;for(const c in o){const A=this.parseMaterial(o[c],t);A!==null&&r.set(parseInt(c),A)}}return r}parseMaterial(t,r){const o=t.id,c=t.attrName;let A=t.ShadingModel;if(typeof A=="object"&&(A=A.value),!yr.has(o))return null;const B=this.parseParameters(t,r,o);let m;switch(A.toLowerCase()){case"phong":m=new hA;break;case"lambert":m=new _M;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',A),m=new hA;break}return m.setValues(B),m.name=c,m}parseParameters(t,r,o){const c={};t.BumpFactor&&(c.bumpScale=t.BumpFactor.value),t.Diffuse?c.color=new Sr().fromArray(t.Diffuse.value).convertSRGBToLinear():t.DiffuseColor&&(t.DiffuseColor.type==="Color"||t.DiffuseColor.type==="ColorRGB")&&(c.color=new Sr().fromArray(t.DiffuseColor.value).convertSRGBToLinear()),t.DisplacementFactor&&(c.displacementScale=t.DisplacementFactor.value),t.Emissive?c.emissive=new Sr().fromArray(t.Emissive.value).convertSRGBToLinear():t.EmissiveColor&&(t.EmissiveColor.type==="Color"||t.EmissiveColor.type==="ColorRGB")&&(c.emissive=new Sr().fromArray(t.EmissiveColor.value).convertSRGBToLinear()),t.EmissiveFactor&&(c.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(c.opacity=parseFloat(t.Opacity.value)),c.opacity<1&&(c.transparent=!0),t.ReflectionFactor&&(c.reflectivity=t.ReflectionFactor.value),t.Shininess&&(c.shininess=t.Shininess.value),t.Specular?c.specular=new Sr().fromArray(t.Specular.value).convertSRGBToLinear():t.SpecularColor&&t.SpecularColor.type==="Color"&&(c.specular=new Sr().fromArray(t.SpecularColor.value).convertSRGBToLinear());const A=this;return yr.get(o).children.forEach(function(B){const m=B.relationship;switch(m){case"Bump":c.bumpMap=A.getTexture(r,B.ID);break;case"Maya|TEX_ao_map":c.aoMap=A.getTexture(r,B.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":c.map=A.getTexture(r,B.ID),c.map!==void 0&&(c.map.colorSpace=zs);break;case"DisplacementColor":c.displacementMap=A.getTexture(r,B.ID);break;case"EmissiveColor":c.emissiveMap=A.getTexture(r,B.ID),c.emissiveMap!==void 0&&(c.emissiveMap.colorSpace=zs);break;case"NormalMap":case"Maya|TEX_normal_map":c.normalMap=A.getTexture(r,B.ID);break;case"ReflectionColor":c.envMap=A.getTexture(r,B.ID),c.envMap!==void 0&&(c.envMap.mapping=cw,c.envMap.colorSpace=zs);break;case"SpecularColor":c.specularMap=A.getTexture(r,B.ID),c.specularMap!==void 0&&(c.specularMap.colorSpace=zs);break;case"TransparentColor":case"TransparencyFactor":c.alphaMap=A.getTexture(r,B.ID),c.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",m);break}}),c}getTexture(t,r){return"LayeredTexture"in fn.Objects&&r in fn.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),r=yr.get(r).children[0].ID),t.get(r)}parseDeformers(){const t={},r={};if("Deformer"in fn.Objects){const o=fn.Objects.Deformer;for(const c in o){const A=o[c],B=yr.get(parseInt(c));if(A.attrType==="Skin"){const m=this.parseSkeleton(B,o);m.ID=c,B.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),m.geometryID=B.parents[0].ID,t[c]=m}else if(A.attrType==="BlendShape"){const m={id:c};m.rawTargets=this.parseMorphTargets(B,o),m.id=c,B.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),r[c]=m}}}return{skeletons:t,morphTargets:r}}parseSkeleton(t,r){const o=[];return t.children.forEach(function(c){const A=r[c.ID];if(A.attrType!=="Cluster")return;const B={ID:c.ID,indices:[],weights:[],transformLink:new Gi().fromArray(A.TransformLink.a)};"Indexes"in A&&(B.indices=A.Indexes.a,B.weights=A.Weights.a),o.push(B)}),{rawBones:o,bones:[]}}parseMorphTargets(t,r){const o=[];for(let c=0;c<t.children.length;c++){const A=t.children[c],B=r[A.ID],m={name:B.attrName,initialWeight:B.DeformPercent,id:B.id,fullWeights:B.FullWeights.a};if(B.attrType!=="BlendShapeChannel")return;m.geoID=yr.get(parseInt(A.ID)).children.filter(function(M){return M.relationship===void 0})[0].ID,o.push(m)}return o}parseScene(t,r,o){ps=new xv;const c=this.parseModels(t.skeletons,r,o),A=fn.Objects.Model,B=this;c.forEach(function(M){const h=A[M.ID];B.setLookAtProperties(M,h),yr.get(M.ID).parents.forEach(function(C){const p=c.get(C.ID);p!==void 0&&p.add(M)}),M.parent===null&&ps.add(M)}),this.bindSkeleton(t.skeletons,r,c),this.addGlobalSceneSettings(),ps.traverse(function(M){if(M.userData.transformData){M.parent&&(M.userData.transformData.parentMatrix=M.parent.matrix,M.userData.transformData.parentMatrixWorld=M.parent.matrixWorld);const h=fy(M.userData.transformData);M.applyMatrix4(h),M.updateWorldMatrix()}});const m=new R_().parse();ps.children.length===1&&ps.children[0].isGroup&&(ps.children[0].animations=m,ps=ps.children[0]),ps.animations=m}parseModels(t,r,o){const c=new Map,A=fn.Objects.Model;for(const B in A){const m=parseInt(B),M=A[B],h=yr.get(m);let f=this.buildSkeleton(h,t,m,M.attrName);if(!f){switch(M.attrType){case"Camera":f=this.createCamera(h);break;case"Light":f=this.createLight(h);break;case"Mesh":f=this.createMesh(h,r,o);break;case"NurbsCurve":f=this.createCurve(h,r);break;case"LimbNode":case"Root":f=new wA;break;case"Null":default:f=new xv;break}f.name=M.attrName?On.sanitizeNodeName(M.attrName):"",f.userData.originalName=M.attrName,f.ID=m}this.getTransformData(f,M),c.set(m,f)}return c}buildSkeleton(t,r,o,c){let A=null;return t.parents.forEach(function(B){for(const m in r){const M=r[m];M.rawBones.forEach(function(h,f){if(h.ID===B.ID){const C=A;A=new wA,A.matrixWorld.copy(h.transformLink),A.name=c?On.sanitizeNodeName(c):"",A.userData.originalName=c,A.ID=o,M.bones[f]=A,C!==null&&A.add(C)}})}}),A}createCamera(t){let r,o;if(t.children.forEach(function(c){const A=fn.Objects.NodeAttribute[c.ID];A!==void 0&&(o=A)}),o===void 0)r=new Ar;else{let c=0;o.CameraProjectionType!==void 0&&o.CameraProjectionType.value===1&&(c=1);let A=1;o.NearPlane!==void 0&&(A=o.NearPlane.value/1e3);let B=1e3;o.FarPlane!==void 0&&(B=o.FarPlane.value/1e3);let m=window.innerWidth,M=window.innerHeight;o.AspectWidth!==void 0&&o.AspectHeight!==void 0&&(m=o.AspectWidth.value,M=o.AspectHeight.value);const h=m/M;let f=45;o.FieldOfView!==void 0&&(f=o.FieldOfView.value);const C=o.FocalLength?o.FocalLength.value:null;switch(c){case 0:r=new PA(f,h,A,B),C!==null&&r.setFocalLength(C);break;case 1:r=new Zv(-m/2,m/2,M/2,-M/2,A,B);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+c+"."),r=new Ar;break}}return r}createLight(t){let r,o;if(t.children.forEach(function(c){const A=fn.Objects.NodeAttribute[c.ID];A!==void 0&&(o=A)}),o===void 0)r=new Ar;else{let c;o.LightType===void 0?c=0:c=o.LightType.value;let A=16777215;o.Color!==void 0&&(A=new Sr().fromArray(o.Color.value).convertSRGBToLinear());let B=o.Intensity===void 0?1:o.Intensity.value/100;o.CastLightOnObject!==void 0&&o.CastLightOnObject.value===0&&(B=0);let m=0;o.FarAttenuationEnd!==void 0&&(o.EnableFarAttenuation!==void 0&&o.EnableFarAttenuation.value===0?m=0:m=o.FarAttenuationEnd.value);const M=1;switch(c){case 0:r=new Nv(A,B,m,M);break;case 1:r=new WM(A,B);break;case 2:let h=Math.PI/3;o.InnerAngle!==void 0&&(h=As.degToRad(o.InnerAngle.value));let f=0;o.OuterAngle!==void 0&&(f=As.degToRad(o.OuterAngle.value),f=Math.max(f,1)),r=new QM(A,B,m,h,f,M);break;default:console.warn("THREE.FBXLoader: Unknown light type "+o.LightType.value+", defaulting to a PointLight."),r=new Nv(A,B);break}o.CastShadows!==void 0&&o.CastShadows.value===1&&(r.castShadow=!0)}return r}createMesh(t,r,o){let c,A=null,B=null;const m=[];return t.children.forEach(function(M){r.has(M.ID)&&(A=r.get(M.ID)),o.has(M.ID)&&m.push(o.get(M.ID))}),m.length>1?B=m:m.length>0?B=m[0]:(B=new hA({name:el.DEFAULT_MATERIAL_NAME,color:13421772}),m.push(B)),"color"in A.attributes&&m.forEach(function(M){M.vertexColors=!0}),A.FBX_Deformer?(c=new sM(A,B),c.normalizeSkinWeights()):c=new qa(A,B),c}createCurve(t,r){const o=t.children.reduce(function(A,B){return r.has(B.ID)&&(A=r.get(B.ID)),A},null),c=new FA({name:el.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new $v(o,c)}getTransformData(t,r){const o={};"InheritType"in r&&(o.inheritType=parseInt(r.InheritType.value)),"RotationOrder"in r?o.eulerOrder=py(r.RotationOrder.value):o.eulerOrder="ZYX","Lcl_Translation"in r&&(o.translation=r.Lcl_Translation.value),"PreRotation"in r&&(o.preRotation=r.PreRotation.value),"Lcl_Rotation"in r&&(o.rotation=r.Lcl_Rotation.value),"PostRotation"in r&&(o.postRotation=r.PostRotation.value),"Lcl_Scaling"in r&&(o.scale=r.Lcl_Scaling.value),"ScalingOffset"in r&&(o.scalingOffset=r.ScalingOffset.value),"ScalingPivot"in r&&(o.scalingPivot=r.ScalingPivot.value),"RotationOffset"in r&&(o.rotationOffset=r.RotationOffset.value),"RotationPivot"in r&&(o.rotationPivot=r.RotationPivot.value),t.userData.transformData=o}setLookAtProperties(t,r){"LookAtProperty"in r&&yr.get(t.ID).children.forEach(function(c){if(c.relationship==="LookAtProperty"){const A=fn.Objects.Model[c.ID];if("Lcl_Translation"in A){const B=A.Lcl_Translation.value;t.target!==void 0?(t.target.position.fromArray(B),ps.add(t.target)):t.lookAt(new it().fromArray(B))}}})}bindSkeleton(t,r,o){const c=this.parsePoseNodes();for(const A in t){const B=t[A];yr.get(parseInt(B.ID)).parents.forEach(function(M){if(r.has(M.ID)){const h=M.ID;yr.get(h).parents.forEach(function(C){o.has(C.ID)&&o.get(C.ID).bind(new OA(B.bones),c[C.ID])})}})}}parsePoseNodes(){const t={};if("Pose"in fn.Objects){const r=fn.Objects.Pose;for(const o in r)if(r[o].attrType==="BindPose"&&r[o].NbPoseNodes>0){const c=r[o].PoseNode;Array.isArray(c)?c.forEach(function(A){t[A.Node]=new Gi().fromArray(A.Matrix.a)}):t[c.Node]=new Gi().fromArray(c.Matrix.a)}}return t}addGlobalSceneSettings(){if("GlobalSettings"in fn){if("AmbientColor"in fn.GlobalSettings){const t=fn.GlobalSettings.AmbientColor.value,r=t[0],o=t[1],c=t[2];if(r!==0||o!==0||c!==0){const A=new Sr(r,o,c).convertSRGBToLinear();ps.add(new KM(A,1))}}"UnitScaleFactor"in fn.GlobalSettings&&(ps.userData.unitScaleFactor=fn.GlobalSettings.UnitScaleFactor.value)}}}class B_{constructor(){this.negativeMaterialIndices=!1}parse(t){const r=new Map;if("Geometry"in fn.Objects){const o=fn.Objects.Geometry;for(const c in o){const A=yr.get(parseInt(c)),B=this.parseGeometry(A,o[c],t);r.set(parseInt(c),B)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),r}parseGeometry(t,r,o){switch(r.attrType){case"Mesh":return this.parseMeshGeometry(t,r,o);case"NurbsCurve":return this.parseNurbsGeometry(r)}}parseMeshGeometry(t,r,o){const c=o.skeletons,A=[],B=t.parents.map(function(C){return fn.Objects.Model[C.ID]});if(B.length===0)return;const m=t.children.reduce(function(C,p){return c[p.ID]!==void 0&&(C=c[p.ID]),C},null);t.children.forEach(function(C){o.morphTargets[C.ID]!==void 0&&A.push(o.morphTargets[C.ID])});const M=B[0],h={};"RotationOrder"in M&&(h.eulerOrder=py(M.RotationOrder.value)),"InheritType"in M&&(h.inheritType=parseInt(M.InheritType.value)),"GeometricTranslation"in M&&(h.translation=M.GeometricTranslation.value),"GeometricRotation"in M&&(h.rotation=M.GeometricRotation.value),"GeometricScaling"in M&&(h.scale=M.GeometricScaling.value);const f=fy(h);return this.genGeometry(r,m,A,f)}genGeometry(t,r,o,c){const A=new so;t.attrName&&(A.name=t.attrName);const B=this.parseGeoNode(t,r),m=this.genBuffers(B),M=new Ms(m.vertex,3);if(M.applyMatrix4(c),A.setAttribute("position",M),m.colors.length>0&&A.setAttribute("color",new Ms(m.colors,3)),r&&(A.setAttribute("skinIndex",new qv(m.weightsIndices,4)),A.setAttribute("skinWeight",new Ms(m.vertexWeights,4)),A.FBX_Deformer=r),m.normal.length>0){const h=new mo().getNormalMatrix(c),f=new Ms(m.normal,3);f.applyNormalMatrix(h),A.setAttribute("normal",f)}if(m.uvs.forEach(function(h,f){const C=f===0?"uv":`uv${f}`;A.setAttribute(C,new Ms(m.uvs[f],2))}),B.material&&B.material.mappingType!=="AllSame"){let h=m.materialIndex[0],f=0;if(m.materialIndex.forEach(function(C,p){C!==h&&(A.addGroup(f,p-f,h),h=C,f=p)}),A.groups.length>0){const C=A.groups[A.groups.length-1],p=C.start+C.count;p!==m.materialIndex.length&&A.addGroup(p,m.materialIndex.length-p,h)}A.groups.length===0&&A.addGroup(0,m.materialIndex.length,m.materialIndex[0])}return this.addMorphTargets(A,t,o,c),A}parseGeoNode(t,r){const o={};if(o.vertexPositions=t.Vertices!==void 0?t.Vertices.a:[],o.vertexIndices=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(o.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(o.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(o.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){o.uv=[];let c=0;for(;t.LayerElementUV[c];)t.LayerElementUV[c].UV&&o.uv.push(this.parseUVs(t.LayerElementUV[c])),c++}return o.weightTable={},r!==null&&(o.skeleton=r,r.rawBones.forEach(function(c,A){c.indices.forEach(function(B,m){o.weightTable[B]===void 0&&(o.weightTable[B]=[]),o.weightTable[B].push({id:A,weight:c.weights[m]})})})),o}genBuffers(t){const r={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let o=0,c=0,A=!1,B=[],m=[],M=[],h=[],f=[],C=[];const p=this;return t.vertexIndices.forEach(function(g,u){let E,b=!1;g<0&&(g=g^-1,b=!0);let x=[],T=[];if(B.push(g*3,g*3+1,g*3+2),t.color){const _=md(u,o,g,t.color);M.push(_[0],_[1],_[2])}if(t.skeleton){if(t.weightTable[g]!==void 0&&t.weightTable[g].forEach(function(_){T.push(_.weight),x.push(_.id)}),T.length>4){A||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),A=!0);const _=[0,0,0,0],w=[0,0,0,0];T.forEach(function(S,L){let P=S,D=x[L];w.forEach(function(U,F,j){if(P>U){j[F]=P,P=U;const Y=_[F];_[F]=D,D=Y}})}),x=_,T=w}for(;T.length<4;)T.push(0),x.push(0);for(let _=0;_<4;++_)f.push(T[_]),C.push(x[_])}if(t.normal){const _=md(u,o,g,t.normal);m.push(_[0],_[1],_[2])}t.material&&t.material.mappingType!=="AllSame"&&(E=md(u,o,g,t.material)[0],E<0&&(p.negativeMaterialIndices=!0,E=0)),t.uv&&t.uv.forEach(function(_,w){const S=md(u,o,g,_);h[w]===void 0&&(h[w]=[]),h[w].push(S[0]),h[w].push(S[1])}),c++,b&&(p.genFace(r,t,B,E,m,M,h,f,C,c),o++,c=0,B=[],m=[],M=[],h=[],f=[],C=[])}),r}getNormalNewell(t){const r=new it(0,0,0);for(let o=0;o<t.length;o++){const c=t[o],A=t[(o+1)%t.length];r.x+=(c.y-A.y)*(c.z+A.z),r.y+=(c.z-A.z)*(c.x+A.x),r.z+=(c.x-A.x)*(c.y+A.y)}return r.normalize(),r}getNormalTangentAndBitangent(t){const r=this.getNormalNewell(t),c=(Math.abs(r.z)>.5?new it(0,1,0):new it(0,0,1)).cross(r).normalize(),A=r.clone().cross(c).normalize();return{normal:r,tangent:c,bitangent:A}}flattenVertex(t,r,o){return new pr(t.dot(r),t.dot(o))}genFace(t,r,o,c,A,B,m,M,h,f){let C;if(f>3){const p=[];for(let b=0;b<o.length;b+=3)p.push(new it(r.vertexPositions[o[b]],r.vertexPositions[o[b+1]],r.vertexPositions[o[b+2]]));const{tangent:g,bitangent:u}=this.getNormalTangentAndBitangent(p),E=[];for(const b of p)E.push(this.flattenVertex(b,g,u));C=NA.triangulateShape(E,[])}else C=[[0,1,2]];for(const[p,g,u]of C)t.vertex.push(r.vertexPositions[o[p*3]]),t.vertex.push(r.vertexPositions[o[p*3+1]]),t.vertex.push(r.vertexPositions[o[p*3+2]]),t.vertex.push(r.vertexPositions[o[g*3]]),t.vertex.push(r.vertexPositions[o[g*3+1]]),t.vertex.push(r.vertexPositions[o[g*3+2]]),t.vertex.push(r.vertexPositions[o[u*3]]),t.vertex.push(r.vertexPositions[o[u*3+1]]),t.vertex.push(r.vertexPositions[o[u*3+2]]),r.skeleton&&(t.vertexWeights.push(M[p*4]),t.vertexWeights.push(M[p*4+1]),t.vertexWeights.push(M[p*4+2]),t.vertexWeights.push(M[p*4+3]),t.vertexWeights.push(M[g*4]),t.vertexWeights.push(M[g*4+1]),t.vertexWeights.push(M[g*4+2]),t.vertexWeights.push(M[g*4+3]),t.vertexWeights.push(M[u*4]),t.vertexWeights.push(M[u*4+1]),t.vertexWeights.push(M[u*4+2]),t.vertexWeights.push(M[u*4+3]),t.weightsIndices.push(h[p*4]),t.weightsIndices.push(h[p*4+1]),t.weightsIndices.push(h[p*4+2]),t.weightsIndices.push(h[p*4+3]),t.weightsIndices.push(h[g*4]),t.weightsIndices.push(h[g*4+1]),t.weightsIndices.push(h[g*4+2]),t.weightsIndices.push(h[g*4+3]),t.weightsIndices.push(h[u*4]),t.weightsIndices.push(h[u*4+1]),t.weightsIndices.push(h[u*4+2]),t.weightsIndices.push(h[u*4+3])),r.color&&(t.colors.push(B[p*3]),t.colors.push(B[p*3+1]),t.colors.push(B[p*3+2]),t.colors.push(B[g*3]),t.colors.push(B[g*3+1]),t.colors.push(B[g*3+2]),t.colors.push(B[u*3]),t.colors.push(B[u*3+1]),t.colors.push(B[u*3+2])),r.material&&r.material.mappingType!=="AllSame"&&(t.materialIndex.push(c),t.materialIndex.push(c),t.materialIndex.push(c)),r.normal&&(t.normal.push(A[p*3]),t.normal.push(A[p*3+1]),t.normal.push(A[p*3+2]),t.normal.push(A[g*3]),t.normal.push(A[g*3+1]),t.normal.push(A[g*3+2]),t.normal.push(A[u*3]),t.normal.push(A[u*3+1]),t.normal.push(A[u*3+2])),r.uv&&r.uv.forEach(function(E,b){t.uvs[b]===void 0&&(t.uvs[b]=[]),t.uvs[b].push(m[b][p*2]),t.uvs[b].push(m[b][p*2+1]),t.uvs[b].push(m[b][g*2]),t.uvs[b].push(m[b][g*2+1]),t.uvs[b].push(m[b][u*2]),t.uvs[b].push(m[b][u*2+1])})}addMorphTargets(t,r,o,c){if(o.length===0)return;t.morphTargetsRelative=!0,t.morphAttributes.position=[];const A=this;o.forEach(function(B){B.rawTargets.forEach(function(m){const M=fn.Objects.Geometry[m.geoID];M!==void 0&&A.genMorphGeometry(t,r,M,c,m.name)})})}genMorphGeometry(t,r,o,c,A){const B=r.PolygonVertexIndex!==void 0?r.PolygonVertexIndex.a:[],m=o.Vertices!==void 0?o.Vertices.a:[],M=o.Indexes!==void 0?o.Indexes.a:[],h=t.attributes.position.count*3,f=new Float32Array(h);for(let u=0;u<M.length;u++){const E=M[u]*3;f[E]=m[u*3],f[E+1]=m[u*3+1],f[E+2]=m[u*3+2]}const C={vertexIndices:B,vertexPositions:f},p=this.genBuffers(C),g=new Ms(p.vertex,3);g.name=A||o.attrName,g.applyMatrix4(c),t.morphAttributes.position.push(g)}parseNormals(t){const r=t.MappingInformationType,o=t.ReferenceInformationType,c=t.Normals.a;let A=[];return o==="IndexToDirect"&&("NormalIndex"in t?A=t.NormalIndex.a:"NormalsIndex"in t&&(A=t.NormalsIndex.a)),{dataSize:3,buffer:c,indices:A,mappingType:r,referenceType:o}}parseUVs(t){const r=t.MappingInformationType,o=t.ReferenceInformationType,c=t.UV.a;let A=[];return o==="IndexToDirect"&&(A=t.UVIndex.a),{dataSize:2,buffer:c,indices:A,mappingType:r,referenceType:o}}parseVertexColors(t){const r=t.MappingInformationType,o=t.ReferenceInformationType,c=t.Colors.a;let A=[];o==="IndexToDirect"&&(A=t.ColorIndex.a);for(let B=0,m=new Sr;B<c.length;B+=4)m.fromArray(c,B).convertSRGBToLinear().toArray(c,B);return{dataSize:4,buffer:c,indices:A,mappingType:r,referenceType:o}}parseMaterialIndices(t){const r=t.MappingInformationType,o=t.ReferenceInformationType;if(r==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:o};const c=t.Materials.a,A=[];for(let B=0;B<c.length;++B)A.push(B);return{dataSize:1,buffer:c,indices:A,mappingType:r,referenceType:o}}parseNurbsGeometry(t){const r=parseInt(t.Order);if(isNaN(r))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new so;const o=r-1,c=t.KnotVector.a,A=[],B=t.Points.a;for(let C=0,p=B.length;C<p;C+=4)A.push(new rs().fromArray(B,C));let m,M;if(t.Form==="Closed")A.push(A[0]);else if(t.Form==="Periodic"){m=o,M=c.length-1-m;for(let C=0;C<o;++C)A.push(A[C])}const f=new S_(o,c,A,m,M).getPoints(A.length*12);return new so().setFromPoints(f)}}class R_{parse(){const t=[],r=this.parseClips();if(r!==void 0)for(const o in r){const c=r[o],A=this.addClip(c);t.push(A)}return t}parseClips(){if(fn.Objects.AnimationCurve===void 0)return;const t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);const r=this.parseAnimationLayers(t);return this.parseAnimStacks(r)}parseAnimationCurveNodes(){const t=fn.Objects.AnimationCurveNode,r=new Map;for(const o in t){const c=t[o];if(c.attrName.match(/S|R|T|DeformPercent/)!==null){const A={id:c.id,attr:c.attrName,curves:{}};r.set(A.id,A)}}return r}parseAnimationCurves(t){const r=fn.Objects.AnimationCurve;for(const o in r){const c={id:r[o].id,times:r[o].KeyTime.a.map(F_),values:r[o].KeyValueFloat.a},A=yr.get(c.id);if(A!==void 0){const B=A.parents[0].ID,m=A.parents[0].relationship;m.match(/X/)?t.get(B).curves.x=c:m.match(/Y/)?t.get(B).curves.y=c:m.match(/Z/)?t.get(B).curves.z=c:m.match(/DeformPercent/)&&t.has(B)&&(t.get(B).curves.morph=c)}}}parseAnimationLayers(t){const r=fn.Objects.AnimationLayer,o=new Map;for(const c in r){const A=[],B=yr.get(parseInt(c));B!==void 0&&(B.children.forEach(function(M,h){if(t.has(M.ID)){const f=t.get(M.ID);if(f.curves.x!==void 0||f.curves.y!==void 0||f.curves.z!==void 0){if(A[h]===void 0){const C=yr.get(M.ID).parents.filter(function(p){return p.relationship!==void 0})[0].ID;if(C!==void 0){const p=fn.Objects.Model[C.toString()];if(p===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",M);return}const g={modelName:p.attrName?On.sanitizeNodeName(p.attrName):"",ID:p.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};ps.traverse(function(u){u.ID===p.id&&(g.transform=u.matrix,u.userData.transformData&&(g.eulerOrder=u.userData.transformData.eulerOrder))}),g.transform||(g.transform=new Gi),"PreRotation"in p&&(g.preRotation=p.PreRotation.value),"PostRotation"in p&&(g.postRotation=p.PostRotation.value),A[h]=g}}A[h]&&(A[h][f.attr]=f)}else if(f.curves.morph!==void 0){if(A[h]===void 0){const C=yr.get(M.ID).parents.filter(function(x){return x.relationship!==void 0})[0].ID,p=yr.get(C).parents[0].ID,g=yr.get(p).parents[0].ID,u=yr.get(g).parents[0].ID,E=fn.Objects.Model[u],b={modelName:E.attrName?On.sanitizeNodeName(E.attrName):"",morphName:fn.Objects.Deformer[C].attrName};A[h]=b}A[h][f.attr]=f}}}),o.set(parseInt(c),A))}return o}parseAnimStacks(t){const r=fn.Objects.AnimationStack,o={};for(const c in r){const A=yr.get(parseInt(c)).children;A.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const B=t.get(A[0].ID);o[c]={name:r[c].attrName,layer:B}}return o}addClip(t){let r=[];const o=this;return t.layer.forEach(function(c){r=r.concat(o.generateTracks(c))}),new DM(t.name,-1,r)}generateTracks(t){const r=[];let o=new it,c=new it;if(t.transform&&t.transform.decompose(o,new ws,c),o=o.toArray(),c=c.toArray(),t.T!==void 0&&Object.keys(t.T.curves).length>0){const A=this.generateVectorTrack(t.modelName,t.T.curves,o,"position");A!==void 0&&r.push(A)}if(t.R!==void 0&&Object.keys(t.R.curves).length>0){const A=this.generateRotationTrack(t.modelName,t.R.curves,t.preRotation,t.postRotation,t.eulerOrder);A!==void 0&&r.push(A)}if(t.S!==void 0&&Object.keys(t.S.curves).length>0){const A=this.generateVectorTrack(t.modelName,t.S.curves,c,"scale");A!==void 0&&r.push(A)}if(t.DeformPercent!==void 0){const A=this.generateMorphTrack(t);A!==void 0&&r.push(A)}return r}generateVectorTrack(t,r,o,c){const A=this.getTimesForAllAxes(r),B=this.getKeyframeTrackValues(A,r,o);return new uh(t+"."+c,A,B)}generateRotationTrack(t,r,o,c,A){let B,m;if(r.x!==void 0&&r.y!==void 0&&r.z!==void 0){const C=this.interpolateRotations(r.x,r.y,r.z,A);B=C[0],m=C[1]}o!==void 0&&(o=o.map(As.degToRad),o.push(A),o=new Xr().fromArray(o),o=new ws().setFromEuler(o)),c!==void 0&&(c=c.map(As.degToRad),c.push(A),c=new Xr().fromArray(c),c=new ws().setFromEuler(c).invert());const M=new ws,h=new Xr,f=[];if(!m||!B)return new $a(t+".quaternion",[0],[0]);for(let C=0;C<m.length;C+=3)h.set(m[C],m[C+1],m[C+2],A),M.setFromEuler(h),o!==void 0&&M.premultiply(o),c!==void 0&&M.multiply(c),C>2&&new ws().fromArray(f,(C-3)/3*4).dot(M)<0&&M.set(-M.x,-M.y,-M.z,-M.w),M.toArray(f,C/3*4);return new $a(t+".quaternion",B,f)}generateMorphTrack(t){const r=t.DeformPercent.curves.morph,o=r.values.map(function(A){return A/100}),c=ps.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new hh(t.modelName+".morphTargetInfluences["+c+"]",r.times,o)}getTimesForAllAxes(t){let r=[];if(t.x!==void 0&&(r=r.concat(t.x.times)),t.y!==void 0&&(r=r.concat(t.y.times)),t.z!==void 0&&(r=r.concat(t.z.times)),r=r.sort(function(o,c){return o-c}),r.length>1){let o=1,c=r[0];for(let A=1;A<r.length;A++){const B=r[A];B!==c&&(r[o]=B,c=B,o++)}r=r.slice(0,o)}return r}getKeyframeTrackValues(t,r,o){const c=o,A=[];let B=-1,m=-1,M=-1;return t.forEach(function(h){if(r.x&&(B=r.x.times.indexOf(h)),r.y&&(m=r.y.times.indexOf(h)),r.z&&(M=r.z.times.indexOf(h)),B!==-1){const f=r.x.values[B];A.push(f),c[0]=f}else A.push(c[0]);if(m!==-1){const f=r.y.values[m];A.push(f),c[1]=f}else A.push(c[1]);if(M!==-1){const f=r.z.values[M];A.push(f),c[2]=f}else A.push(c[2])}),A}interpolateRotations(t,r,o,c){const A=[],B=[];A.push(t.times[0]),B.push(As.degToRad(t.values[0])),B.push(As.degToRad(r.values[0])),B.push(As.degToRad(o.values[0]));for(let m=1;m<t.values.length;m++){const M=[t.values[m-1],r.values[m-1],o.values[m-1]];if(isNaN(M[0])||isNaN(M[1])||isNaN(M[2]))continue;const h=M.map(As.degToRad),f=[t.values[m],r.values[m],o.values[m]];if(isNaN(f[0])||isNaN(f[1])||isNaN(f[2]))continue;const C=f.map(As.degToRad),p=[f[0]-M[0],f[1]-M[1],f[2]-M[2]],g=[Math.abs(p[0]),Math.abs(p[1]),Math.abs(p[2])];if(g[0]>=180||g[1]>=180||g[2]>=180){const E=Math.max(...g)/180,b=new Xr(...h,c),x=new Xr(...C,c),T=new ws().setFromEuler(b),_=new ws().setFromEuler(x);T.dot(_)&&_.set(-_.x,-_.y,-_.z,-_.w);const w=t.times[m-1],S=t.times[m]-w,L=new ws,P=new Xr;for(let D=0;D<1;D+=1/E)L.copy(T.clone().slerp(_.clone(),D)),A.push(w+D*S),P.setFromQuaternion(L,c),B.push(P.x),B.push(P.y),B.push(P.z)}else A.push(t.times[m]),B.push(As.degToRad(t.values[m])),B.push(As.degToRad(r.values[m])),B.push(As.degToRad(o.values[m]))}return[A,B]}}class L_{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(t){this.nodeStack.push(t),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(t,r){this.currentProp=t,this.currentPropName=r}parse(t){this.currentIndent=0,this.allNodes=new dy,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const r=this,o=t.split(/[\r\n]+/);return o.forEach(function(c,A){const B=c.match(/^[\s\t]*;/),m=c.match(/^[\s\t]*$/);if(B||m)return;const M=c.match("^\\t{"+r.currentIndent+"}(\\w+):(.*){",""),h=c.match("^\\t{"+r.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),f=c.match("^\\t{"+(r.currentIndent-1)+"}}");M?r.parseNodeBegin(c,M):h?r.parseNodeProperty(c,h,o[++A]):f?r.popStack():c.match(/^[^\s\t}]/)&&r.parseNodePropertyContinued(c)}),this.allNodes}parseNodeBegin(t,r){const o=r[1].trim().replace(/^"/,"").replace(/"$/,""),c=r[2].split(",").map(function(M){return M.trim().replace(/^"/,"").replace(/"$/,"")}),A={name:o},B=this.parseNodeAttr(c),m=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(o,A):o in m?(o==="PoseNode"?m.PoseNode.push(A):m[o].id!==void 0&&(m[o]={},m[o][m[o].id]=m[o]),B.id!==""&&(m[o][B.id]=A)):typeof B.id=="number"?(m[o]={},m[o][B.id]=A):o!=="Properties70"&&(o==="PoseNode"?m[o]=[A]:m[o]=A),typeof B.id=="number"&&(A.id=B.id),B.name!==""&&(A.attrName=B.name),B.type!==""&&(A.attrType=B.type),this.pushStack(A)}parseNodeAttr(t){let r=t[0];t[0]!==""&&(r=parseInt(t[0]),isNaN(r)&&(r=t[0]));let o="",c="";return t.length>1&&(o=t[1].replace(/^(\w+)::/,""),c=t[2]),{id:r,name:o,type:c}}parseNodeProperty(t,r,o){let c=r[1].replace(/^"/,"").replace(/"$/,"").trim(),A=r[2].replace(/^"/,"").replace(/"$/,"").trim();c==="Content"&&A===","&&(A=o.replace(/"/g,"").replace(/,$/,"").trim());const B=this.getCurrentNode();if(B.name==="Properties70"){this.parseNodeSpecialProperty(t,c,A);return}if(c==="C"){const M=A.split(",").slice(1),h=parseInt(M[0]),f=parseInt(M[1]);let C=A.split(",").slice(3);C=C.map(function(p){return p.trim().replace(/^"/,"")}),c="connections",A=[h,f],k_(A,C),B[c]===void 0&&(B[c]=[])}c==="Node"&&(B.id=A),c in B&&Array.isArray(B[c])?B[c].push(A):c!=="a"?B[c]=A:B.a=A,this.setCurrentProp(B,c),c==="a"&&A.slice(-1)!==","&&(B.a=mA(A))}parseNodePropertyContinued(t){const r=this.getCurrentNode();r.a+=t,t.slice(-1)!==","&&(r.a=mA(r.a))}parseNodeSpecialProperty(t,r,o){const c=o.split('",').map(function(f){return f.trim().replace(/^\"/,"").replace(/\s/,"_")}),A=c[0],B=c[1],m=c[2],M=c[3];let h=c[4];switch(B){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":h=parseFloat(h);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":h=mA(h);break}this.getPrevNode()[A]={type:B,type2:m,flag:M,value:h},this.setCurrentProp(this.getPrevNode(),A)}}class D_{parse(t){const r=new kv(t);r.skip(23);const o=r.getUint32();if(o<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+o);const c=new dy;for(;!this.endOfContent(r);){const A=this.parseNode(r,o);A!==null&&c.add(A.name,A)}return c}endOfContent(t){return t.size()%16===0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()}parseNode(t,r){const o={},c=r>=7500?t.getUint64():t.getUint32(),A=r>=7500?t.getUint64():t.getUint32();r>=7500?t.getUint64():t.getUint32();const B=t.getUint8(),m=t.getString(B);if(c===0)return null;const M=[];for(let p=0;p<A;p++)M.push(this.parseProperty(t));const h=M.length>0?M[0]:"",f=M.length>1?M[1]:"",C=M.length>2?M[2]:"";for(o.singleProperty=A===1&&t.getOffset()===c;c>t.getOffset();){const p=this.parseNode(t,r);p!==null&&this.parseSubNode(m,o,p)}return o.propertyList=M,typeof h=="number"&&(o.id=h),f!==""&&(o.attrName=f),C!==""&&(o.attrType=C),m!==""&&(o.name=m),o}parseSubNode(t,r,o){if(o.singleProperty===!0){const c=o.propertyList[0];Array.isArray(c)?(r[o.name]=o,o.a=c):r[o.name]=c}else if(t==="Connections"&&o.name==="C"){const c=[];o.propertyList.forEach(function(A,B){B!==0&&c.push(A)}),r.connections===void 0&&(r.connections=[]),r.connections.push(c)}else if(o.name==="Properties70")Object.keys(o).forEach(function(A){r[A]=o[A]});else if(t==="Properties70"&&o.name==="P"){let c=o.propertyList[0],A=o.propertyList[1];const B=o.propertyList[2],m=o.propertyList[3];let M;c.indexOf("Lcl ")===0&&(c=c.replace("Lcl ","Lcl_")),A.indexOf("Lcl ")===0&&(A=A.replace("Lcl ","Lcl_")),A==="Color"||A==="ColorRGB"||A==="Vector"||A==="Vector3D"||A.indexOf("Lcl_")===0?M=[o.propertyList[4],o.propertyList[5],o.propertyList[6]]:M=o.propertyList[4],r[c]={type:A,type2:B,flag:m,value:M}}else r[o.name]===void 0?typeof o.id=="number"?(r[o.name]={},r[o.name][o.id]=o):r[o.name]=o:o.name==="PoseNode"?(Array.isArray(r[o.name])||(r[o.name]=[r[o.name]]),r[o.name].push(o)):r[o.name][o.id]===void 0&&(r[o.name][o.id]=o)}parseProperty(t){const r=t.getString(1);let o;switch(r){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":return o=t.getUint32(),t.getArrayBuffer(o);case"S":return o=t.getUint32(),t.getString(o);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const c=t.getUint32(),A=t.getUint32(),B=t.getUint32();if(A===0)switch(r){case"b":case"c":return t.getBooleanArray(c);case"d":return t.getFloat64Array(c);case"f":return t.getFloat32Array(c);case"i":return t.getInt32Array(c);case"l":return t.getInt64Array(c)}const m=g_(new Uint8Array(t.getArrayBuffer(B))),M=new kv(m.buffer);switch(r){case"b":case"c":return M.getBooleanArray(c);case"d":return M.getFloat64Array(c);case"f":return M.getFloat32Array(c);case"i":return M.getInt32Array(c);case"l":return M.getInt64Array(c)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+r)}}}class kv{constructor(t,r){this.dv=new DataView(t),this.offset=0,this.littleEndian=r!==void 0?r:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(t){this.offset+=t}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(t){const r=[];for(let o=0;o<t;o++)r.push(this.getBoolean());return r}getUint8(){const t=this.dv.getUint8(this.offset);return this.offset+=1,t}getInt16(){const t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}getInt32(){const t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}getInt32Array(t){const r=[];for(let o=0;o<t;o++)r.push(this.getInt32());return r}getUint32(){const t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}getInt64(){let t,r;return this.littleEndian?(t=this.getUint32(),r=this.getUint32()):(r=this.getUint32(),t=this.getUint32()),r&2147483648?(r=~r&4294967295,t=~t&4294967295,t===4294967295&&(r=r+1&4294967295),t=t+1&4294967295,-(r*4294967296+t)):r*4294967296+t}getInt64Array(t){const r=[];for(let o=0;o<t;o++)r.push(this.getInt64());return r}getUint64(){let t,r;return this.littleEndian?(t=this.getUint32(),r=this.getUint32()):(r=this.getUint32(),t=this.getUint32()),r*4294967296+t}getFloat32(){const t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}getFloat32Array(t){const r=[];for(let o=0;o<t;o++)r.push(this.getFloat32());return r}getFloat64(){const t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}getFloat64Array(t){const r=[];for(let o=0;o<t;o++)r.push(this.getFloat64());return r}getArrayBuffer(t){const r=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,r}getString(t){const r=this.offset;let o=new Uint8Array(this.dv.buffer,r,t);this.skip(t);const c=o.indexOf(0);return c>=0&&(o=new Uint8Array(this.dv.buffer,r,c)),this._textDecoder.decode(o)}}class dy{add(t,r){this[t]=r}}function P_(y){const t="Kaydara FBX Binary  \0";return y.byteLength>=t.length&&t===Ay(y,0,t.length)}function O_(y){const t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let r=0;function o(c){const A=y[c-1];return y=y.slice(r+c),r++,A}for(let c=0;c<t.length;++c)if(o(1)===t[c])return!1;return!0}function Uv(y){const t=/FBXVersion: (\d+)/,r=y.match(t);if(r)return parseInt(r[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function F_(y){return y/46186158e3}const N_=[];function md(y,t,r,o){let c;switch(o.mappingType){case"ByPolygonVertex":c=y;break;case"ByPolygon":c=t;break;case"ByVertice":c=r;break;case"AllSame":c=o.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+o.mappingType)}o.referenceType==="IndexToDirect"&&(c=o.indices[c]);const A=c*o.dataSize,B=A+o.dataSize;return U_(N_,o.buffer,A,B)}const AA=new Xr,ql=new it;function fy(y){const t=new Gi,r=new Gi,o=new Gi,c=new Gi,A=new Gi,B=new Gi,m=new Gi,M=new Gi,h=new Gi,f=new Gi,C=new Gi,p=new Gi,g=y.inheritType?y.inheritType:0;if(y.translation&&t.setPosition(ql.fromArray(y.translation)),y.preRotation){const F=y.preRotation.map(As.degToRad);F.push(y.eulerOrder||Xr.DEFAULT_ORDER),r.makeRotationFromEuler(AA.fromArray(F))}if(y.rotation){const F=y.rotation.map(As.degToRad);F.push(y.eulerOrder||Xr.DEFAULT_ORDER),o.makeRotationFromEuler(AA.fromArray(F))}if(y.postRotation){const F=y.postRotation.map(As.degToRad);F.push(y.eulerOrder||Xr.DEFAULT_ORDER),c.makeRotationFromEuler(AA.fromArray(F)),c.invert()}y.scale&&A.scale(ql.fromArray(y.scale)),y.scalingOffset&&m.setPosition(ql.fromArray(y.scalingOffset)),y.scalingPivot&&B.setPosition(ql.fromArray(y.scalingPivot)),y.rotationOffset&&M.setPosition(ql.fromArray(y.rotationOffset)),y.rotationPivot&&h.setPosition(ql.fromArray(y.rotationPivot)),y.parentMatrixWorld&&(C.copy(y.parentMatrix),f.copy(y.parentMatrixWorld));const u=r.clone().multiply(o).multiply(c),E=new Gi;E.extractRotation(f);const b=new Gi;b.copyPosition(f);const x=b.clone().invert().multiply(f),T=E.clone().invert().multiply(x),_=A,w=new Gi;if(g===0)w.copy(E).multiply(u).multiply(T).multiply(_);else if(g===1)w.copy(E).multiply(T).multiply(u).multiply(_);else{const j=new Gi().scale(new it().setFromMatrixScale(C)).clone().invert(),Y=T.clone().multiply(j);w.copy(E).multiply(u).multiply(Y).multiply(_)}const S=h.clone().invert(),L=B.clone().invert();let P=t.clone().multiply(M).multiply(h).multiply(r).multiply(o).multiply(c).multiply(S).multiply(m).multiply(B).multiply(A).multiply(L);const D=new Gi().copyPosition(P),U=f.clone().multiply(D);return p.copyPosition(U),P=p.clone().multiply(w),P.premultiply(f.invert()),P}function py(y){y=y||0;const t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return y===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[y]}function mA(y){return y.split(",").map(function(r){return parseFloat(r)})}function Ay(y,t,r){return t===void 0&&(t=0),r===void 0&&(r=y.byteLength),new TextDecoder().decode(new Uint8Array(y,t,r))}function k_(y,t){for(let r=0,o=y.length,c=t.length;r<c;r++,o++)y[o]=t[r]}function U_(y,t,r,o){for(let c=r,A=0;c<o;c++,A++)y[A]=t[c];return y}THREE.FBXLoader=T_;AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const y=this.data;if(!y.src)return;this.remove();const t=new THREE.FBXLoader;y.crossorigin&&t.setCrossOrigin(y.crossorigin),t.load(y.src,this.load.bind(this))},load:function(y){this.model=y,this.el.setObject3D("mesh",y),this.el.emit("model-loaded",{format:"fbx",model:y})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});function G_(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function V_(y,t){var r=document.createElement("script");return r.type="text/javascript",r.async=!0,r.id=t,r.src=y,r}function gA(y){const t=document.getElementById(y),r=t.parentNode;try{r&&r.removeChild(t)}catch{}}function z_(y){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(y,t)}function Q_(y,t,r){return new r(function(o,c){const A=t.timeout||5e3,B=G_(),m=V_(y,B),M=setTimeout(function(){c(new Error("Script request to "+y+" timed out")),gA(B)},A),h=function(f){clearTimeout(f)};m.addEventListener("load",function(f){o({ok:!0}),h(M),gA(B)}),m.addEventListener("error",function(f){c(new Error("Script request to "+y+" failed "+f)),h(M),gA(B)}),z_(m)})}function H_(y){return y=y||{},function(t,r){return r=r||{},Q_(t,r,y.Promise||Promise)}}var j_=H_;const W_=j_(),K_="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",X_=function(){let y;return function(){return y=y||W_(K_),y}}();AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=X_().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const y=this,t=this.el,r=this.data;r&&(this.remove(),this.loaderPromise.then(()=>{this.loader.load(r,function(c){y.model=c.scene,y.model.animations=c.animations,t.setObject3D("mesh",y.model),t.emit("model-loaded",{format:"gltf",model:y.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let y;const t=this.data;t.src&&(this.remove(),y=new THREE.ObjectLoader,t.crossorigin&&y.setCrossOrigin(t.crossorigin),y.load(t.src,r=>{r.traverse(o=>{o instanceof THREE.SkinnedMesh&&o.material&&(o.material.skinning=!!(o.geometry&&o.geometry.bones||[]).length)}),this.load(r)}))},load:function(y){this.model=y,this.el.setObject3D("mesh",y),this.el.emit("model-loaded",{format:"json",model:y})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const y=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!y)throw new Error("No `checkpoint-controls` component found.");y.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}});function Y_(y){return y?Array.isArray(y)?y:y.materials?y.materials:[y]:[]}function Zc(y,t,r,o){y&&(t=t||[],y.traverse(c=>{if(!c.isMesh)return;Y_(c.material).forEach(B=>{B&&!("envMap"in B)||t.length&&t.indexOf(B.name)===-1||(B.envMap=r,B.reflectivity=o,B.needsUpdate=!0)})}))}AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const y=this.data;this.texture=new THREE.CubeTextureLoader().load([y.path+"posx."+y.extension,y.path+"negx."+y.extension,y.path+"posy."+y.extension,y.path+"negy."+y.extension,y.path+"posz."+y.extension,y.path+"negz."+y.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{const t=this.el.getObject3D("mesh"),r=this.data;Zc(t,r.materials,this.texture,r.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(y){const t=this.data,r=this.el.getObject3D("mesh");let o=[],c=[];if(t.materials.length&&(y.materials?(o=t.materials.filter(A=>!y.materials.includes(A)),c=y.materials.filter(A=>!t.materials.includes(A))):o=t.materials),o.length&&Zc(r,o,this.texture,t.reflectivity),c.length&&Zc(r,c,null,1),y.materials&&t.reflectivity!==y.reflectivity){const A=t.materials.filter(B=>y.materials.includes(B));A.length&&Zc(r,A,this.texture,t.reflectivity)}this.data.enableBackground&&!y.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&y.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const y=this.el.getObject3D("mesh"),t=this.data;Zc(y,t.materials,null,1),t.enableBackground&&this.setBackground(null)},setBackground:function(y){this.el.sceneEl.object3D.background=y}});AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const y=this.el;y.addEventListener("hit",this.onHit),y.addEventListener("gripdown",this.onGripClose),y.addEventListener("gripup",this.onGripOpen),y.addEventListener("trackpaddown",this.onGripClose),y.addEventListener("trackpadup",this.onGripOpen),y.addEventListener("triggerdown",this.onGripClose),y.addEventListener("triggerup",this.onGripOpen)},pause:function(){const y=this.el;y.removeEventListener("hit",this.onHit),y.removeEventListener("gripdown",this.onGripClose),y.removeEventListener("gripup",this.onGripOpen),y.removeEventListener("trackpaddown",this.onGripClose),y.removeEventListener("trackpadup",this.onGripOpen),y.removeEventListener("triggerdown",this.onGripClose),y.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const y=this.hitEl;this.grabbing=!1,y&&(y.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(y){const t=y.detail.el;t.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(t.addState(this.GRABBED_STATE),this.hitEl=t,this.constraint=new CANNON.LockConstraint(this.el.body,t.body),this.system.addConstraint(this.constraint))}});AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(y=>{y.isMesh&&(y.material=this.material)})}});AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){const y=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(y,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const y=this.data;let t;y.objects?t=this.el.sceneEl.querySelectorAll(y.objects):t=this.el.sceneEl.children,this.els=Array.prototype.slice.call(t)},tick:function(){const y=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Vector3,c=new THREE.Box3,A=[],B=new Map;return function(m){if(!this.data.enabled)return;const M=this.prevCheckTime;if(M&&m-M<this.data.interval)return;this.prevCheckTime=m;const h=this.el,f=this.data,C=h.getObject3D("mesh");let p;if(!C)return;A.length=0,B.clear(),h.object3D.getWorldPosition(y),h.object3D.getWorldScale(r),p=f.radius*u(r),this.els.forEach(g),A.sort((E,b)=>B.get(E)>B.get(b)?1:-1).forEach(this.handleHit),this.collisions.filter(E=>!B.has(E)).forEach(this.handleHitEnd),q_(this.collisions,A);function g(E){let b,x,T,_;E.isEntity&&(x=E.getObject3D("mesh"),x&&(c.setFromObject(x).getSize(o),_=Math.max(o.x,o.y,o.z)/2,b=Math.sqrt(2*_*_),c.getCenter(t),b&&(T=y.distanceTo(t),T<b+p&&(A.push(E),B.set(E,T)))))}function u(E){return Math.max(E.x,E.y,E.z)}}}(),handleHit:function(y){y.emit("hit"),y.addState(this.data.state),this.eventDetail.el=y,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(y){y.emit("hitend"),y.removeState(this.data.state),this.eventDetail.el=y,this.el.emit("hitend",this.eventDetail)}});function q_(y,t){y.length=0;for(let r=0;r<t.length;r++)y[r]=t[r]}AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var y=this;const t=this.el.getObject3D("mesh");if(this.el.sceneEl.object3D,!t)return;let r;if(t.traverse(c=>{c.isMesh&&(!y.nodeName||c.name===y.nodeName)&&(r=c)}),!r)return;const o=r.geometry.clone();r.updateWorldMatrix(!0,!1),o.applyMatrix4(r.matrixWorld),this.system.setNavMeshGeometry(o),this.hasLoadedNavMesh=!0}});AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const y=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Vector3;return function(o,c){const A=this.el,B=this.data,m=this.raycaster,M=B.speed*c/1e3;if(!B.active)return;if(!this.path.length){const u=this.el.object3D.position;this.group=this.group||this.system.getGroup(u),this.path=this.system.getPath(u,y.copy(B.destination),this.group)||[],A.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",B.destination),this.el.setAttribute("nav-agent",{active:!1}),A.emit("navigation-end");return}const h=A.object3D.position,f=this.path[0];t.subVectors(f,h);const C=t.length();let p;if(C<M){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),A.emit("navigation-end");return}r.copy(h),p=this.path[0]}else r.copy(t.setLength(M)).add(h),p=f;p.y=h.y,A.object3D.lookAt(p),m.ray.origin.copy(r),m.ray.origin.y+=1.5,m.ray.direction={x:0,y:-1,z:0};const g=m.intersectObject(this.system.getNavMesh());g.length?(t.subVectors(g[0].point,h),h.add(t.setLength(M))):h.copy(r)}}()});class Er{static roundNumber(t,r){const o=Math.pow(10,r);return Math.round(t*o)/o}static sample(t){return t[Math.floor(Math.random()*t.length)]}static distanceToSquared(t,r){var o=t.x-r.x,c=t.y-r.y,A=t.z-r.z;return o*o+c*c+A*A}static isPointInPoly(t,r){for(var o=!1,c=-1,A=t.length,B=A-1;++c<A;B=c)(t[c].z<=r.z&&r.z<t[B].z||t[B].z<=r.z&&r.z<t[c].z)&&r.x<(t[B].x-t[c].x)*(r.z-t[c].z)/(t[B].z-t[c].z)+t[c].x&&(o=!o);return o}static isVectorInPolygon(t,r,o){var c=1e5,A=-1e5,B=[];return r.vertexIds.forEach(m=>{c=Math.min(o[m].y,c),A=Math.max(o[m].y,A),B.push(o[m])}),!!(t.y<A+.5&&t.y>c-.5&&this.isPointInPoly(B,t))}static triarea2(t,r,o){return(o.x-t.x)*(r.z-t.z)-(r.x-t.x)*(o.z-t.z)}static vequal(t,r){return this.distanceToSquared(t,r)<1e-5}static mergeVertices(t,r=1e-4){r=Math.max(r,Number.EPSILON);for(var o={},c=t.getIndex(),A=t.getAttribute("position"),B=c?c.count:A.count,m=0,M=[],h=[],f=Math.log10(1/r),C=Math.pow(10,f),p=0;p<B;p++){var g=c?c.getX(p):p,u="";u+=~~(A.getX(g)*C)+",",u+=~~(A.getY(g)*C)+",",(u+=~~(A.getZ(g)*C)+",")in o?M.push(o[u]):(h.push(A.getX(g)),h.push(A.getY(g)),h.push(A.getZ(g)),o[u]=m,M.push(m),m++)}const E=new Aa(new Float32Array(h),A.itemSize,A.normalized),b=new so;return b.setAttribute("position",E),b.setIndex(M),b}}class J_{constructor(t){this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){const t=this.content[0],r=this.content.pop();return this.content.length>0&&(this.content[0]=r,this.bubbleUp(0)),t}remove(t){const r=this.content.indexOf(t),o=this.content.pop();r!==this.content.length-1&&(this.content[r]=o,this.scoreFunction(o)<this.scoreFunction(t)?this.sinkDown(r):this.bubbleUp(r))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}sinkDown(t){const r=this.content[t];for(;t>0;){const o=(t+1>>1)-1,c=this.content[o];if(!(this.scoreFunction(r)<this.scoreFunction(c)))break;this.content[o]=r,this.content[t]=c,t=o}}bubbleUp(t){const r=this.content.length,o=this.content[t],c=this.scoreFunction(o);for(;;){const A=t+1<<1,B=A-1;let m,M=null;if(B<r&&(m=this.scoreFunction(this.content[B]),m<c&&(M=B)),A<r&&this.scoreFunction(this.content[A])<(M===null?c:m)&&(M=A),M===null)break;this.content[t]=this.content[M],this.content[M]=o,t=M}}}class Z_{constructor(){this.portals=[]}push(t,r){r===void 0&&(r=t),this.portals.push({left:t,right:r})}stringPull(){const t=this.portals,r=[];let o,c,A,B=0,m=0,M=0;o=t[0].left,c=t[0].left,A=t[0].right,r.push(o);for(let h=1;h<t.length;h++){const f=t[h].left,C=t[h].right;if(Er.triarea2(o,A,C)<=0){if(!(Er.vequal(o,A)||Er.triarea2(o,c,C)>0)){r.push(c),o=c,B=m,c=o,A=o,m=B,M=B,h=B;continue}A=C,M=h}if(Er.triarea2(o,c,f)>=0){if(!(Er.vequal(o,c)||Er.triarea2(o,A,f)<0)){r.push(A),o=A,B=M,c=o,A=o,m=B,M=B,h=B;continue}c=f,m=h}}return r.length!==0&&Er.vequal(r[r.length-1],t[t.length-1].left)||r.push(t[t.length-1].left),this.path=r,r}}class TA{constructor(){this.zones={}}static createZone(t,r=1e-4){return(class{static buildZone(o,c){const A=this._buildNavigationMesh(o,c),B={};A.vertices.forEach(M=>{M.x=Er.roundNumber(M.x,2),M.y=Er.roundNumber(M.y,2),M.z=Er.roundNumber(M.z,2)}),B.vertices=A.vertices;const m=this._buildPolygonGroups(A);return B.groups=new Array(m.length),m.forEach((M,h)=>{const f=new Map;M.forEach((p,g)=>{f.set(p,g)});const C=new Array(M.length);M.forEach((p,g)=>{const u=[];p.neighbours.forEach(x=>u.push(f.get(x)));const E=[];p.neighbours.forEach(x=>E.push(this._getSharedVerticesInOrder(p,x)));const b=new it(0,0,0);b.add(B.vertices[p.vertexIds[0]]),b.add(B.vertices[p.vertexIds[1]]),b.add(B.vertices[p.vertexIds[2]]),b.divideScalar(3),b.x=Er.roundNumber(b.x,2),b.y=Er.roundNumber(b.y,2),b.z=Er.roundNumber(b.z,2),C[g]={id:g,neighbours:u,vertexIds:p.vertexIds,centroid:b,portals:E}}),B.groups[h]=C}),B}static _buildNavigationMesh(o,c){return o=Er.mergeVertices(o,c),this._buildPolygonsFromGeometry(o)}static _spreadGroupId(o){let c=new Set([o]);for(;c.size>0;){const A=c;c=new Set,A.forEach(B=>{B.group=o.group,B.neighbours.forEach(m=>{m.group===void 0&&c.add(m)})})}}static _buildPolygonGroups(o){const c=[];return o.polygons.forEach(A=>{A.group!==void 0?c[A.group].push(A):(A.group=c.length,this._spreadGroupId(A),c.push([A]))}),c}static _buildPolygonNeighbours(o,c){const A=new Set,B=c[o.vertexIds[1]],m=c[o.vertexIds[2]];return c[o.vertexIds[0]].forEach(M=>{M!==o&&(B.includes(M)||m.includes(M))&&A.add(M)}),B.forEach(M=>{M!==o&&m.includes(M)&&A.add(M)}),A}static _buildPolygonsFromGeometry(o){const c=[],A=[],B=o.attributes.position,m=o.index,M=[];for(let h=0;h<B.count;h++)A.push(new it().fromBufferAttribute(B,h)),M[h]=[];for(let h=0;h<o.index.count;h+=3){const f=m.getX(h),C=m.getX(h+1),p=m.getX(h+2),g={vertexIds:[f,C,p],neighbours:null};c.push(g),M[f].push(g),M[C].push(g),M[p].push(g)}return c.forEach(h=>{h.neighbours=this._buildPolygonNeighbours(h,M)}),{polygons:c,vertices:A}}static _getSharedVerticesInOrder(o,c){const A=o.vertexIds,B=A[0],m=A[1],M=A[2],h=c.vertexIds,f=h.includes(B),C=h.includes(m),p=h.includes(M);return f&&C&&p?Array.from(A):f&&C?[B,m]:C&&p?[m,M]:f&&p?[M,B]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}).buildZone(t,r)}setZoneData(t,r){this.zones[t]=r}getRandomNode(t,r,o,c){if(!this.zones[t])return new it;o=o||null,c=c||0;const A=[];return this.zones[t].groups[r].forEach(B=>{o&&c?Er.distanceToSquared(o,B.centroid)<c*c&&A.push(B.centroid):A.push(B.centroid)}),Er.sample(A)||new it}getClosestNode(t,r,o,c=!1){const A=this.zones[r].vertices;let B=null,m=1/0;return this.zones[r].groups[o].forEach(M=>{const h=Er.distanceToSquared(M.centroid,t);h<m&&(!c||Er.isVectorInPolygon(t,M,A))&&(B=M,m=h)}),B}findPath(t,r,o,c){const A=this.zones[o].groups[c],B=this.zones[o].vertices,m=this.getClosestNode(t,o,c,!0),M=this.getClosestNode(r,o,c,!0);if(!m||!M)return null;const h=(class{static init(g){for(let u=0;u<g.length;u++){const E=g[u];E.f=0,E.g=0,E.h=0,E.cost=1,E.visited=!1,E.closed=!1,E.parent=null}}static cleanUp(g){for(let u=0;u<g.length;u++){const E=g[u];delete E.f,delete E.g,delete E.h,delete E.cost,delete E.visited,delete E.closed,delete E.parent}}static heap(){return new J_(function(g){return g.f})}static search(g,u,E){this.init(g);const b=this.heap();for(b.push(u);b.size()>0;){const x=b.pop();if(x===E){let _=x;const w=[];for(;_.parent;)w.push(_),_=_.parent;return this.cleanUp(w),w.reverse()}x.closed=!0;const T=this.neighbours(g,x);for(let _=0,w=T.length;_<w;_++){const S=T[_];if(S.closed)continue;const L=x.g+S.cost,P=S.visited;if(!P||L<S.g){if(S.visited=!0,S.parent=x,!S.centroid||!E.centroid)throw new Error("Unexpected state");S.h=S.h||this.heuristic(S.centroid,E.centroid),S.g=L,S.f=S.g+S.h,P?b.rescoreElement(S):b.push(S)}}}return[]}static heuristic(g,u){return Er.distanceToSquared(g,u)}static neighbours(g,u){const E=[];for(let b=0;b<u.neighbours.length;b++)E.push(g[u.neighbours[b]]);return E}}).search(A,m,M),f=function(g,u){for(var E=0;E<g.neighbours.length;E++)if(g.neighbours[E]===u.id)return g.portals[E]},C=new Z_;C.push(t);for(let g=0;g<h.length;g++){const u=h[g],E=h[g+1];if(E){const b=f(u,E);C.push(B[b[0]],B[b[1]])}}C.push(r),C.stringPull();const p=C.path.map(g=>new it(g.x,g.y,g.z));return p.shift(),p}}TA.prototype.getGroup=function(){const y=new pa;return function(t,r,o=!1){if(!this.zones[t])return null;let c=null,A=Math.pow(50,2);const B=this.zones[t];for(let m=0;m<B.groups.length;m++){const M=B.groups[m];for(const h of M){if(o&&(y.setFromCoplanarPoints(B.vertices[h.vertexIds[0]],B.vertices[h.vertexIds[1]],B.vertices[h.vertexIds[2]]),Math.abs(y.distanceToPoint(r))<.01)&&Er.isPointInPoly([B.vertices[h.vertexIds[0]],B.vertices[h.vertexIds[1]],B.vertices[h.vertexIds[2]]],r))return m;const f=Er.distanceToSquared(h.centroid,r);f<A&&(c=m,A=f)}}return c}}(),TA.prototype.clampStep=function(){const y=new it,t=new pa,r=new ro,o=new it;let c,A,B=new it;return function(m,M,h,f,C,p){const g=this.zones[f].vertices,u=this.zones[f].groups[C],E=[h],b={};b[h.id]=0,c=void 0,B.set(0,0,0),A=1/0,t.setFromCoplanarPoints(g[h.vertexIds[0]],g[h.vertexIds[1]],g[h.vertexIds[2]]),t.projectPoint(M,y),o.copy(y);for(let x=E.pop();x;x=E.pop()){r.set(g[x.vertexIds[0]],g[x.vertexIds[1]],g[x.vertexIds[2]]),r.closestPointToPoint(o,y),y.distanceToSquared(o)<A&&(c=x,B.copy(y),A=y.distanceToSquared(o));const T=b[x.id];if(!(T>2))for(let _=0;_<x.neighbours.length;_++){const w=u[x.neighbours[_]];w.id in b||(E.push(w),b[w.id]=T+1)}}return p.copy(B),c}}();class $_ extends Ar{constructor(){super(),this._playerMarker=new qa(new Md(.25,32,32),new Zl({color:15631215})),this._targetMarker=new qa(new nh(.3,.3,.3),new Zl({color:14469912})),this._nodeMarker=new qa(new nh(.1,.8,.1),new Zl({color:4417387})),this._stepMarker=new qa(new nh(.1,1,.1),new Zl({color:14472114})),this._pathMarker=new Ar,this._pathLineMaterial=new FA({color:41903,linewidth:2}),this._pathPointMaterial=new Zl({color:41903}),this._pathPointGeometry=new Md(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(t=>{t.visible=!1,this.add(t)})}setPath(t){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);t=[this._playerMarker.position].concat(t);const r=new so;r.setAttribute("position",new Aa(new Float32Array(3*t.length),3));for(let o=0;o<t.length;o++)r.attributes.position.setXYZ(o,t[o].x,t[o].y+.2,t[o].z);this._pathMarker.add(new $v(r,this._pathLineMaterial));for(let o=0;o<t.length-1;o++){const c=new qa(this._pathPointGeometry,this._pathPointMaterial);c.position.copy(t[o]),c.position.y+=.2,this._pathMarker.add(c)}return this._pathMarker.visible=!0,this}setPlayerPosition(t){return this._playerMarker.position.copy(t),this._playerMarker.visible=!0,this}setTargetPosition(t){return this._targetMarker.position.copy(t),this._targetMarker.visible=!0,this}setNodePosition(t){return this._nodeMarker.position.copy(t),this._nodeMarker.visible=!0,this}setStepPosition(t){return this._stepMarker.position.copy(t),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(t=>{t.visible=!1}),this}}const e3=Object.freeze(Object.defineProperty({__proto__:null,Pathfinding:TA,PathfindingHelper:$_},Symbol.toStringTag,{value:"Module"})),t3=k2(e3),{Pathfinding:my}=t3,$c=new my,eh="level";AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(y){this.navMesh=new THREE.Mesh(y),$c.setZoneData(eh,my.createZone(y)),Array.from(this.agents).forEach(t=>t.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(y){this.agents.add(y)},removeAgent:function(y){this.agents.delete(y)},getPath:function(y,t,r){return this.navMesh?$c.findPath(y,t,eh,r):null},getGroup:function(y){return this.navMesh?$c.getGroup(eh,y):null},getNode:function(y,t){return this.navMesh?$c.getClosestNode(y,eh,t,!0):null},clampStep:function(y,t,r,o,c){if(this.navMesh){if(!o)return c.copy(t),this.getNode(t,r)}else return c.copy(t),null;return $c.clampStep(y,t,o,eh,r,c)}});AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}});AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}});AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const y=this.el,t=this.data;let r=y.components.material;const o=new THREE.PlaneGeometry(t.width,t.depth,t.density,t.density);this.waves=[];const c=o.getAttribute("position");for(let A=0;A<c.count;A++)this.waves.push({z:c.getZ(A),ang:Math.random()*Math.PI*2,amp:t.amplitude+Math.random()*t.amplitudeVariance,speed:(t.speed+Math.random()*t.speedVariance)/1e3});r||(r={},r.material=new THREE.MeshPhongMaterial({color:t.color,transparent:t.opacity<1,opacity:t.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(o,r.material),y.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(y,t){if(!t)return;const r=this.mesh.geometry.getAttribute("position");for(let o=0;o<r.count;o++){const c=this.waves[o],A=c.z+Math.sin(c.ang)*c.amp;r.setZ(o,A),c.ang+=c.speed*t}r.needsUpdate=!0}});AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}});AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const y=this.el,t=this.data;let r=y.components.material;if(!t.path.length){console.error("[a-tube] `path` property expected but not found.");return}const o=new THREE.CatmullRomCurve3(t.path.map(function(A){return A=A.split(" "),new THREE.Vector3(Number(A[0]),Number(A[1]),Number(A[2]))})),c=new THREE.TubeGeometry(o,t.segments,t.radius,t.radialSegments,t.closed);r||(r={},r.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(c,r.material),this.el.setObject3D("mesh",this.mesh)},update:function(y){Object.keys(y).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}});
