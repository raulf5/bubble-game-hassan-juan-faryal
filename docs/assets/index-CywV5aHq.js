import Yy from"THREE";(function(){const Fa=document.createElement("link").relList;if(Fa&&Fa.supports&&Fa.supports("modulepreload"))return;for(const yr of document.querySelectorAll('link[rel="modulepreload"]'))Ys(yr);new MutationObserver(yr=>{for(const mi of yr)if(mi.type==="childList")for(const Bo of mi.addedNodes)Bo.tagName==="LINK"&&Bo.rel==="modulepreload"&&Ys(Bo)}).observe(document,{childList:!0,subtree:!0});function na(yr){const mi={};return yr.integrity&&(mi.integrity=yr.integrity),yr.referrerPolicy&&(mi.referrerPolicy=yr.referrerPolicy),yr.crossOrigin==="use-credentials"?mi.credentials="include":yr.crossOrigin==="anonymous"?mi.credentials="omit":mi.credentials="same-origin",mi}function Ys(yr){if(yr.ep)return;yr.ep=!0;const mi=na(yr);fetch(yr.href,mi)}})();var qy={exports:{}};(function(vl,Fa){var na={};(function(yr,mi){vl.exports=mi()})(self,()=>(()=>{var Ys={"./node_modules/an-array/index.js":W=>{var $=Object.prototype.toString;W.exports=A;function A(u){return u.BYTES_PER_ELEMENT&&$.call(u.buffer)==="[object ArrayBuffer]"||Array.isArray(u)}},"./node_modules/as-number/index.js":W=>{W.exports=function(A,u){return typeof A=="number"?A:typeof u=="number"?u:0}},"./node_modules/base64-js/index.js":(W,$)=>{$.byteLength=m,$.toByteArray=y,$.fromByteArray=p;for(var A=[],u=[],w=typeof Uint8Array<"u"?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=0,a=h.length;v<a;++v)A[v]=h[v],u[h.charCodeAt(v)]=v;u[45]=62,u[95]=63;function f(C){var S=C.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _=C.indexOf("=");_===-1&&(_=S);var L=_===S?0:4-_%4;return[_,L]}function m(C){var S=f(C),_=S[0],L=S[1];return(_+L)*3/4-L}function l(C,S,_){return(S+_)*3/4-_}function y(C){var S,_=f(C),L=_[0],T=_[1],N=new w(l(C,L,T)),F=0,te=T>0?L-4:L,K;for(K=0;K<te;K+=4)S=u[C.charCodeAt(K)]<<18|u[C.charCodeAt(K+1)]<<12|u[C.charCodeAt(K+2)]<<6|u[C.charCodeAt(K+3)],N[F++]=S>>16&255,N[F++]=S>>8&255,N[F++]=S&255;return T===2&&(S=u[C.charCodeAt(K)]<<2|u[C.charCodeAt(K+1)]>>4,N[F++]=S&255),T===1&&(S=u[C.charCodeAt(K)]<<10|u[C.charCodeAt(K+1)]<<4|u[C.charCodeAt(K+2)]>>2,N[F++]=S>>8&255,N[F++]=S&255),N}function g(C){return A[C>>18&63]+A[C>>12&63]+A[C>>6&63]+A[C&63]}function d(C,S,_){for(var L,T=[],N=S;N<_;N+=3)L=(C[N]<<16&16711680)+(C[N+1]<<8&65280)+(C[N+2]&255),T.push(g(L));return T.join("")}function p(C){for(var S,_=C.length,L=_%3,T=[],N=16383,F=0,te=_-L;F<te;F+=N)T.push(d(C,F,F+N>te?te:F+N));return L===1?(S=C[_-1],T.push(A[S>>2]+A[S<<4&63]+"==")):L===2&&(S=(C[_-2]<<8)+C[_-1],T.push(A[S>>10]+A[S>>4&63]+A[S<<2&63]+"=")),T.join("")}},"./node_modules/buffer-equal/index.js":(W,$,A)=>{var u=A("./node_modules/buffer/index.js").Buffer;W.exports=function(w,h){if(u.isBuffer(w)&&u.isBuffer(h)){if(typeof w.equals=="function")return w.equals(h);if(w.length!==h.length)return!1;for(var v=0;v<w.length;v++)if(w[v]!==h[v])return!1;return!0}}},"./node_modules/buffer/index.js":(W,$,A)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const u=A("./node_modules/base64-js/index.js"),w=A("./node_modules/ieee754/index.js"),h=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;$.Buffer=m,$.SlowBuffer=N,$.INSPECT_MAX_BYTES=50;const v=2147483647;$.kMaxLength=v,m.TYPED_ARRAY_SUPPORT=a(),!m.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const ee=new Uint8Array(1),D={foo:function(){return 42}};return Object.setPrototypeOf(D,Uint8Array.prototype),Object.setPrototypeOf(ee,D),ee.foo()===42}catch{return!1}}Object.defineProperty(m.prototype,"parent",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.buffer}}),Object.defineProperty(m.prototype,"offset",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.byteOffset}});function f(ee){if(ee>v)throw new RangeError('The value "'+ee+'" is invalid for option "size"');const D=new Uint8Array(ee);return Object.setPrototypeOf(D,m.prototype),D}function m(ee,D,G){if(typeof ee=="number"){if(typeof D=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(ee)}return l(ee,D,G)}m.poolSize=8192;function l(ee,D,G){if(typeof ee=="string")return p(ee,D);if(ArrayBuffer.isView(ee))return S(ee);if(ee==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ee);if(ye(ee,ArrayBuffer)||ee&&ye(ee.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ye(ee,SharedArrayBuffer)||ee&&ye(ee.buffer,SharedArrayBuffer)))return _(ee,D,G);if(typeof ee=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ue=ee.valueOf&&ee.valueOf();if(ue!=null&&ue!==ee)return m.from(ue,D,G);const xe=L(ee);if(xe)return xe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ee[Symbol.toPrimitive]=="function")return m.from(ee[Symbol.toPrimitive]("string"),D,G);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ee)}m.from=function(ee,D,G){return l(ee,D,G)},Object.setPrototypeOf(m.prototype,Uint8Array.prototype),Object.setPrototypeOf(m,Uint8Array);function y(ee){if(typeof ee!="number")throw new TypeError('"size" argument must be of type number');if(ee<0)throw new RangeError('The value "'+ee+'" is invalid for option "size"')}function g(ee,D,G){return y(ee),ee<=0?f(ee):D!==void 0?typeof G=="string"?f(ee).fill(D,G):f(ee).fill(D):f(ee)}m.alloc=function(ee,D,G){return g(ee,D,G)};function d(ee){return y(ee),f(ee<0?0:T(ee)|0)}m.allocUnsafe=function(ee){return d(ee)},m.allocUnsafeSlow=function(ee){return d(ee)};function p(ee,D){if((typeof D!="string"||D==="")&&(D="utf8"),!m.isEncoding(D))throw new TypeError("Unknown encoding: "+D);const G=F(ee,D)|0;let ue=f(G);const xe=ue.write(ee,D);return xe!==G&&(ue=ue.slice(0,xe)),ue}function C(ee){const D=ee.length<0?0:T(ee.length)|0,G=f(D);for(let ue=0;ue<D;ue+=1)G[ue]=ee[ue]&255;return G}function S(ee){if(ye(ee,Uint8Array)){const D=new Uint8Array(ee);return _(D.buffer,D.byteOffset,D.byteLength)}return C(ee)}function _(ee,D,G){if(D<0||ee.byteLength<D)throw new RangeError('"offset" is outside of buffer bounds');if(ee.byteLength<D+(G||0))throw new RangeError('"length" is outside of buffer bounds');let ue;return D===void 0&&G===void 0?ue=new Uint8Array(ee):G===void 0?ue=new Uint8Array(ee,D):ue=new Uint8Array(ee,D,G),Object.setPrototypeOf(ue,m.prototype),ue}function L(ee){if(m.isBuffer(ee)){const D=T(ee.length)|0,G=f(D);return G.length===0||ee.copy(G,0,0,D),G}if(ee.length!==void 0)return typeof ee.length!="number"||Fe(ee.length)?f(0):C(ee);if(ee.type==="Buffer"&&Array.isArray(ee.data))return C(ee.data)}function T(ee){if(ee>=v)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+v.toString(16)+" bytes");return ee|0}function N(ee){return+ee!=ee&&(ee=0),m.alloc(+ee)}m.isBuffer=function(D){return D!=null&&D._isBuffer===!0&&D!==m.prototype},m.compare=function(D,G){if(ye(D,Uint8Array)&&(D=m.from(D,D.offset,D.byteLength)),ye(G,Uint8Array)&&(G=m.from(G,G.offset,G.byteLength)),!m.isBuffer(D)||!m.isBuffer(G))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(D===G)return 0;let ue=D.length,xe=G.length;for(let Ne=0,He=Math.min(ue,xe);Ne<He;++Ne)if(D[Ne]!==G[Ne]){ue=D[Ne],xe=G[Ne];break}return ue<xe?-1:xe<ue?1:0},m.isEncoding=function(D){switch(String(D).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.concat=function(D,G){if(!Array.isArray(D))throw new TypeError('"list" argument must be an Array of Buffers');if(D.length===0)return m.alloc(0);let ue;if(G===void 0)for(G=0,ue=0;ue<D.length;++ue)G+=D[ue].length;const xe=m.allocUnsafe(G);let Ne=0;for(ue=0;ue<D.length;++ue){let He=D[ue];if(ye(He,Uint8Array))Ne+He.length>xe.length?(m.isBuffer(He)||(He=m.from(He)),He.copy(xe,Ne)):Uint8Array.prototype.set.call(xe,He,Ne);else if(m.isBuffer(He))He.copy(xe,Ne);else throw new TypeError('"list" argument must be an Array of Buffers');Ne+=He.length}return xe};function F(ee,D){if(m.isBuffer(ee))return ee.length;if(ArrayBuffer.isView(ee)||ye(ee,ArrayBuffer))return ee.byteLength;if(typeof ee!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ee);const G=ee.length,ue=arguments.length>2&&arguments[2]===!0;if(!ue&&G===0)return 0;let xe=!1;for(;;)switch(D){case"ascii":case"latin1":case"binary":return G;case"utf8":case"utf-8":return Ui(ee).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G*2;case"hex":return G>>>1;case"base64":return Mt(ee).length;default:if(xe)return ue?-1:Ui(ee).length;D=(""+D).toLowerCase(),xe=!0}}m.byteLength=F;function te(ee,D,G){let ue=!1;if((D===void 0||D<0)&&(D=0),D>this.length||((G===void 0||G>this.length)&&(G=this.length),G<=0)||(G>>>=0,D>>>=0,G<=D))return"";for(ee||(ee="utf8");;)switch(ee){case"hex":return ve(this,D,G);case"utf8":case"utf-8":return b(this,D,G);case"ascii":return Q(this,D,G);case"latin1":case"binary":return J(this,D,G);case"base64":return Ae(this,D,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Le(this,D,G);default:if(ue)throw new TypeError("Unknown encoding: "+ee);ee=(ee+"").toLowerCase(),ue=!0}}m.prototype._isBuffer=!0;function K(ee,D,G){const ue=ee[D];ee[D]=ee[G],ee[G]=ue}m.prototype.swap16=function(){const D=this.length;if(D%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let G=0;G<D;G+=2)K(this,G,G+1);return this},m.prototype.swap32=function(){const D=this.length;if(D%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let G=0;G<D;G+=4)K(this,G,G+3),K(this,G+1,G+2);return this},m.prototype.swap64=function(){const D=this.length;if(D%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let G=0;G<D;G+=8)K(this,G,G+7),K(this,G+1,G+6),K(this,G+2,G+5),K(this,G+3,G+4);return this},m.prototype.toString=function(){const D=this.length;return D===0?"":arguments.length===0?b(this,0,D):te.apply(this,arguments)},m.prototype.toLocaleString=m.prototype.toString,m.prototype.equals=function(D){if(!m.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D?!0:m.compare(this,D)===0},m.prototype.inspect=function(){let D="";const G=$.INSPECT_MAX_BYTES;return D=this.toString("hex",0,G).replace(/(.{2})/g,"$1 ").trim(),this.length>G&&(D+=" ... "),"<Buffer "+D+">"},h&&(m.prototype[h]=m.prototype.inspect),m.prototype.compare=function(D,G,ue,xe,Ne){if(ye(D,Uint8Array)&&(D=m.from(D,D.offset,D.byteLength)),!m.isBuffer(D))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof D);if(G===void 0&&(G=0),ue===void 0&&(ue=D?D.length:0),xe===void 0&&(xe=0),Ne===void 0&&(Ne=this.length),G<0||ue>D.length||xe<0||Ne>this.length)throw new RangeError("out of range index");if(xe>=Ne&&G>=ue)return 0;if(xe>=Ne)return-1;if(G>=ue)return 1;if(G>>>=0,ue>>>=0,xe>>>=0,Ne>>>=0,this===D)return 0;let He=Ne-xe,Gt=ue-G;const Yt=Math.min(He,Gt),Ht=this.slice(xe,Ne),zt=D.slice(G,ue);for(let fn=0;fn<Yt;++fn)if(Ht[fn]!==zt[fn]){He=Ht[fn],Gt=zt[fn];break}return He<Gt?-1:Gt<He?1:0};function se(ee,D,G,ue,xe){if(ee.length===0)return-1;if(typeof G=="string"?(ue=G,G=0):G>2147483647?G=2147483647:G<-2147483648&&(G=-2147483648),G=+G,Fe(G)&&(G=xe?0:ee.length-1),G<0&&(G=ee.length+G),G>=ee.length){if(xe)return-1;G=ee.length-1}else if(G<0)if(xe)G=0;else return-1;if(typeof D=="string"&&(D=m.from(D,ue)),m.isBuffer(D))return D.length===0?-1:ne(ee,D,G,ue,xe);if(typeof D=="number")return D=D&255,typeof Uint8Array.prototype.indexOf=="function"?xe?Uint8Array.prototype.indexOf.call(ee,D,G):Uint8Array.prototype.lastIndexOf.call(ee,D,G):ne(ee,[D],G,ue,xe);throw new TypeError("val must be string, number or Buffer")}function ne(ee,D,G,ue,xe){let Ne=1,He=ee.length,Gt=D.length;if(ue!==void 0&&(ue=String(ue).toLowerCase(),ue==="ucs2"||ue==="ucs-2"||ue==="utf16le"||ue==="utf-16le")){if(ee.length<2||D.length<2)return-1;Ne=2,He/=2,Gt/=2,G/=2}function Yt(zt,fn){return Ne===1?zt[fn]:zt.readUInt16BE(fn*Ne)}let Ht;if(xe){let zt=-1;for(Ht=G;Ht<He;Ht++)if(Yt(ee,Ht)===Yt(D,zt===-1?0:Ht-zt)){if(zt===-1&&(zt=Ht),Ht-zt+1===Gt)return zt*Ne}else zt!==-1&&(Ht-=Ht-zt),zt=-1}else for(G+Gt>He&&(G=He-Gt),Ht=G;Ht>=0;Ht--){let zt=!0;for(let fn=0;fn<Gt;fn++)if(Yt(ee,Ht+fn)!==Yt(D,fn)){zt=!1;break}if(zt)return Ht}return-1}m.prototype.includes=function(D,G,ue){return this.indexOf(D,G,ue)!==-1},m.prototype.indexOf=function(D,G,ue){return se(this,D,G,ue,!0)},m.prototype.lastIndexOf=function(D,G,ue){return se(this,D,G,ue,!1)};function re(ee,D,G,ue){G=Number(G)||0;const xe=ee.length-G;ue?(ue=Number(ue),ue>xe&&(ue=xe)):ue=xe;const Ne=D.length;ue>Ne/2&&(ue=Ne/2);let He;for(He=0;He<ue;++He){const Gt=parseInt(D.substr(He*2,2),16);if(Fe(Gt))return He;ee[G+He]=Gt}return He}function Y(ee,D,G,ue){return Ce(Ui(D,ee.length-G),ee,G,ue)}function k(ee,D,G,ue){return Ce(Qi(D),ee,G,ue)}function oe(ee,D,G,ue){return Ce(Mt(D),ee,G,ue)}function ae(ee,D,G,ue){return Ce(Kn(D,ee.length-G),ee,G,ue)}m.prototype.write=function(D,G,ue,xe){if(G===void 0)xe="utf8",ue=this.length,G=0;else if(ue===void 0&&typeof G=="string")xe=G,ue=this.length,G=0;else if(isFinite(G))G=G>>>0,isFinite(ue)?(ue=ue>>>0,xe===void 0&&(xe="utf8")):(xe=ue,ue=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ne=this.length-G;if((ue===void 0||ue>Ne)&&(ue=Ne),D.length>0&&(ue<0||G<0)||G>this.length)throw new RangeError("Attempt to write outside buffer bounds");xe||(xe="utf8");let He=!1;for(;;)switch(xe){case"hex":return re(this,D,G,ue);case"utf8":case"utf-8":return Y(this,D,G,ue);case"ascii":case"latin1":case"binary":return k(this,D,G,ue);case"base64":return oe(this,D,G,ue);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,D,G,ue);default:if(He)throw new TypeError("Unknown encoding: "+xe);xe=(""+xe).toLowerCase(),He=!0}},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ae(ee,D,G){return D===0&&G===ee.length?u.fromByteArray(ee):u.fromByteArray(ee.slice(D,G))}function b(ee,D,G){G=Math.min(ee.length,G);const ue=[];let xe=D;for(;xe<G;){const Ne=ee[xe];let He=null,Gt=Ne>239?4:Ne>223?3:Ne>191?2:1;if(xe+Gt<=G){let Yt,Ht,zt,fn;switch(Gt){case 1:Ne<128&&(He=Ne);break;case 2:Yt=ee[xe+1],(Yt&192)===128&&(fn=(Ne&31)<<6|Yt&63,fn>127&&(He=fn));break;case 3:Yt=ee[xe+1],Ht=ee[xe+2],(Yt&192)===128&&(Ht&192)===128&&(fn=(Ne&15)<<12|(Yt&63)<<6|Ht&63,fn>2047&&(fn<55296||fn>57343)&&(He=fn));break;case 4:Yt=ee[xe+1],Ht=ee[xe+2],zt=ee[xe+3],(Yt&192)===128&&(Ht&192)===128&&(zt&192)===128&&(fn=(Ne&15)<<18|(Yt&63)<<12|(Ht&63)<<6|zt&63,fn>65535&&fn<1114112&&(He=fn))}}He===null?(He=65533,Gt=1):He>65535&&(He-=65536,ue.push(He>>>10&1023|55296),He=56320|He&1023),ue.push(He),xe+=Gt}return O(ue)}const I=4096;function O(ee){const D=ee.length;if(D<=I)return String.fromCharCode.apply(String,ee);let G="",ue=0;for(;ue<D;)G+=String.fromCharCode.apply(String,ee.slice(ue,ue+=I));return G}function Q(ee,D,G){let ue="";G=Math.min(ee.length,G);for(let xe=D;xe<G;++xe)ue+=String.fromCharCode(ee[xe]&127);return ue}function J(ee,D,G){let ue="";G=Math.min(ee.length,G);for(let xe=D;xe<G;++xe)ue+=String.fromCharCode(ee[xe]);return ue}function ve(ee,D,G){const ue=ee.length;(!D||D<0)&&(D=0),(!G||G<0||G>ue)&&(G=ue);let xe="";for(let Ne=D;Ne<G;++Ne)xe+=Se[ee[Ne]];return xe}function Le(ee,D,G){const ue=ee.slice(D,G);let xe="";for(let Ne=0;Ne<ue.length-1;Ne+=2)xe+=String.fromCharCode(ue[Ne]+ue[Ne+1]*256);return xe}m.prototype.slice=function(D,G){const ue=this.length;D=~~D,G=G===void 0?ue:~~G,D<0?(D+=ue,D<0&&(D=0)):D>ue&&(D=ue),G<0?(G+=ue,G<0&&(G=0)):G>ue&&(G=ue),G<D&&(G=D);const xe=this.subarray(D,G);return Object.setPrototypeOf(xe,m.prototype),xe};function _e(ee,D,G){if(ee%1!==0||ee<0)throw new RangeError("offset is not uint");if(ee+D>G)throw new RangeError("Trying to access beyond buffer length")}m.prototype.readUintLE=m.prototype.readUIntLE=function(D,G,ue){D=D>>>0,G=G>>>0,ue||_e(D,G,this.length);let xe=this[D],Ne=1,He=0;for(;++He<G&&(Ne*=256);)xe+=this[D+He]*Ne;return xe},m.prototype.readUintBE=m.prototype.readUIntBE=function(D,G,ue){D=D>>>0,G=G>>>0,ue||_e(D,G,this.length);let xe=this[D+--G],Ne=1;for(;G>0&&(Ne*=256);)xe+=this[D+--G]*Ne;return xe},m.prototype.readUint8=m.prototype.readUInt8=function(D,G){return D=D>>>0,G||_e(D,1,this.length),this[D]},m.prototype.readUint16LE=m.prototype.readUInt16LE=function(D,G){return D=D>>>0,G||_e(D,2,this.length),this[D]|this[D+1]<<8},m.prototype.readUint16BE=m.prototype.readUInt16BE=function(D,G){return D=D>>>0,G||_e(D,2,this.length),this[D]<<8|this[D+1]},m.prototype.readUint32LE=m.prototype.readUInt32LE=function(D,G){return D=D>>>0,G||_e(D,4,this.length),(this[D]|this[D+1]<<8|this[D+2]<<16)+this[D+3]*16777216},m.prototype.readUint32BE=m.prototype.readUInt32BE=function(D,G){return D=D>>>0,G||_e(D,4,this.length),this[D]*16777216+(this[D+1]<<16|this[D+2]<<8|this[D+3])},m.prototype.readBigUInt64LE=Re(function(D){D=D>>>0,Fn(D,"offset");const G=this[D],ue=this[D+7];(G===void 0||ue===void 0)&&Wn(D,this.length-8);const xe=G+this[++D]*2**8+this[++D]*2**16+this[++D]*2**24,Ne=this[++D]+this[++D]*2**8+this[++D]*2**16+ue*2**24;return BigInt(xe)+(BigInt(Ne)<<BigInt(32))}),m.prototype.readBigUInt64BE=Re(function(D){D=D>>>0,Fn(D,"offset");const G=this[D],ue=this[D+7];(G===void 0||ue===void 0)&&Wn(D,this.length-8);const xe=G*2**24+this[++D]*2**16+this[++D]*2**8+this[++D],Ne=this[++D]*2**24+this[++D]*2**16+this[++D]*2**8+ue;return(BigInt(xe)<<BigInt(32))+BigInt(Ne)}),m.prototype.readIntLE=function(D,G,ue){D=D>>>0,G=G>>>0,ue||_e(D,G,this.length);let xe=this[D],Ne=1,He=0;for(;++He<G&&(Ne*=256);)xe+=this[D+He]*Ne;return Ne*=128,xe>=Ne&&(xe-=Math.pow(2,8*G)),xe},m.prototype.readIntBE=function(D,G,ue){D=D>>>0,G=G>>>0,ue||_e(D,G,this.length);let xe=G,Ne=1,He=this[D+--xe];for(;xe>0&&(Ne*=256);)He+=this[D+--xe]*Ne;return Ne*=128,He>=Ne&&(He-=Math.pow(2,8*G)),He},m.prototype.readInt8=function(D,G){return D=D>>>0,G||_e(D,1,this.length),this[D]&128?(255-this[D]+1)*-1:this[D]},m.prototype.readInt16LE=function(D,G){D=D>>>0,G||_e(D,2,this.length);const ue=this[D]|this[D+1]<<8;return ue&32768?ue|4294901760:ue},m.prototype.readInt16BE=function(D,G){D=D>>>0,G||_e(D,2,this.length);const ue=this[D+1]|this[D]<<8;return ue&32768?ue|4294901760:ue},m.prototype.readInt32LE=function(D,G){return D=D>>>0,G||_e(D,4,this.length),this[D]|this[D+1]<<8|this[D+2]<<16|this[D+3]<<24},m.prototype.readInt32BE=function(D,G){return D=D>>>0,G||_e(D,4,this.length),this[D]<<24|this[D+1]<<16|this[D+2]<<8|this[D+3]},m.prototype.readBigInt64LE=Re(function(D){D=D>>>0,Fn(D,"offset");const G=this[D],ue=this[D+7];(G===void 0||ue===void 0)&&Wn(D,this.length-8);const xe=this[D+4]+this[D+5]*2**8+this[D+6]*2**16+(ue<<24);return(BigInt(xe)<<BigInt(32))+BigInt(G+this[++D]*256+this[++D]*65536+this[++D]*16777216)}),m.prototype.readBigInt64BE=Re(function(D){D=D>>>0,Fn(D,"offset");const G=this[D],ue=this[D+7];(G===void 0||ue===void 0)&&Wn(D,this.length-8);const xe=(G<<24)+this[++D]*2**16+this[++D]*2**8+this[++D];return(BigInt(xe)<<BigInt(32))+BigInt(this[++D]*16777216+this[++D]*65536+this[++D]*256+ue)}),m.prototype.readFloatLE=function(D,G){return D=D>>>0,G||_e(D,4,this.length),w.read(this,D,!0,23,4)},m.prototype.readFloatBE=function(D,G){return D=D>>>0,G||_e(D,4,this.length),w.read(this,D,!1,23,4)},m.prototype.readDoubleLE=function(D,G){return D=D>>>0,G||_e(D,8,this.length),w.read(this,D,!0,52,8)},m.prototype.readDoubleBE=function(D,G){return D=D>>>0,G||_e(D,8,this.length),w.read(this,D,!1,52,8)};function Ze(ee,D,G,ue,xe,Ne){if(!m.isBuffer(ee))throw new TypeError('"buffer" argument must be a Buffer instance');if(D>xe||D<Ne)throw new RangeError('"value" argument is out of bounds');if(G+ue>ee.length)throw new RangeError("Index out of range")}m.prototype.writeUintLE=m.prototype.writeUIntLE=function(D,G,ue,xe){if(D=+D,G=G>>>0,ue=ue>>>0,!xe){const Gt=Math.pow(2,8*ue)-1;Ze(this,D,G,ue,Gt,0)}let Ne=1,He=0;for(this[G]=D&255;++He<ue&&(Ne*=256);)this[G+He]=D/Ne&255;return G+ue},m.prototype.writeUintBE=m.prototype.writeUIntBE=function(D,G,ue,xe){if(D=+D,G=G>>>0,ue=ue>>>0,!xe){const Gt=Math.pow(2,8*ue)-1;Ze(this,D,G,ue,Gt,0)}let Ne=ue-1,He=1;for(this[G+Ne]=D&255;--Ne>=0&&(He*=256);)this[G+Ne]=D/He&255;return G+ue},m.prototype.writeUint8=m.prototype.writeUInt8=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,1,255,0),this[G]=D&255,G+1},m.prototype.writeUint16LE=m.prototype.writeUInt16LE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,2,65535,0),this[G]=D&255,this[G+1]=D>>>8,G+2},m.prototype.writeUint16BE=m.prototype.writeUInt16BE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,2,65535,0),this[G]=D>>>8,this[G+1]=D&255,G+2},m.prototype.writeUint32LE=m.prototype.writeUInt32LE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,4,4294967295,0),this[G+3]=D>>>24,this[G+2]=D>>>16,this[G+1]=D>>>8,this[G]=D&255,G+4},m.prototype.writeUint32BE=m.prototype.writeUInt32BE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,4,4294967295,0),this[G]=D>>>24,this[G+1]=D>>>16,this[G+2]=D>>>8,this[G+3]=D&255,G+4};function qe(ee,D,G,ue,xe){xn(D,ue,xe,ee,G,7);let Ne=Number(D&BigInt(4294967295));ee[G++]=Ne,Ne=Ne>>8,ee[G++]=Ne,Ne=Ne>>8,ee[G++]=Ne,Ne=Ne>>8,ee[G++]=Ne;let He=Number(D>>BigInt(32)&BigInt(4294967295));return ee[G++]=He,He=He>>8,ee[G++]=He,He=He>>8,ee[G++]=He,He=He>>8,ee[G++]=He,G}function ft(ee,D,G,ue,xe){xn(D,ue,xe,ee,G,7);let Ne=Number(D&BigInt(4294967295));ee[G+7]=Ne,Ne=Ne>>8,ee[G+6]=Ne,Ne=Ne>>8,ee[G+5]=Ne,Ne=Ne>>8,ee[G+4]=Ne;let He=Number(D>>BigInt(32)&BigInt(4294967295));return ee[G+3]=He,He=He>>8,ee[G+2]=He,He=He>>8,ee[G+1]=He,He=He>>8,ee[G]=He,G+8}m.prototype.writeBigUInt64LE=Re(function(D,G=0){return qe(this,D,G,BigInt(0),BigInt("0xffffffffffffffff"))}),m.prototype.writeBigUInt64BE=Re(function(D,G=0){return ft(this,D,G,BigInt(0),BigInt("0xffffffffffffffff"))}),m.prototype.writeIntLE=function(D,G,ue,xe){if(D=+D,G=G>>>0,!xe){const Yt=Math.pow(2,8*ue-1);Ze(this,D,G,ue,Yt-1,-Yt)}let Ne=0,He=1,Gt=0;for(this[G]=D&255;++Ne<ue&&(He*=256);)D<0&&Gt===0&&this[G+Ne-1]!==0&&(Gt=1),this[G+Ne]=(D/He>>0)-Gt&255;return G+ue},m.prototype.writeIntBE=function(D,G,ue,xe){if(D=+D,G=G>>>0,!xe){const Yt=Math.pow(2,8*ue-1);Ze(this,D,G,ue,Yt-1,-Yt)}let Ne=ue-1,He=1,Gt=0;for(this[G+Ne]=D&255;--Ne>=0&&(He*=256);)D<0&&Gt===0&&this[G+Ne+1]!==0&&(Gt=1),this[G+Ne]=(D/He>>0)-Gt&255;return G+ue},m.prototype.writeInt8=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,1,127,-128),D<0&&(D=255+D+1),this[G]=D&255,G+1},m.prototype.writeInt16LE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,2,32767,-32768),this[G]=D&255,this[G+1]=D>>>8,G+2},m.prototype.writeInt16BE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,2,32767,-32768),this[G]=D>>>8,this[G+1]=D&255,G+2},m.prototype.writeInt32LE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,4,2147483647,-2147483648),this[G]=D&255,this[G+1]=D>>>8,this[G+2]=D>>>16,this[G+3]=D>>>24,G+4},m.prototype.writeInt32BE=function(D,G,ue){return D=+D,G=G>>>0,ue||Ze(this,D,G,4,2147483647,-2147483648),D<0&&(D=4294967295+D+1),this[G]=D>>>24,this[G+1]=D>>>16,this[G+2]=D>>>8,this[G+3]=D&255,G+4},m.prototype.writeBigInt64LE=Re(function(D,G=0){return qe(this,D,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),m.prototype.writeBigInt64BE=Re(function(D,G=0){return ft(this,D,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Et(ee,D,G,ue,xe,Ne){if(G+ue>ee.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("Index out of range")}function Bt(ee,D,G,ue,xe){return D=+D,G=G>>>0,xe||Et(ee,D,G,4),w.write(ee,D,G,ue,23,4),G+4}m.prototype.writeFloatLE=function(D,G,ue){return Bt(this,D,G,!0,ue)},m.prototype.writeFloatBE=function(D,G,ue){return Bt(this,D,G,!1,ue)};function kt(ee,D,G,ue,xe){return D=+D,G=G>>>0,xe||Et(ee,D,G,8),w.write(ee,D,G,ue,52,8),G+8}m.prototype.writeDoubleLE=function(D,G,ue){return kt(this,D,G,!0,ue)},m.prototype.writeDoubleBE=function(D,G,ue){return kt(this,D,G,!1,ue)},m.prototype.copy=function(D,G,ue,xe){if(!m.isBuffer(D))throw new TypeError("argument should be a Buffer");if(ue||(ue=0),!xe&&xe!==0&&(xe=this.length),G>=D.length&&(G=D.length),G||(G=0),xe>0&&xe<ue&&(xe=ue),xe===ue||D.length===0||this.length===0)return 0;if(G<0)throw new RangeError("targetStart out of bounds");if(ue<0||ue>=this.length)throw new RangeError("Index out of range");if(xe<0)throw new RangeError("sourceEnd out of bounds");xe>this.length&&(xe=this.length),D.length-G<xe-ue&&(xe=D.length-G+ue);const Ne=xe-ue;return this===D&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(G,ue,xe):Uint8Array.prototype.set.call(D,this.subarray(ue,xe),G),Ne},m.prototype.fill=function(D,G,ue,xe){if(typeof D=="string"){if(typeof G=="string"?(xe=G,G=0,ue=this.length):typeof ue=="string"&&(xe=ue,ue=this.length),xe!==void 0&&typeof xe!="string")throw new TypeError("encoding must be a string");if(typeof xe=="string"&&!m.isEncoding(xe))throw new TypeError("Unknown encoding: "+xe);if(D.length===1){const He=D.charCodeAt(0);(xe==="utf8"&&He<128||xe==="latin1")&&(D=He)}}else typeof D=="number"?D=D&255:typeof D=="boolean"&&(D=Number(D));if(G<0||this.length<G||this.length<ue)throw new RangeError("Out of range index");if(ue<=G)return this;G=G>>>0,ue=ue===void 0?this.length:ue>>>0,D||(D=0);let Ne;if(typeof D=="number")for(Ne=G;Ne<ue;++Ne)this[Ne]=D;else{const He=m.isBuffer(D)?D:m.from(D,xe),Gt=He.length;if(Gt===0)throw new TypeError('The value "'+D+'" is invalid for argument "value"');for(Ne=0;Ne<ue-G;++Ne)this[Ne+G]=He[Ne%Gt]}return this};const jt={};function nn(ee,D,G){jt[ee]=class extends G{constructor(){super(),Object.defineProperty(this,"message",{value:D.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ee}]`,this.stack,delete this.name}get code(){return ee}set code(xe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:xe,writable:!0})}toString(){return`${this.name} [${ee}]: ${this.message}`}}}nn("ERR_BUFFER_OUT_OF_BOUNDS",function(ee){return ee?`${ee} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),nn("ERR_INVALID_ARG_TYPE",function(ee,D){return`The "${ee}" argument must be of type number. Received type ${typeof D}`},TypeError),nn("ERR_OUT_OF_RANGE",function(ee,D,G){let ue=`The value of "${ee}" is out of range.`,xe=G;return Number.isInteger(G)&&Math.abs(G)>4294967296?xe=Jn(String(G)):typeof G=="bigint"&&(xe=String(G),(G>BigInt(2)**BigInt(32)||G<-(BigInt(2)**BigInt(32)))&&(xe=Jn(xe)),xe+="n"),ue+=` It must be ${D}. Received ${xe}`,ue},RangeError);function Jn(ee){let D="",G=ee.length;const ue=ee[0]==="-"?1:0;for(;G>=ue+4;G-=3)D=`_${ee.slice(G-3,G)}${D}`;return`${ee.slice(0,G)}${D}`}function kn(ee,D,G){Fn(D,"offset"),(ee[D]===void 0||ee[D+G]===void 0)&&Wn(D,ee.length-(G+1))}function xn(ee,D,G,ue,xe,Ne){if(ee>G||ee<D){const He=typeof D=="bigint"?"n":"";let Gt;throw D===0||D===BigInt(0)?Gt=`>= 0${He} and < 2${He} ** ${(Ne+1)*8}${He}`:Gt=`>= -(2${He} ** ${(Ne+1)*8-1}${He}) and < 2 ** ${(Ne+1)*8-1}${He}`,new jt.ERR_OUT_OF_RANGE("value",Gt,ee)}kn(ue,xe,Ne)}function Fn(ee,D){if(typeof ee!="number")throw new jt.ERR_INVALID_ARG_TYPE(D,"number",ee)}function Wn(ee,D,G){throw Math.floor(ee)!==ee?(Fn(ee,G),new jt.ERR_OUT_OF_RANGE("offset","an integer",ee)):D<0?new jt.ERR_BUFFER_OUT_OF_BOUNDS:new jt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${D}`,ee)}const Si=/[^+/0-9A-Za-z-_]/g;function Zn(ee){if(ee=ee.split("=")[0],ee=ee.trim().replace(Si,""),ee.length<2)return"";for(;ee.length%4!==0;)ee=ee+"=";return ee}function Ui(ee,D){D=D||1/0;let G;const ue=ee.length;let xe=null;const Ne=[];for(let He=0;He<ue;++He){if(G=ee.charCodeAt(He),G>55295&&G<57344){if(!xe){if(G>56319){(D-=3)>-1&&Ne.push(239,191,189);continue}else if(He+1===ue){(D-=3)>-1&&Ne.push(239,191,189);continue}xe=G;continue}if(G<56320){(D-=3)>-1&&Ne.push(239,191,189),xe=G;continue}G=(xe-55296<<10|G-56320)+65536}else xe&&(D-=3)>-1&&Ne.push(239,191,189);if(xe=null,G<128){if((D-=1)<0)break;Ne.push(G)}else if(G<2048){if((D-=2)<0)break;Ne.push(G>>6|192,G&63|128)}else if(G<65536){if((D-=3)<0)break;Ne.push(G>>12|224,G>>6&63|128,G&63|128)}else if(G<1114112){if((D-=4)<0)break;Ne.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw new Error("Invalid code point")}return Ne}function Qi(ee){const D=[];for(let G=0;G<ee.length;++G)D.push(ee.charCodeAt(G)&255);return D}function Kn(ee,D){let G,ue,xe;const Ne=[];for(let He=0;He<ee.length&&!((D-=2)<0);++He)G=ee.charCodeAt(He),ue=G>>8,xe=G%256,Ne.push(xe),Ne.push(ue);return Ne}function Mt(ee){return u.toByteArray(Zn(ee))}function Ce(ee,D,G,ue){let xe;for(xe=0;xe<ue&&!(xe+G>=D.length||xe>=ee.length);++xe)D[xe+G]=ee[xe];return xe}function ye(ee,D){return ee instanceof D||ee!=null&&ee.constructor!=null&&ee.constructor.name!=null&&ee.constructor.name===D.name}function Fe(ee){return ee!==ee}const Se=function(){const ee="0123456789abcdef",D=new Array(256);for(let G=0;G<16;++G){const ue=G*16;for(let xe=0;xe<16;++xe)D[ue+xe]=ee[G]+ee[xe]}return D}();function Re(ee){return typeof BigInt>"u"?Ue:ee}function Ue(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":W=>{W.exports=function($){var A=[];return A.toString=function(){return this.map(function(w){var h="",v=typeof w[5]<"u";return w[4]&&(h+="@supports (".concat(w[4],") {")),w[2]&&(h+="@media ".concat(w[2]," {")),v&&(h+="@layer".concat(w[5].length>0?" ".concat(w[5]):""," {")),h+=$(w),v&&(h+="}"),w[2]&&(h+="}"),w[4]&&(h+="}"),h}).join("")},A.i=function(w,h,v,a,f){typeof w=="string"&&(w=[[null,w,void 0]]);var m={};if(v)for(var l=0;l<this.length;l++){var y=this[l][0];y!=null&&(m[y]=!0)}for(var g=0;g<w.length;g++){var d=[].concat(w[g]);v&&m[d[0]]||(typeof f<"u"&&(typeof d[5]>"u"||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=f),h&&(d[2]&&(d[1]="@media ".concat(d[2]," {").concat(d[1],"}")),d[2]=h),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),A.push(d))}},A}},"./node_modules/css-loader/dist/runtime/getUrl.js":W=>{W.exports=function($,A){return A||(A={}),$&&($=String($.__esModule?$.default:$),/^['"].*['"]$/.test($)&&($=$.slice(1,-1)),A.hash&&($+=A.hash),/["'() \t\n]|(%20)/.test($)||A.needQuotes?'"'.concat($.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):$)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":W=>{W.exports=function($){var A=$[1],u=$[3];if(!u)return A;if(typeof btoa=="function"){var w=btoa(unescape(encodeURIComponent(JSON.stringify(u)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(w),v="/*# ".concat(h," */");return[A].concat([v]).join(`
`)}return[A].join(`
`)}},"./node_modules/debug/node_modules/ms/index.js":W=>{var $=1e3,A=$*60,u=A*60,w=u*24,h=w*7,v=w*365.25;W.exports=function(y,g){g=g||{};var d=typeof y;if(d==="string"&&y.length>0)return a(y);if(d==="number"&&isFinite(y))return g.long?m(y):f(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function a(y){if(y=String(y),!(y.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(g){var d=parseFloat(g[1]),p=(g[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return d*v;case"weeks":case"week":case"w":return d*h;case"days":case"day":case"d":return d*w;case"hours":case"hour":case"hrs":case"hr":case"h":return d*u;case"minutes":case"minute":case"mins":case"min":case"m":return d*A;case"seconds":case"second":case"secs":case"sec":case"s":return d*$;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function f(y){var g=Math.abs(y);return g>=w?Math.round(y/w)+"d":g>=u?Math.round(y/u)+"h":g>=A?Math.round(y/A)+"m":g>=$?Math.round(y/$)+"s":y+"ms"}function m(y){var g=Math.abs(y);return g>=w?l(y,g,w,"day"):g>=u?l(y,g,u,"hour"):g>=A?l(y,g,A,"minute"):g>=$?l(y,g,$,"second"):y+" ms"}function l(y,g,d,p){var C=g>=d*1.5;return Math.round(y/d)+" "+p+(C?"s":"")}},"./node_modules/debug/src/browser.js":(W,$,A)=>{$.formatArgs=w,$.save=h,$.load=v,$.useColors=u,$.storage=a(),$.destroy=(()=>{let m=!1;return()=>{m||(m=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),$.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function u(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function w(m){if(m[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+m[0]+(this.useColors?"%c ":" ")+"+"+W.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;m.splice(1,0,l,"color: inherit");let y=0,g=0;m[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(y++,d==="%c"&&(g=y))}),m.splice(g,0,l)}$.log=console.debug||console.log||(()=>{});function h(m){try{m?$.storage.setItem("debug",m):$.storage.removeItem("debug")}catch{}}function v(){let m;try{m=$.storage.getItem("debug")}catch{}return!m&&typeof process<"u"&&"env"in process&&(m=na.DEBUG),m}function a(){try{return localStorage}catch{}}W.exports=A("./node_modules/debug/src/common.js")($);const{formatters:f}=W.exports;f.j=function(m){try{return JSON.stringify(m)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}},"./node_modules/debug/src/common.js":(W,$,A)=>{function u(w){v.debug=v,v.default=v,v.coerce=g,v.disable=m,v.enable=f,v.enabled=l,v.humanize=A("./node_modules/debug/node_modules/ms/index.js"),v.destroy=d,Object.keys(w).forEach(p=>{v[p]=w[p]}),v.names=[],v.skips=[],v.formatters={};function h(p){let C=0;for(let S=0;S<p.length;S++)C=(C<<5)-C+p.charCodeAt(S),C|=0;return v.colors[Math.abs(C)%v.colors.length]}v.selectColor=h;function v(p){let C,S=null,_,L;function T(...N){if(!T.enabled)return;const F=T,te=Number(new Date),K=te-(C||te);F.diff=K,F.prev=C,F.curr=te,C=te,N[0]=v.coerce(N[0]),typeof N[0]!="string"&&N.unshift("%O");let se=0;N[0]=N[0].replace(/%([a-zA-Z%])/g,(re,Y)=>{if(re==="%%")return"%";se++;const k=v.formatters[Y];if(typeof k=="function"){const oe=N[se];re=k.call(F,oe),N.splice(se,1),se--}return re}),v.formatArgs.call(F,N),(F.log||v.log).apply(F,N)}return T.namespace=p,T.useColors=v.useColors(),T.color=v.selectColor(p),T.extend=a,T.destroy=v.destroy,Object.defineProperty(T,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(_!==v.namespaces&&(_=v.namespaces,L=v.enabled(p)),L),set:N=>{S=N}}),typeof v.init=="function"&&v.init(T),T}function a(p,C){const S=v(this.namespace+(typeof C>"u"?":":C)+p);return S.log=this.log,S}function f(p){v.save(p),v.namespaces=p,v.names=[],v.skips=[];let C;const S=(typeof p=="string"?p:"").split(/[\s,]+/),_=S.length;for(C=0;C<_;C++)S[C]&&(p=S[C].replace(/\*/g,".*?"),p[0]==="-"?v.skips.push(new RegExp("^"+p.slice(1)+"$")):v.names.push(new RegExp("^"+p+"$")))}function m(){const p=[...v.names.map(y),...v.skips.map(y).map(C=>"-"+C)].join(",");return v.enable(""),p}function l(p){if(p[p.length-1]==="*")return!0;let C,S;for(C=0,S=v.skips.length;C<S;C++)if(v.skips[C].test(p))return!1;for(C=0,S=v.names.length;C<S;C++)if(v.names[C].test(p))return!0;return!1}function y(p){return p.toString().substring(2,p.toString().length-2).replace(/\.\*\?$/,"*")}function g(p){return p instanceof Error?p.stack||p.message:p}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return v.enable(v.load()),v}W.exports=u},"./node_modules/deep-assign/index.js":(W,$,A)=>{var u=A("./node_modules/is-obj/index.js"),w=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;function v(m){if(m==null)throw new TypeError("Sources cannot be null or undefined");return Object(m)}function a(m,l,y){var g=l[y];if(g!=null){if(w.call(m,y)&&(m[y]===void 0||m[y]===null))throw new TypeError("Cannot convert undefined or null to object ("+y+")");!w.call(m,y)||!u(g)?m[y]=g:m[y]=f(Object(m[y]),l[y])}}function f(m,l){if(m===l)return m;l=Object(l);for(var y in l)w.call(l,y)&&a(m,l,y);if(Object.getOwnPropertySymbols)for(var g=Object.getOwnPropertySymbols(l),d=0;d<g.length;d++)h.call(l,g[d])&&a(m,l,g[d]);return m}W.exports=function(l){l=v(l);for(var y=1;y<arguments.length;y++)f(l,arguments[y]);return l}},"./node_modules/dtype/index.js":W=>{W.exports=function($){switch($){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(W,$,A)=>{var u;typeof window<"u"?u=window:typeof A.g<"u"?u=A.g:typeof self<"u"?u=self:u={},W.exports=u},"./node_modules/ieee754/index.js":(W,$)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */$.read=function(A,u,w,h,v){var a,f,m=v*8-h-1,l=(1<<m)-1,y=l>>1,g=-7,d=w?v-1:0,p=w?-1:1,C=A[u+d];for(d+=p,a=C&(1<<-g)-1,C>>=-g,g+=m;g>0;a=a*256+A[u+d],d+=p,g-=8);for(f=a&(1<<-g)-1,a>>=-g,g+=h;g>0;f=f*256+A[u+d],d+=p,g-=8);if(a===0)a=1-y;else{if(a===l)return f?NaN:(C?-1:1)*(1/0);f=f+Math.pow(2,h),a=a-y}return(C?-1:1)*f*Math.pow(2,a-h)},$.write=function(A,u,w,h,v,a){var f,m,l,y=a*8-v-1,g=(1<<y)-1,d=g>>1,p=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=h?0:a-1,S=h?1:-1,_=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(m=isNaN(u)?1:0,f=g):(f=Math.floor(Math.log(u)/Math.LN2),u*(l=Math.pow(2,-f))<1&&(f--,l*=2),f+d>=1?u+=p/l:u+=p*Math.pow(2,1-d),u*l>=2&&(f++,l/=2),f+d>=g?(m=0,f=g):f+d>=1?(m=(u*l-1)*Math.pow(2,v),f=f+d):(m=u*Math.pow(2,d-1)*Math.pow(2,v),f=0));v>=8;A[w+C]=m&255,C+=S,m/=256,v-=8);for(f=f<<v|m,y+=v;y>0;A[w+C]=f&255,C+=S,f/=256,y-=8);A[w+C-S]|=_*128}},"./node_modules/is-buffer/index.js":W=>{/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */W.exports=function(u){return u!=null&&($(u)||A(u)||!!u._isBuffer)};function $(u){return!!u.constructor&&typeof u.constructor.isBuffer=="function"&&u.constructor.isBuffer(u)}function A(u){return typeof u.readFloatLE=="function"&&typeof u.slice=="function"&&$(u.slice(0,0))}},"./node_modules/is-function/index.js":W=>{W.exports=A;var $=Object.prototype.toString;function A(u){if(!u)return!1;var w=$.call(u);return w==="[object Function]"||typeof u=="function"&&w!=="[object RegExp]"||typeof window<"u"&&(u===window.setTimeout||u===window.alert||u===window.confirm||u===window.prompt)}},"./node_modules/is-obj/index.js":W=>{W.exports=function($){var A=typeof $;return $!==null&&(A==="object"||A==="function")}},"./node_modules/layout-bmfont-text/index.js":(W,$,A)=>{var u=A("./node_modules/word-wrapper/index.js"),w=A("./node_modules/xtend/immutable.js"),h=A("./node_modules/as-number/index.js"),v=["x","e","a","o","n","s","r","c","u","m","v","w","z"],a=["m","w"],f=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],m=9,l=32,y=0,g=1,d=2;W.exports=function(ne){return new p(ne)};function p(se){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(se)}p.prototype.update=function(se){if(se=w({measure:this._measure},se),this._opt=se,this._opt.tabSize=h(this._opt.tabSize,4),!se.font)throw new Error("must provide a valid bitmap font");var ne=this.glyphs,re=se.text||"",Y=se.font;this._setupSpaceGlyphs(Y);var k=u.lines(re,se),oe=se.width||0;ne.length=0;var ae=k.reduce(function(Ze,qe){return Math.max(Ze,qe.width,oe)},0),Ae=0,b=0,I=h(se.lineHeight,Y.common.lineHeight),O=Y.common.base,Q=I-O,J=se.letterSpacing||0,ve=I*k.length-Q,Le=te(this._opt.align);b-=ve,this._width=ae,this._height=ve,this._descender=I-O,this._baseline=O,this._xHeight=L(Y),this._capHeight=N(Y),this._lineHeight=I,this._ascender=I-Q-this._xHeight;var _e=this;k.forEach(function(Ze,qe){for(var ft=Ze.start,Et=Ze.end,Bt=Ze.width,kt,jt=ft;jt<Et;jt++){var nn=re.charCodeAt(jt),Jn=_e.getGlyph(Y,nn);if(Jn){kt&&(Ae+=F(Y,kt.id,Jn.id));var kn=Ae;Le===g?kn+=(ae-Bt)/2:Le===d&&(kn+=ae-Bt),ne.push({position:[kn,b],data:Jn,index:jt,line:qe}),Ae+=Jn.xadvance+J,kt=Jn}}b+=I,Ae=0}),this._linesTotal=k.length},p.prototype._setupSpaceGlyphs=function(se){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!se.chars||se.chars.length===0)){var ne=_(se,l)||T(se)||se.chars[0],re=this._opt.tabSize*ne.xadvance;this._fallbackSpaceGlyph=ne,this._fallbackTabGlyph=w(ne,{x:0,y:0,xadvance:re,id:m,xoffset:0,yoffset:0,width:0,height:0})}},p.prototype.getGlyph=function(se,ne){var re=_(se,ne);return re||(ne===m?this._fallbackTabGlyph:ne===l?this._fallbackSpaceGlyph:null)},p.prototype.computeMetrics=function(se,ne,re,Y){var k=this._opt.letterSpacing||0,oe=this._opt.font,ae=0,Ae=0,b=0,I,O;if(!oe.chars||oe.chars.length===0)return{start:ne,end:ne,width:0};re=Math.min(se.length,re);for(var Q=ne;Q<re;Q++){var J=se.charCodeAt(Q),I=this.getGlyph(oe,J);if(I){I.xoffset;var ve=O?F(oe,O.id,I.id):0;ae+=ve;var Le=ae+I.xadvance+k,_e=ae+I.width;if(_e>=Y||Le>=Y)break;ae=Le,Ae=_e,O=I}b++}return O&&(Ae+=O.xoffset),{start:ne,end:ne+b,width:Ae}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(C);function C(se){Object.defineProperty(p.prototype,se,{get:S(se),configurable:!0})}function S(se){return new Function(["return function "+se+"() {","  return this._"+se,"}"].join(`
`))()}function _(se,ne){if(!se.chars||se.chars.length===0)return null;var re=K(se.chars,ne);return re>=0?se.chars[re]:null}function L(se){for(var ne=0;ne<v.length;ne++){var re=v[ne].charCodeAt(0),Y=K(se.chars,re);if(Y>=0)return se.chars[Y].height}return 0}function T(se){for(var ne=0;ne<a.length;ne++){var re=a[ne].charCodeAt(0),Y=K(se.chars,re);if(Y>=0)return se.chars[Y]}return 0}function N(se){for(var ne=0;ne<f.length;ne++){var re=f[ne].charCodeAt(0),Y=K(se.chars,re);if(Y>=0)return se.chars[Y].height}return 0}function F(se,ne,re){if(!se.kernings||se.kernings.length===0)return 0;for(var Y=se.kernings,k=0;k<Y.length;k++){var oe=Y[k];if(oe.first===ne&&oe.second===re)return oe.amount}return 0}function te(se){return se==="center"?g:se==="right"?d:y}function K(se,ne,re){re=re||0;for(var Y=re;Y<se.length;Y++)if(se[Y].id===ne)return Y;return-1}},"./node_modules/load-bmfont/browser.js":(W,$,A)=>{var u=A("./node_modules/buffer/index.js").Buffer,w=A("./node_modules/xhr/index.js"),h=function(){},v=A("./node_modules/parse-bmfont-ascii/index.js"),a=A("./node_modules/parse-bmfont-xml/lib/browser.js"),f=A("./node_modules/parse-bmfont-binary/index.js"),m=A("./node_modules/load-bmfont/lib/is-binary.js"),l=A("./node_modules/xtend/immutable.js"),y=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();W.exports=function(p,C){C=typeof C=="function"?C:h,typeof p=="string"?p={uri:p}:p||(p={});var S=p.binary;S&&(p=d(p)),w(p,function(_,L,T){if(_)return C(_);if(!/^2/.test(L.statusCode))return C(new Error("http status code: "+L.statusCode));if(!T)return C(new Error("no body result"));var N=!1;if(g(T)){var F=new Uint8Array(T);T=u.from(F,"binary")}m(T)&&(N=!0,typeof T=="string"&&(T=u.from(T,"binary"))),N||(u.isBuffer(T)&&(T=T.toString(p.encoding)),T=T.trim());var te;try{var K=L.headers["content-type"];N?te=f(T):/json/.test(K)||T.charAt(0)==="{"?te=JSON.parse(T):/xml/.test(K)||T.charAt(0)==="<"?te=a(T):te=v(T)}catch(se){C(new Error("error parsing font "+se.message)),C=h}C(null,te)})};function g(p){var C=Object.prototype.toString;return C.call(p)==="[object ArrayBuffer]"}function d(p){if(y)return l(p,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var C=new self.XMLHttpRequest;return C.overrideMimeType("text/plain; charset=x-user-defined"),l({xhr:C},p)}},"./node_modules/load-bmfont/lib/is-binary.js":(W,$,A)=>{var u=A("./node_modules/buffer/index.js").Buffer,w=A("./node_modules/buffer-equal/index.js"),h=u.from([66,77,70,3]);W.exports=function(v){return typeof v=="string"?v.substring(0,3)==="BMF":v.length>4&&w(v.slice(0,4),h)}},"./node_modules/parse-bmfont-ascii/index.js":W=>{W.exports=function(h){if(!h)throw new Error("no data provided");h=h.toString().trim();var v={pages:[],chars:[],kernings:[]},a=h.split(/\r\n?|\n/g);if(a.length===0)throw new Error("no data in BMFont file");for(var f=0;f<a.length;f++){var m=$(a[f],f);if(m)if(m.key==="page"){if(typeof m.data.id!="number")throw new Error("malformed file at line "+f+" -- needs page id=N");if(typeof m.data.file!="string")throw new Error("malformed file at line "+f+' -- needs page file="path"');v.pages[m.data.id]=m.data.file}else m.key==="chars"||m.key==="kernings"||(m.key==="char"?v.chars.push(m.data):m.key==="kerning"?v.kernings.push(m.data):v[m.key]=m.data)}return v};function $(w,h){if(w=w.replace(/\t+/g," ").trim(),!w)return null;var v=w.indexOf(" ");if(v===-1)throw new Error("no named row at line "+h);var a=w.substring(0,v);w=w.substring(v+1),w=w.replace(/letter=[\'\"]\S+[\'\"]/gi,""),w=w.split("="),w=w.map(function(g){return g.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var f=[],m=0;m<w.length;m++){var l=w[m];m===0?f.push({key:l[0],data:""}):m===w.length-1?f[f.length-1].data=A(l[0]):(f[f.length-1].data=A(l[0]),f.push({key:l[1],data:""}))}var y={key:a,data:{}};return f.forEach(function(g){y.data[g.key]=g.data}),y}function A(w){return!w||w.length===0?"":w.indexOf('"')===0||w.indexOf("'")===0?w.substring(1,w.length-1):w.indexOf(",")!==-1?u(w):parseInt(w,10)}function u(w){return w.split(",").map(function(h){return parseInt(h,10)})}},"./node_modules/parse-bmfont-binary/index.js":W=>{var $=[66,77,70];W.exports=function(y){if(y.length<6)throw new Error("invalid buffer length for BMFont");var g=$.every(function(_,L){return y.readUInt8(L)===_});if(!g)throw new Error("BMFont missing BMF byte header");var d=3,p=y.readUInt8(d++);if(p>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var C={kernings:[],chars:[]},S=0;S<5;S++)d+=A(C,y,d);return C};function A(l,y,g){if(g>y.length-1)return 0;var d=y.readUInt8(g++),p=y.readInt32LE(g);switch(g+=4,d){case 1:l.info=u(y,g);break;case 2:l.common=w(y,g);break;case 3:l.pages=h(y,g,p);break;case 4:l.chars=v(y,g,p);break;case 5:l.kernings=a(y,g,p);break}return 5+p}function u(l,y){var g={};g.size=l.readInt16LE(y);var d=l.readUInt8(y+2);return g.smooth=d>>7&1,g.unicode=d>>6&1,g.italic=d>>5&1,g.bold=d>>4&1,d>>3&1&&(g.fixedHeight=1),g.charset=l.readUInt8(y+3)||"",g.stretchH=l.readUInt16LE(y+4),g.aa=l.readUInt8(y+6),g.padding=[l.readInt8(y+7),l.readInt8(y+8),l.readInt8(y+9),l.readInt8(y+10)],g.spacing=[l.readInt8(y+11),l.readInt8(y+12)],g.outline=l.readUInt8(y+13),g.face=m(l,y+14),g}function w(l,y){var g={};return g.lineHeight=l.readUInt16LE(y),g.base=l.readUInt16LE(y+2),g.scaleW=l.readUInt16LE(y+4),g.scaleH=l.readUInt16LE(y+6),g.pages=l.readUInt16LE(y+8),l.readUInt8(y+10),g.packed=0,g.alphaChnl=l.readUInt8(y+11),g.redChnl=l.readUInt8(y+12),g.greenChnl=l.readUInt8(y+13),g.blueChnl=l.readUInt8(y+14),g}function h(l,y,g){for(var d=[],p=f(l,y),C=p.length+1,S=g/C,_=0;_<S;_++)d[_]=l.slice(y,y+p.length).toString("utf8"),y+=C;return d}function v(l,y,g){for(var d=[],p=g/20,C=0;C<p;C++){var S={},_=C*20;S.id=l.readUInt32LE(y+0+_),S.x=l.readUInt16LE(y+4+_),S.y=l.readUInt16LE(y+6+_),S.width=l.readUInt16LE(y+8+_),S.height=l.readUInt16LE(y+10+_),S.xoffset=l.readInt16LE(y+12+_),S.yoffset=l.readInt16LE(y+14+_),S.xadvance=l.readInt16LE(y+16+_),S.page=l.readUInt8(y+18+_),S.chnl=l.readUInt8(y+19+_),d[C]=S}return d}function a(l,y,g){for(var d=[],p=g/10,C=0;C<p;C++){var S={},_=C*10;S.first=l.readUInt32LE(y+0+_),S.second=l.readUInt32LE(y+4+_),S.amount=l.readInt16LE(y+8+_),d[C]=S}return d}function f(l,y){for(var g=y;g<l.length&&l[g]!==0;g++);return l.slice(y,g)}function m(l,y){return f(l,y).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(W,$,A)=>{var u=A("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),w=A("./node_modules/xml-parse-from-string/index.js"),h={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};W.exports=function(l){l=l.toString();var y=w(l),g={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(T){var N=y.getElementsByTagName(T)[0];N&&(g[T]=u(v(N)))});var d=y.getElementsByTagName("pages")[0];if(!d)throw new Error("malformed file -- no <pages> element");for(var p=d.getElementsByTagName("page"),C=0;C<p.length;C++){var S=p[C],_=parseInt(S.getAttribute("id"),10),L=S.getAttribute("file");if(isNaN(_))throw new Error('malformed file -- page "id" attribute is NaN');if(!L)throw new Error('malformed file -- needs page "file" attribute');g.pages[parseInt(_,10)]=L}return["chars","kernings"].forEach(function(T){var N=y.getElementsByTagName(T)[0];if(N)for(var F=T.substring(0,T.length-1),te=N.getElementsByTagName(F),K=0;K<te.length;K++){var se=te[K];g[T].push(u(v(se)))}}),g};function v(m){var l=a(m);return l.reduce(function(y,g){var d=f(g.nodeName);return y[d]=g.nodeValue,y},{})}function a(m){for(var l=[],y=0;y<m.attributes.length;y++)l.push(m.attributes[y]);return l}function f(m){return h[m.toLowerCase()]||m}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":W=>{var $="chasrset";W.exports=function(w){$ in w&&(w.charset=w[$],delete w[$]);for(var h in w)h==="face"||h==="charset"||(h==="padding"||h==="spacing"?w[h]=A(w[h]):w[h]=parseInt(w[h],10));return w};function A(u){return u.split(",").map(function(w){return parseInt(w,10)})}},"./node_modules/parse-headers/parse-headers.js":W=>{var $=function(u){return u.replace(/^\s+|\s+$/g,"")},A=function(u){return Object.prototype.toString.call(u)==="[object Array]"};W.exports=function(u){if(!u)return{};for(var w={},h=$(u).split(`
`),v=0;v<h.length;v++){var a=h[v],f=a.indexOf(":"),m=$(a.slice(0,f)).toLowerCase(),l=$(a.slice(f+1));typeof w[m]>"u"?w[m]=l:A(w[m])?w[m].push(l):w[m]=[w[m],l]}return w}},"./node_modules/quad-indices/index.js":(W,$,A)=>{var u=A("./node_modules/dtype/index.js"),w=A("./node_modules/an-array/index.js"),h=A("./node_modules/is-buffer/index.js"),v=[0,2,3],a=[2,1,3];W.exports=function(m,l){(!m||!(w(m)||h(m)))&&(l=m||{},m=null),typeof l=="number"?l={count:l}:l=l||{};for(var y=typeof l.type=="string"?l.type:"uint16",g=typeof l.count=="number"?l.count:1,d=l.start||0,p=l.clockwise!==!1?v:a,C=p[0],S=p[1],_=p[2],L=g*6,T=m||new(u(y))(L),N=0,F=0;N<L;N+=6,F+=4){var te=N+d;T[te+0]=F+0,T[te+1]=F+1,T[te+2]=F+2,T[te+3]=F+C,T[te+4]=F+S,T[te+5]=F+_}return T}},"./node_modules/super-animejs/lib/anime.es.js":(W,$,A)=>{A.r($),A.d($,{default:()=>es});var u={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},w={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},h=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],v={CSS:{},springs:{}};function a(Ie,Ge,tt){return Math.min(Math.max(Ie,Ge),tt)}function f(Ie,Ge){return Ie.indexOf(Ge)>-1}function m(Ie,Ge){return Ie.apply(null,Ge)}var l=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,y=/^rgb/,g=/^hsl/,d={arr:function(Ie){return Array.isArray(Ie)},obj:function(Ie){return f(Object.prototype.toString.call(Ie),"Object")},pth:function(Ie){return d.obj(Ie)&&Ie.hasOwnProperty("totalLength")},svg:function(Ie){return Ie instanceof SVGElement},inp:function(Ie){return Ie instanceof HTMLInputElement},dom:function(Ie){return Ie.nodeType||d.svg(Ie)},str:function(Ie){return typeof Ie=="string"},fnc:function(Ie){return typeof Ie=="function"},und:function(Ie){return typeof Ie>"u"},hex:function(Ie){return l.test(Ie)},rgb:function(Ie){return y.test(Ie)},hsl:function(Ie){return g.test(Ie)},col:function(Ie){return d.hex(Ie)||d.rgb(Ie)||d.hsl(Ie)},key:function(Ie){return!u.hasOwnProperty(Ie)&&!w.hasOwnProperty(Ie)&&Ie!=="targets"&&Ie!=="keyframes"}},p=/\(([^)]+)\)/;function C(Ie){var Ge=p.exec(Ie);return Ge?Ge[1].split(",").map(function(tt){return parseFloat(tt)}):[]}function S(Ie,Ge){var tt=C(Ie),At=a(d.und(tt[0])?1:tt[0],.1,100),lt=a(d.und(tt[1])?100:tt[1],.1,100),wt=a(d.und(tt[2])?10:tt[2],.1,100),Ft=a(d.und(tt[3])?0:tt[3],.1,100),yn=Math.sqrt(lt/At),tn=wt/(2*Math.sqrt(lt*At)),bt=tn<1?yn*Math.sqrt(1-tn*tn):0,Rn=1,Pn=tn<1?(tn*yn+-Ft)/bt:-Ft+yn;function Xn(si){var ti=Ge?Ge*si/1e3:si;return tn<1?ti=Math.exp(-ti*tn*yn)*(Rn*Math.cos(bt*ti)+Pn*Math.sin(bt*ti)):ti=(Rn+Pn*ti)*Math.exp(-ti*yn),si===0||si===1?si:1-ti}function Di(){var si=v.springs[Ie];if(si)return si;for(var ti=1/6,pi=0,Wi=0;;)if(pi+=ti,Xn(pi)===1){if(Wi++,Wi>=16)break}else Wi=0;var Vi=pi*ti*1e3;return v.springs[Ie]=Vi,Vi}return Ge?Xn:Di}function _(Ie,Ge){Ie===void 0&&(Ie=1),Ge===void 0&&(Ge=.5);var tt=a(Ie,1,10),At=a(Ge,.1,2);return function(lt){return lt===0||lt===1?lt:-tt*Math.pow(2,10*(lt-1))*Math.sin((lt-1-At/(Math.PI*2)*Math.asin(1/tt))*(Math.PI*2)/At)}}function L(Ie){return Ie===void 0&&(Ie=10),function(Ge){return Math.round(Ge*Ie)*(1/Ie)}}var T=function(){var Ie=11,Ge=1/(Ie-1);function tt(Rn,Pn){return 1-3*Pn+3*Rn}function At(Rn,Pn){return 3*Pn-6*Rn}function lt(Rn){return 3*Rn}function wt(Rn,Pn,Xn){return((tt(Pn,Xn)*Rn+At(Pn,Xn))*Rn+lt(Pn))*Rn}function Ft(Rn,Pn,Xn){return 3*tt(Pn,Xn)*Rn*Rn+2*At(Pn,Xn)*Rn+lt(Pn)}function yn(Rn,Pn,Xn,Di,si){var ti,pi,Wi=0;do pi=Pn+(Xn-Pn)/2,ti=wt(pi,Di,si)-Rn,ti>0?Xn=pi:Pn=pi;while(Math.abs(ti)>1e-7&&++Wi<10);return pi}function tn(Rn,Pn,Xn,Di){for(var si=0;si<4;++si){var ti=Ft(Pn,Xn,Di);if(ti===0)return Pn;var pi=wt(Pn,Xn,Di)-Rn;Pn-=pi/ti}return Pn}function bt(Rn,Pn,Xn,Di){if(!(0<=Rn&&Rn<=1&&0<=Xn&&Xn<=1))return;var si=new Float32Array(Ie);if(Rn!==Pn||Xn!==Di)for(var ti=0;ti<Ie;++ti)si[ti]=wt(ti*Ge,Rn,Xn);function pi(Wi){for(var Vi=0,on=1,oi=Ie-1;on!==oi&&si[on]<=Wi;++on)Vi+=Ge;--on;var or=(Wi-si[on])/(si[on+1]-si[on]),gi=Vi+or*Ge,z=Ft(gi,Rn,Xn);return z>=.001?tn(Wi,gi,Rn,Xn):z===0?gi:yn(Wi,Vi,Vi+Ge,Rn,Xn)}return function(Wi){return Rn===Pn&&Xn===Di||Wi===0||Wi===1?Wi:wt(pi(Wi),Pn,Di)}}return bt}(),N=function(){var Ie=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],Ge={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],_],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(Ft,yn){return function(tn){return 1-_(Ft,yn)(1-tn)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(Ft,yn){return function(tn){return tn<.5?_(Ft,yn)(tn*2)/2:1-_(Ft,yn)(tn*-2+2)/2}}]},tt={linear:[.25,.25,.75,.75]};for(var At in Ge)for(var lt=0,wt=Ge[At].length;lt<wt;lt++)tt["ease"+At+Ie[lt]]=Ge[At][lt];return tt}();function F(Ie,Ge){if(d.fnc(Ie))return Ie;var tt=Ie.split("(")[0],At=N[tt],lt=C(Ie);switch(tt){case"spring":return S(Ie,Ge);case"cubicBezier":return m(T,lt);case"steps":return m(L,lt);default:return d.fnc(At)?m(At,lt):m(T,At)}}function te(Ie){try{var Ge=document.querySelectorAll(Ie);return Ge}catch{return}}var K=[];function se(Ie,Ge){for(var tt=K,At=Ie.length,lt=arguments.length>=2?arguments[1]:void 0,wt=0;wt<At;wt++)if(wt in Ie){var Ft=Ie[wt];Ge.call(lt,Ft,wt,Ie)&&tt.push(Ft)}return K=Ie,K.length=0,tt}function ne(Ie,Ge){Ge||(Ge=[]);for(var tt=0,At=Ie.length;tt<At;tt++){var lt=Ie[tt];Array.isArray(lt)?ne(lt,Ge):Ge.push(lt)}return Ge}function re(Ie){return d.arr(Ie)?Ie:(d.str(Ie)&&(Ie=te(Ie)||Ie),Ie instanceof NodeList||Ie instanceof HTMLCollection?[].slice.call(Ie):[Ie])}function Y(Ie,Ge){return Ie.some(function(tt){return tt===Ge})}function k(Ie){var Ge={};for(var tt in Ie)Ge[tt]=Ie[tt];return Ge}function oe(Ie,Ge){var tt=k(Ie);for(var At in Ie)tt[At]=Ge.hasOwnProperty(At)?Ge[At]:Ie[At];return tt}function ae(Ie,Ge){var tt=k(Ie);for(var At in Ge)tt[At]=d.und(Ie[At])?Ge[At]:Ie[At];return tt}var Ae=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function b(Ie){var Ge=Ae.exec(Ie);return Ge?"rgba("+Ge[1]+",1)":Ie}var I=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,O=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function Q(Ie){var Ge=Ie.replace(I,function(Ft,yn,tn,bt){return yn+yn+tn+tn+bt+bt}),tt=O.exec(Ge),At=parseInt(tt[1],16),lt=parseInt(tt[2],16),wt=parseInt(tt[3],16);return"rgba("+At+","+lt+","+wt+",1)"}var J=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,ve=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Le(Ie){var Ge=J.exec(Ie)||ve.exec(Ie),tt=parseInt(Ge[1],10)/360,At=parseInt(Ge[2],10)/100,lt=parseInt(Ge[3],10)/100,wt=Ge[4]||1;function Ft(Xn,Di,si){return si<0&&(si+=1),si>1&&(si-=1),si<.16666666666666666?Xn+(Di-Xn)*6*si:si<.5?Di:si<.6666666666666666?Xn+(Di-Xn)*(.6666666666666666-si)*6:Xn}var yn,tn,bt;if(At==0)yn=tn=bt=lt;else{var Rn=lt<.5?lt*(1+At):lt+At-lt*At,Pn=2*lt-Rn;yn=Ft(Pn,Rn,tt+.3333333333333333),tn=Ft(Pn,Rn,tt),bt=Ft(Pn,Rn,tt-.3333333333333333)}return"rgba("+yn*255+","+tn*255+","+bt*255+","+wt+")"}function _e(Ie){if(d.rgb(Ie))return b(Ie);if(d.hex(Ie))return Q(Ie);if(d.hsl(Ie))return Le(Ie)}var Ze=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function qe(Ie){var Ge=Ze.exec(Ie);if(Ge)return Ge[2]}function ft(Ie){if(f(Ie,"translate")||Ie==="perspective")return"px";if(f(Ie,"rotate")||f(Ie,"skew"))return"deg"}function Et(Ie,Ge){return d.fnc(Ie)?Ie(Ge.target,Ge.id,Ge.total):Ie}function Bt(Ie,Ge){return Ie.getAttribute(Ge)}function kt(Ie,Ge,tt){var At=qe(Ge);if(Y([tt,"deg","rad","turn"],At))return Ge;var lt=v.CSS[Ge+tt];if(!d.und(lt))return lt;var wt=100,Ft=document.createElement(Ie.tagName),yn=Ie.parentNode&&Ie.parentNode!==document?Ie.parentNode:document.body;yn.appendChild(Ft),Ft.style.position="absolute",Ft.style.width=wt+tt;var tn=wt/Ft.offsetWidth;yn.removeChild(Ft);var bt=tn*parseFloat(Ge);return v.CSS[Ge+tt]=bt,bt}function jt(Ie,Ge,tt){if(Ge in Ie.style){var At=Ge.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),lt=Ie.style[Ge]||getComputedStyle(Ie).getPropertyValue(At)||"0";return tt?kt(Ie,lt,tt):lt}}function nn(Ie,Ge){if(d.dom(Ie)&&!d.inp(Ie)&&(Bt(Ie,Ge)||d.svg(Ie)&&Ie[Ge]))return"attribute";if(d.dom(Ie)&&Y(h,Ge))return"transform";if(d.dom(Ie)&&Ge!=="transform"&&jt(Ie,Ge))return"css";if(Ie[Ge]!=null)return"object"}var Jn=/(\w+)\(([^)]*)\)/g;function kn(Ie){if(d.dom(Ie)){for(var Ge=Ie.style.transform||"",tt=new Map,At;At=Jn.exec(Ge);)tt.set(At[1],At[2]);return tt}}function xn(Ie,Ge,tt,At){var lt=f(Ge,"scale")?1:0+ft(Ge),wt=kn(Ie).get(Ge)||lt;return tt&&(tt.transforms.list.set(Ge,wt),tt.transforms.last=Ge),At?kt(Ie,wt,At):wt}function Fn(Ie,Ge,tt,At){switch(nn(Ie,Ge)){case"transform":return xn(Ie,Ge,At,tt);case"css":return jt(Ie,Ge,tt);case"attribute":return Bt(Ie,Ge);default:return Ie[Ge]||0}}var Wn=/^(\*=|\+=|-=)/;function Si(Ie,Ge){var tt=Wn.exec(Ie);if(!tt)return Ie;var At=qe(Ie)||0,lt=parseFloat(Ge),wt=parseFloat(Ie.replace(tt[0],""));switch(tt[0][0]){case"+":return lt+wt+At;case"-":return lt-wt+At;case"*":return lt*wt+At}}var Zn=/\s/g;function Ui(Ie,Ge){if(d.col(Ie))return _e(Ie);var tt=qe(Ie),At=tt?Ie.substr(0,Ie.length-tt.length):Ie;return Ge&&!Zn.test(Ie)?At+Ge:At}function Qi(Ie,Ge){return Math.sqrt(Math.pow(Ge.x-Ie.x,2)+Math.pow(Ge.y-Ie.y,2))}function Kn(Ie){return Math.PI*2*Bt(Ie,"r")}function Mt(Ie){return Bt(Ie,"width")*2+Bt(Ie,"height")*2}function Ce(Ie){return Qi({x:Bt(Ie,"x1"),y:Bt(Ie,"y1")},{x:Bt(Ie,"x2"),y:Bt(Ie,"y2")})}function ye(Ie){for(var Ge=Ie.points,tt=0,At,lt=0;lt<Ge.numberOfItems;lt++){var wt=Ge.getItem(lt);lt>0&&(tt+=Qi(At,wt)),At=wt}return tt}function Fe(Ie){var Ge=Ie.points;return ye(Ie)+Qi(Ge.getItem(Ge.numberOfItems-1),Ge.getItem(0))}function Se(Ie){if(Ie.getTotalLength)return Ie.getTotalLength();switch(Ie.tagName.toLowerCase()){case"circle":return Kn(Ie);case"rect":return Mt(Ie);case"line":return Ce(Ie);case"polyline":return ye(Ie);case"polygon":return Fe(Ie)}}function Re(Ie){var Ge=Se(Ie);return Ie.setAttribute("stroke-dasharray",Ge),Ge}function Ue(Ie){for(var Ge=Ie.parentNode;d.svg(Ge)&&(Ge=Ge.parentNode,!!d.svg(Ge.parentNode)););return Ge}function ee(Ie,Ge){var tt=Ge||{},At=tt.el||Ue(Ie),lt=At.getBoundingClientRect(),wt=Bt(At,"viewBox"),Ft=lt.width,yn=lt.height,tn=tt.viewBox||(wt?wt.split(" "):[0,0,Ft,yn]);return{el:At,viewBox:tn,x:tn[0]/1,y:tn[1]/1,w:Ft/tn[2],h:yn/tn[3]}}function D(Ie,Ge){var tt=d.str(Ie)?te(Ie)[0]:Ie,At=Ge||100;return function(lt){return{property:lt,el:tt,svg:ee(tt),totalLength:Se(tt)*(At/100)}}}function G(Ie,Ge){function tt(yn){yn===void 0&&(yn=0);var tn=Ge+yn>=1?Ge+yn:0;return Ie.el.getPointAtLength(tn)}var At=ee(Ie.el,Ie.svg),lt=tt(),wt=tt(-1),Ft=tt(1);switch(Ie.property){case"x":return(lt.x-At.x)*At.w;case"y":return(lt.y-At.y)*At.h;case"angle":return Math.atan2(Ft.y-wt.y,Ft.x-wt.x)*180/Math.PI}}var ue=/-?\d*\.?\d+/g;function xe(Ie,Ge){var tt=Ui(d.pth(Ie)?Ie.totalLength:Ie,Ge)+"";return{original:tt,numbers:tt.match(ue)?tt.match(ue).map(Number):[0],strings:d.str(Ie)||Ge?tt.split(ue):[]}}function Ne(Ie){var Ge=Ie?ne(d.arr(Ie)?Ie.map(re):re(Ie)):[];return se(Ge,function(tt,At,lt){return lt.indexOf(tt)===At})}function He(Ie){var Ge=Ne(Ie);return Ge.map(function(tt,At){return{target:tt,id:At,total:Ge.length,transforms:{list:kn(tt)}}})}var Gt=/^spring/;function Yt(Ie,Ge){var tt=k(Ge);if(Gt.test(tt.easing)&&(tt.duration=S(tt.easing)),d.arr(Ie)){var At=Ie.length,lt=At===2&&!d.obj(Ie[0]);lt?Ie={value:Ie}:d.fnc(Ge.duration)||(tt.duration=Ge.duration/At)}var wt=d.arr(Ie)?Ie:[Ie];return wt.map(function(Ft,yn){var tn=d.obj(Ft)&&!d.pth(Ft)?Ft:{value:Ft};return d.und(tn.delay)&&(tn.delay=yn?0:Ge.delay),d.und(tn.endDelay)&&(tn.endDelay=yn===wt.length-1?Ge.endDelay:0),tn}).map(function(Ft){return ae(Ft,tt)})}function Ht(Ie){for(var Ge=se(ne(Ie.map(function(wt){return Object.keys(wt)})),function(wt){return d.key(wt)}).reduce(function(wt,Ft){return wt.indexOf(Ft)<0&&wt.push(Ft),wt},[]),tt={},At=function(wt){var Ft=Ge[wt];tt[Ft]=Ie.map(function(yn){var tn={};for(var bt in yn)d.key(bt)?bt==Ft&&(tn.value=yn[bt]):tn[bt]=yn[bt];return tn})},lt=0;lt<Ge.length;lt++)At(lt);return tt}function zt(Ie,Ge){var tt=[],At=Ge.keyframes;At&&(Ge=ae(Ht(At),Ge));for(var lt in Ge)d.key(lt)&&tt.push({name:lt,tweens:Yt(Ge[lt],Ie)});return tt}function fn(Ie,Ge){var tt={};for(var At in Ie){var lt=Et(Ie[At],Ge);d.arr(lt)&&(lt=lt.map(function(wt){return Et(wt,Ge)}),lt.length===1&&(lt=lt[0])),tt[At]=lt}return tt.duration=parseFloat(tt.duration),tt.delay=parseFloat(tt.delay),tt}function nr(Ie,Ge){var tt;return Ie.tweens.map(function(At){var lt=fn(At,Ge),wt=lt.value,Ft=d.arr(wt)?wt[1]:wt,yn=qe(Ft),tn=Fn(Ge.target,Ie.name,yn,Ge),bt=tt?tt.to.original:tn,Rn=d.arr(wt)?wt[0]:bt,Pn=qe(Rn)||qe(tn),Xn=yn||Pn;return d.und(Ft)&&(Ft=bt),lt.from=xe(Rn,Xn),lt.to=xe(Si(Ft,Rn),Xn),lt.start=tt?tt.end:0,lt.end=lt.start+lt.delay+lt.duration+lt.endDelay,lt.easing=F(lt.easing,lt.duration),lt.isPath=d.pth(wt),lt.isColor=d.col(lt.from.original),lt.isColor&&(lt.round=1),tt=lt,lt})}var Bn={css:function(Ie,Ge,tt){return Ie.style[Ge]=tt},attribute:function(Ie,Ge,tt){return Ie.setAttribute(Ge,tt)},object:function(Ie,Ge,tt){return Ie[Ge]=tt},transform:function(Ie,Ge,tt,At,lt){if(At.list.set(Ge,tt),Ge===At.last||lt){var wt="";At.list.forEach(function(Ft,yn){wt+=yn+"("+Ft+") "}),Ie.style.transform=wt}}};function bi(Ie,Ge){for(var tt=He(Ie),At=0,lt=tt.length;At<lt;At++){var wt=tt[At];for(var Ft in Ge){var yn=Et(Ge[Ft],wt),tn=wt.target,bt=qe(yn),Rn=Fn(tn,Ft,bt,wt),Pn=bt||qe(Rn),Xn=Si(Ui(yn,Pn),Rn),Di=nn(tn,Ft);Bn[Di](tn,Ft,Xn,wt.transforms,!0)}}}function Ti(Ie,Ge){var tt=nn(Ie.target,Ge.name);if(tt){var At=nr(Ge,Ie),lt=At[At.length-1];return{type:tt,property:Ge.name,animatable:Ie,tweens:At,duration:lt.end,delay:At[0].delay,endDelay:lt.endDelay}}}function Oi(Ie,Ge){return se(ne(Ie.map(function(tt){return Ge.map(function(At){return Ti(tt,At)})})),function(tt){return!d.und(tt)})}function Mr(Ie,Ge){var tt=Ie.length,At=function(wt){return wt.timelineOffset?wt.timelineOffset:0},lt={};return lt.duration=tt?Math.max.apply(Math,Ie.map(function(wt){return At(wt)+wt.duration})):Ge.duration,lt.delay=tt?Math.min.apply(Math,Ie.map(function(wt){return At(wt)+wt.delay})):Ge.delay,lt.endDelay=tt?lt.duration-Math.max.apply(Math,Ie.map(function(wt){return At(wt)+wt.duration-wt.endDelay})):Ge.endDelay,lt}var $n=0;function Or(Ie){var Ge=oe(u,Ie),tt=oe(w,Ie),At=zt(tt,Ie),lt=He(Ie.targets),wt=Oi(lt,At),Ft=Mr(wt,tt),yn=$n;return $n++,ae(Ge,{id:yn,children:[],animatables:lt,animations:wt,duration:Ft.duration,delay:Ft.delay,endDelay:Ft.endDelay})}var dr=[],Er=[],Fr,Sr=function(){function Ie(){Fr=requestAnimationFrame(Ge)}function Ge(tt){var At=dr.length;if(At){for(var lt=0;lt<At;){var wt=dr[lt];if(!wt.paused)wt.tick(tt);else{var Ft=dr.indexOf(wt);Ft>-1&&(dr.splice(Ft,1),At=dr.length)}lt++}Ie()}else Fr=cancelAnimationFrame(Fr)}return Ie}();function ir(){if(document.hidden){for(var Ie=0,Ge=dr.length;Ie<Ge;Ie++)activeInstance[Ie].pause();Er=dr.slice(0),dr=[]}else for(var tt=0,At=Er.length;tt<At;tt++)Er[tt].play()}document.addEventListener("visibilitychange",ir);function Li(Ie){Ie===void 0&&(Ie={});var Ge=0,tt=0,At=0,lt,wt=0,Ft=null;function yn(){return window.Promise&&new Promise(function(on){return Ft=on})}var tn=yn(),bt=Or(Ie);function Rn(){bt.reversed=!bt.reversed;for(var on=0,oi=lt.length;on<oi;on++)lt[on].reversed=bt.reversed}function Pn(on){return bt.reversed?bt.duration-on:on}function Xn(){Ge=0,tt=Pn(bt.currentTime)*(1/Li.speed)}function Di(on,oi){oi&&oi.seek(on-oi.timelineOffset)}function si(on){if(bt.reversePlayback)for(var or=wt;or--;)Di(on,lt[or]);else for(var oi=0;oi<wt;oi++)Di(on,lt[oi])}function ti(on){for(var oi=0,or=bt.animations,gi=or.length;oi<gi;){var z=or[oi],q=z.animatable,ce=z.tweens,me=ce.length-1,Me=ce[me];me&&(Me=se(ce,function(fe){return on<fe.end})[0]||Me);for(var Ke=a(on-Me.start-Me.delay,0,Me.duration)/Me.duration,et=isNaN(Ke)?1:Me.easing(Ke),It=Me.to.strings,St=Me.round,it=[],yt=Me.to.numbers.length,Nt=void 0,_t=0;_t<yt;_t++){var Cn=void 0,le=Me.to.numbers[_t],he=Me.from.numbers[_t]||0;Me.isPath?Cn=G(Me.value,et*le):Cn=he+et*(le-he),St&&(Me.isColor&&_t>2||(Cn=Math.round(Cn*St)/St)),it.push(Cn)}var Ee=It.length;if(!Ee)Nt=it[0];else{Nt=It[0];for(var R=0;R<Ee;R++){It[R];var M=It[R+1],Z=it[R];isNaN(Z)||(M?Nt+=Z+M:Nt+=Z+" ")}}Bn[z.type](q.target,z.property,Nt,q.transforms),z.currentValue=Nt,oi++}}function pi(on){bt[on]&&!bt.passThrough&&bt[on](bt)}function Wi(){bt.remaining&&bt.remaining!==!0&&bt.remaining--}function Vi(on){var oi=bt.duration,or=bt.delay,gi=oi-bt.endDelay,z=Pn(on);bt.progress=a(z/oi*100,0,100),bt.reversePlayback=z<bt.currentTime,lt&&si(z),!bt.began&&bt.currentTime>0&&(bt.began=!0,pi("begin"),pi("loopBegin")),z<=or&&bt.currentTime!==0&&ti(0),(z>=gi&&bt.currentTime!==oi||!oi)&&ti(oi),z>or&&z<gi?(bt.changeBegan||(bt.changeBegan=!0,bt.changeCompleted=!1,pi("changeBegin")),pi("change"),ti(z)):bt.changeBegan&&(bt.changeCompleted=!0,bt.changeBegan=!1,pi("changeComplete")),bt.currentTime=a(z,0,oi),bt.began&&pi("update"),on>=oi&&(tt=0,Wi(),bt.remaining?(Ge=At,pi("loopComplete"),pi("loopBegin"),bt.direction==="alternate"&&Rn()):(bt.paused=!0,bt.completed||(bt.completed=!0,pi("loopComplete"),pi("complete"),"Promise"in window&&(Ft(),tn=yn()))))}return bt.reset=function(){var on=bt.direction;bt.passThrough=!1,bt.currentTime=0,bt.progress=0,bt.paused=!0,bt.began=!1,bt.changeBegan=!1,bt.completed=!1,bt.changeCompleted=!1,bt.reversePlayback=!1,bt.reversed=on==="reverse",bt.remaining=bt.loop,lt=bt.children,wt=lt.length;for(var oi=wt;oi--;)bt.children[oi].reset();(bt.reversed&&bt.loop!==!0||on==="alternate"&&bt.loop===1)&&bt.remaining++,ti(0)},bt.set=function(on,oi){return bi(on,oi),bt},bt.tick=function(on){At=on,Ge||(Ge=At),Vi((At+(tt-Ge))*Li.speed)},bt.seek=function(on){Vi(Pn(on))},bt.pause=function(){bt.paused=!0,Xn()},bt.play=function(){bt.paused&&(bt.paused=!1,dr.push(bt),Xn(),Fr||Sr())},bt.reverse=function(){Rn(),Xn()},bt.restart=function(){bt.reset(),bt.play()},bt.finished=tn,bt.reset(),bt.autoplay&&bt.play(),bt}function sr(Ie,Ge){for(var tt=Ge.length;tt--;)Y(Ie,Ge[tt].animatable.target)&&Ge.splice(tt,1)}function fs(Ie){for(var Ge=Ne(Ie),tt=dr.length;tt--;){var At=dr[tt],lt=At.animations,wt=At.children;sr(Ge,lt);for(var Ft=wt.length;Ft--;){var yn=wt[Ft],tn=yn.animations;sr(Ge,tn),!tn.length&&!yn.children.length&&wt.splice(Ft,1)}!lt.length&&!wt.length&&At.pause()}}function Ur(Ie,Ge){Ge===void 0&&(Ge={});var tt=Ge.direction||"normal",At=Ge.easing?F(Ge.easing):null,lt=Ge.grid,wt=Ge.axis,Ft=Ge.from||0,yn=Ft==="first",tn=Ft==="center",bt=Ft==="last",Rn=d.arr(Ie),Pn=parseFloat(Rn?Ie[0]:Ie),Xn=Rn?parseFloat(Ie[1]):0,Di=qe(Rn?Ie[1]:Ie)||0,si=Ge.start||0+(Rn?Pn:0),ti=[],pi=0;return function(Wi,Vi,on){if(yn&&(Ft=0),tn&&(Ft=(on-1)/2),bt&&(Ft=on-1),!ti.length){for(var oi=0;oi<on;oi++){if(!lt)ti.push(Math.abs(Ft-oi));else{var or=tn?(lt[0]-1)/2:Ft%lt[0],gi=tn?(lt[1]-1)/2:Math.floor(Ft/lt[0]),z=oi%lt[0],q=Math.floor(oi/lt[0]),ce=or-z,me=gi-q,Me=Math.sqrt(ce*ce+me*me);wt==="x"&&(Me=-ce),wt==="y"&&(Me=-me),ti.push(Me)}pi=Math.max.apply(Math,ti)}At&&(ti=ti.map(function(et){return At(et/pi)*pi})),tt==="reverse"&&(ti=ti.map(function(et){return wt?et<0?et*-1:-et:Math.abs(pi-et)}))}var Ke=Rn?(Xn-Pn)/pi:Pn;return si+Ke*(Math.round(ti[Vi]*100)/100)+Di}}function os(Ie){Ie===void 0&&(Ie={});var Ge=Li(Ie);return Ge.duration=0,Ge.add=function(tt,At){var lt=dr.indexOf(Ge),wt=Ge.children;lt>-1&&dr.splice(lt,1);function Ft(Xn){Xn.passThrough=!0}for(var yn=0;yn<wt.length;yn++)Ft(wt[yn]);var tn=ae(tt,oe(w,Ie));tn.targets=tn.targets||Ie.targets;var bt=Ge.duration;tn.autoplay=!1,tn.direction=Ge.direction,tn.timelineOffset=d.und(At)?bt:Si(At,bt),Ft(Ge),Ge.seek(tn.timelineOffset);var Rn=Li(tn);Ft(Rn),wt.push(Rn);var Pn=Mr(wt,Ie);return Ge.delay=Pn.delay,Ge.endDelay=Pn.endDelay,Ge.duration=Pn.duration,Ge.seek(0),Ge.reset(),Ge.autoplay&&Ge.play(),Ge},Ge}Li.version="3.0.0",Li.speed=1,Li.running=dr,Li.remove=fs,Li.get=Fn,Li.set=bi,Li.convertPx=kt,Li.path=D,Li.setDashoffset=Re,Li.stagger=Ur,Li.timeline=os,Li.easing=F,Li.penner=N,Li.random=function(Ie,Ge){return Math.floor(Math.random()*(Ge-Ie+1))+Ie};const es=Li},"./node_modules/three-bmfont-text/index.js":(W,$,A)=>{var u=A("./node_modules/layout-bmfont-text/index.js"),w=A("./node_modules/quad-indices/index.js"),h=A("./node_modules/three-bmfont-text/lib/vertices.js"),v=A("./node_modules/three-bmfont-text/lib/utils.js");W.exports=function(m){return new a(m)};class a extends THREE.BufferGeometry{constructor(m){super(),typeof m=="string"&&(m={text:m}),this._opt=Object.assign({},m),m&&this.update(m)}update(m){if(typeof m=="string"&&(m={text:m}),m=Object.assign({},this._opt,m),!m.font)throw new TypeError("must specify a { font } in options");this.layout=u(m);var l=m.flipY!==!1,y=m.font,g=y.common.scaleW,d=y.common.scaleH,p=this.layout.glyphs.filter(function(T){var N=T.data;return N.width*N.height>0});this.visibleGlyphs=p;var C=h.positions(p),S=h.uvs(p,g,d,l),_=w([],{clockwise:!0,type:"uint16",count:p.length});if(this.setIndex(_),this.setAttribute("position",new THREE.BufferAttribute(C,2)),this.setAttribute("uv",new THREE.BufferAttribute(S,2)),!m.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(m.multipage){var L=h.pages(p);this.setAttribute("page",new THREE.BufferAttribute(L,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var m=this.attributes.position.array,l=this.attributes.position.itemSize;if(!m||!l||m.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}v.computeSphere(m,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var m=this.boundingBox,l=this.attributes.position.array,y=this.attributes.position.itemSize;if(!l||!y||l.length<2){m.makeEmpty();return}v.computeBox(l,m)}}},"./node_modules/three-bmfont-text/lib/utils.js":W=>{var $=2,A={min:[0,0],max:[0,0]};function u(w){var h=w.length/$;A.min[0]=w[0],A.min[1]=w[1],A.max[0]=w[0],A.max[1]=w[1];for(var v=0;v<h;v++){var a=w[v*$+0],f=w[v*$+1];A.min[0]=Math.min(a,A.min[0]),A.min[1]=Math.min(f,A.min[1]),A.max[0]=Math.max(a,A.max[0]),A.max[1]=Math.max(f,A.max[1])}}W.exports.computeBox=function(w,h){u(w),h.min.set(A.min[0],A.min[1],0),h.max.set(A.max[0],A.max[1],0)},W.exports.computeSphere=function(w,h){u(w);var v=A.min[0],a=A.min[1],f=A.max[0],m=A.max[1],l=f-v,y=m-a,g=Math.sqrt(l*l+y*y);h.center.set(v+l/2,a+y/2,0),h.radius=g/2}},"./node_modules/three-bmfont-text/lib/vertices.js":W=>{W.exports.pages=function(A){var u=new Float32Array(A.length*4*1),w=0;return A.forEach(function(h){var v=h.data.page||0;u[w++]=v,u[w++]=v,u[w++]=v,u[w++]=v}),u},W.exports.uvs=function(A,u,w,h){var v=new Float32Array(A.length*4*2),a=0;return A.forEach(function(f){var m=f.data,l=m.x+m.width,y=m.y+m.height,g=m.x/u,d=m.y/w,p=l/u,C=y/w;h&&(d=(w-m.y)/w,C=(w-y)/w),v[a++]=g,v[a++]=d,v[a++]=g,v[a++]=C,v[a++]=p,v[a++]=C,v[a++]=p,v[a++]=d}),v},W.exports.positions=function(A){var u=new Float32Array(A.length*4*2),w=0;return A.forEach(function(h){var v=h.data,a=h.position[0]+v.xoffset,f=h.position[1]+v.yoffset,m=v.width,l=v.height;u[w++]=a,u[w++]=f,u[w++]=a,u[w++]=f+l,u[w++]=a+m,u[w++]=f+l,u[w++]=a+m,u[w++]=f}),u}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(W,$,A){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(u,w){W.exports=w()})(this,function(){var u=typeof window<"u"?window:typeof A.g<"u"?A.g:typeof self<"u"?self:{};function w(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}function h(_,L){return L={exports:{}},_(L,L.exports),L.exports}var v=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},a=function(L,T){for(var N=0,F=L.length;N<F;N++)T[N]=L[N]},f=function(L,T){for(var N in T)T.hasOwnProperty(N)&&(L[N]=T[N]);return L},m=h(function(_,L){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(T,N){_.exports=N()})(u,function(){var T=function(z,q){if(!(z instanceof q))throw new TypeError("Cannot call a class as a function")},N=function(){function z(q,ce){for(var me=0;me<ce.length;me++){var Me=ce[me];Me.enumerable=Me.enumerable||!1,Me.configurable=!0,"value"in Me&&(Me.writable=!0),Object.defineProperty(q,Me.key,Me)}}return function(q,ce,me){return ce&&z(q.prototype,ce),me&&z(q,me),q}}(),F=function(){function z(q,ce){var me=[],Me=!0,Ke=!1,et=void 0;try{for(var It=q[Symbol.iterator](),St;!(Me=(St=It.next()).done)&&(me.push(St.value),!(ce&&me.length===ce));Me=!0);}catch(it){Ke=!0,et=it}finally{try{!Me&&It.return&&It.return()}finally{if(Ke)throw et}}return me}return function(q,ce){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return z(q,ce);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),te=.001,K=1,se=function(q,ce){return"data:"+q+","+encodeURIComponent(ce)},ne=function(q,ce,me){return q+(ce-q)*me},re=function(){var z=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return z}}(),Y=function(){var z=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return z}}(),k=function(){var z=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return z}}(),oe=function(){var z=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return z}}(),ae=function(){var z=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),q=z?parseInt(z[1],10):null;return function(){return q}}(),Ae=function(){var z=!1;return z=re()&&k()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return z}}(),b=function(){var z=!1;if(ae()===65){var q=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(q){var ce=q[1].split("."),me=F(ce,4);me[0],me[1];var Me=me[2],Ke=me[3];z=parseInt(Me,10)===3325&&parseInt(Ke,10)<148}}return function(){return z}}(),I=function(){var z=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return z}}(),O=function(){var q=window.orientation==90||window.orientation==-90;return I()?!q:q},Q=function(q){return!(isNaN(q)||q<=te||q>K)},J=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},ve=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Le=function(q){if(Y())return!1;if(q.requestFullscreen)q.requestFullscreen();else if(q.webkitRequestFullscreen)q.webkitRequestFullscreen();else if(q.mozRequestFullScreen)q.mozRequestFullScreen();else if(q.msRequestFullscreen)q.msRequestFullscreen();else return!1;return!0},_e=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},Ze=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},qe=function(q,ce,me,Me){var Ke=q.createShader(q.VERTEX_SHADER);q.shaderSource(Ke,ce),q.compileShader(Ke);var et=q.createShader(q.FRAGMENT_SHADER);q.shaderSource(et,me),q.compileShader(et);var It=q.createProgram();q.attachShader(It,Ke),q.attachShader(It,et);for(var St in Me)q.bindAttribLocation(It,Me[St],St);return q.linkProgram(It),q.deleteShader(Ke),q.deleteShader(et),It},ft=function(q,ce){for(var me={},Me=q.getProgramParameter(ce,q.ACTIVE_UNIFORMS),Ke="",et=0;et<Me;et++){var It=q.getActiveUniform(ce,et);Ke=It.name.replace("[0]",""),me[Ke]=q.getUniformLocation(ce,Ke)}return me},Et=function(q,ce,me,Me,Ke,et,It){var St=1/(ce-me),it=1/(Me-Ke),yt=1/(et-It);return q[0]=-2*St,q[1]=0,q[2]=0,q[3]=0,q[4]=0,q[5]=-2*it,q[6]=0,q[7]=0,q[8]=0,q[9]=0,q[10]=2*yt,q[11]=0,q[12]=(ce+me)*St,q[13]=(Ke+Me)*it,q[14]=(It+et)*yt,q[15]=1,q},Bt=function(){var q=!1;return function(ce){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(ce)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ce.substr(0,4)))&&(q=!0)}(navigator.userAgent||navigator.vendor||window.opera),q},kt=function(q,ce){for(var me in ce)ce.hasOwnProperty(me)&&(q[me]=ce[me]);return q},jt=function(q){if(re()){var ce=q.style.width,me=q.style.height;q.style.width=parseInt(ce)+1+"px",q.style.height=parseInt(me)+"px",setTimeout(function(){q.style.width=ce,q.style.height=me},100)}window.canvas=q},nn=function(){var z=Math.PI/180,q=Math.PI*.25;function ce(it,yt,Nt,_t){var Cn=Math.tan(yt?yt.upDegrees*z:q),le=Math.tan(yt?yt.downDegrees*z:q),he=Math.tan(yt?yt.leftDegrees*z:q),Ee=Math.tan(yt?yt.rightDegrees*z:q),R=2/(he+Ee),M=2/(Cn+le);return it[0]=R,it[1]=0,it[2]=0,it[3]=0,it[4]=0,it[5]=M,it[6]=0,it[7]=0,it[8]=-((he-Ee)*R*.5),it[9]=(Cn-le)*M*.5,it[10]=_t/(Nt-_t),it[11]=-1,it[12]=0,it[13]=0,it[14]=_t*Nt/(Nt-_t),it[15]=0,it}function me(it,yt,Nt){var _t=yt[0],Cn=yt[1],le=yt[2],he=yt[3],Ee=_t+_t,R=Cn+Cn,M=le+le,Z=_t*Ee,fe=_t*R,Oe=_t*M,Qe=Cn*R,Je=Cn*M,Xe=le*M,ht=he*Ee,ct=he*R,at=he*M;return it[0]=1-(Qe+Xe),it[1]=fe+at,it[2]=Oe-ct,it[3]=0,it[4]=fe-at,it[5]=1-(Z+Xe),it[6]=Je+ht,it[7]=0,it[8]=Oe+ct,it[9]=Je-ht,it[10]=1-(Z+Qe),it[11]=0,it[12]=Nt[0],it[13]=Nt[1],it[14]=Nt[2],it[15]=1,it}function Me(it,yt,Nt){var _t=Nt[0],Cn=Nt[1],le=Nt[2],he,Ee,R,M,Z,fe,Oe,Qe,Je,Xe,ht,ct;return yt===it?(it[12]=yt[0]*_t+yt[4]*Cn+yt[8]*le+yt[12],it[13]=yt[1]*_t+yt[5]*Cn+yt[9]*le+yt[13],it[14]=yt[2]*_t+yt[6]*Cn+yt[10]*le+yt[14],it[15]=yt[3]*_t+yt[7]*Cn+yt[11]*le+yt[15]):(he=yt[0],Ee=yt[1],R=yt[2],M=yt[3],Z=yt[4],fe=yt[5],Oe=yt[6],Qe=yt[7],Je=yt[8],Xe=yt[9],ht=yt[10],ct=yt[11],it[0]=he,it[1]=Ee,it[2]=R,it[3]=M,it[4]=Z,it[5]=fe,it[6]=Oe,it[7]=Qe,it[8]=Je,it[9]=Xe,it[10]=ht,it[11]=ct,it[12]=he*_t+Z*Cn+Je*le+yt[12],it[13]=Ee*_t+fe*Cn+Xe*le+yt[13],it[14]=R*_t+Oe*Cn+ht*le+yt[14],it[15]=M*_t+Qe*Cn+ct*le+yt[15]),it}function Ke(it,yt){var Nt=yt[0],_t=yt[1],Cn=yt[2],le=yt[3],he=yt[4],Ee=yt[5],R=yt[6],M=yt[7],Z=yt[8],fe=yt[9],Oe=yt[10],Qe=yt[11],Je=yt[12],Xe=yt[13],ht=yt[14],ct=yt[15],at=Nt*Ee-_t*he,ut=Nt*R-Cn*he,Ct=Nt*M-le*he,qt=_t*R-Cn*Ee,Jt=_t*M-le*Ee,an=Cn*M-le*R,Zt=Z*Xe-fe*Je,dn=Z*ht-Oe*Je,un=Z*ct-Qe*Je,pn=fe*ht-Oe*Xe,Vt=fe*ct-Qe*Xe,ei=Oe*ct-Qe*ht,Mn=at*ei-ut*Vt+Ct*pn+qt*un-Jt*dn+an*Zt;return Mn?(Mn=1/Mn,it[0]=(Ee*ei-R*Vt+M*pn)*Mn,it[1]=(Cn*Vt-_t*ei-le*pn)*Mn,it[2]=(Xe*an-ht*Jt+ct*qt)*Mn,it[3]=(Oe*Jt-fe*an-Qe*qt)*Mn,it[4]=(R*un-he*ei-M*dn)*Mn,it[5]=(Nt*ei-Cn*un+le*dn)*Mn,it[6]=(ht*Ct-Je*an-ct*ut)*Mn,it[7]=(Z*an-Oe*Ct+Qe*ut)*Mn,it[8]=(he*Vt-Ee*un+M*Zt)*Mn,it[9]=(_t*un-Nt*Vt-le*Zt)*Mn,it[10]=(Je*Jt-Xe*Ct+ct*at)*Mn,it[11]=(fe*Ct-Z*Jt-Qe*at)*Mn,it[12]=(Ee*dn-he*pn-R*Zt)*Mn,it[13]=(Nt*pn-_t*dn+Cn*Zt)*Mn,it[14]=(Xe*ut-Je*qt-ht*at)*Mn,it[15]=(Z*qt-fe*ut+Oe*at)*Mn,it):null}var et=new Float32Array([0,0,0,1]),It=new Float32Array([0,0,0]);function St(it,yt,Nt,_t,Cn,le){ce(it,_t||null,le.depthNear,le.depthFar);var he=Nt.orientation||et,Ee=Nt.position||It;me(yt,he,Ee),Cn&&Me(yt,yt,Cn),Ke(yt,yt)}return function(it,yt,Nt){return!it||!yt?!1:(it.pose=yt,it.timestamp=yt.timestamp,St(it.leftProjectionMatrix,it.leftViewMatrix,yt,Nt._getFieldOfView("left"),Nt._getEyeOffset("left"),Nt),St(it.rightProjectionMatrix,it.rightViewMatrix,yt,Nt._getFieldOfView("right"),Nt._getEyeOffset("right"),Nt),!0)}}(),Jn=function(){var q=window.self!==window.top,ce=kn(document.referrer),me=kn(window.location.href);return q&&ce!==me},kn=function(q){var ce,me=q.indexOf("://");me!==-1?ce=me+3:ce=0;var Me=q.indexOf("/",ce);return Me===-1&&(Me=q.length),q.substring(0,Me)},xn=function(q){if(q.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var ce=2*Math.acos(q.w);return ce},Fn=function(){var z={};return function(q,ce){z[q]===void 0&&(console.warn("webvr-polyfill: "+ce),z[q]=!0)}}(),Wn=function(q,ce){var me=ce?"Please use "+ce+" instead.":"";Fn(q,q+" has been deprecated. This may not work on native WebVR displays. "+me)};function Si(z,q,ce){if(!q){ce(z);return}for(var me=[],Me=null,Ke=0;Ke<q.length;++Ke){var et=q[Ke];switch(et){case z.TEXTURE_BINDING_2D:case z.TEXTURE_BINDING_CUBE_MAP:var It=q[++Ke];if(It<z.TEXTURE0||It>z.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),me.push(null,null);break}Me||(Me=z.getParameter(z.ACTIVE_TEXTURE)),z.activeTexture(It),me.push(z.getParameter(et),null);break;case z.ACTIVE_TEXTURE:Me=z.getParameter(z.ACTIVE_TEXTURE),me.push(null);break;default:me.push(z.getParameter(et));break}}ce(z);for(var Ke=0;Ke<q.length;++Ke){var et=q[Ke],St=me[Ke];switch(et){case z.ACTIVE_TEXTURE:break;case z.ARRAY_BUFFER_BINDING:z.bindBuffer(z.ARRAY_BUFFER,St);break;case z.COLOR_CLEAR_VALUE:z.clearColor(St[0],St[1],St[2],St[3]);break;case z.COLOR_WRITEMASK:z.colorMask(St[0],St[1],St[2],St[3]);break;case z.CURRENT_PROGRAM:z.useProgram(St);break;case z.ELEMENT_ARRAY_BUFFER_BINDING:z.bindBuffer(z.ELEMENT_ARRAY_BUFFER,St);break;case z.FRAMEBUFFER_BINDING:z.bindFramebuffer(z.FRAMEBUFFER,St);break;case z.RENDERBUFFER_BINDING:z.bindRenderbuffer(z.RENDERBUFFER,St);break;case z.TEXTURE_BINDING_2D:var It=q[++Ke];if(It<z.TEXTURE0||It>z.TEXTURE31)break;z.activeTexture(It),z.bindTexture(z.TEXTURE_2D,St);break;case z.TEXTURE_BINDING_CUBE_MAP:var It=q[++Ke];if(It<z.TEXTURE0||It>z.TEXTURE31)break;z.activeTexture(It),z.bindTexture(z.TEXTURE_CUBE_MAP,St);break;case z.VIEWPORT:z.viewport(St[0],St[1],St[2],St[3]);break;case z.BLEND:case z.CULL_FACE:case z.DEPTH_TEST:case z.SCISSOR_TEST:case z.STENCIL_TEST:St?z.enable(et):z.disable(et);break;default:console.log("No GL restore behavior for 0x"+et.toString(16));break}Me&&z.activeTexture(Me)}}var Zn=Si,Ui=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),Qi=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function Kn(z,q,ce,me){this.gl=z,this.cardboardUI=q,this.bufferScale=ce,this.dirtySubmitFrameBindings=me,this.ctxAttribs=z.getContextAttributes(),this.instanceExt=z.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=z.drawingBufferWidth,this.bufferHeight=z.drawingBufferHeight,this.realBindFramebuffer=z.bindFramebuffer,this.realEnable=z.enable,this.realDisable=z.disable,this.realColorMask=z.colorMask,this.realClearColor=z.clearColor,this.realViewport=z.viewport,re()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(z.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(z.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=qe(z,Ui,Qi,this.attribs),this.uniforms=ft(z,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=z.createBuffer(),this.indexBuffer=z.createBuffer(),this.indexCount=0,this.renderTarget=z.createTexture(),this.framebuffer=z.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=z.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=z.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=z.createRenderbuffer()),this.patch(),this.onResize()}Kn.prototype.destroy=function(){var z=this.gl;this.unpatch(),z.deleteProgram(this.program),z.deleteBuffer(this.vertexBuffer),z.deleteBuffer(this.indexBuffer),z.deleteTexture(this.renderTarget),z.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&z.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&z.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&z.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},Kn.prototype.onResize=function(){var z=this.gl,q=this,ce=[z.RENDERBUFFER_BINDING,z.TEXTURE_BINDING_2D,z.TEXTURE0];Zn(z,ce,function(me){q.realBindFramebuffer.call(me,me.FRAMEBUFFER,null),q.scissorTest&&q.realDisable.call(me,me.SCISSOR_TEST),q.realColorMask.call(me,!0,!0,!0,!0),q.realViewport.call(me,0,0,me.drawingBufferWidth,me.drawingBufferHeight),q.realClearColor.call(me,0,0,0,1),me.clear(me.COLOR_BUFFER_BIT),q.realBindFramebuffer.call(me,me.FRAMEBUFFER,q.framebuffer),me.bindTexture(me.TEXTURE_2D,q.renderTarget),me.texImage2D(me.TEXTURE_2D,0,q.ctxAttribs.alpha?me.RGBA:me.RGB,q.bufferWidth,q.bufferHeight,0,q.ctxAttribs.alpha?me.RGBA:me.RGB,me.UNSIGNED_BYTE,null),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.framebufferTexture2D(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_2D,q.renderTarget,0),q.ctxAttribs.depth&&q.ctxAttribs.stencil?(me.bindRenderbuffer(me.RENDERBUFFER,q.depthStencilBuffer),me.renderbufferStorage(me.RENDERBUFFER,me.DEPTH_STENCIL,q.bufferWidth,q.bufferHeight),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.DEPTH_STENCIL_ATTACHMENT,me.RENDERBUFFER,q.depthStencilBuffer)):q.ctxAttribs.depth?(me.bindRenderbuffer(me.RENDERBUFFER,q.depthBuffer),me.renderbufferStorage(me.RENDERBUFFER,me.DEPTH_COMPONENT16,q.bufferWidth,q.bufferHeight),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.DEPTH_ATTACHMENT,me.RENDERBUFFER,q.depthBuffer)):q.ctxAttribs.stencil&&(me.bindRenderbuffer(me.RENDERBUFFER,q.stencilBuffer),me.renderbufferStorage(me.RENDERBUFFER,me.STENCIL_INDEX8,q.bufferWidth,q.bufferHeight),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.STENCIL_ATTACHMENT,me.RENDERBUFFER,q.stencilBuffer)),!me.checkFramebufferStatus(me.FRAMEBUFFER)===me.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),q.realBindFramebuffer.call(me,me.FRAMEBUFFER,q.lastBoundFramebuffer),q.scissorTest&&q.realEnable.call(me,me.SCISSOR_TEST),q.realColorMask.apply(me,q.colorMask),q.realViewport.apply(me,q.viewport),q.realClearColor.apply(me,q.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},Kn.prototype.patch=function(){if(!this.isPatched){var z=this,q=this.gl.canvas,ce=this.gl;re()||(q.width=J()*this.bufferScale,q.height=ve()*this.bufferScale,Object.defineProperty(q,"width",{configurable:!0,enumerable:!0,get:function(){return z.bufferWidth},set:function(Me){z.bufferWidth=Me,z.realCanvasWidth.set.call(q,Me),z.onResize()}}),Object.defineProperty(q,"height",{configurable:!0,enumerable:!0,get:function(){return z.bufferHeight},set:function(Me){z.bufferHeight=Me,z.realCanvasHeight.set.call(q,Me),z.onResize()}})),this.lastBoundFramebuffer=ce.getParameter(ce.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(ce.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(me,Me){z.lastBoundFramebuffer=Me||z.framebuffer,z.realBindFramebuffer.call(ce,me,z.lastBoundFramebuffer)},this.cullFace=ce.getParameter(ce.CULL_FACE),this.depthTest=ce.getParameter(ce.DEPTH_TEST),this.blend=ce.getParameter(ce.BLEND),this.scissorTest=ce.getParameter(ce.SCISSOR_TEST),this.stencilTest=ce.getParameter(ce.STENCIL_TEST),ce.enable=function(me){switch(me){case ce.CULL_FACE:z.cullFace=!0;break;case ce.DEPTH_TEST:z.depthTest=!0;break;case ce.BLEND:z.blend=!0;break;case ce.SCISSOR_TEST:z.scissorTest=!0;break;case ce.STENCIL_TEST:z.stencilTest=!0;break}z.realEnable.call(ce,me)},ce.disable=function(me){switch(me){case ce.CULL_FACE:z.cullFace=!1;break;case ce.DEPTH_TEST:z.depthTest=!1;break;case ce.BLEND:z.blend=!1;break;case ce.SCISSOR_TEST:z.scissorTest=!1;break;case ce.STENCIL_TEST:z.stencilTest=!1;break}z.realDisable.call(ce,me)},this.colorMask=ce.getParameter(ce.COLOR_WRITEMASK),ce.colorMask=function(me,Me,Ke,et){z.colorMask[0]=me,z.colorMask[1]=Me,z.colorMask[2]=Ke,z.colorMask[3]=et,z.realColorMask.call(ce,me,Me,Ke,et)},this.clearColor=ce.getParameter(ce.COLOR_CLEAR_VALUE),ce.clearColor=function(me,Me,Ke,et){z.clearColor[0]=me,z.clearColor[1]=Me,z.clearColor[2]=Ke,z.clearColor[3]=et,z.realClearColor.call(ce,me,Me,Ke,et)},this.viewport=ce.getParameter(ce.VIEWPORT),ce.viewport=function(me,Me,Ke,et){z.viewport[0]=me,z.viewport[1]=Me,z.viewport[2]=Ke,z.viewport[3]=et,z.realViewport.call(ce,me,Me,Ke,et)},this.isPatched=!0,jt(q)}},Kn.prototype.unpatch=function(){if(this.isPatched){var z=this.gl,q=this.gl.canvas;re()||(Object.defineProperty(q,"width",this.realCanvasWidth),Object.defineProperty(q,"height",this.realCanvasHeight)),q.width=this.bufferWidth,q.height=this.bufferHeight,z.bindFramebuffer=this.realBindFramebuffer,z.enable=this.realEnable,z.disable=this.realDisable,z.colorMask=this.realColorMask,z.clearColor=this.realClearColor,z.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&z.bindFramebuffer(z.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){jt(q)},1)}},Kn.prototype.setTextureBounds=function(z,q){z||(z=[0,0,.5,1]),q||(q=[.5,0,.5,1]),this.viewportOffsetScale[0]=z[0],this.viewportOffsetScale[1]=z[1],this.viewportOffsetScale[2]=z[2],this.viewportOffsetScale[3]=z[3],this.viewportOffsetScale[4]=q[0],this.viewportOffsetScale[5]=q[1],this.viewportOffsetScale[6]=q[2],this.viewportOffsetScale[7]=q[3]},Kn.prototype.submitFrame=function(){var z=this.gl,q=this,ce=[];if(this.dirtySubmitFrameBindings||ce.push(z.CURRENT_PROGRAM,z.ARRAY_BUFFER_BINDING,z.ELEMENT_ARRAY_BUFFER_BINDING,z.TEXTURE_BINDING_2D,z.TEXTURE0),Zn(z,ce,function(Me){q.realBindFramebuffer.call(Me,Me.FRAMEBUFFER,null);var Ke=0,et=0;q.instanceExt&&(Ke=Me.getVertexAttrib(q.attribs.position,q.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),et=Me.getVertexAttrib(q.attribs.texCoord,q.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),q.cullFace&&q.realDisable.call(Me,Me.CULL_FACE),q.depthTest&&q.realDisable.call(Me,Me.DEPTH_TEST),q.blend&&q.realDisable.call(Me,Me.BLEND),q.scissorTest&&q.realDisable.call(Me,Me.SCISSOR_TEST),q.stencilTest&&q.realDisable.call(Me,Me.STENCIL_TEST),q.realColorMask.call(Me,!0,!0,!0,!0),q.realViewport.call(Me,0,0,Me.drawingBufferWidth,Me.drawingBufferHeight),(q.ctxAttribs.alpha||re())&&(q.realClearColor.call(Me,0,0,0,1),Me.clear(Me.COLOR_BUFFER_BIT)),Me.useProgram(q.program),Me.bindBuffer(Me.ELEMENT_ARRAY_BUFFER,q.indexBuffer),Me.bindBuffer(Me.ARRAY_BUFFER,q.vertexBuffer),Me.enableVertexAttribArray(q.attribs.position),Me.enableVertexAttribArray(q.attribs.texCoord),Me.vertexAttribPointer(q.attribs.position,2,Me.FLOAT,!1,20,0),Me.vertexAttribPointer(q.attribs.texCoord,3,Me.FLOAT,!1,20,8),q.instanceExt&&(Ke!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.position,0),et!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.texCoord,0)),Me.activeTexture(Me.TEXTURE0),Me.uniform1i(q.uniforms.diffuse,0),Me.bindTexture(Me.TEXTURE_2D,q.renderTarget),Me.uniform4fv(q.uniforms.viewportOffsetScale,q.viewportOffsetScale),Me.drawElements(Me.TRIANGLES,q.indexCount,Me.UNSIGNED_SHORT,0),q.cardboardUI&&q.cardboardUI.renderNoState(),q.realBindFramebuffer.call(q.gl,Me.FRAMEBUFFER,q.framebuffer),q.ctxAttribs.preserveDrawingBuffer||(q.realClearColor.call(Me,0,0,0,0),Me.clear(Me.COLOR_BUFFER_BIT)),q.dirtySubmitFrameBindings||q.realBindFramebuffer.call(Me,Me.FRAMEBUFFER,q.lastBoundFramebuffer),q.cullFace&&q.realEnable.call(Me,Me.CULL_FACE),q.depthTest&&q.realEnable.call(Me,Me.DEPTH_TEST),q.blend&&q.realEnable.call(Me,Me.BLEND),q.scissorTest&&q.realEnable.call(Me,Me.SCISSOR_TEST),q.stencilTest&&q.realEnable.call(Me,Me.STENCIL_TEST),q.realColorMask.apply(Me,q.colorMask),q.realViewport.apply(Me,q.viewport),(q.ctxAttribs.alpha||!q.ctxAttribs.preserveDrawingBuffer)&&q.realClearColor.apply(Me,q.clearColor),q.instanceExt&&(Ke!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.position,Ke),et!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.texCoord,et))}),re()){var me=z.canvas;(me.width!=q.bufferWidth||me.height!=q.bufferHeight)&&(q.bufferWidth=me.width,q.bufferHeight=me.height,q.onResize())}},Kn.prototype.updateDeviceInfo=function(z){var q=this.gl,ce=this,me=[q.ARRAY_BUFFER_BINDING,q.ELEMENT_ARRAY_BUFFER_BINDING];Zn(q,me,function(Me){var Ke=ce.computeMeshVertices_(ce.meshWidth,ce.meshHeight,z);if(Me.bindBuffer(Me.ARRAY_BUFFER,ce.vertexBuffer),Me.bufferData(Me.ARRAY_BUFFER,Ke,Me.STATIC_DRAW),!ce.indexCount){var et=ce.computeMeshIndices_(ce.meshWidth,ce.meshHeight);Me.bindBuffer(Me.ELEMENT_ARRAY_BUFFER,ce.indexBuffer),Me.bufferData(Me.ELEMENT_ARRAY_BUFFER,et,Me.STATIC_DRAW),ce.indexCount=et.length}})},Kn.prototype.computeMeshVertices_=function(z,q,ce){for(var me=new Float32Array(2*z*q*5),Me=ce.getLeftEyeVisibleTanAngles(),Ke=ce.getLeftEyeNoLensTanAngles(),et=ce.getLeftEyeVisibleScreenRect(Ke),It=0,St=0;St<2;St++){for(var it=0;it<q;it++)for(var yt=0;yt<z;yt++,It++){var Nt=yt/(z-1),_t=it/(q-1),Cn=Nt,le=_t,he=ne(Me[0],Me[2],Nt),Ee=ne(Me[3],Me[1],_t),R=Math.sqrt(he*he+Ee*Ee),M=ce.distortion.distortInverse(R),Z=he*M/R,fe=Ee*M/R;Nt=(Z-Ke[0])/(Ke[2]-Ke[0]),_t=(fe-Ke[3])/(Ke[1]-Ke[3]),Nt=(et.x+Nt*et.width-.5)*2,_t=(et.y+_t*et.height-.5)*2,me[It*5+0]=Nt,me[It*5+1]=_t,me[It*5+2]=Cn,me[It*5+3]=le,me[It*5+4]=St}var Oe=Me[2]-Me[0];Me[0]=-(Oe+Me[0]),Me[2]=Oe-Me[2],Oe=Ke[2]-Ke[0],Ke[0]=-(Oe+Ke[0]),Ke[2]=Oe-Ke[2],et.x=1-(et.x+et.width)}return me},Kn.prototype.computeMeshIndices_=function(z,q){for(var ce=new Uint16Array(2*(z-1)*(q-1)*6),me=z/2,Me=q/2,Ke=0,et=0,It=0;It<2;It++)for(var St=0;St<q;St++)for(var it=0;it<z;it++,Ke++)it==0||St==0||(it<=me==St<=Me?(ce[et++]=Ke,ce[et++]=Ke-z-1,ce[et++]=Ke-z,ce[et++]=Ke-z-1,ce[et++]=Ke,ce[et++]=Ke-1):(ce[et++]=Ke-1,ce[et++]=Ke-z,ce[et++]=Ke,ce[et++]=Ke-z,ce[et++]=Ke-1,ce[et++]=Ke-z-1));return ce},Kn.prototype.getOwnPropertyDescriptor_=function(z,q){var ce=Object.getOwnPropertyDescriptor(z,q);return(ce.get===void 0||ce.set===void 0)&&(ce.configurable=!0,ce.enumerable=!0,ce.get=function(){return this.getAttribute(q)},ce.set=function(me){this.setAttribute(q,me)}),ce};var Mt=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),Ce=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),ye=Math.PI/180,Fe=60,Se=12,Re=20,Ue=1,ee=.75,D=.3125,G=4,ue=28,xe=1.5;function Ne(z){this.gl=z,this.attribs={position:0},this.program=qe(z,Mt,Ce,this.attribs),this.uniforms=ft(z,this.program),this.vertexBuffer=z.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Ne.prototype.destroy=function(){var z=this.gl;this.listener&&z.canvas.removeEventListener("click",this.listener,!1),z.deleteProgram(this.program),z.deleteBuffer(this.vertexBuffer)},Ne.prototype.listen=function(z,q){var ce=this.gl.canvas;this.listener=function(me){var Me=ce.clientWidth/2,Ke=ue*xe;me.clientX>Me-Ke&&me.clientX<Me+Ke&&me.clientY>ce.clientHeight-Ke?z(me):me.clientX<Ke&&me.clientY<Ke&&q(me)},ce.addEventListener("click",this.listener,!1)},Ne.prototype.onResize=function(){var z=this.gl,q=this,ce=[z.ARRAY_BUFFER_BINDING];Zn(z,ce,function(me){var Me=[],Ke=me.drawingBufferWidth/2,et=Math.max(screen.width,screen.height)*window.devicePixelRatio,It=me.drawingBufferWidth/et,St=It*window.devicePixelRatio,it=G*St/2,yt=ue*xe*St,Nt=ue*St/2,_t=(ue*xe-ue)*St;Me.push(Ke-it,yt),Me.push(Ke-it,me.drawingBufferHeight),Me.push(Ke+it,yt),Me.push(Ke+it,me.drawingBufferHeight),q.gearOffset=Me.length/2;function Cn(M,Z){var fe=(90-M)*ye,Oe=Math.cos(fe),Qe=Math.sin(fe);Me.push(D*Oe*Nt+Ke,D*Qe*Nt+Nt),Me.push(Z*Oe*Nt+Ke,Z*Qe*Nt+Nt)}for(var le=0;le<=6;le++){var he=le*Fe;Cn(he,Ue),Cn(he+Se,Ue),Cn(he+Re,ee),Cn(he+(Fe-Re),ee),Cn(he+(Fe-Se),Ue)}q.gearVertexCount=Me.length/2-q.gearOffset,q.arrowOffset=Me.length/2;function Ee(M,Z){Me.push(_t+M,me.drawingBufferHeight-_t-Z)}var R=it/Math.sin(45*ye);Ee(0,Nt),Ee(Nt,0),Ee(Nt+R,R),Ee(R,Nt+R),Ee(R,Nt-R),Ee(0,Nt),Ee(Nt,Nt*2),Ee(Nt+R,Nt*2-R),Ee(R,Nt-R),Ee(0,Nt),Ee(R,Nt-it),Ee(ue*St,Nt-it),Ee(R,Nt+it),Ee(ue*St,Nt+it),q.arrowVertexCount=Me.length/2-q.arrowOffset,me.bindBuffer(me.ARRAY_BUFFER,q.vertexBuffer),me.bufferData(me.ARRAY_BUFFER,new Float32Array(Me),me.STATIC_DRAW)})},Ne.prototype.render=function(){var z=this.gl,q=this,ce=[z.CULL_FACE,z.DEPTH_TEST,z.BLEND,z.SCISSOR_TEST,z.STENCIL_TEST,z.COLOR_WRITEMASK,z.VIEWPORT,z.CURRENT_PROGRAM,z.ARRAY_BUFFER_BINDING];Zn(z,ce,function(me){me.disable(me.CULL_FACE),me.disable(me.DEPTH_TEST),me.disable(me.BLEND),me.disable(me.SCISSOR_TEST),me.disable(me.STENCIL_TEST),me.colorMask(!0,!0,!0,!0),me.viewport(0,0,me.drawingBufferWidth,me.drawingBufferHeight),q.renderNoState()})},Ne.prototype.renderNoState=function(){var z=this.gl;z.useProgram(this.program),z.bindBuffer(z.ARRAY_BUFFER,this.vertexBuffer),z.enableVertexAttribArray(this.attribs.position),z.vertexAttribPointer(this.attribs.position,2,z.FLOAT,!1,8,0),z.uniform4f(this.uniforms.color,1,1,1,1),Et(this.projMat,0,z.drawingBufferWidth,0,z.drawingBufferHeight,.1,1024),z.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),z.drawArrays(z.TRIANGLE_STRIP,0,4),z.drawArrays(z.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),z.drawArrays(z.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function He(z){this.coefficients=z}He.prototype.distortInverse=function(z){for(var q=0,ce=1,me=z-this.distort(q);Math.abs(ce-q)>1e-4;){var Me=z-this.distort(ce),Ke=ce-Me*((ce-q)/(Me-me));q=ce,ce=Ke,me=Me}return ce},He.prototype.distort=function(z){for(var q=z*z,ce=0,me=0;me<this.coefficients.length;me++)ce=q*(ce+this.coefficients[me]);return(ce+1)*z};var Gt=Math.PI/180,Yt=180/Math.PI,Ht=function(q,ce,me){this.x=q||0,this.y=ce||0,this.z=me||0};Ht.prototype={constructor:Ht,set:function(q,ce,me){return this.x=q,this.y=ce,this.z=me,this},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var q=this.length();if(q!==0){var ce=1/q;this.multiplyScalar(ce)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(q){this.x*=q,this.y*=q,this.z*=q},applyQuaternion:function(q){var ce=this.x,me=this.y,Me=this.z,Ke=q.x,et=q.y,It=q.z,St=q.w,it=St*ce+et*Me-It*me,yt=St*me+It*ce-Ke*Me,Nt=St*Me+Ke*me-et*ce,_t=-Ke*ce-et*me-It*Me;return this.x=it*St+_t*-Ke+yt*-It-Nt*-et,this.y=yt*St+_t*-et+Nt*-Ke-it*-It,this.z=Nt*St+_t*-It+it*-et-yt*-Ke,this},dot:function(q){return this.x*q.x+this.y*q.y+this.z*q.z},crossVectors:function(q,ce){var me=q.x,Me=q.y,Ke=q.z,et=ce.x,It=ce.y,St=ce.z;return this.x=Me*St-Ke*It,this.y=Ke*et-me*St,this.z=me*It-Me*et,this}};var zt=function(q,ce,me,Me){this.x=q||0,this.y=ce||0,this.z=me||0,this.w=Me!==void 0?Me:1};zt.prototype={constructor:zt,set:function(q,ce,me,Me){return this.x=q,this.y=ce,this.z=me,this.w=Me,this},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this.w=q.w,this},setFromEulerXYZ:function(q,ce,me){var Me=Math.cos(q/2),Ke=Math.cos(ce/2),et=Math.cos(me/2),It=Math.sin(q/2),St=Math.sin(ce/2),it=Math.sin(me/2);return this.x=It*Ke*et+Me*St*it,this.y=Me*St*et-It*Ke*it,this.z=Me*Ke*it+It*St*et,this.w=Me*Ke*et-It*St*it,this},setFromEulerYXZ:function(q,ce,me){var Me=Math.cos(q/2),Ke=Math.cos(ce/2),et=Math.cos(me/2),It=Math.sin(q/2),St=Math.sin(ce/2),it=Math.sin(me/2);return this.x=It*Ke*et+Me*St*it,this.y=Me*St*et-It*Ke*it,this.z=Me*Ke*it-It*St*et,this.w=Me*Ke*et+It*St*it,this},setFromAxisAngle:function(q,ce){var me=ce/2,Me=Math.sin(me);return this.x=q.x*Me,this.y=q.y*Me,this.z=q.z*Me,this.w=Math.cos(me),this},multiply:function(q){return this.multiplyQuaternions(this,q)},multiplyQuaternions:function(q,ce){var me=q.x,Me=q.y,Ke=q.z,et=q.w,It=ce.x,St=ce.y,it=ce.z,yt=ce.w;return this.x=me*yt+et*It+Me*it-Ke*St,this.y=Me*yt+et*St+Ke*It-me*it,this.z=Ke*yt+et*it+me*St-Me*It,this.w=et*yt-me*It-Me*St-Ke*it,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var q=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return q===0?(this.x=0,this.y=0,this.z=0,this.w=1):(q=1/q,this.x=this.x*q,this.y=this.y*q,this.z=this.z*q,this.w=this.w*q),this},slerp:function(q,ce){if(ce===0)return this;if(ce===1)return this.copy(q);var me=this.x,Me=this.y,Ke=this.z,et=this.w,It=et*q.w+me*q.x+Me*q.y+Ke*q.z;if(It<0?(this.w=-q.w,this.x=-q.x,this.y=-q.y,this.z=-q.z,It=-It):this.copy(q),It>=1)return this.w=et,this.x=me,this.y=Me,this.z=Ke,this;var St=Math.acos(It),it=Math.sqrt(1-It*It);if(Math.abs(it)<.001)return this.w=.5*(et+this.w),this.x=.5*(me+this.x),this.y=.5*(Me+this.y),this.z=.5*(Ke+this.z),this;var yt=Math.sin((1-ce)*St)/it,Nt=Math.sin(ce*St)/it;return this.w=et*yt+this.w*Nt,this.x=me*yt+this.x*Nt,this.y=Me*yt+this.y*Nt,this.z=Ke*yt+this.z*Nt,this},setFromUnitVectors:function(){var z,q,ce=1e-6;return function(me,Me){return z===void 0&&(z=new Ht),q=me.dot(Me)+1,q<ce?(q=0,Math.abs(me.x)>Math.abs(me.z)?z.set(-me.y,me.x,0):z.set(0,-me.z,me.y)):z.crossVectors(me,Me),this.x=z.x,this.y=z.y,this.z=z.z,this.w=q,this.normalize(),this}}()};function fn(z){this.width=z.width||J(),this.height=z.height||ve(),this.widthMeters=z.widthMeters,this.heightMeters=z.heightMeters,this.bevelMeters=z.bevelMeters}var nr=new fn({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),Bn=new fn({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),bi={CardboardV1:new Oi({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Oi({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Ti(z,q){this.viewer=bi.CardboardV2,this.updateDeviceParams(z),this.distortion=new He(this.viewer.distortionCoefficients);for(var ce=0;ce<q.length;ce++){var me=q[ce];bi[me.id]=new Oi(me)}}Ti.prototype.updateDeviceParams=function(z){this.device=this.determineDevice_(z)||this.device},Ti.prototype.getDevice=function(){return this.device},Ti.prototype.setViewer=function(z){this.viewer=z,this.distortion=new He(this.viewer.distortionCoefficients)},Ti.prototype.determineDevice_=function(z){if(!z)return re()?(console.warn("Using fallback iOS device measurements."),Bn):(console.warn("Using fallback Android device measurements."),nr);var q=.0254,ce=q/z.xdpi,me=q/z.ydpi,Me=J(),Ke=ve();return new fn({widthMeters:ce*Me,heightMeters:me*Ke,bevelMeters:z.bevelMm*.001})},Ti.prototype.getDistortedFieldOfViewLeftEye=function(){var z=this.viewer,q=this.device,ce=this.distortion,me=z.screenLensDistance,Me=(q.widthMeters-z.interLensDistance)/2,Ke=z.interLensDistance/2,et=z.baselineLensDistance-q.bevelMeters,It=q.heightMeters-et,St=Yt*Math.atan(ce.distort(Me/me)),it=Yt*Math.atan(ce.distort(Ke/me)),yt=Yt*Math.atan(ce.distort(et/me)),Nt=Yt*Math.atan(ce.distort(It/me));return{leftDegrees:Math.min(St,z.fov),rightDegrees:Math.min(it,z.fov),downDegrees:Math.min(yt,z.fov),upDegrees:Math.min(Nt,z.fov)}},Ti.prototype.getLeftEyeVisibleTanAngles=function(){var z=this.viewer,q=this.device,ce=this.distortion,me=Math.tan(-Gt*z.fov),Me=Math.tan(Gt*z.fov),Ke=Math.tan(Gt*z.fov),et=Math.tan(-Gt*z.fov),It=q.widthMeters/4,St=q.heightMeters/2,it=z.baselineLensDistance-q.bevelMeters-St,yt=z.interLensDistance/2-It,Nt=-it,_t=z.screenLensDistance,Cn=ce.distort((yt-It)/_t),le=ce.distort((Nt+St)/_t),he=ce.distort((yt+It)/_t),Ee=ce.distort((Nt-St)/_t),R=new Float32Array(4);return R[0]=Math.max(me,Cn),R[1]=Math.min(Me,le),R[2]=Math.min(Ke,he),R[3]=Math.max(et,Ee),R},Ti.prototype.getLeftEyeNoLensTanAngles=function(){var z=this.viewer,q=this.device,ce=this.distortion,me=new Float32Array(4),Me=ce.distortInverse(Math.tan(-Gt*z.fov)),Ke=ce.distortInverse(Math.tan(Gt*z.fov)),et=ce.distortInverse(Math.tan(Gt*z.fov)),It=ce.distortInverse(Math.tan(-Gt*z.fov)),St=q.widthMeters/4,it=q.heightMeters/2,yt=z.baselineLensDistance-q.bevelMeters-it,Nt=z.interLensDistance/2-St,_t=-yt,Cn=z.screenLensDistance,le=(Nt-St)/Cn,he=(_t+it)/Cn,Ee=(Nt+St)/Cn,R=(_t-it)/Cn;return me[0]=Math.max(Me,le),me[1]=Math.min(Ke,he),me[2]=Math.min(et,Ee),me[3]=Math.max(It,R),me},Ti.prototype.getLeftEyeVisibleScreenRect=function(z){var q=this.viewer,ce=this.device,me=q.screenLensDistance,Me=(ce.widthMeters-q.interLensDistance)/2,Ke=q.baselineLensDistance-ce.bevelMeters,et=(z[0]*me+Me)/ce.widthMeters,It=(z[1]*me+Ke)/ce.heightMeters,St=(z[2]*me+Me)/ce.widthMeters,it=(z[3]*me+Ke)/ce.heightMeters;return{x:et,y:it,width:St-et,height:It-it}},Ti.prototype.getFieldOfViewLeftEye=function(z){return z?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Ti.prototype.getFieldOfViewRightEye=function(z){var q=this.getFieldOfViewLeftEye(z);return{leftDegrees:q.rightDegrees,rightDegrees:q.leftDegrees,upDegrees:q.upDegrees,downDegrees:q.downDegrees}},Ti.prototype.getUndistortedFieldOfViewLeftEye=function(){var z=this.getUndistortedParams_();return{leftDegrees:Yt*Math.atan(z.outerDist),rightDegrees:Yt*Math.atan(z.innerDist),downDegrees:Yt*Math.atan(z.bottomDist),upDegrees:Yt*Math.atan(z.topDist)}},Ti.prototype.getUndistortedViewportLeftEye=function(){var z=this.getUndistortedParams_(),q=this.viewer,ce=this.device,me=q.screenLensDistance,Me=ce.widthMeters/me,Ke=ce.heightMeters/me,et=ce.width/Me,It=ce.height/Ke,St=Math.round((z.eyePosX-z.outerDist)*et),it=Math.round((z.eyePosY-z.bottomDist)*It);return{x:St,y:it,width:Math.round((z.eyePosX+z.innerDist)*et)-St,height:Math.round((z.eyePosY+z.topDist)*It)-it}},Ti.prototype.getUndistortedParams_=function(){var z=this.viewer,q=this.device,ce=this.distortion,me=z.screenLensDistance,Me=z.interLensDistance/2/me,Ke=q.widthMeters/me,et=q.heightMeters/me,It=Ke/2-Me,St=(z.baselineLensDistance-q.bevelMeters)/me,it=z.fov,yt=ce.distortInverse(Math.tan(Gt*it)),Nt=Math.min(It,yt),_t=Math.min(Me,yt),Cn=Math.min(St,yt),le=Math.min(et-St,yt);return{outerDist:Nt,innerDist:_t,topDist:le,bottomDist:Cn,eyePosX:It,eyePosY:St}};function Oi(z){this.id=z.id,this.label=z.label,this.fov=z.fov,this.interLensDistance=z.interLensDistance,this.baselineLensDistance=z.baselineLensDistance,this.screenLensDistance=z.screenLensDistance,this.distortionCoefficients=z.distortionCoefficients,this.inverseCoefficients=z.inverseCoefficients}Ti.Viewers=bi;var Mr=1,$n="2019-11-09T17:36:14Z",Or=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],dr={format:Mr,last_updated:$n,devices:Or};function Er(z,q){if(this.dpdb=dr,this.recalculateDeviceParams_(),z){this.onDeviceParamsUpdated=q;var ce=new XMLHttpRequest,me=this;ce.open("GET",z,!0),ce.addEventListener("load",function(){me.loading=!1,ce.status>=200&&ce.status<=299?(me.dpdb=JSON.parse(ce.response),me.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),ce.send()}}Er.prototype.getDeviceParams=function(){return this.deviceParams},Er.prototype.recalculateDeviceParams_=function(){var z=this.calcDeviceParams_();z?(this.deviceParams=z,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Er.prototype.calcDeviceParams_=function(){var z=this.dpdb;if(!z)return console.error("DPDB not available."),null;if(z.format!=1)return console.error("DPDB has unexpected format version."),null;if(!z.devices||!z.devices.length)return console.error("DPDB does not have a devices section."),null;var q=navigator.userAgent||navigator.vendor||window.opera,ce=J(),me=ve();if(!z.devices)return console.error("DPDB has no devices section."),null;for(var Me=0;Me<z.devices.length;Me++){var Ke=z.devices[Me];if(!Ke.rules){console.warn("Device["+Me+"] has no rules section.");continue}if(Ke.type!="ios"&&Ke.type!="android"){console.warn("Device["+Me+"] has invalid type.");continue}if(re()==(Ke.type=="ios")){for(var et=!1,It=0;It<Ke.rules.length;It++){var St=Ke.rules[It];if(this.ruleMatches_(St,q,ce,me)){et=!0;break}}if(et){var it=Ke.dpi[0]||Ke.dpi,yt=Ke.dpi[1]||Ke.dpi;return new Fr({xdpi:it,ydpi:yt,bevelMm:Ke.bw})}}}return console.warn("No DPDB device match."),null},Er.prototype.ruleMatches_=function(z,q,ce,me){if(!z.ua&&!z.res||(z.ua&&z.ua.substring(0,2)==="SM"&&(z.ua=z.ua.substring(0,7)),z.ua&&q.indexOf(z.ua)<0))return!1;if(z.res){if(!z.res[0]||!z.res[1])return!1;var Me=z.res[0],Ke=z.res[1];if(Math.min(ce,me)!=Math.min(Me,Ke)||Math.max(ce,me)!=Math.max(Me,Ke))return!1}return!0};function Fr(z){this.xdpi=z.xdpi,this.ydpi=z.ydpi,this.bevelMm=z.bevelMm}function Sr(z,q){this.set(z,q)}Sr.prototype.set=function(z,q){this.sample=z,this.timestampS=q},Sr.prototype.copy=function(z){this.set(z.sample,z.timestampS)};function ir(z,q){this.kFilter=z,this.isDebug=q,this.currentAccelMeasurement=new Sr,this.currentGyroMeasurement=new Sr,this.previousGyroMeasurement=new Sr,re()?this.filterQ=new zt(-1,0,0,1):this.filterQ=new zt(1,0,0,1),this.previousFilterQ=new zt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new zt,this.isOrientationInitialized=!1,this.estimatedGravity=new Ht,this.measuredGravity=new Ht,this.gyroIntegralQ=new zt}ir.prototype.addAccelMeasurement=function(z,q){this.currentAccelMeasurement.set(z,q)},ir.prototype.addGyroMeasurement=function(z,q){this.currentGyroMeasurement.set(z,q);var ce=q-this.previousGyroMeasurement.timestampS;Q(ce)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},ir.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var z=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,q=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,z);this.gyroIntegralQ.multiply(q),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(q);var ce=new zt;ce.copy(this.filterQ),ce.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(ce),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var me=new zt;me.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),me.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",Yt*xn(me),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Me=new zt;Me.copy(this.filterQ),Me.multiply(me),this.filterQ.slerp(Me,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},ir.prototype.getOrientation=function(){return this.filterQ},ir.prototype.accelToQuaternion_=function(z){var q=new Ht;q.copy(z),q.normalize();var ce=new zt;return ce.setFromUnitVectors(new Ht(0,0,-1),q),ce.inverse(),ce},ir.prototype.gyroToQuaternionDelta_=function(z,q){var ce=new zt,me=new Ht;return me.copy(z),me.normalize(),ce.setFromAxisAngle(me,z.length()*q),ce};function Li(z,q){this.predictionTimeS=z,this.isDebug=q,this.previousQ=new zt,this.previousTimestampS=null,this.deltaQ=new zt,this.outQ=new zt}Li.prototype.getPrediction=function(z,q,ce){if(!this.previousTimestampS)return this.previousQ.copy(z),this.previousTimestampS=ce,z;var me=new Ht;me.copy(q),me.normalize();var Me=q.length();if(Me<Gt*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(Yt*Me).toFixed(1)),this.outQ.copy(z),this.previousQ.copy(z),this.outQ;var Ke=Me*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(me,Ke),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(z),this.previousTimestampS=ce,this.outQ};function sr(z,q,ce,me){this.yawOnly=ce,this.accelerometer=new Ht,this.gyroscope=new Ht,this.filter=new ir(z,me),this.posePredictor=new Li(q,me),this.isFirefoxAndroid=oe(),this.isIOS=re();var Me=ae();this.isDeviceMotionInRadians=!this.isIOS&&Me&&Me<66,this.isWithoutDeviceMotion=b()||Ae(),this.filterToWorldQ=new zt,re()?this.filterToWorldQ.setFromAxisAngle(new Ht(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Ht(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new zt,this.worldToScreenQ=new zt,this.originalPoseAdjustQ=new zt,this.originalPoseAdjustQ.setFromAxisAngle(new Ht(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),O()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new zt,this.orientationOut_=new Float32Array(4),this.start()}sr.prototype.getPosition=function(){return null},sr.prototype.getOrientation=function(){var z=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Me=new zt().setFromAxisAngle(new Ht(0,0,-1),0),Ke=new zt;return window.orientation===-90?Ke.setFromAxisAngle(new Ht(0,1,0),Math.PI/-2):Ke.setFromAxisAngle(new Ht(0,1,0),Math.PI/2),Me.multiply(Ke)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Me=new zt;return Me.setFromAxisAngle(new Ht(1,0,0),-Math.PI/2),Me}(),z=this._deviceOrientationQ;var ce=new zt;return ce.copy(z),ce.multiply(this.deviceOrientationFilterToWorldQ),ce.multiply(this.resetQ),ce.multiply(this.worldToScreenQ),ce.multiplyQuaternions(this.deviceOrientationFixQ,ce),this.yawOnly&&(ce.x=0,ce.z=0,ce.normalize()),this.orientationOut_[0]=ce.x,this.orientationOut_[1]=ce.y,this.orientationOut_[2]=ce.z,this.orientationOut_[3]=ce.w,this.orientationOut_}else{var q=this.filter.getOrientation();z=this.posePredictor.getPrediction(q,this.gyroscope,this.previousTimestampS)}var ce=new zt;return ce.copy(this.filterToWorldQ),ce.multiply(this.resetQ),ce.multiply(z),ce.multiply(this.worldToScreenQ),this.yawOnly&&(ce.x=0,ce.z=0,ce.normalize()),this.orientationOut_[0]=ce.x,this.orientationOut_[1]=ce.y,this.orientationOut_[2]=ce.z,this.orientationOut_[3]=ce.w,this.orientationOut_},sr.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),O()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},sr.prototype.onDeviceOrientation_=function(z){this._deviceOrientationQ=this._deviceOrientationQ||new zt;var q=z.alpha,ce=z.beta,me=z.gamma;q=(q||0)*Math.PI/180,ce=(ce||0)*Math.PI/180,me=(me||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(ce,q,-me)},sr.prototype.onDeviceMotion_=function(z){this.updateDeviceMotion_(z)},sr.prototype.updateDeviceMotion_=function(z){var q=z.accelerationIncludingGravity,ce=z.rotationRate,me=z.timeStamp/1e3,Me=me-this.previousTimestampS;if(Me<0){Fn("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=me;return}else if(Me<=te||Me>K){Fn("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=me;return}this.accelerometer.set(-q.x,-q.y,-q.z),ce&&(I()?this.gyroscope.set(-ce.beta,ce.alpha,ce.gamma):this.gyroscope.set(ce.alpha,ce.beta,ce.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,me)),this.filter.addAccelMeasurement(this.accelerometer,me),this.previousTimestampS=me},sr.prototype.onOrientationChange_=function(z){this.setScreenTransform_()},sr.prototype.onMessage_=function(z){var q=z.data;if(!(!q||!q.type)){var ce=q.type.toLowerCase();ce==="devicemotion"&&this.updateDeviceMotion_(q.deviceMotionEvent)}},sr.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new Ht(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new Ht(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},sr.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),re()&&Jn()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},sr.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var fs=60,Ur=new Ht(1,0,0),os=new Ht(0,0,1),es=new zt;es.setFromAxisAngle(Ur,-Math.PI/2),es.multiply(new zt().setFromAxisAngle(os,Math.PI/2));var Ie=function(){function z(q){T(this,z),this.config=q,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new zt,this._outQ=new zt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return N(z,[{key:"init",value:function(){var ce=null;try{ce=new RelativeOrientationSensor({frequency:fs,referenceFrame:"screen"}),ce.addEventListener("error",this._onSensorError)}catch(me){this.errors.push(me),me.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):me.name==="ReferenceError"?this.useDeviceMotion():console.error(me)}ce&&(this.api="sensor",this.sensor=ce,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new sr(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var ce=this.sensor.quaternion;this._sensorQ.set(ce[0],ce[1],ce[2],ce[3]);var me=this._outQ;return me.copy(es),me.multiply(this._sensorQ),this.config.YAW_ONLY&&(me.x=me.z=0,me.normalize()),this._out[0]=me.x,this._out[1]=me.y,this._out[2]=me.z,this._out[3]=me.w,this._out}},{key:"_onSensorError",value:function(ce){this.errors.push(ce.error),ce.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):ce.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(ce.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),z}(),Ge="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function tt(){this.loadIcon_();var z=document.createElement("div"),et=z.style;et.position="fixed",et.top=0,et.right=0,et.bottom=0,et.left=0,et.backgroundColor="gray",et.fontFamily="sans-serif",et.zIndex=1e6;var q=document.createElement("img");q.src=this.icon;var et=q.style;et.marginLeft="25%",et.marginTop="25%",et.width="50%",z.appendChild(q);var ce=document.createElement("div"),et=ce.style;et.textAlign="center",et.fontSize="16px",et.lineHeight="24px",et.margin="24px 25%",et.width="50%",ce.innerHTML="Place your phone into your Cardboard viewer.",z.appendChild(ce);var me=document.createElement("div"),et=me.style;et.backgroundColor="#CFD8DC",et.position="fixed",et.bottom=0,et.width="100%",et.height="48px",et.padding="14px 24px",et.boxSizing="border-box",et.color="#656A6B",z.appendChild(me);var Me=document.createElement("div");Me.style.float="left",Me.innerHTML="No Cardboard viewer?";var Ke=document.createElement("a");Ke.href="https://www.google.com/get/cardboard/get-cardboard/",Ke.innerHTML="get one",Ke.target="_blank";var et=Ke.style;et.float="right",et.fontWeight=600,et.textTransform="uppercase",et.borderLeft="1px solid gray",et.paddingLeft="24px",et.textDecoration="none",et.color="#656A6B",me.appendChild(Me),me.appendChild(Ke),this.overlay=z,this.text=ce,this.hide()}tt.prototype.show=function(z){!z&&!this.overlay.parentElement?document.body.appendChild(this.overlay):z&&(this.overlay.parentElement&&this.overlay.parentElement!=z&&this.overlay.parentElement.removeChild(this.overlay),z.appendChild(this.overlay)),this.overlay.style.display="block";var q=this.overlay.querySelector("img"),ce=q.style;O()?(ce.width="20%",ce.marginLeft="40%",ce.marginTop="3%"):(ce.width="50%",ce.marginLeft="25%",ce.marginTop="25%")},tt.prototype.hide=function(){this.overlay.style.display="none"},tt.prototype.showTemporarily=function(z,q){this.show(q),this.timer=setTimeout(this.hide.bind(this),z)},tt.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},tt.prototype.update=function(){this.disableShowTemporarily(),!O()&&Bt()?this.show():this.hide()},tt.prototype.loadIcon_=function(){this.icon=se("image/svg+xml",Ge)};var At="CardboardV1",lt="WEBVR_CARDBOARD_VIEWER",wt="webvr-polyfill-viewer-selector";function Ft(z){try{this.selectedKey=localStorage.getItem(lt)}catch(q){console.error("Failed to load viewer profile: %s",q)}this.selectedKey||(this.selectedKey=z||At),this.dialog=this.createDialog_(Ti.Viewers),this.root=null,this.onChangeCallbacks_=[]}Ft.prototype.show=function(z){this.root=z,z.appendChild(this.dialog);var q=this.dialog.querySelector("#"+this.selectedKey);q.checked=!0,this.dialog.style.display="block"},Ft.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Ft.prototype.getCurrentViewer=function(){return Ti.Viewers[this.selectedKey]},Ft.prototype.getSelectedKey_=function(){var z=this.dialog.querySelector("input[name=field]:checked");return z?z.id:null},Ft.prototype.onChange=function(z){this.onChangeCallbacks_.push(z)},Ft.prototype.fireOnChange_=function(z){for(var q=0;q<this.onChangeCallbacks_.length;q++)this.onChangeCallbacks_[q](z)},Ft.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Ti.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Ti.Viewers[this.selectedKey]);try{localStorage.setItem(lt,this.selectedKey)}catch(z){console.error("Failed to save viewer profile: %s",z)}this.hide()},Ft.prototype.createDialog_=function(z){var q=document.createElement("div");q.classList.add(wt),q.style.display="none";var ce=document.createElement("div"),Ke=ce.style;Ke.position="fixed",Ke.left=0,Ke.top=0,Ke.width="100%",Ke.height="100%",Ke.background="rgba(0, 0, 0, 0.3)",ce.addEventListener("click",this.hide.bind(this));var me=280,Me=document.createElement("div"),Ke=Me.style;Ke.boxSizing="border-box",Ke.position="fixed",Ke.top="24px",Ke.left="50%",Ke.marginLeft=-me/2+"px",Ke.width=me+"px",Ke.padding="24px",Ke.overflow="hidden",Ke.background="#fafafa",Ke.fontFamily="'Roboto', sans-serif",Ke.boxShadow="0px 5px 20px #666",Me.appendChild(this.createH1_("Select your viewer"));for(var et in z)Me.appendChild(this.createChoice_(et,z[et].label));return Me.appendChild(this.createButton_("Save",this.onSave_.bind(this))),q.appendChild(ce),q.appendChild(Me),q},Ft.prototype.createH1_=function(z){var q=document.createElement("h1"),ce=q.style;return ce.color="black",ce.fontSize="20px",ce.fontWeight="bold",ce.marginTop=0,ce.marginBottom="24px",q.innerHTML=z,q},Ft.prototype.createChoice_=function(z,q){var ce=document.createElement("div");ce.style.marginTop="8px",ce.style.color="black";var me=document.createElement("input");me.style.fontSize="30px",me.setAttribute("id",z),me.setAttribute("type","radio"),me.setAttribute("value",z),me.setAttribute("name","field");var Me=document.createElement("label");return Me.style.marginLeft="4px",Me.setAttribute("for",z),Me.innerHTML=q,ce.appendChild(me),ce.appendChild(Me),ce},Ft.prototype.createButton_=function(z,q){var ce=document.createElement("button");ce.innerHTML=z;var me=ce.style;return me.float="right",me.textTransform="uppercase",me.color="#1094f7",me.fontSize="14px",me.letterSpacing=0,me.border=0,me.background="none",me.marginTop="16px",ce.addEventListener("click",q),ce};var yn=typeof window<"u"?window:typeof u<"u"?u:typeof self<"u"?self:{};function tn(z){return z&&z.__esModule&&Object.prototype.hasOwnProperty.call(z,"default")?z.default:z}function bt(z,q){return q={exports:{}},z(q,q.exports),q.exports}var Rn=bt(function(z,q){(function(me,Me){z.exports=Me()})(yn,function(){return function(ce){var me={};function Me(Ke){if(me[Ke])return me[Ke].exports;var et=me[Ke]={i:Ke,l:!1,exports:{}};return ce[Ke].call(et.exports,et,et.exports,Me),et.l=!0,et.exports}return Me.m=ce,Me.c=me,Me.d=function(Ke,et,It){Me.o(Ke,et)||Object.defineProperty(Ke,et,{configurable:!1,enumerable:!0,get:It})},Me.n=function(Ke){var et=Ke&&Ke.__esModule?function(){return Ke.default}:function(){return Ke};return Me.d(et,"a",et),et},Me.o=function(Ke,et){return Object.prototype.hasOwnProperty.call(Ke,et)},Me.p="",Me(Me.s=0)}([function(ce,me,Me){var Ke=function(){function yt(Nt,_t){for(var Cn=0;Cn<_t.length;Cn++){var le=_t[Cn];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(Nt,le.key,le)}}return function(Nt,_t,Cn){return _t&&yt(Nt.prototype,_t),Cn&&yt(Nt,Cn),Nt}}();function et(yt,Nt){if(!(yt instanceof Nt))throw new TypeError("Cannot call a class as a function")}var It=Me(1),St=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,it=function(){function yt(){et(this,yt),St?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",It),this.noSleepVideo.addEventListener("timeupdate",(function(Nt){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return Ke(yt,[{key:"enable",value:function(){St?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){St?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),yt}();ce.exports=it},function(ce,me,Me){ce.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),Pn=tn(Rn),Xn=1e3,Di=[0,0,.5,1],si=[.5,0,.5,1],ti=window.requestAnimationFrame,pi=window.cancelAnimationFrame;function Wi(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function Vi(z){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:z.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:z.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:z.canPresent},maxLayers:{writable:!1,enumerable:!0,value:z.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Wn("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),z.hasOrientation}}})}function on(z){z=z||{};var q="wakelock"in z?z.wakelock:!0;this.isPolyfilled=!0,this.displayId=Xn++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Wn("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Vi({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,q&&Bt()&&(this.wakelock_=new Pn)}on.prototype.getFrameData=function(z){return nn(z,this._getPose(),this)},on.prototype.getPose=function(){return Wn("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},on.prototype.resetPose=function(){return Wn("VRDisplay.prototype.resetPose"),this._resetPose()},on.prototype.getImmediatePose=function(){return Wn("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},on.prototype.requestAnimationFrame=function(z){return ti(z)},on.prototype.cancelAnimationFrame=function(z){return pi(z)},on.prototype.wrapForFullscreen=function(z){if(re())return z;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var q=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",q.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==z)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=z,this.originalParent_=z.parentElement,this.originalParent_||document.body.appendChild(z),!this.fullscreenWrapper_.parentElement){var ce=this.fullscreenElement_.parentElement;ce.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),ce.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var me=this;function Me(){if(me.fullscreenElement_){var Ke=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];me.fullscreenElement_.setAttribute("style",Ke.join("; ")+";")}}return Me(),this.fullscreenWrapper_},on.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var z=this.fullscreenElement_;this.fullscreenElementCachedStyle_?z.setAttribute("style",this.fullscreenElementCachedStyle_):z.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var q=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(z),this.originalParent_===q?q.insertBefore(z,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(z),q.removeChild(this.fullscreenWrapper_),z}},on.prototype.requestPresent=function(z){var q=this.isPresenting,ce=this;return z instanceof Array||(Wn("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),z=[z]),new Promise(function(me,Me){if(!ce.capabilities.canPresent){Me(new Error("VRDisplay is not capable of presenting."));return}if(z.length==0||z.length>ce.capabilities.maxLayers){Me(new Error("Invalid number of layers."));return}var Ke=z[0];if(!Ke.source){me();return}var et=Ke.leftBounds||Di,It=Ke.rightBounds||si;if(q){var St=ce.layer_;St.source!==Ke.source&&(St.source=Ke.source);for(var it=0;it<4;it++)St.leftBounds[it]=et[it],St.rightBounds[it]=It[it];ce.wrapForFullscreen(ce.layer_.source),ce.updatePresent_(),me();return}if(ce.layer_={predistorted:Ke.predistorted,source:Ke.source,leftBounds:et.slice(0),rightBounds:It.slice(0)},ce.waitingForPresent_=!1,ce.layer_&&ce.layer_.source){var yt=ce.wrapForFullscreen(ce.layer_.source),Nt=function(){var le=Ze();ce.isPresenting=yt===le,ce.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(he){console.error("screen.orientation.lock() failed due to",he.message)}),ce.waitingForPresent_=!1,ce.beginPresent_(),me()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),ce.removeFullscreenWrapper(),ce.disableWakeLock(),ce.endPresent_(),ce.removeFullscreenListeners_()),ce.fireVRDisplayPresentChange_()},_t=function(){ce.waitingForPresent_&&(ce.removeFullscreenWrapper(),ce.removeFullscreenListeners_(),ce.disableWakeLock(),ce.waitingForPresent_=!1,ce.isPresenting=!1,Me(new Error("Unable to present.")))};ce.addFullscreenListeners_(yt,Nt,_t),Le(yt)?(ce.enableWakeLock(),ce.waitingForPresent_=!0):(re()||Y())&&(ce.enableWakeLock(),ce.isPresenting=!0,ce.beginPresent_(),ce.fireVRDisplayPresentChange_(),me())}!ce.waitingForPresent_&&!re()&&(_e(),Me(new Error("Unable to present.")))})},on.prototype.exitPresent=function(){var z=this.isPresenting,q=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(ce,me){z?(!_e()&&re()&&(q.endPresent_(),q.fireVRDisplayPresentChange_()),Y()&&(q.removeFullscreenWrapper(),q.removeFullscreenListeners_(),q.endPresent_(),q.fireVRDisplayPresentChange_()),ce()):me(new Error("Was not presenting to VRDisplay."))})},on.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},on.prototype.fireVRDisplayPresentChange_=function(){var z=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(z)},on.prototype.fireVRDisplayConnect_=function(){var z=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(z)},on.prototype.addFullscreenListeners_=function(z,q,ce){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=z,this.fullscreenChangeHandler_=q,this.fullscreenErrorHandler_=ce,q&&(document.fullscreenEnabled?z.addEventListener("fullscreenchange",q,!1):document.webkitFullscreenEnabled?z.addEventListener("webkitfullscreenchange",q,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",q,!1):document.msFullscreenEnabled&&z.addEventListener("msfullscreenchange",q,!1)),ce&&(document.fullscreenEnabled?z.addEventListener("fullscreenerror",ce,!1):document.webkitFullscreenEnabled?z.addEventListener("webkitfullscreenerror",ce,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",ce,!1):document.msFullscreenEnabled&&z.addEventListener("msfullscreenerror",ce,!1))},on.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var z=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var q=this.fullscreenChangeHandler_;z.removeEventListener("fullscreenchange",q,!1),z.removeEventListener("webkitfullscreenchange",q,!1),document.removeEventListener("mozfullscreenchange",q,!1),z.removeEventListener("msfullscreenchange",q,!1)}if(this.fullscreenErrorHandler_){var ce=this.fullscreenErrorHandler_;z.removeEventListener("fullscreenerror",ce,!1),z.removeEventListener("webkitfullscreenerror",ce,!1),document.removeEventListener("mozfullscreenerror",ce,!1),z.removeEventListener("msfullscreenerror",ce,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},on.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},on.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},on.prototype.beginPresent_=function(){},on.prototype.endPresent_=function(){},on.prototype.submitFrame=function(z){},on.prototype.getEyeParameters=function(z){return null};var oi={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},or={LEFT:"left",RIGHT:"right"};function gi(z){var q=kt({},oi);z=kt(q,z||{}),on.call(this,{wakelock:z.MOBILE_WAKE_LOCK}),this.config=z,this.displayName="Cardboard VRDisplay",this.capabilities=new Vi({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new Ie(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Er(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Ti(this.dpdb_.getDeviceParams(),z.ADDITIONAL_VIEWERS),this.viewerSelector_=new Ft(z.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new tt),re()&&window.addEventListener("resize",this.onResize_.bind(this))}return gi.prototype=Object.create(on.prototype),gi.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},gi.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},gi.prototype._getFieldOfView=function(z){var q;if(z==or.LEFT)q=this.deviceInfo_.getFieldOfViewLeftEye();else if(z==or.RIGHT)q=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",z),null;return q},gi.prototype._getEyeOffset=function(z){var q;if(z==or.LEFT)q=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(z==or.RIGHT)q=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",z),null;return q},gi.prototype.getEyeParameters=function(z){var q=this._getEyeOffset(z),ce=this._getFieldOfView(z),me={offset:q,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(me,"fieldOfView",{enumerable:!0,get:function(){return Wn("VRFieldOfView","VRFrameData's projection matrices"),ce}}),me},gi.prototype.onDeviceParamsUpdated_=function(z){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(z),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},gi.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},gi.prototype.beginPresent_=function(){var z=this.layer_.source.getContext("webgl");z||(z=this.layer_.source.getContext("experimental-webgl")),z||(z=this.layer_.source.getContext("webgl2")),z&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(z.canvas.width=J()*this.bufferScale_,z.canvas.height=ve()*this.bufferScale_,this.cardboardUI_=new Ne(z)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Ne(z)),this.distorter_=new Kn(z,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(q){this.viewerSelector_.show(this.layer_.source.parentElement),q.stopPropagation(),q.preventDefault()}).bind(this),(function(q){this.exitPresent(),q.stopPropagation(),q.preventDefault()}).bind(this)),this.rotateInstructions_&&(O()&&Bt()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},gi.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},gi.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},gi.prototype.submitFrame=function(z){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var q=this.layer_.source.getContext("webgl");q||(q=this.layer_.source.getContext("experimental-webgl")),q||(q=this.layer_.source.getContext("webgl2"));var ce=q.canvas;(ce.width!=this.lastWidth||ce.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=ce.width,this.lastHeight=ce.height,this.cardboardUI_.render()}},gi.prototype.onOrientationChange_=function(z){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},gi.prototype.onResize_=function(z){if(this.layer_){var q=this.layer_.source.getContext("webgl");q||(q=this.layer_.source.getContext("experimental-webgl")),q||(q=this.layer_.source.getContext("webgl2"));var ce=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];q.canvas.setAttribute("style",ce.join("; ")+";"),jt(q.canvas)}},gi.prototype.onViewerChanged_=function(z){this.deviceInfo_.setViewer(z),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},gi.prototype.fireVRDisplayDeviceParamsChange_=function(){var z=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(z)},gi.VRFrameData=Wi,gi.VRDisplay=on,gi})}),l=w(m),y="0.10.12",g={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function d(_){this.config=f(f({},g),_),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&v())&&(this.enable(),this.getVRDisplays().then(function(L){L&&L[0]&&L[0].fireVRDisplayConnect_&&L[0].fireVRDisplayConnect_()}))}d.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(v()){var _=new l({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(_)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},d.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var _=this.native.VRFrameData,L=new this.native.VRFrameData,T=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(N){if(N instanceof _){T.call(this,N);return}T.call(this,L),N.pose=L.pose,a(L.leftProjectionMatrix,N.leftProjectionMatrix),a(L.rightProjectionMatrix,N.rightProjectionMatrix),a(L.leftViewMatrix,N.leftViewMatrix),a(L.rightViewMatrix,N.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=l.VRDisplay,window.VRFrameData=l.VRFrameData},d.prototype.getVRDisplays=function(){var _=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(L){return L.length>0?L:_.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},d.version=y,d.VRFrameData=l.VRFrameData,d.VRDisplay=l.VRDisplay;var p=Object.freeze({default:d}),C=p&&d||p;typeof u<"u"&&u.window&&(u.document||(u.document=u.window.document),u.navigator||(u.navigator=u.window.navigator));var S=C;return S})},"./node_modules/word-wrapper/index.js":W=>{var $=/\n/,A=`
`,u=/\s/;W.exports=function(m,l){var y=W.exports.lines(m,l);return y.map(function(g){return m.substring(g.start,g.end)}).join(`
`)},W.exports.lines=function(l,y){if(y=y||{},y.width===0&&y.mode!=="nowrap")return[];l=l||"";var g=typeof y.width=="number"?y.width:Number.MAX_VALUE,d=Math.max(0,y.start||0),p=typeof y.end=="number"?y.end:l.length,C=y.mode,S=y.measure||f;return C==="pre"?v(S,l,d,p,g):a(S,l,d,p,g,C)};function w(m,l,y,g){var d=m.indexOf(l,y);return d===-1||d>g?g:d}function h(m){return u.test(m)}function v(m,l,y,g,d){for(var p=[],C=y,S=y;S<g&&S<l.length;S++){var _=l.charAt(S),L=$.test(_);if(L||S===g-1){var T=L?S:S+1,N=m(l,C,T,d);p.push(N),C=S+1}}return p}function a(m,l,y,g,d,p){var C=[],S=d;for(p==="nowrap"&&(S=Number.MAX_VALUE);y<g&&y<l.length;){for(var _=w(l,A,y,g);y<_&&h(l.charAt(y));)y++;var L=m(l,y,_,S),T=y+(L.end-L.start),N=T+A.length;if(T<_){for(;T>y&&!h(l.charAt(T));)T--;if(T===y)N>y+A.length&&N--,T=N;else for(N=T;T>y&&h(l.charAt(T-A.length));)T--}if(T>=y){var F=m(l,y,T,S);C.push(F)}y=N}return C}function f(m,l,y,g){var d=Math.min(g,y-l);return{start:l,end:l+d}}},"./node_modules/xhr/index.js":(W,$,A)=>{var u=A("./node_modules/global/window.js"),w=A("./node_modules/is-function/index.js"),h=A("./node_modules/parse-headers/parse-headers.js"),v=A("./node_modules/xtend/immutable.js");W.exports=l,W.exports.default=l,l.XMLHttpRequest=u.XMLHttpRequest||d,l.XDomainRequest="withCredentials"in new l.XMLHttpRequest?l.XMLHttpRequest:u.XDomainRequest,a(["get","put","post","patch","head","delete"],function(p){l[p==="delete"?"del":p]=function(C,S,_){return S=m(C,S,_),S.method=p.toUpperCase(),y(S)}});function a(p,C){for(var S=0;S<p.length;S++)C(p[S])}function f(p){for(var C in p)if(p.hasOwnProperty(C))return!1;return!0}function m(p,C,S){var _=p;return w(C)?(S=C,typeof p=="string"&&(_={uri:p})):_=v(C,{uri:p}),_.callback=S,_}function l(p,C,S){return C=m(p,C,S),y(C)}function y(p){if(typeof p.callback>"u")throw new Error("callback argument missing");var C=!1,S=function(I,O,Q){C||(C=!0,p.callback(I,O,Q))};function _(){F.readyState===4&&setTimeout(N,0)}function L(){var b=void 0;if(F.response?b=F.response:b=F.responseText||g(F),oe)try{b=JSON.parse(b)}catch{}return b}function T(b){return clearTimeout(ae),b instanceof Error||(b=new Error(""+(b||"Unknown XMLHttpRequest Error"))),b.statusCode=0,S(b,Ae)}function N(){if(!K){var b;clearTimeout(ae),p.useXDR&&F.status===void 0?b=200:b=F.status===1223?204:F.status;var I=Ae,O=null;return b!==0?(I={body:L(),statusCode:b,method:ne,headers:{},url:se,rawRequest:F},F.getAllResponseHeaders&&(I.headers=h(F.getAllResponseHeaders()))):O=new Error("Internal XMLHttpRequest Error"),S(O,I,I.body)}}var F=p.xhr||null;F||(p.cors||p.useXDR?F=new l.XDomainRequest:F=new l.XMLHttpRequest);var te,K,se=F.url=p.uri||p.url,ne=F.method=p.method||"GET",re=p.body||p.data,Y=F.headers=p.headers||{},k=!!p.sync,oe=!1,ae,Ae={body:void 0,headers:{},statusCode:0,method:ne,url:se,rawRequest:F};if("json"in p&&p.json!==!1&&(oe=!0,Y.accept||Y.Accept||(Y.Accept="application/json"),ne!=="GET"&&ne!=="HEAD"&&(Y["content-type"]||Y["Content-Type"]||(Y["Content-Type"]="application/json"),re=JSON.stringify(p.json===!0?re:p.json))),F.onreadystatechange=_,F.onload=N,F.onerror=T,F.onprogress=function(){},F.onabort=function(){K=!0},F.ontimeout=T,F.open(ne,se,!k,p.username,p.password),k||(F.withCredentials=!!p.withCredentials),!k&&p.timeout>0&&(ae=setTimeout(function(){if(!K){K=!0,F.abort("timeout");var b=new Error("XMLHttpRequest timeout");b.code="ETIMEDOUT",T(b)}},p.timeout)),F.setRequestHeader)for(te in Y)Y.hasOwnProperty(te)&&F.setRequestHeader(te,Y[te]);else if(p.headers&&!f(p.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in p&&(F.responseType=p.responseType),"beforeSend"in p&&typeof p.beforeSend=="function"&&p.beforeSend(F),F.send(re||null),F}function g(p){try{if(p.responseType==="document")return p.responseXML;var C=p.responseXML&&p.responseXML.documentElement.nodeName==="parsererror";if(p.responseType===""&&!C)return p.responseXML}catch{}return null}function d(){}},"./node_modules/xml-parse-from-string/index.js":W=>{W.exports=function(){return typeof self.DOMParser<"u"?function(A){var u=new self.DOMParser;return u.parseFromString(A,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(A){var u=new self.ActiveXObject("Microsoft.XMLDOM");return u.async="false",u.loadXML(A),u}:function(A){var u=document.createElement("div");return u.innerHTML=A,u}}()},"./node_modules/xtend/immutable.js":W=>{W.exports=A;var $=Object.prototype.hasOwnProperty;function A(){for(var u={},w=0;w<arguments.length;w++){var h=arguments[w];for(var v in h)$.call(h,v)&&(u[v]=h[v])}return u}},"./src/components/anchored.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/index.js"),h=w.debug("components:anchored:warn");W.exports.Component=u("anchored",{schema:{persistent:{default:!1}},init:function(){var a=this.el.sceneEl,f=a.getAttribute("webxr"),m=f.optionalFeatures;m.indexOf("anchors")===-1&&(m.push("anchors"),this.el.sceneEl.setAttribute("webxr",f)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var a=this.el.sceneEl,f=a.renderer.xr,m,l,y,g=this.el.object3D;!a.is("ar-mode")&&!a.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),this.anchor&&(m=a.frame,l=f.getReferenceSpace(),y=m.getPose(this.anchor.anchorSpace,l),g.matrix.elements=y.transform.matrix,g.matrix.decompose(g.position,g.rotation,g.scale)))},createAnchor:async function(f,m){var l=this.el.sceneEl,y=l.renderer.xr,g,d,p,C,S=this.el.object3D;if(f=f||S.position,m=m||this.auxQuaternion.setFromEuler(S.rotation),!v(l)){h("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),g=l.frame,d=y.getReferenceSpace(),p=new XRRigidTransform({x:f.x,y:f.y,z:f.z},{x:m.x,y:m.y,z:m.z,w:m.w}),this.requestAnchorPending=!1,C=await g.createAnchor(p,d),this.data.persistent&&(this.el.id?(this.persistentHandle=await C.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):h("The anchor won't be persisted because the entity has no assigned id.")),l.object3D.attach(this.el.object3D),this.anchor=C},restorePersistentAnchor:async function(){var f=this.el.sceneEl.renderer.xr,m=f.getSession(),l=m.persistentAnchors,y;if(this.requestPersistentAnchorPending=!1,!this.el.id){h("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(l){y=localStorage.getItem(this.el.id);for(var g=0;g<l.length;++g)if(y===l[g]){this.anchor=await m.restorePersistentAnchor(l[g]),this.anchor&&(this.persistentHandle=l[g]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0},deleteAnchor:function(){var a,f,m=this.anchor;m&&(a=this.el.sceneEl.renderer.xr,f=a.getSession(),m.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&f.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function v(a){var f=a.renderer.xr,m=f.getSession();return m&&m.restorePersistentAnchor}},"./src/components/animation.js":(W,$,A)=>{var u=A("./node_modules/super-animejs/lib/anime.es.js").default,w=A("./src/core/component.js").components,h=A("./src/core/component.js").registerComponent,v=A("./src/lib/three.js"),a=A("./src/utils/index.js"),f=new v.Color,m=new v.Color,l=a.entity.getComponentProperty,y=a.entity.setComponentProperty,g={},d="color",p="position",C="rotation",S="scale",_="components",L="object3D";W.exports.Component=h("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(Y){return Y===!0||Y==="true"?!0:Y===!1||Y==="false"?!1:parseInt(Y,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var Y=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){Y.animationIsPlaying=!1,Y.el.emit("animationcomplete",Y.eventDetail,!1),Y.id&&Y.el.emit("animationcomplete__"+Y.id,Y.eventDetail,!1)}}},update:function(Y){var k=this.config,oe=this.data;this.animationIsPlaying=!1,this.data.enabled&&oe.property&&(k.autoplay=!1,k.direction=oe.dir,k.duration=oe.dur,k.easing=oe.easing,k.elasticity=oe.elasticity,k.loop=oe.loop,k.round=oe.round,this.createAndStartAnimation())},tick:function(Y,k){this.animationIsPlaying&&(this.time+=k,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var Y=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=u(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!Y.autoplay||Y.startEvents&&Y.startEvents.length)){if(Y.delay){setTimeout(this.beginAnimation,Y.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=u(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var Y=this.config,k=this.data,oe=this.el,ae,Ae,b;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){ae=k.from===""?K(oe,k.property):k.from,b=k.to,this.setColorConfig(ae,b),ae=this.fromColor,b=this.toColor,this.targetsArray.length=0,this.targetsArray.push(ae),Y.targets=this.targetsArray;for(Ae in b)Y[Ae]=b[Ae];Y.update=function(){var I={};return function(O){var Q;Q=O.animatables[0].target,!(Q.r===I.r&&Q.g===I.g&&Q.b===I.b)&&se(oe,k.property,Q,k.type)}}()}},updateConfigForDefault:function(){var Y=this.config,k=this.data,oe=this.el,ae,Ae,b,I;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(k.from===""?ae=re(k)?K(oe,k.property):l(oe,k.property):ae=k.from,I=k.to,b=!isNaN(ae||I),b?(ae=parseFloat(ae),I=parseFloat(I)):(ae=ae&&ae.toString(),I=I&&I.toString()),Ae=k.to==="true"||k.to==="false"||k.to===!0||k.to===!1,Ae&&(ae=k.from==="true"||k.from===!0?1:0,I=k.to==="true"||k.to===!0?1:0),this.targets.aframeProperty=ae,Y.targets=this.targets,Y.aframeProperty=I,Y.update=function(){var O;return function(Q){var J;J=Q.animatables[0].target.aframeProperty,J!==O&&(O=J,Ae&&(J=J>=1),re(k)?se(oe,k.property,J,k.type):y(oe,k.property,J))}}())},updateConfigForVector:function(){var Y=this.config,k=this.data,oe=this.el,ae,Ae,b;Ae=k.from!==""?a.coordinates.parse(k.from):l(oe,k.property),b=a.coordinates.parse(k.to),k.property===C&&(N(Ae),N(b)),this.targetsArray.length=0,this.targetsArray.push(Ae),Y.targets=this.targetsArray;for(ae in b)Y[ae]=b[ae];if(k.property===p||k.property===C||k.property===S){Y.update=function(){var I={};return function(O){var Q=O.animatables[0].target;Q.x===I.x&&Q.y===I.y&&Q.z===I.z||(I.x=Q.x,I.y=Q.y,I.z=Q.z,oe.object3D[k.property].set(Q.x,Q.y,Q.z))}}();return}Y.update=function(){var I={};return function(O){var Q=O.animatables[0].target;Q.x===I.x&&Q.y===I.y&&Q.z===I.z||(I.x=Q.x,I.y=Q.y,I.z=Q.z,y(oe,k.property,Q))}}()},updateConfig:function(){var Y;Y=T(this.el,this.data.property),re(this.data)&&this.data.type===d?this.updateConfigForRawColor():Y==="vec2"||Y==="vec3"||Y==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(Y){var k,oe=this.data,ae=this.el,Ae=this;return oe.from!==""||!oe.property.startsWith(_)||(k=ne(oe.property)[1],ae.components[k])?!1:(ae.addEventListener("componentinitialized",function b(I){I.detail.name===k&&(Y(),Ae.animation=u(Ae.config),ae.removeEventListener("componentinitialized",b))}),!0)},stopRelatedAnimations:function(){var Y,k;for(k in this.el.components)Y=this.el.components[k],k!==this.attrName&&Y.name==="animation"&&Y.animationIsPlaying&&Y.data.property===this.data.property&&(Y.animationIsPlaying=!1)},addEventListeners:function(){var Y=this.data,k=this.el;F(k,Y.startEvents,this.onStartEvent),F(k,Y.pauseEvents,this.pauseAnimation),F(k,Y.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var Y=this.data,k=this.el;te(k,Y.startEvents,this.onStartEvent),te(k,Y.pauseEvents,this.pauseAnimation),te(k,Y.resumeEvents,this.resumeAnimation)},setColorConfig:function(Y,k){f.set(Y),m.set(k),Y=this.fromColor,k=this.toColor,Y.r=f.r,Y.g=f.g,Y.b=f.b,k.r=m.r,k.g=m.g,k.b=m.b}});function T(Y,k){var oe,ae,Ae,b;return Ae=k.split("."),ae=Ae[0],b=Ae[1],oe=Y.components[ae]||w[ae],!oe||b&&!oe.schema[b]?null:b?oe.schema[b].type:oe.schema.type}function N(Y){Y.x=v.MathUtils.degToRad(Y.x),Y.y=v.MathUtils.degToRad(Y.y),Y.z=v.MathUtils.degToRad(Y.z)}function F(Y,k,oe){var ae;for(ae=0;ae<k.length;ae++)Y.addEventListener(k[ae],oe)}function te(Y,k,oe){var ae;for(ae=0;ae<k.length;ae++)Y.removeEventListener(k[ae],oe)}function K(Y,k){var oe,ae,Ae;for(ae=ne(k),Ae=Y,oe=0;oe<ae.length;oe++)Ae=Ae[ae[oe]];if(Ae===void 0)throw console.log(Y),new Error("[animation] property ("+k+") could not be found");return Ae}function se(Y,k,oe,ae){var Ae,b,I,O;for(k.startsWith("object3D.rotation")&&(oe=v.MathUtils.degToRad(oe)),b=ne(k),O=Y,Ae=0;Ae<b.length-1;Ae++)O=O[b[Ae]];if(I=b[b.length-1],ae===d){"r"in O[I]?(O[I].r=oe.r,O[I].g=oe.g,O[I].b=oe.b):(O[I].x=oe.r,O[I].y=oe.g,O[I].z=oe.b);return}O[I]=oe}function ne(Y){return Y in g||(g[Y]=Y.split(".")),g[Y]}function re(Y){return Y.isRawProperty||Y.property.startsWith(_)||Y.property.startsWith(L)}},"./src/components/camera.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js");W.exports.Component=u("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var h,v=this.el;h=this.camera=new w.PerspectiveCamera,v.setObject3D("camera",h)},update:function(h){var v=this.data,a=this.camera;a.aspect=v.aspect||window.innerWidth/window.innerHeight,a.far=v.far,a.fov=v.fov,a.near=v.near,a.zoom=v.zoom,a.updateProjectionMatrix(),this.updateActiveCamera(h),this.updateSpectatorCamera(h)},updateActiveCamera:function(h){var v=this.data,a=this.el,f=this.system;h&&h.active===v.active||v.spectator||(v.active&&f.activeCameraEl!==a?f.setActiveCamera(a):!v.active&&f.activeCameraEl===a&&f.disableActiveCamera())},updateSpectatorCamera:function(h){var v=this.data,a=this.el,f=this.system;h&&h.spectator===v.spectator||(v.spectator&&f.spectatorCameraEl!==a?f.setSpectatorCamera(a):!v.spectator&&f.spectatorCameraEl===a&&f.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/index.js"),h={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},v={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},a={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},f={DOWN:["selectstart"],UP:["selectend"]},m="a-mouse-cursor-hover";W.exports.Component=u("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:w.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},after:["tracked-controls"],multiple:!0,init:function(){var l=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=w.debounce(function(){l.canvasBounds=l.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=this.onCursorDown.bind(this),this.onCursorUp=this.onCursorUp.bind(this),this.onIntersection=this.onIntersection.bind(this),this.onIntersectionCleared=this.onIntersectionCleared.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},update:function(l){this.data.rayOrigin!==l.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var l=this.el.sceneEl.frame,y=this.activeXRInput;this.data.rayOrigin==="xrselect"&&l&&y&&this.onMouseMove({frame:l,inputSource:y,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var l=this.el;l.removeState(v.HOVERING),l.removeState(v.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(v.HOVERED),this.removeEventListeners()},addEventListeners:function(){var l,y=this.data,g=this.el,d=this;function p(){l=g.sceneEl.canvas,!(y.downEvents.length||y.upEvents.length)&&(a.DOWN.forEach(function(C){l.addEventListener(C,d.onCursorDown,{passive:!1})}),a.UP.forEach(function(C){l.addEventListener(C,d.onCursorUp,{passive:!1})}))}l=g.sceneEl.canvas,l?p():g.sceneEl.addEventListener("render-target-loaded",p),y.downEvents.forEach(function(C){g.addEventListener(C,d.onCursorDown)}),y.upEvents.forEach(function(C){g.addEventListener(C,d.onCursorUp)}),g.addEventListener("raycaster-intersection",this.onIntersection),g.addEventListener("raycaster-closest-entity-changed",this.onIntersection),g.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),g.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),g.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var l,y=this.data,g=this.el,d=this;l=g.sceneEl.canvas,l&&!y.downEvents.length&&!y.upEvents.length&&(a.DOWN.forEach(function(p){l.removeEventListener(p,d.onCursorDown)}),a.UP.forEach(function(p){l.removeEventListener(p,d.onCursorUp)})),y.downEvents.forEach(function(p){g.removeEventListener(p,d.onCursorDown)}),y.upEvents.forEach(function(p){g.removeEventListener(p,d.onCursorUp)}),g.removeEventListener("raycaster-intersection",this.onIntersection),g.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),l.removeEventListener("mousemove",this.onMouseMove),l.removeEventListener("touchstart",this.onMouseMove),l.removeEventListener("touchmove",this.onMouseMove),g.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),g.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var l,y=this.el;l=y.sceneEl.canvas,l.removeEventListener("mousemove",this.onMouseMove),l.removeEventListener("touchmove",this.onMouseMove),y.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(l.addEventListener("mousemove",this.onMouseMove),l.addEventListener("touchmove",this.onMouseMove,{passive:!1}),y.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var l=new THREE.Vector3,y=new THREE.Vector2,g=new THREE.Vector3,d={origin:g,direction:l};return function(p){var C=this.canvasBounds,S=this.el.sceneEl.camera,_,L,T,N,F,te,K,se;S.parent.updateMatrixWorld(),p.type==="touchmove"||p.type==="touchstart"?L=p.touches.item(0):L=p,_=L.clientX-C.left,T=L.clientY-C.top,y.x=_/C.width*2-1,y.y=-(T/C.height)*2+1,this.data.rayOrigin==="xrselect"&&(p.type==="selectstart"||p.type==="fakeselectevent")?(N=p.frame,F=p.inputSource,te=this.el.renderer.xr.getReferenceSpace(),K=N.getPose(F.targetRaySpace,te),se=K.transform,l.set(0,0,-1),l.applyQuaternion(se.orientation),g.copy(se.position)):p.type==="fakeselectout"?(l.set(0,1,0),g.set(0,9999,0)):S&&S.isPerspectiveCamera?(g.setFromMatrixPosition(S.matrixWorld),l.set(y.x,y.y,.5).unproject(S).sub(g).normalize()):S&&S.isOrthographicCamera?(g.set(y.x,y.y,(S.near+S.far)/(S.near-S.far)).unproject(S),l.set(0,0,-1).transformDirection(S.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+S.type),this.el.setAttribute("raycaster",d),p.type==="touchmove"&&p.preventDefault()}}(),onCursorDown:function(l){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&l.type==="touchstart"&&(this.onMouseMove(l),this.el.components.raycaster.checkIntersections(),l.preventDefault()),this.data.rayOrigin==="xrselect"&&l.type==="selectstart"&&(this.activeXRInput=l.inputSource,this.onMouseMove(l),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(h.MOUSEDOWN,l),this.cursorDownEl=this.intersectedEl},onCursorUp:function(l){if(this.isCursorDown){this.isCursorDown=!1;var y=this.data;this.twoWayEmit(h.MOUSEUP,l),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(h.MOUSEUP,this.intersectedEventDetail)),(!y.fuse||y.rayOrigin==="mouse"||y.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(h.CLICK,l),y.rayOrigin==="xrselect"&&this.activeXRInput===l.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,l.type==="touchend"&&l.preventDefault()}},onIntersection:function(l){var y,g=this.el,d,p,C;d=l.detail.els[0]===g?1:0,C=l.detail.intersections[d],p=l.detail.els[d],p&&this.intersectedEl!==p&&(this.intersectedEl&&(y=this.el.components.raycaster.getIntersection(this.intersectedEl),y&&y.distance<=C.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(p,C)))},onIntersectionCleared:function(l){var y=l.detail.clearedEls;y.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var l=this.el.sceneEl.xrSession,y=this;l&&this.data.rayOrigin!=="mouse"&&(f.DOWN.forEach(function(g){l.addEventListener(g,y.onCursorDown)}),f.UP.forEach(function(g){l.addEventListener(g,y.onCursorUp)}))},setIntersection:function(l,y){var g=this.el,d=this.data,p=this;this.intersectedEl!==l&&(this.intersectedEl=l,g.addState(v.HOVERING),l.addState(v.HOVERED),this.twoWayEmit(h.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(m),!(d.fuseTimeout===0||!d.fuse||d.rayOrigin==="xrselect"||d.rayOrigin==="mouse")&&(g.addState(v.FUSING),this.twoWayEmit(h.FUSING),this.fuseTimeout=setTimeout(function(){g.removeState(v.FUSING),p.twoWayEmit(h.CLICK)},d.fuseTimeout)))},clearCurrentIntersection:function(l){var y,g,d,p=this.el;this.intersectedEl&&(this.intersectedEl.removeState(v.HOVERED),p.removeState(v.HOVERING),p.removeState(v.FUSING),this.twoWayEmit(h.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(m),this.intersectedEl=null,clearTimeout(this.fuseTimeout),l!==!0&&(d=this.el.components.raycaster.intersections,d.length!==0&&(y=d[0].object.el===p?1:0,g=d[y],g&&this.setIntersection(g.object.el,g))))},twoWayEmit:function(l,y){var g=this.el,d=this.intersectedEl,p;function C(S,_){y instanceof MouseEvent?S.mouseEvent=y:typeof TouchEvent<"u"&&y instanceof TouchEvent&&(S.touchEvent=y)}p=this.el.components.raycaster.getIntersection(d),this.eventDetail.intersectedEl=d,this.eventDetail.intersection=p,C(this.eventDetail),g.emit(l,this.eventDetail),d&&(this.intersectedEventDetail.intersection=p,C(this.intersectedEventDetail),d.emit(l,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/tracked-controls.js"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,a=w.onButtonEvent,f="generic",m={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};W.exports.Component=u("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},after:["tracked-controls"],mapping:m,bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var l=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(y){a(y.detail.id,"down",l)},this.onButtonUp=function(y){a(y.detail.id,"up",l)},this.onButtonTouchStart=function(y){a(y.detail.id,"touchstart",l)},this.onButtonTouchEnd=function(y){a(y.detail.id,"touchend",l)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(y){y.detail.name!==l.name&&(l.wasControllerConnected=!0,l.removeEventListeners(),l.removeControllersUpdateListener())})},addEventListeners:function(){var l=this.el;l.addEventListener("buttonchanged",this.onButtonChanged),l.addEventListener("buttondown",this.onButtonDown),l.addEventListener("buttonup",this.onButtonUp),l.addEventListener("touchstart",this.onButtonTouchStart),l.addEventListener("touchend",this.onButtonTouchEnd),l.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var l=this.el;l.removeEventListener("buttonchanged",this.onButtonChanged),l.removeEventListener("buttondown",this.onButtonDown),l.removeEventListener("buttonup",this.onButtonUp),l.removeEventListener("touchstart",this.onButtonTouchStart),l.removeEventListener("touchend",this.onButtonTouchEnd),l.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var l=this.data,y=l.hand?l.hand:void 0;h(this,f,{hand:y,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var l=this.el,y=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}l.setAttribute("tracked-controls",{hand:y.hand,idPrefix:f,orientationOffset:y.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(l){var y=this.mapping.buttons[l.detail.id];y&&this.el.emit(y+"changed",l.detail.state)},onAxisMoved:function(l){v(this,this.mapping.axes,l)},initDefaultModel:function(){var l=this.modelEl=document.createElement("a-entity");l.setAttribute("geometry",{primitive:"sphere",radius:.03}),l.setAttribute("material",{color:this.data.color}),this.el.appendChild(l),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(W,$,A)=>{var u=A("./src/core/geometry.js").geometries,w=A("./src/core/geometry.js").geometryNames,h=A("./src/core/component.js").registerComponent,v=A("./src/lib/three.js"),a=new v.BufferGeometry;W.exports.Component=h("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:w,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(f){var m=this.data,l=this.el,y,g=this.system;this.geometry&&(g.unuseGeometry(f),this.geometry=null),this.geometry=g.getOrCreateGeometry(m),y=l.getObject3D("mesh"),y?y.geometry=this.geometry:(y=new v.Mesh,y.geometry=this.geometry,this.el.getAttribute("material")||(y.material=new v.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),l.setObject3D("mesh",y))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=a,this.geometry=null},updateSchema:function(f){var m=this.oldData&&this.oldData.primitive,l=f.primitive,y=u[l]&&u[l].schema;if(!y)throw new Error("Unknown geometry schema `"+l+"`");m&&m===l||this.extendSchema(y)}})},"./src/components/gltf-model.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/index.js"),v=h.debug("components:gltf-model:warn");W.exports.Component=u("gltf-model",{schema:{type:"model"},init:function(){var a=this,f=this.system.getDRACOLoader(),m=this.system.getMeshoptDecoder(),l=this.system.getKTX2Loader();this.model=null,this.loader=new w.GLTFLoader,f&&this.loader.setDRACOLoader(f),m?this.ready=m.then(function(y){a.loader.setMeshoptDecoder(y)}):this.ready=Promise.resolve(),l&&this.loader.setKTX2Loader(l)},update:function(){var a=this,f=this.el,m=this.data;m&&(this.remove(),this.ready.then(function(){a.loader.load(m,function(y){a.model=y.scene||y.scenes[0],a.model.animations=y.animations,f.setObject3D("mesh",a.model),f.emit("model-loaded",{format:"gltf",model:a.model})},void 0,function(y){var g=y&&y.message?y.message:"Failed to load glTF model";v(g),f.emit("model-error",{format:"gltf",src:m})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;u("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/constants/index.js").AFRAME_CDN_ROOT,h={toonLeft:w+"controllers/hands/leftHand.glb",toonRight:w+"controllers/hands/rightHand.glb",lowPolyLeft:w+"controllers/hands/leftHandLow.glb",lowPolyRight:w+"controllers/hands/rightHandLow.glb",highPolyLeft:w+"controllers/hands/leftHandHigh.glb",highPolyRight:w+"controllers/hands/rightHandHigh.glb"},v={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},a={};a[v.fist]="grip",a[v.thumbUp]="pistol",a[v.point]="pointing",W.exports.Component=u("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},after:["tracked-controls"],init:function(){var l=this,y=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){l.handleButton("grip","down")},this.onGripUp=function(){l.handleButton("grip","up")},this.onTrackpadDown=function(){l.handleButton("trackpad","down")},this.onTrackpadUp=function(){l.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){l.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){l.handleButton("trackpad","touchend")},this.onTriggerDown=function(){l.handleButton("trigger","down")},this.onTriggerUp=function(){l.handleButton("trigger","up")},this.onTriggerTouchStart=function(){l.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){l.handleButton("trigger","touchend")},this.onGripTouchStart=function(){l.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){l.handleButton("grip","touchend")},this.onThumbstickDown=function(){l.handleButton("thumbstick","down")},this.onThumbstickUp=function(){l.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){l.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){l.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){l.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){l.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){l.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){l.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),y.addEventListener("controllerconnected",this.onControllerConnected),y.addEventListener("controllerdisconnected",this.onControllerDisconnected),y.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(l,y){var g=this.el.getObject3D("mesh");!g||!g.mixer||g.mixer.update(y/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var l=this.el;l.addEventListener("gripdown",this.onGripDown),l.addEventListener("gripup",this.onGripUp),l.addEventListener("trackpaddown",this.onTrackpadDown),l.addEventListener("trackpadup",this.onTrackpadUp),l.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),l.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),l.addEventListener("triggerdown",this.onTriggerDown),l.addEventListener("triggerup",this.onTriggerUp),l.addEventListener("triggertouchstart",this.onTriggerTouchStart),l.addEventListener("triggertouchend",this.onTriggerTouchEnd),l.addEventListener("griptouchstart",this.onGripTouchStart),l.addEventListener("griptouchend",this.onGripTouchEnd),l.addEventListener("thumbstickdown",this.onThumbstickDown),l.addEventListener("thumbstickup",this.onThumbstickUp),l.addEventListener("abuttontouchstart",this.onAorXTouchStart),l.addEventListener("abuttontouchend",this.onAorXTouchEnd),l.addEventListener("bbuttontouchstart",this.onBorYTouchStart),l.addEventListener("bbuttontouchend",this.onBorYTouchEnd),l.addEventListener("xbuttontouchstart",this.onAorXTouchStart),l.addEventListener("xbuttontouchend",this.onAorXTouchEnd),l.addEventListener("ybuttontouchstart",this.onBorYTouchStart),l.addEventListener("ybuttontouchend",this.onBorYTouchEnd),l.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),l.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var l=this.el;l.removeEventListener("gripdown",this.onGripDown),l.removeEventListener("gripup",this.onGripUp),l.removeEventListener("trackpaddown",this.onTrackpadDown),l.removeEventListener("trackpadup",this.onTrackpadUp),l.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),l.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),l.removeEventListener("triggerdown",this.onTriggerDown),l.removeEventListener("triggerup",this.onTriggerUp),l.removeEventListener("triggertouchstart",this.onTriggerTouchStart),l.removeEventListener("triggertouchend",this.onTriggerTouchEnd),l.removeEventListener("griptouchstart",this.onGripTouchStart),l.removeEventListener("griptouchend",this.onGripTouchEnd),l.removeEventListener("thumbstickdown",this.onThumbstickDown),l.removeEventListener("thumbstickup",this.onThumbstickUp),l.removeEventListener("abuttontouchstart",this.onAorXTouchStart),l.removeEventListener("abuttontouchend",this.onAorXTouchEnd),l.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),l.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),l.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),l.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),l.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),l.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),l.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),l.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(l){var y,g=this.el,d=this.data.hand,p=this.data.handModelStyle,C=this.data.color,S=this;if(y={hand:d,model:!1},d!==l){var _=h[p+d.charAt(0).toUpperCase()+d.slice(1)];this.loader.load(_,function(L){var T=L.scene.children[0],N=d==="left"?Math.PI/2:-Math.PI/2,F=g.sceneEl.hasWebXR?-Math.PI/2:0;T.mixer=new THREE.AnimationMixer(T),S.clips=L.animations,g.setObject3D("mesh",T),T.traverse(function(te){te.isMesh&&(te.material.color=new THREE.Color(C))}),T.position.set(0,0,0),T.rotation.set(F,0,N),g.setAttribute("magicleap-controls",y),g.setAttribute("vive-controls",y),g.setAttribute("oculus-touch-controls",y),g.setAttribute("pico-controls",y),g.setAttribute("windows-motion-controls",y),g.setAttribute("hp-mixed-reality-controls",y)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(l,y){var g,d=y==="down",p=y==="touchstart";if(y.indexOf("touch")===0){if(p===this.touchedButtons[l])return;this.touchedButtons[l]=p}else{if(d===this.pressedButtons[l])return;this.pressedButtons[l]=d}g=this.gesture,this.gesture=this.determineGesture(),this.gesture!==g&&(this.animateGesture(this.gesture,g),this.emitGestureEvents(this.gesture,g))},determineGesture:function(){var l,y=this.pressedButtons.grip,g=this.pressedButtons.surface||this.touchedButtons.surface,d=this.pressedButtons.trackpad||this.touchedButtons.trackpad,p=this.pressedButtons.trigger||this.touchedButtons.trigger,C=this.touchedButtons.AorX||this.touchedButtons.BorY,S=m(this.el.components["tracked-controls"]);return S?y||p?l=v.fist:d&&(l=v.point):y?g||C||d?l=p?v.fist:v.point:l=p?v.thumbUp:v.pointThumb:p&&(l=v.hold),l},getClip:function(l){var y,g;for(g=0;g<this.clips.length;g++)if(y=this.clips[g],y.name===l)return y},animateGesture:function(l,y){if(l){this.playAnimation(l||v.open,y,!1);return}this.playAnimation(y,y,!0)},emitGestureEvents:function(l,y){var g=this.el,d;y!==l&&(d=f(y,!1),d&&g.emit(d),d=f(l,!0),d&&g.emit(d))},playAnimation:function(l,y,g){var d,p,C=this.el.getObject3D("mesh"),S;if(C){if(d=this.getClip(l),S=C.mixer.clipAction(d),g){S.paused=!1,S.timeScale=-1;return}if(S.clampWhenFinished=!0,S.loop=THREE.LoopOnce,S.repetitions=0,S.timeScale=1,S.time=0,S.weight=1,!y){C.mixer.stopAllAction(),S.play();return}d=this.getClip(y),S.reset(),S.play(),p=C.mixer.clipAction(d),p.crossFadeTo(S,.15,!0)}}});function f(l,y){var g;if(l){if(g=a[l],g==="grip")return g+(y?"close":"open");if(g==="point")return g+(y?"up":"down");if(g==="pointing"||g==="pistol")return g+(y?"start":"end")}}function m(l){var y=l&&l.controller,g=y&&(y.id&&y.id.indexOf("OpenVR ")===0||y.profiles&&y.profiles[0]&&y.profiles[0]==="htc-vive");return g}},"./src/components/hand-tracking-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/core/a-entity.js").AEntity,h=A("./src/utils/tracked-controls.js"),v=h.checkControllerPresentAndSetup,a=A("./src/constants/index.js").AFRAME_CDN_ROOT,f=a+"controllers/oculus-hands/v4/left.glb",m=a+"controllers/oculus-hands/v4/right.glb",l=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],y=0,g=4,d=9,p=.015,C=.1;W.exports.Component=u("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"},modelOpacity:{default:1}},after:["tracked-controls"],bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var S=0;S<this.jointEls.length;++S)this.jointEls[S].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var S=0;S<this.jointEls.length;++S)this.jointEls[S].object3D.visible=!1},init:function(){var S=this.el.sceneEl,_=S.getAttribute("webxr"),L=_.optionalFeatures;L.indexOf("hand-tracking")===-1&&(L.push("hand-tracking"),S.setAttribute("webxr",_)),this.wristObject3D=new THREE.Object3D,this.el.sceneEl.object3D.add(this.wristObject3D),this.onModelLoaded=this.onModelLoaded.bind(this),this.onChildAttached=this.onChildAttached.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*l.length),this.jointRadii=new Float32Array(l.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace),this.el.addEventListener("child-attached",this.onChildAttached),this.el.object3D.visible=!1,this.wristObject3D.visible=!1},onChildAttached:function(S){this.addChildEntity(S.detail.el)},update:function(){this.updateModelMaterial()},updateModelMaterial:function(){var S=this.jointEls,_=this.skinnedMesh,L=this.data.modelOpacity!==1;_&&(this.skinnedMesh.material.color.set(this.data.modelColor),this.skinnedMesh.material.transparent=L,this.skinnedMesh.material.opacity=this.data.modelOpacity);for(var T=0;T<S.length;T++)S[T].setAttribute("material",{color:this.data.modelColor,transparent:L,opacity:this.data.modelOpacity})},updateReferenceSpace:function(){var S=this,_=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!_){var L=S.el.sceneEl.systems.webxr.sessionReferenceSpaceType;_.requestReferenceSpace(L).then(function(T){S.referenceSpace=T}).catch(function(T){throw S.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(L,"tracked-controls-webxr uses reference space "+L),T})}},checkIfControllerPresent:function(){var S=this.data,_=S.hand?S.hand:void 0;v(this,"",{hand:_,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var S=this.el.sceneEl,_=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,L=S.frame,T=this.el.components["tracked-controls-webxr"],N=this.referenceSpace;!_||!L||!N||!T||(this.hasPoses=!1,_.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=L.fillPoses(_.hand.values(),N,this.jointPoses)&&L.fillJointRadii(_.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture(),this.updateWristObject()))},updateWristObject:function(){var S=new THREE.Matrix4;return function(){var _=this.wristObject3D;!_||!this.hasPoses||(S.fromArray(this.jointPoses,y*16),_.position.setFromMatrixPosition(S),_.quaternion.setFromRotationMatrix(S))}}(),updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(S){for(var _=this.bones,L=0;L<_.length;L++)if(_[L].name===S)return _[L];return null},updateHandMeshModel:function(){var S=new THREE.Matrix4;return function(){var _=0,L=this.jointPoses,T=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!T||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var N of T.hand.values()){var F=this.getBone(N.jointName);F!=null&&(this.mesh.visible=!0,S.fromArray(L,_*16),F.position.setFromMatrixPosition(S),F.quaternion.setFromRotationMatrix(S)),_++}}}(),updateHandDotsModel:function(){for(var S=this.jointPoses,_=this.jointRadii,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,T,N,F=0;F<L.hand.size;F++)T=this.jointEls[F],N=T.object3D,T.object3D.visible=this.hasPoses,this.hasPoses&&(N.matrix.fromArray(S,F*16),N.matrix.decompose(N.position,N.rotation,N.scale),T.setAttribute("scale",{x:_[F],y:_[F],z:_[F]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var S=new THREE.Vector3,_=new THREE.Matrix4;return function(){var L=this.indexTipPosition,T=this.pinchEventDetail;if(this.hasPoses){S.setFromMatrixPosition(_.fromArray(this.jointPoses,g*16)),L.setFromMatrixPosition(_.fromArray(this.jointPoses,d*16)),T.wristRotation.setFromRotationMatrix(_.fromArray(this.jointPoses,y*16));var N=L.distanceTo(S);N<p&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=N,T.position.copy(L).add(S).multiplyScalar(.5),this.el.emit("pinchstarted",T)),N>this.pinchDistance+this.pinchDistance*C&&this.isPinched===!0&&(this.isPinched=!1,T.position.copy(L).add(S).multiplyScalar(.5),this.el.emit("pinchended",T)),this.isPinched&&(T.position.copy(L).add(S).multiplyScalar(.5),this.el.emit("pinchmoved",T))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var S=this.el,_=this.data;if(S.setAttribute("tracked-controls",{id:"",hand:_.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==S.getObject3D("mesh")&&S.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var S=this.el,_;this.checkIfControllerPresent(),_=S.components["tracked-controls"]&&S.components["tracked-controls"].controller,this.mesh&&_&&_.hand&&_.hand instanceof XRHand&&S.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var S=this.data;S.modelStyle==="dots"&&this.initDotsModel(),S.modelStyle==="mesh"&&this.initMeshHandModel(),this.el.object3D.visible=!0,this.wristObject3D.visible=!0},initDotsModel:function(){if(this.jointEls.length===0){for(var S=0;S<l.length;++S){var _=this.jointEl=document.createElement("a-entity");_.setAttribute("geometry",{primitive:"sphere",radius:1}),_.object3D.visible=!1,this.el.appendChild(_),this.jointEls.push(_)}this.updateModelMaterial()}},initMeshHandModel:function(){var S=this.data.hand==="left"?f:m;this.el.setAttribute("gltf-model",S)},onModelLoaded:function(){var S=this.mesh=this.el.getObject3D("mesh").children[0],_=this.skinnedMesh=S.getObjectByProperty("type","SkinnedMesh");this.skinnedMesh&&(this.bones=_.skeleton.bones,this.el.removeObject3D("mesh"),S.position.set(0,0,0),S.rotation.set(0,0,0),_.frustumCulled=!1,_.material=new THREE.MeshStandardMaterial,this.updateModelMaterial(),this.setupChildrenEntities(),this.el.setObject3D("mesh",S))},setupChildrenEntities:function(){for(var S=this.el.children,_=0;_<S.length;++_)S[_]instanceof w&&this.addChildEntity(S[_])},addChildEntity:function(S){S instanceof w&&this.wristObject3D.add(S.object3D)}})},"./src/components/hand-tracking-grab-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js");u("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var h=this.el,v=this.data,a;v.hand==="right"?a="components.hand-tracking-controls.bones.3":a="components.hand-tracking-controls.bones.21",h.setAttribute("hand-tracking-controls",{hand:v.hand}),h.setAttribute("obb-collider",{trackedObject3D:a,size:.04}),this.auxMatrix=new w.Matrix4,this.auxQuaternion=new w.Quaternion,this.auxQuaternion2=new w.Quaternion,this.auxVector=new w.Vector3,this.auxVector2=new w.Vector3,this.grabbingObjectPosition=new w.Vector3,this.grabbedObjectPosition=new w.Vector3,this.grabbedObjectPositionDelta=new w.Vector3,this.grabDeltaPosition=new w.Vector3,this.grabInitialRotation=new w.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var h,v=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),a=0;a<v.length;++a)h=v[a].components["hand-tracking-grab-controls"],h!==this&&this.grabbedEl&&this.grabbedEl===h.grabbedEl&&h.releaseGrabbedEntity();return!1},onCollisionStarted:function(h){var v=h.detail.withEl;this.collidedEl||v.getAttribute("grabbable")&&(this.collidedEl=v,this.grabbingObject3D=h.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(h){this.collidedEl&&(this.pinchPosition=h.detail.position,this.wristRotation=h.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(h){this.wristRotation=h.detail.wristRotation},releaseGrabbedEntity:function(){var h=this.grabbedEl;h&&(h.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,h.object3D.matrixAutoUpdate=!0,h.object3D.matrixWorldAutoUpdate=!0,h.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),h.object3D.position.copy(this.auxVector),h.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:h}),this.grabbedEl=void 0)},grab:function(){var h=this.grabbedEl,v;v=h.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(v).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=h.object3D.updateMatrixWorld,h.object3D.updateMatrixWorld=function(){},h.object3D.updateMatrixWorldChildren=function(a){for(var f=this.children,m=0,l=f.length;m<l;m++){var y=f[m];(y.matrixWorldAutoUpdate===!0||a===!0)&&y.updateMatrixWorld(!0)}},h.object3D.matrixAutoUpdate=!1,h.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:h})},tock:function(){var h=this.auxMatrix,v=this.auxQuaternion,a=this.auxQuaternion2,f,m=this.grabbedEl;m&&(f=m.object3D,f.getWorldQuaternion(a),f.matrixWorld.identity(),h.identity(),h.makeTranslation(this.pinchPosition),f.matrixWorld.multiply(h),h.identity(),h.makeRotationFromQuaternion(v.copy(this.wristRotation).multiply(this.grabInitialRotation)),f.matrixWorld.multiply(h),h.identity(),h.makeTranslation(this.grabDeltaPosition),f.matrixWorld.multiply(h),h.identity(),h.makeRotationFromQuaternion(a),f.matrixWorld.multiply(h),h.makeScale(m.object3D.scale.x,m.object3D.scale.y,m.object3D.scale.z),f.matrixWorld.multiply(h),f.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("hide-on-enter-ar",{init:function(){var w=this;this.el.sceneEl.addEventListener("enter-vr",function(){w.el.sceneEl.is("ar-mode")&&(w.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){w.el.object3D.visible=!0})}})},"./src/components/hide-on-enter-vr.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("hide-on-enter-vr",{init:function(){var w=this;this.el.sceneEl.addEventListener("enter-vr",function(){w.el.sceneEl.is("vr-mode")&&(w.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){w.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/tracked-controls.js"),v=h.checkControllerPresentAndSetup,a=h.emitIfAxesChanged,f=h.onButtonEvent,m="hp-mixed-reality",l=A("./src/constants/index.js").AFRAME_CDN_ROOT,y=l+"controllers/hp/mixed-reality/",g={x:0,y:0,z:.06},d={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},p={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};W.exports.Component=u("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:p,init:function(){var C=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(S){f(S.detail.id,"down",C,C.data.hand)},this.onButtonUp=function(S){f(S.detail.id,"up",C,C.data.hand)},this.onButtonTouchEnd=function(S){f(S.detail.id,"touchend",C,C.data.hand)},this.onButtonTouchStart=function(S){f(S.detail.id,"touchstart",C,C.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var C=this.data;this.controllerIndex=C.hand==="right"?0:C.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var C=this.el;C.addEventListener("buttonchanged",this.onButtonChanged),C.addEventListener("buttondown",this.onButtonDown),C.addEventListener("buttonup",this.onButtonUp),C.addEventListener("touchstart",this.onButtonTouchStart),C.addEventListener("touchend",this.onButtonTouchEnd),C.addEventListener("axismove",this.onAxisMoved),C.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var C=this.el;C.removeEventListener("buttonchanged",this.onButtonChanged),C.removeEventListener("buttondown",this.onButtonDown),C.removeEventListener("buttonup",this.onButtonUp),C.removeEventListener("touchstart",this.onButtonTouchStart),C.removeEventListener("touchend",this.onButtonTouchEnd),C.removeEventListener("axismove",this.onAxisMoved),C.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var C=this.data;v(this,m,{index:this.controllerIndex,hand:C.hand})},injectTrackedControls:function(){var C=this.el,S=this.data;C.setAttribute("tracked-controls",{idPrefix:m,hand:S.hand,controller:this.controllerIndex,orientationOffset:S.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",y+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(C){var S=this.mapping[this.data.hand].buttons[C.detail.id],_;S&&(S==="trigger"&&(_=C.detail.state.value,console.log("analog value of trigger press: "+_)),this.el.emit(S+"changed",C.detail.state))},onModelLoaded:function(C){var S=C.detail.model;this.data.model&&(S.position.copy(g),S.rotation.copy(d),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new w.Vector3(0,0,0)}))},onAxisMoved:function(C){a(this,this.mapping.axes,C)}})},"./src/components/index.js":(W,$,A)=>{A("./src/components/animation.js"),A("./src/components/anchored.js"),A("./src/components/camera.js"),A("./src/components/cursor.js"),A("./src/components/geometry.js"),A("./src/components/generic-tracked-controller-controls.js"),A("./src/components/gltf-model.js"),A("./src/components/grabbable.js"),A("./src/components/hand-tracking-controls.js"),A("./src/components/hand-tracking-grab-controls.js"),A("./src/components/hand-controls.js"),A("./src/components/hide-on-enter-ar.js"),A("./src/components/hide-on-enter-vr.js"),A("./src/components/hp-mixed-reality-controls.js"),A("./src/components/layer.js"),A("./src/components/laser-controls.js"),A("./src/components/light.js"),A("./src/components/line.js"),A("./src/components/link.js"),A("./src/components/look-controls.js"),A("./src/components/magicleap-controls.js"),A("./src/components/material.js"),A("./src/components/obb-collider.js"),A("./src/components/obj-model.js"),A("./src/components/oculus-go-controls.js"),A("./src/components/oculus-touch-controls.js"),A("./src/components/pico-controls.js"),A("./src/components/position.js"),A("./src/components/raycaster.js"),A("./src/components/rotation.js"),A("./src/components/scale.js"),A("./src/components/shadow.js"),A("./src/components/sound.js"),A("./src/components/text.js"),A("./src/components/tracked-controls.js"),A("./src/components/tracked-controls-webvr.js"),A("./src/components/tracked-controls-webxr.js"),A("./src/components/visible.js"),A("./src/components/valve-index-controls.js"),A("./src/components/vive-controls.js"),A("./src/components/vive-focus-controls.js"),A("./src/components/wasd-controls.js"),A("./src/components/windows-motion-controls.js"),A("./src/components/scene/ar-hit-test.js"),A("./src/components/scene/background.js"),A("./src/components/scene/debug.js"),A("./src/components/scene/device-orientation-permission-ui.js"),A("./src/components/scene/embedded.js"),A("./src/components/scene/inspector.js"),A("./src/components/scene/fog.js"),A("./src/components/scene/keyboard-shortcuts.js"),A("./src/components/scene/pool.js"),A("./src/components/scene/real-world-meshing.js"),A("./src/components/scene/reflection.js"),A("./src/components/scene/screenshot.js"),A("./src/components/scene/stats.js"),A("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/index.js");u("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var h=this.config,v=this.data,a=this.el,f=this,m={hand:v.hand,model:v.model};a.setAttribute("hp-mixed-reality-controls",m),a.setAttribute("magicleap-controls",m),a.setAttribute("oculus-go-controls",m),a.setAttribute("oculus-touch-controls",m),a.setAttribute("pico-controls",m),a.setAttribute("valve-index-controls",m),a.setAttribute("vive-controls",m),a.setAttribute("vive-focus-controls",m),a.setAttribute("windows-motion-controls",m),a.setAttribute("generic-tracked-controller-controls",{hand:m.hand}),a.addEventListener("controllerconnected",l),a.addEventListener("controllerdisconnected",y),a.addEventListener("controllermodelready",function(g){l(g),f.modelReady=!0});function l(g){var d=h[g.detail.name];if(d){var p=w.extend({showLine:!0},d.raycaster||{});g.detail.rayOrigin&&(p.origin=g.detail.rayOrigin.origin,p.direction=g.detail.rayOrigin.direction,p.showLine=!0),g.detail.rayOrigin||!f.modelReady?a.setAttribute("raycaster",p):a.setAttribute("raycaster","showLine",!0),a.setAttribute("cursor",w.extend({fuse:!1},d.cursor))}}function y(g){var d=h[g.detail.name];d&&a.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"pico-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/index.js"),h=w.debug("components:layer:warn");W.exports.Component=u("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var a=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=a.createFramebuffer();var f=this.el.sceneEl.getAttribute("webxr"),m=f.requiredFeatures;m.indexOf("layers")===-1&&(m.push("layers"),this.el.sceneEl.setAttribute("webxr",f)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(a){this.data.src!==a.src&&this.updateSrc()},updateSrc:function(){var a=this.data.type;if(this.texture=void 0,a==="quad"){this.loadQuadImage();return}if(a==="monocubemap"||a==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var a,f=this.xrGLFactory,m=this.el.sceneEl.frame,l=this.data.src,y=this.data.type;this.visibilityChanged=!1,this.layer&&(y!=="monocubemap"&&y!=="stereocubemap"||(l.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,y==="monocubemap"?(a=f.getSubImage(this.layer,m),this.loadCubeMapImage(a.colorTexture,l,0)):(a=f.getSubImage(this.layer,m,"left"),this.loadCubeMapImage(a.colorTexture,l,0),a=f.getSubImage(this.layer,m,"right"),this.loadCubeMapImage(a.colorTexture,l,6))))},loadQuadImage:function(){var a=this.data.src,f=this;this.el.sceneEl.systems.material.loadTexture(a,{src:a},function(l){f.el.sceneEl.renderer.initTexture(l),f.texture=l,a.tagName==="VIDEO"&&setTimeout(function(){f.textureIsVideo=!0},1e3),f.layer&&(f.layer.height=f.data.height/2||f.texture.image.height/1e3,f.layer.width=f.data.width/2||f.texture.image.width/1e3,f.needsRedraw=!0),f.updateQuadPanel()})},preGenerateCubeMapTextures:function(a,f){this.data.type==="monocubemap"?this.generateCubeMapTextures(a,0,f):(this.generateCubeMapTextures(a,0,f),this.generateCubeMapTextures(a,6,f))},generateCubeMapTextures:function(a,f,m){for(var l=this.data,y=this.cubeFaceSize,g=Math.min(a.width,a.height),d=[],p,C,S=0;S<6;S++){var _=document.createElement("CANVAS");_.width=_.height=y;var L=_.getContext("2d");l.rotateCubemap&&(S===2||S===3)&&(L.save(),L.translate(y,y),L.rotate(Math.PI)),L.drawImage(a,(S+f)*g,0,g,g,0,0,y,y),L.restore(),m&&m(),d.push(_)}return l.rotateCubemap&&(p=d[0],C=d[1],d[0]=C,d[1]=p,p=d[4],C=d[5],d[4]=C,d[5]=p),m&&m(),d},loadCubeMapImage:function(a,f,m){var l=this.el.sceneEl.renderer.getContext(),y;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1),l.bindTexture(l.TEXTURE_CUBE_MAP,a),!f.complete||this.loadingScreen?y=this.loadingScreenImages:y=this.generateCubeMapTextures(f,m);var g=0;y.forEach(function(d,p){l.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,0,0,l.RGBA,l.UNSIGNED_BYTE,d),g=l.getError()}),g!==0&&console.log("renderingError, WebGL Error Code: "+g),l.bindTexture(l.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var a=this,f=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(m){a.visibilityChanged=m.session.visibilityState!=="hidden"},f==="quad"){this.initQuadLayer();return}if(f==="monocubemap"||f==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var a=this.el.sceneEl,f=a.renderer.getContext(),m=this.xrGLFactory=new XRWebGLBinding(a.xrSession,f);this.texture&&(this.layer=m.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),a.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var a=this.data.src,f=this.el.sceneEl,m=f.renderer.getContext(),l=m.getParameter(m.MAX_CUBE_MAP_TEXTURE_SIZE),y=this.cubeFaceSize=Math.min(l,Math.min(a.width,a.height)),g=this.xrGLFactory=new XRWebGLBinding(f.xrSession,m);this.layer=g.createCubeLayer({space:this.referenceSpace,viewPixelWidth:y,viewPixelHeight:y,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),f.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var a=this.cubeFaceSize,f=this.loadingScreenImages=[],m=0;m<6;m++){var l=document.createElement("CANVAS");l.width=l.height=a;var y=l.getContext("2d");l.width=l.height=a,y.fillStyle="black",y.fillRect(0,0,a,a),m!==2&&m!==3&&(y.translate(a,0),y.scale(-1,1),y.fillStyle="white",y.font="30px Arial",y.fillText("Loading",a/2,a/2)),f.push(l)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(a){this.layerEnabled=a,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var a=this.quadPanelEl;this.quadPanelEl||(a=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(a)),a.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),a.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var a=this.el.sceneEl,f=this.el.sceneEl.renderer.getContext(),m=this.xrGLFactory.getSubImage(this.layer,a.frame),l=a.renderer.properties.get(this.texture).__webglTexture,y=f.getParameter(f.FRAMEBUFFER_BINDING);f.viewport(m.viewport.x,m.viewport.y,m.viewport.width,m.viewport.height),f.bindFramebuffer(f.FRAMEBUFFER,this.frameBuffer),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,m.colorTexture,0),v(f,l,m,this.data.src),f.bindFramebuffer(f.FRAMEBUFFER,y)},updateTransform:function(){var a=this.el,f=this.position,m=this.quaternion;a.object3D.updateMatrixWorld(),f.setFromMatrixPosition(a.object3D.matrixWorld),m.setFromRotationMatrix(a.object3D.matrixWorld),this.layerEnabled||f.set(0,0,1e8),this.layer.transform=new XRRigidTransform(f,m)},onEnterVR:function(){var a=this.el.sceneEl,f=a.xrSession;if(!a.hasWebXR||!XRWebGLBinding||!f){h("The layer component requires WebXR and the layers API enabled");return}f.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(a){this.referenceSpace=a}});function v(a,f,m,l){var y=a.createFramebuffer(),g=m.viewport.x,d=m.viewport.y,p=m.viewport.x+m.viewport.width,C=m.viewport.y+m.viewport.height;l.tagName==="VIDEO"&&(a.bindTexture(a.TEXTURE_2D,f),a.texSubImage2D(a.TEXTURE_2D,0,0,0,l.width,l.height,a.RGB,a.UNSIGNED_BYTE,l)),a.bindFramebuffer(a.READ_FRAMEBUFFER,y),a.framebufferTexture2D(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,f,0),a.readBuffer(a.COLOR_ATTACHMENT0),a.blitFramebuffer(0,0,l.width,l.height,g,d,p,C,a.COLOR_BUFFER_BIT,a.NEAREST),a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.deleteFramebuffer(y)}},"./src/components/light.js":(W,$,A)=>{var u=A("./src/utils/index.js"),w=u.diff,h=A("./src/utils/debug.js"),v=A("./src/core/component.js").registerComponent,a=A("./src/lib/three.js"),f=A("./src/utils/math.js"),m=a.MathUtils.degToRad,l=h("components:light:warn"),y=new a.CubeTextureLoader,g={};W.exports.Component=v("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var d=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(d)},update:function(d){var p=this.data,C=w(p,d),S=this.light,_=this;if(S&&!("type"in C)){var L=!1;Object.keys(C).forEach(function(T){var N=p[T];switch(T){case"color":{S.color.set(N);break}case"groundColor":{S.groundColor.set(N);break}case"angle":{S.angle=m(N);break}case"target":{N===null?(p.type==="spot"||p.type==="directional")&&(S.target=_.defaultTarget):N.hasLoaded?_.onSetTarget(N,S):N.addEventListener("loaded",_.onSetTarget.bind(_,N,S));break}case"envMap":_.updateProbeMap(p,S);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":L||(_.updateShadow(),L=!0);break;case"shadowCameraAutomatic":p.shadowCameraAutomatic?_.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(p.shadowCameraAutomatic)):_.shadowCameraAutomaticEls=[];break;default:S[T]=N}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var d=new a.Box3,p=new a.Vector3,C=new a.Vector3,S=new a.Matrix4,_=new a.Sphere,L=new a.Vector3;return function(){if(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof a.OrthographicCamera&&this.shadowCameraAutomaticEls.length){var T=this.light.shadow.camera;T.getWorldDirection(p),T.getWorldPosition(C),S.copy(T.matrixWorld),S.invert(),T.near=1,T.left=1e5,T.right=-1e5,T.top=-1e5,T.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(N){d.setFromObject(N.object3D),d.getBoundingSphere(_);var F=f.distanceOfPointFromPlane(C,p,_.center),te=f.nearestPointInPlane(C,p,_.center,L),K=te.applyMatrix4(S);T.near=Math.min(-F-_.radius-1,T.near),T.left=Math.min(-_.radius+K.x,T.left),T.right=Math.max(_.radius+K.x,T.right),T.top=Math.max(_.radius+K.y,T.top),T.bottom=Math.min(-_.radius+K.y,T.bottom)}),T.updateProjectionMatrix()}}}(),setLight:function(d){var p=this.el,C=this.getLight(d);C&&(this.light&&p.removeObject3D("light"),this.light=C,this.light.el=p,p.setObject3D("light",this.light),(d.type==="spot"||d.type==="directional"||d.type==="hemisphere")&&p.getObject3D("light").translateY(-1),d.type==="spot"&&(p.setObject3D("light-target",this.defaultTarget),p.getObject3D("light-target").position.set(0,0,-1)),d.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(d.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var d=this.el,p=this.data,C=this.light;C.castShadow=p.castShadow;var S=d.getObject3D("cameraHelper");if(p.shadowCameraVisible&&!S?d.setObject3D("cameraHelper",new a.CameraHelper(C.shadow.camera)):!p.shadowCameraVisible&&S&&d.removeObject3D("cameraHelper"),!p.castShadow)return C;C.shadow.bias=p.shadowBias,C.shadow.radius=p.shadowRadius,C.shadow.mapSize.height=p.shadowMapHeight,C.shadow.mapSize.width=p.shadowMapWidth,C.shadow.camera.near=p.shadowCameraNear,C.shadow.camera.far=p.shadowCameraFar,C.shadow.camera instanceof a.OrthographicCamera?(C.shadow.camera.top=p.shadowCameraTop,C.shadow.camera.right=p.shadowCameraRight,C.shadow.camera.bottom=p.shadowCameraBottom,C.shadow.camera.left=p.shadowCameraLeft):C.shadow.camera.fov=p.shadowCameraFov,C.shadow.camera.updateProjectionMatrix(),S&&S.update()},getLight:function(d){var p=d.angle,C=new a.Color(d.color);C=C.getHex();var S=d.decay,_=d.distance,L=new a.Color(d.groundColor);L=L.getHex();var T=d.intensity,N=d.type,F=d.target,te=null;switch(N.toLowerCase()){case"ambient":return new a.AmbientLight(C,T);case"directional":return te=new a.DirectionalLight(C,T),this.defaultTarget=te.target,F&&(F.hasLoaded?this.onSetTarget(F,te):F.addEventListener("loaded",this.onSetTarget.bind(this,F,te))),te;case"hemisphere":return new a.HemisphereLight(C,L,T);case"point":return new a.PointLight(C,T,_,S);case"spot":return te=new a.SpotLight(C,T,_,m(p),d.penumbra,S),this.defaultTarget=te.target,F&&(F.hasLoaded?this.onSetTarget(F,te):F.addEventListener("loaded",this.onSetTarget.bind(this,F,te))),te;case"probe":return te=new a.LightProbe,this.updateProbeMap(d,te),te;default:l("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",N)}},updateProbeMap:function(d,p){d.envMap||p.copy(new a.LightProbe),g[d.envMap]instanceof window.Promise&&g[d.envMap].then(function(C){p.copy(C)}),g[d.envMap]instanceof a.LightProbe&&p.copy(g[d.envMap]),g[d.envMap]=new window.Promise(function(C){u.srcLoader.validateCubemapSrc(d.envMap,function(_){y.load(_,function(L){var T=a.LightProbeGenerator.fromCubeTexture(L);g[d.envMap]=T,p.copy(T)})})})},onSetTarget:function(d,p){p.target=d.object3D},remove:function(){var d=this.el;d.removeObject3D("light"),d.getObject3D("cameraHelper")&&d.removeObject3D("cameraHelper")}})},"./src/components/line.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var h=this.data,v,a;a=this.material=new THREE.LineBasicMaterial({color:h.color,opacity:h.opacity,transparent:h.opacity<1,visible:h.visible}),v=this.geometry=new THREE.BufferGeometry,v.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(v,a),this.el.setObject3D(this.attrName,this.line)},update:function(h){var v=this.data,a=this.geometry,f=!1,m=this.material,l=a.attributes.position.array;w(v.start,h.start)||(l[0]=v.start.x,l[1]=v.start.y,l[2]=v.start.z,f=!0),w(v.end,h.end)||(l[3]=v.end.x,l[4]=v.end.y,l[5]=v.end.z,f=!0),f&&(a.attributes.position.needsUpdate=!0,a.computeBoundingSphere()),m.color.setStyle(v.color),m.opacity=v.opacity,m.transparent=v.opacity<1,m.visible=v.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function w(h,v){return!h||!v?!1:h.x===v.x&&h.y===v.y&&h.z===v.z}},"./src/components/link.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/core/shader.js").registerShader,h=A("./src/lib/three.js");W.exports.Component=u("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new h.Quaternion,this.hiddenEls=[]},update:function(v){var a=this.data,f=this.el,m,l;a.visualAspectEnabled&&(this.initVisualAspect(),m=a.highlighted?a.highlightedColor:a.backgroundColor,l=a.highlighted?a.highlightedColor:a.borderColor,f.setAttribute("material","backgroundColor",m),f.setAttribute("material","strokeColor",l),a.on!==v.on&&this.updateEventListener(),v.peekMode!==void 0&&a.peekMode!==v.peekMode&&this.updatePeekMode(),!(!a.image||v.image===a.image)&&f.setAttribute("material","pano",typeof a.image=="string"?a.image:a.image.src))},updatePeekMode:function(){var v=this.el,a=this.sphereEl;this.data.peekMode?(this.hideAll(),v.getObject3D("mesh").visible=!1,a.setAttribute("visible",!0)):(this.showAll(),v.getObject3D("mesh").visible=!0,a.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var v=this.el;v.isPlaying&&(this.removeEventListener(),v.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var v=this.data.on;v&&this.el.removeEventListener(v,this.navigate)},initVisualAspect:function(){var v=this.el,a,f,m;!this.data.visualAspectEnabled||this.visualAspectInitialized||(m=this.textEl=this.textEl||document.createElement("a-entity"),f=this.sphereEl=this.sphereEl||document.createElement("a-entity"),a=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),v.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),v.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),m.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),m.setAttribute("position","0 1.5 0"),v.appendChild(m),a.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),a.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),a.setAttribute("rotation","0 180 0"),a.setAttribute("position","0 0 0"),a.setAttribute("visible",!1),v.appendChild(a),f.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),f.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),f.setAttribute("visible",!1),v.appendChild(f),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var v=new h.Vector3,a=new h.Vector3,f=new h.Quaternion,m=new h.Vector3;return function(){var l=this.el,y=l.object3D,g=l.sceneEl.camera,d,p,C=this.textEl;if(this.data.visualAspectEnabled)if(y.updateMatrixWorld(),g.parent.updateMatrixWorld(),g.updateMatrixWorld(),y.matrix.decompose(a,f,m),a.setFromMatrixPosition(y.matrixWorld),v.setFromMatrixPosition(g.matrixWorld),p=a.distanceTo(v),p>20)this.previousQuaternion||(this.quaternionClone.copy(f),this.previousQuaternion=this.quaternionClone),y.lookAt(v);else{if(d=this.calculateCameraPortalOrientation(),p<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;C.setAttribute("text","width",1.5),d<=0?(C.setAttribute("position","0 0 0.75"),C.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(C.setAttribute("position","0 0 -0.75"),C.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),l.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=d}else d<=0?C.setAttribute("rotation","0 180 0"):C.setAttribute("rotation","0 0 0"),C.setAttribute("text","width",5),C.setAttribute("position","0 1.5 0"),l.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(y.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var v=this.el,a=this.hiddenEls,f=this;a.length>0||v.sceneEl.object3D.traverse(function(m){m&&m.el&&m.el.hasAttribute("link-controls")||!m.el||m===v.sceneEl.object3D||m.el===v||m.el===f.sphereEl||m.el===v.sceneEl.cameraEl||m.el.getAttribute("visible")===!1||m.el===f.textEl||m.el===f.semiSphereEl||(m.el.setAttribute("visible",!1),a.push(m.el))})},showAll:function(){this.hiddenEls.forEach(function(v){v.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var v=new h.Matrix4,a=new h.Vector3,f=new h.Vector3(0,0,1),m=new h.Vector3(0,0,0);return function(){var l=this.el,y=l.sceneEl.camera;return a.set(0,0,0),f.set(0,0,1),m.set(0,0,0),l.object3D.matrixWorld.extractRotation(v),f.applyMatrix4(v),l.object3D.updateMatrixWorld(),l.object3D.localToWorld(m),y.parent.parent.updateMatrixWorld(),y.parent.updateMatrixWorld(),y.updateMatrixWorld(),y.localToWorld(a),a.sub(m).normalize(),f.normalize(),Math.sign(f.dot(a))}}(),remove:function(){this.removeEventListener()}}),w("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/index.js"),v=Math.PI/2;W.exports.Component=u("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new w.Vector3,this.hmdQuaternion=new w.Quaternion,this.magicWindowAbsoluteEuler=new w.Euler,this.magicWindowDeltaEuler=new w.Euler,this.position=new w.Vector3,this.magicWindowObject=new w.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new w.Vector3,rotation:new w.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var a,f=this.data;(h.device.isMobile()||h.device.isMobileDeviceRequestingDesktopSite())&&(a=this.magicWindowControls=new w.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(a.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?a.enabled=f.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){a.enabled=f.magicWindowTrackingEnabled})))},update:function(a){var f=this.data;f.enabled!==a.enabled&&this.updateGrabCursor(f.enabled),a&&!f.magicWindowTrackingEnabled&&a.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=f.magicWindowTrackingEnabled),a&&!f.pointerLockEnabled!==a.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(a){var f=this.data;f.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockError=this.onPointerLockError.bind(this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new w.Object3D,this.yawObject=new w.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var a=this.el.sceneEl,f=a.canvas;if(!f){a.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}f.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),f.addEventListener("touchstart",this.onTouchStart,{passive:!0}),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),window.addEventListener("touchend",this.onTouchEnd,{passive:!0}),a.addEventListener("enter-vr",this.onEnterVR),a.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var a=this.el.sceneEl,f=a&&a.canvas;f&&(f.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),f.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),a.removeEventListener("enter-vr",this.onEnterVR),a.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var a=this.el.object3D,f=this.pitchObject,m=this.yawObject,l=this.el.sceneEl;(l.is("vr-mode")||l.is("ar-mode"))&&l.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),a.rotation.x=this.magicWindowDeltaEuler.x+f.rotation.x,a.rotation.y=this.magicWindowDeltaEuler.y+m.rotation.y,a.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var a=this.magicWindowAbsoluteEuler,f=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),a.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&a.y!==0&&(this.previousMagicWindowYaw=a.y),this.previousMagicWindowYaw&&(f.x=a.x,f.y+=a.y-this.previousMagicWindowYaw,f.z=a.z,this.previousMagicWindowYaw=a.y))},onMouseMove:function(a){var f,m,l,y=this.pitchObject,g=this.previousMouseEvent,d=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(m=a.movementX||a.mozMovementX||0,l=a.movementY||a.mozMovementY||0):(m=a.screenX-g.screenX,l=a.screenY-g.screenY),this.previousMouseEvent.screenX=a.screenX,this.previousMouseEvent.screenY=a.screenY,f=this.data.reverseMouseDrag?1:-1,d.rotation.y+=m*.002*f,y.rotation.x+=l*.002*f,y.rotation.x=Math.max(-v,Math.min(v,y.rotation.x)))},onMouseDown:function(a){var f=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(f.is("vr-mode")||f.is("ar-mode"))&&f.checkHeadsetConnected())&&a.button===0){var m=f&&f.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=a.screenX,this.previousMouseEvent.screenY=a.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(m.requestPointerLock?m.requestPointerLock():m.mozRequestPointerLock&&m.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(a){a.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:a.touches[0].pageX,y:a.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(a){var f,m=this.el.sceneEl.canvas,l,y=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(l=2*Math.PI*(a.touches[0].pageX-this.touchStart.x)/m.clientWidth,f=this.data.reverseTouchDrag?1:-1,y.rotation.y-=l*.5*f,this.touchStart={x:a.touches[0].pageX,y:a.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var a=this.el.sceneEl;a.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),a.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(a){var f=this.el.sceneEl;function m(){f.canvas.classList.add("a-grab-cursor")}function l(){f.canvas.classList.remove("a-grab-cursor")}if(!f.canvas){a?f.addEventListener("render-target-loaded",m):f.addEventListener("render-target-loaded",l);return}if(a){m();return}l()},saveCameraPose:function(){var a=this.el;this.savedPose.position.copy(a.object3D.position),this.savedPose.rotation.copy(a.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var a=this.el,f=this.savedPose;this.hasSavedPose&&(a.object3D.position.copy(f.position),a.object3D.rotation.copy(f.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/tracked-controls.js"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,a=w.onButtonEvent,f="magicleap",m="-one",l=f+m,y=A("./src/constants/index.js").AFRAME_CDN_ROOT,g=y+"controllers/magicleap/magicleap-one-controller.glb",d={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};W.exports.Component=u("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:d,init:function(){var p=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(C){a(C.detail.id,"down",p)},this.onButtonUp=function(C){a(C.detail.id,"up",p)},this.onButtonTouchEnd=function(C){a(C.detail.id,"touchend",p)},this.onButtonTouchStart=function(C){a(C.detail.id,"touchstart",p)},this.previousButtonValues={},this.bindMethods()},update:function(){var p=this.data;this.controllerIndex=p.hand==="right"?0:p.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var p=this.el;p.addEventListener("buttonchanged",this.onButtonChanged),p.addEventListener("buttondown",this.onButtonDown),p.addEventListener("buttonup",this.onButtonUp),p.addEventListener("touchstart",this.onButtonTouchStart),p.addEventListener("touchend",this.onButtonTouchEnd),p.addEventListener("axismove",this.onAxisMoved),p.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var p=this.el;p.removeEventListener("buttonchanged",this.onButtonChanged),p.removeEventListener("buttondown",this.onButtonDown),p.removeEventListener("buttonup",this.onButtonUp),p.removeEventListener("touchstart",this.onButtonTouchStart),p.removeEventListener("touchend",this.onButtonTouchEnd),p.removeEventListener("axismove",this.onAxisMoved),p.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var p=this.data;h(this,l,{index:this.controllerIndex,hand:p.hand})},injectTrackedControls:function(){var p=this.el,C=this.data;p.setAttribute("tracked-controls",{idPrefix:l,hand:C.hand,controller:this.controllerIndex,orientationOffset:C.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",g)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(p){var C=this.mapping.buttons[p.detail.id],S;C&&(C==="trigger"&&(S=p.detail.state.value,console.log("analog value of trigger press: "+S)),this.el.emit(C+"changed",p.detail.state))},onModelLoaded:function(p){var C=p.detail.model;C.scale.set(.01,.01,.01)},onAxisMoved:function(p){v(this,this.mapping.axes,p)},updateModel:function(p,C){},setButtonColor:function(p,C){}})},"./src/components/material.js":(W,$,A)=>{var u=A("./src/utils/index.js"),w=A("./src/core/component.js"),h=A("./src/lib/three.js"),v=A("./src/core/shader.js"),a=u.debug("components:material:error"),f=w.registerComponent,m=v.shaders,l=v.shaderNames;W.exports.Component=f("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:l,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(p){var C=this.data;(!this.shader||C.shader!==p.shader)&&this.updateShader(C.shader),this.shader.update(this.data),this.updateMaterial(p)},updateSchema:function(p){var C,S,_,L;S=p&&p.shader,C=this.oldData&&this.oldData.shader,L=S||C,_=m[L]&&m[L].schema,_||a("Unknown shader schema "+L),!(C&&S===C)&&(this.extendSchema(_),this.updateBehavior())},updateBehavior:function(){var p,C=this.el.sceneEl,S=this.schema,_=this,L;function T(N,F){var te;for(te in L)L[te]=N;_.shader.update(L)}this.tick=void 0,L={};for(p in S)S[p].type==="time"&&(this.tick=T,L[p]=!0);C&&(this.tick?C.addBehavior(this):C.removeBehavior(this))},updateShader:function(p){var C=this.data,S=m[p]&&m[p].Shader,_;if(!S)throw new Error("Unknown shader "+p);_=this.shader=new S,_.el=this.el,_.init(C),this.setMaterial(_.material),this.updateSchema(C)},updateMaterial:function(p){var C=this.data,S=this.material,_;S.alphaTest=C.alphaTest,S.depthTest=C.depthTest!==!1,S.depthWrite=C.depthWrite!==!1,S.opacity=C.opacity,S.flatShading=C.flatShading,S.side=y(C.side),S.transparent=C.transparent!==!1||C.opacity<1,S.vertexColors=C.vertexColorsEnabled,S.visible=C.visible,S.blending=g(C.blending),S.dithering=C.dithering;for(_ in p)break;_&&(p.alphaTest!==C.alphaTest||p.side!==C.side||p.vertexColorsEnabled!==C.vertexColorsEnabled)&&(S.needsUpdate=!0)},remove:function(){var p=new h.MeshBasicMaterial,C=this.material,S=this.el.getObject3D("mesh");S&&(S.material=p),d(C,this.system)},setMaterial:function(p){var C=this.el,S,_=this.system;this.material&&d(this.material,_),this.material=p,_.registerMaterial(p),S=C.getObject3D("mesh"),S?S.material=p:C.addEventListener("object3dset",function L(T){T.detail.type!=="mesh"||T.target!==C||(C.getObject3D("mesh").material=p,C.removeEventListener("object3dset",L))})}});function y(p){switch(p){case"back":return h.BackSide;case"double":return h.DoubleSide;default:return h.FrontSide}}function g(p){switch(p){case"none":return h.NoBlending;case"additive":return h.AdditiveBlending;case"subtractive":return h.SubtractiveBlending;case"multiply":return h.MultiplyBlending;default:return h.NormalBlending}}function d(p,C){p.dispose(),C.unregisterMaterial(p),Object.keys(p).filter(function(S){return p[S]&&p[S].isTexture}).forEach(function(S){p[S].dispose()})}},"./src/components/obb-collider.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js");u("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new w.Vector3().copy(this.el.object3D.scale),this.auxEuler=new w.Euler,this.boundingBox=new w.Box3,this.boundingBoxSize=new w.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var h=this.el,v=h.components["gltf-model"]&&h.components["gltf-model"].model,a,f;v&&(this.el.removeObject3D("mesh"),a=new w.Box3().setFromObject(v),f=a.getCenter(new w.Vector3),v.position.x+=v.position.x-f.x,v.position.y+=v.position.y-f.y,v.position.z+=v.position.z-f.z,this.el.setObject3D("mesh",v))},updateCollider:function(){var h=this.el,v=this.boundingBoxSize,a=this.aabb=this.aabb||new w.OBB;if(this.obb=this.obb||new w.OBB,!h.hasLoaded){h.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),a.halfSize.copy(v).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var h=this.renderColliderMesh,v=this.boundingBoxSize;if(!h){this.initColliderMesh();return}h.geometry.dispose(),h.geometry=new w.BoxGeometry(v.x,v.y,v.z)},hideCollider:function(){this.renderColliderMesh&&(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var h,v,a;h=this.boundingBoxSize,v=this.renderColliderGeometry=new w.BoxGeometry(h.x,h.y,h.z),a=this.renderColliderMesh=new w.Mesh(v,new w.MeshLambertMaterial({color:65280,side:w.DoubleSide})),a.matrixAutoUpdate=!1,a.matrixWorldAutoUpdate=!1,a.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(a)},updateBoundingBox:function(){var h=new w.Vector3,v=new w.Vector3,a=new w.Quaternion,f=new w.Quaternion,m=new w.Matrix4;return function(){var l=this.auxEuler,y=this.boundingBox,g=this.data.size,d=this.trackedObject3D||this.el.object3D,p=this.boundingBoxSize,C=this.data.minimumColliderDimension;if(g){this.boundingBoxSize.x=g,this.boundingBoxSize.y=g,this.boundingBoxSize.z=g;return}l.copy(d.rotation),d.rotation.set(0,0,0),d.parent.matrixWorld.decompose(h,a,v),m.compose(h,f,v),d.parent.matrixWorld.copy(m),y.setFromObject(d,!0),y.getSize(p),p.x=p.x<C?C:p.x,p.y=p.y<C?C:p.y,p.z=p.z<C?C:p.z,d.parent.matrixWorld.compose(h,a,v),this.el.object3D.rotation.copy(l)}}(),checkTrackedObject:function(){var h=this.trackedObject3DPath,v;if(h&&h.length&&!this.trackedObject3D){v=this.el;for(var a=0;a<h.length&&(v=v[h[a]],!!v);a++);v&&(this.trackedObject3D=v,this.updateCollider())}return this.trackedObject3D},tick:function(){var h=new w.Vector3,v=new w.Vector3,a=new w.Quaternion,f=new w.Matrix4;return function(){var m=this.obb,l=this.renderColliderMesh,y=this.checkTrackedObject()||this.el.object3D;y&&(y.updateMatrix(),y.updateMatrixWorld(!0),y.matrixWorld.decompose(h,a,v),(Math.abs(v.x-this.previousScale.x)>1e-4||Math.abs(v.y-this.previousScale.y)>1e-4||Math.abs(v.z-this.previousScale.z)>1e-4)&&this.updateCollider(),this.previousScale.copy(v),v.set(1,1,1),f.compose(h,a,v),l&&l.matrixWorld.copy(f),m.copy(this.aabb),m.applyMatrix4(f))}}()})},"./src/components/obj-model.js":(W,$,A)=>{var u=A("./src/utils/debug.js"),w=A("./src/core/component.js").registerComponent,h=A("./src/lib/three.js"),v=u("components:obj-model:warn");W.exports.Component=w("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var a=this;this.model=null,this.objLoader=new h.OBJLoader,this.mtlLoader=new h.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(f){a.model&&f.detail.name==="material"&&a.applyMaterial()})},update:function(){var a=this.data;a.obj&&(this.resetMesh(),this.loadObj(a.obj,a.mtl))},remove:function(){this.resetMesh()},resetMesh:function(){this.model&&this.el.removeObject3D("mesh")},loadObj:function(a,f){var m=this,l=this.el,y=this.mtlLoader,g=this.objLoader,d=this.el.sceneEl.systems.renderer,p=f.substr(0,f.lastIndexOf("/")+1);if(f){l.hasAttribute("material")&&v("Material component properties are ignored when a .MTL is provided"),y.setResourcePath(p),y.load(f,function(C){C.preload(),g.setMaterials(C),g.load(a,function(S){m.model=S,m.model.traverse(function(_){if(_.isMesh){var L=_.material;L.map&&d.applyColorCorrection(L.map),L.emissiveMap&&d.applyColorCorrection(L.emissiveMap)}}),l.setObject3D("mesh",S),l.emit("model-loaded",{format:"obj",model:S})})});return}g.load(a,function(S){m.model=S,m.applyMaterial(),l.setObject3D("mesh",S),l.emit("model-loaded",{format:"obj",model:S})})},applyMaterial:function(){var a=this.el.components.material;a&&this.model.traverse(function(f){f instanceof h.Mesh&&(f.material=a.material)})}})},"./src/components/oculus-go-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/tracked-controls.js"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,a=w.onButtonEvent,f=A("./src/utils/index.js").device.isWebXRAvailable,m="oculus-go",l="Oculus Go",y=A("./src/constants/index.js").AFRAME_CDN_ROOT,g=y+"controllers/oculus/go/oculus-go-controller.gltf",d=f?m:l,p={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},C={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},S=f?C:p;W.exports.Component=u("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:S,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var _=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(L){a(L.detail.id,"down",_)},this.onButtonUp=function(L){a(L.detail.id,"up",_)},this.onButtonTouchStart=function(L){a(L.detail.id,"touchstart",_)},this.onButtonTouchEnd=function(L){a(L.detail.id,"touchend",_)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var _=this.el;_.addEventListener("buttonchanged",this.onButtonChanged),_.addEventListener("buttondown",this.onButtonDown),_.addEventListener("buttonup",this.onButtonUp),_.addEventListener("touchstart",this.onButtonTouchStart),_.addEventListener("touchend",this.onButtonTouchEnd),_.addEventListener("model-loaded",this.onModelLoaded),_.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var _=this.el;_.removeEventListener("buttonchanged",this.onButtonChanged),_.removeEventListener("buttondown",this.onButtonDown),_.removeEventListener("buttonup",this.onButtonUp),_.removeEventListener("touchstart",this.onButtonTouchStart),_.removeEventListener("touchend",this.onButtonTouchEnd),_.removeEventListener("model-loaded",this.onModelLoaded),_.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){h(this,d,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var _=this.el,L=this.data;_.setAttribute("tracked-controls",{armModel:L.armModel,hand:L.hand,idPrefix:d,orientationOffset:L.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",g)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(_){var L=_.detail.model,T;_.target!==this.el||!this.data.model||(T=this.buttonMeshes={},T.trigger=L.getObjectByName("oculus_go_button_trigger"),T.trackpad=L.getObjectByName("oculus_go_touchpad"),T.touchpad=L.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(_){var L=this.mapping.buttons[_.detail.id];L&&this.el.emit(L+"changed",_.detail.state)},onAxisMoved:function(_){v(this,this.mapping.axes,_)},updateModel:function(_,L){this.data.model&&this.updateButtonModel(_,L)},updateButtonModel:function(_,L){var T=this.buttonMeshes;if(!(!T||!T[_])){var N,F;switch(L){case"down":N=this.data.buttonHighlightColor;break;case"touchstart":N=this.data.buttonTouchedColor;break;default:N=this.data.buttonColor}F=T[_],F.material.color.set(N)}}})},"./src/components/oculus-touch-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/tracked-controls.js"),v=h.checkControllerPresentAndSetup,a=h.emitIfAxesChanged,f=h.onButtonEvent,m=A("./src/utils/index.js").device.isWebXRAvailable,l="oculus-touch",y="Oculus Touch",g=m?l:y,d=A("./src/constants/index.js").AFRAME_CDN_ROOT,p=d+"controllers/oculus/oculus-touch-controller-",C=d+"controllers/meta/",S={left:{modelUrl:p+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new w.Vector3(-.005,.003,-.055),modelPivotRotation:new w.Euler(0,0,0)},right:{modelUrl:p+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new w.Vector3(.005,.003,-.055),modelPivotRotation:new w.Euler(0,0,0)}},_={left:{modelUrl:p+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new w.Vector3(-.005,.036,-.037),modelPivotRotation:new w.Euler(Math.PI/4.5,0,0)},right:{modelUrl:p+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new w.Vector3(.005,.036,-.037),modelPivotRotation:new w.Euler(Math.PI/4.5,0,0)}},L=m?_:S,T="oculus-touch",N={"oculus-touch":L,"oculus-touch-v2":{left:{modelUrl:p+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new w.Vector3(0,-.007,-.021),modelPivotRotation:new w.Euler(-Math.PI/4,0,0)},right:{modelUrl:p+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new w.Vector3(0,-.007,-.021),modelPivotRotation:new w.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:p+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new w.Vector3(0,0,0),modelPivotRotation:new w.Euler(0,0,0)},right:{modelUrl:p+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new w.Vector3(0,0,0),modelPivotRotation:new w.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:C+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new w.Vector3(0,0,0),modelPivotRotation:new w.Euler(0,0,0)},right:{modelUrl:C+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new w.Vector3(0,0,0),modelPivotRotation:new w.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:C+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new w.Vector3(0,0,0),modelPivotRotation:new w.Euler(0,0,0)},right:{modelUrl:C+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new w.Vector3(0,0,0),modelPivotRotation:new w.Euler(0,0,0)}}},F={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},te={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},K=m?te:F;W.exports.Component=u("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},after:["tracked-controls"],mapping:K,bindMethods:function(){this.onButtonChanged=this.onButtonChanged.bind(this),this.onThumbstickMoved=this.onThumbstickMoved.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var ne=this;this.onButtonDown=function(re){f(re.detail.id,"down",ne,ne.data.hand)},this.onButtonUp=function(re){f(re.detail.id,"up",ne,ne.data.hand)},this.onButtonTouchStart=function(re){f(re.detail.id,"touchstart",ne,ne.data.hand)},this.onButtonTouchEnd=function(re){f(re.detail.id,"touchend",ne,ne.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new w.Euler},addEventListeners:function(){var ne=this.el;ne.addEventListener("buttonchanged",this.onButtonChanged),ne.addEventListener("buttondown",this.onButtonDown),ne.addEventListener("buttonup",this.onButtonUp),ne.addEventListener("touchstart",this.onButtonTouchStart),ne.addEventListener("touchend",this.onButtonTouchEnd),ne.addEventListener("axismove",this.onAxisMoved),ne.addEventListener("model-loaded",this.onModelLoaded),ne.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var ne=this.el;ne.removeEventListener("buttonchanged",this.onButtonChanged),ne.removeEventListener("buttondown",this.onButtonDown),ne.removeEventListener("buttonup",this.onButtonUp),ne.removeEventListener("touchstart",this.onButtonTouchStart),ne.removeEventListener("touchend",this.onButtonTouchEnd),ne.removeEventListener("axismove",this.onAxisMoved),ne.removeEventListener("model-loaded",this.onModelLoaded),ne.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,g,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(ne){var re=this.data,Y;if(re.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=N[re.controllerType]||N[T],re.controllerType==="auto"){var k=this.el.sceneEl.systems["tracked-controls-webvr"];if(k&&k.vrDisplay){var oe=k.vrDisplay.displayName;/^Oculus Quest$/.test(oe)&&(this.displayModel=N["oculus-touch-v2"])}else{Y=T;for(var ae=Object.keys(N),Ae=0;Ae<ne.profiles.length;Ae++)if(ae.indexOf(ne.profiles[Ae])!==-1){Y=ne.profiles[Ae];break}this.displayModel=N[Y]}}var b=this.displayModel[re.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===N["oculus-touch-v3"]||this.displayModel===N["meta-quest-touch-pro"]||this.displayModel===N["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",b)}},injectTrackedControls:function(ne){var re=this.data,Y=l,k=re.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",oe=m?Y:k;this.el.setAttribute("tracked-controls",{id:oe,hand:re.hand,orientationOffset:re.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel(ne)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(ne){var re=this.mapping[this.data.hand].buttons[ne.detail.id];if(re){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(ne);else{var Y=this.buttonMeshes,k;(re==="trigger"||re==="grip")&&(k=ne.detail.state.value),Y&&(re==="trigger"&&Y.trigger&&(Y.trigger.rotation.x=this.originalXRotationTrigger-k*(Math.PI/26)),re==="grip"&&Y.grip&&(k*=this.data.hand==="left"?-1:1,Y.grip.position.x=this.originalXPositionGrip+k*.004))}this.el.emit(re+"changed",ne.detail.state)}},onButtonChangedV3orPROorPlus:function(ne){var re=this.mapping[this.data.hand].buttons[ne.detail.id],Y=this.buttonObjects,k;!Y||!Y[re]||(k=ne.detail.state.value,Y[re].quaternion.slerpQuaternions(this.buttonRanges[re].min.quaternion,this.buttonRanges[re].max.quaternion,k),Y[re].position.lerpVectors(this.buttonRanges[re].min.position,this.buttonRanges[re].max.position,k))},onModelLoaded:function(ne){if(!(ne.target!==this.el||!this.data.model)){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(ne);else{var re=this.controllerObject3D=ne.detail.model,Y;Y=this.buttonMeshes={},Y.grip=re.getObjectByName("buttonHand"),this.originalXPositionGrip=Y.grip&&Y.grip.position.x,Y.trigger=re.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=Y.trigger&&Y.trigger.rotation.x,Y.thumbstick=re.getObjectByName("stick"),Y.xbutton=re.getObjectByName("buttonX"),Y.abutton=re.getObjectByName("buttonA"),Y.ybutton=re.getObjectByName("buttonY"),Y.bbutton=re.getObjectByName("buttonB")}for(var k in this.buttonMeshes)this.buttonMeshes[k]&&se(this.buttonMeshes[k]);this.applyOffset(ne.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function(ne){ne.position.copy(this.displayModel[this.data.hand].modelPivotOffset),ne.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(ne){var re=this.controllerObject3D=ne.detail.model,Y=this.buttonObjects={},k=this.buttonMeshes={},oe=this.buttonRanges={};k.grip=re.getObjectByName("squeeze"),Y.grip=re.getObjectByName("xr_standard_squeeze_pressed_value"),oe.grip={min:re.getObjectByName("xr_standard_squeeze_pressed_min"),max:re.getObjectByName("xr_standard_squeeze_pressed_max")},Y.grip.minX=Y.grip.position.x,k.thumbstick=re.getObjectByName("thumbstick"),Y.thumbstick=re.getObjectByName("xr_standard_thumbstick_pressed_value"),oe.thumbstick={min:re.getObjectByName("xr_standard_thumbstick_pressed_min"),max:re.getObjectByName("xr_standard_thumbstick_pressed_max")},Y.thumbstickXAxis=re.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),oe.thumbstickXAxis={min:re.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:re.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},Y.thumbstickYAxis=re.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),oe.thumbstickYAxis={min:re.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:re.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},k.trigger=re.getObjectByName("trigger"),Y.trigger=re.getObjectByName("xr_standard_trigger_pressed_value"),oe.trigger={min:re.getObjectByName("xr_standard_trigger_pressed_min"),max:re.getObjectByName("xr_standard_trigger_pressed_max")},oe.trigger.diff={x:Math.abs(oe.trigger.max.rotation.x)-Math.abs(oe.trigger.min.rotation.x),y:Math.abs(oe.trigger.max.rotation.y)-Math.abs(oe.trigger.min.rotation.y),z:Math.abs(oe.trigger.max.rotation.z)-Math.abs(oe.trigger.min.rotation.z)};var ae=this.data.hand==="left"?"x":"a",Ae=this.data.hand==="left"?"y":"b",b=ae+"button",I=Ae+"button";k[b]=re.getObjectByName(ae+"_button"),Y[b]=re.getObjectByName(ae+"_button_pressed_value"),oe[b]={min:re.getObjectByName(ae+"_button_pressed_min"),max:re.getObjectByName(ae+"_button_pressed_max")},k[I]=re.getObjectByName(Ae+"_button"),Y[I]=re.getObjectByName(Ae+"_button_pressed_value"),oe[I]={min:re.getObjectByName(Ae+"_button_pressed_min"),max:re.getObjectByName(Ae+"_button_pressed_max")}},onAxisMoved:function(ne){a(this,this.mapping[this.data.hand].axes,ne)},onThumbstickMoved:function(ne){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus(ne);return}for(var re in ne.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[re]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[re]]-Math.PI/8*ne.detail[re]*(re==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(ne){var re=(ne.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,re);var Y=(ne.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,Y)},updateModel:function(ne,re){this.data.model&&this.updateButtonModel(ne,re)},updateButtonModel:function(ne,re){var Y=this.buttonMeshes,k,oe;Y&&Y[ne]&&(oe=re==="up"||re==="touchend"?Y[ne].originalColor||this.data.buttonColor:re==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,k=Y[ne],k.material.color.set(oe))}});function se(ne){ne.traverse(function(re){var Y;re.type==="Mesh"&&(Y=re.material.clone(),ne.originalColor=re.material.color,re.material.dispose(),re.material=Y)})}},"./src/components/pico-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/tracked-controls.js"),v=h.checkControllerPresentAndSetup,a=h.emitIfAxesChanged,f=h.onButtonEvent,m="pico-4",l=A("./src/constants/index.js").AFRAME_CDN_ROOT,y=l+"controllers/pico/pico4/",g={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};W.exports.Component=u("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:g,init:function(){var d=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(p){f(p.detail.id,"down",d,d.data.hand)},this.onButtonUp=function(p){f(p.detail.id,"up",d,d.data.hand)},this.onButtonTouchEnd=function(p){f(p.detail.id,"touchend",d,d.data.hand)},this.onButtonTouchStart=function(p){f(p.detail.id,"touchstart",d,d.data.hand)},this.bindMethods()},update:function(){var d=this.data;this.controllerIndex=d.hand==="right"?0:d.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var d=this.el;d.addEventListener("buttonchanged",this.onButtonChanged),d.addEventListener("buttondown",this.onButtonDown),d.addEventListener("buttonup",this.onButtonUp),d.addEventListener("touchstart",this.onButtonTouchStart),d.addEventListener("touchend",this.onButtonTouchEnd),d.addEventListener("axismove",this.onAxisMoved),d.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var d=this.el;d.removeEventListener("buttonchanged",this.onButtonChanged),d.removeEventListener("buttondown",this.onButtonDown),d.removeEventListener("buttonup",this.onButtonUp),d.removeEventListener("touchstart",this.onButtonTouchStart),d.removeEventListener("touchend",this.onButtonTouchEnd),d.removeEventListener("axismove",this.onAxisMoved),d.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var d=this.data;v(this,m,{index:this.controllerIndex,hand:d.hand})},injectTrackedControls:function(){var d=this.el,p=this.data;d.setAttribute("tracked-controls",{idPrefix:m,hand:p.hand,controller:this.controllerIndex,orientationOffset:p.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",y+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(d){var p=this.mapping[this.data.hand].buttons[d.detail.id],C;p&&(p==="trigger"&&(C=d.detail.state.value,console.log("analog value of trigger press: "+C)),this.el.emit(p+"changed",d.detail.state))},onModelLoaded:function(d){d.target!==this.el||!this.data.model||this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new w.Vector3(0,0,0)})},onAxisMoved:function(d){a(this,this.mapping.axes,d)}})},"./src/components/position.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("position",{schema:{type:"vec3"},update:function(){var w=this.el.object3D,h=this.data;w.position.set(h.x,h.y,h.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/index.js"),v=h.debug("components:raycaster:warn"),a=/^[\w\s-.,[\]#]*$/,f={childList:!0,attributes:!0,subtree:!0},m={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};W.exports.Component=u("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new w.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new w.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new w.Vector3,this.otherLineEndVec3=new w.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(y){var g=this.data,d=this.el,p=this.raycaster;p.far=g.far,p.near=g.near,g.showLine&&(g.far!==y.far||g.origin!==y.origin||g.direction!==y.direction||!y.showLine)&&(this.unitLineEndVec3.copy(g.direction).normalize(),this.drawLine()),!g.showLine&&y.showLine&&d.removeAttribute("line"),g.objects!==y.objects&&!a.test(g.objects)&&v('[raycaster] Selector "'+g.objects+'" may not update automatically with DOM changes.'),g.objects||v('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),g.autoRefresh!==y.autoRefresh&&d.isPlaying&&(g.autoRefresh?this.addEventListeners():this.removeEventListeners()),y.enabled&&!g.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,f),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var y=this.data,g;g=y.objects?this.el.sceneEl.querySelectorAll(y.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(g),this.dirty=!1},tock:function(y){var g=this.data,d=this.prevCheckTime;g.enabled&&(d&&y-d<g.interval||(this.prevCheckTime=y,this.checkIntersections()))},checkIntersections:function(){var y=this.clearedIntersectedEls,g=this.el,d=this.data,p,C=this.intersectedEls,S,_=this.intersections,L=this.newIntersectedEls,T=this.newIntersections,N=this.prevIntersectedEls,F=this.rawIntersections;for(this.dirty&&this.refreshObjects(),l(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),F.length=0,this.raycaster.intersectObjects(this.objects,!0,F),_.length=0,C.length=0,p=0;p<F.length;p++)S=F[p],!(d.showLine&&S.object===g.getObject3D("line"))&&S.object.el&&(_.push(S),C.push(S.object.el));for(T.length=0,L.length=0,p=0;p<_.length;p++)N.indexOf(_[p].object.el)===-1&&(T.push(_[p]),L.push(_[p].object.el));for(y.length=0,p=0;p<N.length;p++)C.indexOf(N[p])===-1&&(N[p].emit(m.INTERSECT_CLEAR,this.intersectedClearedDetail),y.push(N[p]));for(y.length&&g.emit(m.INTERSECTION_CLEAR,this.intersectionClearedDetail),p=0;p<L.length;p++)L[p].emit(m.INTERSECT,this.intersectedDetail);T.length&&(this.intersectionDetail.els=L,this.intersectionDetail.intersections=T,g.emit(m.INTERSECTION,this.intersectionDetail)),(N.length===0&&_.length>0||N.length>0&&_.length===0||N.length&&_.length&&N[0]!==_[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=_,g.emit(m.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),d.showLine&&setTimeout(this.updateLine)},updateLine:function(){var y=this.el,g=this.intersections,d;g.length&&(g[0].object.el===y&&g[1]?d=g[1].distance:d=g[0].distance),this.drawLine(d)},getIntersection:function(y){var g,d;for(g=0;g<this.intersections.length;g++)if(d=this.intersections[g],d.object.el===y)return d;return null},updateOriginDirection:function(){var y=new w.Vector3,g=new w.Vector3;return function(){var p=this.el,C=this.data;if(C.useWorldCoordinates){this.raycaster.set(C.origin,C.direction);return}p.object3D.updateMatrixWorld(),g.setFromMatrixPosition(p.object3D.matrixWorld),(C.origin.x!==0||C.origin.y!==0||C.origin.z!==0)&&(g=p.object3D.localToWorld(g.copy(C.origin))),y.copy(C.direction).transformDirection(p.object3D.matrixWorld).normalize(),this.raycaster.set(g,y)}}(),drawLine:function(y){var g=this.data,d=this.el,p;p=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,y===void 0&&(y=g.far===1/0?1e3:g.far),this.lineData.start=g.origin,this.lineData.end=p.copy(this.unitLineEndVec3).multiplyScalar(y).add(g.origin),this.lineData.color=g.lineColor,this.lineData.opacity=g.lineOpacity,d.setAttribute("line",this.lineData)},flattenObject3DMaps:function(y){var g,d,p=this.objects,C=this.el.sceneEl.object3D;function S(L){return L.parent?S(L.parent):L===C}for(p.length=0,d=0;d<y.length;d++){var _=y[d];if(_.isEntity&&_.object3D&&S(_.object3D))for(g in _.object3DMap)p.push(_.getObject3D(g))}return p},clearAllIntersections:function(){var y;for(y=0;y<this.intersectedEls.length;y++)this.intersectedEls[y].emit(m.INTERSECT_CLEAR,this.intersectedClearedDetail);l(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(m.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function l(y,g){var d;for(y.length=g.length,d=0;d<g.length;d++)y[d]=g[d]}},"./src/components/rotation.js":(W,$,A)=>{var u=A("./src/lib/three.js").MathUtils.degToRad,w=A("./src/core/component.js").registerComponent;W.exports.Component=w("rotation",{schema:{type:"vec3"},update:function(){var h=this.data,v=this.el.object3D;v.rotation.set(u(h.x),u(h.y),u(h.z),"YXZ")},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var w=this.data,h=this.el.object3D;h.scale.set(w.x,w.y,w.z)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(W,$,A)=>{var u="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",w=A("./src/core/component.js").registerComponent,h=A("./src/lib/three.js"),v=21,a=function(){var y=new h.Quaternion,g=new h.Vector3;function d(p,C,S){C.position.copy(p.transform.position),C.quaternion.copy(p.transform.orientation),g.copy(S),y.copy(p.transform.orientation),g.applyQuaternion(y),C.position.sub(g)}return d}();a.tempFakePose={transform:{orientation:new h.Quaternion,position:new h.Vector3}};function f(y,g){this.renderer=y,this.xrHitTestSource=null,y.xr.addEventListener("sessionend",(function(){this.xrHitTestSource=null}).bind(this)),y.xr.addEventListener("sessionstart",(function(){this.sessionStart(g)}).bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(g)}f.prototype.previousFrameAnchors=new Set,f.prototype.anchorToObject3D=new Map;function m(y){console.warn(y.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}f.prototype.sessionStart=function(g){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){m({message:"No requestHitTestSource on the session."});return}g.space?this.session.requestHitTestSource(g).then((function(d){this.xrHitTestSource=d}).bind(this)).catch(m):g.profile&&this.session.requestHitTestSourceForTransientInput(g).then((function(d){this.xrHitTestSource=d,this.transient=!0}).bind(this)).catch(m)},f.prototype.anchorFromLastHitTestResult=function(y,g){var d=this.lastHitTest;if(d){var p={object3D:y,offset:g};Array.from(this.anchorToObject3D.entries()).forEach((function(C){var S=C[1].object3D,_=C[0];S===y&&(this.anchorToObject3D.delete(_),_.delete())}).bind(this)),d.createAnchor&&d.createAnchor().then((function(C){this.anchorToObject3D.set(C,p)}).bind(this)).catch(function(C){console.warn(C.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},f.prototype.doHit=function(g){if(this.renderer.xr.isPresenting){var d=this.renderer.xr.getReferenceSpace(),p=g.getViewerPose(d),C,S;if(this.xrHitTestSource&&p)return this.transient?(C=g.getHitTestResultsForTransientInput(this.xrHitTestSource),C.length>0?(S=C[0].results,S.length>0?(this.lastHitTest=S[0],S[0].getPose(d)):!1):!1):(C=g.getHitTestResults(this.xrHitTestSource),C.length>0?(this.lastHitTest=C[0],C[0].getPose(d)):!1)}},f.updateAnchorPoses=function(y,g){var d=y.trackedAnchors||f.prototype.previousFrameAnchors;f.prototype.previousFrameAnchors.forEach(function(p){d.has(p)||f.prototype.anchorToObject3D.delete(p)}),d.forEach(function(p){var C,S,_,L;try{C=y.getPose(p.anchorSpace,g)}catch{}if(C){if(S=f.prototype.anchorToObject3D.get(p),!S)return;_=S.offset,L=S.object3D,a(C,L,_)}})};var l;W.exports.Component=w("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:u,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},sceneOnly:!0,init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(1048576),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new h.OrthographicCamera,this.orthoCam.layers.set(v),this.textureTarget=new h.WebGLRenderTarget(512,512,{}),this.basicMaterial=new h.MeshBasicMaterial({color:0,side:h.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new h.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var y=this.el.getAttribute("webxr"),g=y.optionalFeatures;(!g.includes("hit-test")||!g.includes("anchors"))&&(g.push("hit-test"),g.push("anchors"),this.el.setAttribute("webxr",y)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",(function(){this.hitTest=null}).bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",(function(){if(this.el.is("ar-mode")){var d=this.el.sceneEl.renderer,p=this.session=d.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,l||(l=new Map),p.requestReferenceSpace("viewer").then((function(_){this.hitTest=new f(d,{space:_}),l.set(_,this.hitTest),this.el.emit("ar-hit-test-start")}).bind(this));var C="generic-touchscreen",S=new f(d,{profile:C});p.addEventListener("selectstart",(function(_){if(this.data.enabled===!0){var L=_.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:L,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),L.profiles[0]===C?this.hitTest=S:(this.hitTest=l.get(L)||new f(d,{space:L.targetRaySpace}),l.set(L,this.hitTest)))}}).bind(this)),p.addEventListener("selectend",(function(_){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var L=_.inputSource,T;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(T=this.data.target.object3D,T&&(a.tempFakePose.transform.position.copy(this.bboxMesh.position),a.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),a(a.tempFakePose,T,this.bboxOffset),T.visible=!0,this.hitTest.anchorFromLastHitTestResult(T,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:L,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}).bind(this))}}).bind(this)),this.bboxOffset=new h.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(v),this.data.target.object3D.traverse(function(y){y.layers.enable(v)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var y=new h.PlaneGeometry(1,1),g=new h.MeshBasicMaterial({transparent:!0,color:16777215});y.rotateX(-Math.PI/2),y.rotateY(-Math.PI/2),this.bbox=new h.Box3,this.bboxMesh=new h.Mesh(y,g),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var y,g=this.el.sceneEl.renderer,d,p,C=g.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),d=g.getRenderTarget(),g.setRenderTarget(this.textureTarget),g.xr.enabled=!1,p=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,g.render(this.el.object3D,this.orthoCam),this.el.object3D.background=p,this.el.object3D.overrideMaterial=null,g.xr.enabled=C,g.setRenderTarget(d),g.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),y=this.context.getImageData(0,0,512,512);for(var S=0;S<262144;S++)y.data[S*4+3]!==0&&y.data[S*4+3]!==255&&(y.data[S*4+3]=128);this.context.putImageData(y,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var y,g=this.el.sceneEl.frame,d=this.el.sceneEl.renderer;if(g&&f.updateAnchorPoses(g,d.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var p;this.textureCache.has(this.data.src)?p=this.textureCache.get(this.data.src):(p=new h.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,p)),this.bboxMesh.material.map=p,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(y=this.hitTest.doHit(g),y&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(y.transform.position),this.bboxMesh.quaternion.copy(y.transform.orientation)))}})},"./src/components/scene/background.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},sceneOnly:!0,update:function(){var w=this.data,h=this.el.object3D;w.transparent?h.background=null:h.background=new THREE.Color(w.color)},remove:function(){var w=this.el.object3D;w.background=null}})},"./src/components/scene/debug.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("debug",{schema:{default:!0},sceneOnly:!0})},"./src/components/scene/device-orientation-permission-ui.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/constants/index.js"),h="a-modal",v="a-dialog",a="a-dialog-text",f="a-dialog-text-container",m="a-dialog-buttons-container",l="a-dialog-button",y="a-dialog-allow-button",g="a-dialog-deny-button",d="a-dialog-ok-button";W.exports.Component=u("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},sceneOnly:!0,init:function(){var _=this;if(this.data.enabled){if(window.isSecureContext||this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=this.onDeviceMotionDialogAllowClicked.bind(this),this.onDeviceMotionDialogDenyClicked=this.onDeviceMotionDialogDenyClicked.bind(this),DeviceOrientationEvent.requestPermission().then(function(){_.el.emit("deviceorientationpermissiongranted"),_.permissionGranted=!0}).catch(function(){_.devicePermissionDialogEl=p(_.data.denyButtonText,_.data.allowButtonText,_.data.deviceMotionMessage,_.onDeviceMotionDialogAllowClicked,_.onDeviceMotionDialogDenyClicked),_.el.appendChild(_.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var _=this,L=C(_.data.cancelButtonText,_.data.httpsMessage,function(){_.el.removeChild(L)});this.el.appendChild(L)},onDeviceMotionDialogAllowClicked:function(){var _=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(L){L==="granted"?(_.el.emit("deviceorientationpermissiongranted"),_.permissionGranted=!0):_.el.emit("deviceorientationpermissionrejected"),_.remove()}).catch(console.error)}});function p(_,L,T,N,F){var te,K,se;return te=document.createElement("div"),te.classList.add(m),K=document.createElement("button"),K.classList.add(l,g),K.setAttribute(w.AFRAME_INJECTED,""),K.innerHTML=_,te.appendChild(K),se=document.createElement("button"),se.classList.add(l,y),se.setAttribute(w.AFRAME_INJECTED,""),se.innerHTML=L,te.appendChild(se),se.addEventListener("click",function(ne){ne.stopPropagation(),N()}),K.addEventListener("click",function(ne){ne.stopPropagation(),F()}),S(T,te)}function C(_,L,T){var N,F;return N=document.createElement("div"),N.classList.add(m),F=document.createElement("button"),F.classList.add(l,d),F.setAttribute(w.AFRAME_INJECTED,""),F.innerHTML=_,N.appendChild(F),F.addEventListener("click",function(te){te.stopPropagation(),T()}),S(L,N)}function S(_,L){var T,N,F,te;return T=document.createElement("div"),T.classList.add(h),T.setAttribute(w.AFRAME_INJECTED,""),N=document.createElement("div"),N.className=v,N.setAttribute(w.AFRAME_INJECTED,""),T.appendChild(N),F=document.createElement("div"),F.classList.add(f),N.appendChild(F),te=document.createElement("div"),te.classList.add(a),te.innerHTML=_,F.appendChild(te),N.appendChild(L),T}},"./src/components/scene/embedded.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},sceneOnly:!0,update:function(){var w=this.el,h=w.querySelector(".a-enter-vr");this.data===!0?(h&&h.classList.add("embedded"),w.removeFullScreenStyles()):(h&&h.classList.remove("embedded"),w.addFullScreenStyles())}})},"./src/components/scene/fog.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/debug.js");h("components:fog:warn"),W.exports.Component=u("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},sceneOnly:!0,update:function(){var a=this.data,f=this.el,m=this.el.object3D.fog;if(!m||a.type!==m.name){f.object3D.fog=v(a);return}Object.keys(this.schema).forEach(function(l){var y=a[l];l==="color"&&(y=new w.Color(y)),m[l]=y})},remove:function(){var a=this.el,f=this.el.object3D.fog;f&&(a.object3D.fog=null)}});function v(a){var f;return a.type==="exponential"?f=new w.FogExp2(a.color,a.density):f=new w.Fog(a.color,a.near,a.far),f.name=a.type,f}},"./src/components/scene/inspector.js":(W,$,A)=>{var u=A("./src/constants/index.js").AFRAME_INJECTED,w=A("./package.json"),h=A("./src/core/component.js").registerComponent,v=A("./src/utils/index.js");function a(g){var d=g.split(".");return d[2]="x",d.join(".")}var f="https://unpkg.com/aframe-inspector@"+a(w.version)+"/dist/aframe-inspector.min.js",m=f,l="Loading Inspector",y="Error loading Inspector";W.exports.Component=h("inspector",{schema:{url:{default:m}},sceneOnly:!0,init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var g;this.firstPlay&&(g=v.getUrlParameter("inspector"),g!=="false"&&g&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var g='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=l+g},remove:function(){this.removeEventListeners()},onKeydown:function(g){var d=g.keyCode===73&&(g.ctrlKey&&g.altKey||g.getModifierState("AltGraph"));d&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(g){g.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(g){var d=this,p;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(g);return}this.showLoader(),p=document.createElement("script"),p.src=this.data.url,p.setAttribute("data-name","aframe-inspector"),p.setAttribute(u,""),p.onload=function(){AFRAME.INSPECTOR.open(g),d.hideLoader(),d.removeEventListeners()},p.onerror=function(){d.loadingMessageEl.innerHTML=y},document.head.appendChild(p),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/index.js").shouldCaptureKeyEvent;W.exports.Component=u("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},sceneOnly:!0,init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(h){var v=this.data;this.enterVREnabled=v.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(h){var v=this.el;w(h)&&(this.enterVREnabled&&h.keyCode===70&&v.enterVR(),this.enterVREnabled&&h.keyCode===27&&v.exitVR())}})},"./src/components/scene/pool.js":(W,$,A)=>{var u=A("./src/utils/debug.js"),w=A("./src/core/component.js").registerComponent,h=u("components:pool:warn");W.exports.Component=w("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},sceneOnly:!0,multiple:!0,initPool:function(){var v;for(this.availableEls=[],this.usedEls=[],this.data.mixin||h("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||h("Container "+this.data.container+" not found.")),this.container=this.container||this.el,v=0;v<this.data.size;++v)this.createEntity()},update:function(v){var a=this.data;(v.mixin!==a.mixin||v.size!==a.size)&&this.initPool()},createEntity:function(){var v;v=document.createElement("a-entity"),v.play=this.wrapPlay(v.play),v.setAttribute("mixin",this.data.mixin),v.object3D.visible=!1,v.pause(),this.container.appendChild(v),this.availableEls.push(v);var a=this.usedEls;v.addEventListener("loaded",function(){a.indexOf(v)===-1&&(v.object3DParent=v.object3D.parent,v.object3D.parent.remove(v.object3D))})},wrapPlay:function(v){var a=this.usedEls;return function(){a.indexOf(this)!==-1&&v.call(this)}},requestEntity:function(){var v;if(this.availableEls.length===0){if(this.data.dynamic===!1){h("Requested entity from empty pool: "+this.attrName);return}else h("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return v=this.availableEls.shift(),this.usedEls.push(v),v.object3DParent&&(v.object3DParent.add(v.object3D),this.updateRaycasters()),v.object3D.visible=!0,v},returnEntity:function(v){var a=this.usedEls.indexOf(v);if(a===-1){h("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(a,1),this.availableEls.push(v),v.object3DParent=v.object3D.parent,v.object3D.parent.remove(v.object3D),this.updateRaycasters(),v.object3D.visible=!1,v.pause(),v},updateRaycasters:function(){var v=document.querySelectorAll("[raycaster]");v.forEach(function(a){a.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js");W.exports.Component=u("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},sceneOnly:!0,init:function(){var h=this.el.getAttribute("webxr"),v=h.requiredFeatures;v.indexOf("mesh-detection")===-1&&(v.push("mesh-detection"),this.el.setAttribute("webxr",h)),v.indexOf("plane-detection")===-1&&(v.push("plane-detection"),this.el.setAttribute("webxr",h)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){this.el.is("ar-mode")&&(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var h=this.data,v,a,f=this.el;f.renderer.xr;var m,l=this.meshEntities,y=!1,g=[],d=this.data.filterLabels;m=f.frame,v=m.detectedMeshes,a=m.detectedPlanes;for(var p=0;p<l.length;p++)l[p].present=!1;if(h.meshesEnabled){for(var C of v.values())if(!(d.length&&d.indexOf(C.semanticLabel)===-1)){for(p=0;p<l.length;p++)if(C===l[p].mesh){y=!0,l[p].present=!0,l[p].lastChangedTime<C.lastChangedTime&&this.updateMeshGeometry(l[p].el,C),l[p].lastChangedTime=C.lastChangedTime;break}y||g.push(C),y=!1}}if(h.planesEnabled){for(C of a.values())if(!(d.length&&d.indexOf(C.semanticLabel)===-1)){for(p=0;p<l.length;p++)if(C===l[p].mesh){y=!0,l[p].present=!0,l[p].lastChangedTime<C.lastChangedTime&&this.updateMeshGeometry(l[p].el,C),l[p].lastChangedTime=C.lastChangedTime;break}y||g.push(C),y=!1}}this.deleteMeshes(),this.createNewMeshes(g)},updateMeshes:function(){var h=new w.Matrix4;return function(){for(var v,a=this.el,f,m=a.frame,l=this.meshEntities,y=a.renderer.xr.getReferenceSpace(),g,d=0;d<l.length;d++)g=l[d].mesh.meshSpace||l[d].mesh.planeSpace,v=m.getPose(g,y),f=l[d].el,f.hasLoaded&&(h.fromArray(v.transform.matrix),h.decompose(f.object3D.position,f.object3D.quaternion,f.object3D.scale))}}(),deleteMeshes:function(){for(var h=this.meshEntities,v=[],a=0;a<h.length;a++)h[a].present?v.push(h[a]):this.el.removeChild(h[a]);this.meshEntities=v},createNewMeshes:function(h){for(var v,a=0;a<h.length;a++)v=document.createElement("a-entity"),this.meshEntities.push({mesh:h[a],el:v}),v.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(v)},initMeshGeometry:function(h){var v,a,f;if(h instanceof XRPlane){a=new w.Shape,f=h.polygon;for(var m=0;m<f.length;++m)m===0?a.moveTo(f[m].x,f[m].z):a.lineTo(f[m].x,f[m].z);return v=new w.ShapeGeometry(a),v.rotateX(Math.PI/2),v}return v=new w.BufferGeometry,v.setAttribute("position",new w.BufferAttribute(h.vertices,3)),v.setIndex(new w.BufferAttribute(h.indices,1)),v},initWorldMeshEntity:function(h){for(var v=h.target,a,f,m,l=this.meshEntities,y=0;y<l.length;y++)if(l[y].el===v){m=l[y];break}a=this.initMeshGeometry(m.mesh),f=new w.Mesh(a,new w.MeshBasicMaterial({color:Math.random()*16777215,side:w.DoubleSide})),v.setObject3D("mesh",f),m.mesh instanceof XRPlane&&this.data.planeMixin?v.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&v.setAttribute("mixin",this.data.meshMixin),v.setAttribute("data-world-mesh",m.mesh.semanticLabel)},updateMeshGeometry:function(h,v){var a=h.getObject3D("mesh");a.geometry.dispose(),a.geometry=this.initMeshGeometry(v)}})},"./src/components/scene/reflection.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;function w(h,v,a,f){var m=Math.max(h.primaryLightIntensity.x,Math.max(h.primaryLightIntensity.y,h.primaryLightIntensity.z));v.sh.fromArray(h.sphericalHarmonicsCoefficients),v.intensity=1,a&&(a.color.setRGB(h.primaryLightIntensity.x/m,h.primaryLightIntensity.y/m,h.primaryLightIntensity.z/m),a.intensity=m,f.copy(h.primaryLightDirection))}W.exports.Component=u("reflection",{schema:{directionalLight:{type:"selector"}},sceneOnly:!0,init:function(){var h=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var v=this.el.getAttribute("webxr"),a=v.optionalFeatures;a.includes("light-estimation")||(a.push("light-estimation"),this.el.setAttribute("webxr",v)),this.el.addEventListener("enter-vr",function(){if(h.el.is("ar-mode")){var f=h.el.renderer,m=f.xr.getSession();m.requestLightProbe&&h.startLightProbe()}}),this.el.addEventListener("exit-vr",function(){h.xrLightProbe&&h.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var h=this.el.renderer,v=h.xr.getSession(),a=this,f=h.getContext();if(!this.probeLight){var m=document.createElement("a-light");m.setAttribute("type","probe"),m.setAttribute("intensity",0),this.el.appendChild(m),this.probeLight=m}switch(v.preferredReflectionFormat){case"srgba8":f.getExtension("EXT_sRGB");break;case"rgba16f":f.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(v,f),f.getExtension("EXT_sRGB"),f.getExtension("OES_texture_half_float"),v.requestLightProbe().then(function(l){a.xrLightProbe=l,l.addEventListener("reflectionchange",a.updateXRCubeMap.bind(a))}).catch(function(l){console.warn("Lighting estimation not supported: "+l.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var h=this.el.renderer,v=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(v){var a=h.properties.get(this.lightingEstimationTexture);a.__webglTexture=v,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var h=this.el.object3D,v=this.el.renderer,a=this.el.frame;if(a&&this.xrLightProbe){var f=a.getLightEstimate(this.xrLightProbe);f&&w(f,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(h.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(v,h),h.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&a&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),v=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);W.exports.Component=u("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},sceneOnly:!0,setup:function(){var a=this.el;if(!this.canvas){var f=a.renderer.getContext();f&&(this.cubeMapSize=f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE),this.material=new w.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:h,fragmentShader:v,side:w.DoubleSide}),this.quad=new w.Mesh(new w.PlaneGeometry(1,1),this.material),this.quad.visible=!1,this.camera=new w.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),a.object3D.add(this.quad),this.onKeyDown=this.onKeyDown.bind(this))}},getRenderTarget:function(a,f){return new w.WebGLRenderTarget(a,f,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:w.LinearFilter,magFilter:w.LinearFilter,wrapS:w.ClampToEdgeWrapping,wrapT:w.ClampToEdgeWrapping,format:w.RGBAFormat,type:w.UnsignedByteType})},resize:function(a,f){this.quad.scale.set(a,f,1),this.camera.left=-1*a/2,this.camera.right=a/2,this.camera.top=f/2,this.camera.bottom=-1*f/2,this.camera.updateProjectionMatrix(),this.canvas.width=a,this.canvas.height=f},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(a){var f=a.keyCode===83&&a.ctrlKey&&a.altKey;if(!(!this.data||!f)){var m=a.shiftKey?"equirectangular":"perspective";this.capture(m)}},setCapture:function(a){var f=this.el,m,l,y,g;return a==="perspective"?(this.quad.visible=!1,l=this.data.camera&&this.data.camera.components.camera.camera||f.camera,m={width:this.data.width,height:this.data.height}):(l=this.camera,g=new w.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:w.RGBFormat,generateMipmaps:!0,minFilter:w.LinearMipmapLinearFilter,colorSpace:w.SRGBColorSpace}),y=new w.CubeCamera(f.camera.near,f.camera.far,g),f.camera.getWorldPosition(y.position),f.camera.getWorldQuaternion(y.quaternion),y.update(f.renderer,f.object3D),this.quad.material.uniforms.map.value=y.renderTarget.texture,m={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:l,size:m,projection:a}},capture:function(a){var f=this.el.renderer.xr.enabled,m=this.el.renderer,l;this.setup(),m.xr.enabled=!1,l=this.setCapture(a),this.renderCapture(l.camera,l.size,l.projection),this.saveCapture(),m.xr.enabled=f},getCanvas:function(a){var f=this.el.renderer.xr.enabled,m=this.el.renderer;this.setup();var l=this.setCapture(a);return m.xr.enabled=!1,this.renderCapture(l.camera,l.size,l.projection),m.xr.enabled=f,this.canvas},renderCapture:function(a,f,m){var l=this.el.renderer.autoClear,y=this.el,g,d,p,C=y.renderer;d=this.getRenderTarget(f.width,f.height),p=new Uint8Array(4*f.width*f.height),this.resize(f.width,f.height),C.autoClear=!0,C.clear(),C.setRenderTarget(d),C.render(y.object3D,a),C.autoClear=l,C.readRenderTargetPixels(d,0,0,f.width,f.height,p),C.setRenderTarget(null),m==="perspective"&&(p=this.flipPixelsVertically(p,f.width,f.height)),g=new ImageData(new Uint8ClampedArray(p),f.width,f.height),this.quad.visible=!1,this.ctx.putImageData(g,0,0)},flipPixelsVertically:function(a,f,m){for(var l=a.slice(0),y=0;y<f;++y)for(var g=0;g<m;++g)l[y*4+g*f*4]=a[y*4+(m-g)*f*4],l[y*4+1+g*f*4]=a[y*4+1+(m-g)*f*4],l[y*4+2+g*f*4]=a[y*4+2+(m-g)*f*4],l[y*4+3+g*f*4]=a[y*4+3+(m-g)*f*4];return l},saveCapture:function(){this.canvas.toBlob(function(a){var f="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",m=document.createElement("a"),l=URL.createObjectURL(a);m.href=l,m.setAttribute("download",f),m.innerHTML="downloading...",m.style.display="none",document.body.appendChild(m),setTimeout(function(){m.click(),document.body.removeChild(m)},1)},"image/png")}})},"./src/components/scene/stats.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./vendor/rStats.js"),h=A("./src/utils/index.js");A("./vendor/rStats.extras.js"),A("./src/lib/rStatsAframe.js");var v=window.aframeStats,a="a-hidden",f=window.threeStats;W.exports.Component=u("stats",{schema:{default:!0},sceneOnly:!0,init:function(){var l=this.el;h.getUrlParameter("stats")!=="false"&&(this.stats=m(l),this.statsEl=document.querySelector(".rs-base"),this.hideBound=this.hide.bind(this),this.showBound=this.show.bind(this),l.addEventListener("enter-vr",this.hideBound),l.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var l=this.stats;l&&(l("rAF").tick(),l("FPS").frame(),l().update())},hide:function(){this.statsEl.classList.add(a)},show:function(){this.statsEl.classList.remove(a)}});function m(l){var y=new f(l.renderer),g=new v(l),d=l.isMobile?[]:[y,g];return new w({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:d})}},"./src/components/scene/xr-mode-ui.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/constants/index.js"),h=A("./src/utils/index.js"),v="a-enter-vr",a="a-enter-ar",f="a-enter-vr-button",m="a-enter-ar-button",l="a-hidden",y="a-orientation-modal";W.exports.Component=u("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},sceneOnly:!0,init:function(){var S=this,_=this.el;h.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),_.addEventListener("enter-vr",this.updateEnterInterfaces),_.addEventListener("exit-vr",this.updateEnterInterfaces),_.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(L){L.data.type==="loaderReady"&&(S.insideLoader=!0,S.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=this.onEnterVRButtonClick.bind(this),this.onEnterARButtonClick=this.onEnterARButtonClick.bind(this),this.onModalClick=this.onModalClick.bind(this),this.toggleOrientationModalIfNeeded=this.toggleOrientationModalIfNeeded.bind(this),this.updateEnterInterfaces=this.updateEnterInterfaces.bind(this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var S=this.data,_=this.el;if(!S.enabled||this.insideLoader||h.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&S.enterVREnabled&&(S.XRMode==="xr"||S.XRMode==="vr")&&(S.enterVRButton?(this.enterVREl=document.querySelector(S.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=g(this.onEnterVRButtonClick),_.appendChild(this.enterVREl))),!this.enterAREl&&S.enterAREnabled&&(S.XRMode==="xr"||S.XRMode==="ar")&&(S.enterARButton?(this.enterAREl=document.querySelector(S.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=d(this.onEnterARButtonClick,S.XRMode==="xr"),_.appendChild(this.enterAREl))),this.orientationModalEl=p(this.onModalClick),_.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(S){S&&S.parentNode&&S.parentNode.removeChild(S)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var S=this.el;this.enterVREl&&(S.is("vr-mode")||(S.isMobile||h.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!h.device.checkVRSupport()?this.enterVREl.classList.add(l):(h.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(l),S.enterVR(!1,!0)))},toggleEnterARButtonIfNeeded:function(){var S=this.el;this.enterAREl&&(S.is("vr-mode")||!h.device.checkARSupport()?this.enterAREl.classList.add(l):(this.enterAREl.classList.remove(l),S.enterVR(!0,!0)))},toggleOrientationModalIfNeeded:function(){var S=this.el,_=this.orientationModalEl;!_||!S.isMobile||(!h.device.isLandscape()&&S.is("vr-mode")?_.classList.remove(l):_.classList.add(l))}});function g(S){var _,L;return L=document.createElement("div"),L.classList.add(v),L.setAttribute(w.AFRAME_INJECTED,""),_=document.createElement("button"),_.className=f,_.setAttribute("title","Enter VR mode with a headset or fullscreen without"),_.setAttribute(w.AFRAME_INJECTED,""),h.device.isMobile()&&C(_),L.appendChild(_),_.addEventListener("click",function(T){S(),T.stopPropagation()}),L}function d(S,_){var L,T;return T=document.createElement("div"),T.classList.add(a),_&&T.classList.add("xr"),T.setAttribute(w.AFRAME_INJECTED,""),L=document.createElement("button"),L.className=m,L.setAttribute("title","Enter AR mode with a headset or handheld device."),L.setAttribute(w.AFRAME_INJECTED,""),h.device.isMobile()&&C(L),T.appendChild(L),L.addEventListener("click",function(N){S(),N.stopPropagation()}),T}function p(S){var _=document.createElement("div");_.className=y,_.classList.add(l),_.setAttribute(w.AFRAME_INJECTED,"");var L=document.createElement("button");return L.setAttribute(w.AFRAME_INJECTED,""),L.innerHTML="Exit VR",L.addEventListener("click",S),_.appendChild(L),_}function C(S){S.addEventListener("touchstart",function(){S.classList.remove("resethover")},{passive:!0}),S.addEventListener("touchend",function(){S.classList.add("resethover")},{passive:!0})}},"./src/components/shadow.js":(W,$,A)=>{var u=A("./src/core/component.js"),w=A("./src/lib/three.js"),h=u.registerComponent;W.exports.Component=h("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=this.update.bind(this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var v=this.data;this.updateDescendants(v.cast,v.receive)},remove:function(){var v=this.el;v.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(v,a){var f=this.el.sceneEl;this.el.object3D.traverse(function(m){if(m instanceof w.Mesh&&(m.castShadow=v,m.receiveShadow=a,f.hasLoaded&&m.material))for(var l=Array.isArray(m.material)?m.material:[m.material],y=0;y<l.length;y++)l[y].needsUpdate=!0})}})},"./src/components/sound.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/debug.js"),h=A("./src/lib/three.js"),v=w("components:sound:warn");W.exports.Component=u("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var a=this;this.listener=null,this.audioLoader=new h.AudioLoader,this.pool=new h.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){a.playSound()}},update:function(a){var f=this.data,m,l,y=f.src!==a.src;if(y){if(!f.src)return;this.setupSound()}for(m=0;m<this.pool.children.length;m++)l=this.pool.children[m],f.positional&&(l.setDistanceModel(f.distanceModel),l.setMaxDistance(f.maxDistance),l.setRefDistance(f.refDistance),l.setRolloffFactor(f.rolloffFactor)),l.setLoop(f.loop),l.setLoopStart(f.loopStart),f.loopStart!==0&&f.loopEnd===0?l.setLoopEnd(l.buffer.duration):l.setLoopEnd(f.loopEnd),l.setVolume(f.volume),l.isPaused=!1;if(f.on!==a.on&&this.updateEventListener(a.on),y){var g=this;this.loaded=!1,this.audioLoader.load(f.src,function(d){for(m=0;m<g.pool.children.length;m++)l=g.pool.children[m],l.setBuffer(d);g.loaded=!0,h.Cache.remove(f.src),(g.data.autoplay||g.mustPlay)&&g.playSound(g.processSound),g.el.emit("sound-loaded",g.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var a,f;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(a=0;a<this.pool.children.length;a++)f=this.pool.children[a],f.disconnect()}catch{v("Audio source not properly disconnected")}},updateEventListener:function(a){var f=this.el;a&&f.removeEventListener(a,this.playSoundBound),f.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var a=this.el,f,m=a.sceneEl,l=this,y;this.pool.children.length>0&&(this.stopSound(),a.removeObject3D("sound"));var g=this.listener=m.audioListener||new h.AudioListener;for(m.audioListener=g,m.camera&&m.camera.add(g),m.addEventListener("camera-set-active",function(d){d.detail.cameraEl.getObject3D("camera").add(g)}),this.pool=new h.Group,f=0;f<this.data.poolSize;f++)y=this.data.positional?new h.PositionalAudio(g):new h.Audio(g),this.pool.add(y);for(a.setObject3D(this.attrName,this.pool),f=0;f<this.pool.children.length;f++)y=this.pool.children[f],y.onEnded=function(){this.isPlaying=!1,l.el.emit("sound-ended",l.evtDetail,!1)}},pauseSound:function(){var a,f;for(this.isPlaying=!1,a=0;a<this.pool.children.length;a++)f=this.pool.children[a],!(!f.source||!f.source.buffer||!f.isPlaying||f.isPaused)&&(f.isPaused=!0,f.pause())},playSound:function(a){var f,m,l;if(!this.loaded){v("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=a;return}for(f=!1,this.isPlaying=!0,m=0;m<this.pool.children.length;m++)if(l=this.pool.children[m],!l.isPlaying&&l.buffer&&!f){a&&a(l),l.play(),l.isPaused=!1,f=!0;continue}if(!f){v("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var a,f;for(this.isPlaying=!1,a=0;a<this.pool.children.length;a++){if(f=this.pool.children[a],!f.source||!f.source.buffer)return;f.stop()}}})},"./src/components/text.js":(W,$,A)=>{var u=A("./node_modules/three-bmfont-text/index.js"),w=A("./node_modules/load-bmfont/browser.js"),h=A("./src/core/component.js").registerComponent,v=A("./src/core/shader.js"),a=A("./src/lib/three.js"),f=A("./src/utils/index.js"),m=f.debug("components:text:error"),l=v.shaders,y=f.debug("components:text:warn"),g=1,d=16,p=A("./src/constants/index.js").AFRAME_CDN_ROOT,C=p+"fonts/",S={aileronsemibold:C+"Aileron-Semibold.fnt",dejavu:C+"DejaVu-sdf.fnt",exo2bold:C+"Exo2Bold.fnt",exo2semibold:C+"Exo2SemiBold.fnt",kelsonsans:C+"KelsonSans.fnt",monoid:C+"Monoid.fnt",mozillavr:C+"mozillavr.fnt",roboto:C+"Roboto-msdf.json",sourcecodepro:C+"SourceCodePro.fnt"},_=["roboto"],L="roboto";W.exports.FONTS=S;var T=new oe,N={},F={},te=/^\w+:/;W.exports.Component=h("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:L},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:l},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=u(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(ae){var Ae=this.data,b=this.currentFont;if(F[Ae.font]?this.texture=F[Ae.font]:(this.texture=F[Ae.font]=new a.Texture,this.texture.anisotropy=d),this.createOrUpdateMaterial(),ae.font!==Ae.font){this.updateFont();return}b&&(this.updateGeometry(this.geometry,b),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var ae=this.data,Ae,b=this.material,I,O=this.shaderData,Q;if(Q=ae.shader,_.indexOf(ae.font)!==-1||ae.font.indexOf("-msdf.")>=0?Q="msdf":ae.font in S&&_.indexOf(ae.font)===-1&&(Q="sdf"),Ae=(this.shaderObject&&this.shaderObject.name)!==Q,O.alphaTest=ae.alphaTest,O.color=ae.color,O.map=this.texture,O.opacity=ae.opacity,O.side=K(ae.side),O.transparent=ae.transparent,O.negate=ae.negate,!Ae){this.shaderObject.update(O),b.transparent=O.transparent,b.side=O.side;return}I=re(this.el,Q,O),this.material=I.material,this.shaderObject=I.shader,this.material.side=O.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var ae=this.data,Ae=this.el,b,I=this.geometry,O=this;ae.font||y("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),b=this.lookupFont(ae.font||L)||ae.font,T.get(b,function(){return se(b,ae.yOffset)}).then(function(J){var ve;if(J.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");N[b]||(J.widthFactor=N[J]=k(J)),O.currentFont=J,ve=O.getFontImageSrc(),T.get(ve,function(){return ne(ve)}).then(function(Le){var _e=O.texture;_e&&(_e.image=Le,_e.needsUpdate=!0,F[ae.font]=_e,O.texture=_e,O.initMesh(),O.currentFont=J,O.updateGeometry(I,J),O.updateLayout(),O.mesh.visible=!0,Ae.emit("textfontset",{font:ae.font,fontObj:J}))}).catch(function(Le){m(Le.message),m(Le.stack)})}).catch(function(Q){m(Q.message),m(Q.stack)})},initMesh:function(){this.mesh||(this.mesh=new a.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var ae=this.lookupFont(this.data.font||L)||this.data.font,Ae=this.currentFont.pages[0];return Ae.match(te)&&Ae.indexOf("http")!==0?ae.replace(/(\.fnt)|(\.json)/,".png"):a.LoaderUtils.extractUrlBase(ae)+Ae},updateLayout:function(){var ae,Ae,b=this.el,I=this.data,O=this.geometry,Q,J,ve,Le=this.mesh,_e,Ze,qe,ft,Et;if(!(!Le||!O.layout)){if(Q=b.getAttribute("geometry"),qe=I.width||Q&&Q.width||g,_e=Y(I.wrapPixels,I.wrapCount,this.currentFont.widthFactor),Ze=qe/_e,ve=O.layout,J=Ze*(ve.height+ve.descender),Q&&Q.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!Q.width,this.hasExplicitGeoHeight=!!Q.height),this.hasExplicitGeoWidth||b.setAttribute("geometry","width",qe),this.hasExplicitGeoHeight||b.setAttribute("geometry","height",J)),ae=I.anchor==="align"?I.align:I.anchor,ae==="left")ft=0;else if(ae==="right")ft=-1*ve.width;else if(ae==="center")ft=-1*ve.width/2;else throw new TypeError("Invalid text.anchor property value",ae);if(Ae=I.baseline,Ae==="bottom")Et=0;else if(Ae==="top")Et=-1*ve.height+ve.ascender;else if(Ae==="center")Et=-1*ve.height/2;else throw new TypeError("Invalid text.baseline property value",Ae);Le.position.x=ft*Ze+I.xOffset,Le.position.y=Et*Ze,Le.position.z=I.zOffset,Le.scale.set(Ze,-1*Ze,Ze)}},lookupFont:function(ae){return S[ae]},updateGeometry:function(){var ae={},Ae={},b=/\\n/g,I=/\\t/g;return function(O,Q){var J=this.data;Ae.font=Q,Ae.lineHeight=J.lineHeight&&isFinite(J.lineHeight)?J.lineHeight:Q.common.lineHeight,Ae.text=J.value.toString().replace(b,`
`).replace(I,"	"),Ae.width=Y(J.wrapPixels,J.wrapCount,Q.widthFactor),O.update(f.extend(ae,J,Ae))}}()});function K(ae){switch(ae){case"back":return a.FrontSide;case"double":return a.DoubleSide;default:return a.BackSide}}function se(ae,Ae){return new Promise(function(b,I){w(ae,function(O,Q){if(O){m("Error loading font",ae),I(O);return}ae.indexOf("/Roboto-msdf.json")>=0&&(Ae=30),Ae&&Q.chars.map(function(ve){ve.yoffset+=Ae}),b(Q)})})}function ne(ae){return new Promise(function(Ae,b){new a.ImageLoader().load(ae,function(I){Ae(I)},void 0,function(){m("Error loading font image",ae),b(null)})})}function re(ae,Ae,b){var I,O;return O=new l[Ae].Shader,O.el=ae,O.init(b),O.update(b),I=O.material,I.transparent=b.transparent,{material:I,shader:O}}function Y(ae,Ae,b){return ae||(.5+Ae)*b}function k(ae){var Ae=0,b=0,I=0;return ae.chars.map(function(O){Ae+=O.xadvance,O.id>=48&&O.id<=57&&(I++,b+=O.xadvance)}),I?b/I:Ae/ae.chars.length}function oe(){var ae=this.cache={};this.get=function(Ae,b){return Ae in ae||(ae[Ae]=b()),ae[Ae]}}},"./src/components/tracked-controls-webvr.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/tracked-controls.js"),h=A("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,v=A("./src/lib/three.js"),a=A("./src/constants/index.js").DEFAULT_HANDEDNESS,f={x:.175,y:-.3,z:-.03},m={x:0,y:0,z:-.175},l={touches:[]},y={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};W.exports.Component=u("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new v.Vector3,this.controllerQuaternion=new v.Quaternion,this.controllerEuler=new v.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(g,d){var p=this.el.getObject3D("mesh");p&&p.update&&p.update(d/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return h},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var g=this.data,d=w.findMatchingControllerWebVR(this.system.controllers,g.id,g.idPrefix,g.hand,g.controller);this.controller=d,this.el.components["tracked-controls"].controller=d,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(g){var d=this.controller,p=this.controllerEuler,C=this.controllerQuaternion,S=this.deltaControllerPosition,_,L,T,N,F;L=this.getHeadElement(),T=L.object3D,F=this.defaultUserHeight(),N=d.pose,_=(d?d.hand:void 0)||a,g.copy(T.position),S.set(f.x*(_==="left"?-1:_==="right"?1:0),f.y,f.z),S.multiplyScalar(F),S.applyAxisAngle(T.up,T.rotation.y),g.add(S),S.set(m.x,m.y,m.z),S.multiplyScalar(F),N.orientation?C.fromArray(N.orientation):C.copy(T.quaternion),p.setFromQuaternion(C),p.set(p.x,p.y,0),S.applyEuler(p),g.add(S)},updatePose:function(){var g=this.controller,d=this.data,p=this.el.object3D,C,S=this.system.vrDisplay,_;g&&(C=g.pose,C.position?p.position.fromArray(C.position):d.armModel&&this.applyArmModel(p.position),C.orientation&&p.quaternion.fromArray(C.orientation),S&&C.position&&(_=this.el.sceneEl.renderer.xr.getStandingMatrix(),p.matrix.compose(p.position,p.quaternion,p.scale),p.matrix.multiplyMatrices(_,p.matrix),p.matrix.decompose(p.position,p.quaternion,p.scale)),p.rotateX(this.data.orientationOffset.x*v.MathUtils.DEG2RAD),p.rotateY(this.data.orientationOffset.y*v.MathUtils.DEG2RAD),p.rotateZ(this.data.orientationOffset.z*v.MathUtils.DEG2RAD))},updateButtons:function(){var g,d=this.controller,p;if(d){for(p=0;p<d.buttons.length;++p)this.buttonStates[p]||(this.buttonStates[p]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[p]||(this.buttonEventDetails[p]={id:p,state:this.buttonStates[p]}),g=d.buttons[p],this.handleButton(p,g);this.handleAxes()}},handleButton:function(g,d){var p;return p=this.handlePress(g,d)|this.handleTouch(g,d)|this.handleValue(g,d),p?(this.el.emit(y.BUTTONCHANGED,this.buttonEventDetails[g],!1),!0):!1},handleAxes:function(){var g=!1,d=this.controller.axes,p,C=this.axis,S=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),p=0;p<d.length;++p)S.push(C[p]!==d[p]),S[p]&&(g=!0);if(!g)return!1;for(this.axis.splice(0,this.axis.length),p=0;p<d.length;p++)this.axis.push(d[p]);return this.el.emit(y.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(g,d){var p,C=this.buttonStates[g];return d.pressed===C.pressed?!1:(p=d.pressed?y.BUTTONDOWN:y.BUTTONUP,this.el.emit(p,this.buttonEventDetails[g],!1),C.pressed=d.pressed,!0)},handleTouch:function(g,d){var p,C=this.buttonStates[g];return d.touched===C.touched?!1:(p=d.touched?y.TOUCHSTART:y.TOUCHEND,this.el.emit(p,this.buttonEventDetails[g],!1,l),C.touched=d.touched,!0)},handleValue:function(g,d){var p=this.buttonStates[g];return d.value===p.value?!1:(p.value=d.value,!0)}})},"./src/components/tracked-controls-webxr.js":(W,$,A)=>{var u=A("./src/utils/tracked-controls.js"),w=A("./src/core/component.js").registerComponent,h={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};W.exports.Component=w("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var v=this.el.sceneEl;this.updateController(),v.addEventListener("controllersupdated",this.updateController)},pause:function(){var v=this.el.sceneEl;v.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(v){return!(!this.controller||this.controller.gamepad||v.inputSource.handedness!=="none"&&v.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=u.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var v=this.el.sceneEl,a=this.controller,f=v.frame;!a||!v.frame||!this.system.referenceSpace||a.hand||(this.pose=f.getPose(a[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var v=this.el.object3D,a=this.pose;a&&(v.matrix.elements=a.transform.matrix,v.matrix.decompose(v.position,v.rotation,v.scale))},updateButtons:function(){var v,a,f=this.controller,m;if(!(!f||!f.gamepad)){for(m=f.gamepad,a=0;a<m.buttons.length;++a)this.buttonStates[a]||(this.buttonStates[a]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[a]||(this.buttonEventDetails[a]={id:a,state:this.buttonStates[a]}),v=m.buttons[a],this.handleButton(a,v);this.handleAxes()}},handleButton:function(v,a){var f;return f=this.handlePress(v,a)|this.handleTouch(v,a)|this.handleValue(v,a),f?(this.el.emit(h.BUTTONCHANGED,this.buttonEventDetails[v],!1),!0):!1},handleAxes:function(){var v=!1,a=this.controller.gamepad.axes,f,m=this.axis,l=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),f=0;f<a.length;++f)l.push(m[f]!==a[f]),l[f]&&(v=!0);if(!v)return!1;for(this.axis.splice(0,this.axis.length),f=0;f<a.length;f++)this.axis.push(a[f]);return this.el.emit(h.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(v,a){var f,m=this.buttonStates[v];return a.pressed===m.pressed?!1:(f=a.pressed?h.BUTTONDOWN:h.BUTTONUP,this.el.emit(f,this.buttonEventDetails[v],!1),m.pressed=a.pressed,!0)},handleTouch:function(v,a){var f,m=this.buttonStates[v];return a.touched===m.touched?!1:(f=a.touched?h.TOUCHSTART:h.TOUCHEND,this.el.emit(f,this.buttonEventDetails[v],!1),m.touched=a.touched,!0)},handleValue:function(v,a){var f=this.buttonStates[v];return a.value===f.value?!1:(f.value=a.value,!0)}})},"./src/components/tracked-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},after:["tracked-controls-webvr","tracked-controls-webxr"],update:function(){var w=this.data,h=this.el;h.sceneEl.hasWebXR?h.setAttribute("tracked-controls-webxr",{id:w.id,hand:w.hand,index:w.controller,iterateControllerProfiles:w.iterateControllerProfiles,handTrackingEnabled:w.handTrackingEnabled,space:w.space}):h.setAttribute("tracked-controls-webvr",w)}})},"./src/components/valve-index-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=A("./src/utils/tracked-controls.js"),v=h.checkControllerPresentAndSetup,a=h.emitIfAxesChanged,f=h.onButtonEvent,m=A("./src/constants/index.js").AFRAME_CDN_ROOT,l=m+"controllers/valve/index/valve-index-",y={left:l+"left.glb",right:l+"right.glb"},g="valve",d=A("./src/utils/index.js").device.isWebXRAvailable,p={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},C={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},S={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},_={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},L=d?_:S,T=d?C:p;W.exports.Component=u("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var N=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(F){f(F.detail.id,"down",N)},this.onButtonUp=function(F){f(F.detail.id,"up",N)},this.onButtonTouchEnd=function(F){f(F.detail.id,"touchend",N)},this.onButtonTouchStart=function(F){f(F.detail.id,"touchstart",N)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var N=this.el;N.addEventListener("buttonchanged",this.onButtonChanged),N.addEventListener("buttondown",this.onButtonDown),N.addEventListener("buttonup",this.onButtonUp),N.addEventListener("touchend",this.onButtonTouchEnd),N.addEventListener("touchstart",this.onButtonTouchStart),N.addEventListener("model-loaded",this.onModelLoaded),N.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var N=this.el;N.removeEventListener("buttonchanged",this.onButtonChanged),N.removeEventListener("buttondown",this.onButtonDown),N.removeEventListener("buttonup",this.onButtonUp),N.removeEventListener("touchend",this.onButtonTouchEnd),N.removeEventListener("touchstart",this.onButtonTouchStart),N.removeEventListener("model-loaded",this.onModelLoaded),N.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var N=this.data,F=N.hand==="right"?0:N.hand==="left"?1:2;v(this,g,{index:F,iterateControllerProfiles:!0,hand:N.hand})},injectTrackedControls:function(){var N=this.el,F=this.data;N.setAttribute("tracked-controls",{idPrefix:g,controller:F.hand==="right"?1:F.hand==="left"?0:2,hand:F.hand,orientationOffset:F.orientationOffset}),this.loadModel()},loadModel:function(){var N=this.data;N.model&&this.el.setAttribute("gltf-model",""+y[N.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(N){var F=this.mapping.buttons[N.detail.id],te=this.buttonMeshes,K;F&&(F==="trigger"&&(K=N.detail.state.value,te&&te.trigger&&(te.trigger.rotation.x=this.triggerOriginalRotationX-K*(Math.PI/40))),this.el.emit(F+"changed",N.detail.state))},onModelLoaded:function(N){var F,te=N.detail.model,K=this;N.target!==this.el||!this.data.model||(F=this.buttonMeshes={},F.grip={left:te.getObjectByName("leftgrip"),right:te.getObjectByName("rightgrip")},F.menu=te.getObjectByName("menubutton"),F.system=te.getObjectByName("systembutton"),F.trackpad=te.getObjectByName("touchpad"),F.trigger=te.getObjectByName("trigger"),this.triggerOriginalRotationX=F.trigger.rotation.x,Object.keys(F).forEach(function(se){K.setButtonColor(se,K.data.buttonColor)}),te.position.copy(T[this.data.hand]),te.rotation.copy(L[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controls",model:this.data.model,rayOrigin:new w.Vector3(0,0,0)}))},onAxisMoved:function(N){a(this,this.mapping.axes,N)},updateModel:function(N,F){var te,K;this.data.model&&(K=F.indexOf("touch")!==-1,!K&&(te=F==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(N,te)))},setButtonColor:function(N,F){}})},"./src/components/visible.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent;W.exports.Component=u("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/tracked-controls.js"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,a=w.onButtonEvent,f=A("./src/constants/index.js").AFRAME_CDN_ROOT,m=f+"controllers/vive/vr_controller_vive.obj",l=f+"controllers/vive/vr_controller_vive.mtl",y=A("./src/utils/index.js").device.isWebXRAvailable,g="htc-vive",d="OpenVR ",p=y?g:d,C={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},S={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","none"]},_=y?S:C;W.exports.Component=u("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:_,init:function(){var L=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(T){a(T.detail.id,"down",L)},this.onButtonUp=function(T){a(T.detail.id,"up",L)},this.onButtonTouchEnd=function(T){a(T.detail.id,"touchend",L)},this.onButtonTouchStart=function(T){a(T.detail.id,"touchstart",L)},this.previousButtonValues={},this.bindMethods()},update:function(){var L=this.data;this.controllerIndex=L.hand==="right"?0:L.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("model-loaded",this.onModelLoaded),L.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("model-loaded",this.onModelLoaded),L.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var L=this.data;h(this,p,{index:this.controllerIndex,hand:L.hand})},injectTrackedControls:function(){var L=this.el,T=this.data;L.setAttribute("tracked-controls",{idPrefix:p,hand:T.hand,controller:this.controllerIndex,orientationOffset:T.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:m,mtl:l})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(L){var T=this.mapping.buttons[L.detail.id],N=this.buttonMeshes,F;T&&(T==="trigger"&&(F=L.detail.state.value,N&&N.trigger&&(N.trigger.rotation.x=-F*(Math.PI/12))),this.el.emit(T+"changed",L.detail.state))},onModelLoaded:function(L){var T,N=L.detail.model,F=this;L.target!==this.el||!this.data.model||(T=this.buttonMeshes={},T.grip={left:N.getObjectByName("leftgrip"),right:N.getObjectByName("rightgrip")},T.menu=N.getObjectByName("menubutton"),T.system=N.getObjectByName("systembutton"),T.trackpad=N.getObjectByName("touchpad"),T.touchpad=N.getObjectByName("touchpad"),T.trigger=N.getObjectByName("trigger"),Object.keys(T).forEach(function(te){F.setButtonColor(te,F.data.buttonColor)}),N.position.set(0,-.015,.04))},onAxisMoved:function(L){v(this,this.mapping.axes,L)},updateModel:function(L,T){var N,F;this.data.model&&(F=T.indexOf("touch")!==-1,!F&&(N=T==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(L,N)))},setButtonColor:function(L,T){var N=this.buttonMeshes;if(N){if(L==="grip"){N.grip.left.material.color.set(T),N.grip.right.material.color.set(T);return}N[L].material.color.set(T)}}})},"./src/components/vive-focus-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/tracked-controls.js"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,a=w.onButtonEvent,f=A("./src/constants/index.js").AFRAME_CDN_ROOT,m=f+"controllers/vive/focus-controller/focus-controller.gltf",l=A("./src/utils/index.js").device.isWebXRAvailable,y="htc-vive-focus",g="HTC Vive Focus ",d=l?y:g,p={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},C={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},S=l?C:p;W.exports.Component=u("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},after:["tracked-controls"],mapping:S,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var _=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(L){a(L.detail.id,"down",_)},this.onButtonUp=function(L){a(L.detail.id,"up",_)},this.onButtonTouchStart=function(L){a(L.detail.id,"touchstart",_)},this.onButtonTouchEnd=function(L){a(L.detail.id,"touchend",_)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var _=this.el;_.addEventListener("buttonchanged",this.onButtonChanged),_.addEventListener("buttondown",this.onButtonDown),_.addEventListener("buttonup",this.onButtonUp),_.addEventListener("touchstart",this.onButtonTouchStart),_.addEventListener("touchend",this.onButtonTouchEnd),_.addEventListener("model-loaded",this.onModelLoaded),_.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var _=this.el;_.removeEventListener("buttonchanged",this.onButtonChanged),_.removeEventListener("buttondown",this.onButtonDown),_.removeEventListener("buttonup",this.onButtonUp),_.removeEventListener("touchstart",this.onButtonTouchStart),_.removeEventListener("touchend",this.onButtonTouchEnd),_.removeEventListener("model-loaded",this.onModelLoaded),_.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){h(this,d,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var _=this.el,L=this.data;_.setAttribute("tracked-controls",{armModel:L.armModel,idPrefix:d,orientationOffset:L.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",m)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(_){var L=_.detail.model,T;_.target!==this.el||!this.data.model||(T=this.buttonMeshes={},T.trigger=L.getObjectByName("BumperKey"),T.triggerPressed=L.getObjectByName("BumperKey_Press"),T.triggerPressed&&(T.triggerPressed.visible=!1),T.trackpad=L.getObjectByName("TouchPad"),T.trackpadPressed=L.getObjectByName("TouchPad_Press"),T.trackpadPressed&&(T.trackpadPressed.visible=!1))},onButtonChanged:function(_){var L=this.mapping.buttons[_.detail.id];L&&this.el.emit(L+"changed",_.detail.state)},onAxisMoved:function(_){v(this,this.mapping.axes,_)},updateModel:function(_,L){this.data.model&&this.updateButtonModel(_,L)},updateButtonModel:function(_,L){var T=this.buttonMeshes,N=_+"Pressed";if(!(!T||!T[_]||!T[N])){var F;switch(L){case"down":F=this.data.buttonHighlightColor;break;case"touchstart":F=this.data.buttonTouchedColor;break}F&&T[N].material.color.set(F),T[N].visible=!!F,T[_].visible=!F}}})},"./src/components/wasd-controls.js":(W,$,A)=>{var u=A("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,w=A("./src/core/component.js").registerComponent,h=A("./src/lib/three.js"),v=A("./src/utils/index.js"),a=v.shouldCaptureKeyEvent,f=1e-5,m=.2,l=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];W.exports.Component=w("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},after:["look-controls"],init:function(){this.keys={},this.easing=1.1,this.velocity=new h.Vector3,this.onBlur=this.onBlur.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onFocus=this.onFocus.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.attachVisibilityEventListeners()},tick:function(g,d){var p=this.data,C=this.el,S=this.velocity;!S[p.adAxis]&&!S[p.wsAxis]&&y(this.keys)||(d=d/1e3,this.updateVelocity(d),!(!S[p.adAxis]&&!S[p.wsAxis])&&C.object3D.position.add(this.getMovementVector(d)))},update:function(g){g.adAxis!==this.data.adAxis&&(this.velocity[g.adAxis]=0),g.wsAxis!==this.data.wsAxis&&(this.velocity[g.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(g){var d,p,C,S=this.data,_=this.keys,L=this.velocity,T,N;if(p=S.adAxis,T=S.wsAxis,g>m){L[p]=0,L[T]=0;return}var F=Math.pow(1/this.easing,g*60);L[p]!==0&&(L[p]=L[p]*F),L[T]!==0&&(L[T]=L[T]*F),Math.abs(L[p])<f&&(L[p]=0),Math.abs(L[T])<f&&(L[T]=0),S.enabled&&(d=S.acceleration,S.adEnabled&&(C=S.adInverted?-1:1,(_.KeyA||_.ArrowLeft)&&(L[p]-=C*d*g),(_.KeyD||_.ArrowRight)&&(L[p]+=C*d*g)),S.wsEnabled&&(N=S.wsInverted?-1:1,(_.KeyW||_.ArrowUp)&&(L[T]-=N*d*g),(_.KeyS||_.ArrowDown)&&(L[T]+=N*d*g)))},getMovementVector:function(){var g=new h.Vector3(0,0,0),d=new h.Euler(0,0,0,"YXZ");return function(p){var C=this.el.getAttribute("rotation"),S=this.velocity,_;return g.copy(S),g.multiplyScalar(p),C&&(_=this.data.fly?C.x:0,d.set(h.MathUtils.degToRad(_),h.MathUtils.degToRad(C.y),0),g.applyEuler(d)),g}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var g=Object.keys(this.keys),d=0;d<g.length;d++)delete this.keys[g[d]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(g){var d;a(g)&&(d=g.code||u[g.keyCode],l.indexOf(d)!==-1&&(this.keys[d]=!0))},onKeyUp:function(g){var d;d=g.code||u[g.keyCode],delete this.keys[d]}});function y(g){var d;for(d in g)return!1;return!0}},"./src/components/windows-motion-controls.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/utils/tracked-controls.js"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,a=w.onButtonEvent,f=A("./src/utils/index.js"),m=f.debug("components:windows-motion-controls:debug"),l=f.debug("components:windows-motion-controls:warn"),y=A("./src/constants/index.js").DEFAULT_HANDEDNESS,g=A("./src/constants/index.js").AFRAME_CDN_ROOT,d=g+"controllers/microsoft/",p={left:"left.glb",right:"right.glb",default:"universal.glb"},C=A("./src/utils/index.js").device.isWebXRAvailable,S="windows-mixed-reality",_="Spatial Controller (Spatial Interaction Source) ",L=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,T=C?S:_,N={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},F={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},te=C?F:N;W.exports.Component=u("windows-motion-controls",{schema:{hand:{default:y},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},after:["tracked-controls"],mapping:te,bindMethods:function(){this.onModelError=this.onModelError.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var K=this,se=this.el;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(ne){a(ne.detail.id,"down",K)},this.onButtonUp=function(ne){a(ne.detail.id,"up",K)},this.onButtonTouchStart=function(ne){a(ne.detail.id,"touchstart",K)},this.onButtonTouchEnd=function(ne){a(ne.detail.id,"touchend",K)},this.onControllerConnected=function(){K.setModelVisibility(!0)},this.onControllerDisconnected=function(){K.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},se.addEventListener("controllerconnected",this.onControllerConnected),se.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var K=this.el;K.addEventListener("buttonchanged",this.onButtonChanged),K.addEventListener("buttondown",this.onButtonDown),K.addEventListener("buttonup",this.onButtonUp),K.addEventListener("touchstart",this.onButtonTouchStart),K.addEventListener("touchend",this.onButtonTouchEnd),K.addEventListener("axismove",this.onAxisMoved),K.addEventListener("model-error",this.onModelError),K.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var K=this.el;K.removeEventListener("buttonchanged",this.onButtonChanged),K.removeEventListener("buttondown",this.onButtonDown),K.removeEventListener("buttonup",this.onButtonUp),K.removeEventListener("touchstart",this.onButtonTouchStart),K.removeEventListener("touchend",this.onButtonTouchEnd),K.removeEventListener("axismove",this.onAxisMoved),K.removeEventListener("model-error",this.onModelError),K.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){h(this,T,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var K=this.createControllerModelUrl();this.loadModel(K)},createControllerModelUrl:function(K){var se=this.el.components["tracked-controls"],ne=se?se.controller:null,re="default",Y=this.data.hand,k;if(ne&&!window.hasNativeWebXRImplementation&&(Y=ne.hand,!K)){var oe=ne.id.match(L);re=oe&&oe[0]||re}return k=p[Y]||p.default,d+re+"/"+k},injectTrackedControls:function(){var K=this.data;this.el.setAttribute("tracked-controls",{idPrefix:T,controller:K.pair,hand:K.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(K){var se=this.createControllerModelUrl(!0);K.detail.src!==se?(l("Failed to load controller model for device, attempting to load default."),this.loadModel(se)):l("Failed to load default controller model.")},loadModel:function(K){this.el.setAttribute("gltf-model","url("+K+")")},onModelLoaded:function(K){var se=this.controllerModel=K.detail.model,ne=this.loadedMeshInfo,re,Y,k,oe;if(K.target!==this.el)return;if(m("Processing model"),ne.buttonMeshes={},ne.axisMeshes={},se){for(re=0;re<this.mapping.buttons.length;re++){if(Y=this.mapping.buttonMeshNames[this.mapping.buttons[re]],!Y){m("Skipping unknown button at index: "+re+" with mapped name: "+this.mapping.buttons[re]);continue}if(k=se.getObjectByName(Y),!k){l("Missing button mesh with name: "+Y);continue}oe={index:re,value:ae(k,"VALUE"),pressed:ae(k,"PRESSED"),unpressed:ae(k,"UNPRESSED")},oe.value&&oe.pressed&&oe.unpressed?ne.buttonMeshes[this.mapping.buttons[re]]=oe:l("Missing button submesh under mesh with name: "+Y+"(VALUE: "+!!oe.value+", PRESSED: "+!!oe.pressed+", UNPRESSED:"+!!oe.unpressed+")")}for(re=0;re<this.mapping.axisMeshNames.length;re++){if(Y=this.mapping.axisMeshNames[re],!Y){m("Skipping unknown axis at index: "+re);continue}if(k=se.getObjectByName(Y),!k){l("Missing axis mesh with name: "+Y);continue}oe={index:re,value:ae(k,"VALUE"),min:ae(k,"MIN"),max:ae(k,"MAX")},oe.value&&oe.min&&oe.max?ne.axisMeshes[re]=oe:l("Missing axis submesh under mesh with name: "+Y+"(VALUE: "+!!oe.value+", MIN: "+!!oe.min+", MAX:"+!!oe.max+")")}this.calculateRayOriginFromMesh(se),this.setModelVisibility()}m("Model load complete.");function ae(Ae,b){for(var I=0,O=Ae.children.length;I<O;I++){var Q=Ae.children[I];if(Q&&Q.name===b)return Q}}},calculateRayOriginFromMesh:function(){var K=new THREE.Quaternion;return function(se){var ne;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,ne=se.getObjectByName(this.mapping.pointingPoseMeshName),ne){var re=se.parent;re&&(se.parent=null,se.updateMatrixWorld(!0),se.parent=re),ne.getWorldPosition(this.rayOrigin.origin),ne.getWorldQuaternion(K),this.rayOrigin.direction.applyQuaternion(K),re&&se.updateMatrixWorld(!0)}else m("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var K=new THREE.Quaternion;return function(se,ne){var re=this.loadedMeshInfo.axisMeshes[se];if(re){var Y=re.min,k=re.max,oe=re.value,ae=ne*.5+.5;oe.setRotationFromQuaternion(K.copy(Y.quaternion).slerp(k.quaternion,ae)),oe.position.lerpVectors(Y.position,k.position,ae)}}}(),lerpButtonTransform:function(){var K=new THREE.Quaternion;return function(se,ne){var re=this.loadedMeshInfo.buttonMeshes[se];if(re){var Y=re.unpressed,k=re.pressed,oe=re.value;oe.setRotationFromQuaternion(K.copy(Y.quaternion).slerp(k.quaternion,ne)),oe.position.lerpVectors(Y.position,k.position,ne)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(K){var se=this.mapping.buttons[K.detail.id];se&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(se,K.detail.state.value),this.el.emit(se+"changed",K.detail.state))},onAxisMoved:function(K){var se=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var ne=0;ne<se;ne++)this.lerpAxisTransform(ne,K.detail.axis[ne]||0);v(this,this.mapping.axes,K)},setModelVisibility:function(K){var se=this.el.getObject3D("mesh");this.controllerPresent&&(K=K!==void 0?K:this.modelVisible,this.modelVisible=K,se&&(se.visible=K))}})},"./src/constants/index.js":(W,$,A)=>{W.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:A("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":W=>{W.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},"./src/core/a-assets.js":(W,$,A)=>{var u=A("./src/core/a-node.js").ANode,w=A("./src/utils/debug.js"),h=A("./src/lib/three.js"),v=new h.FileLoader,a=w("core:a-assets:warn");class f extends u{constructor(){super(),this.isAssets=!0,this.fileLoader=v,this.timeout=null}doConnectedCallback(){var _=this,L,T=[],N,F,te,K,se,ne;if(super.doConnectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(K=this.querySelectorAll("img"),L=0;L<K.length;L++)te=y(K[L]),T.push(new Promise(function(re,Y){if(h.Cache.add(K[L].getAttribute("src"),te),te.complete){re();return}te.onload=re,te.onerror=Y}));for(F=this.querySelectorAll("audio, video"),L=0;L<F.length;L++)N=y(F[L]),!N.src&&!N.srcObject&&a("Audio/video asset has neither `src` nor `srcObject` attributes."),T.push(l(N));ne=this.getChildren(),ne.forEach(function(re){!re.isAssetItem||!re.hasAttribute("src")||T.push(new Promise(function(k,oe){if(re.hasLoaded)return k();re.addEventListener("loaded",k),re.addEventListener("error",oe)}))}),Promise.allSettled(T).then(function(){_.timeout!==null&&_.load()}),se=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){_.hasLoaded||(a("Asset loading timed out in",se,"ms"),_.timeout=null,_.emit("timeout"),_.load())},se)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(){return!1})}}customElements.define("a-assets",f);class m extends u{constructor(){super(),this.data=null,this.isAssetItem=!0}connectedCallback(){var _=this,L=this.getAttribute("src");v.setResponseType(this.getAttribute("response-type")||p(L)),v.load(L,function(N){_.data=N,u.prototype.load.call(_)},function(N){_.emit("progress",{loadedBytes:N.loaded,totalBytes:N.total,xhr:N})},function(N){_.emit("error",{xhr:N})})}}customElements.define("a-asset-item",m);function l(S){if(!(!S.hasAttribute("autoplay")&&S.getAttribute("preload")!=="auto"))return new Promise(function(_,L){if(S.readyState===4)return _();if(S.error)return L();S.addEventListener("loadeddata",T,!1),S.addEventListener("progress",T,!1),S.addEventListener("error",L,!1);function T(){for(var N=0,F=0;F<S.buffered.length;F++)N+=S.buffered.end(F)-S.buffered.start(F);N>=S.duration&&(S.tagName==="VIDEO"&&h.Cache.add(S.getAttribute("src"),S),_())}})}function y(S){var _=g(S);return _.tagName&&_.tagName.toLowerCase()==="video"&&(_.setAttribute("playsinline",""),_.setAttribute("webkit-playsinline","")),_!==S&&(S.parentNode.appendChild(_),S.parentNode.removeChild(S)),_}function g(S){var _,L;return S.hasAttribute("crossorigin")||(L=S.getAttribute("src"),L!==null&&(L.indexOf("://")===-1||d(L)===window.location.host))?S:(a('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',L),S.crossOrigin="anonymous",_=S.cloneNode(!0),_)}function d(S){var _=S.indexOf("://")>-1?S.split("/")[2]:S.split("/")[0];return _.substring(0,_.indexOf(":"))}function p(S){var _=C(S),L=_.lastIndexOf(".");if(L>=0){var T=_.slice(L,S.search(/\?|#|$/));if(T===".glb")return"arraybuffer"}return"text"}W.exports.inferResponseType=p;function C(S){var _=document.createElement("a");_.href=S;var L=_.search.replace(/^\?/,""),T=S.replace(L,"").replace("?","");return T.substring(T.lastIndexOf("/")+1)}W.exports.getFileNameFromURL=C},"./src/core/a-cubemap.js":(W,$,A)=>{var u=A("./src/utils/debug.js"),w=u("core:cubemap:warn");class h extends HTMLElement{constructor(a){return a=super(a),a}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}h.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var a=this.querySelectorAll("[src]"),f,m=[];if(a.length===6){for(f=0;f<a.length;f++)a[f].tagName==="IMG"?m.push(a[f]):m.push(a[f].getAttribute("src"));return m}w("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",h)},"./src/core/a-entity.js":(W,$,A)=>{var u=A("./src/core/a-node.js").ANode,w=A("./src/core/component.js").components,h=A("./src/lib/three.js"),v=A("./src/utils/index.js"),a=v.debug("core:a-entity:debug"),f=v.debug("core:a-entity:warn"),m="__",l=["position","rotation","scale","visible"],y={once:!0};class g extends u{constructor(){super(),this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new h.Group,this.object3D.rotation.order="YXZ",this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(T,N,F){var te=this.components[T];if(super.attributeChangedCallback(),te&&te.justInitialized&&F===""){delete te.justInitialized;return}!te&&F===null||this.setEntityAttribute(T,N,F)}doConnectedCallback(){var T=this,N,F;if(super.doConnectedCallback(),F=this.sceneEl,this.addToParent(),!this.isScene){if(!F){this.load();return}if(N=F.querySelector("a-assets"),N&&!N.hasLoaded){N.addEventListener("loaded",function(){T.load()});return}this.load()}}disconnectedCallback(){var T;if(this.parentEl){for(T in this.components)this.removeComponent(T,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(T){return this.object3DMap[T]}setObject3D(T,N){var F,te=this;if(!(N instanceof h.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");F=this.getObject3D(T),F&&this.object3D.remove(F),N.el=this,N.children.length&&N.traverse(function(se){se.el=te}),this.object3D.add(N),this.object3DMap[T]=N,this.emit("object3dset",{object:N,type:T})}removeObject3D(T){var N=this.getObject3D(T);if(!N){f("Tried to remove `Object3D` of type:",T,"which was not defined.");return}this.object3D.remove(N),delete this.object3DMap[T],this.emit("object3dremove",{type:T})}getOrCreateObject3D(T,N){var F=this.getObject3D(T);return!F&&N&&(F=new N,this.setObject3D(T,F)),f("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),F}add(T){if(!T.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(T.object3D),this.emit("child-attached",{el:T})}addToParent(){var T=this.parentEl=this.parentNode;!T||!T.add||this.attachedToParent||(T.add(this),this.attachedToParent=!0)}removeFromParent(){var T=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,T.emit("child-detached",{el:this})}load(){var T=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){T.parentEl&&(T.updateComponents(),(T.isScene||T.parentEl.isPlaying)&&T.play())})}remove(T){T?this.object3D.remove(T.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var T=this.children,N=[],F=0;F<T.length;F++){var te=T[F];te instanceof g&&N.push(te)}return N}initComponent(T,N,F){var te,K,se,ne,re;se=v.split(T,m),ne=se[0],K=se.length>2?se.slice(1).join("__"):se[1],w[ne]&&(re=d(this,T)||N!==void 0,!(!re&&!F)&&(T in this.components||(this.initComponentDependencies(ne),te=new w[ne].Component(this,N,K),this.isPlaying&&te.play(),this.hasAttribute(T)||(te.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,T,"")),a("Component initialized: %s",T))))}initComponentDependencies(T){var N=this,F=w[T],te,K;if(F&&(te=w[T].dependencies,!!te))for(K=0;K<te.length;K++)N.initComponent(te[K],window.HTMLElement.prototype.getAttribute.call(N,te[K])||void 0,!0)}removeComponent(T,N){var F;if(F=this.components[T],!!F){if(!F.initialized){this.addEventListener("componentinitialized",function te(K){K.detail.name===T&&(this.removeComponent(T,N),this.removeEventListener("componentinitialized",te))});return}F.pause(),F.remove(),N&&(F.destroy(),delete this.components[T],this.hasAttribute(T)&&window.HTMLElement.prototype.removeAttribute.call(this,T)),this.emit("componentremoved",F.evtDetail,!1)}}updateComponents(){var T,N,F,te,K=this.componentsToUpdate;if(!(!this.hasLoaded&&!this.isLoading)){for(F=0;F<this.mixinEls.length;F++)for(te in this.mixinEls[F].componentCache)S(te)&&(K[te]=!0);if(this.getExtraComponents){N=this.getExtraComponents();for(te in N)S(te)&&(K[te]=!0)}for(F=0;F<this.attributes.length;++F)te=this.attributes[F].name,l.indexOf(te)===-1&&S(te)&&(K[te]=!0);for(F=0;F<l.length;F++)te=l[F],this.hasAttribute(te)&&this.updateComponent(te,this.getDOMAttribute(te));for(te in K)T=C(this.getDOMAttribute(te),N&&N[te]),this.updateComponent(te,T),delete K[te]}}updateComponent(T,N,F){var te=this.components[T];if(te){if(N===null&&!d(this,T)){this.removeComponent(T,!0);return}te.updateProperties(N,F);return}this.initComponent(T,N,!1)}removeAttribute(T,N){var F=this.components[T];if(F&&N===void 0&&this.removeComponent(T,!0),F&&N!==void 0){F.resetProperty(N);return}T==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,T)}play(){var T,N,F;if(!(this.isPlaying||!this.hasLoaded&&!this.isLoading)){this.isPlaying=!0;for(F in this.components)this.components[F].play();for(T=this.getChildEntities(),N=0;N<T.length;N++)T[N].play();this.emit("play")}}pause(){var T,N,F;if(this.isPlaying){this.isPlaying=!1;for(F in this.components)this.components[F].pause();for(T=this.getChildEntities(),N=0;N<T.length;N++)T[N].pause();this.emit("pause")}}setEntityAttribute(T,N,F){if(w[T]||this.components[T]){this.updateComponent(T,F);return}if(T==="mixin"){if(F===this.computedMixinStr)return;this.mixinUpdate(F,N)}}mixinUpdate(T,N,F){var te=g.componentsUpdated,K,se,ne,re,Y=this;if(F||(N=N||this.getAttribute("mixin")),!this.hasLoaded){this.addEventListener("loaded-private",function(){Y.mixinUpdate(T,N,!0)},y);return}for(ne=this.updateMixins(T,N),te.length=0,re=0;re<this.mixinEls.length;re++)for(K in this.mixinEls[re].componentCache)te.indexOf(K)===-1&&(this.components[K]?this.components[K].handleMixinUpdate():this.initComponent(K,null),te.push(K));for(re=0;re<ne.oldMixinIds.length;re++)if(se=document.getElementById(ne.oldMixinIds[re]),!!se)for(K in se.componentCache)te.indexOf(K)===-1&&this.components[K]&&(this.getDOMAttribute(K)?this.components[K].handleMixinUpdate():this.removeComponent(K,!0))}setAttribute(T,N,F){var te=g.singlePropUpdate,K,se,ne,re,Y,k;if(re=T.indexOf(m),ne=re>0?T.substring(0,re):T,!w[ne]){T==="mixin"&&this.mixinUpdate(N),super.setAttribute.call(this,T,N);return}if(!this.components[T]&&this.hasAttribute(T)&&this.updateComponent(T,window.HTMLElement.prototype.getAttribute.call(this,T)),typeof F<"u"&&typeof N=="string"&&N.length>0&&typeof v.styleParser.parse(N)=="string"){for(k in te)delete te[k];K=te,K[N]=F,se=!1}else K=N,se=F===!0;this.updateComponent(T,K,se),Y=this.sceneEl&&this.sceneEl.getAttribute("debug"),Y&&this.components[T].flushToDOM()}flushToDOM(T){var N=this.components,F,te=this.children,K,se;for(se in N)N[se].flushToDOM();if(T)for(K=0;K<te.length;++K)F=te[K],F.flushToDOM&&F.flushToDOM(T)}getAttribute(T){var N;return T==="position"?this.object3D.position:T==="rotation"?_(this):T==="scale"?this.object3D.scale:T==="visible"?this.object3D.visible:(N=this.components[T],N?N.data:window.HTMLElement.prototype.getAttribute.call(this,T))}getDOMAttribute(T){var N=this.components[T];return N?N.attrValue:window.HTMLElement.prototype.getAttribute.call(this,T)}addState(T){this.is(T)||(this.states.push(T),this.emit("stateadded",T))}removeState(T){var N=this.states.indexOf(T);N!==-1&&(this.states.splice(N,1),this.emit("stateremoved",T))}is(T){return this.states.indexOf(T)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var T;if(this.parentNode){f("Entity can only be destroyed if detached from scenegraph.");return}for(T in this.components)this.components[T].destroy()}}function d(L,T){return L.components[T]&&L.components[T].attrValue?!0:p(T,L.mixinEls)}function p(L,T){var N,F=!1;for(N=0;N<T.length&&(F=T[N].hasAttribute(L),!F);++N);return F}function C(L,T){return T?T.constructor===Object?v.extend(T,v.styleParser.parse(L||{})):L||T:L}function S(L){return L.indexOf(m)!==-1&&(L=v.split(L,m)[0]),!!w[L]}function _(L){var T=h.MathUtils.radToDeg,N=L.object3D.rotation,F=L.rotationObj;return F.x=T(N.x),F.y=T(N.y),F.z=T(N.z),F}g.componentsUpdated=[],g.singlePropUpdate={},customElements.define("a-entity",g),W.exports.AEntity=g},"./src/core/a-mixin.js":(W,$,A)=>{var u=A("./src/core/a-node.js").ANode,w=A("./src/core/component.js").components,h=A("./src/utils/index.js"),v=h.styleParser,a="__";class f extends u{constructor(){super(),this.componentCache={},this.rawAttributeCache={},this.isMixin=!0}doConnectedCallback(){super.doConnectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(l,y,g){super.attributeChangedCallback(),this.cacheAttribute(l,g),this.updateEntities()}setAttribute(l,y){window.HTMLElement.prototype.setAttribute.call(this,l,y),this.cacheAttribute(l,y)}cacheAttribute(l,y){var g,d;d=h.split(l,a)[0],g=w[d],y===void 0&&(y=window.HTMLElement.prototype.getAttribute.call(this,l)),this.rawAttributeCache[l]=y,g&&(this.componentCache[l]=this.parseComponentAttrValue(g,y))}parseComponentAttrValue(l,y){var g;return typeof y!="string"?y:(l.isSingleProperty?(g=l.schema.parse(y),typeof g=="string"&&(g=y)):g=v.parse(y),g)}getAttribute(l){return this.componentCache[l]||window.HTMLElement.prototype.getAttribute.call(this,l)}cacheAttributes(){var l=this.attributes,y,g;for(g=0;g<l.length;g++)y=l[g].name,this.cacheAttribute(y)}updateEntities(){var l,y,g;if(this.sceneEl)for(y=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),g=0;g<y.length;g++)l=y[g],!(!l.hasLoaded||l.isMixin)&&l.mixinUpdate(this.id)}}customElements.define("a-mixin",f)},"./src/core/a-node.js":(W,$,A)=>{var u=A("./src/utils/index.js"),w=A("./src/core/readyState.js"),h=u.debug("core:a-node:warn"),v={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function a(m){return m.tagName.toLowerCase()in v||m.isNode}class f extends HTMLElement{constructor(){super(),this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}connectedCallback(){if(!w.canInitializeElements){document.addEventListener("aframeready",this.connectedCallback.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var l;this.sceneEl=this.closestScene(),this.sceneEl||h("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(l=this.getAttribute("mixin"),l&&this.updateMixins(l))}attributeChangedCallback(l,y,g){g!==this.computedMixinStr&&l==="mixin"&&!this.isMixin&&this.updateMixins(g,y)}closestScene(){for(var l=this;l&&!l.isScene;)l=l.parentElement;return l}closest(l){for(var y=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,g=this;g&&!y.call(g,l);)g=g.parentElement;return g}disconnectedCallback(){this.hasLoaded=!1}load(l,y){var g,d,p=this;this.hasLoaded||(y=y||a,g=this.getChildren(),d=g.filter(y).map(function(C){return new Promise(function(_,L){if(C.hasLoaded)return _();C.addEventListener("loaded",_),C.addEventListener("error",L)})}),Promise.allSettled(d).then(function(S){S.forEach(function(L){L.status==="rejected"&&h("Rendering scene with errors on node: ",L.reason.target)}),p.isLoading=!0,p.setupMutationObserver(),l&&l(),p.isLoading=!1,p.hasLoaded=!0,p.emit("loaded-private",void 0,!1),p.emit("loaded",void 0,!1)}))}setupMutationObserver(){var l=this,y={attributes:!0,attributeOldValue:!0},g=new MutationObserver(function(p){var C;for(C=0;C<p.length;C++)if(p[C].type==="attributes"){var S=p[C].attributeName,_=window.HTMLElement.prototype.getAttribute.call(l,S),L=p[C].oldValue;l.attributeChangedCallback(S,L,_)}});g.observe(this,y)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(l,y){var g=f.newMixinIdArray,d=f.oldMixinIdArray,p=f.mixinIds,C,S,_;for(g.length=0,d.length=0,S=l?u.split(l.trim(),/\s+/):g,_=y?u.split(y.trim(),/\s+/):d,p.newMixinIds=S,p.oldMixinIds=_,C=0;C<_.length;C++)S.indexOf(_[C])===-1&&this.unregisterMixin(_[C]);for(this.computedMixinStr="",this.mixinEls.length=0,C=0;C<S.length;C++)this.registerMixin(S[C]);return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),S.length===0&&window.HTMLElement.prototype.removeAttribute.call(this,"mixin"),p}registerMixin(l){var y,g,d,p=document.getElementById(l);if(!p){h("No mixin was found with id `%s`",l);return}if(d=p.getAttribute("mixin"),d)for(y=u.split(d.trim(),/\s+/),g=0;g<y.length;g++)this.registerMixin(y[g]);this.computedMixinStr=this.computedMixinStr+" "+p.id,this.mixinEls.push(p)}setAttribute(l,y){l==="mixin"&&this.updateMixins(y),window.HTMLElement.prototype.setAttribute.call(this,l,y)}unregisterMixin(l){var y,g=this.mixinEls,d;for(y=0;y<g.length;++y)if(d=g[y],l===d.id){g.splice(y,1);break}}emit(l,y,g,d){var p=f.evtData;g===void 0&&(g=!0),p.bubbles=!!g,p.detail=y,d&&(p=u.extend({},d,p)),this.dispatchEvent(new CustomEvent(l,p))}}f.evtData={},f.newMixinIdArray=[],f.oldMixinIdArray=[],f.mixinIds={},customElements.define("a-node",f),W.exports.ANode=f,W.exports.knownTags=v},"./src/core/component.js":(W,$,A)=>{var u=A("./src/core/schema.js"),w=A("./src/core/scene/scenes.js"),h=A("./src/core/system.js"),v=A("./src/utils/index.js"),a=W.exports.components={},f=u.parseProperty,m=u.process,l=u.isSingleProperty,y=u.stringifyProperties,g=u.stringifyProperty,d=v.styleParser,p=v.debug("core:component:warn"),C=document.currentScript,S=new RegExp("[A-Z]+"),_={},L=Object.freeze({}),T=[],N={get:function(k,oe){return k.getComputedPropertyValue(oe)},set:function(k,oe,ae){return oe in k.schema?k.recomputeProperty(oe,ae):ae!==void 0&&k.handleUnknownProperty(oe,ae),!0}},F=W.exports.Component=function(k,oe,ae){var Ae=this;if(this.sceneOnly&&!k.isScene)throw new Error("Component `"+this.name+"` can only be applied to <a-scene>");if(ae&&!this.multiple)throw new Error("Trying to initialize multiple components of type `"+this.name+"`. There can only be one component of this type per entity.");this.el=k,this.id=ae,this.attrName=this.name+(ae?"__"+ae:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=_[this.name];var b=this.events;this.events={},te(this,b),this.attrValue=void 0,this.isObjectBased?(this.data=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.data,this.schema),this.oldData=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.oldData,this.schema),this.attrValueProxy=new Proxy(this,N)):(this.data=void 0,this.oldData=void 0,this.attrValueProxy=void 0),this.deferUnknownPropertyWarnings=!!this.updateSchema,this.silenceUnknownPropertyWarnings=!1,this.throttledEmitComponentChanged=v.throttleLeadingAndTrailing(function(){k.emit("componentchanged",Ae.evtDetail,!1)},200),this.updateProperties(oe,!0)};F.prototype={schema:{},init:function(){},events:{},update:function(k){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},stringify:function(k){var oe=this.schema;return typeof k=="string"?k:this.isSingleProperty?g(k,oe):(k=y(k,oe),d.stringify(k))},flushToDOM:function(k){var oe=k?this.data:this.attrValue;oe!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(oe))},updateProperties:function(k,oe){var ae=this.el;this.updateData(k,oe),!(!ae.hasLoaded&&!ae.isLoading)&&(this.initialized?this.callUpdateHandler():this.initComponent())},initComponent:function(){var k=this.el,oe;k.initializingComponents[this.name]||(k.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete k.initializingComponents[this.name],oe=this.isObjectBased?L:void 0,this.dataChanged=!1,this.storeOldData(),this.update(oe),k.isPlaying&&this.play(),k.emit("componentinitialized",this.evtDetail,!1))},updateData:function(k,oe){if(this.isSingleProperty){this.recomputeProperty(void 0,k);return}oe?(v.objectPool.clearObject(this.attrValue),this.recomputeData(k),this.schemaChangeRequired=!!this.updateSchema):typeof k=="string"?d.parse(k,this.attrValueProxy):v.extend(this.attrValueProxy,k),this.updateSchemaIfNeeded(k)},updateSchemaIfNeeded:function(k){if(!this.schemaChangeRequired||!this.updateSchema){for(var oe=0;oe<T.length;oe++)p("Unknown property `"+T[oe]+"` for component `"+this.name+"`.");T.length=0;return}T.length=0,this.updateSchema(this.data),v.objectPool.removeUnusedKeys(this.data,this.schema),this.silenceUnknownPropertyWarnings=!0,this.recomputeData(k),this.silenceUnknownPropertyWarnings=!1,this.schemaChangeRequired=!1},callUpdateHandler:function(){if(!(!this.isPositionRotationScale&&!this.dataChanged)){this.dataChanged=!1;var k=this.oldData;this.oldDataInUse=!0,this.update(k),k!==this.oldData&&this.objectPool.recycle(k),this.oldDataInUse=!1,this.storeOldData(),this.throttledEmitComponentChanged()}},handleMixinUpdate:function(){this.recomputeData(),this.updateSchemaIfNeeded(),this.callUpdateHandler()},resetProperty:function(k){!this.isSingleProperty&&!(k in this.schema)||(k?this.attrValue[k]=void 0:(this.isObjectBased&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0),this.recomputeProperty(k,void 0),this.updateSchemaIfNeeded(),this.callUpdateHandler())},extendSchema:function(k){var oe;oe=v.extend({},a[this.name].schema),v.extend(oe,k),this.schema=m(oe),this.el.emit("schemachanged",this.evtDetail)},getComputedPropertyValue:function(k){var oe=this.el.mixinEls,ae=this.attrValue&&k?this.attrValue[k]:this.attrValue;if(ae!==void 0)return ae;for(var Ae=oe.length-1;Ae>=0;Ae--){var b=oe[Ae].getAttribute(this.attrName);if(!(b===null||k&&!(k in b)))return k?b[k]:b}var I=k?this.schema[k].default:this.schema.default;return I},recomputeProperty:function(k,oe){var ae=k?this.schema[k]:this.schema;if(oe!=null){this.attrValue===void 0&&this.isObjectBased&&(this.attrValue=this.objectPool.use());var Ae=k?this.attrValue[k]:this.attrValue;Ae=ae.isCacheable?f(oe,ae,Ae):oe,typeof Ae=="string"&&(Ae=oe===""?void 0:oe),k?this.attrValue[k]=Ae:this.attrValue=Ae}this.oldDataInUse&&(this.oldData=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.oldData,this.schema),this.storeOldData(),this.oldDataInUse=!1);var b=k?this.oldData[k]:this.oldData,I=k?this.data[k]:this.data,O=f(this.getComputedPropertyValue(k),ae,I);return ae.type==="array"&&!k&&(O=v.clone(O)),ae.equals(O,b)||(this.dataChanged=!0,ae.schemaChange&&(this.schemaChangeRequired=!0)),k?this.data[k]=O:this.data=O,O},handleUnknownProperty:function(k,oe){this.attrValue===void 0&&(this.attrValue=this.objectPool.use()),this.attrValue[k]=oe,this.silenceUnknownPropertyWarnings||(this.deferUnknownPropertyWarnings?T.push(k):this.silenceUnknownPropertyWarnings||p("Unknown property `"+k+"` for component `"+this.name+"`."))},storeOldData:function(){if(!this.isObjectBased){this.oldData=this.data;return}if(this.isSingleProperty){this.oldData=f(this.data,this.schema,this.oldData);return}var k;for(k in this.schema)this.data[k]!==void 0&&(this.data[k]&&typeof this.data[k]=="object"?this.oldData[k]=f(this.data[k],this.schema[k],this.oldData[k]):this.oldData[k]=this.data[k])},recomputeData:function(k){var oe;if(this.isSingleProperty){this.recomputeProperty(void 0,k);return}if(k&&typeof k=="object")for(oe in this.schema)this.attrValueProxy[oe]=k[oe];else for(oe in this.schema)this.attrValueProxy[oe]=void 0;typeof k=="string"&&d.parse(k,this.attrValueProxy);for(oe in this.attrValue)this.attrValue[oe]!==void 0&&T.indexOf(oe)!==-1&&(oe in this.schema||p("Unknown property `"+oe+"` for component `"+this.name+"`."))},eventsAttach:function(){var k;this.eventsDetach();for(k in this.events)this.el.addEventListener(k,this.events[k])},eventsDetach:function(){var k;for(k in this.events)this.el.removeEventListener(k,this.events[k])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.data),this.objectPool.recycle(this.oldData),this.attrValue=this.data=this.oldData=this.attrValueProxy=void 0}};function te(k,oe){var ae;for(ae in oe)k.events[ae]=oe[ae].bind(k)}if(window.debug)var K=W.exports.registrationOrderWarnings={};W.exports.registerComponent=function(k,oe){var ae,Ae={},b,I;if(document.currentScript&&document.currentScript!==C&&w.forEach(function(J){J.hasLoaded||document.currentScript.compareDocumentPosition(J)!==Node.DOCUMENT_POSITION_FOLLOWING&&(p("The component `"+k+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(K[k]=!0))}),S.test(k)===!0&&p("The component name `"+k+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+k.toLowerCase()+"`"),k.indexOf("__")!==-1)throw new Error("The component name `"+k+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(oe).forEach(function(Q){Ae[Q]={value:oe[Q],writable:!0}}),a[k])throw new Error("The component `"+k+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");ae=function(Q,J,ve){F.call(this,Q,J,ve)},ae.prototype=Object.create(F.prototype,Ae),ae.prototype.name=k,ae.prototype.isPositionRotationScale=k==="position"||k==="rotation"||k==="scale",ae.prototype.constructor=ae,ae.prototype.system=h&&h.systems[k],ae.prototype.play=re(ae.prototype.play),ae.prototype.pause=ne(ae.prototype.pause),b=v.extend(m(ae.prototype.schema,ae.prototype.name)),ae.prototype.isSingleProperty=I=l(ae.prototype.schema),ae.prototype.isObjectBased=!I||I&&(Y(b.default)||Y(f(void 0,b))),_[k]=v.objectPool.createPool(),a[k]={Component:ae,dependencies:ae.prototype.dependencies,before:ae.prototype.before,after:ae.prototype.after,isSingleProperty:ae.prototype.isSingleProperty,isObjectBased:ae.prototype.isObjectBased,multiple:ae.prototype.multiple,sceneOnly:ae.prototype.sceneOnly,name:k,schema:b,stringify:ae.prototype.stringify};for(var O=0;O<w.length;O++)w[O].emit("componentregistered",{name:k},!1);return ae};function se(k){return k.tick||k.tock}function ne(k){return function(){var ae=this.el.sceneEl;this.isPlaying&&(k.call(this),this.isPlaying=!1,this.eventsDetach(),se(this)&&ae.removeBehavior(this))}}function re(k){return function(){var ae=this.el.sceneEl,Ae=this.el.isPlaying&&!this.isPlaying;!this.initialized||!Ae||(k.call(this),this.isPlaying=!0,this.eventsAttach(),se(this)&&ae.addBehavior(this))}}function Y(k){return k&&k.constructor===Object&&!(k instanceof window.HTMLElement)}},"./src/core/geometry.js":(W,$,A)=>{var u=A("./src/core/schema.js"),w=u.process,h=W.exports.geometries={},v=W.exports.geometryNames=[],a=A("./src/lib/three.js"),f=W.exports.Geometry=function(){};f.prototype={schema:{},init:function(m){return this.geometry=new a.BufferGeometry,this.geometry},update:function(m){}},W.exports.registerGeometry=function(m,l){var y,g={};if(Object.keys(l).forEach(function(p){g[p]={value:l[p],writable:!0}}),h[m])throw new Error("The geometry `"+m+"` has been already registered");return y=function(){f.call(this)},y.prototype=Object.create(f.prototype,g),y.prototype.name=m,y.prototype.constructor=y,h[m]={Geometry:y,schema:w(y.prototype.schema)},v.push(m),y}},"./src/core/propertyTypes.js":(W,$,A)=>{var u=A("./src/utils/coordinates.js"),w=A("./node_modules/debug/src/browser.js"),h=w("core:propertyTypes:warn"),v=W.exports.propertyTypes={},a=/[,> .[\]:]/,f=/url\((.+)\)/;m("audio","",d),m("array",[],l,y,g),m("asset","",d),m("boolean",!1,_),m("color","#FFF"),m("int",0,L),m("number",0,T),m("map","",d),m("model","",d),m("selector",null,N,te,S,!1),m("selectorAll",null,F,K,g,!1),m("src","",se),m("string",""),m("time",0,L),m("vec2",{x:0,y:0},ne,u.stringify,u.equals),m("vec3",{x:0,y:0,z:0},ne,u.stringify,u.equals),m("vec4",{x:0,y:0,z:0,w:1},ne,u.stringify,u.equals);function m(k,oe,ae,Ae,b,I){if(k in v)throw new Error("Property type "+k+" is already registered.");v[k]={default:oe,parse:ae||p,stringify:Ae||C,equals:b||S,isCacheable:I!==!1}}W.exports.registerPropertyType=m;function l(k){if(Array.isArray(k))return k;if(!k||typeof k!="string")return[];return k.split(",").map(oe);function oe(ae){return ae.trim()}}function y(k){return k.join(", ")}function g(k,oe){if(!Array.isArray(k)||!Array.isArray(oe))return k===oe;if(k.length!==oe.length)return!1;for(var ae=0;ae<k.length;ae++)if(k[ae]!==oe[ae])return!1;return!0}function d(k){var oe,ae;if(typeof k!="string")return k;if(ae=k.match(f),ae)return ae[1];if(k.charAt(0)==="#"){if(oe=document.getElementById(k.substring(1)),oe)return oe.tagName==="CANVAS"||oe.tagName==="VIDEO"||oe.tagName==="IMG"?oe:oe.getAttribute("src");h('"'+k+'" asset not found.');return}return k}function p(k){return k}function C(k){return k===null?"null":k.toString()}function S(k,oe){return k===oe}function _(k){return k!=="false"&&k!==!1}function L(k){return parseInt(k,10)}function T(k){return parseFloat(k,10)}function N(k){return k?typeof k!="string"?k:k[0]==="#"&&!a.test(k)?document.getElementById(k.substring(1)):document.querySelector(k):null}function F(k){return k?typeof k!="string"?k:Array.prototype.slice.call(document.querySelectorAll(k),0):null}function te(k){return k.getAttribute?"#"+k.getAttribute("id"):C(k)}function K(k){return k instanceof Array?k.map(function(oe){return"#"+oe.getAttribute("id")}).join(", "):C(k)}function se(k){return h("`src` property type is deprecated. Use `asset` instead."),d(k)}function ne(k,oe,ae){return u.parse(k,oe,ae)}function re(k,oe){return k==="audio"&&typeof oe!="string"||k==="array"&&!Array.isArray(oe)||k==="asset"&&typeof oe!="string"||k==="boolean"&&typeof oe!="boolean"||k==="color"&&typeof oe!="string"||k==="int"&&typeof oe!="number"||k==="number"&&typeof oe!="number"||k==="map"&&typeof oe!="string"||k==="model"&&typeof oe!="string"||k==="selector"&&typeof oe!="string"&&oe!==null||k==="selectorAll"&&typeof oe!="string"&&oe!==null||k==="src"&&typeof oe!="string"||k==="string"&&typeof oe!="string"||k==="time"&&typeof oe!="number"?!1:k==="vec2"?Y(oe,2):k==="vec3"?Y(oe,3):k==="vec4"?Y(oe,4):!0}W.exports.isValidDefaultValue=re;function Y(k,oe){if(k===null)return!0;if(typeof k!="object"||Object.keys(k).length!==oe)return!1;var ae=k.x,Ae=k.y,b=k.z,I=k.w;return!(typeof ae!="number"||typeof Ae!="number"||oe>2&&typeof b!="number"||oe>3&&typeof I!="number")}W.exports.isValidDefaultCoordinate=Y},"./src/core/readyState.js":W=>{W.exports.canInitializeElements=!1;function $(){if(document.readyState==="complete"){A();return}document.addEventListener("readystatechange",function u(){document.readyState==="complete"&&(document.removeEventListener("readystatechange",u),A())})}W.exports.waitForDocumentReadyState=$;function A(){W.exports.canInitializeElements||(W.exports.canInitializeElements=!0,setTimeout(function(){document.dispatchEvent(new CustomEvent("aframeready"))}))}W.exports.emitReady=A},"./src/core/scene/a-scene.js":(W,$,A)=>{var u=A("./src/core/scene/metaTags.js").inject,w=A("./src/core/scene/wakelock.js"),h=A("./src/core/scene/loadingScreen.js"),v=A("./src/core/scene/scenes.js"),a=A("./src/core/system.js").systems,f=A("./src/core/component.js").components,m=A("./src/lib/three.js"),l=A("./src/utils/index.js"),y=l.debug("core:a-scene:warn"),g=A("./src/core/a-entity.js").AEntity,d=A("./src/core/a-node.js").ANode,p=A("./src/core/scene/postMessage.js"),C=l.device.isIOS(),S=l.device.isMobile(),_=l.device.isWebXRAvailable;C&&A("./src/utils/ios-orientationchange-blank-bug.js");class L extends g{constructor(){var Y;super(),Y=this,Y.clock=new m.Clock,Y.isIOS=C,Y.isMobile=S,Y.hasWebXR=_,Y.isAR=!1,Y.isScene=!0,Y.object3D=new m.Scene,Y.object3D.onAfterRender=function(k,oe,ae){Y.isPlaying&&Y.tock(Y.time,Y.delta,ae)},Y.resize=Y.resize.bind(Y),Y.render=Y.render.bind(Y),Y.systems={},Y.systemNames=[],Y.time=Y.delta=0,Y.usedOfferSession=!1,Y.componentOrder=[],Y.behaviors={},Y.hasLoaded=!1,Y.isPlaying=!1,Y.originalHTML=Y.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}doConnectedCallback(){var Y=this,k=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.doConnectedCallback(),ne(this),this.setupRenderer(),h.setup(this,F),this.resize(),k||this.addFullScreenStyles(),p(this),u(this),w(this),this.onVRPresentChangeBound=this.onVRPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){Y.enterVR()},this.exitVRBound=function(){Y.exitVR()},this.exitVRTrueBound=function(){Y.exitVR(!0)},this.pointerRestrictedBound=function(){Y.pointerRestricted()},this.pointerUnrestrictedBound=function(){Y.pointerUnrestricted()},Y.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){Y.attachedCallbackPostCamera()}),this.initSystems(),this.componentOrder=T(f,this.componentOrder),this.addEventListener("componentregistered",function(){Y.componentOrder=T(f,Y.componentOrder)}),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){Y.enterVR()})}attachedCallbackPostCamera(){var Y,k=this;window.addEventListener("load",Y),window.addEventListener("resize",function(){k.isIOS?setTimeout(k.resize,100):k.resize()}),this.play(),v.push(this)}initSystems(){var Y;this.initSystem("camera");for(Y in a)Y!=="camera"&&this.initSystem(Y)}initSystem(Y){this.systems[Y]||(this.systems[Y]=new a[Y](this),this.systemNames.push(Y))}disconnectedCallback(){var Y=v.indexOf(this);super.disconnectedCallback(),v.splice(Y,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(Y){var k,oe=this.behaviors[Y.name],ae;oe||(oe=this.behaviors[Y.name]={tick:{inUse:!1,array:[],markedForRemoval:[]},tock:{inUse:!1,array:[],markedForRemoval:[]}});for(ae in oe)if(Y[ae]){if(k=oe[ae],k.inUse){var Ae=k.markedForRemoval.indexOf(Y);Ae!==-1&&k.markedForRemoval.splice(Ae,1)}k.array.indexOf(Y)===-1&&k.array.push(Y)}}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return l.device.checkHeadsetConnected()}enterAR(){var Y;if(!this.hasWebXR)throw Y="Failed to enter AR mode, WebXR not supported.",new Error(Y);if(!l.device.checkARSupport())throw Y="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(Y);return this.enterVR(!0)}enterVR(Y,k){var oe=this,ae,Ae=oe.renderer.xr,b;if(k&&(!navigator.xr||!navigator.xr.offerSession))return Promise.resolve("OfferSession is not supported.");if(oe.usedOfferSession&&k)return Promise.resolve("OfferSession was already called.");if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var I=oe.getAttribute("renderer");if(Ae.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var O=this.sceneEl.systems.webxr.sessionReferenceSpaceType;Ae.setReferenceSpaceType(O);var Q=Y?"immersive-ar":"immersive-vr";return b=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(_e,Ze){var qe=k?navigator.xr.offerSession.bind(navigator.xr):navigator.xr.requestSession.bind(navigator.xr);oe.usedOfferSession|=k,qe(Q,b).then(function(Et){k&&(oe.usedOfferSession=!1),Ae.layersEnabled=b.requiredFeatures.indexOf("layers")!==-1,Ae.setSession(Et).then(function(){Ae.setFoveation(I.foveationLevel),oe.xrSession=Et,oe.systems.renderer.setWebXRFrameRate(Et),Et.addEventListener("end",oe.exitVRBound),ve(_e)})},function(Et){var Bt=Q==="immersive-ar",kt=Bt?"AR":"VR";Ze(new Error("Failed to enter "+kt+" mode (`requestSession`)",{cause:Et}))})})}else{if(ae=l.device.getVRDisplay(),Ae.setDevice(ae),ae.isPresenting&&!window.hasNativeWebVRImplementation)return ve(),Promise.resolve();var J={highRefreshRate:I.highRefreshRate};return ae.requestPresent([{source:this.canvas,attributes:J}]).then(ve,Le)}}return ve(),Promise.resolve();function ve(_e){var Ze;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(Ze=new CustomEvent("vrdisplaypresentchange",{detail:{display:l.device.getVRDisplay()}}),window.dispatchEvent(Ze)),Y?oe.addState("ar-mode"):oe.addState("vr-mode"),oe.emit("enter-vr",{target:oe}),!oe.hasWebXR&&oe.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),oe.addFullScreenStyles(),!oe.isMobile&&!oe.checkHeadsetConnected()&&K(oe.canvas),oe.resize(),_e&&_e()}function Le(_e){throw oe.removeState("vr-mode"),_e&&_e.message?new Error("Failed to enter VR mode (`requestPresent`): "+_e.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var Y=this,k,oe=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(oe.enabled=!1,k=l.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(k.isPresenting)return k.exitPresent().then(ae,Ae)}else se();return ae(),Promise.resolve();function ae(){Y.removeState("vr-mode"),Y.removeState("ar-mode"),Y.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),Y.hasAttribute("embedded")&&Y.removeFullScreenStyles(),Y.resize(),Y.isIOS&&l.forceCanvasResizeSafariMobile(Y.canvas),Y.renderer.setPixelRatio(window.devicePixelRatio),Y.emit("exit-vr",{target:Y})}function Ae(b){throw b&&b.message?new Error("Failed to exit VR mode (`exitPresent`): "+b.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var Y=this.getPointerLockElement();Y&&Y!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var Y=this.getPointerLockElement();Y&&Y===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(Y){var k=Y.display||Y.detail.display;if(k&&k.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(Y){var k=this.systems[Y];return k?k.data:g.prototype.getAttribute.call(this,Y)}getDOMAttribute(Y){var k=this.systems[Y];return k?k.data:g.prototype.getDOMAttribute.call(this,Y)}setAttribute(Y,k,oe){if(a[Y]){d.prototype.setAttribute.call(this,Y,k);var ae=this.systems[Y];ae&&ae.updateProperties(k);return}g.prototype.setAttribute.call(this,Y,k,oe)}removeBehavior(Y){var k,oe,ae=this.behaviors[Y.name],Ae;for(oe in ae)Y[oe]&&(k=ae[oe],Ae=k.array.indexOf(Y),Ae!==-1&&(k.inUse?k.markedForRemoval.indexOf(Y)===-1&&k.markedForRemoval.push(Y):(k.array[Ae]=k.array[k.array.length-1],k.array.pop())))}resize(){var Y=this.camera,k=this.canvas,oe,ae,Ae,b=this.renderer.xr.isPresenting;ae=this.renderer.xr.enabled&&b,!(!Y||!k||this.is("vr-mode")&&(this.isMobile||ae))&&(oe=this.getAttribute("embedded")&&!this.is("vr-mode"),Ae=F(k,oe,this.maxCanvasSize,this.is("vr-mode")),Y.aspect=Ae.width/Ae.height,Y.updateProjectionMatrix(),this.renderer.setSize(Ae.width,Ae.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var Y=this,k,oe,ae,Ae;Ae={alpha:!0,antialias:!S,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:-1,width:-1},this.hasAttribute("renderer")&&(ae=this.getAttribute("renderer"),oe=l.styleParser.parse(ae),oe.precision&&(Ae.precision=oe.precision+"p"),oe.antialias&&oe.antialias!=="auto"&&(Ae.antialias=oe.antialias==="true"),oe.logarithmicDepthBuffer&&oe.logarithmicDepthBuffer!=="auto"&&(Ae.logarithmicDepthBuffer=oe.logarithmicDepthBuffer==="true"),oe.alpha&&(Ae.alpha=oe.alpha==="true"),oe.stencil&&(Ae.stencil=oe.stencil==="true"),oe.multiviewStereo&&(Ae.multiviewStereo=oe.multiviewStereo==="true"),this.maxCanvasSize={width:oe.maxCanvasWidth?parseInt(oe.maxCanvasWidth):this.maxCanvasSize.width,height:oe.maxCanvasHeight?parseInt(oe.maxCanvasHeight):this.maxCanvasSize.height}),k=this.renderer=new m.WebGLRenderer(Ae),k.setPixelRatio(window.devicePixelRatio),this.camera&&k.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){k.xr.setPoseTarget(Y.camera.el.object3D)})}play(){var Y=this,k=this;if(this.renderStarted){g.prototype.play.call(this);return}this.addEventListener("loaded",function(){var oe=this.renderer,ae,Ae=this.renderer.xr;g.prototype.play.call(this),!k.renderStarted&&(k.resize(),k.renderer&&(window.performance&&window.performance.mark("render-started"),h.remove(),ae=l.device.getVRDisplay(),ae&&ae.isPresenting&&(Ae.setDevice(ae),Ae.enabled=!0,k.enterVR()),oe.setAnimationLoop(this.render),k.renderStarted=!0,k.emit("renderstart")))}),setTimeout(function(){g.prototype.load.call(Y)})}updateComponent(Y){Y in a||g.prototype.updateComponent.apply(this,arguments)}tick(Y,k){var oe,ae=this.systems;for(this.callComponentBehaviors("tick",Y,k),oe=0;oe<this.systemNames.length;oe++)ae[this.systemNames[oe]].tick&&ae[this.systemNames[oe]].tick(Y,k)}tock(Y,k,oe){var ae,Ae=this.systems;for(this.callComponentBehaviors("tock",Y,k),ae=0;ae<this.systemNames.length;ae++)Ae[this.systemNames[ae]].tock&&Ae[this.systemNames[ae]].tock(Y,k,oe)}render(Y,k){var oe=this.renderer;this.frame=k,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var ae=null;this.is("ar-mode")&&(ae=this.object3D.background,this.object3D.background=null),oe.render(this.object3D,this.camera),ae&&(this.object3D.background=ae)}callComponentBehaviors(Y,k,oe){for(var ae,Ae=0;Ae<this.componentOrder.length;Ae++){var b=this.behaviors[this.componentOrder[Ae]];if(b){var I=b[Y];for(I.inUse=!0,ae=0;ae<I.array.length;ae++)I.array[ae].isPlaying&&I.array[ae][Y](k,oe);for(I.inUse=!1,ae=0;ae<I.markedForRemoval.length;ae++)this.removeBehavior(I.markedForRemoval[ae]);I.markedForRemoval.length=0}}}}function T(re,Y){var k={},oe,ae,Ae=Y||[];Ae.length=0;for(ae in re){var b=re[ae];if(b!==void 0){var I=b.before?b.before.slice(0):[],O=b.after?b.after.slice(0):[];k[ae]={before:I,after:O,visited:!1,done:!1}}}for(ae in k)for(oe=0;oe<k[ae].before.length;oe++){var Q=k[ae].before[oe];if(!(Q in k)){y("Invalid ordering constraint, no component named `"+Q+"` referenced by `"+ae+"`");continue}k[Q].after.push(ae)}function J(ve){if(!(!(ve in k)||k[ve].done)){if(k[ve].visited){y("Cycle detected, ignoring one or more before/after constraints. The resulting order might be incorrect");return}k[ve].visited=!0;for(var Le=0;Le<k[ve].after.length;Le++){var _e=k[ve].after[Le];_e in k||y("Invalid before/after constraint, no component named `"+_e+"` referenced in `"+ve+"`"),J(_e)}k[ve].done=!0,Ae.push(ve)}}for(ae in k)k[ae].done||J(ae);return Ae}W.exports.determineComponentBehaviorOrder=T;function N(re,Y){var k,oe=window.devicePixelRatio;return!Y||Y.width===-1&&Y.height===-1||re.width*oe<Y.width&&re.height*oe<Y.height||(k=re.width/re.height,re.width*oe>Y.width&&Y.width!==-1&&(re.width=Math.round(Y.width/oe),re.height=Math.round(Y.width/k/oe)),re.height*oe>Y.height&&Y.height!==-1&&(re.height=Math.round(Y.height/oe),re.width=Math.round(Y.height*k/oe))),re}customElements.define("a-scene",L);function F(re,Y,k,oe){if(!re.parentElement)return{height:0,width:0};if(Y){var ae;return ae={height:re.parentElement.offsetHeight,width:re.parentElement.offsetWidth},N(ae,k)}return te(k,oe)}function te(re,Y){var k;return k={height:document.body.offsetHeight,width:document.body.offsetWidth},Y?k:N(k,re)}function K(re){var Y=re.requestFullscreen||re.webkitRequestFullscreen||re.mozRequestFullScreen||re.msRequestFullscreen;Y.apply(re,[{navigationUI:"hide"}])}function se(){var re=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;re&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function ne(re){var Y;Y=document.createElement("canvas"),Y.classList.add("a-canvas"),Y.dataset.aframeCanvas=!0,re.appendChild(Y),document.addEventListener("fullscreenchange",k),document.addEventListener("mozfullscreenchange",k),document.addEventListener("webkitfullscreenchange",k),document.addEventListener("MSFullscreenChange",k),Y.addEventListener("touchmove",function(oe){oe.preventDefault()},{passive:!1}),re.canvas=Y,re.emit("render-target-loaded",{target:Y}),setTimeout(re.resize.bind(re),0);function k(){var oe=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;oe||re.exitVR(),document.activeElement.blur(),document.body.focus()}}W.exports.setupCanvas=ne,W.exports.AScene=L},"./src/core/scene/loadingScreen.js":(W,$,A)=>{var u=A("./src/utils/index.js"),w=u.styleParser,h,v,a,f="loading-screen",m="a-loader-title";W.exports.setup=function(d,p){h=d,a=p;var C=h.hasAttribute(f)?w.parse(h.getAttribute(f)):void 0,S=C&&C.dotsColor||"white",_=C&&C.backgroundColor||"#24CAFF",L=C===void 0||C.enabled==="true"||C.enabled===void 0,T,N,F,te,K,se,ne,re,Y,k;L&&(T=new THREE.Scene,N=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),F=new THREE.MeshBasicMaterial({color:S}),te=new THREE.Mesh(N,F),K=te.clone(),se=te.clone(),ne=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),re=new THREE.Clock,Y=0,k=function(){h.renderer.render(T,ne),Y=re.getElapsedTime()%4,te.visible=Y>=1,K.visible=Y>=2,se.visible=Y>=3},T.background=new THREE.Color(_),T.add(ne),te.position.set(-1,0,-15),K.position.set(0,0,-15),se.position.set(1,0,-15),ne.add(te),ne.add(K),ne.add(se),y(),setTimeout(function(){h.hasLoaded||(l(ne),v.style.display="block",window.addEventListener("resize",function(){l(ne)}),h.renderer.setAnimationLoop(k))},200))},W.exports.remove=function(){window.removeEventListener("resize",l),v&&(v.style.display="none")};function l(g){var d=h.hasAttribute("embedded"),p=a(h.canvas,d,h.maxCanvasSize,h.is("vr-mode"));g.aspect=p.width/p.height,g.updateProjectionMatrix(),h.renderer.setSize(p.width,p.height,!1)}function y(){v=document.createElement("div"),v.className=m,v.innerHTML=document.title,v.style.display="none",h.appendChild(v)}},"./src/core/scene/metaTags.js":(W,$,A)=>{var u=A("./src/constants/index.js"),w=A("./src/utils/index.js").extend,h=W.exports.MOBILE_HEAD_TAGS=[a({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),a({name:"mobile-web-app-capable",content:"yes"}),a({name:"theme-color",content:"black"})],v=[a({name:"apple-mobile-web-app-capable",content:"yes"}),a({name:"apple-mobile-web-app-status-bar-style",content:"black"}),f({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function a(l){return{tagName:"meta",attributes:l,exists:function(){return document.querySelector('meta[name="'+l.name+'"]')}}}function f(l){return{tagName:"link",attributes:l,exists:function(){return document.querySelector('link[rel="'+l.rel+'"]')}}}W.exports.inject=function(y){var g=document.head,d=g.querySelector("script"),p,C=[];return h.forEach(S),y.isIOS&&v.forEach(S),C;function S(_){!_||_.exists()||(p=m(_),p&&(d?d.parentNode.insertBefore(p,d):g.appendChild(p),C.push(p)))}};function m(l){if(!(!l||!l.tagName)){var y=document.createElement(l.tagName);return y.setAttribute(u.AFRAME_INJECTED,""),w(y,l.attributes)}}},"./src/core/scene/postMessage.js":(W,$,A)=>{var u=A("./src/utils/index.js").isIframed;W.exports=function(v){u()&&window.addEventListener("message",w.bind(v))};function w(h){var v=this;if(h.data)switch(h.data.type){case"vr":switch(h.data.data){case"enter":v.enterVR();break;case"exit":v.exitVR();break}}}},"./src/core/scene/scenes.js":W=>{W.exports=[]},"./src/core/scene/wakelock.js":(W,$,A)=>{var u=A("./vendor/wakelock/wakelock.js");W.exports=function(h){if(h.isMobile){var v=h.wakelock=new u;h.addEventListener("enter-vr",function(){v.request()}),h.addEventListener("exit-vr",function(){v.release()})}}},"./src/core/schema.js":(W,$,A)=>{var u=A("./src/utils/index.js"),w=A("./src/core/propertyTypes.js"),h=u.debug,v=w.isValidDefaultValue,a=w.propertyTypes,f=h("core:schema:warn");function m(d){return"type"in d?typeof d.type=="string":"default"in d}W.exports.isSingleProperty=m,W.exports.process=function(d,p){var C;if(m(d))return l(d,p);for(C in d)d[C]=l(d[C],p);return d};function l(d,p){var C=d.default,S,_,L=d.type;return d.type?d.type==="bool"?L="boolean":d.type==="float"&&(L="number"):C!==void 0&&(typeof C=="boolean"||typeof C=="number")?L=typeof C:Array.isArray(C)?L="array":L="string",_=a[L],_||f("Unknown property type for component `"+p+"`: "+L),S=!!d.parse,d.parse=d.parse||_.parse,d.stringify=d.stringify||_.stringify,d.equals=d.equals||_.equals,d.isCacheable=d.isCacheable===!0||_.isCacheable,d.type=L,"default"in d?!S&&!v(L,C)&&f("Default value `"+C+"` does not match type `"+L+"` in component `"+p+"`"):d.default=_.default,d}W.exports.processPropertyDefinition=l,W.exports.parseProperties=function(){var d=[];return function(p,C,S,_,L){var T,N,F,te;d.length=0;for(N in S?p:C)S&&p[N]===void 0||d.push(N);if(p===null||typeof p!="object")return p;for(N in p)p[N]!==void 0&&!C[N]&&!L&&f("Unknown property `"+N+"` for component/system `"+_+"`.");for(T=0;T<d.length;T++){if(N=d[T],F=C[N],te=p[N],!C[N])return;p[N]=y(te,F)}return p}}();function y(d,p,C){return(d==null||d==="")&&(d=p.default,Array.isArray(d)&&(d=d.slice())),p.parse(d,p.default,C)}W.exports.parseProperty=y,W.exports.stringifyProperties=function(d,p){var C,S,_,L={},T;for(C in d)S=p[C],_=d[C],T=_,typeof T=="object"&&(T=g(_,S),S||f("Unknown component property: "+C)),L[C]=T;return L};function g(d,p){return typeof d!="object"?d:!p||d===null?JSON.stringify(d):p.stringify(d)}W.exports.stringifyProperty=g},"./src/core/shader.js":(W,$,A)=>{var u=A("./src/core/schema.js"),w=u.process,h=W.exports.shaders={},v=W.exports.shaderNames=[],a=A("./src/lib/three.js"),f=A("./src/utils/index.js"),m={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},l=W.exports.Shader=function(){};l.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(y){return this.uniforms=this.initUniforms(),this.material=new(this.raw?a.RawShaderMaterial:a.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw||this.glsl3?a.GLSL3:null,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initUniforms:function(){var y,g=this.schema,d={},p;for(y in g)g[y].is==="uniform"&&(p=m[g[y].type],d[y]={type:p,value:void 0});return d},update:function(y){var g,d,p=this.schema,C=this.uniforms;for(g in y)if(!(!p[g]||p[g].is!=="uniform")){if(p[g].type==="map"){if(!C[g]||C[g].value===y[g])continue;d="_texture_"+g,this.setMapOnTextureLoad(C,g,d),f.material.updateMapMaterialFromData(d,g,this,y);continue}C[g].value=this.parseValue(p[g].type,y[g]),C[g].needsUpdate=!0}},parseValue:function(y,g){var d;switch(y){case"vec2":return new a.Vector2(g.x,g.y);case"vec3":return new a.Vector3(g.x,g.y,g.z);case"vec4":return new a.Vector4(g.x,g.y,g.z,g.w);case"color":return d=new a.Color(g),new a.Vector3(d.r,d.g,d.b);default:return g}},setMapOnTextureLoad:function(y,g,d){var p=this;this.el.addEventListener("materialtextureloaded",function(){y[g].value=p.material[d],y[g].needsUpdate=!0})}},W.exports.registerShader=function(y,g){var d,p={};if(Object.keys(g).forEach(function(C){p[C]={value:g[C],writable:!0}}),h[y])throw new Error("The shader "+y+" has already been registered");return d=function(){l.call(this)},d.prototype=Object.create(l.prototype,p),d.prototype.name=y,d.prototype.constructor=d,h[y]={Shader:d,schema:w(d.prototype.schema)},v.push(y),d}},"./src/core/system.js":(W,$,A)=>{var u=A("./src/core/component.js"),w=A("./src/core/schema.js"),h=A("./src/utils/index.js"),v=A("./src/core/readyState.js"),a=w.parseProperties,f=w.parseProperty,m=w.process,l=w.isSingleProperty,y=h.styleParser,g=W.exports.systems={},d=W.exports.System=function(p){var C=u&&u.components[this.name];this.el=p,this.sceneEl=p,C&&(C.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};d.prototype={schema:{},init:function(){},update:function(p){},updateProperties:function(p){var C=this.data;Object.keys(w).length&&(this.buildData(p),this.update(C))},buildData:function(p){var C=this.schema;Object.keys(C).length&&(p=p||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),l(C)?this.data=f(p,C):this.data=a(y.parse(p)||{},C,!1,this.name))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},W.exports.registerSystem=function(p,C){var S,_,L={},T=h.findAllScenes(document);if(Object.keys(C).forEach(function(N){L[N]={value:C[N],writable:!0}}),g[p])throw new Error("The system `"+p+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");if(_=function(N){d.call(this,N)},_.prototype=Object.create(d.prototype,L),_.prototype.name=p,_.prototype.constructor=_,_.prototype.schema=h.extend(m(_.prototype.schema)),g[p]=_,v.canInitializeElements)for(S=0;S<T.length;S++)T[S].initSystem(p)}},"./src/extras/components/index.js":(W,$,A)=>{A("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(W,$,A)=>{var u=A("./src/core/component.js").registerComponent,w=A("./src/lib/three.js"),h=new w.Vector3,v=new w.Vector3;u("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var a=this.data,f=this.el,m=f.object3D.parent,l=f.object3D,y=new w.Group;h.copy(l.position),v.copy(l.rotation),m.remove(l),y.add(l),m.add(y),f.object3D=y,l.position.set(-1*a.x,-1*a.y,-1*a.z),y.position.set(a.x+h.x,a.y+h.y,a.z+h.z),y.rotation.copy(l.rotation),l.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(W,$,A)=>{var u=A("./src/core/component.js").components,w=A("./src/core/shader.js").shaders,h=A("./src/utils/index.js"),v={};Object.keys(u.material.schema).forEach(a),Object.keys(w.standard.schema).forEach(a);function a(f){var m=f.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();f==="fog"&&(m="material-fog"),f==="visible"&&(m="material-visible"),v[m]="material."+f}W.exports=function(){return{defaultComponents:{material:{}},mappings:h.extend({},v)}}},"./src/extras/primitives/index.js":(W,$,A)=>{A("./src/extras/primitives/primitives/a-camera.js"),A("./src/extras/primitives/primitives/a-cursor.js"),A("./src/extras/primitives/primitives/a-curvedimage.js"),A("./src/extras/primitives/primitives/a-gltf-model.js"),A("./src/extras/primitives/primitives/a-image.js"),A("./src/extras/primitives/primitives/a-light.js"),A("./src/extras/primitives/primitives/a-link.js"),A("./src/extras/primitives/primitives/a-obj-model.js"),A("./src/extras/primitives/primitives/a-sky.js"),A("./src/extras/primitives/primitives/a-sound.js"),A("./src/extras/primitives/primitives/a-text.js"),A("./src/extras/primitives/primitives/a-video.js"),A("./src/extras/primitives/primitives/a-videosphere.js"),A("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(W,$,A)=>{var u=A("./src/core/a-node.js").knownTags,w=A("./src/core/a-entity.js").AEntity,h=A("./src/core/component.js").components,v=A("./src/utils/index.js"),a=v.debug,f=v.entity.setComponentProperty,m=a("extras:primitives:debug"),l=a("extras:primitives:warn"),y=a("extras:primitives:error"),g=W.exports.primitives={};W.exports.registerPrimitive=function(_,L){if(_=_.toLowerCase(),u[_]){y("Trying to register primitive "+_+" that has been already previously registered");return}u[_]=!0,m("Registering <%s>",_),L.defaultAttributes&&l("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var T=L.mappings||{},N=class extends w{constructor(){super(),this.defaultComponentsFromPrimitive=L.defaultComponents||L.defaultAttributes||{},this.deprecated=L.deprecated||null,this.deprecatedMappings=L.deprecatedMappings||{},this.mappings=T,L.deprecated&&console.warn(L.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var F=this.mappings,te=this;Object.keys(F).forEach(function(se){var ne;se!==se.toLowerCase()&&l("Mapping keys should be specified in lower case. The mapping key "+se+" may not be recognized"),h[se]&&(ne=F[se].replace(".","-"),F[ne]=F[se],delete F[se],console.warn("The primitive "+te.tagName.toLowerCase()+" has a mapping collision. The attribute "+se+" has the same name as a registered component and has been renamed to "+ne))})}getExtraComponents(){var F,te,K,se,ne,re=this;for(te=v.clone(this.defaultComponentsFromPrimitive),ne=this.getAttribute("mixin"),ne&&(ne=v.split(ne.trim(),/\s+/),ne.forEach(function(b){var I=document.getElementById(b);if(I){var O=I.rawAttributeCache,Q=I.componentCache;for(var J in O){if(se=re.mappings[J],se){d(se,O[J],te);return}J in Q&&(te[J]=Y(te[J],Q[J]))}}})),K=0;K<this.attributes.length;K++)F=this.attributes[K],se=this.mappings[F.name],se&&d(se,F.value,te);return te;function Y(Ae,b){return k(Ae)?oe(b):k(b)?oe(Ae):ae(Ae)&&ae(b)?v.extendDeep(Ae,b):oe(b)}function k(Ae){return typeof Ae>"u"}function oe(Ae){return ae(Ae)?v.extendDeep({},Ae):Ae}function ae(Ae){return Ae!==null&&Ae.constructor===Object}}attributeChangedCallback(F,te,K){var se=this.mappings[F];if(F in this.deprecatedMappings&&console.warn(this.deprecatedMappings[F]),!F||!se){super.attributeChangedCallback(F,te,K);return}f(this,se,K)}};return customElements.define(_,N),N.mappings=T,g[_]=N,N};function d(S,_,L){var T=v.entity.getComponentPropertyPath(S);T.constructor===Array?(L[T[0]]=L[T[0]]||{},L[T[0]][T[1]]=_.trim()):L[T]=_.trim()}function p(S,_){var L=h[S].schema;Object.keys(L).map(function(T){var N=T.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();_[N]!==void 0&&(N=S+"-"+T),_[N]=S+"."+T})}function C(S,_,L){L=L||{},Object.keys(_).map(function(N){p(N,L)}),W.exports.registerPrimitive(S,v.extendDeep({},null,{defaultComponents:_,mappings:L}))}W.exports.definePrimitive=C},"./src/extras/primitives/primitives/a-camera.js":(W,$,A)=>{var u=A("./src/extras/primitives/primitives.js").registerPrimitive;u("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js"),w=A("./src/extras/primitives/primitives.js").registerPrimitive,h=A("./src/utils/index.js");w("a-cursor",h.extendDeep({},u(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js"),w=A("./src/extras/primitives/primitives.js").registerPrimitive,h=A("./src/utils/index.js");w("a-curvedimage",h.extendDeep({},u(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(W,$,A)=>{var u=A("./src/extras/primitives/primitives.js").registerPrimitive;u("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js"),w=A("./src/extras/primitives/primitives.js").registerPrimitive,h=A("./src/utils/index.js");w("a-image",h.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(W,$,A)=>{var u=A("./src/extras/primitives/primitives.js").registerPrimitive;u("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(W,$,A)=>{var u=A("./src/extras/primitives/primitives.js").registerPrimitive;u("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js")(),w=A("./src/extras/primitives/primitives.js").registerPrimitive,h=A("./src/utils/index.js");w("a-obj-model",h.extendDeep({},u,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js"),w=A("./src/extras/primitives/primitives.js").registerPrimitive,h=A("./src/utils/index.js"),v=A("./src/extras/primitives/primitives/meshPrimitives.js");w("a-sky",h.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:h.extendDeep({},v["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(W,$,A)=>{var u=A("./src/extras/primitives/primitives.js").registerPrimitive;u("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(W,$,A)=>{var u=A("./src/extras/primitives/primitives.js").definePrimitive;u("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js"),w=A("./src/extras/primitives/primitives.js").registerPrimitive,h=A("./src/utils/index.js");w("a-video",h.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js"),w=A("./src/extras/primitives/primitives.js").registerPrimitive,h=A("./src/utils/index.js");w("a-videosphere",h.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(W,$,A)=>{var u=A("./src/extras/primitives/getMeshMixin.js"),w=A("./src/core/geometry.js").geometries,h=A("./src/core/geometry.js").geometryNames,v=A("./src/extras/primitives/primitives.js").registerPrimitive,a=A("./src/utils/index.js"),f=W.exports={};h.forEach(function(y){var g=w[y],d=m(y),p={};Object.keys(g.schema).forEach(function(L){p[m(L)]="geometry."+L});var C="a-"+d,S=v(C,a.extendDeep({},u(),{defaultComponents:{geometry:{primitive:y}},mappings:p}));f[C]=S});function m(l){return l.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js");u("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(h){this.geometry=new w.BoxGeometry(h.width,h.height,h.depth,h.segmentsWidth,h.segmentsHeight,h.segmentsDepth)}})},"./src/geometries/circle.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js"),h=w.MathUtils.degToRad;u("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new w.CircleGeometry(v.radius,v.segments,h(v.thetaStart),h(v.thetaLength))}})},"./src/geometries/cone.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js"),h=w.MathUtils.degToRad;u("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new w.CylinderGeometry(v.radiusTop,v.radiusBottom,v.height,v.segmentsRadial,v.segmentsHeight,v.openEnded,h(v.thetaStart),h(v.thetaLength))}})},"./src/geometries/cylinder.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js"),h=w.MathUtils.degToRad;u("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new w.CylinderGeometry(v.radius,v.radius,v.height,v.segmentsRadial,v.segmentsHeight,v.openEnded,h(v.thetaStart),h(v.thetaLength))}})},"./src/geometries/dodecahedron.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js");u("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new w.DodecahedronGeometry(h.radius,h.detail)}})},"./src/geometries/icosahedron.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js");u("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new w.IcosahedronGeometry(h.radius,h.detail)}})},"./src/geometries/index.js":(W,$,A)=>{A("./src/geometries/box.js"),A("./src/geometries/circle.js"),A("./src/geometries/cone.js"),A("./src/geometries/cylinder.js"),A("./src/geometries/dodecahedron.js"),A("./src/geometries/icosahedron.js"),A("./src/geometries/octahedron.js"),A("./src/geometries/plane.js"),A("./src/geometries/ring.js"),A("./src/geometries/sphere.js"),A("./src/geometries/tetrahedron.js"),A("./src/geometries/torus.js"),A("./src/geometries/torusKnot.js"),A("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js");u("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new w.OctahedronGeometry(h.radius,h.detail)}})},"./src/geometries/plane.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js");u("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(h){this.geometry=new w.PlaneGeometry(h.width,h.height,h.segmentsWidth,h.segmentsHeight)}})},"./src/geometries/ring.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js"),h=w.MathUtils.degToRad;u("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new w.RingGeometry(v.radiusInner,v.radiusOuter,v.segmentsTheta,v.segmentsPhi,h(v.thetaStart),h(v.thetaLength))}})},"./src/geometries/sphere.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js"),h=w.MathUtils.degToRad;u("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(v){this.geometry=new w.SphereGeometry(v.radius,v.segmentsWidth,v.segmentsHeight,h(v.phiStart),h(v.phiLength),h(v.thetaStart),h(v.thetaLength))}})},"./src/geometries/tetrahedron.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js");u("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new w.TetrahedronGeometry(h.radius,h.detail)}})},"./src/geometries/torus.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js"),h=w.MathUtils.degToRad;u("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(v){this.geometry=new w.TorusGeometry(v.radius,v.radiusTubular*2,v.segmentsRadial,v.segmentsTubular,h(v.arc))}})},"./src/geometries/torusKnot.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js");u("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(h){this.geometry=new w.TorusKnotGeometry(h.radius,h.radiusTubular*2,h.segmentsTubular,h.segmentsRadial,h.p,h.q)}})},"./src/geometries/triangle.js":(W,$,A)=>{var u=A("./src/core/geometry.js").registerGeometry,w=A("./src/lib/three.js"),h=new w.Quaternion,v=new w.Vector3(0,0,1),a=new w.Vector2,f=new w.Vector2,m=new w.Vector2;u("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(l){var y,g,d,p,C,S,_,L,T;d=new w.Triangle,d.a.set(l.vertexA.x,l.vertexA.y,l.vertexA.z),d.b.set(l.vertexB.x,l.vertexB.y,l.vertexB.z),d.c.set(l.vertexC.x,l.vertexC.y,l.vertexC.z),g=d.getNormal(new w.Vector3),h.setFromUnitVectors(g,v),p=d.a.clone().applyQuaternion(h),C=d.b.clone().applyQuaternion(h),S=d.c.clone().applyQuaternion(h),a.set(Math.min(p.x,C.x,S.x),Math.min(p.y,C.y,S.y)),f.set(Math.max(p.x,C.x,S.x),Math.max(p.y,C.y,S.y)),m.set(0,0).subVectors(f,a),p=new w.Vector2().subVectors(p,a).divide(m),C=new w.Vector2().subVectors(C,a).divide(m),S=new w.Vector2().subVectors(S,a).divide(m),y=this.geometry=new w.BufferGeometry,_=[d.a.x,d.a.y,d.a.z,d.b.x,d.b.y,d.b.z,d.c.x,d.c.y,d.c.z],L=[g.x,g.y,g.z,g.x,g.y,g.z,g.x,g.y,g.z],T=[p.x,p.y,C.x,C.y,S.x,S.y],y.setAttribute("position",new w.Float32BufferAttribute(_,3)),y.setAttribute("normal",new w.Float32BufferAttribute(L,3)),y.setAttribute("uv",new w.Float32BufferAttribute(T,2))}})},"./src/index.js":(W,$,A)=>{if(window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var u=A("./src/utils/isIOSOlderThan10.js"),w=u(window.navigator.userAgent)?1/window.devicePixelRatio:1,h=A("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),v={BUFFER_SCALE:w,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new h(v)}var a=A("./src/utils/index.js"),f=a.debug,m=f("A-Frame:error"),l=f("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&l("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&m("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),a.device.isBrowserEnvironment&&(A("./src/style/aframe.css"),A("./src/style/rStats.css"));var y=A("./src/core/scene/a-scene.js").AScene,g=A("./src/core/component.js").components,d=A("./src/core/component.js").registerComponent,p=A("./src/core/geometry.js").registerGeometry,C=A("./src/extras/primitives/primitives.js").registerPrimitive,S=A("./src/core/shader.js").registerShader,_=A("./src/core/system.js").registerSystem,L=A("./src/core/shader.js").shaders,T=A("./src/core/system.js").systems,N=window.THREE=A("./src/lib/three.js"),F=A("./src/core/readyState.js"),te=A("./package.json");A("./src/components/index.js"),A("./src/geometries/index.js"),A("./src/shaders/index.js"),A("./src/systems/index.js");var K=A("./src/core/a-node.js").ANode,se=A("./src/core/a-entity.js").AEntity;A("./src/core/a-assets.js"),A("./src/core/a-cubemap.js"),A("./src/core/a-mixin.js"),A("./src/extras/components/index.js"),A("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.6.0 (Date 2024-05-23, Commit #0e2163bd)"),console.log("THREE Version (https://github.com/supermedium/three.js):",N.REVISION),console.log("WebVR Polyfill Version:",te.dependencies["webvr-polyfill"]),window.AFRAME_ASYNC||F.waitForDocumentReadyState(),W.exports=window.AFRAME={AComponent:A("./src/core/component.js").Component,AEntity:se,ANode:K,ANIME:A("./node_modules/super-animejs/lib/anime.es.js").default,AScene:y,components:g,coreComponents:Object.keys(g),geometries:A("./src/core/geometry.js").geometries,registerComponent:d,registerGeometry:p,registerPrimitive:C,registerShader:S,registerSystem:_,primitives:{getMeshMixin:A("./src/extras/primitives/getMeshMixin.js"),primitives:A("./src/extras/primitives/primitives.js").primitives},scenes:A("./src/core/scene/scenes.js"),schema:A("./src/core/schema.js"),shaders:L,systems:T,emitReady:F.emitReady,THREE:N,utils:a,version:te.version}},"./src/lib/rStatsAframe.js":W=>{window.aframeStats=function($){var A=null,u=$,w={te:{caption:"Entities"},lt:{caption:"Load Time"}},h=[{caption:"A-Frame",values:["te","lt"]}];function v(){A("te").set(a()),window.performance.getEntriesByName&&A("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function a(){var y=u.querySelectorAll("*");return Array.prototype.slice.call(y).filter(function(g){return g.isEntity}),y.length}function f(){}function m(){}function l(y){A=y}return{update:v,start:f,end:m,attach:l,values:w,groups:h,fractions:[]}},W.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(W,$,A)=>{var u=A("./src/lib/three.mjs").default;A.g.THREE=u,A("./vendor/DeviceOrientationControls.js"),u.Cache&&(u.Cache.enabled=!0),W.exports=u},"./src/shaders/flat.js":(W,$,A)=>{var u=A("./src/core/shader.js").registerShader,w=A("./src/lib/three.js"),h=A("./src/utils/index.js");W.exports.Shader=u("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(a){this.materialData={color:new w.Color},v(a,this.materialData),this.material=new w.MeshBasicMaterial(this.materialData)},update:function(a){this.updateMaterial(a),h.material.updateMap(this,a)},updateMaterial:function(a){var f;v(a,this.materialData);for(f in this.materialData)this.material[f]=this.materialData[f]}});function v(a,f){return f.color.set(a.color),f.fog=a.fog,f.wireframe=a.wireframe,f.toneMapped=a.toneMapped,f.wireframeLinewidth=a.wireframeLinewidth,f}},"./src/shaders/index.js":(W,$,A)=>{A("./src/shaders/flat.js"),A("./src/shaders/standard.js"),A("./src/shaders/phong.js"),A("./src/shaders/sdf.js"),A("./src/shaders/msdf.js"),A("./src/shaders/shadow.js")},"./src/shaders/msdf.js":(W,$,A)=>{var u=A("./src/core/shader.js").registerShader,w=A("./src/lib/three.js"),h=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),v=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);W.exports.Shader=u("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},vertexShader:h,fragmentShader:v,init:function(){return this.uniforms=w.UniformsUtils.merge([w.UniformsLib.fog,this.initUniforms()]),this.material=new w.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/phong.js":(W,$,A)=>{var u=A("./src/core/shader.js").registerShader,w=A("./src/lib/three.js"),h=A("./src/utils/index.js");W.exports.Shader=u("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(a){this.materialData={color:new w.Color,specular:new w.Color,emissive:new w.Color},v(a,this.materialData),this.material=new w.MeshPhongMaterial(this.materialData);var f=this.el.sceneEl;Object.defineProperty(this.material,"envMap",{get:function(){return this._envMap||f.object3D.environment},set:function(m){this._envMap=m}})},update:function(a){this.updateMaterial(a),h.material.updateMap(this,a),h.material.updateDistortionMap("normal",this,a),h.material.updateDistortionMap("displacement",this,a),h.material.updateDistortionMap("ambientOcclusion",this,a),h.material.updateDistortionMap("bump",this,a),h.material.updateEnvMap(this,a)},updateMaterial:function(a){var f;v(a,this.materialData);for(f in this.materialData)this.material[f]=this.materialData[f]}});function v(a,f){switch(f.color.set(a.color),f.specular.set(a.specular),f.emissive.set(a.emissive),f.emissiveIntensity=a.emissiveIntensity,f.fog=a.fog,f.transparent=a.transparent,f.wireframe=a.wireframe,f.wireframeLinewidth=a.wireframeLinewidth,f.shininess=a.shininess,f.flatShading=a.flatShading,f.wireframe=a.wireframe,f.wireframeLinewidth=a.wireframeLinewidth,f.reflectivity=a.reflectivity,f.refractionRatio=a.refractionRatio,a.combine){case"mix":f.combine=w.MixOperation;break;case"multiply":f.combine=w.MultiplyOperation;break;case"add":f.combine=w.AddOperation;break}return a.normalMap&&(f.normalScale=a.normalScale),a.ambientOcclusionMap&&(f.aoMapIntensity=a.ambientOcclusionMapIntensity),a.bumpMap&&(f.bumpScale=a.bumpMapScale),a.displacementMap&&(f.displacementScale=a.displacementScale,f.displacementBias=a.displacementBias),f}},"./src/shaders/sdf.js":(W,$,A)=>{var u=A("./src/core/shader.js").registerShader,w=A("./src/lib/three.js"),h=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),v=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec2 uv = vUV;","  vec4 texColor = texture(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture(map, box.xy).a, width)","      + contour(texture(map, box.zw).a, width)","      + contour(texture(map, box.xw).a, width)","      + contour(texture(map, box.zy).a, width)","    )) / 3.0;","  }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color, opacity * alpha);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);W.exports.Shader=u("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:h,fragmentShader:v,init:function(){return this.uniforms=w.UniformsUtils.merge([w.UniformsLib.fog,this.initUniforms()]),this.material=new w.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/shadow.js":(W,$,A)=>{var u=A("./src/core/shader.js").registerShader,w=A("./src/lib/three.js");W.exports.Shader=u("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(h){this.material=new w.ShadowMaterial},update:function(h){this.material.opacity=h.opacity,this.material.alphaToCoverage=h.alphaToCoverage,this.material.transparent=h.transparent}})},"./src/shaders/standard.js":(W,$,A)=>{var u=A("./src/core/shader.js").registerShader,w=A("./src/lib/three.js"),h=A("./src/utils/index.js");W.exports.Shader=u("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(a){this.materialData={color:new w.Color,emissive:new w.Color},v(a,this.materialData),this.material=new w.MeshStandardMaterial(this.materialData)},update:function(a){this.updateMaterial(a),h.material.updateMap(this,a),h.material.updateDistortionMap("normal",this,a),h.material.updateDistortionMap("displacement",this,a),h.material.updateDistortionMap("ambientOcclusion",this,a),h.material.updateDistortionMap("metalness",this,a),h.material.updateDistortionMap("roughness",this,a),h.material.updateEnvMap(this,a)},updateMaterial:function(a){var f,m=this.material;v(a,this.materialData);for(f in this.materialData)m[f]=this.materialData[f]}});function v(a,f){return f.color.set(a.color),f.emissive.set(a.emissive),f.emissiveIntensity=a.emissiveIntensity,f.fog=a.fog,f.metalness=a.metalness,f.roughness=a.roughness,f.wireframe=a.wireframe,f.wireframeLinewidth=a.wireframeLinewidth,a.normalMap&&(f.normalScale=a.normalScale),a.ambientOcclusionMap&&(f.aoMapIntensity=a.ambientOcclusionMapIntensity),a.displacementMap&&(f.displacementScale=a.displacementScale,f.displacementBias=a.displacementBias),f}},"./src/systems/camera.js":(W,$,A)=>{var u=A("./src/constants/index.js"),w=A("./src/core/system.js").registerSystem,h="data-aframe-default-camera";W.exports.System=w("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var a,f,m=this.sceneEl,l=this;if(m.camera&&!m.camera.el.getAttribute("camera").spectator){m.emit("cameraready",{cameraEl:m.camera.el});return}if(a=m.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!a.length){this.createDefaultCamera();return}for(this.numUserCameras=a.length,f=0;f<a.length;f++)a[f].addEventListener("object3dset",function(y){y.detail.type==="camera"&&l.checkUserCamera(this)}),a[f].isNode?a[f].load():a[f].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(a){var f,m=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(f=a.getAttribute("camera"),!f.active||f.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,m.camera=a.getObject3D("camera"),m.emit("cameraready",{cameraEl:a})}},createDefaultCamera:function(){var a,f=this.sceneEl;a=document.createElement("a-entity"),a.setAttribute("camera",{active:!0}),a.setAttribute("position",{x:0,y:u.DEFAULT_CAMERA_HEIGHT,z:0}),a.setAttribute("wasd-controls",""),a.setAttribute("look-controls",""),a.setAttribute(u.AFRAME_INJECTED,""),a.addEventListener("object3dset",function(m){m.detail.type==="camera"&&(f.camera=m.detail.object,f.emit("cameraready",{cameraEl:a}))}),f.appendChild(a)},disableActiveCamera:function(){var a,f;a=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),f=a[a.length-1],f.setAttribute("camera","active",!0)},setActiveCamera:function(a){var f,m,l,y,g=this.activeCameraEl,d=this.sceneEl;if(y=a.getObject3D("camera"),!(!y||a===this.activeCameraEl)){var p=d.querySelector("["+h+"]"),C=p&&p.querySelector(":not(a-mixin)[camera]");for(a!==C&&v(d),this.activeCameraEl=a,this.activeCameraEl.play(),d.camera=y,g&&g.setAttribute("camera","active",!1),m=d.querySelectorAll(":not(a-mixin)[camera]"),l=0;l<m.length;l++)f=m[l],!(!f.isEntity||a===f)&&(f.setAttribute("camera","active",!1),f.pause());d.emit("camera-set-active",{cameraEl:a})}},setSpectatorCamera:function(a){var f,m=this.spectatorCameraEl,l=this.sceneEl,y;f=a.getObject3D("camera"),!(!f||a===this.spectatorCameraEl)&&(m&&m.setAttribute("camera","spectator",!1),y=this.spectatorCameraEl=a,l.addEventListener("enter-vr",this.wrapRender),l.addEventListener("exit-vr",this.unwrapRender),y.setAttribute("camera","active",!1),y.play(),l.emit("camera-set-spectator",{cameraEl:a}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(a,f){var m,l=this.sceneEl,y;m=l.renderer.xr.enabled,this.originalRender.call(l.renderer,a,f),!(!this.spectatorCameraEl||l.isMobile||!m)&&(y=this.spectatorCameraEl.components.camera.camera,l.renderer.xr.enabled=!1,this.originalRender.call(l.renderer,a,y),l.renderer.xr.enabled=m)}});function v(a){var f,m=a.camera;m&&(f=a.querySelector("["+h+"]"),f&&a.removeChild(f))}},"./src/systems/geometry.js":(W,$,A)=>{var u=A("./src/core/geometry.js").geometries,w=A("./src/core/system.js").registerSystem;W.exports.System=w("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(f){var m=this.cache,l,y;return f.skipCache?h(f):(y=this.hash(f),l=m[y],a(this.cacheCount,y),l||(l=h(f),m[y]=l,l))},unuseGeometry:function(f){var m=this.cache,l=this.cacheCount,y,g;f.skipCache||(g=this.hash(f),m[g]&&(v(l,g),!(l[g]>0)&&(y=m[g],y.dispose(),delete m[g],delete l[g])))},hash:function(f){return JSON.stringify(f)}});function h(f){var m=f.primitive,l=u[m]&&u[m].Geometry,y=new l;if(!l)throw new Error("Unknown geometry `"+m+"`");return y.init(f),y.geometry}function v(f,m){f[m]--}function a(f,m){f[m]=f[m]===void 0?1:f[m]+1}},"./src/systems/gltf-model.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/lib/three.js");function h(v){return new Promise(function(a,f){var m=document.createElement("script");document.body.appendChild(m),m.onload=a,m.onerror=f,m.async=!0,m.src=v})}W.exports.System=u("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var v=this.data.dracoDecoderPath,a=this.data.basisTranscoderPath,f=this.data.meshoptDecoderPath;!this.dracoLoader&&v&&(this.dracoLoader=new w.DRACOLoader,this.dracoLoader.setDecoderPath(v)),!this.ktx2Loader&&a&&(this.ktx2Loader=new w.KTX2Loader,this.ktx2Loader.setTranscoderPath(a).detectSupport(this.el.renderer)),!this.meshoptDecoder&&f&&(this.meshoptDecoder=h(f).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(W,$,A)=>{A("./src/systems/camera.js"),A("./src/systems/geometry.js"),A("./src/systems/gltf-model.js"),A("./src/systems/light.js"),A("./src/systems/material.js"),A("./src/systems/obb-collider.js"),A("./src/systems/renderer.js"),A("./src/systems/shadow.js"),A("./src/systems/tracked-controls-webvr.js"),A("./src/systems/tracked-controls-webxr.js"),A("./src/systems/webxr.js")},"./src/systems/light.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/constants/index.js"),h="data-aframe-default-light";W.exports.System=u("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",this.setupDefaultLights.bind(this))},registerLight:function(v){v.hasAttribute(h)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var v,a=this.sceneEl;if(this.defaultLights){v=document.querySelectorAll("["+h+"]");for(var f=0;f<v.length;f++)a.removeChild(v[f]);this.defaultLights=!1}},setupDefaultLights:function(){var v=this.sceneEl,a,f;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(a=document.createElement("a-entity"),a.setAttribute("light",{color:"#BBB",type:"ambient"}),a.setAttribute(h,""),a.setAttribute(w.AFRAME_INJECTED,""),v.appendChild(a),f=document.createElement("a-entity"),f.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),f.setAttribute("position",{x:-.5,y:1,z:1}),f.setAttribute(h,""),f.setAttribute(w.AFRAME_INJECTED,""),v.appendChild(f),this.defaultLights=!0)}})},"./src/systems/material.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/lib/three.js"),h=A("./src/utils/index.js"),v=A("./src/utils/material.js").setTextureProperties,a=A("./src/utils/material.js").createCompatibleTexture,f=h.debug,m=f("components:texture:error"),l=f("components:texture:warn"),y=new w.ImageLoader;W.exports.System=u("material",{init:function(){this.materials={},this.sourceCache={}},clearTextureSourceCache:function(){this.sourceCache={}},loadTexture:function(C,S,_){this.loadTextureSource(C,function(T){var N=a(T);v(N,S),_(N)})},loadTextureSource:function(C,S){var _=this,L=this.sourceCache,T=this.hash(C);if(L[T]){L[T].then(S);return}if(C.tagName==="CANVAS"){F(new w.Source(C));return}F(new Promise(N));function N(te,K){h.srcLoader.validateSrc(C,se,ne);function se(re){_.loadImage(re,te)}function ne(re){_.loadVideo(re,te)}}function F(te){L[T]=Promise.resolve(te),L[T].then(S)}},loadCubeMapTexture:function(C,S){var _=this,L=0,T=new w.CubeTexture;T.colorSpace=w.SRGBColorSpace;function N(te){_.loadTextureSource(C[te],function(K){T.images[te]=K,L++,L===6&&(T.needsUpdate=!0,S(T))})}if(C.length!==6){l("Cube map texture requires exactly 6 sources, got only %s sources",C.length);return}for(var F=0;F<C.length;F++)N(F)},loadImage:function(C,S){if(typeof C!="string"){S(new w.Source(C));return}S(g(C))},loadVideo:function(C,S){var _;typeof C!="string"&&(_=C,p(_)),_=_||d(C),S(new w.Source(_))},hash:function(C){return C.tagName&&(C.id||C.src)||C},registerMaterial:function(C){this.materials[C.uuid]=C},unregisterMaterial:function(C){delete this.materials[C.uuid]}});function g(C){return new Promise(S);function S(_,L){y.load(C,T,function(){},function(N){m("`$s` could not be fetched (Error code: %s; Response: %s)",N.status,N.statusText)});function T(N){_(new w.Source(N))}}}function d(C){var S=document.createElement("video");return S.setAttribute("playsinline",""),S.setAttribute("webkit-playsinline",""),S.autoplay=!0,S.loop=!0,S.crossOrigin="anonymous",S.addEventListener("error",function(){l("`%s` is not a valid video",C)},!0),S.src=C,S}function p(C){return C.autoplay=C.hasAttribute("autoplay")&&C.getAttribute("autoplay")!=="false",C.controls=C.hasAttribute("controls")&&C.getAttribute("controls")!=="false",C.getAttribute("loop")==="false"&&C.removeAttribute("loop"),C.getAttribute("preload")==="false"&&(C.preload="none"),C.crossOrigin=C.crossOrigin||"anonymous",C.setAttribute("playsinline",""),C.setAttribute("webkit-playsinline",""),C}},"./src/systems/obb-collider.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem;u("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(w){this.colliderEls.push(w),this.data.showColliders?w.components["obb-collider"].showCollider():w.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(w){var h=this.colliderEls,v=h.indexOf(w);w.components["obb-collider"].hideCollider(),v>-1&&h.splice(v,1),h.length===0&&(this.tick=void 0)},registerCollision:function(w,h){var v=this.collisions,a=!1,f=w.obb,m=h.obb,l=w.renderColliderMesh,y=h.renderColliderMesh;l&&l.material.color.set(16711680),y&&y.material.color.set(16711680);for(var g=0;g<v.length;g++)if(v[g].componentA.obb===f&&v[g].componentB.obb===m||v[g].componentA.obb===m&&v[g].componentB.obb===f){a=!0,v[g].detected=!0;break}a||(v.push({componentA:w,componentB:h,detected:!0}),w.el.emit("obbcollisionstarted",{trackedObject3D:w.trackedObject3D,withEl:h.el}),h.el.emit("obbcollisionstarted",{trackedObject3D:h.trackedObject3D,withEl:w.el}))},resetCollisions:function(){for(var w=this.collisions,h=0;h<w.length;h++)w[h].detected=!1},clearCollisions:function(){for(var w=this.collisions,h=[],v,a,f,m,l=0;l<w.length;l++)w[l].detected?h.push(w[l]):(v=w[l].componentA,a=w[l].componentB,f=v.renderColliderMesh,m=a.renderColliderMesh,f&&f.material.color.set(65280),v.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:a.el}),m&&m.material.color.set(65280),a.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:v.el}));this.collisions=h},detectCollisions:function(){var w,h,v,a,f=this.colliderEls;if(!(f.length<2)){this.resetCollisions();for(var m=0;m<f.length;m++)if(v=f[m].components["obb-collider"],w=f[m].components["obb-collider"].obb,!(w.halfSize.x===0||w.halfSize.y===0||w.halfSize.z===0))for(var l=m+1;l<f.length;l++)a=f[l].components["obb-collider"],h=a.obb,!(h.halfSize.x===0||h.halfSize.y===0||h.halfSize.z===0)&&w.intersectsOBB(h)&&this.registerCollision(v,a);this.clearCollisions()}}})},"./src/systems/renderer.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/utils/index.js"),h=A("./src/lib/three.js"),v=w.debug,a=v("components:renderer:warn");W.exports.System=u("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:w.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:-1},maxCanvasHeight:{default:-1},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},stencil:{default:!1},foveationLevel:{default:1}},init:function(){var y=this.data,g=this.el,d=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),p=g.renderer;y.physicallyCorrectLights||(p.useLegacyLights=!y.physicallyCorrectLights),p.toneMapping=h[d+"ToneMapping"],h.Texture.DEFAULT_ANISOTROPY=y.anisotropy,h.ColorManagement.enabled=y.colorManagement,p.outputColorSpace=y.colorManagement?h.SRGBColorSpace:h.LinearSRGBColorSpace,g.hasAttribute("antialias")&&a('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),g.hasAttribute("logarithmicDepthBuffer")&&a('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),p.sortObjects=!0,p.setOpaqueSort(f)},update:function(){var y=this.data,g=this.el,d=g.renderer,p=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);d.toneMapping=h[p+"ToneMapping"],d.toneMappingExposure=y.exposure,d.xr.setFoveation(y.foveationLevel),y.sortObjects&&a('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),y.sortTransparentObjects?d.setTransparentSort(l):d.setTransparentSort(m)},applyColorCorrection:function(y){!this.data.colorManagement||!y||y.isTexture&&y.colorSpace!==h.SRGBColorSpace&&(y.colorSpace=h.SRGBColorSpace,y.needsUpdate=!0)},setWebXRFrameRate:function(y){var g=this.data,d=y.supportedFrameRates;if(d&&y.updateTargetFrameRate){var p;d.includes(90)?p=g.highRefreshRate?90:72:p=g.highRefreshRate?72:60,y.updateTargetFrameRate(p).catch(function(C){console.warn("failed to set target frame rate of "+p+". Error info: "+C)})}}});function f(y,g){return y.groupOrder!==g.groupOrder?y.groupOrder-g.groupOrder:y.renderOrder!==g.renderOrder?y.renderOrder-g.renderOrder:y.z-g.z}function m(y,g){return y.groupOrder!==g.groupOrder?y.groupOrder-g.groupOrder:y.renderOrder-g.renderOrder}function l(y,g){return y.groupOrder!==g.groupOrder?y.groupOrder-g.groupOrder:y.renderOrder!==g.renderOrder?y.renderOrder-g.renderOrder:g.z-y.z}W.exports.sortFrontToBack=f,W.exports.sortRenderOrderOnly=m,W.exports.sortBackToFront=l},"./src/systems/shadow.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/lib/three.js"),h={basic:w.BasicShadowMap,pcf:w.PCFShadowMap,pcfsoft:w.PCFSoftShadowMap};W.exports.System=u("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var a=this.sceneEl,f=this.data;this.shadowMapEnabled=!1,a.renderer.shadowMap.type=h[f.type],a.renderer.shadowMap.autoUpdate=f.autoUpdate},update:function(a){a.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.shadowMapEnabled)},setShadowMapEnabled:function(a){var f=this.sceneEl,m=this.sceneEl.renderer;this.shadowMapEnabled=a;var l=this.data.enabled&&this.shadowMapEnabled;m&&l!==m.shadowMap.enabled&&(m.shadowMap.enabled=l,v(f))}});function v(a){a.hasLoaded&&a.object3D.traverse(function(f){if(f.material)for(var m=Array.isArray(f.material)?f.material:[f.material],l=0;l<m.length;l++)m[l].needsUpdate=!0})}},"./src/systems/tracked-controls-webvr.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/utils/index.js"),h=w.device.isWebXRAvailable;W.exports.System=u("tracked-controls-webvr",{init:function(){var v=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=w.throttle(this.updateControllerList,500,this),!h&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(a){a.length&&(v.vrDisplay=a[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var v=this.controllers,a,f,m,l;if(f=navigator.getGamepads&&navigator.getGamepads(),!!f){for(l=v.length,v.length=0,m=0;m<f.length;++m)a=f[m],a&&a.pose&&v.push(a);v.length!==l&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/utils/index.js");W.exports.System=u("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=w.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var h=this,v=this.el.xrSession;if(!v){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var a=h.el.sceneEl.systems.webxr.sessionReferenceSpaceType;v.requestReferenceSpace(a).then(function(f){h.referenceSpace=f}).catch(function(f){throw h.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(a,'tracked-controls-webxr uses reference space "'+a+'".'),f})},updateControllerList:function(){var h=this.el.xrSession,v=this.oldControllers,a;if(!h){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(h.inputSources){if(this.controllers=h.inputSources,this.oldControllersLength===this.controllers.length){var f=!0;for(a=0;a<this.controllers.length;++a)if(!(this.controllers[a]===v[a]&&this.controllers[a].gamepad===v[a].gamepad)){f=!1;break}if(f)return}for(v.length=0,a=0;a<this.controllers.length;a++)v.push(this.controllers[a]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(W,$,A)=>{var u=A("./src/core/system.js").registerSystem,w=A("./src/utils/index.js"),h=w.debug("systems:webxr:warn");W.exports.System=u("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var v=this.data;this.sessionConfiguration={requiredFeatures:v.requiredFeatures,optionalFeatures:v.optionalFeatures},this.sessionReferenceSpaceType=v.referenceSpaceType,v.overlayElement&&(v.overlayElement.classList.remove("a-dom-overlay"),v.optionalFeatures.includes("dom-overlay")||(v.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",v)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:v.overlayElement},v.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(v){return!!(v==="viewer"||v==="local"||this.sessionConfiguration.requiredFeatures.includes(v)||this.sessionConfiguration.optionalFeatures.includes(v))},warnIfFeatureNotRequested:function(v,a){if(!this.wasFeatureRequested(v)){var f='Please add the feature "'+v+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;h((a?a+" ":"")+f)}}})},"./src/utils/coordinates.js":(W,$,A)=>{var u=A("./src/utils/debug.js"),w=u("utils:coordinates:warn"),h=["x","y","z","w"],v=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;W.exports.regex=v;var a=/\s+/g;function f(d,p,C){var S,_,L,T,N=C&&typeof C=="object"?C:{},F,te,K,se;if(d&&d instanceof Object)return F=d.x===void 0?p&&p.x:d.x,te=d.y===void 0?p&&p.y:d.y,K=d.z===void 0?p&&p.z:d.z,se=d.w===void 0?p&&p.w:d.w,F!=null&&(N.x=g(F)),te!=null&&(N.y=g(te)),K!=null&&(N.z=g(K)),se!=null&&(N.w=g(se)),N;if(d==null)return typeof p=="object"?Object.assign(N,p):p;for(S=d.trim().split(a),T=0;T<h.length;T++)if(L=h[T],S[T])N[L]=parseFloat(S[T],10);else{if(_=p&&p[L],_===void 0)continue;N[L]=g(_)}return N}W.exports.parse=f;function m(d){var p;return typeof d!="object"?d:(p=d.x+" "+d.y,d.z!=null&&(p+=" "+d.z),d.w!=null&&(p+=" "+d.w),p)}W.exports.stringify=m;function l(d,p){return typeof d!="object"||typeof p!="object"?d===p:d.x===p.x&&d.y===p.y&&d.z===p.z&&d.w===p.w}W.exports.equals=l;function y(d){return v.test(d)}W.exports.isCoordinates=y,W.exports.isCoordinate=function(d){return w("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),y(d)};function g(d){return d!=null&&d.constructor===String?parseFloat(d,10):d}W.exports.toVector3=function(d){return new THREE.Vector3(d.x,d.y,d.z)}},"./src/utils/debug.js":(W,$,A)=>{var u=A("./node_modules/debug/src/browser.js"),w=A("./src/utils/device.js").isBrowserEnvironment,h={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};u.formatArgs=v;function v(y){if(y[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+y[0]+(this.useColors?"%c ":" "),!!this.useColors){this.color=f(this.namespace);var g="color: "+this.color;y.splice(1,0,g,"color: inherit");var d=0,p=0;y[0].replace(/%[a-zA-Z%]/g,function(C){C!=="%%"&&(d++,C==="%c"&&(p=d))}),y.splice(p,0,g)}}function a(y){var g=y.split(":");return g[g.length-1]}function f(y){var g=a(y),d=h.colors&&h.colors[g];return d||null}function m(){try{return window.localStorage}catch{}}var l=m();l&&(parseInt(l.logs,10)||l.logs==="true")?u.enable("*"):u.enable("*:error,*:info,*:warn"),w&&(window.logs=u),W.exports=u},"./src/utils/device.js":(W,$,A)=>{var u=A("./node_modules/debug/src/browser.js")("device:error"),w,h=!1,v=!1,a=W.exports.isWebXRAvailable=navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(K){var se;a||(se=document.createElement("canvas"),w=K.display,se.getContext("webgl",{}),w.requestPresent([{source:se}]).then(function(){},function(){}))}),a){var f=function(){var K=document.querySelector("a-scene");if(!K){window.addEventListener("DOMContentLoaded",f);return}K.hasLoaded?K.components["xr-mode-ui"].updateEnterInterfaces():K.addEventListener("loaded",f)},m=function(K){u("WebXR session support error: "+K.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(K){h=K,f()}).catch(m),navigator.xr.isSessionSupported("immersive-ar").then(function(K){v=K,f()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){h=!0,f()}).catch(m),navigator.xr.supportsSession("immersive-ar").then(function(){v=!0,f()}).catch(function(){})):u("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(K){var se=document.querySelector("a-scene");w=K.length&&K[0],se&&se.emit("displayconnected",{vrDisplay:w})});function l(){return w}W.exports.getVRDisplay=l;function y(){return h||v||!!l()}W.exports.checkHeadsetConnected=y;function g(){return v}W.exports.checkARSupport=g;function d(){return h}W.exports.checkVRSupport=d;var p=function(){var K=!1;return function(se){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(se)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(se.substr(0,4)))&&(K=!0),(_()||C()||te())&&(K=!0),F()&&(K=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return K}}();W.exports.isMobile=p;function C(K){var se=K||window.navigator.userAgent,ne=/Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(se);return ne||S()}W.exports.isTablet=C;function S(K,se,ne){var re=K||window.navigator.userAgent,Y=se||window.navigator.platform,k=ne||window.navigator.maxTouchPoints||0;return(Y==="iPad"||Y==="MacIntel")&&k>0&&/Macintosh|Intel|iPad|ipad/i.test(re)&&!window.MSStream}W.exports.isIpad=S;function _(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}W.exports.isIOS=_;function L(){return!p()&&!F()&&window.orientation!==void 0}W.exports.isMobileDeviceRequestingDesktopSite=L;function T(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}W.exports.isOculusBrowser=T;function N(){return/(Mobile VR)/i.test(window.navigator.userAgent)}W.exports.isFirefoxReality=N;function F(){return T()||N()}W.exports.isMobileVR=F;function te(){return/R7 Build/.test(window.navigator.userAgent)}W.exports.isR7=te,W.exports.isLandscape=function(){var K=window.orientation;return te()&&(K+=90),K===90||K===-90},W.exports.isBrowserEnvironment=typeof process>"u"||process.browser===!0,W.exports.isNodeEnvironment=!W.exports.isBrowserEnvironment},"./src/utils/entity.js":(W,$,A)=>{var u=A("./src/utils/split.js").split;function w(h,v){v=v||".";var a=u(h,v);return a.length===1?a[0]:a}W.exports.getComponentPropertyPath=w,W.exports.getComponentProperty=function(h,v,a){var f;return a=a||".",v.indexOf(a)!==-1?(f=w(v,a),f.constructor===String?h.getAttribute(f):h.getAttribute(f[0])[f[1]]):h.getAttribute(v)},W.exports.setComponentProperty=function(h,v,a,f){var m;if(f=f||".",v.indexOf(f)!==-1){m=w(v,f),m.constructor===String?h.setAttribute(m,a):h.setAttribute(m[0],m[1],a);return}h.setAttribute(v,a)}},"./src/utils/forceCanvasResizeSafariMobile.js":W=>{W.exports=function(A){var u=A.style.width,w=A.style.height;A.style.width=parseInt(u,10)+1+"px",A.style.height=parseInt(w,10)+1+"px",setTimeout(function(){A.style.width=u,A.style.height=w},200)}},"./src/utils/index.js":(W,$,A)=>{var u=A("./src/utils/debug.js"),w=A("./node_modules/deep-assign/index.js"),h=A("./src/utils/device.js"),v=A("./src/utils/object-pool.js"),a=u("utils:warn");W.exports.bind=function(m){return m.bind.apply(m,Array.prototype.slice.call(arguments,1))},W.exports.coordinates=A("./src/utils/coordinates.js"),W.exports.debug=u,W.exports.device=h,W.exports.entity=A("./src/utils/entity.js"),W.exports.forceCanvasResizeSafariMobile=A("./src/utils/forceCanvasResizeSafariMobile.js"),W.exports.material=A("./src/utils/material.js"),W.exports.objectPool=v,W.exports.split=A("./src/utils/split.js").split,W.exports.styleParser=A("./src/utils/styleParser.js"),W.exports.trackedControls=A("./src/utils/tracked-controls.js"),W.exports.checkHeadsetConnected=function(){return a("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),h.checkHeadsetConnected(arguments)},W.exports.isGearVR=W.exports.device.isGearVR=function(){a("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},W.exports.isIOS=function(){return a("`utils.isIOS` has moved to `utils.device.isIOS`"),h.isIOS(arguments)},W.exports.isOculusGo=W.exports.device.isOculusGo=function(){a("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},W.exports.isMobile=function(){return a("`utils.isMobile has moved to `utils.device.isMobile`"),h.isMobile(arguments)},W.exports.throttle=function(m,l,y){var g;return y&&(m=m.bind(y)),function(){var d=Date.now(),p=typeof g>"u"?l:d-g;(typeof g>"u"||p>=l)&&(g=d,m.apply(null,arguments))}},W.exports.throttleLeadingAndTrailing=function(m,l,y){var g,d;y&&(m=m.bind(y));var p,C=function(){g=Date.now(),m.apply(this,p),d=void 0};return function(){var S=Date.now(),_=typeof g>"u"?l:S-g;_>=l?(clearTimeout(d),d=void 0,g=S,m.apply(null,arguments)):(d=d||setTimeout(C,l-_),p=arguments)}},W.exports.throttleTick=function(m,l,y){var g;return y&&(m=m.bind(y)),function(d,p){var C=typeof g>"u"?p:d-g;(typeof g>"u"||C>=l)&&(g=d,m(d,C))}},W.exports.debounce=function(m,l,y){var g;return function(){var d=this,p=arguments,C=function(){g=null,y||m.apply(d,p)},S=y&&!g;clearTimeout(g),g=setTimeout(C,l),S&&m.apply(d,p)}},W.exports.extend=Object.assign,W.exports.extendDeep=w,W.exports.clone=function(m){return JSON.parse(JSON.stringify(m))};var f=function(){var m=v.createPool(function(){return[]});return function(l,y){var g,d,p,C,S,_;if(l===void 0||y===void 0||l===null||y===null||!(l&&y&&l.constructor===Object&&y.constructor===Object||l.constructor===Array&&y.constructor===Array))return l===y;d=m.use(),p=m.use(),d.length=0,p.length=0;for(g in l)d.push(g);for(g in y)p.push(g);if(d.length!==p.length)return m.recycle(d),m.recycle(p),!1;for(C=0;C<d.length;++C)if(S=l[d[C]],_=y[d[C]],typeof S=="object"||typeof _=="object"||Array.isArray(S)&&Array.isArray(_)){if(S===_)continue;if(!f(S,_))return m.recycle(d),m.recycle(p),!1}else if(S!==_)return m.recycle(d),m.recycle(p),!1;return m.recycle(d),m.recycle(p),!0}}();W.exports.deepEqual=f,W.exports.diff=function(){var m=[];return function(l,y,g){var d,p,C,S,_,L,T;S=g||{},m.length=0;for(_ in l)m.push(_);if(!y)return S;for(C in y)m.indexOf(C)===-1&&m.push(C);for(L=0;L<m.length;L++)_=m[L],d=l[_],p=y[_],T=d&&p&&d.constructor===Object&&p.constructor===Object,(T&&!f(d,p)||!T&&d!==p)&&(S[_]=p);return S}}(),W.exports.shouldCaptureKeyEvent=function(m){return m.metaKey?!1:document.activeElement===document.body},W.exports.splitString=function(m,l){typeof l>"u"&&(l=" ");var y=new RegExp(l,"g");return m=(m||"").replace(y,l),m.split(l)},W.exports.getElData=function(m,l){l=l||{};var y={};Object.keys(l).forEach(g);function g(d){m.hasAttribute(d)&&(y[d]=m.getAttribute(d))}return y},W.exports.getUrlParameter=function(m){m=m.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var l=new RegExp("[\\?&]"+m+"=([^&#]*)"),y=l.exec(location.search);return y===null?"":decodeURIComponent(y[1].replace(/\+/g," "))},W.exports.isIframed=function(){return window.top!==window.self},W.exports.findAllScenes=function(m){for(var l=[],y=m.getElementsByTagName("*"),g=0,d=y.length;g<d;g++)y[g].isScene&&l.push(y[g]);return l},W.exports.srcLoader=A("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/isIOSOlderThan10.js":W=>{W.exports=function(A){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(A)}},"./src/utils/material.js":(W,$,A)=>{var u=A("./src/lib/three.js"),w=A("./src/utils/src-loader.js"),h=A("./src/utils/debug.js"),v=h("utils:material:warn"),a=new Set(["emissiveMap","envMap","map","specularMap"]);function f(d,p){var C=p.offset||{x:0,y:0},S=p.repeat||{x:1,y:1},_=p.npot||!1,L=p.anisotropy||u.Texture.DEFAULT_ANISOTROPY,T=d.wrapS,N=d.wrapT,F=d.magFilter,te=d.minFilter;_&&(T=u.ClampToEdgeWrapping,N=u.ClampToEdgeWrapping,F=u.LinearFilter,te=u.LinearFilter),(S.x!==1||S.y!==1)&&(T=u.RepeatWrapping,N=u.RepeatWrapping),d.offset.set(C.x,C.y),d.repeat.set(S.x,S.y),(d.wrapS!==T||d.wrapT!==N||d.magFilter!==F||d.minFilter!==te||d.anisotropy!==L)&&(d.wrapS=T,d.wrapT=N,d.magFilter=F,d.minFilter=te,d.anisotropy=L,d.needsUpdate=!0)}W.exports.setTextureProperties=f,W.exports.updateMapMaterialFromData=function(d,p,C,S){var _=C.el,L=C.material,T=_.sceneEl.systems.renderer,N=S[p];if(C.materialSrcs||(C.materialSrcs={}),!N){delete C.materialSrcs[d],te(null);return}if(N===C.materialSrcs[d]&&L[d]){f(L[d],S);return}C.materialSrcs[d]=N,N instanceof u.Texture?te(N):_.sceneEl.systems.material.loadTextureSource(N,F);function F(K){if(C.materialSrcs[d]===N){var se=L[d];se&&(K===null||!y(se,K))&&(se=null),!se&&K&&(se=g(K)),se&&(se.source!==K&&(se.source=K,se.needsUpdate=!0),a.has(d)&&T.applyColorCorrection(se),f(se,S)),te(se)}}function te(K){L[d]!==K&&(L[d]&&L[d].dispose(),L[d]=K,L.needsUpdate=!0,l(_,K))}},W.exports.updateMap=function(d,p){return W.exports.updateMapMaterialFromData("map","src",d,p)},W.exports.updateDistortionMap=function(d,p,C){var S=d;d==="ambientOcclusion"&&(S="ao");var _={};return _.src=C[d+"Map"],_.offset=C[d+"TextureOffset"],_.repeat=C[d+"TextureRepeat"],_.wrap=C[d+"TextureWrap"],W.exports.updateMapMaterialFromData(S+"Map","src",p,_)};var m={};W.exports.updateEnvMap=function(d,p){var C=d.material,S=d.el,_="envMap",L=p.envMap,T=p.sphericalEnvMap,N=p.refract;if(T&&(L=T,v("`sphericalEnvMap` property is deprecated, using spherical map as equirectangular map instead. Use `envMap` property with a CubeMap or Equirectangular image instead.")),d.materialSrcs||(d.materialSrcs={}),!L){delete d.materialSrcs[_],C.envMap=null,C.needsUpdate=!0;return}if(d.materialSrcs[_]=L,m[L]){m[L].then(F);return}m[L]=new Promise(function(te){w.validateEnvMapSrc(L,function(se){S.sceneEl.systems.material.loadCubeMapTexture(se,function(ne){ne.mapping=N?u.CubeRefractionMapping:u.CubeReflectionMapping,F(ne),te(ne)})},function(se){S.sceneEl.systems.material.loadTexture(se,{src:se},function(ne){ne.mapping=N?u.EquirectangularRefractionMapping:u.EquirectangularReflectionMapping,F(ne),te(ne)})})});function F(te){d.materialSrcs[_]===L&&(C.envMap=te,C.needsUpdate=!0,l(S,te))}};function l(d,p){if(!p||(d.emit("materialtextureloaded",{src:p.image,texture:p}),!p.image||p.image.tagName!=="VIDEO"))return;p.image.addEventListener("loadeddata",C),p.image.addEventListener("ended",S);function C(){d.emit("materialvideoloadeddata",{src:p.image,texture:p})}function S(){d.emit("materialvideoended",{src:p.image,texture:p})}p.addEventListener("dispose",function(){p.image.removeEventListener("loadeddata",C),p.image.removeEventListener("ended",S)})}W.exports.handleTextureEvents=l;function y(d,p){return p.data instanceof HTMLCanvasElement?d.isCanvasTexture:p.data instanceof HTMLVideoElement?d.isVideoTexture&&d.source===p:d.isTexture&&!d.isCanvasTexture&&!d.isVideoTexture}W.exports.isCompatibleTexture=y;function g(d){var p;return d.data instanceof HTMLCanvasElement?p=new u.CanvasTexture:d.data instanceof HTMLVideoElement?p=new u.VideoTexture(d.data):p=new u.Texture,p.source=d,p.needsUpdate=!0,p}W.exports.createCompatibleTexture=g},"./src/utils/math.js":W=>{function $(u,w,h){var v=w.dot(u);return(v-w.dot(h))/w.length()}function A(u,w,h,v){var a=$(u,w,h);return v.copy(w),v.multiplyScalar(a),v.add(h),v}W.exports.distanceOfPointFromPlane=$,W.exports.nearestPointInPlane=A},"./src/utils/object-pool.js":W=>{var $=Object.freeze(Object.create(null));function A(){return{}}W.exports.createPool=function(v){var a=[],f=null;v=v||A;function m(){var d;return(f===null||f===a.length)&&y(a.length||5),d=a[f],a[f++]=$,u(d),d}function l(d){if(d instanceof Object){if(f===null||f===-1){a[a.length]=d;return}a[--f]=d}}function y(d){var p,C;if(d=d===void 0?a.length:d,d>0&&f==null&&(f=0),d>0)for(p=a.length,a.length+=Number(d),C=p;C<a.length;C++)a[C]=v();return a.length}function g(){return a.length}return{grow:y,pool:a,recycle:l,size:g,use:m}};function u(h){var v;if(!(!h||h.constructor!==Object))for(v in h)h[v]=void 0}W.exports.clearObject=u;function w(h,v){var a;if(!(!h||h.constructor!==Object))for(a in h)a in v||delete h[a]}W.exports.removeUnusedKeys=w},"./src/utils/split.js":W=>{W.exports.split=function(){var $={};return function(A,u){return u in $||($[u]={}),A in $[u]||($[u][A]=A.split(u)),$[u][A]}}()},"./src/utils/src-loader.js":(W,$,A)=>{var u=A("./src/utils/debug.js"),w=u("utils:src-loader:warn");function h(g,d,p){m(g,function(S){if(S){d(g);return}p(g)})}function v(g,d,p){var C,S="",_,L,T=[];if(typeof g=="string"){let F=function(te){T.push(te),T.length===6&&d(T)};for(_=0;_<5;_++)S+="(url\\((?:[^\\)]+)\\),\\s*)";if(S+="(url\\((?:[^\\)]+)\\)\\s*)",L=g.match(new RegExp(S)),L){for(_=1;_<7;_++)h(f(L[_]),F);return}if(!g.startsWith("#")){var N=f(g);h(N||g,p);return}}if(g.tagName?C=g:C=y(g),!!C){if(C.tagName==="A-CUBEMAP"&&C.srcs)return d(C.srcs);if(C.tagName==="IMG")return p(C);w('Selector "%s" does not point to <a-cubemap> or <img>',g)}}function a(g,d){return v(g,d,function(){w("Expected cubemap but got image")})}function f(g){var d=g.match(/url\((.+)\)/);if(d)return d[1]}function m(g,d){var p;if(g.tagName){d(g.tagName==="IMG");return}p=new XMLHttpRequest,p.open("HEAD",g),p.addEventListener("load",function(C){var S;p.status>=200&&p.status<300?(S=p.getResponseHeader("Content-Type"),S==null?l(g,d):S.startsWith("image")?d(!0):d(!1)):l(g,d),p.abort()}),p.send()}function l(g,d){var p=new Image;p.addEventListener("load",C);function C(){d(!0)}p.addEventListener("error",S);function S(){d(!1)}p.src=g}function y(g){try{var d=document.querySelector(g);return d||w('No element was found matching the selector: "%s"',g),d}catch{w('"%s" is not a valid selector',g);return}}W.exports={parseUrl:f,validateSrc:h,validateCubemapSrc:a,validateEnvMapSrc:v}},"./src/utils/styleParser.js":W=>{var $=/-([a-z])/g;W.exports.parse=function(a,f){var m;return typeof a!="string"||(m=w(a,f),m[""])?a:m},W.exports.stringify=function(a){return typeof a=="string"?a:h(a)};function A(a){return a.replace($,v)}W.exports.toCamelCase=A;var u=function(){var a=[],f=/url\([^)]+$/;return function(l){var y="",g,d=0,p=";";for(a.length=0;d<l.length;){if(g=l.indexOf(p,d),g===-1&&(g=l.length),y+=l.substring(d,g),f.test(y)){y+=";",d=g+1;continue}a.push(y.trim()),y="",d=g+1}return a}}();function w(a,f){var m,l,y,g,d,p;for(f=f||{},m=u(a),l=0;l<m.length;l++)y=m[l],y&&(g=y.indexOf(":"),d=y.substr(0,g).trim(),p=y.substr(g+1).trim(),f[A(d)]=p);return f}function h(a){var f,m=0,l=0,y="";for(f in a)m++;for(f in a)y+=f+": "+a[f],l<m-1&&(y+="; "),l++;return y}function v(a){return a[1].toUpperCase()}},"./src/utils/tracked-controls.js":(W,$,A)=>{var u=A("./src/constants/index.js").DEFAULT_HANDEDNESS,w=["x","y","z","w"],h=2;W.exports.checkControllerPresentAndSetup=function(l,y,g){var d=l.el,p,C=d.sceneEl.hasWebXR,S=C?a:v,_;if(p=S(l,y,g),_=!!p,l.controllerPresent&&!l.controllerEventsActive&&!C&&l.addEventListeners(),_===l.controllerPresent)return _;l.controllerPresent=_,_?(l.addEventListeners(),l.injectTrackedControls(p),d.emit("controllerconnected",{name:l.name,component:l})):(l.removeEventListeners(),d.emit("controllerdisconnected",{name:l.name,component:l}))};function v(l,y,g){var d,p=l.el.sceneEl,C,S=g.index||0;return!y||(C=p&&p.systems["tracked-controls-webvr"],!C)||(d=C.controllers,!d.length)?!1:!!f(d,null,y,g.hand,S)}function a(l,y,g){var d,p=l.el.sceneEl,C=p&&p.systems["tracked-controls-webxr"];return!C||(d=C.controllers,!d||!d.length)?!1:m(d,y,g.hand,g.index,g.iterateControllerProfiles,g.handTracking)}W.exports.isControllerPresentWebVR=v,W.exports.isControllerPresentWebXR=a;function f(l,y,g,d,p){var C,S,_=0,L=p>=0?p:0;for(S=0;S<l.length;S++)if(C=l[S],!(g&&!C.id.startsWith(g))&&!(!g&&C.id!==y)&&!(d&&C.hand&&d!==C.hand)){if(d&&!C.hand)L=h*p+(d===u?0:1);else return C;if(_===L)return C;++_}}function m(l,y,g,d,p,C){var S,_,L,T=!1,N,F;for(S=0;S<l.length;S++){if(L=l[S],F=L.profiles,C)T=L.hand;else if(p)for(_=0;_<F.length&&(T=F[_].startsWith(y),!T);_++);else T=F.length>0&&F[0].startsWith(y);if(T){if(N=L.handedness==="right"||L.handedness==="left",N){if(L.handedness===g)return l[S]}else if(S===d)return l[S]}}}W.exports.findMatchingControllerWebVR=f,W.exports.findMatchingControllerWebXR=m,W.exports.emitIfAxesChanged=function(l,y,g){var d,p,C,S,_;for(p in y){for(d=y[p],C=!1,_=0;_<d.length;_++)g.detail.changed[d[_]]&&(C=!0);if(C){for(S={},_=0;_<d.length;_++)S[w[_]]=g.detail.axis[d[_]];l.el.emit(p+"moved",S)}}},W.exports.onButtonEvent=function(l,y,g,d){var p=d?g.mapping[d]:g.mapping,C=p.buttons[l];g.el.emit(C+y),g.updateModel&&g.updateModel(C,y)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(W){var $=this;this.object=W,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var A=function(h){$.deviceOrientation=h},u=function(){$.screenOrientation=window.orientation||0},w=function(){var h=new THREE.Vector3(0,0,1),v=new THREE.Euler,a=new THREE.Quaternion,f=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(m,l,y,g,d){v.set(y,l,-g,"YXZ"),m.setFromEuler(v),m.multiply(f),m.multiply(a.setFromAxisAngle(h,-d))}}();this.connect=function(){u(),window.addEventListener("orientationchange",u,!1),window.addEventListener("deviceorientation",A,!1),$.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",u,!1),window.removeEventListener("deviceorientation",A,!1),$.enabled=!1},this.update=function(){if($.enabled!==!1){var h=$.deviceOrientation;if(h){var v=h.alpha?THREE.MathUtils.degToRad(h.alpha)+$.alphaOffset:0,a=h.beta?THREE.MathUtils.degToRad(h.beta):0,f=h.gamma?THREE.MathUtils.degToRad(h.gamma):0,m=$.screenOrientation?THREE.MathUtils.degToRad($.screenOrientation):0;w($.object.quaternion,v,a,f,m)}}},this.dispose=function(){$.disconnect()},this.connect()}},"./vendor/rStats.extras.js":W=>{window.glStats=function(){var $=null,A=0,u=0,w=0,h=0,v=0,a=0,f=0;function m(_,L){return function(){L.apply(this,arguments),_.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=m(WebGLRenderingContext.prototype.drawArrays,function(){A++,arguments[0]==this.POINTS?a+=arguments[2]:v+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=m(WebGLRenderingContext.prototype.drawElements,function(){u++,h+=arguments[1]/3,v+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=m(WebGLRenderingContext.prototype.useProgram,function(){w++}),WebGLRenderingContext.prototype.bindTexture=m(WebGLRenderingContext.prototype.bindTexture,function(){f++});var l={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},y=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],g=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function d(){$("allcalls").set(A+u),$("drawElements").set(u),$("drawArrays").set(A),$("bindTexture").set(f),$("useProgram").set(w),$("glfaces").set(h),$("glvertices").set(v),$("glpoints").set(a)}function p(){A=0,u=0,w=0,h=0,v=0,a=0,f=0}function C(){}function S(_){$=_}return{update:d,start:p,end:C,attach:S,values:l,groups:y,fractions:g}},window.threeStats=function($){var A=null,u={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},w=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],h=[];function v(){A("renderer.info.memory.geometries").set($.info.memory.geometries),A("renderer.info.programs").set($.info.programs.length),A("renderer.info.memory.textures").set($.info.memory.textures),A("renderer.info.render.calls").set($.info.render.calls),A("renderer.info.render.triangles").set($.info.render.triangles),A("renderer.info.render.points").set($.info.render.points)}function a(){}function f(){}function m(l){A=l}return{update:v,start:a,end:f,attach:m,values:u,groups:w,fractions:h}},window.BrowserStats=function(){var $=null,A=0,u=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var w={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},h=[{caption:"Browser",values:["memory","total"]}],v=[{base:"total",steps:["memory"]}],a=Math.log(1024);function f(d){var p=100,C=Math.floor(Math.log(d)/a);return Math.round(d*p/Math.pow(1024,C))/p}function m(){A=f(performance.memory.usedJSHeapSize),u=f(performance.memory.totalJSHeapSize),$("memory").set(A),$("total").set(u)}function l(){A=0}function y(){}function g(d){$=d}return{update:m,start:l,end:y,attach:g,values:w,groups:h,fractions:v}},W.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":W=>{(function(){"performance"in window||(window.performance={});var $=window.performance;if(!("now"in $)){var A=Date.now();$.timing&&$.timing.navigationStart&&(A=$.timing.navigationStart),$.now=function(){return Date.now()-A}}$.mark||($.mark=function(){}),$.measure||($.measure=function(){})})(),window.rStats=function(A){function u(F,te){for(var K=Object.keys(F),se=0,ne=K.length;se<ne;se++)te(K[se])}function w(F){var te=document.createElement("link");te.href=F,te.rel="stylesheet",te.type="text/css",document.getElementsByTagName("head")[0].appendChild(te)}var h=A||{},v=h.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],a="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",f=(h.CSSPath?h.CSSPath:"")+"rStats.css",m=h.css||[a,f];m.forEach(function(F){w(F)}),h.values||(h.values={});var l,y,g=10,d=200,p={};function C(F,te,K){var se=K||{},ne=document.createElement("canvas"),re=ne.getContext("2d"),Y=0,k=0,oe=se.color?se.color:"#666666",ae=document.createElement("canvas"),Ae=ae.getContext("2d");ae.width=1,ae.height=2*g,Ae.fillStyle="#444444",Ae.fillRect(0,0,1,2*g),Ae.fillStyle=oe,Ae.fillRect(0,g,1,g),Ae.fillStyle="#ffffff",Ae.globalAlpha=.5,Ae.fillRect(0,g,1,1),Ae.globalAlpha=1;var b=document.createElement("canvas"),I=b.getContext("2d");b.width=1,b.height=2*g,I.fillStyle="#444444",I.fillRect(0,0,1,2*g),I.fillStyle="#b70000",I.fillRect(0,g,1,g),I.globalAlpha=.5,I.fillStyle="#ffffff",I.fillRect(0,g,1,1),I.globalAlpha=1;function O(){ne.width=d,ne.height=g,ne.style.width=ne.width+"px",ne.style.height=ne.height+"px",ne.className="rs-canvas",F.appendChild(ne),re.fillStyle="#444444",re.fillRect(0,0,ne.width,ne.height)}function Q(J,ve){k+=(J-k)*.1,Y*=.99,k>Y&&(Y=k),re.drawImage(ne,1,0,ne.width-1,ne.height,0,0,ne.width-1,ne.height),ve?re.drawImage(b,ne.width-1,ne.height-k*ne.height/Y-g):re.drawImage(ae,ne.width-1,ne.height-k*ne.height/Y-g)}return O(),{draw:Q}}function S(F,te){var K=document.createElement("canvas"),se=K.getContext("2d");function ne(){K.width=d,K.height=g*te,K.style.width=K.width+"px",K.style.height=K.height+"px",K.className="rs-canvas",F.appendChild(K),se.fillStyle="#444444",se.fillRect(0,0,K.width,K.height)}function re(Y){se.drawImage(K,1,0,K.width-1,K.height,0,0,K.width-1,K.height);var k=0;u(Y,function(oe){var ae=Y[oe]*K.height;se.fillStyle=v[oe],se.fillRect(K.width-1,k,1,ae),k+=ae})}return ne(),{draw:re}}function _(F,te){var K=F,se,ne=0,re=0,Y=0,k=0,oe=performance.now(),ae=0,Ae=document.createElement("div"),b=document.createElement("span"),I=document.createElement("div"),O=document.createTextNode(""),Q=h?h.values[K.toLowerCase()]:null,J=new C(Ae,K,Q),ve=!1;b.className="rs-counter-id",b.textContent=Q&&Q.caption?Q.caption:K,I.className="rs-counter-value",I.appendChild(O),Ae.appendChild(b),Ae.appendChild(I),te?te.div.appendChild(Ae):y.appendChild(Ae),se=performance.now();function Le(kt){if(Q&&Q.average){k+=kt,ae++;var jt=performance.now();jt-oe>=(Q.avgMs||1e3)&&(Y=k/ae,k=0,oe=jt,ae=0)}}function _e(){se=performance.now(),h.userTimingAPI&&performance.mark(K+"-start"),ve=!0}function Ze(){ne=performance.now()-se,h.userTimingAPI&&(performance.mark(K+"-end"),ve&&performance.measure(K,K+"-start",K+"-end")),Le(ne)}function qe(){Ze(),_e()}function ft(){var kt=Q&&Q.average?Y:ne;O.nodeValue=Math.round(kt*100)/100;var jt=Q&&(Q.below&&ne<Q.below||Q.over&&ne>Q.over);J.draw(ne,jt),Ae.className=jt?"rs-counter-base alarm":"rs-counter-base"}function Et(){var kt=performance.now(),jt=kt-se;re++,jt>1e3&&(Q&&Q.interpolate===!1?ne=re:ne=re*1e3/jt,re=0,se=kt,Le(ne))}function Bt(kt){ne=kt,Le(ne)}return{set:Bt,start:_e,tick:qe,end:Ze,frame:Et,value:function(){return ne},draw:ft}}function L(F){var te=F.toLowerCase();if(te===void 0&&(te="default"),p[te])return p[te];var K=null;h&&h.groups&&u(h.groups,function(ne){var re=h.groups[parseInt(ne,10)];!K&&re.values.indexOf(te.toLowerCase())!==-1&&(K=re)});var se=new _(te,K);return p[te]=se,se}function T(){if(h.plugins){h.values||(h.values={}),h.groups||(h.groups=[]),h.fractions||(h.fractions=[]);for(var F=0;F<h.plugins.length;F++)h.plugins[F].attach(L),u(h.plugins[F].values,function(te){h.values[te]=h.plugins[F].values[te]}),h.groups=h.groups.concat(h.plugins[F].groups),h.fractions=h.fractions.concat(h.plugins[F].fractions)}else h.plugins={};l=document.createElement("div"),l.className="rs-base",y=document.createElement("div"),y.className="rs-container",y.style.height="auto",l.appendChild(y),document.body.appendChild(l),h&&(h.groups&&u(h.groups,function(te){var K=h.groups[parseInt(te,10)],se=document.createElement("div");se.className="rs-group",K.div=se;var ne=document.createElement("h1");ne.textContent=K.caption,ne.addEventListener("click",(function(re){this.classList.toggle("hidden"),re.preventDefault()}).bind(se)),y.appendChild(ne),y.appendChild(se)}),h.fractions&&u(h.fractions,function(te){var K=h.fractions[parseInt(te,10)],se=document.createElement("div");se.className="rs-fraction";var ne=document.createElement("div");ne.className="rs-legend";var re=0;u(h.fractions[te].steps,function(k){var oe=document.createElement("p");oe.textContent=h.fractions[te].steps[k],oe.style.color=v[re],ne.appendChild(oe),re++}),se.appendChild(ne),se.style.height=re*g+"px",K.div=se;var Y=new S(se,re);K.graph=Y,y.appendChild(se)}))}function N(){u(h.plugins,function(F){h.plugins[F].update()}),u(p,function(F){p[F].draw()}),h&&h.fractions&&u(h.fractions,function(F){var te=h.fractions[parseInt(F,10)],K=[],se=p[te.base.toLowerCase()];se&&(se=se.value(),u(h.fractions[F].steps,function(ne){var re=h.fractions[F].steps[parseInt(ne,10)].toLowerCase(),Y=p[re];Y&&K.push(Y.value()/se)})),te.graph.draw(K)})}return T(),function(F){return F?L(F):{element:l,update:N}}},W.exports=window.rStats},"./vendor/wakelock/util.js":W=>{var $={};$.base64=function(A,u){return"data:"+A+";base64,"+u},$.isMobile=function(){var A=!1;return function(u){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(u)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(u.substr(0,4)))&&(A=!0)}(navigator.userAgent||navigator.vendor||window.opera),A},$.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},$.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},$.appendQueryParameter=function(A,u,w){var h=A.indexOf("?")<0?"?":"&";return A+=h+u+"="+w,A},$.getQueryParameter=function(A){A=A.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var u=new RegExp("[\\?&]"+A+"=([^&#]*)"),w=u.exec(location.search);return w===null?"":decodeURIComponent(w[1].replace(/\+/g," "))},$.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},W.exports=$},"./vendor/wakelock/wakelock.js":(W,$,A)=>{var u=A("./vendor/wakelock/util.js");function w(){var a=document.createElement("video");a.addEventListener("ended",function(){a.play()}),this.request=function(){a.paused&&(a.src=u.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),a.play())},this.release=function(){a.pause(),a.src=""}}function h(){var a=null;this.request=function(){a||(a=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){a&&(clearInterval(a),a=null)}}function v(){var a=navigator.userAgent||navigator.vendor||window.opera;return a.match(/iPhone/i)||a.match(/iPod/i)?h:w}W.exports=v()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(W,$,A)=>{A.r($),A.d($,{default:()=>N});var u=A("./node_modules/css-loader/dist/runtime/sourceMaps.js"),w=A.n(u),h=A("./node_modules/css-loader/dist/runtime/api.js"),v=A.n(h),a=A("./node_modules/css-loader/dist/runtime/getUrl.js"),f=A.n(a),m=new URL(A("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),A.b),l=new URL(A("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),A.b),y=new URL(A("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),A.b),g=new URL(A("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),A.b),d=new URL(A("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),A.b),p=v()(w()),C=f()(m),S=f()(l),_=f()(y),L=f()(g),T=f()(d);p.push([W.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(${C}) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(${S}) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(${_});
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(${L}) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(${T}) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);const N=p},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(W,$,A)=>{A.r($),A.d($,{default:()=>f});var u=A("./node_modules/css-loader/dist/runtime/sourceMaps.js"),w=A.n(u),h=A("./node_modules/css-loader/dist/runtime/api.js"),v=A.n(h),a=v()(w());a.push([W.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);const f=a},"./src/style/aframe.css":(W,$,A)=>{A.r($),A.d($,{default:()=>_});var u=A("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),w=A.n(u),h=A("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),v=A.n(h),a=A("./node_modules/style-loader/dist/runtime/insertBySelector.js"),f=A.n(a),m=A("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),l=A.n(m),y=A("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),g=A.n(y),d=A("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),p=A.n(d),C=A("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),S={};S.styleTagTransform=p(),S.setAttributes=l(),S.insert=f().bind(null,"head"),S.domAPI=v(),S.insertStyleElement=g(),w()(C.default,S);const _=C.default&&C.default.locals?C.default.locals:void 0},"./src/style/rStats.css":(W,$,A)=>{A.r($),A.d($,{default:()=>_});var u=A("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),w=A.n(u),h=A("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),v=A.n(h),a=A("./node_modules/style-loader/dist/runtime/insertBySelector.js"),f=A.n(a),m=A("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),l=A.n(m),y=A("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),g=A.n(y),d=A("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),p=A.n(d),C=A("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),S={};S.styleTagTransform=p(),S.setAttributes=l(),S.insert=f().bind(null,"head"),S.domAPI=v(),S.insertStyleElement=g(),w()(C.default,S);const _=C.default&&C.default.locals?C.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":W=>{var $=[];function A(h){for(var v=-1,a=0;a<$.length;a++)if($[a].identifier===h){v=a;break}return v}function u(h,v){for(var a={},f=[],m=0;m<h.length;m++){var l=h[m],y=v.base?l[0]+v.base:l[0],g=a[y]||0,d="".concat(y," ").concat(g);a[y]=g+1;var p=A(d),C={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(p!==-1)$[p].references++,$[p].updater(C);else{var S=w(C,v);v.byIndex=m,$.splice(m,0,{identifier:d,updater:S,references:1})}f.push(d)}return f}function w(h,v){var a=v.domAPI(v);a.update(h);var f=function(l){if(l){if(l.css===h.css&&l.media===h.media&&l.sourceMap===h.sourceMap&&l.supports===h.supports&&l.layer===h.layer)return;a.update(h=l)}else a.remove()};return f}W.exports=function(h,v){v=v||{},h=h||[];var a=u(h,v);return function(m){m=m||[];for(var l=0;l<a.length;l++){var y=a[l],g=A(y);$[g].references--}for(var d=u(m,v),p=0;p<a.length;p++){var C=a[p],S=A(C);$[S].references===0&&($[S].updater(),$.splice(S,1))}a=d}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":W=>{var $={};function A(w){if(typeof $[w]>"u"){var h=document.querySelector(w);if(window.HTMLIFrameElement&&h instanceof window.HTMLIFrameElement)try{h=h.contentDocument.head}catch{h=null}$[w]=h}return $[w]}function u(w,h){var v=A(w);if(!v)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");v.appendChild(h)}W.exports=u},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":W=>{function $(A){var u=document.createElement("style");return A.setAttributes(u,A.attributes),A.insert(u,A.options),u}W.exports=$},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(W,$,A)=>{function u(w){var h=A.nc;h&&w.setAttribute("nonce",h)}W.exports=u},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":W=>{function $(w,h,v){var a="";v.supports&&(a+="@supports (".concat(v.supports,") {")),v.media&&(a+="@media ".concat(v.media," {"));var f=typeof v.layer<"u";f&&(a+="@layer".concat(v.layer.length>0?" ".concat(v.layer):""," {")),a+=v.css,f&&(a+="}"),v.media&&(a+="}"),v.supports&&(a+="}");var m=v.sourceMap;m&&typeof btoa<"u"&&(a+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(m))))," */")),h.styleTagTransform(a,w,h.options)}function A(w){if(w.parentNode===null)return!1;w.parentNode.removeChild(w)}function u(w){if(typeof document>"u")return{update:function(){},remove:function(){}};var h=w.insertStyleElement(w);return{update:function(a){$(h,w,a)},remove:function(){A(h)}}}W.exports=u},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":W=>{function $(A,u){if(u.styleSheet)u.styleSheet.cssText=A;else{for(;u.firstChild;)u.removeChild(u.firstChild);u.appendChild(document.createTextNode(A))}}W.exports=$},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":W=>{W.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":W=>{W.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":W=>{W.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":W=>{W.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":W=>{W.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/three/build/three.module.js":(W,$,A)=>{A.r($),A.d($,{ACESFilmicToneMapping:()=>Mt,AddEquation:()=>K,AddOperation:()=>Si,AdditiveAnimationBlendMode:()=>qt,AdditiveBlending:()=>T,AgXToneMapping:()=>ye,AlphaFormat:()=>es,AlwaysCompare:()=>Cl,AlwaysDepth:()=>Bt,AlwaysStencilFunc:()=>Qs,AmbientLight:()=>Wf,AnimationAction:()=>lp,AnimationClip:()=>pl,AnimationLoader:()=>Hv,AnimationMixer:()=>vy,AnimationObjectGroup:()=>my,AnimationUtils:()=>kv,ArcCurve:()=>lf,ArrayCamera:()=>jh,ArrowHelper:()=>Gy,AttachedBindMode:()=>Se,Audio:()=>sp,AudioAnalyser:()=>oy,AudioContext:()=>_u,AudioListener:()=>iy,AudioLoader:()=>ey,AxesHelper:()=>Qy,BackSide:()=>C,BasicDepthPacking:()=>dn,BasicShadowMap:()=>l,BatchedMesh:()=>Zd,Bone:()=>Jh,BooleanKeyframeTrack:()=>Xo,Box2:()=>My,Box3:()=>br,Box3Helper:()=>Ny,BoxGeometry:()=>Fo,BoxHelper:()=>Uy,BufferAttribute:()=>lr,BufferGeometry:()=>wi,BufferGeometryLoader:()=>Jf,ByteType:()=>Or,Cache:()=>so,Camera:()=>zl,CameraHelper:()=>Fy,CanvasTexture:()=>cv,CapsuleGeometry:()=>yc,CatmullRomCurve3:()=>cf,CineonToneMapping:()=>Kn,CircleGeometry:()=>Ec,ClampToEdgeWrapping:()=>He,Clock:()=>np,Color:()=>Sn,ColorKeyframeTrack:()=>yu,ColorManagement:()=>$i,CompressedArrayTexture:()=>av,CompressedCubeTexture:()=>lv,CompressedTexture:()=>Ac,CompressedTextureLoader:()=>zv,ConeGeometry:()=>Cc,ConstantAlphaFactor:()=>qe,ConstantColorFactor:()=>_e,CubeCamera:()=>ed,CubeReflectionMapping:()=>ee,CubeRefractionMapping:()=>D,CubeTexture:()=>Wa,CubeTextureLoader:()=>jv,CubeUVReflectionMapping:()=>xe,CubicBezierCurve:()=>au,CubicBezierCurve3:()=>uf,CubicInterpolant:()=>Of,CullFaceBack:()=>a,CullFaceFront:()=>f,CullFaceFrontBack:()=>m,CullFaceNone:()=>v,Curve:()=>Us,CurvePath:()=>ff,CustomBlending:()=>te,CustomToneMapping:()=>Ce,CylinderGeometry:()=>Da,Cylindrical:()=>_y,Data3DTexture:()=>hi,DataArrayTexture:()=>oa,DataTexture:()=>xo,DataTextureLoader:()=>Wv,DataUtils:()=>Fp,DecrementStencilOp:()=>Rr,DecrementWrapStencilOp:()=>Ds,DefaultLoadingManager:()=>Nf,DepthFormat:()=>lt,DepthStencilFormat:()=>wt,DepthTexture:()=>Gh,DetachedBindMode:()=>Re,DirectionalLight:()=>jf,DirectionalLightHelper:()=>Oy,DiscreteInterpolant:()=>Ff,DisplayP3ColorSpace:()=>qn,DodecahedronGeometry:()=>xc,DoubleSide:()=>S,DstAlphaFactor:()=>O,DstColorFactor:()=>J,DynamicCopyUsage:()=>$c,DynamicDrawUsage:()=>Kc,DynamicReadUsage:()=>qc,EdgesGeometry:()=>pf,EllipseCurve:()=>mc,EqualCompare:()=>Hs,EqualDepth:()=>nn,EqualStencilFunc:()=>Jr,EquirectangularReflectionMapping:()=>G,EquirectangularRefractionMapping:()=>ue,Euler:()=>ws,EventDispatcher:()=>as,ExtrudeGeometry:()=>Ic,FileLoader:()=>ao,Float16BufferAttribute:()=>Vp,Float32BufferAttribute:()=>Gn,FloatType:()=>ir,Fog:()=>Zl,FogExp2:()=>Jl,FramebufferTexture:()=>ov,FrontSide:()=>p,Frustum:()=>Ka,GLBufferAttribute:()=>xy,GLSL1:()=>th,GLSL3:()=>Ua,GreaterCompare:()=>ho,GreaterDepth:()=>kn,GreaterEqualCompare:()=>El,GreaterEqualDepth:()=>Jn,GreaterEqualStencilFunc:()=>Gs,GreaterStencilFunc:()=>ps,GridHelper:()=>Dy,Group:()=>Qo,HalfFloatType:()=>Li,HemisphereLight:()=>kf,HemisphereLightHelper:()=>Ly,IcosahedronGeometry:()=>Bc,ImageBitmapLoader:()=>$v,ImageLoader:()=>Al,ImageUtils:()=>Ao,IncrementStencilOp:()=>Ki,IncrementWrapStencilOp:()=>xr,InstancedBufferAttribute:()=>Ba,InstancedBufferGeometry:()=>qf,InstancedInterleavedBuffer:()=>Cy,InstancedMesh:()=>Yd,Int16BufferAttribute:()=>Gp,Int32BufferAttribute:()=>Qp,Int8BufferAttribute:()=>Up,IntType:()=>Fr,InterleavedBuffer:()=>$l,InterleavedBufferAttribute:()=>Ho,Interpolant:()=>ul,InterpolateDiscrete:()=>Je,InterpolateLinear:()=>Xe,InterpolateSmooth:()=>ht,InvertStencilOp:()=>jr,KeepStencilOp:()=>Hi,KeyframeTrack:()=>Ns,LOD:()=>kd,LatheGeometry:()=>sl,Layers:()=>Ll,LessCompare:()=>Vs,LessDepth:()=>kt,LessEqualCompare:()=>Ts,LessEqualDepth:()=>jt,LessEqualStencilFunc:()=>pr,LessStencilFunc:()=>qr,Light:()=>Mo,LightProbe:()=>Yf,Line:()=>wo,Line3:()=>Sy,LineBasicMaterial:()=>ds,LineCurve:()=>lu,LineCurve3:()=>df,LineDashedMaterial:()=>Lf,LineLoop:()=>rf,LineSegments:()=>Ws,LinearDisplayP3ColorSpace:()=>Un,LinearFilter:()=>Bn,LinearInterpolant:()=>vu,LinearMipMapLinearFilter:()=>Mr,LinearMipMapNearestFilter:()=>Ti,LinearMipmapLinearFilter:()=>Oi,LinearMipmapNearestFilter:()=>bi,LinearSRGBColorSpace:()=>ai,LinearToneMapping:()=>Ui,LinearTransfer:()=>fi,Loader:()=>ys,LoaderUtils:()=>wu,LoadingManager:()=>Eu,LoopOnce:()=>fe,LoopPingPong:()=>Qe,LoopRepeat:()=>Oe,LuminanceAlphaFormat:()=>At,LuminanceFormat:()=>tt,MOUSE:()=>w,Material:()=>is,MaterialLoader:()=>Uc,MathUtils:()=>vh,Matrix3:()=>ci,Matrix4:()=>On,MaxEquation:()=>Y,Mesh:()=>Dr,MeshBasicMaterial:()=>yo,MeshDepthMaterial:()=>Hh,MeshDistanceMaterial:()=>zh,MeshLambertMaterial:()=>Bf,MeshMatcapMaterial:()=>Rf,MeshNormalMaterial:()=>If,MeshPhongMaterial:()=>Sf,MeshPhysicalMaterial:()=>Mf,MeshStandardMaterial:()=>Au,MeshToonMaterial:()=>Tf,MinEquation:()=>re,MirroredRepeatWrapping:()=>Gt,MixOperation:()=>Wn,MultiplyBlending:()=>F,MultiplyOperation:()=>Fn,NearestFilter:()=>Yt,NearestMipMapLinearFilter:()=>nr,NearestMipMapNearestFilter:()=>zt,NearestMipmapLinearFilter:()=>fn,NearestMipmapNearestFilter:()=>Ht,NeutralToneMapping:()=>Fe,NeverCompare:()=>qs,NeverDepth:()=>Et,NeverStencilFunc:()=>Es,NoBlending:()=>_,NoColorSpace:()=>ei,NoToneMapping:()=>Zn,NormalAnimationBlendMode:()=>Ct,NormalBlending:()=>L,NotEqualCompare:()=>yl,NotEqualDepth:()=>xn,NotEqualStencilFunc:()=>ks,NumberKeyframeTrack:()=>dl,Object3D:()=>Yi,ObjectLoader:()=>Jv,ObjectSpaceNormalMap:()=>Vt,OctahedronGeometry:()=>cl,OneFactor:()=>oe,OneMinusConstantAlphaFactor:()=>ft,OneMinusConstantColorFactor:()=>Ze,OneMinusDstAlphaFactor:()=>Q,OneMinusDstColorFactor:()=>ve,OneMinusSrcAlphaFactor:()=>I,OneMinusSrcColorFactor:()=>Ae,OrthographicCamera:()=>Kl,P3Primaries:()=>cr,PCFShadowMap:()=>y,PCFSoftShadowMap:()=>g,PMREMGenerator:()=>Nh,Path:()=>rl,PerspectiveCamera:()=>Gr,Plane:()=>Co,PlaneGeometry:()=>xa,PlaneHelper:()=>ky,PointLight:()=>zf,PointLightHelper:()=>By,Points:()=>of,PointsMaterial:()=>tu,PolarGridHelper:()=>Py,PolyhedronGeometry:()=>_o,PositionalAudio:()=>sy,PropertyBinding:()=>ji,PropertyMixer:()=>ap,QuadraticBezierCurve:()=>cu,QuadraticBezierCurve3:()=>hu,Quaternion:()=>Xi,QuaternionKeyframeTrack:()=>Oa,QuaternionLinearInterpolant:()=>Uf,RED_GREEN_RGTC2_Format:()=>M,RED_RGTC1_Format:()=>Ee,REVISION:()=>u,RGBADepthPacking:()=>un,RGBAFormat:()=>Ge,RGBAIntegerFormat:()=>Rn,RGBA_ASTC_10x10_Format:()=>yt,RGBA_ASTC_10x5_Format:()=>It,RGBA_ASTC_10x6_Format:()=>St,RGBA_ASTC_10x8_Format:()=>it,RGBA_ASTC_12x10_Format:()=>Nt,RGBA_ASTC_12x12_Format:()=>_t,RGBA_ASTC_4x4_Format:()=>gi,RGBA_ASTC_5x4_Format:()=>z,RGBA_ASTC_5x5_Format:()=>q,RGBA_ASTC_6x5_Format:()=>ce,RGBA_ASTC_6x6_Format:()=>me,RGBA_ASTC_8x5_Format:()=>Me,RGBA_ASTC_8x6_Format:()=>Ke,RGBA_ASTC_8x8_Format:()=>et,RGBA_BPTC_Format:()=>Cn,RGBA_ETC2_EAC_Format:()=>or,RGBA_PVRTC_2BPPV1_Format:()=>Vi,RGBA_PVRTC_4BPPV1_Format:()=>Wi,RGBA_S3TC_DXT1_Format:()=>Xn,RGBA_S3TC_DXT3_Format:()=>Di,RGBA_S3TC_DXT5_Format:()=>si,RGBFormat:()=>Ie,RGB_BPTC_SIGNED_Format:()=>le,RGB_BPTC_UNSIGNED_Format:()=>he,RGB_ETC1_Format:()=>on,RGB_ETC2_Format:()=>oi,RGB_PVRTC_2BPPV1_Format:()=>pi,RGB_PVRTC_4BPPV1_Format:()=>ti,RGB_S3TC_DXT1_Format:()=>Pn,RGFormat:()=>tn,RGIntegerFormat:()=>bt,RawShaderMaterial:()=>_f,Ray:()=>kr,Raycaster:()=>by,Rec709Primaries:()=>Ni,RectAreaLight:()=>Kf,RedFormat:()=>Ft,RedIntegerFormat:()=>yn,ReinhardToneMapping:()=>Qi,RenderTarget:()=>sa,RepeatWrapping:()=>Ne,ReplaceStencilOp:()=>hr,ReverseSubtractEquation:()=>ne,RingGeometry:()=>Rc,SIGNED_RED_GREEN_RGTC2_Format:()=>Z,SIGNED_RED_RGTC1_Format:()=>R,SRGBColorSpace:()=>Mn,SRGBTransfer:()=>Qn,Scene:()=>Dd,ShaderChunk:()=>Ei,ShaderLib:()=>Fs,ShaderMaterial:()=>Os,ShadowMaterial:()=>wf,Shape:()=>jo,ShapeGeometry:()=>Lc,ShapePath:()=>Vy,ShapeUtils:()=>Ks,ShortType:()=>dr,Skeleton:()=>sc,SkeletonHelper:()=>Iy,SkinnedMesh:()=>jd,Source:()=>gr,Sphere:()=>Nr,SphereGeometry:()=>hl,Spherical:()=>wy,SphericalHarmonics3:()=>Xf,SplineCurve:()=>uu,SpotLight:()=>Vf,SpotLightHelper:()=>Ty,Sprite:()=>Ud,SpriteMaterial:()=>Kh,SrcAlphaFactor:()=>b,SrcAlphaSaturateFactor:()=>Le,SrcColorFactor:()=>ae,StaticCopyUsage:()=>Zc,StaticDrawUsage:()=>Ro,StaticReadUsage:()=>Yc,StereoCamera:()=>ty,StreamCopyUsage:()=>eh,StreamDrawUsage:()=>Xc,StreamReadUsage:()=>Jc,StringKeyframeTrack:()=>Yo,SubtractEquation:()=>se,SubtractiveBlending:()=>N,TOUCH:()=>h,TangentSpaceNormalMap:()=>pn,TetrahedronGeometry:()=>Dc,Texture:()=>fr,TextureLoader:()=>Kv,TorusGeometry:()=>Pc,TorusKnotGeometry:()=>Oc,Triangle:()=>_s,TriangleFanDrawMode:()=>Zt,TriangleStripDrawMode:()=>an,TrianglesDrawMode:()=>Jt,TubeGeometry:()=>Fc,UVMapping:()=>Ue,Uint16BufferAttribute:()=>Sh,Uint32BufferAttribute:()=>Th,Uint8BufferAttribute:()=>Np,Uint8ClampedBufferAttribute:()=>kp,Uniform:()=>Tu,UniformsGroup:()=>Ey,UniformsLib:()=>An,UniformsUtils:()=>Ju,UnsignedByteType:()=>$n,UnsignedInt248Type:()=>Ur,UnsignedInt5999Type:()=>os,UnsignedIntType:()=>Sr,UnsignedShort4444Type:()=>sr,UnsignedShort5551Type:()=>fs,UnsignedShortType:()=>Er,VSMShadowMap:()=>d,Vector2:()=>Lt,Vector3:()=>De,Vector4:()=>zi,VectorKeyframeTrack:()=>fl,VideoTexture:()=>sv,WebGL3DRenderTarget:()=>Fi,WebGLArrayRenderTarget:()=>Ln,WebGLCoordinateSystem:()=>Is,WebGLCubeRenderTarget:()=>td,WebGLMultipleRenderTargets:()=>Hy,WebGLRenderTarget:()=>As,WebGLRenderer:()=>q0,WebGLUtils:()=>Td,WebGPUCoordinateSystem:()=>Lo,WireframeGeometry:()=>Cf,WrapAroundEnding:()=>ut,ZeroCurvatureEnding:()=>ct,ZeroFactor:()=>k,ZeroSlopeEnding:()=>at,ZeroStencilOp:()=>Zi,createCanvasElement:()=>wl});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const u="164",w={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},h={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},v=0,a=1,f=2,m=3,l=0,y=1,g=2,d=3,p=0,C=1,S=2,_=0,L=1,T=2,N=3,F=4,te=5,K=100,se=101,ne=102,re=103,Y=104,k=200,oe=201,ae=202,Ae=203,b=204,I=205,O=206,Q=207,J=208,ve=209,Le=210,_e=211,Ze=212,qe=213,ft=214,Et=0,Bt=1,kt=2,jt=3,nn=4,Jn=5,kn=6,xn=7,Fn=0,Wn=1,Si=2,Zn=0,Ui=1,Qi=2,Kn=3,Mt=4,Ce=5,ye=6,Fe=7,Se="attached",Re="detached",Ue=300,ee=301,D=302,G=303,ue=304,xe=306,Ne=1e3,He=1001,Gt=1002,Yt=1003,Ht=1004,zt=1004,fn=1005,nr=1005,Bn=1006,bi=1007,Ti=1007,Oi=1008,Mr=1008,$n=1009,Or=1010,dr=1011,Er=1012,Fr=1013,Sr=1014,ir=1015,Li=1016,sr=1017,fs=1018,Ur=1020,os=35902,es=1021,Ie=1022,Ge=1023,tt=1024,At=1025,lt=1026,wt=1027,Ft=1028,yn=1029,tn=1030,bt=1031,Rn=1033,Pn=33776,Xn=33777,Di=33778,si=33779,ti=35840,pi=35841,Wi=35842,Vi=35843,on=36196,oi=37492,or=37496,gi=37808,z=37809,q=37810,ce=37811,me=37812,Me=37813,Ke=37814,et=37815,It=37816,St=37817,it=37818,yt=37819,Nt=37820,_t=37821,Cn=36492,le=36494,he=36495,Ee=36283,R=36284,M=36285,Z=36286,fe=2200,Oe=2201,Qe=2202,Je=2300,Xe=2301,ht=2302,ct=2400,at=2401,ut=2402,Ct=2500,qt=2501,Jt=0,an=1,Zt=2,dn=3200,un=3201,pn=0,Vt=1,ei="",Mn="srgb",ai="srgb-linear",qn="display-p3",Un="display-p3-linear",fi="linear",Qn="srgb",Ni="rec709",cr="p3",Zi=0,Hi=7680,hr=7681,Ki=7682,Rr=7683,xr=34055,Ds=34056,jr=5386,Es=512,qr=513,Jr=514,pr=515,ps=516,ks=517,Gs=518,Qs=519,qs=512,Vs=513,Hs=514,Ts=515,ho=516,yl=517,El=518,Cl=519,Ro=35044,Kc=35048,Xc=35040,Yc=35045,qc=35049,Jc=35041,Zc=35046,$c=35050,eh=35042,th="100",Ua="300 es",Is=2e3,Lo=2001;class as{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let r=0,o=i.length;r<o;r++)i[r].call(this,e);e.target=null}}}const Wr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let xl=1234567;const Js=Math.PI/180,uo=180/Math.PI;function ls(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Wr[s&255]+Wr[s>>8&255]+Wr[s>>16&255]+Wr[s>>24&255]+"-"+Wr[e&255]+Wr[e>>8&255]+"-"+Wr[e>>16&15|64]+Wr[e>>24&255]+"-"+Wr[t&63|128]+Wr[t>>8&255]+"-"+Wr[t>>16&255]+Wr[t>>24&255]+Wr[n&255]+Wr[n>>8&255]+Wr[n>>16&255]+Wr[n>>24&255]).toLowerCase()}function Cr(s,e,t){return Math.max(e,Math.min(t,s))}function Na(s,e){return(s%e+e)%e}function nh(s,e,t,n,i){return n+(s-e)*(i-n)/(t-e)}function ih(s,e,t){return s!==e?(t-s)/(e-s):0}function Do(s,e,t){return(1-t)*s+t*e}function rh(s,e,t,n){return Do(s,e,1-Math.exp(-t*n))}function sh(s,e=1){return e-Math.abs(Na(s,e*2)-e)}function oh(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function ah(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function lh(s,e){return s+Math.floor(Math.random()*(e-s+1))}function ch(s,e){return s+Math.random()*(e-s)}function hh(s){return s*(.5-Math.random())}function uh(s){s!==void 0&&(xl=s);let e=xl+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function dh(s){return s*Js}function fh(s){return s*uo}function ph(s){return(s&s-1)===0&&s!==0}function Ah(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function mh(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function gh(s,e,t,n,i){const r=Math.cos,o=Math.sin,c=r(t/2),E=o(t/2),x=r((e+n)/2),B=o((e+n)/2),P=r((e-n)/2),U=o((e-n)/2),V=r((n-e)/2),j=o((n-e)/2);switch(i){case"XYX":s.set(c*B,E*P,E*U,c*x);break;case"YZY":s.set(E*U,c*B,E*P,c*x);break;case"ZXZ":s.set(E*P,E*U,c*B,c*x);break;case"XZX":s.set(c*B,E*j,E*V,c*x);break;case"YXY":s.set(E*V,c*B,E*j,c*x);break;case"ZYZ":s.set(E*j,E*V,c*B,c*x);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Zr(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function ui(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const vh={DEG2RAD:Js,RAD2DEG:uo,generateUUID:ls,clamp:Cr,euclideanModulo:Na,mapLinear:nh,inverseLerp:ih,lerp:Do,damp:rh,pingpong:sh,smoothstep:oh,smootherstep:ah,randInt:lh,randFloat:ch,randFloatSpread:hh,seededRandom:uh,degToRad:dh,radToDeg:fh,isPowerOfTwo:ph,ceilPowerOfTwo:Ah,floorPowerOfTwo:mh,setQuaternionFromProperEuler:gh,normalize:ui,denormalize:Zr};class Lt{constructor(e=0,t=0){Lt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Cr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*i+e.x,this.y=r*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ci{constructor(e,t,n,i,r,o,c,E,x){ci.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,r,o,c,E,x)}set(e,t,n,i,r,o,c,E,x){const B=this.elements;return B[0]=e,B[1]=i,B[2]=c,B[3]=t,B[4]=r,B[5]=E,B[6]=n,B[7]=o,B[8]=x,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,o=n[0],c=n[3],E=n[6],x=n[1],B=n[4],P=n[7],U=n[2],V=n[5],j=n[8],ie=i[0],X=i[3],H=i[6],ge=i[1],pe=i[4],de=i[7],We=i[2],Pe=i[5],ke=i[8];return r[0]=o*ie+c*ge+E*We,r[3]=o*X+c*pe+E*Pe,r[6]=o*H+c*de+E*ke,r[1]=x*ie+B*ge+P*We,r[4]=x*X+B*pe+P*Pe,r[7]=x*H+B*de+P*ke,r[2]=U*ie+V*ge+j*We,r[5]=U*X+V*pe+j*Pe,r[8]=U*H+V*de+j*ke,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],c=e[5],E=e[6],x=e[7],B=e[8];return t*o*B-t*c*x-n*r*B+n*c*E+i*r*x-i*o*E}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],c=e[5],E=e[6],x=e[7],B=e[8],P=B*o-c*x,U=c*E-B*r,V=x*r-o*E,j=t*P+n*U+i*V;if(j===0)return this.set(0,0,0,0,0,0,0,0,0);const ie=1/j;return e[0]=P*ie,e[1]=(i*x-B*n)*ie,e[2]=(c*n-i*o)*ie,e[3]=U*ie,e[4]=(B*t-i*E)*ie,e[5]=(i*r-c*t)*ie,e[6]=V*ie,e[7]=(n*E-x*t)*ie,e[8]=(o*t-n*r)*ie,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,o,c){const E=Math.cos(r),x=Math.sin(r);return this.set(n*E,n*x,-n*(E*o+x*c)+o+e,-i*x,i*E,-i*(-x*o+E*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(ka.makeScale(e,t)),this}rotate(e){return this.premultiply(ka.makeRotation(-e)),this}translate(e,t){return this.premultiply(ka.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const ka=new ci;function bl(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const yh={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function fo(s,e){return new yh[s](e)}function Po(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function wl(){const s=Po("canvas");return s.style.display="block",s}const _l={};function Ml(s){s in _l||(_l[s]=!0,console.warn(s))}const Sl=new ci().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Tl=new ci().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),ia={[ai]:{transfer:fi,primaries:Ni,toReference:s=>s,fromReference:s=>s},[Mn]:{transfer:Qn,primaries:Ni,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[Un]:{transfer:fi,primaries:cr,toReference:s=>s.applyMatrix3(Tl),fromReference:s=>s.applyMatrix3(Sl)},[qn]:{transfer:Qn,primaries:cr,toReference:s=>s.convertSRGBToLinear().applyMatrix3(Tl),fromReference:s=>s.applyMatrix3(Sl).convertLinearToSRGB()}},Eh=new Set([ai,Un]),$i={enabled:!0,_workingColorSpace:ai,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!Eh.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,t){if(this.enabled===!1||e===t||!e||!t)return s;const n=ia[e].toReference,i=ia[t].fromReference;return i(n(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return ia[s].primaries},getTransfer:function(s){return s===ei?fi:ia[s].transfer}};function po(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function Ga(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let Zs;class Ao{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Zs===void 0&&(Zs=Po("canvas")),Zs.width=e.width,Zs.height=e.height;const n=Zs.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Zs}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Po("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let o=0;o<r.length;o++)r[o]=po(r[o]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(po(t[n]/255)*255):t[n]=po(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Il=0;class gr{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Il++}),this.uuid=ls(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let r;if(Array.isArray(i)){r=[];for(let o=0,c=i.length;o<c;o++)i[o].isDataTexture?r.push(ra(i[o].image)):r.push(ra(i[o]))}else r=ra(i);n.url=r}return t||(e.images[this.uuid]=n),n}}function ra(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?Ao.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Bl=0;class fr extends as{constructor(e=fr.DEFAULT_IMAGE,t=fr.DEFAULT_MAPPING,n=He,i=He,r=Bn,o=Oi,c=Ge,E=$n,x=fr.DEFAULT_ANISOTROPY,B=ei){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Bl++}),this.uuid=ls(),this.name="",this.source=new gr(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=o,this.anisotropy=x,this.format=c,this.internalFormat=null,this.type=E,this.offset=new Lt(0,0),this.repeat=new Lt(1,1),this.center=new Lt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ci,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=B,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Ue)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ne:e.x=e.x-Math.floor(e.x);break;case He:e.x=e.x<0?0:1;break;case Gt:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ne:e.y=e.y-Math.floor(e.y);break;case He:e.y=e.y<0?0:1;break;case Gt:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}fr.DEFAULT_IMAGE=null,fr.DEFAULT_MAPPING=Ue,fr.DEFAULT_ANISOTROPY=1;class zi{constructor(e=0,t=0,n=0,i=1){zi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const E=e.elements,x=E[0],B=E[4],P=E[8],U=E[1],V=E[5],j=E[9],ie=E[2],X=E[6],H=E[10];if(Math.abs(B-U)<.01&&Math.abs(P-ie)<.01&&Math.abs(j-X)<.01){if(Math.abs(B+U)<.1&&Math.abs(P+ie)<.1&&Math.abs(j+X)<.1&&Math.abs(x+V+H-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const pe=(x+1)/2,de=(V+1)/2,We=(H+1)/2,Pe=(B+U)/4,ke=(P+ie)/4,ze=(j+X)/4;return pe>de&&pe>We?pe<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(pe),i=Pe/n,r=ke/n):de>We?de<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(de),n=Pe/i,r=ze/i):We<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(We),n=ke/r,i=ze/r),this.set(n,i,r,t),this}let ge=Math.sqrt((X-j)*(X-j)+(P-ie)*(P-ie)+(U-B)*(U-B));return Math.abs(ge)<.001&&(ge=1),this.x=(X-j)/ge,this.y=(P-ie)/ge,this.z=(U-B)/ge,this.w=Math.acos((x+V+H-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class sa extends as{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new zi(0,0,e,t),this.scissorTest=!1,this.viewport=new zi(0,0,e,t);const i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const r=new fr(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let c=0;c<o;c++)this.textures[c]=r.clone(),this.textures[c].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new gr(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class As extends sa{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class oa extends fr{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Yt,this.minFilter=Yt,this.wrapR=He,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ln extends As{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new oa(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class hi extends fr{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Yt,this.minFilter=Yt,this.wrapR=He,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Fi extends As{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new hi(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Xi{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,o,c){let E=n[i+0],x=n[i+1],B=n[i+2],P=n[i+3];const U=r[o+0],V=r[o+1],j=r[o+2],ie=r[o+3];if(c===0){e[t+0]=E,e[t+1]=x,e[t+2]=B,e[t+3]=P;return}if(c===1){e[t+0]=U,e[t+1]=V,e[t+2]=j,e[t+3]=ie;return}if(P!==ie||E!==U||x!==V||B!==j){let X=1-c;const H=E*U+x*V+B*j+P*ie,ge=H>=0?1:-1,pe=1-H*H;if(pe>Number.EPSILON){const We=Math.sqrt(pe),Pe=Math.atan2(We,H*ge);X=Math.sin(X*Pe)/We,c=Math.sin(c*Pe)/We}const de=c*ge;if(E=E*X+U*de,x=x*X+V*de,B=B*X+j*de,P=P*X+ie*de,X===1-c){const We=1/Math.sqrt(E*E+x*x+B*B+P*P);E*=We,x*=We,B*=We,P*=We}}e[t]=E,e[t+1]=x,e[t+2]=B,e[t+3]=P}static multiplyQuaternionsFlat(e,t,n,i,r,o){const c=n[i],E=n[i+1],x=n[i+2],B=n[i+3],P=r[o],U=r[o+1],V=r[o+2],j=r[o+3];return e[t]=c*j+B*P+E*V-x*U,e[t+1]=E*j+B*U+x*P-c*V,e[t+2]=x*j+B*V+c*U-E*P,e[t+3]=B*j-c*P-E*U-x*V,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,i=e._y,r=e._z,o=e._order,c=Math.cos,E=Math.sin,x=c(n/2),B=c(i/2),P=c(r/2),U=E(n/2),V=E(i/2),j=E(r/2);switch(o){case"XYZ":this._x=U*B*P+x*V*j,this._y=x*V*P-U*B*j,this._z=x*B*j+U*V*P,this._w=x*B*P-U*V*j;break;case"YXZ":this._x=U*B*P+x*V*j,this._y=x*V*P-U*B*j,this._z=x*B*j-U*V*P,this._w=x*B*P+U*V*j;break;case"ZXY":this._x=U*B*P-x*V*j,this._y=x*V*P+U*B*j,this._z=x*B*j+U*V*P,this._w=x*B*P-U*V*j;break;case"ZYX":this._x=U*B*P-x*V*j,this._y=x*V*P+U*B*j,this._z=x*B*j-U*V*P,this._w=x*B*P+U*V*j;break;case"YZX":this._x=U*B*P+x*V*j,this._y=x*V*P+U*B*j,this._z=x*B*j-U*V*P,this._w=x*B*P-U*V*j;break;case"XZY":this._x=U*B*P-x*V*j,this._y=x*V*P-U*B*j,this._z=x*B*j+U*V*P,this._w=x*B*P+U*V*j;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],o=t[1],c=t[5],E=t[9],x=t[2],B=t[6],P=t[10],U=n+c+P;if(U>0){const V=.5/Math.sqrt(U+1);this._w=.25/V,this._x=(B-E)*V,this._y=(r-x)*V,this._z=(o-i)*V}else if(n>c&&n>P){const V=2*Math.sqrt(1+n-c-P);this._w=(B-E)/V,this._x=.25*V,this._y=(i+o)/V,this._z=(r+x)/V}else if(c>P){const V=2*Math.sqrt(1+c-n-P);this._w=(r-x)/V,this._x=(i+o)/V,this._y=.25*V,this._z=(E+B)/V}else{const V=2*Math.sqrt(1+P-n-c);this._w=(o-i)/V,this._x=(r+x)/V,this._y=(E+B)/V,this._z=.25*V}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Cr(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,o=e._w,c=t._x,E=t._y,x=t._z,B=t._w;return this._x=n*B+o*c+i*x-r*E,this._y=i*B+o*E+r*c-n*x,this._z=r*B+o*x+n*E-i*c,this._w=o*B-n*c-i*E-r*x,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,r=this._z,o=this._w;let c=o*e._w+n*e._x+i*e._y+r*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;const E=1-c*c;if(E<=Number.EPSILON){const V=1-t;return this._w=V*o+t*this._w,this._x=V*n+t*this._x,this._y=V*i+t*this._y,this._z=V*r+t*this._z,this.normalize(),this}const x=Math.sqrt(E),B=Math.atan2(x,c),P=Math.sin((1-t)*B)/x,U=Math.sin(t*B)/x;return this._w=o*P+this._w*U,this._x=n*P+this._x*U,this._y=i*P+this._y*U,this._z=r*P+this._z*U,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class De{constructor(e=0,t=0,n=0){De.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Tr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Tr.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,c=e.z,E=e.w,x=2*(o*i-c*n),B=2*(c*t-r*i),P=2*(r*n-o*t);return this.x=t+E*x+o*P-c*B,this.y=n+E*B+c*x-r*P,this.z=i+E*P+r*B-o*x,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,o=t.x,c=t.y,E=t.z;return this.x=i*E-r*c,this.y=r*o-n*E,this.z=n*c-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Cs.copy(this).projectOnVector(e),this.sub(Cs)}reflect(e){return this.sub(Cs.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Cr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Cs=new De,Tr=new Xi;class br{constructor(e=new De(1/0,1/0,1/0),t=new De(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(ts.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(ts.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=ts.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,c=r.count;o<c;o++)e.isMesh===!0?e.getVertexPosition(o,ts):ts.fromBufferAttribute(r,o),ts.applyMatrix4(e.matrixWorld),this.expandByPoint(ts);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),zs.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),zs.copy(n.boundingBox)),zs.applyMatrix4(e.matrixWorld),this.union(zs)}const i=e.children;for(let r=0,o=i.length;r<o;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ts),ts.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ki),ar.subVectors(this.max,ki),ms.subVectors(e.a,ki),Kr.subVectors(e.b,ki),vi.subVectors(e.c,ki),$r.subVectors(Kr,ms),xs.subVectors(vi,Kr),Xr.subVectors(ms,vi);let t=[0,-$r.z,$r.y,0,-xs.z,xs.y,0,-Xr.z,Xr.y,$r.z,0,-$r.x,xs.z,0,-xs.x,Xr.z,0,-Xr.x,-$r.y,$r.x,0,-xs.y,xs.x,0,-Xr.y,Xr.x,0];return!cs(t,ms,Kr,vi,ar)||(t=[1,0,0,0,1,0,0,0,1],!cs(t,ms,Kr,vi,ar))?!1:(yi.crossVectors($r,xs),t=[yi.x,yi.y,yi.z],cs(t,ms,Kr,vi,ar))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ts).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ts).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Pi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Pi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Pi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Pi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Pi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Pi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Pi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Pi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Pi),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Pi=[new De,new De,new De,new De,new De,new De,new De,new De],ts=new De,zs=new br,ms=new De,Kr=new De,vi=new De,$r=new De,xs=new De,Xr=new De,ki=new De,ar=new De,yi=new De,Gi=new De;function cs(s,e,t,n,i){for(let r=0,o=s.length-3;r<=o;r+=3){Gi.fromArray(s,r);const c=i.x*Math.abs(Gi.x)+i.y*Math.abs(Gi.y)+i.z*Math.abs(Gi.z),E=e.dot(Gi),x=t.dot(Gi),B=n.dot(Gi);if(Math.max(-Math.max(E,x,B),Math.min(E,x,B))>c)return!1}return!0}const mo=new br,$s=new De,aa=new De;class Nr{constructor(e=new De,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):mo.setFromPoints(e).getCenter(n);let i=0;for(let r=0,o=e.length;r<o;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$s.subVectors(e,this.center);const t=$s.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector($s,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(aa.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($s.copy(e.center).add(aa)),this.expandByPoint($s.copy(e.center).sub(aa))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Bs=new De,la=new De,ca=new De,js=new De,Qa=new De,ha=new De,Va=new De;class kr{constructor(e=new De,t=new De(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Bs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Bs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Bs.copy(this.origin).addScaledVector(this.direction,t),Bs.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){la.copy(e).add(t).multiplyScalar(.5),ca.copy(t).sub(e).normalize(),js.copy(this.origin).sub(la);const r=e.distanceTo(t)*.5,o=-this.direction.dot(ca),c=js.dot(this.direction),E=-js.dot(ca),x=js.lengthSq(),B=Math.abs(1-o*o);let P,U,V,j;if(B>0)if(P=o*E-c,U=o*c-E,j=r*B,P>=0)if(U>=-j)if(U<=j){const ie=1/B;P*=ie,U*=ie,V=P*(P+o*U+2*c)+U*(o*P+U+2*E)+x}else U=r,P=Math.max(0,-(o*U+c)),V=-P*P+U*(U+2*E)+x;else U=-r,P=Math.max(0,-(o*U+c)),V=-P*P+U*(U+2*E)+x;else U<=-j?(P=Math.max(0,-(-o*r+c)),U=P>0?-r:Math.min(Math.max(-r,-E),r),V=-P*P+U*(U+2*E)+x):U<=j?(P=0,U=Math.min(Math.max(-r,-E),r),V=U*(U+2*E)+x):(P=Math.max(0,-(o*r+c)),U=P>0?r:Math.min(Math.max(-r,-E),r),V=-P*P+U*(U+2*E)+x);else U=o>0?-r:r,P=Math.max(0,-(o*U+c)),V=-P*P+U*(U+2*E)+x;return n&&n.copy(this.origin).addScaledVector(this.direction,P),i&&i.copy(la).addScaledVector(ca,U),V}intersectSphere(e,t){Bs.subVectors(e.center,this.origin);const n=Bs.dot(this.direction),i=Bs.dot(Bs)-n*n,r=e.radius*e.radius;if(i>r)return null;const o=Math.sqrt(r-i),c=n-o,E=n+o;return E<0?null:c<0?this.at(E,t):this.at(c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,o,c,E;const x=1/this.direction.x,B=1/this.direction.y,P=1/this.direction.z,U=this.origin;return x>=0?(n=(e.min.x-U.x)*x,i=(e.max.x-U.x)*x):(n=(e.max.x-U.x)*x,i=(e.min.x-U.x)*x),B>=0?(r=(e.min.y-U.y)*B,o=(e.max.y-U.y)*B):(r=(e.max.y-U.y)*B,o=(e.min.y-U.y)*B),n>o||r>i||((r>n||isNaN(n))&&(n=r),(o<i||isNaN(i))&&(i=o),P>=0?(c=(e.min.z-U.z)*P,E=(e.max.z-U.z)*P):(c=(e.max.z-U.z)*P,E=(e.min.z-U.z)*P),n>E||c>i)||((c>n||n!==n)&&(n=c),(E<i||i!==i)&&(i=E),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,Bs)!==null}intersectTriangle(e,t,n,i,r){Qa.subVectors(t,e),ha.subVectors(n,e),Va.crossVectors(Qa,ha);let o=this.direction.dot(Va),c;if(o>0){if(i)return null;c=1}else if(o<0)c=-1,o=-o;else return null;js.subVectors(this.origin,e);const E=c*this.direction.dot(ha.crossVectors(js,ha));if(E<0)return null;const x=c*this.direction.dot(Qa.cross(js));if(x<0||E+x>o)return null;const B=-c*js.dot(Va);return B<0?null:this.at(B/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class On{constructor(e,t,n,i,r,o,c,E,x,B,P,U,V,j,ie,X){On.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,r,o,c,E,x,B,P,U,V,j,ie,X)}set(e,t,n,i,r,o,c,E,x,B,P,U,V,j,ie,X){const H=this.elements;return H[0]=e,H[4]=t,H[8]=n,H[12]=i,H[1]=r,H[5]=o,H[9]=c,H[13]=E,H[2]=x,H[6]=B,H[10]=P,H[14]=U,H[3]=V,H[7]=j,H[11]=ie,H[15]=X,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new On().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/eo.setFromMatrixColumn(e,0).length(),r=1/eo.setFromMatrixColumn(e,1).length(),o=1/eo.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),c=Math.sin(n),E=Math.cos(i),x=Math.sin(i),B=Math.cos(r),P=Math.sin(r);if(e.order==="XYZ"){const U=o*B,V=o*P,j=c*B,ie=c*P;t[0]=E*B,t[4]=-E*P,t[8]=x,t[1]=V+j*x,t[5]=U-ie*x,t[9]=-c*E,t[2]=ie-U*x,t[6]=j+V*x,t[10]=o*E}else if(e.order==="YXZ"){const U=E*B,V=E*P,j=x*B,ie=x*P;t[0]=U+ie*c,t[4]=j*c-V,t[8]=o*x,t[1]=o*P,t[5]=o*B,t[9]=-c,t[2]=V*c-j,t[6]=ie+U*c,t[10]=o*E}else if(e.order==="ZXY"){const U=E*B,V=E*P,j=x*B,ie=x*P;t[0]=U-ie*c,t[4]=-o*P,t[8]=j+V*c,t[1]=V+j*c,t[5]=o*B,t[9]=ie-U*c,t[2]=-o*x,t[6]=c,t[10]=o*E}else if(e.order==="ZYX"){const U=o*B,V=o*P,j=c*B,ie=c*P;t[0]=E*B,t[4]=j*x-V,t[8]=U*x+ie,t[1]=E*P,t[5]=ie*x+U,t[9]=V*x-j,t[2]=-x,t[6]=c*E,t[10]=o*E}else if(e.order==="YZX"){const U=o*E,V=o*x,j=c*E,ie=c*x;t[0]=E*B,t[4]=ie-U*P,t[8]=j*P+V,t[1]=P,t[5]=o*B,t[9]=-c*B,t[2]=-x*B,t[6]=V*P+j,t[10]=U-ie*P}else if(e.order==="XZY"){const U=o*E,V=o*x,j=c*E,ie=c*x;t[0]=E*B,t[4]=-P,t[8]=x*B,t[1]=U*P+ie,t[5]=o*B,t[9]=V*P-j,t[2]=j*P-V,t[6]=c*B,t[10]=ie*P+U}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Tp,e,Ip)}lookAt(e,t,n){const i=this.elements;return bs.subVectors(e,t),bs.lengthSq()===0&&(bs.z=1),bs.normalize(),go.crossVectors(n,bs),go.lengthSq()===0&&(Math.abs(n.z)===1?bs.x+=1e-4:bs.z+=1e-4,bs.normalize(),go.crossVectors(n,bs)),go.normalize(),Rl.crossVectors(bs,go),i[0]=go.x,i[4]=Rl.x,i[8]=bs.x,i[1]=go.y,i[5]=Rl.y,i[9]=bs.y,i[2]=go.z,i[6]=Rl.z,i[10]=bs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,o=n[0],c=n[4],E=n[8],x=n[12],B=n[1],P=n[5],U=n[9],V=n[13],j=n[2],ie=n[6],X=n[10],H=n[14],ge=n[3],pe=n[7],de=n[11],We=n[15],Pe=i[0],ke=i[4],ze=i[8],Te=i[12],be=i[1],je=i[5],nt=i[9],$e=i[13],rt=i[2],mt=i[6],Rt=i[10],ln=i[14],vt=i[3],en=i[7],rn=i[11],Dn=i[15];return r[0]=o*Pe+c*be+E*rt+x*vt,r[4]=o*ke+c*je+E*mt+x*en,r[8]=o*ze+c*nt+E*Rt+x*rn,r[12]=o*Te+c*$e+E*ln+x*Dn,r[1]=B*Pe+P*be+U*rt+V*vt,r[5]=B*ke+P*je+U*mt+V*en,r[9]=B*ze+P*nt+U*Rt+V*rn,r[13]=B*Te+P*$e+U*ln+V*Dn,r[2]=j*Pe+ie*be+X*rt+H*vt,r[6]=j*ke+ie*je+X*mt+H*en,r[10]=j*ze+ie*nt+X*Rt+H*rn,r[14]=j*Te+ie*$e+X*ln+H*Dn,r[3]=ge*Pe+pe*be+de*rt+We*vt,r[7]=ge*ke+pe*je+de*mt+We*en,r[11]=ge*ze+pe*nt+de*Rt+We*rn,r[15]=ge*Te+pe*$e+de*ln+We*Dn,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],c=e[5],E=e[9],x=e[13],B=e[2],P=e[6],U=e[10],V=e[14],j=e[3],ie=e[7],X=e[11],H=e[15];return j*(+r*E*P-i*x*P-r*c*U+n*x*U+i*c*V-n*E*V)+ie*(+t*E*V-t*x*U+r*o*U-i*o*V+i*x*B-r*E*B)+X*(+t*x*P-t*c*V-r*o*P+n*o*V+r*c*B-n*x*B)+H*(-i*c*B-t*E*P+t*c*U+i*o*P-n*o*U+n*E*B)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],c=e[5],E=e[6],x=e[7],B=e[8],P=e[9],U=e[10],V=e[11],j=e[12],ie=e[13],X=e[14],H=e[15],ge=P*X*x-ie*U*x+ie*E*V-c*X*V-P*E*H+c*U*H,pe=j*U*x-B*X*x-j*E*V+o*X*V+B*E*H-o*U*H,de=B*ie*x-j*P*x+j*c*V-o*ie*V-B*c*H+o*P*H,We=j*P*E-B*ie*E-j*c*U+o*ie*U+B*c*X-o*P*X,Pe=t*ge+n*pe+i*de+r*We;if(Pe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ke=1/Pe;return e[0]=ge*ke,e[1]=(ie*U*r-P*X*r-ie*i*V+n*X*V+P*i*H-n*U*H)*ke,e[2]=(c*X*r-ie*E*r+ie*i*x-n*X*x-c*i*H+n*E*H)*ke,e[3]=(P*E*r-c*U*r-P*i*x+n*U*x+c*i*V-n*E*V)*ke,e[4]=pe*ke,e[5]=(B*X*r-j*U*r+j*i*V-t*X*V-B*i*H+t*U*H)*ke,e[6]=(j*E*r-o*X*r-j*i*x+t*X*x+o*i*H-t*E*H)*ke,e[7]=(o*U*r-B*E*r+B*i*x-t*U*x-o*i*V+t*E*V)*ke,e[8]=de*ke,e[9]=(j*P*r-B*ie*r-j*n*V+t*ie*V+B*n*H-t*P*H)*ke,e[10]=(o*ie*r-j*c*r+j*n*x-t*ie*x-o*n*H+t*c*H)*ke,e[11]=(B*c*r-o*P*r-B*n*x+t*P*x+o*n*V-t*c*V)*ke,e[12]=We*ke,e[13]=(B*ie*i-j*P*i+j*n*U-t*ie*U-B*n*X+t*P*X)*ke,e[14]=(j*c*i-o*ie*i-j*n*E+t*ie*E+o*n*X-t*c*X)*ke,e[15]=(o*P*i-B*c*i+B*n*E-t*P*E-o*n*U+t*c*U)*ke,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,c=e.y,E=e.z,x=r*o,B=r*c;return this.set(x*o+n,x*c-i*E,x*E+i*c,0,x*c+i*E,B*c+n,B*E-i*o,0,x*E-i*c,B*E+i*o,r*E*E+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,o){return this.set(1,n,r,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,o=t._y,c=t._z,E=t._w,x=r+r,B=o+o,P=c+c,U=r*x,V=r*B,j=r*P,ie=o*B,X=o*P,H=c*P,ge=E*x,pe=E*B,de=E*P,We=n.x,Pe=n.y,ke=n.z;return i[0]=(1-(ie+H))*We,i[1]=(V+de)*We,i[2]=(j-pe)*We,i[3]=0,i[4]=(V-de)*Pe,i[5]=(1-(U+H))*Pe,i[6]=(X+ge)*Pe,i[7]=0,i[8]=(j+pe)*ke,i[9]=(X-ge)*ke,i[10]=(1-(U+ie))*ke,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=eo.set(i[0],i[1],i[2]).length();const o=eo.set(i[4],i[5],i[6]).length(),c=eo.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],gs.copy(this);const x=1/r,B=1/o,P=1/c;return gs.elements[0]*=x,gs.elements[1]*=x,gs.elements[2]*=x,gs.elements[4]*=B,gs.elements[5]*=B,gs.elements[6]*=B,gs.elements[8]*=P,gs.elements[9]*=P,gs.elements[10]*=P,t.setFromRotationMatrix(gs),n.x=r,n.y=o,n.z=c,this}makePerspective(e,t,n,i,r,o,c=Is){const E=this.elements,x=2*r/(t-e),B=2*r/(n-i),P=(t+e)/(t-e),U=(n+i)/(n-i);let V,j;if(c===Is)V=-(o+r)/(o-r),j=-2*o*r/(o-r);else if(c===Lo)V=-o/(o-r),j=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return E[0]=x,E[4]=0,E[8]=P,E[12]=0,E[1]=0,E[5]=B,E[9]=U,E[13]=0,E[2]=0,E[6]=0,E[10]=V,E[14]=j,E[3]=0,E[7]=0,E[11]=-1,E[15]=0,this}makeOrthographic(e,t,n,i,r,o,c=Is){const E=this.elements,x=1/(t-e),B=1/(n-i),P=1/(o-r),U=(t+e)*x,V=(n+i)*B;let j,ie;if(c===Is)j=(o+r)*P,ie=-2*P;else if(c===Lo)j=r*P,ie=-1*P;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return E[0]=2*x,E[4]=0,E[8]=0,E[12]=-U,E[1]=0,E[5]=2*B,E[9]=0,E[13]=-V,E[2]=0,E[6]=0,E[10]=ie,E[14]=-j,E[3]=0,E[7]=0,E[11]=0,E[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const eo=new De,gs=new On,Tp=new De(0,0,0),Ip=new De(1,1,1),go=new De,Rl=new De,bs=new De,Fu=new On,Uu=new Xi;class ws{constructor(e=0,t=0,n=0,i=ws.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,r=i[0],o=i[4],c=i[8],E=i[1],x=i[5],B=i[9],P=i[2],U=i[6],V=i[10];switch(t){case"XYZ":this._y=Math.asin(Cr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-B,V),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(U,x),this._z=0);break;case"YXZ":this._x=Math.asin(-Cr(B,-1,1)),Math.abs(B)<.9999999?(this._y=Math.atan2(c,V),this._z=Math.atan2(E,x)):(this._y=Math.atan2(-P,r),this._z=0);break;case"ZXY":this._x=Math.asin(Cr(U,-1,1)),Math.abs(U)<.9999999?(this._y=Math.atan2(-P,V),this._z=Math.atan2(-o,x)):(this._y=0,this._z=Math.atan2(E,r));break;case"ZYX":this._y=Math.asin(-Cr(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(U,V),this._z=Math.atan2(E,r)):(this._x=0,this._z=Math.atan2(-o,x));break;case"YZX":this._z=Math.asin(Cr(E,-1,1)),Math.abs(E)<.9999999?(this._x=Math.atan2(-B,x),this._y=Math.atan2(-P,r)):(this._x=0,this._y=Math.atan2(c,V));break;case"XZY":this._z=Math.asin(-Cr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(U,x),this._y=Math.atan2(c,r)):(this._x=Math.atan2(-B,V),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Fu.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Fu,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Uu.setFromEuler(this),this.setFromQuaternion(Uu,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ws.DEFAULT_ORDER="XYZ";class Ll{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Bp=0;const Nu=new De,ua=new Xi,to=new On,Dl=new De,Ha=new De,Rp=new De,Lp=new Xi,ku=new De(1,0,0),Gu=new De(0,1,0),Qu=new De(0,0,1),Vu={type:"added"},Dp={type:"removed"},da={type:"childadded",child:null},Ch={type:"childremoved",child:null};class Yi extends as{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Bp++}),this.uuid=ls(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Yi.DEFAULT_UP.clone();const e=new De,t=new ws,n=new Xi,i=new De(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new On},normalMatrix:{value:new ci}}),this.matrix=new On,this.matrixWorld=new On,this.matrixAutoUpdate=Yi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Yi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ll,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ua.setFromAxisAngle(e,t),this.quaternion.multiply(ua),this}rotateOnWorldAxis(e,t){return ua.setFromAxisAngle(e,t),this.quaternion.premultiply(ua),this}rotateX(e){return this.rotateOnAxis(ku,e)}rotateY(e){return this.rotateOnAxis(Gu,e)}rotateZ(e){return this.rotateOnAxis(Qu,e)}translateOnAxis(e,t){return Nu.copy(e).applyQuaternion(this.quaternion),this.position.add(Nu.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ku,e)}translateY(e){return this.translateOnAxis(Gu,e)}translateZ(e){return this.translateOnAxis(Qu,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(to.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Dl.copy(e):Dl.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ha.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?to.lookAt(Ha,Dl,this.up):to.lookAt(Dl,Ha,this.up),this.quaternion.setFromRotationMatrix(to),i&&(to.extractRotation(i.matrixWorld),ua.setFromRotationMatrix(to),this.quaternion.premultiply(ua.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Vu),da.child=e,this.dispatchEvent(da),da.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Dp),Ch.child=e,this.dispatchEvent(Ch),Ch.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),to.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),to.multiply(e.parent.matrixWorld)),e.applyMatrix4(to),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Vu),da.child=e,this.dispatchEvent(da),da.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ha,e,Rp),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ha,Lp,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){const r=t[n];(r.matrixWorldAutoUpdate===!0||e===!0)&&r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let r=0,o=i.length;r<o;r++){const c=i[r];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function r(c,E){return c[E.uuid]===void 0&&(c[E.uuid]=E.toJSON(e)),E.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const E=c.shapes;if(Array.isArray(E))for(let x=0,B=E.length;x<B;x++){const P=E[x];r(e.shapes,P)}else r(e.shapes,E)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let E=0,x=this.material.length;E<x;E++)c.push(r(e.materials,this.material[E]));i.material=c}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let c=0;c<this.children.length;c++)i.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let c=0;c<this.animations.length;c++){const E=this.animations[c];i.animations.push(r(e.animations,E))}}if(t){const c=o(e.geometries),E=o(e.materials),x=o(e.textures),B=o(e.images),P=o(e.shapes),U=o(e.skeletons),V=o(e.animations),j=o(e.nodes);c.length>0&&(n.geometries=c),E.length>0&&(n.materials=E),x.length>0&&(n.textures=x),B.length>0&&(n.images=B),P.length>0&&(n.shapes=P),U.length>0&&(n.skeletons=U),V.length>0&&(n.animations=V),j.length>0&&(n.nodes=j)}return n.object=i,n;function o(c){const E=[];for(const x in c){const B=c[x];delete B.metadata,E.push(B)}return E}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}Yi.DEFAULT_UP=new De(0,1,0),Yi.DEFAULT_MATRIX_AUTO_UPDATE=!0,Yi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ps=new De,no=new De,xh=new De,io=new De,fa=new De,pa=new De,Hu=new De,bh=new De,wh=new De,_h=new De;class _s{constructor(e=new De,t=new De,n=new De){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Ps.subVectors(e,t),i.cross(Ps);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){Ps.subVectors(i,t),no.subVectors(n,t),xh.subVectors(e,t);const o=Ps.dot(Ps),c=Ps.dot(no),E=Ps.dot(xh),x=no.dot(no),B=no.dot(xh),P=o*x-c*c;if(P===0)return r.set(0,0,0),null;const U=1/P,V=(x*E-c*B)*U,j=(o*B-c*E)*U;return r.set(1-V-j,j,V)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,io)===null?!1:io.x>=0&&io.y>=0&&io.x+io.y<=1}static getInterpolation(e,t,n,i,r,o,c,E){return this.getBarycoord(e,t,n,i,io)===null?(E.x=0,E.y=0,"z"in E&&(E.z=0),"w"in E&&(E.w=0),null):(E.setScalar(0),E.addScaledVector(r,io.x),E.addScaledVector(o,io.y),E.addScaledVector(c,io.z),E)}static isFrontFacing(e,t,n,i){return Ps.subVectors(n,t),no.subVectors(e,t),Ps.cross(no).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ps.subVectors(this.c,this.b),no.subVectors(this.a,this.b),Ps.cross(no).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(e){return _s.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return _s.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return _s.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return _s.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return _s.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let o,c;fa.subVectors(i,n),pa.subVectors(r,n),bh.subVectors(e,n);const E=fa.dot(bh),x=pa.dot(bh);if(E<=0&&x<=0)return t.copy(n);wh.subVectors(e,i);const B=fa.dot(wh),P=pa.dot(wh);if(B>=0&&P<=B)return t.copy(i);const U=E*P-B*x;if(U<=0&&E>=0&&B<=0)return o=E/(E-B),t.copy(n).addScaledVector(fa,o);_h.subVectors(e,r);const V=fa.dot(_h),j=pa.dot(_h);if(j>=0&&V<=j)return t.copy(r);const ie=V*x-E*j;if(ie<=0&&x>=0&&j<=0)return c=x/(x-j),t.copy(n).addScaledVector(pa,c);const X=B*j-V*P;if(X<=0&&P-B>=0&&V-j>=0)return Hu.subVectors(r,i),c=(P-B)/(P-B+(V-j)),t.copy(i).addScaledVector(Hu,c);const H=1/(X+ie+U);return o=ie*H,c=U*H,t.copy(n).addScaledVector(fa,o).addScaledVector(pa,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const zu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vo={h:0,s:0,l:0},Pl={h:0,s:0,l:0};function Mh(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<.16666666666666666?s+(e-s)*6*t:t<.5?e:t<.6666666666666666?s+(e-s)*6*(.6666666666666666-t):s}class Sn{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Mn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,$i.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=$i.workingColorSpace){return this.r=e,this.g=t,this.b=n,$i.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=$i.workingColorSpace){if(e=Na(e,1),t=Cr(t,0,1),n=Cr(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=Mh(o,r,e+.3333333333333333),this.g=Mh(o,r,e),this.b=Mh(o,r,e-.3333333333333333)}return $i.toWorkingColorSpace(this,i),this}setStyle(e,t=Mn){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=i[1],c=i[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=i[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Mn){const n=zu[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=po(e.r),this.g=po(e.g),this.b=po(e.b),this}copyLinearToSRGB(e){return this.r=Ga(e.r),this.g=Ga(e.g),this.b=Ga(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Mn){return $i.fromWorkingColorSpace(ns.copy(this),e),Math.round(Cr(ns.r*255,0,255))*65536+Math.round(Cr(ns.g*255,0,255))*256+Math.round(Cr(ns.b*255,0,255))}getHexString(e=Mn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=$i.workingColorSpace){$i.fromWorkingColorSpace(ns.copy(this),t);const n=ns.r,i=ns.g,r=ns.b,o=Math.max(n,i,r),c=Math.min(n,i,r);let E,x;const B=(c+o)/2;if(c===o)E=0,x=0;else{const P=o-c;switch(x=B<=.5?P/(o+c):P/(2-o-c),o){case n:E=(i-r)/P+(i<r?6:0);break;case i:E=(r-n)/P+2;break;case r:E=(n-i)/P+4;break}E/=6}return e.h=E,e.s=x,e.l=B,e}getRGB(e,t=$i.workingColorSpace){return $i.fromWorkingColorSpace(ns.copy(this),t),e.r=ns.r,e.g=ns.g,e.b=ns.b,e}getStyle(e=Mn){$i.fromWorkingColorSpace(ns.copy(this),e);const t=ns.r,n=ns.g,i=ns.b;return e!==Mn?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(vo),this.setHSL(vo.h+e,vo.s+t,vo.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(vo),e.getHSL(Pl);const n=Do(vo.h,Pl.h,t),i=Do(vo.s,Pl.s,t),r=Do(vo.l,Pl.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ns=new Sn;Sn.NAMES=zu;let Pp=0;class is extends as{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Pp++}),this.uuid=ls(),this.name="",this.type="Material",this.blending=L,this.side=p,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=b,this.blendDst=I,this.blendEquation=K,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Sn(0,0,0),this.blendAlpha=0,this.depthFunc=jt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Qs,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Hi,this.stencilZFail=Hi,this.stencilZPass=Hi,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==L&&(n.blending=this.blending),this.side!==p&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==b&&(n.blendSrc=this.blendSrc),this.blendDst!==I&&(n.blendDst=this.blendDst),this.blendEquation!==K&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==jt&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Qs&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Hi&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Hi&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Hi&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(r){const o=[];for(const c in r){const E=r[c];delete E.metadata,o.push(E)}return o}if(t){const r=i(e.textures),o=i(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class yo extends is{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Sn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ws,this.combine=Fn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const ro=Op();function Op(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),i=new Uint32Array(512);for(let E=0;E<256;++E){const x=E-127;x<-27?(n[E]=0,n[E|256]=32768,i[E]=24,i[E|256]=24):x<-14?(n[E]=1024>>-x-14,n[E|256]=1024>>-x-14|32768,i[E]=-x-1,i[E|256]=-x-1):x<=15?(n[E]=x+15<<10,n[E|256]=x+15<<10|32768,i[E]=13,i[E|256]=13):x<128?(n[E]=31744,n[E|256]=64512,i[E]=24,i[E|256]=24):(n[E]=31744,n[E|256]=64512,i[E]=13,i[E|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),c=new Uint32Array(64);for(let E=1;E<1024;++E){let x=E<<13,B=0;for(;!(x&8388608);)x<<=1,B-=8388608;x&=-8388609,B+=947912704,r[E]=x|B}for(let E=1024;E<2048;++E)r[E]=939524096+(E-1024<<13);for(let E=1;E<31;++E)o[E]=E<<23;o[31]=1199570944,o[32]=2147483648;for(let E=33;E<63;++E)o[E]=2147483648+(E-32<<23);o[63]=3347054592;for(let E=1;E<64;++E)E!==32&&(c[E]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:r,exponentTable:o,offsetTable:c}}function vs(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=Cr(s,-65504,65504),ro.floatView[0]=s;const e=ro.uint32View[0],t=e>>23&511;return ro.baseTable[t]+((e&8388607)>>ro.shiftTable[t])}function za(s){const e=s>>10;return ro.uint32View[0]=ro.mantissaTable[ro.offsetTable[e]+(s&1023)]+ro.exponentTable[e],ro.floatView[0]}const Fp={toHalfFloat:vs,fromHalfFloat:za},Lr=new De,Ol=new Lt;class lr{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Ro,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ir,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Ml("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Ol.fromBufferAttribute(this,t),Ol.applyMatrix3(e),this.setXY(t,Ol.x,Ol.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Lr.fromBufferAttribute(this,t),Lr.applyMatrix3(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Lr.fromBufferAttribute(this,t),Lr.applyMatrix4(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Lr.fromBufferAttribute(this,t),Lr.applyNormalMatrix(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Lr.fromBufferAttribute(this,t),Lr.transformDirection(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Zr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ui(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Zr(t,this.array)),t}setX(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Zr(t,this.array)),t}setY(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Zr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Zr(t,this.array)),t}setW(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),i=ui(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),i=ui(i,this.array),r=ui(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Ro&&(e.usage=this.usage),e}}class Up extends lr{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Np extends lr{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class kp extends lr{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Gp extends lr{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Sh extends lr{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Qp extends lr{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Th extends lr{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Vp extends lr{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=za(this.array[e*this.itemSize]);return this.normalized&&(t=Zr(t,this.array)),t}setX(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize]=vs(t),this}getY(e){let t=za(this.array[e*this.itemSize+1]);return this.normalized&&(t=Zr(t,this.array)),t}setY(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+1]=vs(t),this}getZ(e){let t=za(this.array[e*this.itemSize+2]);return this.normalized&&(t=Zr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+2]=vs(t),this}getW(e){let t=za(this.array[e*this.itemSize+3]);return this.normalized&&(t=Zr(t,this.array)),t}setW(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+3]=vs(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array)),this.array[e+0]=vs(t),this.array[e+1]=vs(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),i=ui(i,this.array)),this.array[e+0]=vs(t),this.array[e+1]=vs(n),this.array[e+2]=vs(i),this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),i=ui(i,this.array),r=ui(r,this.array)),this.array[e+0]=vs(t),this.array[e+1]=vs(n),this.array[e+2]=vs(i),this.array[e+3]=vs(r),this}}class Gn extends lr{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Hp=0;const Rs=new On,Ih=new Yi,Aa=new De,Ms=new br,ja=new br,Yr=new De;class wi extends as{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Hp++}),this.uuid=ls(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(bl(e)?Th:Sh)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new ci().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Rs.makeRotationFromQuaternion(e),this.applyMatrix4(Rs),this}rotateX(e){return Rs.makeRotationX(e),this.applyMatrix4(Rs),this}rotateY(e){return Rs.makeRotationY(e),this.applyMatrix4(Rs),this}rotateZ(e){return Rs.makeRotationZ(e),this.applyMatrix4(Rs),this}translate(e,t,n){return Rs.makeTranslation(e,t,n),this.applyMatrix4(Rs),this}scale(e,t,n){return Rs.makeScale(e,t,n),this.applyMatrix4(Rs),this}lookAt(e){return Ih.lookAt(e),Ih.updateMatrix(),this.applyMatrix4(Ih.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Aa).negate(),this.translate(Aa.x,Aa.y,Aa.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Gn(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new br);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new De(-1/0,-1/0,-1/0),new De(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const r=t[n];Ms.setFromBufferAttribute(r),this.morphTargetsRelative?(Yr.addVectors(this.boundingBox.min,Ms.min),this.boundingBox.expandByPoint(Yr),Yr.addVectors(this.boundingBox.max,Ms.max),this.boundingBox.expandByPoint(Yr)):(this.boundingBox.expandByPoint(Ms.min),this.boundingBox.expandByPoint(Ms.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Nr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new De,1/0);return}if(e){const n=this.boundingSphere.center;if(Ms.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const c=t[r];ja.setFromBufferAttribute(c),this.morphTargetsRelative?(Yr.addVectors(Ms.min,ja.min),Ms.expandByPoint(Yr),Yr.addVectors(Ms.max,ja.max),Ms.expandByPoint(Yr)):(Ms.expandByPoint(ja.min),Ms.expandByPoint(ja.max))}Ms.getCenter(n);let i=0;for(let r=0,o=e.count;r<o;r++)Yr.fromBufferAttribute(e,r),i=Math.max(i,n.distanceToSquared(Yr));if(t)for(let r=0,o=t.length;r<o;r++){const c=t[r],E=this.morphTargetsRelative;for(let x=0,B=c.count;x<B;x++)Yr.fromBufferAttribute(c,x),E&&(Aa.fromBufferAttribute(e,x),Yr.add(Aa)),i=Math.max(i,n.distanceToSquared(Yr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,i=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new lr(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),c=[],E=[];for(let ze=0;ze<n.count;ze++)c[ze]=new De,E[ze]=new De;const x=new De,B=new De,P=new De,U=new Lt,V=new Lt,j=new Lt,ie=new De,X=new De;function H(ze,Te,be){x.fromBufferAttribute(n,ze),B.fromBufferAttribute(n,Te),P.fromBufferAttribute(n,be),U.fromBufferAttribute(r,ze),V.fromBufferAttribute(r,Te),j.fromBufferAttribute(r,be),B.sub(x),P.sub(x),V.sub(U),j.sub(U);const je=1/(V.x*j.y-j.x*V.y);isFinite(je)&&(ie.copy(B).multiplyScalar(j.y).addScaledVector(P,-V.y).multiplyScalar(je),X.copy(P).multiplyScalar(V.x).addScaledVector(B,-j.x).multiplyScalar(je),c[ze].add(ie),c[Te].add(ie),c[be].add(ie),E[ze].add(X),E[Te].add(X),E[be].add(X))}let ge=this.groups;ge.length===0&&(ge=[{start:0,count:e.count}]);for(let ze=0,Te=ge.length;ze<Te;++ze){const be=ge[ze],je=be.start,nt=be.count;for(let $e=je,rt=je+nt;$e<rt;$e+=3)H(e.getX($e+0),e.getX($e+1),e.getX($e+2))}const pe=new De,de=new De,We=new De,Pe=new De;function ke(ze){We.fromBufferAttribute(i,ze),Pe.copy(We);const Te=c[ze];pe.copy(Te),pe.sub(We.multiplyScalar(We.dot(Te))).normalize(),de.crossVectors(Pe,Te);const je=de.dot(E[ze])<0?-1:1;o.setXYZW(ze,pe.x,pe.y,pe.z,je)}for(let ze=0,Te=ge.length;ze<Te;++ze){const be=ge[ze],je=be.start,nt=be.count;for(let $e=je,rt=je+nt;$e<rt;$e+=3)ke(e.getX($e+0)),ke(e.getX($e+1)),ke(e.getX($e+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new lr(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let U=0,V=n.count;U<V;U++)n.setXYZ(U,0,0,0);const i=new De,r=new De,o=new De,c=new De,E=new De,x=new De,B=new De,P=new De;if(e)for(let U=0,V=e.count;U<V;U+=3){const j=e.getX(U+0),ie=e.getX(U+1),X=e.getX(U+2);i.fromBufferAttribute(t,j),r.fromBufferAttribute(t,ie),o.fromBufferAttribute(t,X),B.subVectors(o,r),P.subVectors(i,r),B.cross(P),c.fromBufferAttribute(n,j),E.fromBufferAttribute(n,ie),x.fromBufferAttribute(n,X),c.add(B),E.add(B),x.add(B),n.setXYZ(j,c.x,c.y,c.z),n.setXYZ(ie,E.x,E.y,E.z),n.setXYZ(X,x.x,x.y,x.z)}else for(let U=0,V=t.count;U<V;U+=3)i.fromBufferAttribute(t,U+0),r.fromBufferAttribute(t,U+1),o.fromBufferAttribute(t,U+2),B.subVectors(o,r),P.subVectors(i,r),B.cross(P),n.setXYZ(U+0,B.x,B.y,B.z),n.setXYZ(U+1,B.x,B.y,B.z),n.setXYZ(U+2,B.x,B.y,B.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Yr.fromBufferAttribute(e,t),Yr.normalize(),e.setXYZ(t,Yr.x,Yr.y,Yr.z)}toNonIndexed(){function e(c,E){const x=c.array,B=c.itemSize,P=c.normalized,U=new x.constructor(E.length*B);let V=0,j=0;for(let ie=0,X=E.length;ie<X;ie++){c.isInterleavedBufferAttribute?V=E[ie]*c.data.stride+c.offset:V=E[ie]*B;for(let H=0;H<B;H++)U[j++]=x[V++]}return new lr(U,B,P)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new wi,n=this.index.array,i=this.attributes;for(const c in i){const E=i[c],x=e(E,n);t.setAttribute(c,x)}const r=this.morphAttributes;for(const c in r){const E=[],x=r[c];for(let B=0,P=x.length;B<P;B++){const U=x[B],V=e(U,n);E.push(V)}t.morphAttributes[c]=E}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let c=0,E=o.length;c<E;c++){const x=o[c];t.addGroup(x.start,x.count,x.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const E=this.parameters;for(const x in E)E[x]!==void 0&&(e[x]=E[x]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const E in n){const x=n[E];e.data.attributes[E]=x.toJSON(e.data)}const i={};let r=!1;for(const E in this.morphAttributes){const x=this.morphAttributes[E],B=[];for(let P=0,U=x.length;P<U;P++){const V=x[P];B.push(V.toJSON(e.data))}B.length>0&&(i[E]=B,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const x in i){const B=i[x];this.setAttribute(x,B.clone(t))}const r=e.morphAttributes;for(const x in r){const B=[],P=r[x];for(let U=0,V=P.length;U<V;U++)B.push(P[U].clone(t));this.morphAttributes[x]=B}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let x=0,B=o.length;x<B;x++){const P=o[x];this.addGroup(P.start,P.count,P.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const E=e.boundingSphere;return E!==null&&(this.boundingSphere=E.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ju=new On,Oo=new kr,Fl=new Nr,Wu=new De,ma=new De,ga=new De,va=new De,Bh=new De,Ul=new De,Nl=new Lt,kl=new Lt,Gl=new Lt,Ku=new De,Xu=new De,Yu=new De,Ql=new De,Vl=new De;class Dr extends Yi{constructor(e=new wi,t=new yo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const c=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const c=this.morphTargetInfluences;if(r&&c){Ul.set(0,0,0);for(let E=0,x=r.length;E<x;E++){const B=c[E],P=r[E];B!==0&&(Bh.fromBufferAttribute(P,e),o?Ul.addScaledVector(Bh,B):Ul.addScaledVector(Bh.sub(t),B))}t.add(Ul)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Fl.copy(n.boundingSphere),Fl.applyMatrix4(r),Oo.copy(e.ray).recast(e.near),!(Fl.containsPoint(Oo.origin)===!1&&(Oo.intersectSphere(Fl,Wu)===null||Oo.origin.distanceToSquared(Wu)>(e.far-e.near)**2))&&(ju.copy(r).invert(),Oo.copy(e.ray).applyMatrix4(ju),!(n.boundingBox!==null&&Oo.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Oo)))}_computeIntersections(e,t,n){let i;const r=this.geometry,o=this.material,c=r.index,E=r.attributes.position,x=r.attributes.uv,B=r.attributes.uv1,P=r.attributes.normal,U=r.groups,V=r.drawRange;if(c!==null)if(Array.isArray(o))for(let j=0,ie=U.length;j<ie;j++){const X=U[j],H=o[X.materialIndex],ge=Math.max(X.start,V.start),pe=Math.min(c.count,Math.min(X.start+X.count,V.start+V.count));for(let de=ge,We=pe;de<We;de+=3){const Pe=c.getX(de),ke=c.getX(de+1),ze=c.getX(de+2);i=Hl(this,H,e,n,x,B,P,Pe,ke,ze),i&&(i.faceIndex=Math.floor(de/3),i.face.materialIndex=X.materialIndex,t.push(i))}}else{const j=Math.max(0,V.start),ie=Math.min(c.count,V.start+V.count);for(let X=j,H=ie;X<H;X+=3){const ge=c.getX(X),pe=c.getX(X+1),de=c.getX(X+2);i=Hl(this,o,e,n,x,B,P,ge,pe,de),i&&(i.faceIndex=Math.floor(X/3),t.push(i))}}else if(E!==void 0)if(Array.isArray(o))for(let j=0,ie=U.length;j<ie;j++){const X=U[j],H=o[X.materialIndex],ge=Math.max(X.start,V.start),pe=Math.min(E.count,Math.min(X.start+X.count,V.start+V.count));for(let de=ge,We=pe;de<We;de+=3){const Pe=de,ke=de+1,ze=de+2;i=Hl(this,H,e,n,x,B,P,Pe,ke,ze),i&&(i.faceIndex=Math.floor(de/3),i.face.materialIndex=X.materialIndex,t.push(i))}}else{const j=Math.max(0,V.start),ie=Math.min(E.count,V.start+V.count);for(let X=j,H=ie;X<H;X+=3){const ge=X,pe=X+1,de=X+2;i=Hl(this,o,e,n,x,B,P,ge,pe,de),i&&(i.faceIndex=Math.floor(X/3),t.push(i))}}}}function zp(s,e,t,n,i,r,o,c){let E;if(e.side===C?E=n.intersectTriangle(o,r,i,!0,c):E=n.intersectTriangle(i,r,o,e.side===p,c),E===null)return null;Vl.copy(c),Vl.applyMatrix4(s.matrixWorld);const x=t.ray.origin.distanceTo(Vl);return x<t.near||x>t.far?null:{distance:x,point:Vl.clone(),object:s}}function Hl(s,e,t,n,i,r,o,c,E,x){s.getVertexPosition(c,ma),s.getVertexPosition(E,ga),s.getVertexPosition(x,va);const B=zp(s,e,t,n,ma,ga,va,Ql);if(B){i&&(Nl.fromBufferAttribute(i,c),kl.fromBufferAttribute(i,E),Gl.fromBufferAttribute(i,x),B.uv=_s.getInterpolation(Ql,ma,ga,va,Nl,kl,Gl,new Lt)),r&&(Nl.fromBufferAttribute(r,c),kl.fromBufferAttribute(r,E),Gl.fromBufferAttribute(r,x),B.uv1=_s.getInterpolation(Ql,ma,ga,va,Nl,kl,Gl,new Lt)),o&&(Ku.fromBufferAttribute(o,c),Xu.fromBufferAttribute(o,E),Yu.fromBufferAttribute(o,x),B.normal=_s.getInterpolation(Ql,ma,ga,va,Ku,Xu,Yu,new De),B.normal.dot(n.direction)>0&&B.normal.multiplyScalar(-1));const P={a:c,b:E,c:x,normal:new De,materialIndex:0};_s.getNormal(ma,ga,va,P.normal),B.face=P}return B}class Fo extends wi{constructor(e=1,t=1,n=1,i=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};const c=this;i=Math.floor(i),r=Math.floor(r),o=Math.floor(o);const E=[],x=[],B=[],P=[];let U=0,V=0;j("z","y","x",-1,-1,n,t,e,o,r,0),j("z","y","x",1,-1,n,t,-e,o,r,1),j("x","z","y",1,1,e,n,t,i,o,2),j("x","z","y",1,-1,e,n,-t,i,o,3),j("x","y","z",1,-1,e,t,n,i,r,4),j("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(E),this.setAttribute("position",new Gn(x,3)),this.setAttribute("normal",new Gn(B,3)),this.setAttribute("uv",new Gn(P,2));function j(ie,X,H,ge,pe,de,We,Pe,ke,ze,Te){const be=de/ke,je=We/ze,nt=de/2,$e=We/2,rt=Pe/2,mt=ke+1,Rt=ze+1;let ln=0,vt=0;const en=new De;for(let rn=0;rn<Rt;rn++){const Dn=rn*je-$e;for(let _i=0;_i<mt;_i++){const er=_i*be-nt;en[ie]=er*ge,en[X]=Dn*pe,en[H]=rt,x.push(en.x,en.y,en.z),en[ie]=0,en[X]=0,en[H]=Pe>0?1:-1,B.push(en.x,en.y,en.z),P.push(_i/ke),P.push(1-rn/ze),ln+=1}}for(let rn=0;rn<ze;rn++)for(let Dn=0;Dn<ke;Dn++){const _i=U+Dn+mt*rn,er=U+Dn+mt*(rn+1),Ar=U+(Dn+1)+mt*(rn+1),qi=U+(Dn+1)+mt*rn;E.push(_i,er,qi),E.push(er,Ar,qi),vt+=6}c.addGroup(V,vt,Te),V+=vt,U+=ln}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ya(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const i=s[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function hs(s){const e={};for(let t=0;t<s.length;t++){const n=ya(s[t]);for(const i in n)e[i]=n[i]}return e}function jp(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function qu(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:$i.workingColorSpace}const Ju={clone:ya,merge:hs};var Wp=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Kp=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Os extends is{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Wp,this.fragmentShader=Kp,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ya(e.uniforms),this.uniformsGroups=jp(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class zl extends Yi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new On,this.projectionMatrix=new On,this.projectionMatrixInverse=new On,this.coordinateSystem=Is}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Eo=new De,Zu=new Lt,$u=new Lt;class Gr extends zl{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=uo*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Js*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return uo*2*Math.atan(Math.tan(Js*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Eo.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Eo.x,Eo.y).multiplyScalar(-e/Eo.z),Eo.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Eo.x,Eo.y).multiplyScalar(-e/Eo.z)}getViewSize(e,t){return this.getViewBounds(e,Zu,$u),t.subVectors($u,Zu)}setViewOffset(e,t,n,i,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Js*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const E=o.fullWidth,x=o.fullHeight;r+=o.offsetX*i/E,t-=o.offsetY*n/x,i*=o.width/E,n*=o.height/x}const c=this.filmOffset;c!==0&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Ea=-90,Ca=1;class ed extends Yi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Gr(Ea,Ca,e,t);i.layers=this.layers,this.add(i);const r=new Gr(Ea,Ca,e,t);r.layers=this.layers,this.add(r);const o=new Gr(Ea,Ca,e,t);o.layers=this.layers,this.add(o);const c=new Gr(Ea,Ca,e,t);c.layers=this.layers,this.add(c);const E=new Gr(Ea,Ca,e,t);E.layers=this.layers,this.add(E);const x=new Gr(Ea,Ca,e,t);x.layers=this.layers,this.add(x)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,o,c,E]=t;for(const x of t)this.remove(x);if(e===Is)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),E.up.set(0,1,0),E.lookAt(0,0,-1);else if(e===Lo)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),E.up.set(0,-1,0),E.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const x of t)this.add(x),x.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,c,E,x,B]=this.children,P=e.getRenderTarget(),U=e.getActiveCubeFace(),V=e.getActiveMipmapLevel(),j=e.xr.enabled;e.xr.enabled=!1;const ie=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,o),e.setRenderTarget(n,2,i),e.render(t,c),e.setRenderTarget(n,3,i),e.render(t,E),e.setRenderTarget(n,4,i),e.render(t,x),n.texture.generateMipmaps=ie,e.setRenderTarget(n,5,i),e.render(t,B),e.setRenderTarget(P,U,V),e.xr.enabled=j,n.texture.needsPMREMUpdate=!0}}class Wa extends fr{constructor(e,t,n,i,r,o,c,E,x,B){e=e!==void 0?e:[],t=t!==void 0?t:ee,super(e,t,n,i,r,o,c,E,x,B),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class td extends As{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Wa(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Bn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Fo(5,5,5),r=new Os({name:"CubemapFromEquirect",uniforms:ya(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:C,blending:_});r.uniforms.tEquirect.value=t;const o=new Dr(i,r),c=t.minFilter;return t.minFilter===Oi&&(t.minFilter=Bn),new ed(1,10,this).update(e,o),t.minFilter=c,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,i);e.setRenderTarget(r)}}const Rh=new De,Xp=new De,Yp=new ci;class Co{constructor(e=new De(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Rh.subVectors(n,t).cross(Xp.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Rh),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Yp.getNormalMatrix(e),i=this.coplanarPoint(Rh).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Uo=new Nr,jl=new De;class Ka{constructor(e=new Co,t=new Co,n=new Co,i=new Co,r=new Co,o=new Co){this.planes=[e,t,n,i,r,o]}set(e,t,n,i,r,o){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(i),c[4].copy(r),c[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Is){const n=this.planes,i=e.elements,r=i[0],o=i[1],c=i[2],E=i[3],x=i[4],B=i[5],P=i[6],U=i[7],V=i[8],j=i[9],ie=i[10],X=i[11],H=i[12],ge=i[13],pe=i[14],de=i[15];if(n[0].setComponents(E-r,U-x,X-V,de-H).normalize(),n[1].setComponents(E+r,U+x,X+V,de+H).normalize(),n[2].setComponents(E+o,U+B,X+j,de+ge).normalize(),n[3].setComponents(E-o,U-B,X-j,de-ge).normalize(),n[4].setComponents(E-c,U-P,X-ie,de-pe).normalize(),t===Is)n[5].setComponents(E+c,U+P,X+ie,de+pe).normalize();else if(t===Lo)n[5].setComponents(c,P,ie,pe).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Uo.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Uo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Uo)}intersectsSprite(e){return Uo.center.set(0,0,0),Uo.radius=.7071067811865476,Uo.applyMatrix4(e.matrixWorld),this.intersectsSphere(Uo)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(jl.x=i.normal.x>0?e.max.x:e.min.x,jl.y=i.normal.y>0?e.max.y:e.min.y,jl.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(jl)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Lh(){let s=null,e=!1,t=null,n=null;function i(r,o){t(r,o),n=s.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(i),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){s=r}}}function qp(s){const e=new WeakMap;function t(c,E){const x=c.array,B=c.usage,P=x.byteLength,U=s.createBuffer();s.bindBuffer(E,U),s.bufferData(E,x,B),c.onUploadCallback();let V;if(x instanceof Float32Array)V=s.FLOAT;else if(x instanceof Uint16Array)c.isFloat16BufferAttribute?V=s.HALF_FLOAT:V=s.UNSIGNED_SHORT;else if(x instanceof Int16Array)V=s.SHORT;else if(x instanceof Uint32Array)V=s.UNSIGNED_INT;else if(x instanceof Int32Array)V=s.INT;else if(x instanceof Int8Array)V=s.BYTE;else if(x instanceof Uint8Array)V=s.UNSIGNED_BYTE;else if(x instanceof Uint8ClampedArray)V=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+x);return{buffer:U,type:V,bytesPerElement:x.BYTES_PER_ELEMENT,version:c.version,size:P}}function n(c,E,x){const B=E.array,P=E._updateRange,U=E.updateRanges;if(s.bindBuffer(x,c),P.count===-1&&U.length===0&&s.bufferSubData(x,0,B),U.length!==0){for(let V=0,j=U.length;V<j;V++){const ie=U[V];s.bufferSubData(x,ie.start*B.BYTES_PER_ELEMENT,B,ie.start,ie.count)}E.clearUpdateRanges()}P.count!==-1&&(s.bufferSubData(x,P.offset*B.BYTES_PER_ELEMENT,B,P.offset,P.count),P.count=-1),E.onUploadCallback()}function i(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function r(c){c.isInterleavedBufferAttribute&&(c=c.data);const E=e.get(c);E&&(s.deleteBuffer(E.buffer),e.delete(c))}function o(c,E){if(c.isGLBufferAttribute){const B=e.get(c);(!B||B.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const x=e.get(c);if(x===void 0)e.set(c,t(c,E));else if(x.version<c.version){if(x.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(x.buffer,c,E),x.version=c.version}}return{get:i,remove:r,update:o}}class xa extends wi{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,o=t/2,c=Math.floor(n),E=Math.floor(i),x=c+1,B=E+1,P=e/c,U=t/E,V=[],j=[],ie=[],X=[];for(let H=0;H<B;H++){const ge=H*U-o;for(let pe=0;pe<x;pe++){const de=pe*P-r;j.push(de,-ge,0),ie.push(0,0,1),X.push(pe/c),X.push(1-H/E)}}for(let H=0;H<E;H++)for(let ge=0;ge<c;ge++){const pe=ge+x*H,de=ge+x*(H+1),We=ge+1+x*(H+1),Pe=ge+1+x*H;V.push(pe,de,Pe),V.push(de,We,Pe)}this.setIndex(V),this.setAttribute("position",new Gn(j,3)),this.setAttribute("normal",new Gn(ie,3)),this.setAttribute("uv",new Gn(X,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xa(e.width,e.height,e.widthSegments,e.heightSegments)}}var Jp=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Zp=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,$p=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,eA=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tA=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,nA=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,iA=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,rA=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,sA=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,oA=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,aA=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,lA=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,cA=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,hA=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,uA=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,dA=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,fA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,pA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,AA=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,mA=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,gA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,vA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,yA=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,EA=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,CA=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,xA=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,bA=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,wA=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,_A=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,MA=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,SA="gl_FragColor = linearToOutputTexel( gl_FragColor );",TA=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,IA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,BA=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,RA=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,LA=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,DA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,PA=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,OA=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,FA=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,UA=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,NA=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,kA=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,GA=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,QA=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,VA=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,HA=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,zA=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,jA=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,WA=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,KA=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,XA=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,YA=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,qA=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,JA=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,ZA=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,$A=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,em=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,tm=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nm=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,im=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,rm=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,sm=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,om=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,am=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,lm=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,cm=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,hm=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,um=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,dm=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,fm=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,pm=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Am=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,mm=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,gm=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vm=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ym=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Em=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Cm=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,xm=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,bm=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,wm=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,_m=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Mm=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Sm=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Tm=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Im=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Bm=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Rm=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Lm=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,Dm=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Pm=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Om=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Fm=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Um=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Nm=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,km=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Gm=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Qm=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Vm=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Hm=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,zm=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,jm=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Wm=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Km=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Xm=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Ym=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Ei={alphahash_fragment:Jp,alphahash_pars_fragment:Zp,alphamap_fragment:$p,alphamap_pars_fragment:eA,alphatest_fragment:tA,alphatest_pars_fragment:nA,aomap_fragment:iA,aomap_pars_fragment:rA,batching_pars_vertex:sA,batching_vertex:oA,begin_vertex:aA,beginnormal_vertex:lA,bsdfs:cA,iridescence_fragment:hA,bumpmap_pars_fragment:uA,clipping_planes_fragment:dA,clipping_planes_pars_fragment:fA,clipping_planes_pars_vertex:pA,clipping_planes_vertex:AA,color_fragment:mA,color_pars_fragment:gA,color_pars_vertex:vA,color_vertex:yA,common:EA,cube_uv_reflection_fragment:CA,defaultnormal_vertex:xA,displacementmap_pars_vertex:bA,displacementmap_vertex:wA,emissivemap_fragment:_A,emissivemap_pars_fragment:MA,colorspace_fragment:SA,colorspace_pars_fragment:TA,envmap_fragment:IA,envmap_common_pars_fragment:BA,envmap_pars_fragment:RA,envmap_pars_vertex:LA,envmap_physical_pars_fragment:HA,envmap_vertex:DA,fog_vertex:PA,fog_pars_vertex:OA,fog_fragment:FA,fog_pars_fragment:UA,gradientmap_pars_fragment:NA,lightmap_pars_fragment:kA,lights_lambert_fragment:GA,lights_lambert_pars_fragment:QA,lights_pars_begin:VA,lights_toon_fragment:zA,lights_toon_pars_fragment:jA,lights_phong_fragment:WA,lights_phong_pars_fragment:KA,lights_physical_fragment:XA,lights_physical_pars_fragment:YA,lights_fragment_begin:qA,lights_fragment_maps:JA,lights_fragment_end:ZA,logdepthbuf_fragment:$A,logdepthbuf_pars_fragment:em,logdepthbuf_pars_vertex:tm,logdepthbuf_vertex:nm,map_fragment:im,map_pars_fragment:rm,map_particle_fragment:sm,map_particle_pars_fragment:om,metalnessmap_fragment:am,metalnessmap_pars_fragment:lm,morphinstance_vertex:cm,morphcolor_vertex:hm,morphnormal_vertex:um,morphtarget_pars_vertex:dm,morphtarget_vertex:fm,normal_fragment_begin:pm,normal_fragment_maps:Am,normal_pars_fragment:mm,normal_pars_vertex:gm,normal_vertex:vm,normalmap_pars_fragment:ym,clearcoat_normal_fragment_begin:Em,clearcoat_normal_fragment_maps:Cm,clearcoat_pars_fragment:xm,iridescence_pars_fragment:bm,opaque_fragment:wm,packing:_m,premultiplied_alpha_fragment:Mm,project_vertex:Sm,dithering_fragment:Tm,dithering_pars_fragment:Im,roughnessmap_fragment:Bm,roughnessmap_pars_fragment:Rm,shadowmap_pars_fragment:Lm,shadowmap_pars_vertex:Dm,shadowmap_vertex:Pm,shadowmask_pars_fragment:Om,skinbase_vertex:Fm,skinning_pars_vertex:Um,skinning_vertex:Nm,skinnormal_vertex:km,specularmap_fragment:Gm,specularmap_pars_fragment:Qm,tonemapping_fragment:Vm,tonemapping_pars_fragment:Hm,transmission_fragment:zm,transmission_pars_fragment:jm,uv_pars_fragment:Wm,uv_pars_vertex:Km,uv_vertex:Xm,worldpos_vertex:Ym,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},An={common:{diffuse:{value:new Sn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ci},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ci}},envmap:{envMap:{value:null},envMapRotation:{value:new ci},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ci}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ci}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ci},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ci},normalScale:{value:new Lt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ci},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ci}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ci}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ci}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Sn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Sn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0},uvTransform:{value:new ci}},sprite:{diffuse:{value:new Sn(16777215)},opacity:{value:1},center:{value:new Lt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ci},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0}}},Fs={basic:{uniforms:hs([An.common,An.specularmap,An.envmap,An.aomap,An.lightmap,An.fog]),vertexShader:Ei.meshbasic_vert,fragmentShader:Ei.meshbasic_frag},lambert:{uniforms:hs([An.common,An.specularmap,An.envmap,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.fog,An.lights,{emissive:{value:new Sn(0)}}]),vertexShader:Ei.meshlambert_vert,fragmentShader:Ei.meshlambert_frag},phong:{uniforms:hs([An.common,An.specularmap,An.envmap,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.fog,An.lights,{emissive:{value:new Sn(0)},specular:{value:new Sn(1118481)},shininess:{value:30}}]),vertexShader:Ei.meshphong_vert,fragmentShader:Ei.meshphong_frag},standard:{uniforms:hs([An.common,An.envmap,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.roughnessmap,An.metalnessmap,An.fog,An.lights,{emissive:{value:new Sn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ei.meshphysical_vert,fragmentShader:Ei.meshphysical_frag},toon:{uniforms:hs([An.common,An.aomap,An.lightmap,An.emissivemap,An.bumpmap,An.normalmap,An.displacementmap,An.gradientmap,An.fog,An.lights,{emissive:{value:new Sn(0)}}]),vertexShader:Ei.meshtoon_vert,fragmentShader:Ei.meshtoon_frag},matcap:{uniforms:hs([An.common,An.bumpmap,An.normalmap,An.displacementmap,An.fog,{matcap:{value:null}}]),vertexShader:Ei.meshmatcap_vert,fragmentShader:Ei.meshmatcap_frag},points:{uniforms:hs([An.points,An.fog]),vertexShader:Ei.points_vert,fragmentShader:Ei.points_frag},dashed:{uniforms:hs([An.common,An.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ei.linedashed_vert,fragmentShader:Ei.linedashed_frag},depth:{uniforms:hs([An.common,An.displacementmap]),vertexShader:Ei.depth_vert,fragmentShader:Ei.depth_frag},normal:{uniforms:hs([An.common,An.bumpmap,An.normalmap,An.displacementmap,{opacity:{value:1}}]),vertexShader:Ei.meshnormal_vert,fragmentShader:Ei.meshnormal_frag},sprite:{uniforms:hs([An.sprite,An.fog]),vertexShader:Ei.sprite_vert,fragmentShader:Ei.sprite_frag},background:{uniforms:{uvTransform:{value:new ci},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ei.background_vert,fragmentShader:Ei.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ci}},vertexShader:Ei.backgroundCube_vert,fragmentShader:Ei.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ei.cube_vert,fragmentShader:Ei.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ei.equirect_vert,fragmentShader:Ei.equirect_frag},distanceRGBA:{uniforms:hs([An.common,An.displacementmap,{referencePosition:{value:new De},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ei.distanceRGBA_vert,fragmentShader:Ei.distanceRGBA_frag},shadow:{uniforms:hs([An.lights,An.fog,{color:{value:new Sn(0)},opacity:{value:1}}]),vertexShader:Ei.shadow_vert,fragmentShader:Ei.shadow_frag}};Fs.physical={uniforms:hs([Fs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ci},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ci},clearcoatNormalScale:{value:new Lt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ci},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ci},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ci},sheen:{value:0},sheenColor:{value:new Sn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ci},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ci},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ci},transmissionSamplerSize:{value:new Lt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ci},attenuationDistance:{value:0},attenuationColor:{value:new Sn(0)},specularColor:{value:new Sn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ci},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ci},anisotropyVector:{value:new Lt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ci}}]),vertexShader:Ei.meshphysical_vert,fragmentShader:Ei.meshphysical_frag};const Wl={r:0,b:0,g:0},No=new ws,qm=new On;function Jm(s,e,t,n,i,r,o){const c=new Sn(0);let E=r===!0?0:1,x,B,P=null,U=0,V=null;function j(ge){let pe=ge.isScene===!0?ge.background:null;return pe&&pe.isTexture&&(pe=(ge.backgroundBlurriness>0?t:e).get(pe)),pe}function ie(ge){let pe=!1;const de=j(ge);de===null?H(c,E):de&&de.isColor&&(H(de,1),pe=!0);const We=s.xr.getEnvironmentBlendMode();We==="additive"?n.buffers.color.setClear(0,0,0,1,o):We==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(s.autoClear||pe)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil)}function X(ge,pe){const de=j(pe);de&&(de.isCubeTexture||de.mapping===xe)?(B===void 0&&(B=new Dr(new Fo(1e4,1e4,1e4),new Os({name:"BackgroundCubeMaterial",uniforms:ya(Fs.backgroundCube.uniforms),vertexShader:Fs.backgroundCube.vertexShader,fragmentShader:Fs.backgroundCube.fragmentShader,side:C,depthTest:!1,depthWrite:!1,fog:!1})),B.geometry.deleteAttribute("normal"),B.geometry.deleteAttribute("uv"),B.onBeforeRender=function(We,Pe,ke){this.matrixWorld.copyPosition(ke.matrixWorld)},Object.defineProperty(B.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(B)),No.copy(pe.backgroundRotation),No.x*=-1,No.y*=-1,No.z*=-1,de.isCubeTexture&&de.isRenderTargetTexture===!1&&(No.y*=-1,No.z*=-1),B.material.uniforms.envMap.value=de,B.material.uniforms.flipEnvMap.value=de.isCubeTexture&&de.isRenderTargetTexture===!1?-1:1,B.material.uniforms.backgroundBlurriness.value=pe.backgroundBlurriness,B.material.uniforms.backgroundIntensity.value=pe.backgroundIntensity,B.material.uniforms.backgroundRotation.value.setFromMatrix4(qm.makeRotationFromEuler(No)),B.material.toneMapped=$i.getTransfer(de.colorSpace)!==Qn,(P!==de||U!==de.version||V!==s.toneMapping)&&(B.material.needsUpdate=!0,P=de,U=de.version,V=s.toneMapping),B.layers.enableAll(),ge.unshift(B,B.geometry,B.material,0,0,null)):de&&de.isTexture&&(x===void 0&&(x=new Dr(new xa(2,2),new Os({name:"BackgroundMaterial",uniforms:ya(Fs.background.uniforms),vertexShader:Fs.background.vertexShader,fragmentShader:Fs.background.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1})),x.geometry.deleteAttribute("normal"),Object.defineProperty(x.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(x)),x.material.uniforms.t2D.value=de,x.material.uniforms.backgroundIntensity.value=pe.backgroundIntensity,x.material.toneMapped=$i.getTransfer(de.colorSpace)!==Qn,de.matrixAutoUpdate===!0&&de.updateMatrix(),x.material.uniforms.uvTransform.value.copy(de.matrix),(P!==de||U!==de.version||V!==s.toneMapping)&&(x.material.needsUpdate=!0,P=de,U=de.version,V=s.toneMapping),x.layers.enableAll(),ge.unshift(x,x.geometry,x.material,0,0,null))}function H(ge,pe){ge.getRGB(Wl,qu(s)),n.buffers.color.setClear(Wl.r,Wl.g,Wl.b,pe,o)}return{getClearColor:function(){return c},setClearColor:function(ge,pe=1){c.set(ge),E=pe,H(c,E)},getClearAlpha:function(){return E},setClearAlpha:function(ge){E=ge,H(c,E)},render:ie,addToRenderList:X}}function Zm(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},i=U(null);let r=i,o=!1;function c(be,je,nt,$e,rt){let mt=!1;const Rt=P($e,nt,je);r!==Rt&&(r=Rt,x(r.object)),mt=V(be,$e,nt,rt),mt&&j(be,$e,nt,rt),rt!==null&&e.update(rt,s.ELEMENT_ARRAY_BUFFER),(mt||o)&&(o=!1,de(be,je,nt,$e),rt!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(rt).buffer))}function E(){return s.createVertexArray()}function x(be){return s.bindVertexArray(be)}function B(be){return s.deleteVertexArray(be)}function P(be,je,nt){const $e=nt.wireframe===!0;let rt=n[be.id];rt===void 0&&(rt={},n[be.id]=rt);let mt=rt[je.id];mt===void 0&&(mt={},rt[je.id]=mt);let Rt=mt[$e];return Rt===void 0&&(Rt=U(E()),mt[$e]=Rt),Rt}function U(be){const je=[],nt=[],$e=[];for(let rt=0;rt<t;rt++)je[rt]=0,nt[rt]=0,$e[rt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:je,enabledAttributes:nt,attributeDivisors:$e,object:be,attributes:{},index:null}}function V(be,je,nt,$e){const rt=r.attributes,mt=je.attributes;let Rt=0;const ln=nt.getAttributes();for(const vt in ln)if(ln[vt].location>=0){const rn=rt[vt];let Dn=mt[vt];if(Dn===void 0&&(vt==="instanceMatrix"&&be.instanceMatrix&&(Dn=be.instanceMatrix),vt==="instanceColor"&&be.instanceColor&&(Dn=be.instanceColor)),rn===void 0||rn.attribute!==Dn||Dn&&rn.data!==Dn.data)return!0;Rt++}return r.attributesNum!==Rt||r.index!==$e}function j(be,je,nt,$e){const rt={},mt=je.attributes;let Rt=0;const ln=nt.getAttributes();for(const vt in ln)if(ln[vt].location>=0){let rn=mt[vt];rn===void 0&&(vt==="instanceMatrix"&&be.instanceMatrix&&(rn=be.instanceMatrix),vt==="instanceColor"&&be.instanceColor&&(rn=be.instanceColor));const Dn={};Dn.attribute=rn,rn&&rn.data&&(Dn.data=rn.data),rt[vt]=Dn,Rt++}r.attributes=rt,r.attributesNum=Rt,r.index=$e}function ie(){const be=r.newAttributes;for(let je=0,nt=be.length;je<nt;je++)be[je]=0}function X(be){H(be,0)}function H(be,je){const nt=r.newAttributes,$e=r.enabledAttributes,rt=r.attributeDivisors;nt[be]=1,$e[be]===0&&(s.enableVertexAttribArray(be),$e[be]=1),rt[be]!==je&&(s.vertexAttribDivisor(be,je),rt[be]=je)}function ge(){const be=r.newAttributes,je=r.enabledAttributes;for(let nt=0,$e=je.length;nt<$e;nt++)je[nt]!==be[nt]&&(s.disableVertexAttribArray(nt),je[nt]=0)}function pe(be,je,nt,$e,rt,mt,Rt){Rt===!0?s.vertexAttribIPointer(be,je,nt,rt,mt):s.vertexAttribPointer(be,je,nt,$e,rt,mt)}function de(be,je,nt,$e){ie();const rt=$e.attributes,mt=nt.getAttributes(),Rt=je.defaultAttributeValues;for(const ln in mt){const vt=mt[ln];if(vt.location>=0){let en=rt[ln];if(en===void 0&&(ln==="instanceMatrix"&&be.instanceMatrix&&(en=be.instanceMatrix),ln==="instanceColor"&&be.instanceColor&&(en=be.instanceColor)),en!==void 0){const rn=en.normalized,Dn=en.itemSize,_i=e.get(en);if(_i===void 0)continue;const er=_i.buffer,Ar=_i.type,qi=_i.bytesPerElement,ur=Ar===s.INT||Ar===s.UNSIGNED_INT||en.gpuType===Fr;if(en.isInterleavedBufferAttribute){const Nn=en.data,Pt=Nn.stride,hn=en.offset;if(Nn.isInstancedInterleavedBuffer){for(let mn=0;mn<vt.locationSize;mn++)H(vt.location+mn,Nn.meshPerAttribute);be.isInstancedMesh!==!0&&$e._maxInstanceCount===void 0&&($e._maxInstanceCount=Nn.meshPerAttribute*Nn.count)}else for(let mn=0;mn<vt.locationSize;mn++)X(vt.location+mn);s.bindBuffer(s.ARRAY_BUFFER,er);for(let mn=0;mn<vt.locationSize;mn++)pe(vt.location+mn,Dn/vt.locationSize,Ar,rn,Pt*qi,(hn+Dn/vt.locationSize*mn)*qi,ur)}else{if(en.isInstancedBufferAttribute){for(let Nn=0;Nn<vt.locationSize;Nn++)H(vt.location+Nn,en.meshPerAttribute);be.isInstancedMesh!==!0&&$e._maxInstanceCount===void 0&&($e._maxInstanceCount=en.meshPerAttribute*en.count)}else for(let Nn=0;Nn<vt.locationSize;Nn++)X(vt.location+Nn);s.bindBuffer(s.ARRAY_BUFFER,er);for(let Nn=0;Nn<vt.locationSize;Nn++)pe(vt.location+Nn,Dn/vt.locationSize,Ar,rn,Dn*qi,Dn/vt.locationSize*Nn*qi,ur)}}else if(Rt!==void 0){const rn=Rt[ln];if(rn!==void 0)switch(rn.length){case 2:s.vertexAttrib2fv(vt.location,rn);break;case 3:s.vertexAttrib3fv(vt.location,rn);break;case 4:s.vertexAttrib4fv(vt.location,rn);break;default:s.vertexAttrib1fv(vt.location,rn)}}}}ge()}function We(){ze();for(const be in n){const je=n[be];for(const nt in je){const $e=je[nt];for(const rt in $e)B($e[rt].object),delete $e[rt];delete je[nt]}delete n[be]}}function Pe(be){if(n[be.id]===void 0)return;const je=n[be.id];for(const nt in je){const $e=je[nt];for(const rt in $e)B($e[rt].object),delete $e[rt];delete je[nt]}delete n[be.id]}function ke(be){for(const je in n){const nt=n[je];if(nt[be.id]===void 0)continue;const $e=nt[be.id];for(const rt in $e)B($e[rt].object),delete $e[rt];delete nt[be.id]}}function ze(){Te(),o=!0,r!==i&&(r=i,x(r.object))}function Te(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:c,reset:ze,resetDefaultState:Te,dispose:We,releaseStatesOfGeometry:Pe,releaseStatesOfProgram:ke,initAttributes:ie,enableAttribute:X,disableUnusedAttributes:ge}}function $m(s,e,t){let n;function i(x){n=x}function r(x,B){s.drawArrays(n,x,B),t.update(B,n,1)}function o(x,B,P){P!==0&&(s.drawArraysInstanced(n,x,B,P),t.update(B,n,P))}function c(x,B,P){if(P===0)return;const U=e.get("WEBGL_multi_draw");if(U===null)for(let V=0;V<P;V++)this.render(x[V],B[V]);else{U.multiDrawArraysWEBGL(n,x,0,B,0,P);let V=0;for(let j=0;j<P;j++)V+=B[j];t.update(V,n,1)}}function E(x,B,P,U){if(P===0)return;const V=e.get("WEBGL_multi_draw");if(V===null)for(let j=0;j<x.length;j++)o(x[j],B[j],U[j]);else{V.multiDrawArraysInstancedWEBGL(n,x,0,B,0,U,0,P);let j=0;for(let ie=0;ie<P;ie++)j+=B[ie];for(let ie=0;ie<U.length;ie++)t.update(j,n,U[ie])}}this.setMode=i,this.render=r,this.renderInstances=o,this.renderMultiDraw=c,this.renderMultiDrawInstances=E}function eg(s,e,t,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const Pe=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(Pe.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(Pe){return!(Pe!==Ge&&n.convert(Pe)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(Pe){const ke=Pe===Li&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(Pe!==$n&&n.convert(Pe)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&Pe!==ir&&!ke)}function E(Pe){if(Pe==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";Pe="mediump"}return Pe==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let x=t.precision!==void 0?t.precision:"highp";const B=E(x);B!==x&&(console.warn("THREE.WebGLRenderer:",x,"not supported, using",B,"instead."),x=B);const P=t.logarithmicDepthBuffer===!0,U=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),V=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),j=s.getParameter(s.MAX_TEXTURE_SIZE),ie=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),X=s.getParameter(s.MAX_VERTEX_ATTRIBS),H=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),ge=s.getParameter(s.MAX_VARYING_VECTORS),pe=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),de=V>0,We=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:E,textureFormatReadable:o,textureTypeReadable:c,precision:x,logarithmicDepthBuffer:P,maxTextures:U,maxVertexTextures:V,maxTextureSize:j,maxCubemapSize:ie,maxAttributes:X,maxVertexUniforms:H,maxVaryings:ge,maxFragmentUniforms:pe,vertexTextures:de,maxSamples:We}}function tg(s){const e=this;let t=null,n=0,i=!1,r=!1;const o=new Co,c=new ci,E={value:null,needsUpdate:!1};this.uniform=E,this.numPlanes=0,this.numIntersection=0,this.init=function(P,U){const V=P.length!==0||U||n!==0||i;return i=U,n=P.length,V},this.beginShadows=function(){r=!0,B(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(P,U){t=B(P,U,0)},this.setState=function(P,U,V){const j=P.clippingPlanes,ie=P.clipIntersection,X=P.clipShadows,H=s.get(P);if(!i||j===null||j.length===0||r&&!X)r?B(null):x();else{const ge=r?0:n,pe=ge*4;let de=H.clippingState||null;E.value=de,de=B(j,U,pe,V);for(let We=0;We!==pe;++We)de[We]=t[We];H.clippingState=de,this.numIntersection=ie?this.numPlanes:0,this.numPlanes+=ge}};function x(){E.value!==t&&(E.value=t,E.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function B(P,U,V,j){const ie=P!==null?P.length:0;let X=null;if(ie!==0){if(X=E.value,j!==!0||X===null){const H=V+ie*4,ge=U.matrixWorldInverse;c.getNormalMatrix(ge),(X===null||X.length<H)&&(X=new Float32Array(H));for(let pe=0,de=V;pe!==ie;++pe,de+=4)o.copy(P[pe]).applyMatrix4(ge,c),o.normal.toArray(X,de),X[de+3]=o.constant}E.value=X,E.needsUpdate=!0}return e.numPlanes=ie,e.numIntersection=0,X}}function ng(s){let e=new WeakMap;function t(o,c){return c===G?o.mapping=ee:c===ue&&(o.mapping=D),o}function n(o){if(o&&o.isTexture){const c=o.mapping;if(c===G||c===ue)if(e.has(o)){const E=e.get(o).texture;return t(E,o.mapping)}else{const E=o.image;if(E&&E.height>0){const x=new td(E.height);return x.fromEquirectangularTexture(s,o),e.set(o,x),o.addEventListener("dispose",i),t(x.texture,o.mapping)}else return null}}return o}function i(o){const c=o.target;c.removeEventListener("dispose",i);const E=e.get(c);E!==void 0&&(e.delete(c),E.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}class Kl extends zl{constructor(e=-1,t=1,n=1,i=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,o=n+e,c=i+t,E=i-t;if(this.view!==null&&this.view.enabled){const x=(this.right-this.left)/this.view.fullWidth/this.zoom,B=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=x*this.view.offsetX,o=r+x*this.view.width,c-=B*this.view.offsetY,E=c-B*this.view.height}this.projectionMatrix.makeOrthographic(r,o,c,E,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const ba=4,nd=[.125,.215,.35,.446,.526,.582],ko=20,Dh=new Kl,id=new Sn;let Ph=null,Oh=0,Fh=0,Uh=!1;const Go=(1+Math.sqrt(5))/2,wa=1/Go,rd=[new De(-Go,wa,0),new De(Go,wa,0),new De(-wa,0,Go),new De(wa,0,Go),new De(0,Go,-wa),new De(0,Go,wa),new De(-1,1,-1),new De(1,1,-1),new De(-1,1,1),new De(1,1,1)];class Nh{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){Ph=this._renderer.getRenderTarget(),Oh=this._renderer.getActiveCubeFace(),Fh=this._renderer.getActiveMipmapLevel(),Uh=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=ad(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=od(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Ph,Oh,Fh),this._renderer.xr.enabled=Uh,e.scissorTest=!1,Xl(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ee||e.mapping===D?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Ph=this._renderer.getRenderTarget(),Oh=this._renderer.getActiveCubeFace(),Fh=this._renderer.getActiveMipmapLevel(),Uh=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Bn,minFilter:Bn,generateMipmaps:!1,type:Li,format:Ge,colorSpace:ai,depthBuffer:!1},i=sd(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=sd(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=ig(r)),this._blurMaterial=rg(r,e,t)}return i}_compileMaterial(e){const t=new Dr(this._lodPlanes[0],e);this._renderer.compile(t,Dh)}_sceneToCubeUV(e,t,n,i){const c=new Gr(90,1,t,n),E=[1,-1,1,1,1,1],x=[1,1,1,-1,-1,-1],B=this._renderer,P=B.autoClear,U=B.toneMapping;B.getClearColor(id),B.toneMapping=Zn,B.autoClear=!1;const V=new yo({name:"PMREM.Background",side:C,depthWrite:!1,depthTest:!1}),j=new Dr(new Fo,V);let ie=!1;const X=e.background;X?X.isColor&&(V.color.copy(X),e.background=null,ie=!0):(V.color.copy(id),ie=!0);for(let H=0;H<6;H++){const ge=H%3;ge===0?(c.up.set(0,E[H],0),c.lookAt(x[H],0,0)):ge===1?(c.up.set(0,0,E[H]),c.lookAt(0,x[H],0)):(c.up.set(0,E[H],0),c.lookAt(0,0,x[H]));const pe=this._cubeSize;Xl(i,ge*pe,H>2?pe:0,pe,pe),B.setRenderTarget(i),ie&&B.render(j,c),B.render(e,c)}j.geometry.dispose(),j.material.dispose(),B.toneMapping=U,B.autoClear=P,e.background=X}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===ee||e.mapping===D;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=ad()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=od());const r=i?this._cubemapMaterial:this._equirectMaterial,o=new Dr(this._lodPlanes[0],r),c=r.uniforms;c.envMap.value=e;const E=this._cubeSize;Xl(t,0,0,3*E,2*E),n.setRenderTarget(t),n.render(o,Dh)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),c=rd[(i-r-1)%rd.length];this._blur(e,r-1,r,o,c)}t.autoClear=n}_blur(e,t,n,i,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,i,"latitudinal",r),this._halfBlur(o,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,o,c){const E=this._renderer,x=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const B=3,P=new Dr(this._lodPlanes[i],x),U=x.uniforms,V=this._sizeLods[n]-1,j=isFinite(r)?Math.PI/(2*V):2*Math.PI/(2*ko-1),ie=r/j,X=isFinite(r)?1+Math.floor(B*ie):ko;X>ko&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${X} samples when the maximum is set to ${ko}`);const H=[];let ge=0;for(let ke=0;ke<ko;++ke){const ze=ke/ie,Te=Math.exp(-ze*ze/2);H.push(Te),ke===0?ge+=Te:ke<X&&(ge+=2*Te)}for(let ke=0;ke<H.length;ke++)H[ke]=H[ke]/ge;U.envMap.value=e.texture,U.samples.value=X,U.weights.value=H,U.latitudinal.value=o==="latitudinal",c&&(U.poleAxis.value=c);const{_lodMax:pe}=this;U.dTheta.value=j,U.mipInt.value=pe-n;const de=this._sizeLods[i],We=3*de*(i>pe-ba?i-pe+ba:0),Pe=4*(this._cubeSize-de);Xl(t,We,Pe,3*de,2*de),E.setRenderTarget(t),E.render(P,Dh)}}function ig(s){const e=[],t=[],n=[];let i=s;const r=s-ba+1+nd.length;for(let o=0;o<r;o++){const c=Math.pow(2,i);t.push(c);let E=1/c;o>s-ba?E=nd[o-s+ba-1]:o===0&&(E=0),n.push(E);const x=1/(c-2),B=-x,P=1+x,U=[B,B,P,B,P,P,B,B,P,P,B,P],V=6,j=6,ie=3,X=2,H=1,ge=new Float32Array(ie*j*V),pe=new Float32Array(X*j*V),de=new Float32Array(H*j*V);for(let Pe=0;Pe<V;Pe++){const ke=Pe%3*2/3-1,ze=Pe>2?0:-1,Te=[ke,ze,0,ke+2/3,ze,0,ke+2/3,ze+1,0,ke,ze,0,ke+2/3,ze+1,0,ke,ze+1,0];ge.set(Te,ie*j*Pe),pe.set(U,X*j*Pe);const be=[Pe,Pe,Pe,Pe,Pe,Pe];de.set(be,H*j*Pe)}const We=new wi;We.setAttribute("position",new lr(ge,ie)),We.setAttribute("uv",new lr(pe,X)),We.setAttribute("faceIndex",new lr(de,H)),e.push(We),i>ba&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function sd(s,e,t){const n=new As(s,e,t);return n.texture.mapping=xe,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Xl(s,e,t,n,i){s.viewport.set(e,t,n,i),s.scissor.set(e,t,n,i)}function rg(s,e,t){const n=new Float32Array(ko),i=new De(0,1,0);return new Os({name:"SphericalGaussianBlur",defines:{n:ko,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:kh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:_,depthTest:!1,depthWrite:!1})}function od(){return new Os({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:kh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:_,depthTest:!1,depthWrite:!1})}function ad(){return new Os({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:kh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:_,depthTest:!1,depthWrite:!1})}function kh(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function sg(s){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const E=c.mapping,x=E===G||E===ue,B=E===ee||E===D;if(x||B){let P=e.get(c);const U=P!==void 0?P.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==U)return t===null&&(t=new Nh(s)),P=x?t.fromEquirectangular(c,P):t.fromCubemap(c,P),P.texture.pmremVersion=c.pmremVersion,e.set(c,P),P.texture;if(P!==void 0)return P.texture;{const V=c.image;return x&&V&&V.height>0||B&&V&&i(V)?(t===null&&(t=new Nh(s)),P=x?t.fromEquirectangular(c):t.fromCubemap(c),P.texture.pmremVersion=c.pmremVersion,e.set(c,P),c.addEventListener("dispose",r),P.texture):null}}}return c}function i(c){let E=0;const x=6;for(let B=0;B<x;B++)c[B]!==void 0&&E++;return E===x}function r(c){const E=c.target;E.removeEventListener("dispose",r);const x=e.get(E);x!==void 0&&(e.delete(E),x.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function og(s){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=s.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function ag(s,e,t,n){const i={},r=new WeakMap;function o(P){const U=P.target;U.index!==null&&e.remove(U.index);for(const j in U.attributes)e.remove(U.attributes[j]);for(const j in U.morphAttributes){const ie=U.morphAttributes[j];for(let X=0,H=ie.length;X<H;X++)e.remove(ie[X])}U.removeEventListener("dispose",o),delete i[U.id];const V=r.get(U);V&&(e.remove(V),r.delete(U)),n.releaseStatesOfGeometry(U),U.isInstancedBufferGeometry===!0&&delete U._maxInstanceCount,t.memory.geometries--}function c(P,U){return i[U.id]===!0||(U.addEventListener("dispose",o),i[U.id]=!0,t.memory.geometries++),U}function E(P){const U=P.attributes;for(const j in U)e.update(U[j],s.ARRAY_BUFFER);const V=P.morphAttributes;for(const j in V){const ie=V[j];for(let X=0,H=ie.length;X<H;X++)e.update(ie[X],s.ARRAY_BUFFER)}}function x(P){const U=[],V=P.index,j=P.attributes.position;let ie=0;if(V!==null){const ge=V.array;ie=V.version;for(let pe=0,de=ge.length;pe<de;pe+=3){const We=ge[pe+0],Pe=ge[pe+1],ke=ge[pe+2];U.push(We,Pe,Pe,ke,ke,We)}}else if(j!==void 0){const ge=j.array;ie=j.version;for(let pe=0,de=ge.length/3-1;pe<de;pe+=3){const We=pe+0,Pe=pe+1,ke=pe+2;U.push(We,Pe,Pe,ke,ke,We)}}else return;const X=new(bl(U)?Th:Sh)(U,1);X.version=ie;const H=r.get(P);H&&e.remove(H),r.set(P,X)}function B(P){const U=r.get(P);if(U){const V=P.index;V!==null&&U.version<V.version&&x(P)}else x(P);return r.get(P)}return{get:c,update:E,getWireframeAttribute:B}}function lg(s,e,t){let n;function i(U){n=U}let r,o;function c(U){r=U.type,o=U.bytesPerElement}function E(U,V){s.drawElements(n,V,r,U*o),t.update(V,n,1)}function x(U,V,j){j!==0&&(s.drawElementsInstanced(n,V,r,U*o,j),t.update(V,n,j))}function B(U,V,j){if(j===0)return;const ie=e.get("WEBGL_multi_draw");if(ie===null)for(let X=0;X<j;X++)this.render(U[X]/o,V[X]);else{ie.multiDrawElementsWEBGL(n,V,0,r,U,0,j);let X=0;for(let H=0;H<j;H++)X+=V[H];t.update(X,n,1)}}function P(U,V,j,ie){if(j===0)return;const X=e.get("WEBGL_multi_draw");if(X===null)for(let H=0;H<U.length;H++)x(U[H]/o,V[H],ie[H]);else{X.multiDrawElementsInstancedWEBGL(n,V,0,r,U,0,ie,0,j);let H=0;for(let ge=0;ge<j;ge++)H+=V[ge];for(let ge=0;ge<ie.length;ge++)t.update(H,n,ie[ge])}}this.setMode=i,this.setIndex=c,this.render=E,this.renderInstances=x,this.renderMultiDraw=B,this.renderMultiDrawInstances=P}function cg(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,o,c){switch(t.calls++,o){case s.TRIANGLES:t.triangles+=c*(r/3);break;case s.LINES:t.lines+=c*(r/2);break;case s.LINE_STRIP:t.lines+=c*(r-1);break;case s.LINE_LOOP:t.lines+=c*r;break;case s.POINTS:t.points+=c*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function hg(s,e,t){const n=new WeakMap,i=new zi;function r(o,c,E){const x=o.morphTargetInfluences,B=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,P=B!==void 0?B.length:0;let U=n.get(c);if(U===void 0||U.count!==P){let V=function(){ze.dispose(),n.delete(c),c.removeEventListener("dispose",V)};U!==void 0&&U.texture.dispose();const j=c.morphAttributes.position!==void 0,ie=c.morphAttributes.normal!==void 0,X=c.morphAttributes.color!==void 0,H=c.morphAttributes.position||[],ge=c.morphAttributes.normal||[],pe=c.morphAttributes.color||[];let de=0;j===!0&&(de=1),ie===!0&&(de=2),X===!0&&(de=3);let We=c.attributes.position.count*de,Pe=1;We>e.maxTextureSize&&(Pe=Math.ceil(We/e.maxTextureSize),We=e.maxTextureSize);const ke=new Float32Array(We*Pe*4*P),ze=new oa(ke,We,Pe,P);ze.type=ir,ze.needsUpdate=!0;const Te=de*4;for(let be=0;be<P;be++){const je=H[be],nt=ge[be],$e=pe[be],rt=We*Pe*4*be;for(let mt=0;mt<je.count;mt++){const Rt=mt*Te;j===!0&&(i.fromBufferAttribute(je,mt),ke[rt+Rt+0]=i.x,ke[rt+Rt+1]=i.y,ke[rt+Rt+2]=i.z,ke[rt+Rt+3]=0),ie===!0&&(i.fromBufferAttribute(nt,mt),ke[rt+Rt+4]=i.x,ke[rt+Rt+5]=i.y,ke[rt+Rt+6]=i.z,ke[rt+Rt+7]=0),X===!0&&(i.fromBufferAttribute($e,mt),ke[rt+Rt+8]=i.x,ke[rt+Rt+9]=i.y,ke[rt+Rt+10]=i.z,ke[rt+Rt+11]=$e.itemSize===4?i.w:1)}}U={count:P,texture:ze,size:new Lt(We,Pe)},n.set(c,U),c.addEventListener("dispose",V)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)E.getUniforms().setValue(s,"morphTexture",o.morphTexture,t);else{let V=0;for(let ie=0;ie<x.length;ie++)V+=x[ie];const j=c.morphTargetsRelative?1:1-V;E.getUniforms().setValue(s,"morphTargetBaseInfluence",j),E.getUniforms().setValue(s,"morphTargetInfluences",x)}E.getUniforms().setValue(s,"morphTargetsTexture",U.texture,t),E.getUniforms().setValue(s,"morphTargetsTextureSize",U.size)}return{update:r}}class ug{constructor(e,t,n){if(this.renderer=e,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=n,this.extensions=t,this.available=this.extensions.has("OCULUS_multiview"),this.available){const r=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(r.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var i=0;i<this.maxNumViews;i++)this.mat4[i]=new On,this.mat3[i]=new ci}}getCameraArray(e){return e.isArrayCamera?e.cameras:(this.cameraArray[0]=e,this.cameraArray)}updateCameraProjectionMatricesUniform(e,t){for(var n=this.getCameraArray(e),i=0;i<n.length;i++)this.mat4[i].copy(n[i].projectionMatrix);t.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(e,t){for(var n=this.getCameraArray(e),i=0;i<n.length;i++)this.mat4[i].copy(n[i].matrixWorldInverse);t.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(e,t,n){for(var i=this.getCameraArray(t),r=0;r<i.length;r++)this.mat4[r].multiplyMatrices(i[r].matrixWorldInverse,e.matrixWorld),this.mat3[r].getNormalMatrix(this.mat4[r]);n.setValue(this.gl,"modelViewMatrices",this.mat4),n.setValue(this.gl,"normalMatrices",this.mat3)}}function dg(s,e,t,n){let i=new WeakMap;function r(E){const x=n.render.frame,B=E.geometry,P=e.get(E,B);if(i.get(P)!==x&&(e.update(P),i.set(P,x)),E.isInstancedMesh&&(E.hasEventListener("dispose",c)===!1&&E.addEventListener("dispose",c),i.get(E)!==x&&(t.update(E.instanceMatrix,s.ARRAY_BUFFER),E.instanceColor!==null&&t.update(E.instanceColor,s.ARRAY_BUFFER),i.set(E,x))),E.isSkinnedMesh){const U=E.skeleton;i.get(U)!==x&&(U.update(),i.set(U,x))}return P}function o(){i=new WeakMap}function c(E){const x=E.target;x.removeEventListener("dispose",c),t.remove(x.instanceMatrix),x.instanceColor!==null&&t.remove(x.instanceColor)}return{update:r,dispose:o}}class Gh extends fr{constructor(e,t,n,i,r,o,c,E,x,B){if(B=B!==void 0?B:lt,B!==lt&&B!==wt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&B===lt&&(n=Sr),n===void 0&&B===wt&&(n=Ur),super(null,i,r,o,c,E,B,n,x),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=c!==void 0?c:Yt,this.minFilter=E!==void 0?E:Yt,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const ld=new fr,cd=new Gh(1,1);cd.compareFunction=Ts;const hd=new oa,ud=new hi,dd=new Wa,fd=[],pd=[],Ad=new Float32Array(16),md=new Float32Array(9),gd=new Float32Array(4);function _a(s,e,t){const n=s[0];if(n<=0||n>0)return s;const i=e*t;let r=fd[i];if(r===void 0&&(r=new Float32Array(i),fd[i]=r),e!==0){n.toArray(r,0);for(let o=1,c=0;o!==e;++o)c+=t,s[o].toArray(r,c)}return r}function Qr(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function Vr(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function Yl(s,e){let t=pd[e];t===void 0&&(t=new Int32Array(e),pd[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function fg(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function pg(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Qr(t,e))return;s.uniform2fv(this.addr,e),Vr(t,e)}}function Ag(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Qr(t,e))return;s.uniform3fv(this.addr,e),Vr(t,e)}}function mg(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Qr(t,e))return;s.uniform4fv(this.addr,e),Vr(t,e)}}function gg(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Qr(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),Vr(t,e)}else{if(Qr(t,n))return;gd.set(n),s.uniformMatrix2fv(this.addr,!1,gd),Vr(t,n)}}function vg(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Qr(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),Vr(t,e)}else{if(Qr(t,n))return;md.set(n),s.uniformMatrix3fv(this.addr,!1,md),Vr(t,n)}}function yg(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Qr(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),Vr(t,e)}else{if(Qr(t,n))return;Ad.set(n),s.uniformMatrix4fv(this.addr,!1,Ad),Vr(t,n)}}function Eg(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function Cg(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Qr(t,e))return;s.uniform2iv(this.addr,e),Vr(t,e)}}function xg(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Qr(t,e))return;s.uniform3iv(this.addr,e),Vr(t,e)}}function bg(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Qr(t,e))return;s.uniform4iv(this.addr,e),Vr(t,e)}}function wg(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function _g(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Qr(t,e))return;s.uniform2uiv(this.addr,e),Vr(t,e)}}function Mg(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Qr(t,e))return;s.uniform3uiv(this.addr,e),Vr(t,e)}}function Sg(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Qr(t,e))return;s.uniform4uiv(this.addr,e),Vr(t,e)}}function Tg(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i);const r=this.type===s.SAMPLER_2D_SHADOW?cd:ld;t.setTexture2D(e||r,i)}function Ig(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||ud,i)}function Bg(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||dd,i)}function Rg(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||hd,i)}function Lg(s){switch(s){case 5126:return fg;case 35664:return pg;case 35665:return Ag;case 35666:return mg;case 35674:return gg;case 35675:return vg;case 35676:return yg;case 5124:case 35670:return Eg;case 35667:case 35671:return Cg;case 35668:case 35672:return xg;case 35669:case 35673:return bg;case 5125:return wg;case 36294:return _g;case 36295:return Mg;case 36296:return Sg;case 35678:case 36198:case 36298:case 36306:case 35682:return Tg;case 35679:case 36299:case 36307:return Ig;case 35680:case 36300:case 36308:case 36293:return Bg;case 36289:case 36303:case 36311:case 36292:return Rg}}function Dg(s,e){s.uniform1fv(this.addr,e)}function Pg(s,e){const t=_a(e,this.size,2);s.uniform2fv(this.addr,t)}function Og(s,e){const t=_a(e,this.size,3);s.uniform3fv(this.addr,t)}function Fg(s,e){const t=_a(e,this.size,4);s.uniform4fv(this.addr,t)}function Ug(s,e){const t=_a(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function Ng(s,e){const t=_a(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function kg(s,e){const t=_a(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function Gg(s,e){s.uniform1iv(this.addr,e)}function Qg(s,e){s.uniform2iv(this.addr,e)}function Vg(s,e){s.uniform3iv(this.addr,e)}function Hg(s,e){s.uniform4iv(this.addr,e)}function zg(s,e){s.uniform1uiv(this.addr,e)}function jg(s,e){s.uniform2uiv(this.addr,e)}function Wg(s,e){s.uniform3uiv(this.addr,e)}function Kg(s,e){s.uniform4uiv(this.addr,e)}function Xg(s,e,t){const n=this.cache,i=e.length,r=Yl(t,i);Qr(n,r)||(s.uniform1iv(this.addr,r),Vr(n,r));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||ld,r[o])}function Yg(s,e,t){const n=this.cache,i=e.length,r=Yl(t,i);Qr(n,r)||(s.uniform1iv(this.addr,r),Vr(n,r));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||ud,r[o])}function qg(s,e,t){const n=this.cache,i=e.length,r=Yl(t,i);Qr(n,r)||(s.uniform1iv(this.addr,r),Vr(n,r));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||dd,r[o])}function Jg(s,e,t){const n=this.cache,i=e.length,r=Yl(t,i);Qr(n,r)||(s.uniform1iv(this.addr,r),Vr(n,r));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||hd,r[o])}function Zg(s){switch(s){case 5126:return Dg;case 35664:return Pg;case 35665:return Og;case 35666:return Fg;case 35674:return Ug;case 35675:return Ng;case 35676:return kg;case 5124:case 35670:return Gg;case 35667:case 35671:return Qg;case 35668:case 35672:return Vg;case 35669:case 35673:return Hg;case 5125:return zg;case 36294:return jg;case 36295:return Wg;case 36296:return Kg;case 35678:case 36198:case 36298:case 36306:case 35682:return Xg;case 35679:case 36299:case 36307:return Yg;case 35680:case 36300:case 36308:case 36293:return qg;case 36289:case 36303:case 36311:case 36292:return Jg}}class $g{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=Lg(t.type)}}class e0{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Zg(t.type)}}class t0{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,o=i.length;r!==o;++r){const c=i[r];c.setValue(e,t[c.id],n)}}}const Qh=/(\w+)(\])?(\[|\.)?/g;function vd(s,e){s.seq.push(e),s.map[e.id]=e}function n0(s,e,t){const n=s.name,i=n.length;for(Qh.lastIndex=0;;){const r=Qh.exec(n),o=Qh.lastIndex;let c=r[1];const E=r[2]==="]",x=r[3];if(E&&(c=c|0),x===void 0||x==="["&&o+2===i){vd(t,x===void 0?new $g(c,s,e):new e0(c,s,e));break}else{let P=t.map[c];P===void 0&&(P=new t0(c),vd(t,P)),t=P}}}class ql{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const r=e.getActiveUniform(t,i),o=e.getUniformLocation(t,r.name);n0(r,o,this)}}setValue(e,t,n,i){const r=this.map[t];r!==void 0&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,o=t.length;r!==o;++r){const c=t[r],E=n[c.id];E.needsUpdate!==!1&&c.setValue(e,E.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const o=e[i];o.id in t&&n.push(o)}return n}}function yd(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const i0=37297;let r0=0;function s0(s,e){const t=s.split(`
`),n=[],i=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=i;o<r;o++){const c=o+1;n.push(`${c===e?">":" "} ${c}: ${t[o]}`)}return n.join(`
`)}function o0(s){const e=$i.getPrimaries($i.workingColorSpace),t=$i.getPrimaries(s);let n;switch(e===t?n="":e===cr&&t===Ni?n="LinearDisplayP3ToLinearSRGB":e===Ni&&t===cr&&(n="LinearSRGBToLinearDisplayP3"),s){case ai:case Un:return[n,"LinearTransferOETF"];case Mn:case qn:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",s),[n,"LinearTransferOETF"]}}function Ed(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),i=s.getShaderInfoLog(e).trim();if(n&&i==="")return"";const r=/ERROR: 0:(\d+)/.exec(i);if(r){const o=parseInt(r[1]);return t.toUpperCase()+`

`+i+`

`+s0(s.getShaderSource(e),o)}else return i}function a0(s,e){const t=o0(e);return`vec4 ${s}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function l0(s,e){let t;switch(e){case Ui:t="Linear";break;case Qi:t="Reinhard";break;case Kn:t="OptimizedCineon";break;case Mt:t="ACESFilmic";break;case ye:t="AgX";break;case Fe:t="Neutral";break;case Ce:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function c0(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Xa).join(`
`)}function h0(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function u0(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const r=s.getActiveAttrib(e,i),o=r.name;let c=1;r.type===s.FLOAT_MAT2&&(c=2),r.type===s.FLOAT_MAT3&&(c=3),r.type===s.FLOAT_MAT4&&(c=4),t[o]={type:r.type,location:s.getAttribLocation(e,o),locationSize:c}}return t}function Xa(s){return s!==""}function Cd(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function xd(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const d0=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vh(s){return s.replace(d0,p0)}const f0=new Map;function p0(s,e){let t=Ei[e];if(t===void 0){const n=f0.get(e);if(n!==void 0)t=Ei[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Vh(t)}const A0=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function bd(s){return s.replace(A0,m0)}function m0(s,e,t,n){let i="";for(let r=parseInt(e);r<parseInt(t);r++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return i}function wd(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function g0(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===y?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===g?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===d&&(e="SHADOWMAP_TYPE_VSM"),e}function v0(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case ee:case D:e="ENVMAP_TYPE_CUBE";break;case xe:e="ENVMAP_TYPE_CUBE_UV";break}return e}function y0(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case D:e="ENVMAP_MODE_REFRACTION";break}return e}function E0(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case Fn:e="ENVMAP_BLENDING_MULTIPLY";break;case Wn:e="ENVMAP_BLENDING_MIX";break;case Si:e="ENVMAP_BLENDING_ADD";break}return e}function C0(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function x0(s,e,t,n){const i=s.getContext(),r=t.defines;let o=t.vertexShader,c=t.fragmentShader;const E=g0(t),x=v0(t),B=y0(t),P=E0(t),U=C0(t),V=c0(t),j=h0(r),ie=i.createProgram();let X,H,ge=t.glslVersion?"#version "+t.glslVersion+`
`:"";const pe=t.numMultiviewViews;t.isRawShaderMaterial?(X=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j].filter(Xa).join(`
`),X.length>0&&(X+=`
`),H=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j].filter(Xa).join(`
`),H.length>0&&(H+=`
`)):(X=[wd(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+B:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+E:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Xa).join(`
`),H=[wd(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,j,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+x:"",t.envMap?"#define "+B:"",t.envMap?"#define "+P:"",U?"#define CUBEUV_TEXEL_WIDTH "+U.texelWidth:"",U?"#define CUBEUV_TEXEL_HEIGHT "+U.texelHeight:"",U?"#define CUBEUV_MAX_MIP "+U.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+E:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Zn?"#define TONE_MAPPING":"",t.toneMapping!==Zn?Ei.tonemapping_pars_fragment:"",t.toneMapping!==Zn?l0("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Ei.colorspace_pars_fragment,a0("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Xa).join(`
`)),o=Vh(o),o=Cd(o,t),o=xd(o,t),c=Vh(c),c=Cd(c,t),c=xd(c,t),o=bd(o),c=bd(c),t.isRawShaderMaterial!==!0&&(ge=`#version 300 es
`,X=[V,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+X,H=["#define varying in",t.glslVersion===Ua?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Ua?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+H,pe>0&&(X=["#extension GL_OVR_multiview : require","layout(num_views = "+pe+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+X,X=X.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+pe+"];","uniform mat4 projectionMatrices["+pe+"];","uniform mat4 viewMatrices["+pe+"];","uniform mat3 normalMatrices["+pe+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),H=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+H,H=H.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+pe+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));const de=ge+X+o,We=ge+H+c,Pe=yd(i,i.VERTEX_SHADER,de),ke=yd(i,i.FRAGMENT_SHADER,We);i.attachShader(ie,Pe),i.attachShader(ie,ke),t.index0AttributeName!==void 0?i.bindAttribLocation(ie,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(ie,0,"position"),i.linkProgram(ie);function ze(nt){if(s.debug.checkShaderErrors){const $e=i.getProgramInfoLog(ie).trim(),rt=i.getShaderInfoLog(Pe).trim(),mt=i.getShaderInfoLog(ke).trim();let Rt=!0,ln=!0;if(i.getProgramParameter(ie,i.LINK_STATUS)===!1)if(Rt=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(i,ie,Pe,ke);else{const vt=Ed(i,Pe,"vertex"),en=Ed(i,ke,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(ie,i.VALIDATE_STATUS)+`

Material Name: `+nt.name+`
Material Type: `+nt.type+`

Program Info Log: `+$e+`
`+vt+`
`+en)}else $e!==""?console.warn("THREE.WebGLProgram: Program Info Log:",$e):(rt===""||mt==="")&&(ln=!1);ln&&(nt.diagnostics={runnable:Rt,programLog:$e,vertexShader:{log:rt,prefix:X},fragmentShader:{log:mt,prefix:H}})}i.deleteShader(Pe),i.deleteShader(ke),Te=new ql(i,ie),be=u0(i,ie)}let Te;this.getUniforms=function(){return Te===void 0&&ze(this),Te};let be;this.getAttributes=function(){return be===void 0&&ze(this),be};let je=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return je===!1&&(je=i.getProgramParameter(ie,i0)),je},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(ie),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=r0++,this.cacheKey=e,this.usedTimes=1,this.program=ie,this.vertexShader=Pe,this.fragmentShader=ke,this.numMultiviewViews=pe,this}let b0=0;class w0{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new _0(e),t.set(e,n)),n}}class _0{constructor(e){this.id=b0++,this.code=e,this.usedTimes=0}}function M0(s,e,t,n,i,r,o){const c=new Ll,E=new w0,x=new Set,B=[],P=i.logarithmicDepthBuffer,U=i.vertexTextures;let V=i.precision;const j={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ie(Te){return x.add(Te),Te===0?"uv":`uv${Te}`}function X(Te,be,je,nt,$e){const rt=nt.fog,mt=$e.geometry,Rt=Te.isMeshStandardMaterial?nt.environment:null,ln=(Te.isMeshStandardMaterial?t:e).get(Te.envMap||Rt),vt=ln&&ln.mapping===xe?ln.image.height:null,en=j[Te.type];Te.precision!==null&&(V=i.getMaxPrecision(Te.precision),V!==Te.precision&&console.warn("THREE.WebGLProgram.getParameters:",Te.precision,"not supported, using",V,"instead."));const rn=mt.morphAttributes.position||mt.morphAttributes.normal||mt.morphAttributes.color,Dn=rn!==void 0?rn.length:0;let _i=0;mt.morphAttributes.position!==void 0&&(_i=1),mt.morphAttributes.normal!==void 0&&(_i=2),mt.morphAttributes.color!==void 0&&(_i=3);let er,Ar,qi,ur;if(en){const Hr=Fs[en];er=Hr.vertexShader,Ar=Hr.fragmentShader}else er=Te.vertexShader,Ar=Te.fragmentShader,E.update(Te),qi=E.getVertexShaderID(Te),ur=E.getFragmentShaderID(Te);const Nn=s.getRenderTarget(),Pt=Nn&&Nn.isWebGLMultiviewRenderTarget?Nn.numViews:0,hn=$e.isInstancedMesh===!0,mn=$e.isBatchedMesh===!0,st=!!Te.map,Ot=!!Te.matcap,Tt=!!ln,$t=!!Te.aoMap,Xt=!!Te.lightMap,Wt=!!Te.bumpMap,gn=!!Te.normalMap,_n=!!Te.displacementMap,li=!!Te.emissiveMap,di=!!Te.metalnessMap,Ji=!!Te.roughnessMap,_r=Te.anisotropy>0,mr=Te.clearcoat>0,Ve=Te.dispersion>0,we=Te.iridescence>0,xt=Te.sheen>0,Dt=Te.transmission>0,Qt=_r&&!!Te.anisotropyMap,Ut=mr&&!!Te.clearcoatMap,Vn=mr&&!!Te.clearcoatNormalMap,cn=mr&&!!Te.clearcoatRoughnessMap,Tn=we&&!!Te.iridescenceMap,rr=we&&!!Te.iridescenceThicknessMap,In=xt&&!!Te.sheenColorMap,zn=xt&&!!Te.sheenRoughnessMap,Ci=!!Te.specularMap,ni=!!Te.specularColorMap,Ye=!!Te.specularIntensityMap,Kt=Dt&&!!Te.transmissionMap,sn=Dt&&!!Te.thicknessMap,Hn=!!Te.gradientMap,bn=!!Te.alphaMap,xi=Te.alphaTest>0,wn=!!Te.alphaHash,vn=!!Te.extensions;let Ii=Zn;Te.toneMapped&&(Nn===null||Nn.isXRRenderTarget===!0)&&(Ii=s.toneMapping);const ii={shaderID:en,shaderType:Te.type,shaderName:Te.name,vertexShader:er,fragmentShader:Ar,defines:Te.defines,customVertexShaderID:qi,customFragmentShaderID:ur,isRawShaderMaterial:Te.isRawShaderMaterial===!0,glslVersion:Te.glslVersion,precision:V,batching:mn,instancing:hn,instancingColor:hn&&$e.instanceColor!==null,instancingMorph:hn&&$e.morphTexture!==null,supportsVertexTextures:U,numMultiviewViews:Pt,outputColorSpace:Nn===null?s.outputColorSpace:Nn.isXRRenderTarget===!0?Nn.texture.colorSpace:ai,alphaToCoverage:!!Te.alphaToCoverage,map:st,matcap:Ot,envMap:Tt,envMapMode:Tt&&ln.mapping,envMapCubeUVHeight:vt,aoMap:$t,lightMap:Xt,bumpMap:Wt,normalMap:gn,displacementMap:U&&_n,emissiveMap:li,normalMapObjectSpace:gn&&Te.normalMapType===Vt,normalMapTangentSpace:gn&&Te.normalMapType===pn,metalnessMap:di,roughnessMap:Ji,anisotropy:_r,anisotropyMap:Qt,clearcoat:mr,clearcoatMap:Ut,clearcoatNormalMap:Vn,clearcoatRoughnessMap:cn,dispersion:Ve,iridescence:we,iridescenceMap:Tn,iridescenceThicknessMap:rr,sheen:xt,sheenColorMap:In,sheenRoughnessMap:zn,specularMap:Ci,specularColorMap:ni,specularIntensityMap:Ye,transmission:Dt,transmissionMap:Kt,thicknessMap:sn,gradientMap:Hn,opaque:Te.transparent===!1&&Te.blending===L&&Te.alphaToCoverage===!1,alphaMap:bn,alphaTest:xi,alphaHash:wn,combine:Te.combine,mapUv:st&&ie(Te.map.channel),aoMapUv:$t&&ie(Te.aoMap.channel),lightMapUv:Xt&&ie(Te.lightMap.channel),bumpMapUv:Wt&&ie(Te.bumpMap.channel),normalMapUv:gn&&ie(Te.normalMap.channel),displacementMapUv:_n&&ie(Te.displacementMap.channel),emissiveMapUv:li&&ie(Te.emissiveMap.channel),metalnessMapUv:di&&ie(Te.metalnessMap.channel),roughnessMapUv:Ji&&ie(Te.roughnessMap.channel),anisotropyMapUv:Qt&&ie(Te.anisotropyMap.channel),clearcoatMapUv:Ut&&ie(Te.clearcoatMap.channel),clearcoatNormalMapUv:Vn&&ie(Te.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:cn&&ie(Te.clearcoatRoughnessMap.channel),iridescenceMapUv:Tn&&ie(Te.iridescenceMap.channel),iridescenceThicknessMapUv:rr&&ie(Te.iridescenceThicknessMap.channel),sheenColorMapUv:In&&ie(Te.sheenColorMap.channel),sheenRoughnessMapUv:zn&&ie(Te.sheenRoughnessMap.channel),specularMapUv:Ci&&ie(Te.specularMap.channel),specularColorMapUv:ni&&ie(Te.specularColorMap.channel),specularIntensityMapUv:Ye&&ie(Te.specularIntensityMap.channel),transmissionMapUv:Kt&&ie(Te.transmissionMap.channel),thicknessMapUv:sn&&ie(Te.thicknessMap.channel),alphaMapUv:bn&&ie(Te.alphaMap.channel),vertexTangents:!!mt.attributes.tangent&&(gn||_r),vertexColors:Te.vertexColors,vertexAlphas:Te.vertexColors===!0&&!!mt.attributes.color&&mt.attributes.color.itemSize===4,pointsUvs:$e.isPoints===!0&&!!mt.attributes.uv&&(st||bn),fog:!!rt,useFog:Te.fog===!0,fogExp2:!!rt&&rt.isFogExp2,flatShading:Te.flatShading===!0,sizeAttenuation:Te.sizeAttenuation===!0,logarithmicDepthBuffer:P,skinning:$e.isSkinnedMesh===!0,morphTargets:mt.morphAttributes.position!==void 0,morphNormals:mt.morphAttributes.normal!==void 0,morphColors:mt.morphAttributes.color!==void 0,morphTargetsCount:Dn,morphTextureStride:_i,numDirLights:be.directional.length,numPointLights:be.point.length,numSpotLights:be.spot.length,numSpotLightMaps:be.spotLightMap.length,numRectAreaLights:be.rectArea.length,numHemiLights:be.hemi.length,numDirLightShadows:be.directionalShadowMap.length,numPointLightShadows:be.pointShadowMap.length,numSpotLightShadows:be.spotShadowMap.length,numSpotLightShadowsWithMaps:be.numSpotLightShadowsWithMaps,numLightProbes:be.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:Te.dithering,shadowMapEnabled:s.shadowMap.enabled&&je.length>0,shadowMapType:s.shadowMap.type,toneMapping:Ii,useLegacyLights:s._useLegacyLights,decodeVideoTexture:st&&Te.map.isVideoTexture===!0&&$i.getTransfer(Te.map.colorSpace)===Qn,premultipliedAlpha:Te.premultipliedAlpha,doubleSided:Te.side===S,flipSided:Te.side===C,useDepthPacking:Te.depthPacking>=0,depthPacking:Te.depthPacking||0,index0AttributeName:Te.index0AttributeName,extensionClipCullDistance:vn&&Te.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:vn&&Te.extensions.multiDraw===!0&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:Te.customProgramCacheKey()};return ii.vertexUv1s=x.has(1),ii.vertexUv2s=x.has(2),ii.vertexUv3s=x.has(3),x.clear(),ii}function H(Te){const be=[];if(Te.shaderID?be.push(Te.shaderID):(be.push(Te.customVertexShaderID),be.push(Te.customFragmentShaderID)),Te.defines!==void 0)for(const je in Te.defines)be.push(je),be.push(Te.defines[je]);return Te.isRawShaderMaterial===!1&&(ge(be,Te),pe(be,Te),be.push(s.outputColorSpace)),be.push(Te.customProgramCacheKey),be.join()}function ge(Te,be){Te.push(be.precision),Te.push(be.outputColorSpace),Te.push(be.envMapMode),Te.push(be.envMapCubeUVHeight),Te.push(be.mapUv),Te.push(be.alphaMapUv),Te.push(be.lightMapUv),Te.push(be.aoMapUv),Te.push(be.bumpMapUv),Te.push(be.normalMapUv),Te.push(be.displacementMapUv),Te.push(be.emissiveMapUv),Te.push(be.metalnessMapUv),Te.push(be.roughnessMapUv),Te.push(be.anisotropyMapUv),Te.push(be.clearcoatMapUv),Te.push(be.clearcoatNormalMapUv),Te.push(be.clearcoatRoughnessMapUv),Te.push(be.iridescenceMapUv),Te.push(be.iridescenceThicknessMapUv),Te.push(be.sheenColorMapUv),Te.push(be.sheenRoughnessMapUv),Te.push(be.specularMapUv),Te.push(be.specularColorMapUv),Te.push(be.specularIntensityMapUv),Te.push(be.transmissionMapUv),Te.push(be.thicknessMapUv),Te.push(be.combine),Te.push(be.fogExp2),Te.push(be.sizeAttenuation),Te.push(be.morphTargetsCount),Te.push(be.morphAttributeCount),Te.push(be.numDirLights),Te.push(be.numPointLights),Te.push(be.numSpotLights),Te.push(be.numSpotLightMaps),Te.push(be.numHemiLights),Te.push(be.numRectAreaLights),Te.push(be.numDirLightShadows),Te.push(be.numPointLightShadows),Te.push(be.numSpotLightShadows),Te.push(be.numSpotLightShadowsWithMaps),Te.push(be.numLightProbes),Te.push(be.shadowMapType),Te.push(be.toneMapping),Te.push(be.numClippingPlanes),Te.push(be.numClipIntersection),Te.push(be.depthPacking)}function pe(Te,be){c.disableAll(),be.supportsVertexTextures&&c.enable(0),be.instancing&&c.enable(1),be.instancingColor&&c.enable(2),be.instancingMorph&&c.enable(3),be.matcap&&c.enable(4),be.envMap&&c.enable(5),be.normalMapObjectSpace&&c.enable(6),be.normalMapTangentSpace&&c.enable(7),be.clearcoat&&c.enable(8),be.iridescence&&c.enable(9),be.alphaTest&&c.enable(10),be.vertexColors&&c.enable(11),be.vertexAlphas&&c.enable(12),be.vertexUv1s&&c.enable(13),be.vertexUv2s&&c.enable(14),be.vertexUv3s&&c.enable(15),be.vertexTangents&&c.enable(16),be.anisotropy&&c.enable(17),be.alphaHash&&c.enable(18),be.batching&&c.enable(19),be.dispersion&&c.enable(20),Te.push(c.mask),c.disableAll(),be.fog&&c.enable(0),be.useFog&&c.enable(1),be.flatShading&&c.enable(2),be.logarithmicDepthBuffer&&c.enable(3),be.skinning&&c.enable(4),be.morphTargets&&c.enable(5),be.morphNormals&&c.enable(6),be.morphColors&&c.enable(7),be.premultipliedAlpha&&c.enable(8),be.shadowMapEnabled&&c.enable(9),be.useLegacyLights&&c.enable(10),be.doubleSided&&c.enable(11),be.flipSided&&c.enable(12),be.useDepthPacking&&c.enable(13),be.dithering&&c.enable(14),be.transmission&&c.enable(15),be.sheen&&c.enable(16),be.opaque&&c.enable(17),be.pointsUvs&&c.enable(18),be.decodeVideoTexture&&c.enable(19),be.alphaToCoverage&&c.enable(20),be.numMultiviewViews&&c.enable(21),Te.push(c.mask)}function de(Te){const be=j[Te.type];let je;if(be){const nt=Fs[be];je=Ju.clone(nt.uniforms)}else je=Te.uniforms;return je}function We(Te,be){let je;for(let nt=0,$e=B.length;nt<$e;nt++){const rt=B[nt];if(rt.cacheKey===be){je=rt,++je.usedTimes;break}}return je===void 0&&(je=new x0(s,be,Te,r),B.push(je)),je}function Pe(Te){if(--Te.usedTimes===0){const be=B.indexOf(Te);B[be]=B[B.length-1],B.pop(),Te.destroy()}}function ke(Te){E.remove(Te)}function ze(){E.dispose()}return{getParameters:X,getProgramCacheKey:H,getUniforms:de,acquireProgram:We,releaseProgram:Pe,releaseShaderCache:ke,programs:B,dispose:ze}}function S0(){let s=new WeakMap;function e(r){let o=s.get(r);return o===void 0&&(o={},s.set(r,o)),o}function t(r){s.delete(r)}function n(r,o,c){s.get(r)[o]=c}function i(){s=new WeakMap}return{get:e,remove:t,update:n,dispose:i}}function T0(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function _d(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function Md(){const s=[];let e=0;const t=[],n=[],i=[];function r(){e=0,t.length=0,n.length=0,i.length=0}function o(P,U,V,j,ie,X){let H=s[e];return H===void 0?(H={id:P.id,object:P,geometry:U,material:V,groupOrder:j,renderOrder:P.renderOrder,z:ie,group:X},s[e]=H):(H.id=P.id,H.object=P,H.geometry=U,H.material=V,H.groupOrder=j,H.renderOrder=P.renderOrder,H.z=ie,H.group=X),e++,H}function c(P,U,V,j,ie,X){const H=o(P,U,V,j,ie,X);V.transmission>0?n.push(H):V.transparent===!0?i.push(H):t.push(H)}function E(P,U,V,j,ie,X){const H=o(P,U,V,j,ie,X);V.transmission>0?n.unshift(H):V.transparent===!0?i.unshift(H):t.unshift(H)}function x(P,U){t.length>1&&t.sort(P||T0),n.length>1&&n.sort(U||_d),i.length>1&&i.sort(U||_d)}function B(){for(let P=e,U=s.length;P<U;P++){const V=s[P];if(V.id===null)break;V.id=null,V.object=null,V.geometry=null,V.material=null,V.group=null}}return{opaque:t,transmissive:n,transparent:i,init:r,push:c,unshift:E,finish:B,sort:x}}function I0(){let s=new WeakMap;function e(n,i){const r=s.get(n);let o;return r===void 0?(o=new Md,s.set(n,[o])):i>=r.length?(o=new Md,r.push(o)):o=r[i],o}function t(){s=new WeakMap}return{get:e,dispose:t}}function B0(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new De,color:new Sn};break;case"SpotLight":t={position:new De,direction:new De,color:new Sn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new De,color:new Sn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new De,skyColor:new Sn,groundColor:new Sn};break;case"RectAreaLight":t={color:new Sn,position:new De,halfWidth:new De,halfHeight:new De};break}return s[e.id]=t,t}}}function R0(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lt};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lt,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let L0=0;function D0(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function P0(s){const e=new B0,t=R0(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let x=0;x<9;x++)n.probe.push(new De);const i=new De,r=new On,o=new On;function c(x,B){let P=0,U=0,V=0;for(let je=0;je<9;je++)n.probe[je].set(0,0,0);let j=0,ie=0,X=0,H=0,ge=0,pe=0,de=0,We=0,Pe=0,ke=0,ze=0;x.sort(D0);const Te=B===!0?Math.PI:1;for(let je=0,nt=x.length;je<nt;je++){const $e=x[je],rt=$e.color,mt=$e.intensity,Rt=$e.distance,ln=$e.shadow&&$e.shadow.map?$e.shadow.map.texture:null;if($e.isAmbientLight)P+=rt.r*mt*Te,U+=rt.g*mt*Te,V+=rt.b*mt*Te;else if($e.isLightProbe){for(let vt=0;vt<9;vt++)n.probe[vt].addScaledVector($e.sh.coefficients[vt],mt);ze++}else if($e.isDirectionalLight){const vt=e.get($e);if(vt.color.copy($e.color).multiplyScalar($e.intensity*Te),$e.castShadow){const en=$e.shadow,rn=t.get($e);rn.shadowBias=en.bias,rn.shadowNormalBias=en.normalBias,rn.shadowRadius=en.radius,rn.shadowMapSize=en.mapSize,n.directionalShadow[j]=rn,n.directionalShadowMap[j]=ln,n.directionalShadowMatrix[j]=$e.shadow.matrix,pe++}n.directional[j]=vt,j++}else if($e.isSpotLight){const vt=e.get($e);vt.position.setFromMatrixPosition($e.matrixWorld),vt.color.copy(rt).multiplyScalar(mt*Te),vt.distance=Rt,vt.coneCos=Math.cos($e.angle),vt.penumbraCos=Math.cos($e.angle*(1-$e.penumbra)),vt.decay=$e.decay,n.spot[X]=vt;const en=$e.shadow;if($e.map&&(n.spotLightMap[Pe]=$e.map,Pe++,en.updateMatrices($e),$e.castShadow&&ke++),n.spotLightMatrix[X]=en.matrix,$e.castShadow){const rn=t.get($e);rn.shadowBias=en.bias,rn.shadowNormalBias=en.normalBias,rn.shadowRadius=en.radius,rn.shadowMapSize=en.mapSize,n.spotShadow[X]=rn,n.spotShadowMap[X]=ln,We++}X++}else if($e.isRectAreaLight){const vt=e.get($e);vt.color.copy(rt).multiplyScalar(mt),vt.halfWidth.set($e.width*.5,0,0),vt.halfHeight.set(0,$e.height*.5,0),n.rectArea[H]=vt,H++}else if($e.isPointLight){const vt=e.get($e);if(vt.color.copy($e.color).multiplyScalar($e.intensity*Te),vt.distance=$e.distance,vt.decay=$e.decay,$e.castShadow){const en=$e.shadow,rn=t.get($e);rn.shadowBias=en.bias,rn.shadowNormalBias=en.normalBias,rn.shadowRadius=en.radius,rn.shadowMapSize=en.mapSize,rn.shadowCameraNear=en.camera.near,rn.shadowCameraFar=en.camera.far,n.pointShadow[ie]=rn,n.pointShadowMap[ie]=ln,n.pointShadowMatrix[ie]=$e.shadow.matrix,de++}n.point[ie]=vt,ie++}else if($e.isHemisphereLight){const vt=e.get($e);vt.skyColor.copy($e.color).multiplyScalar(mt*Te),vt.groundColor.copy($e.groundColor).multiplyScalar(mt*Te),n.hemi[ge]=vt,ge++}}H>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=An.LTC_FLOAT_1,n.rectAreaLTC2=An.LTC_FLOAT_2):(n.rectAreaLTC1=An.LTC_HALF_1,n.rectAreaLTC2=An.LTC_HALF_2)),n.ambient[0]=P,n.ambient[1]=U,n.ambient[2]=V;const be=n.hash;(be.directionalLength!==j||be.pointLength!==ie||be.spotLength!==X||be.rectAreaLength!==H||be.hemiLength!==ge||be.numDirectionalShadows!==pe||be.numPointShadows!==de||be.numSpotShadows!==We||be.numSpotMaps!==Pe||be.numLightProbes!==ze)&&(n.directional.length=j,n.spot.length=X,n.rectArea.length=H,n.point.length=ie,n.hemi.length=ge,n.directionalShadow.length=pe,n.directionalShadowMap.length=pe,n.pointShadow.length=de,n.pointShadowMap.length=de,n.spotShadow.length=We,n.spotShadowMap.length=We,n.directionalShadowMatrix.length=pe,n.pointShadowMatrix.length=de,n.spotLightMatrix.length=We+Pe-ke,n.spotLightMap.length=Pe,n.numSpotLightShadowsWithMaps=ke,n.numLightProbes=ze,be.directionalLength=j,be.pointLength=ie,be.spotLength=X,be.rectAreaLength=H,be.hemiLength=ge,be.numDirectionalShadows=pe,be.numPointShadows=de,be.numSpotShadows=We,be.numSpotMaps=Pe,be.numLightProbes=ze,n.version=L0++)}function E(x,B){let P=0,U=0,V=0,j=0,ie=0;const X=B.matrixWorldInverse;for(let H=0,ge=x.length;H<ge;H++){const pe=x[H];if(pe.isDirectionalLight){const de=n.directional[P];de.direction.setFromMatrixPosition(pe.matrixWorld),i.setFromMatrixPosition(pe.target.matrixWorld),de.direction.sub(i),de.direction.transformDirection(X),P++}else if(pe.isSpotLight){const de=n.spot[V];de.position.setFromMatrixPosition(pe.matrixWorld),de.position.applyMatrix4(X),de.direction.setFromMatrixPosition(pe.matrixWorld),i.setFromMatrixPosition(pe.target.matrixWorld),de.direction.sub(i),de.direction.transformDirection(X),V++}else if(pe.isRectAreaLight){const de=n.rectArea[j];de.position.setFromMatrixPosition(pe.matrixWorld),de.position.applyMatrix4(X),o.identity(),r.copy(pe.matrixWorld),r.premultiply(X),o.extractRotation(r),de.halfWidth.set(pe.width*.5,0,0),de.halfHeight.set(0,pe.height*.5,0),de.halfWidth.applyMatrix4(o),de.halfHeight.applyMatrix4(o),j++}else if(pe.isPointLight){const de=n.point[U];de.position.setFromMatrixPosition(pe.matrixWorld),de.position.applyMatrix4(X),U++}else if(pe.isHemisphereLight){const de=n.hemi[ie];de.direction.setFromMatrixPosition(pe.matrixWorld),de.direction.transformDirection(X),ie++}}}return{setup:c,setupView:E,state:n}}function Sd(s){const e=new P0(s),t=[],n=[];function i(B){x.camera=B,t.length=0,n.length=0}function r(B){t.push(B)}function o(B){n.push(B)}function c(B){e.setup(t,B)}function E(B){e.setupView(t,B)}const x={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:x,setupLights:c,setupLightsView:E,pushLight:r,pushShadow:o}}function O0(s){let e=new WeakMap;function t(i,r=0){const o=e.get(i);let c;return o===void 0?(c=new Sd(s),e.set(i,[c])):r>=o.length?(c=new Sd(s),o.push(c)):c=o[r],c}function n(){e=new WeakMap}return{get:t,dispose:n}}class Hh extends is{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=dn,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class zh extends is{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const F0=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,U0=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function N0(s,e,t){let n=new Ka;const i=new Lt,r=new Lt,o=new zi,c=new Hh({depthPacking:un}),E=new zh,x={},B=t.maxTextureSize,P={[p]:C,[C]:p,[S]:S},U=new Os({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Lt},radius:{value:4}},vertexShader:F0,fragmentShader:U0}),V=U.clone();V.defines.HORIZONTAL_PASS=1;const j=new wi;j.setAttribute("position",new lr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ie=new Dr(j,U),X=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=y;let H=this.type;this.render=function(Pe,ke,ze){if(X.enabled===!1||X.autoUpdate===!1&&X.needsUpdate===!1||Pe.length===0)return;const Te=s.getRenderTarget(),be=s.getActiveCubeFace(),je=s.getActiveMipmapLevel(),nt=s.state;nt.setBlending(_),nt.buffers.color.setClear(1,1,1,1),nt.buffers.depth.setTest(!0),nt.setScissorTest(!1);const $e=H!==d&&this.type===d,rt=H===d&&this.type!==d;for(let mt=0,Rt=Pe.length;mt<Rt;mt++){const ln=Pe[mt],vt=ln.shadow;if(vt===void 0){console.warn("THREE.WebGLShadowMap:",ln,"has no shadow.");continue}if(vt.autoUpdate===!1&&vt.needsUpdate===!1)continue;i.copy(vt.mapSize);const en=vt.getFrameExtents();if(i.multiply(en),r.copy(vt.mapSize),(i.x>B||i.y>B)&&(i.x>B&&(r.x=Math.floor(B/en.x),i.x=r.x*en.x,vt.mapSize.x=r.x),i.y>B&&(r.y=Math.floor(B/en.y),i.y=r.y*en.y,vt.mapSize.y=r.y)),vt.map===null||$e===!0||rt===!0){const Dn=this.type!==d?{minFilter:Yt,magFilter:Yt}:{};vt.map!==null&&vt.map.dispose(),vt.map=new As(i.x,i.y,Dn),vt.map.texture.name=ln.name+".shadowMap",vt.camera.updateProjectionMatrix()}s.setRenderTarget(vt.map),s.clear();const rn=vt.getViewportCount();for(let Dn=0;Dn<rn;Dn++){const _i=vt.getViewport(Dn);o.set(r.x*_i.x,r.y*_i.y,r.x*_i.z,r.y*_i.w),nt.viewport(o),vt.updateMatrices(ln,Dn),n=vt.getFrustum(),de(ke,ze,vt.camera,ln,this.type)}vt.isPointLightShadow!==!0&&this.type===d&&ge(vt,ze),vt.needsUpdate=!1}H=this.type,X.needsUpdate=!1,s.setRenderTarget(Te,be,je)};function ge(Pe,ke){const ze=e.update(ie);U.defines.VSM_SAMPLES!==Pe.blurSamples&&(U.defines.VSM_SAMPLES=Pe.blurSamples,V.defines.VSM_SAMPLES=Pe.blurSamples,U.needsUpdate=!0,V.needsUpdate=!0),Pe.mapPass===null&&(Pe.mapPass=new As(i.x,i.y)),U.uniforms.shadow_pass.value=Pe.map.texture,U.uniforms.resolution.value=Pe.mapSize,U.uniforms.radius.value=Pe.radius,s.setRenderTarget(Pe.mapPass),s.clear(),s.renderBufferDirect(ke,null,ze,U,ie,null),V.uniforms.shadow_pass.value=Pe.mapPass.texture,V.uniforms.resolution.value=Pe.mapSize,V.uniforms.radius.value=Pe.radius,s.setRenderTarget(Pe.map),s.clear(),s.renderBufferDirect(ke,null,ze,V,ie,null)}function pe(Pe,ke,ze,Te){let be=null;const je=ze.isPointLight===!0?Pe.customDistanceMaterial:Pe.customDepthMaterial;if(je!==void 0)be=je;else if(be=ze.isPointLight===!0?E:c,s.localClippingEnabled&&ke.clipShadows===!0&&Array.isArray(ke.clippingPlanes)&&ke.clippingPlanes.length!==0||ke.displacementMap&&ke.displacementScale!==0||ke.alphaMap&&ke.alphaTest>0||ke.map&&ke.alphaTest>0){const nt=be.uuid,$e=ke.uuid;let rt=x[nt];rt===void 0&&(rt={},x[nt]=rt);let mt=rt[$e];mt===void 0&&(mt=be.clone(),rt[$e]=mt,ke.addEventListener("dispose",We)),be=mt}if(be.visible=ke.visible,be.wireframe=ke.wireframe,Te===d?be.side=ke.shadowSide!==null?ke.shadowSide:ke.side:be.side=ke.shadowSide!==null?ke.shadowSide:P[ke.side],be.alphaMap=ke.alphaMap,be.alphaTest=ke.alphaTest,be.map=ke.map,be.clipShadows=ke.clipShadows,be.clippingPlanes=ke.clippingPlanes,be.clipIntersection=ke.clipIntersection,be.displacementMap=ke.displacementMap,be.displacementScale=ke.displacementScale,be.displacementBias=ke.displacementBias,be.wireframeLinewidth=ke.wireframeLinewidth,be.linewidth=ke.linewidth,ze.isPointLight===!0&&be.isMeshDistanceMaterial===!0){const nt=s.properties.get(be);nt.light=ze}return be}function de(Pe,ke,ze,Te,be){if(Pe.visible===!1)return;if(Pe.layers.test(ke.layers)&&(Pe.isMesh||Pe.isLine||Pe.isPoints)&&(Pe.castShadow||Pe.receiveShadow&&be===d)&&(!Pe.frustumCulled||n.intersectsObject(Pe))){Pe.modelViewMatrix.multiplyMatrices(ze.matrixWorldInverse,Pe.matrixWorld);const $e=e.update(Pe),rt=Pe.material;if(Array.isArray(rt)){const mt=$e.groups;for(let Rt=0,ln=mt.length;Rt<ln;Rt++){const vt=mt[Rt],en=rt[vt.materialIndex];if(en&&en.visible){const rn=pe(Pe,en,Te,be);Pe.onBeforeShadow(s,Pe,ke,ze,$e,rn,vt),s.renderBufferDirect(ze,null,$e,rn,Pe,vt),Pe.onAfterShadow(s,Pe,ke,ze,$e,rn,vt)}}}else if(rt.visible){const mt=pe(Pe,rt,Te,be);Pe.onBeforeShadow(s,Pe,ke,ze,$e,mt,null),s.renderBufferDirect(ze,null,$e,mt,Pe,null),Pe.onAfterShadow(s,Pe,ke,ze,$e,mt,null)}}const nt=Pe.children;for(let $e=0,rt=nt.length;$e<rt;$e++)de(nt[$e],ke,ze,Te,be)}function We(Pe){Pe.target.removeEventListener("dispose",We);for(const ze in x){const Te=x[ze],be=Pe.target.uuid;be in Te&&(Te[be].dispose(),delete Te[be])}}}function k0(s){function e(){let Ye=!1;const Kt=new zi;let sn=null;const Hn=new zi(0,0,0,0);return{setMask:function(bn){sn!==bn&&!Ye&&(s.colorMask(bn,bn,bn,bn),sn=bn)},setLocked:function(bn){Ye=bn},setClear:function(bn,xi,wn,vn,Ii){Ii===!0&&(bn*=vn,xi*=vn,wn*=vn),Kt.set(bn,xi,wn,vn),Hn.equals(Kt)===!1&&(s.clearColor(bn,xi,wn,vn),Hn.copy(Kt))},reset:function(){Ye=!1,sn=null,Hn.set(-1,0,0,0)}}}function t(){let Ye=!1,Kt=null,sn=null,Hn=null;return{setTest:function(bn){bn?ur(s.DEPTH_TEST):Nn(s.DEPTH_TEST)},setMask:function(bn){Kt!==bn&&!Ye&&(s.depthMask(bn),Kt=bn)},setFunc:function(bn){if(sn!==bn){switch(bn){case Et:s.depthFunc(s.NEVER);break;case Bt:s.depthFunc(s.ALWAYS);break;case kt:s.depthFunc(s.LESS);break;case jt:s.depthFunc(s.LEQUAL);break;case nn:s.depthFunc(s.EQUAL);break;case Jn:s.depthFunc(s.GEQUAL);break;case kn:s.depthFunc(s.GREATER);break;case xn:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}sn=bn}},setLocked:function(bn){Ye=bn},setClear:function(bn){Hn!==bn&&(s.clearDepth(bn),Hn=bn)},reset:function(){Ye=!1,Kt=null,sn=null,Hn=null}}}function n(){let Ye=!1,Kt=null,sn=null,Hn=null,bn=null,xi=null,wn=null,vn=null,Ii=null;return{setTest:function(ii){Ye||(ii?ur(s.STENCIL_TEST):Nn(s.STENCIL_TEST))},setMask:function(ii){Kt!==ii&&!Ye&&(s.stencilMask(ii),Kt=ii)},setFunc:function(ii,Hr,Xs){(sn!==ii||Hn!==Hr||bn!==Xs)&&(s.stencilFunc(ii,Hr,Xs),sn=ii,Hn=Hr,bn=Xs)},setOp:function(ii,Hr,Xs){(xi!==ii||wn!==Hr||vn!==Xs)&&(s.stencilOp(ii,Hr,Xs),xi=ii,wn=Hr,vn=Xs)},setLocked:function(ii){Ye=ii},setClear:function(ii){Ii!==ii&&(s.clearStencil(ii),Ii=ii)},reset:function(){Ye=!1,Kt=null,sn=null,Hn=null,bn=null,xi=null,wn=null,vn=null,Ii=null}}}const i=new e,r=new t,o=new n,c=new WeakMap,E=new WeakMap;let x={},B={},P=new WeakMap,U=[],V=null,j=!1,ie=null,X=null,H=null,ge=null,pe=null,de=null,We=null,Pe=new Sn(0,0,0),ke=0,ze=!1,Te=null,be=null,je=null,nt=null,$e=null;const rt=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let mt=!1,Rt=0;const ln=s.getParameter(s.VERSION);ln.indexOf("WebGL")!==-1?(Rt=parseFloat(/^WebGL (\d)/.exec(ln)[1]),mt=Rt>=1):ln.indexOf("OpenGL ES")!==-1&&(Rt=parseFloat(/^OpenGL ES (\d)/.exec(ln)[1]),mt=Rt>=2);let vt=null,en={};const rn=s.getParameter(s.SCISSOR_BOX),Dn=s.getParameter(s.VIEWPORT),_i=new zi().fromArray(rn),er=new zi().fromArray(Dn);function Ar(Ye,Kt,sn,Hn){const bn=new Uint8Array(4),xi=s.createTexture();s.bindTexture(Ye,xi),s.texParameteri(Ye,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(Ye,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let wn=0;wn<sn;wn++)Ye===s.TEXTURE_3D||Ye===s.TEXTURE_2D_ARRAY?s.texImage3D(Kt,0,s.RGBA,1,1,Hn,0,s.RGBA,s.UNSIGNED_BYTE,bn):s.texImage2D(Kt+wn,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,bn);return xi}const qi={};qi[s.TEXTURE_2D]=Ar(s.TEXTURE_2D,s.TEXTURE_2D,1),qi[s.TEXTURE_CUBE_MAP]=Ar(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),qi[s.TEXTURE_2D_ARRAY]=Ar(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),qi[s.TEXTURE_3D]=Ar(s.TEXTURE_3D,s.TEXTURE_3D,1,1),i.setClear(0,0,0,1),r.setClear(1),o.setClear(0),ur(s.DEPTH_TEST),r.setFunc(jt),Xt(!1),Wt(a),ur(s.CULL_FACE),Tt(_);function ur(Ye){x[Ye]!==!0&&(s.enable(Ye),x[Ye]=!0)}function Nn(Ye){x[Ye]!==!1&&(s.disable(Ye),x[Ye]=!1)}function Pt(Ye,Kt){return B[Ye]!==Kt?(s.bindFramebuffer(Ye,Kt),B[Ye]=Kt,Ye===s.DRAW_FRAMEBUFFER&&(B[s.FRAMEBUFFER]=Kt),Ye===s.FRAMEBUFFER&&(B[s.DRAW_FRAMEBUFFER]=Kt),!0):!1}function hn(Ye,Kt){let sn=U,Hn=!1;if(Ye){sn=P.get(Kt),sn===void 0&&(sn=[],P.set(Kt,sn));const bn=Ye.textures;if(sn.length!==bn.length||sn[0]!==s.COLOR_ATTACHMENT0){for(let xi=0,wn=bn.length;xi<wn;xi++)sn[xi]=s.COLOR_ATTACHMENT0+xi;sn.length=bn.length,Hn=!0}}else sn[0]!==s.BACK&&(sn[0]=s.BACK,Hn=!0);Hn&&s.drawBuffers(sn)}function mn(Ye){return V!==Ye?(s.useProgram(Ye),V=Ye,!0):!1}const st={[K]:s.FUNC_ADD,[se]:s.FUNC_SUBTRACT,[ne]:s.FUNC_REVERSE_SUBTRACT};st[re]=s.MIN,st[Y]=s.MAX;const Ot={[k]:s.ZERO,[oe]:s.ONE,[ae]:s.SRC_COLOR,[b]:s.SRC_ALPHA,[Le]:s.SRC_ALPHA_SATURATE,[J]:s.DST_COLOR,[O]:s.DST_ALPHA,[Ae]:s.ONE_MINUS_SRC_COLOR,[I]:s.ONE_MINUS_SRC_ALPHA,[ve]:s.ONE_MINUS_DST_COLOR,[Q]:s.ONE_MINUS_DST_ALPHA,[_e]:s.CONSTANT_COLOR,[Ze]:s.ONE_MINUS_CONSTANT_COLOR,[qe]:s.CONSTANT_ALPHA,[ft]:s.ONE_MINUS_CONSTANT_ALPHA};function Tt(Ye,Kt,sn,Hn,bn,xi,wn,vn,Ii,ii){if(Ye===_){j===!0&&(Nn(s.BLEND),j=!1);return}if(j===!1&&(ur(s.BLEND),j=!0),Ye!==te){if(Ye!==ie||ii!==ze){if((X!==K||pe!==K)&&(s.blendEquation(s.FUNC_ADD),X=K,pe=K),ii)switch(Ye){case L:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case T:s.blendFunc(s.ONE,s.ONE);break;case N:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case F:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ye);break}else switch(Ye){case L:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case T:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case N:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case F:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ye);break}H=null,ge=null,de=null,We=null,Pe.set(0,0,0),ke=0,ie=Ye,ze=ii}return}bn=bn||Kt,xi=xi||sn,wn=wn||Hn,(Kt!==X||bn!==pe)&&(s.blendEquationSeparate(st[Kt],st[bn]),X=Kt,pe=bn),(sn!==H||Hn!==ge||xi!==de||wn!==We)&&(s.blendFuncSeparate(Ot[sn],Ot[Hn],Ot[xi],Ot[wn]),H=sn,ge=Hn,de=xi,We=wn),(vn.equals(Pe)===!1||Ii!==ke)&&(s.blendColor(vn.r,vn.g,vn.b,Ii),Pe.copy(vn),ke=Ii),ie=Ye,ze=!1}function $t(Ye,Kt){Ye.side===S?Nn(s.CULL_FACE):ur(s.CULL_FACE);let sn=Ye.side===C;Kt&&(sn=!sn),Xt(sn),Ye.blending===L&&Ye.transparent===!1?Tt(_):Tt(Ye.blending,Ye.blendEquation,Ye.blendSrc,Ye.blendDst,Ye.blendEquationAlpha,Ye.blendSrcAlpha,Ye.blendDstAlpha,Ye.blendColor,Ye.blendAlpha,Ye.premultipliedAlpha),r.setFunc(Ye.depthFunc),r.setTest(Ye.depthTest),r.setMask(Ye.depthWrite),i.setMask(Ye.colorWrite);const Hn=Ye.stencilWrite;o.setTest(Hn),Hn&&(o.setMask(Ye.stencilWriteMask),o.setFunc(Ye.stencilFunc,Ye.stencilRef,Ye.stencilFuncMask),o.setOp(Ye.stencilFail,Ye.stencilZFail,Ye.stencilZPass)),_n(Ye.polygonOffset,Ye.polygonOffsetFactor,Ye.polygonOffsetUnits),Ye.alphaToCoverage===!0?ur(s.SAMPLE_ALPHA_TO_COVERAGE):Nn(s.SAMPLE_ALPHA_TO_COVERAGE)}function Xt(Ye){Te!==Ye&&(Ye?s.frontFace(s.CW):s.frontFace(s.CCW),Te=Ye)}function Wt(Ye){Ye!==v?(ur(s.CULL_FACE),Ye!==be&&(Ye===a?s.cullFace(s.BACK):Ye===f?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):Nn(s.CULL_FACE),be=Ye}function gn(Ye){Ye!==je&&(mt&&s.lineWidth(Ye),je=Ye)}function _n(Ye,Kt,sn){Ye?(ur(s.POLYGON_OFFSET_FILL),(nt!==Kt||$e!==sn)&&(s.polygonOffset(Kt,sn),nt=Kt,$e=sn)):Nn(s.POLYGON_OFFSET_FILL)}function li(Ye){Ye?ur(s.SCISSOR_TEST):Nn(s.SCISSOR_TEST)}function di(Ye){Ye===void 0&&(Ye=s.TEXTURE0+rt-1),vt!==Ye&&(s.activeTexture(Ye),vt=Ye)}function Ji(Ye,Kt,sn){sn===void 0&&(vt===null?sn=s.TEXTURE0+rt-1:sn=vt);let Hn=en[sn];Hn===void 0&&(Hn={type:void 0,texture:void 0},en[sn]=Hn),(Hn.type!==Ye||Hn.texture!==Kt)&&(vt!==sn&&(s.activeTexture(sn),vt=sn),s.bindTexture(Ye,Kt||qi[Ye]),Hn.type=Ye,Hn.texture=Kt)}function _r(){const Ye=en[vt];Ye!==void 0&&Ye.type!==void 0&&(s.bindTexture(Ye.type,null),Ye.type=void 0,Ye.texture=void 0)}function mr(){try{s.compressedTexImage2D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function Ve(){try{s.compressedTexImage3D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function we(){try{s.texSubImage2D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function xt(){try{s.texSubImage3D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function Dt(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function Qt(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function Ut(){try{s.texStorage2D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function Vn(){try{s.texStorage3D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function cn(){try{s.texImage2D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function Tn(){try{s.texImage3D.apply(s,arguments)}catch(Ye){console.error("THREE.WebGLState:",Ye)}}function rr(Ye){_i.equals(Ye)===!1&&(s.scissor(Ye.x,Ye.y,Ye.z,Ye.w),_i.copy(Ye))}function In(Ye){er.equals(Ye)===!1&&(s.viewport(Ye.x,Ye.y,Ye.z,Ye.w),er.copy(Ye))}function zn(Ye,Kt){let sn=E.get(Kt);sn===void 0&&(sn=new WeakMap,E.set(Kt,sn));let Hn=sn.get(Ye);Hn===void 0&&(Hn=s.getUniformBlockIndex(Kt,Ye.name),sn.set(Ye,Hn))}function Ci(Ye,Kt){const Hn=E.get(Kt).get(Ye);c.get(Kt)!==Hn&&(s.uniformBlockBinding(Kt,Hn,Ye.__bindingPointIndex),c.set(Kt,Hn))}function ni(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),x={},vt=null,en={},B={},P=new WeakMap,U=[],V=null,j=!1,ie=null,X=null,H=null,ge=null,pe=null,de=null,We=null,Pe=new Sn(0,0,0),ke=0,ze=!1,Te=null,be=null,je=null,nt=null,$e=null,_i.set(0,0,s.canvas.width,s.canvas.height),er.set(0,0,s.canvas.width,s.canvas.height),i.reset(),r.reset(),o.reset()}return{buffers:{color:i,depth:r,stencil:o},enable:ur,disable:Nn,bindFramebuffer:Pt,drawBuffers:hn,useProgram:mn,setBlending:Tt,setMaterial:$t,setFlipSided:Xt,setCullFace:Wt,setLineWidth:gn,setPolygonOffset:_n,setScissorTest:li,activeTexture:di,bindTexture:Ji,unbindTexture:_r,compressedTexImage2D:mr,compressedTexImage3D:Ve,texImage2D:cn,texImage3D:Tn,updateUBOMapping:zn,uniformBlockBinding:Ci,texStorage2D:Ut,texStorage3D:Vn,texSubImage2D:we,texSubImage3D:xt,compressedTexSubImage2D:Dt,compressedTexSubImage3D:Qt,scissor:rr,viewport:In,reset:ni}}function G0(s,e,t,n,i,r,o){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,E=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),x=e.has("OCULUS_multiview")?e.get("OCULUS_multiview"):null,B=new Lt,P=new WeakMap;let U;const V=new WeakMap;let j=[],ie=!1,X=!1;try{X=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function H(Ve,we){return X?new OffscreenCanvas(Ve,we):Po("canvas")}function ge(Ve,we,xt){let Dt=1;const Qt=mr(Ve);if((Qt.width>xt||Qt.height>xt)&&(Dt=xt/Math.max(Qt.width,Qt.height)),Dt<1)if(typeof HTMLImageElement<"u"&&Ve instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ve instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ve instanceof ImageBitmap||typeof VideoFrame<"u"&&Ve instanceof VideoFrame){const Ut=Math.floor(Dt*Qt.width),Vn=Math.floor(Dt*Qt.height);U===void 0&&(U=H(Ut,Vn));const cn=we?H(Ut,Vn):U;return cn.width=Ut,cn.height=Vn,cn.getContext("2d").drawImage(Ve,0,0,Ut,Vn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Qt.width+"x"+Qt.height+") to ("+Ut+"x"+Vn+")."),cn}else return"data"in Ve&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Qt.width+"x"+Qt.height+")."),Ve;return Ve}function pe(Ve){return Ve.generateMipmaps&&Ve.minFilter!==Yt&&Ve.minFilter!==Bn}function de(Ve){s.generateMipmap(Ve)}function We(Ve,we,xt,Dt,Qt=!1){if(Ve!==null){if(s[Ve]!==void 0)return s[Ve];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ve+"'")}let Ut=we;if(we===s.RED&&(xt===s.FLOAT&&(Ut=s.R32F),xt===s.HALF_FLOAT&&(Ut=s.R16F),xt===s.UNSIGNED_BYTE&&(Ut=s.R8)),we===s.RED_INTEGER&&(xt===s.UNSIGNED_BYTE&&(Ut=s.R8UI),xt===s.UNSIGNED_SHORT&&(Ut=s.R16UI),xt===s.UNSIGNED_INT&&(Ut=s.R32UI),xt===s.BYTE&&(Ut=s.R8I),xt===s.SHORT&&(Ut=s.R16I),xt===s.INT&&(Ut=s.R32I)),we===s.RG&&(xt===s.FLOAT&&(Ut=s.RG32F),xt===s.HALF_FLOAT&&(Ut=s.RG16F),xt===s.UNSIGNED_BYTE&&(Ut=s.RG8)),we===s.RG_INTEGER&&(xt===s.UNSIGNED_BYTE&&(Ut=s.RG8UI),xt===s.UNSIGNED_SHORT&&(Ut=s.RG16UI),xt===s.UNSIGNED_INT&&(Ut=s.RG32UI),xt===s.BYTE&&(Ut=s.RG8I),xt===s.SHORT&&(Ut=s.RG16I),xt===s.INT&&(Ut=s.RG32I)),we===s.RGB&&xt===s.UNSIGNED_INT_5_9_9_9_REV&&(Ut=s.RGB9_E5),we===s.RGBA){const Vn=Qt?fi:$i.getTransfer(Dt);xt===s.FLOAT&&(Ut=s.RGBA32F),xt===s.HALF_FLOAT&&(Ut=s.RGBA16F),xt===s.UNSIGNED_BYTE&&(Ut=Vn===Qn?s.SRGB8_ALPHA8:s.RGBA8),xt===s.UNSIGNED_SHORT_4_4_4_4&&(Ut=s.RGBA4),xt===s.UNSIGNED_SHORT_5_5_5_1&&(Ut=s.RGB5_A1)}return(Ut===s.R16F||Ut===s.R32F||Ut===s.RG16F||Ut===s.RG32F||Ut===s.RGBA16F||Ut===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Ut}function Pe(Ve,we){return pe(Ve)===!0||Ve.isFramebufferTexture&&Ve.minFilter!==Yt&&Ve.minFilter!==Bn?Math.log2(Math.max(we.width,we.height))+1:Ve.mipmaps!==void 0&&Ve.mipmaps.length>0?Ve.mipmaps.length:Ve.isCompressedTexture&&Array.isArray(Ve.image)?we.mipmaps.length:1}function ke(Ve){const we=Ve.target;we.removeEventListener("dispose",ke),Te(we),we.isVideoTexture&&P.delete(we)}function ze(Ve){const we=Ve.target;we.removeEventListener("dispose",ze),je(we)}function Te(Ve){const we=n.get(Ve);if(we.__webglInit===void 0)return;const xt=Ve.source,Dt=V.get(xt);if(Dt){const Qt=Dt[we.__cacheKey];Qt.usedTimes--,Qt.usedTimes===0&&be(Ve),Object.keys(Dt).length===0&&V.delete(xt)}n.remove(Ve)}function be(Ve){const we=n.get(Ve);s.deleteTexture(we.__webglTexture);const xt=Ve.source,Dt=V.get(xt);delete Dt[we.__cacheKey],o.memory.textures--}function je(Ve){const we=n.get(Ve);if(Ve.depthTexture&&Ve.depthTexture.dispose(),Ve.isWebGLCubeRenderTarget)for(let Dt=0;Dt<6;Dt++){if(Array.isArray(we.__webglFramebuffer[Dt]))for(let Qt=0;Qt<we.__webglFramebuffer[Dt].length;Qt++)s.deleteFramebuffer(we.__webglFramebuffer[Dt][Qt]);else s.deleteFramebuffer(we.__webglFramebuffer[Dt]);we.__webglDepthbuffer&&s.deleteRenderbuffer(we.__webglDepthbuffer[Dt])}else{if(Array.isArray(we.__webglFramebuffer))for(let Dt=0;Dt<we.__webglFramebuffer.length;Dt++)s.deleteFramebuffer(we.__webglFramebuffer[Dt]);else s.deleteFramebuffer(we.__webglFramebuffer);if(we.__webglDepthbuffer&&s.deleteRenderbuffer(we.__webglDepthbuffer),we.__webglMultisampledFramebuffer&&s.deleteFramebuffer(we.__webglMultisampledFramebuffer),we.__webglColorRenderbuffer)for(let Dt=0;Dt<we.__webglColorRenderbuffer.length;Dt++)we.__webglColorRenderbuffer[Dt]&&s.deleteRenderbuffer(we.__webglColorRenderbuffer[Dt]);we.__webglDepthRenderbuffer&&s.deleteRenderbuffer(we.__webglDepthRenderbuffer)}const xt=Ve.textures;for(let Dt=0,Qt=xt.length;Dt<Qt;Dt++){const Ut=n.get(xt[Dt]);Ut.__webglTexture&&(s.deleteTexture(Ut.__webglTexture),o.memory.textures--),n.remove(xt[Dt])}n.remove(Ve)}let nt=0;function $e(){nt=0}function rt(){const Ve=nt;return Ve>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ve+" texture units while this GPU supports only "+i.maxTextures),nt+=1,Ve}function mt(Ve){const we=[];return we.push(Ve.wrapS),we.push(Ve.wrapT),we.push(Ve.wrapR||0),we.push(Ve.magFilter),we.push(Ve.minFilter),we.push(Ve.anisotropy),we.push(Ve.internalFormat),we.push(Ve.format),we.push(Ve.type),we.push(Ve.generateMipmaps),we.push(Ve.premultiplyAlpha),we.push(Ve.flipY),we.push(Ve.unpackAlignment),we.push(Ve.colorSpace),we.join()}function Rt(Ve,we){const xt=n.get(Ve);if(Ve.isVideoTexture&&Ji(Ve),Ve.isRenderTargetTexture===!1&&Ve.version>0&&xt.__version!==Ve.version){const Dt=Ve.image;if(Dt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Dt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(Nn(xt,Ve,we))return}t.bindTexture(s.TEXTURE_2D,xt.__webglTexture,s.TEXTURE0+we)}function ln(Ve,we){const xt=n.get(Ve);if(Ve.version>0&&xt.__version!==Ve.version){Nn(xt,Ve,we);return}t.bindTexture(s.TEXTURE_2D_ARRAY,xt.__webglTexture,s.TEXTURE0+we)}function vt(Ve,we){const xt=n.get(Ve);if(Ve.version>0&&xt.__version!==Ve.version){Nn(xt,Ve,we);return}t.bindTexture(s.TEXTURE_3D,xt.__webglTexture,s.TEXTURE0+we)}function en(Ve,we){const xt=n.get(Ve);if(Ve.version>0&&xt.__version!==Ve.version){Pt(xt,Ve,we);return}t.bindTexture(s.TEXTURE_CUBE_MAP,xt.__webglTexture,s.TEXTURE0+we)}const rn={[Ne]:s.REPEAT,[He]:s.CLAMP_TO_EDGE,[Gt]:s.MIRRORED_REPEAT},Dn={[Yt]:s.NEAREST,[Ht]:s.NEAREST_MIPMAP_NEAREST,[fn]:s.NEAREST_MIPMAP_LINEAR,[Bn]:s.LINEAR,[bi]:s.LINEAR_MIPMAP_NEAREST,[Oi]:s.LINEAR_MIPMAP_LINEAR},_i={[qs]:s.NEVER,[Cl]:s.ALWAYS,[Vs]:s.LESS,[Ts]:s.LEQUAL,[Hs]:s.EQUAL,[El]:s.GEQUAL,[ho]:s.GREATER,[yl]:s.NOTEQUAL};function er(Ve,we){if(we.type===ir&&e.has("OES_texture_float_linear")===!1&&(we.magFilter===Bn||we.magFilter===bi||we.magFilter===fn||we.magFilter===Oi||we.minFilter===Bn||we.minFilter===bi||we.minFilter===fn||we.minFilter===Oi)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(Ve,s.TEXTURE_WRAP_S,rn[we.wrapS]),s.texParameteri(Ve,s.TEXTURE_WRAP_T,rn[we.wrapT]),(Ve===s.TEXTURE_3D||Ve===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Ve,s.TEXTURE_WRAP_R,rn[we.wrapR]),s.texParameteri(Ve,s.TEXTURE_MAG_FILTER,Dn[we.magFilter]),s.texParameteri(Ve,s.TEXTURE_MIN_FILTER,Dn[we.minFilter]),we.compareFunction&&(s.texParameteri(Ve,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(Ve,s.TEXTURE_COMPARE_FUNC,_i[we.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(we.magFilter===Yt||we.minFilter!==fn&&we.minFilter!==Oi||we.type===ir&&e.has("OES_texture_float_linear")===!1)return;if(we.anisotropy>1||n.get(we).__currentAnisotropy){const xt=e.get("EXT_texture_filter_anisotropic");s.texParameterf(Ve,xt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(we.anisotropy,i.getMaxAnisotropy())),n.get(we).__currentAnisotropy=we.anisotropy}}}function Ar(Ve,we){let xt=!1;Ve.__webglInit===void 0&&(Ve.__webglInit=!0,we.addEventListener("dispose",ke));const Dt=we.source;let Qt=V.get(Dt);Qt===void 0&&(Qt={},V.set(Dt,Qt));const Ut=mt(we);if(Ut!==Ve.__cacheKey){Qt[Ut]===void 0&&(Qt[Ut]={texture:s.createTexture(),usedTimes:0},o.memory.textures++,xt=!0),Qt[Ut].usedTimes++;const Vn=Qt[Ve.__cacheKey];Vn!==void 0&&(Qt[Ve.__cacheKey].usedTimes--,Vn.usedTimes===0&&be(we)),Ve.__cacheKey=Ut,Ve.__webglTexture=Qt[Ut].texture}return xt}function qi(Ve){ie=Ve}function ur(){const Ve=ie;ie=!1;for(const we of j)Nn(we.textureProperties,we.texture,we.slot),we.texture.isPendingDeferredUpload=!1;j=[],ie=Ve}function Nn(Ve,we,xt){if(ie)return we.isPendingDeferredUpload||(we.isPendingDeferredUpload=!0,j.push({textureProperties:Ve,texture:we,slot:xt})),!1;let Dt=s.TEXTURE_2D;(we.isDataArrayTexture||we.isCompressedArrayTexture)&&(Dt=s.TEXTURE_2D_ARRAY),we.isData3DTexture&&(Dt=s.TEXTURE_3D);const Qt=Ar(Ve,we),Ut=we.source;t.bindTexture(Dt,Ve.__webglTexture,s.TEXTURE0+xt);const Vn=n.get(Ut);if(Ut.version!==Vn.__version||Qt===!0){t.activeTexture(s.TEXTURE0+xt);const cn=$i.getPrimaries($i.workingColorSpace),Tn=we.colorSpace===ei?null:$i.getPrimaries(we.colorSpace),rr=we.colorSpace===ei||cn===Tn?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,we.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,we.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,rr);let In=ge(we.image,!1,i.maxTextureSize);In=_r(we,In);const zn=r.convert(we.format,we.colorSpace),Ci=r.convert(we.type);let ni=We(we.internalFormat,zn,Ci,we.colorSpace,we.isVideoTexture);er(Dt,we);let Ye;const Kt=we.mipmaps,sn=we.isVideoTexture!==!0,Hn=Vn.__version===void 0||Qt===!0,bn=Ut.dataReady,xi=Pe(we,In);if(we.isDepthTexture)ni=s.DEPTH_COMPONENT16,we.type===ir?ni=s.DEPTH_COMPONENT32F:we.type===Sr?ni=s.DEPTH_COMPONENT24:we.type===Ur&&(ni=s.DEPTH24_STENCIL8),Hn&&(sn?t.texStorage2D(s.TEXTURE_2D,1,ni,In.width,In.height):t.texImage2D(s.TEXTURE_2D,0,ni,In.width,In.height,0,zn,Ci,null));else if(we.isDataTexture)if(Kt.length>0){sn&&Hn&&t.texStorage2D(s.TEXTURE_2D,xi,ni,Kt[0].width,Kt[0].height);for(let wn=0,vn=Kt.length;wn<vn;wn++)Ye=Kt[wn],sn?bn&&t.texSubImage2D(s.TEXTURE_2D,wn,0,0,Ye.width,Ye.height,zn,Ci,Ye.data):t.texImage2D(s.TEXTURE_2D,wn,ni,Ye.width,Ye.height,0,zn,Ci,Ye.data);we.generateMipmaps=!1}else sn?(Hn&&t.texStorage2D(s.TEXTURE_2D,xi,ni,In.width,In.height),bn&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,In.width,In.height,zn,Ci,In.data)):t.texImage2D(s.TEXTURE_2D,0,ni,In.width,In.height,0,zn,Ci,In.data);else if(we.isCompressedTexture)if(we.isCompressedArrayTexture){sn&&Hn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,xi,ni,Kt[0].width,Kt[0].height,In.depth);for(let wn=0,vn=Kt.length;wn<vn;wn++)Ye=Kt[wn],we.format!==Ge?zn!==null?sn?bn&&t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,wn,0,0,0,Ye.width,Ye.height,In.depth,zn,Ye.data,0,0):t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,wn,ni,Ye.width,Ye.height,In.depth,0,Ye.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):sn?bn&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,wn,0,0,0,Ye.width,Ye.height,In.depth,zn,Ci,Ye.data):t.texImage3D(s.TEXTURE_2D_ARRAY,wn,ni,Ye.width,Ye.height,In.depth,0,zn,Ci,Ye.data)}else{sn&&Hn&&t.texStorage2D(s.TEXTURE_2D,xi,ni,Kt[0].width,Kt[0].height);for(let wn=0,vn=Kt.length;wn<vn;wn++)Ye=Kt[wn],we.format!==Ge?zn!==null?sn?bn&&t.compressedTexSubImage2D(s.TEXTURE_2D,wn,0,0,Ye.width,Ye.height,zn,Ye.data):t.compressedTexImage2D(s.TEXTURE_2D,wn,ni,Ye.width,Ye.height,0,Ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):sn?bn&&t.texSubImage2D(s.TEXTURE_2D,wn,0,0,Ye.width,Ye.height,zn,Ci,Ye.data):t.texImage2D(s.TEXTURE_2D,wn,ni,Ye.width,Ye.height,0,zn,Ci,Ye.data)}else if(we.isDataArrayTexture)sn?(Hn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,xi,ni,In.width,In.height,In.depth),bn&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,In.width,In.height,In.depth,zn,Ci,In.data)):t.texImage3D(s.TEXTURE_2D_ARRAY,0,ni,In.width,In.height,In.depth,0,zn,Ci,In.data);else if(we.isData3DTexture)sn?(Hn&&t.texStorage3D(s.TEXTURE_3D,xi,ni,In.width,In.height,In.depth),bn&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,In.width,In.height,In.depth,zn,Ci,In.data)):t.texImage3D(s.TEXTURE_3D,0,ni,In.width,In.height,In.depth,0,zn,Ci,In.data);else if(we.isFramebufferTexture){if(Hn)if(sn)t.texStorage2D(s.TEXTURE_2D,xi,ni,In.width,In.height);else{let wn=In.width,vn=In.height;for(let Ii=0;Ii<xi;Ii++)t.texImage2D(s.TEXTURE_2D,Ii,ni,wn,vn,0,zn,Ci,null),wn>>=1,vn>>=1}}else if(Kt.length>0){if(sn&&Hn){const wn=mr(Kt[0]);t.texStorage2D(s.TEXTURE_2D,xi,ni,wn.width,wn.height)}for(let wn=0,vn=Kt.length;wn<vn;wn++)Ye=Kt[wn],sn?bn&&t.texSubImage2D(s.TEXTURE_2D,wn,0,0,zn,Ci,Ye):t.texImage2D(s.TEXTURE_2D,wn,ni,zn,Ci,Ye);we.generateMipmaps=!1}else if(sn){if(Hn){const wn=mr(In);t.texStorage2D(s.TEXTURE_2D,xi,ni,wn.width,wn.height)}bn&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,zn,Ci,In)}else t.texImage2D(s.TEXTURE_2D,0,ni,zn,Ci,In);pe(we)&&de(Dt),Vn.__version=Ut.version,we.onUpdate&&we.onUpdate(we)}return Ve.__version=we.version,!0}function Pt(Ve,we,xt){if(we.image.length!==6)return;const Dt=Ar(Ve,we),Qt=we.source;t.bindTexture(s.TEXTURE_CUBE_MAP,Ve.__webglTexture,s.TEXTURE0+xt);const Ut=n.get(Qt);if(Qt.version!==Ut.__version||Dt===!0){t.activeTexture(s.TEXTURE0+xt);const Vn=$i.getPrimaries($i.workingColorSpace),cn=we.colorSpace===ei?null:$i.getPrimaries(we.colorSpace),Tn=we.colorSpace===ei||Vn===cn?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,we.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,we.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Tn);const rr=we.isCompressedTexture||we.image[0].isCompressedTexture,In=we.image[0]&&we.image[0].isDataTexture,zn=[];for(let vn=0;vn<6;vn++)!rr&&!In?zn[vn]=ge(we.image[vn],!0,i.maxCubemapSize):zn[vn]=In?we.image[vn].image:we.image[vn],zn[vn]=_r(we,zn[vn]);const Ci=zn[0],ni=r.convert(we.format,we.colorSpace),Ye=r.convert(we.type),Kt=We(we.internalFormat,ni,Ye,we.colorSpace),sn=we.isVideoTexture!==!0,Hn=Ut.__version===void 0||Dt===!0,bn=Qt.dataReady;let xi=Pe(we,Ci);er(s.TEXTURE_CUBE_MAP,we);let wn;if(rr){sn&&Hn&&t.texStorage2D(s.TEXTURE_CUBE_MAP,xi,Kt,Ci.width,Ci.height);for(let vn=0;vn<6;vn++){wn=zn[vn].mipmaps;for(let Ii=0;Ii<wn.length;Ii++){const ii=wn[Ii];we.format!==Ge?ni!==null?sn?bn&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii,0,0,ii.width,ii.height,ni,ii.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii,Kt,ii.width,ii.height,0,ii.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):sn?bn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii,0,0,ii.width,ii.height,ni,Ye,ii.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii,Kt,ii.width,ii.height,0,ni,Ye,ii.data)}}}else{if(wn=we.mipmaps,sn&&Hn){wn.length>0&&xi++;const vn=mr(zn[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,xi,Kt,vn.width,vn.height)}for(let vn=0;vn<6;vn++)if(In){sn?bn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,0,0,0,zn[vn].width,zn[vn].height,ni,Ye,zn[vn].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,0,Kt,zn[vn].width,zn[vn].height,0,ni,Ye,zn[vn].data);for(let Ii=0;Ii<wn.length;Ii++){const Hr=wn[Ii].image[vn].image;sn?bn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii+1,0,0,Hr.width,Hr.height,ni,Ye,Hr.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii+1,Kt,Hr.width,Hr.height,0,ni,Ye,Hr.data)}}else{sn?bn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,0,0,0,ni,Ye,zn[vn]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,0,Kt,ni,Ye,zn[vn]);for(let Ii=0;Ii<wn.length;Ii++){const ii=wn[Ii];sn?bn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii+1,0,0,ni,Ye,ii.image[vn]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ii+1,Kt,ni,Ye,ii.image[vn])}}}pe(we)&&de(s.TEXTURE_CUBE_MAP),Ut.__version=Qt.version,we.onUpdate&&we.onUpdate(we)}Ve.__version=we.version}function hn(Ve,we,xt,Dt,Qt,Ut){const Vn=r.convert(xt.format,xt.colorSpace),cn=r.convert(xt.type),Tn=We(xt.internalFormat,Vn,cn,xt.colorSpace);if(!n.get(we).__hasExternalTextures){const zn=Math.max(1,we.width>>Ut),Ci=Math.max(1,we.height>>Ut);we.isWebGLMultiviewRenderTarget===!0?t.texStorage3D(s.TEXTURE_2D_ARRAY,0,Tn,we.width,we.height,we.numViews):Qt===s.TEXTURE_3D||Qt===s.TEXTURE_2D_ARRAY?t.texImage3D(Qt,Ut,Tn,zn,Ci,we.depth,0,Vn,cn,null):t.texImage2D(Qt,Ut,Tn,zn,Ci,0,Vn,cn,null)}t.bindFramebuffer(s.FRAMEBUFFER,Ve);const In=di(we);we.isWebGLMultiviewRenderTarget===!0?In?x.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,n.get(xt).__webglTexture,0,li(we),0,we.numViews):x.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,n.get(xt).__webglTexture,0,0,we.numViews):(Qt===s.TEXTURE_2D||Qt>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&Qt<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(In?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Dt,Qt,n.get(xt).__webglTexture,0,li(we)):s.framebufferTexture2D(s.FRAMEBUFFER,Dt,Qt,n.get(xt).__webglTexture,Ut)),t.bindFramebuffer(s.FRAMEBUFFER,null)}function mn(Ve,we,xt){if(s.bindRenderbuffer(s.RENDERBUFFER,Ve),we.isWebGLMultiviewRenderTarget===!0){const Dt=di(we),Qt=we.numViews,Ut=we.depthTexture;let Vn=s.DEPTH_COMPONENT24,cn=s.DEPTH_ATTACHMENT;Ut&&Ut.isDepthTexture&&(Ut.type===ir?Vn=s.DEPTH_COMPONENT32F:Ut.type===Ur&&(Vn=s.DEPTH24_STENCIL8,cn=s.DEPTH_STENCIL_ATTACHMENT));let Tn=n.get(we.depthTexture).__webglTexture;Tn===void 0&&(Tn=s.createTexture(),s.bindTexture(s.TEXTURE_2D_ARRAY,Tn),s.texStorage3D(s.TEXTURE_2D_ARRAY,1,Vn,we.width,we.height,Qt)),Dt?x.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,cn,Tn,0,li(we),0,Qt):x.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,cn,Tn,0,0,Qt)}else if(we.depthBuffer&&!we.stencilBuffer){let Dt=s.DEPTH_COMPONENT24;if(xt||di(we)){const Qt=we.depthTexture;Qt&&Qt.isDepthTexture&&(Qt.type===ir?Dt=s.DEPTH_COMPONENT32F:Qt.type===Sr&&(Dt=s.DEPTH_COMPONENT24));const Ut=li(we);di(we)?c.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Ut,Dt,we.width,we.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,Ut,Dt,we.width,we.height)}else s.renderbufferStorage(s.RENDERBUFFER,Dt,we.width,we.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,Ve)}else if(we.depthBuffer&&we.stencilBuffer){const Dt=li(we);xt&&di(we)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,Dt,s.DEPTH24_STENCIL8,we.width,we.height):di(we)?c.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Dt,s.DEPTH24_STENCIL8,we.width,we.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,we.width,we.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,Ve)}else{const Dt=we.textures;for(let Qt=0;Qt<Dt.length;Qt++){const Ut=Dt[Qt],Vn=r.convert(Ut.format,Ut.colorSpace),cn=r.convert(Ut.type),Tn=We(Ut.internalFormat,Vn,cn,Ut.colorSpace),rr=li(we);xt&&di(we)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,rr,Tn,we.width,we.height):di(we)?c.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,rr,Tn,we.width,we.height):s.renderbufferStorage(s.RENDERBUFFER,Tn,we.width,we.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function st(Ve,we){if(we&&we.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,Ve),!(we.depthTexture&&we.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(we.depthTexture).__webglTexture||we.depthTexture.image.width!==we.width||we.depthTexture.image.height!==we.height)&&(we.depthTexture.image.width=we.width,we.depthTexture.image.height=we.height,we.depthTexture.needsUpdate=!0),Rt(we.depthTexture,0),we.depthTexture.image.depth!=1?ln(we.depthTexture,0):Rt(we.depthTexture,0);const Dt=n.get(we.depthTexture).__webglTexture,Qt=li(we);if(we.isWebGLMultiviewRenderTarget===!0){const Ut=di(we),Vn=we.numViews;if(we.depthTexture.format===lt)Ut?x.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,Dt,0,Qt,0,Vn):x.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,Dt,0,0,Vn);else if(we.depthTexture.format===wt)Ut?x.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,Dt,0,Qt,0,Vn):x.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,Dt,0,0,Vn);else throw new Error("Unknown depthTexture format")}else if(we.depthTexture.format===lt)di(we)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Dt,0,Qt):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Dt,0);else if(we.depthTexture.format===wt)di(we)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Dt,0,Qt):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Dt,0);else throw new Error("Unknown depthTexture format")}function Ot(Ve){const we=n.get(Ve),xt=Ve.isWebGLCubeRenderTarget===!0;if(Ve.depthTexture&&!we.__autoAllocateDepthBuffer){if(xt)throw new Error("target.depthTexture not supported in Cube render targets");st(we.__webglFramebuffer,Ve)}else if(xt){we.__webglDepthbuffer=[];for(let Dt=0;Dt<6;Dt++)t.bindFramebuffer(s.FRAMEBUFFER,we.__webglFramebuffer[Dt]),we.__webglDepthbuffer[Dt]=s.createRenderbuffer(),mn(we.__webglDepthbuffer[Dt],Ve,!1)}else t.bindFramebuffer(s.FRAMEBUFFER,we.__webglFramebuffer),we.__webglDepthbuffer=s.createRenderbuffer(),mn(we.__webglDepthbuffer,Ve,!1);t.bindFramebuffer(s.FRAMEBUFFER,null)}function Tt(Ve,we,xt){const Dt=n.get(Ve);we!==void 0&&hn(Dt.__webglFramebuffer,Ve,Ve.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),xt!==void 0&&Ot(Ve)}function $t(Ve){const we=Ve.texture,xt=n.get(Ve),Dt=n.get(we);Ve.addEventListener("dispose",ze);const Qt=Ve.textures,Ut=Ve.isWebGLCubeRenderTarget===!0,Vn=Qt.length>1;if(Vn||(Dt.__webglTexture===void 0&&(Dt.__webglTexture=s.createTexture()),Dt.__version=we.version,o.memory.textures++),Ut){xt.__webglFramebuffer=[];for(let cn=0;cn<6;cn++)if(we.mipmaps&&we.mipmaps.length>0){xt.__webglFramebuffer[cn]=[];for(let Tn=0;Tn<we.mipmaps.length;Tn++)xt.__webglFramebuffer[cn][Tn]=s.createFramebuffer()}else xt.__webglFramebuffer[cn]=s.createFramebuffer()}else{if(we.mipmaps&&we.mipmaps.length>0){xt.__webglFramebuffer=[];for(let cn=0;cn<we.mipmaps.length;cn++)xt.__webglFramebuffer[cn]=s.createFramebuffer()}else xt.__webglFramebuffer=s.createFramebuffer();if(Vn)for(let cn=0,Tn=Qt.length;cn<Tn;cn++){const rr=n.get(Qt[cn]);rr.__webglTexture===void 0&&(rr.__webglTexture=s.createTexture(),o.memory.textures++)}if(Ve.samples>0&&di(Ve)===!1){xt.__webglMultisampledFramebuffer=s.createFramebuffer(),xt.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,xt.__webglMultisampledFramebuffer);for(let cn=0;cn<Qt.length;cn++){const Tn=Qt[cn];xt.__webglColorRenderbuffer[cn]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,xt.__webglColorRenderbuffer[cn]);const rr=r.convert(Tn.format,Tn.colorSpace),In=r.convert(Tn.type),zn=We(Tn.internalFormat,rr,In,Tn.colorSpace,Ve.isXRRenderTarget===!0),Ci=li(Ve);s.renderbufferStorageMultisample(s.RENDERBUFFER,Ci,zn,Ve.width,Ve.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+cn,s.RENDERBUFFER,xt.__webglColorRenderbuffer[cn])}s.bindRenderbuffer(s.RENDERBUFFER,null),Ve.depthBuffer&&(xt.__webglDepthRenderbuffer=s.createRenderbuffer(),mn(xt.__webglDepthRenderbuffer,Ve,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Ut){t.bindTexture(s.TEXTURE_CUBE_MAP,Dt.__webglTexture),er(s.TEXTURE_CUBE_MAP,we);for(let cn=0;cn<6;cn++)if(we.mipmaps&&we.mipmaps.length>0)for(let Tn=0;Tn<we.mipmaps.length;Tn++)hn(xt.__webglFramebuffer[cn][Tn],Ve,we,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+cn,Tn);else hn(xt.__webglFramebuffer[cn],Ve,we,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+cn,0);pe(we)&&de(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Vn){for(let cn=0,Tn=Qt.length;cn<Tn;cn++){const rr=Qt[cn],In=n.get(rr);t.bindTexture(s.TEXTURE_2D,In.__webglTexture),er(s.TEXTURE_2D,rr),hn(xt.__webglFramebuffer,Ve,rr,s.COLOR_ATTACHMENT0+cn,s.TEXTURE_2D,0),pe(rr)&&de(s.TEXTURE_2D)}t.unbindTexture()}else{let cn=s.TEXTURE_2D;if((Ve.isWebGL3DRenderTarget||Ve.isWebGLArrayRenderTarget)&&(cn=Ve.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),Ve.isWebGLMultiviewRenderTarget===!0&&(cn=s.TEXTURE_2D_ARRAY),t.bindTexture(cn,Dt.__webglTexture),er(cn,we),we.mipmaps&&we.mipmaps.length>0)for(let Tn=0;Tn<we.mipmaps.length;Tn++)hn(xt.__webglFramebuffer[Tn],Ve,we,s.COLOR_ATTACHMENT0,cn,Tn);else hn(xt.__webglFramebuffer,Ve,we,s.COLOR_ATTACHMENT0,cn,0);pe(we)&&de(cn),t.unbindTexture()}(Ve.depthBuffer||Ve.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(Ve)}function Xt(Ve){const we=Ve.textures;for(let xt=0,Dt=we.length;xt<Dt;xt++){const Qt=we[xt];if(pe(Qt)){const Ut=Ve.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,Vn=n.get(Qt).__webglTexture;t.bindTexture(Ut,Vn),de(Ut),t.unbindTexture()}}}const Wt=[],gn=[];function _n(Ve){if(Ve.samples>0){if(di(Ve)===!1){const we=Ve.textures,xt=Ve.width,Dt=Ve.height;let Qt=s.COLOR_BUFFER_BIT;const Ut=Ve.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Vn=n.get(Ve),cn=we.length>1;if(cn)for(let Tn=0;Tn<we.length;Tn++)t.bindFramebuffer(s.FRAMEBUFFER,Vn.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Tn,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,Vn.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Tn,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,Vn.__webglMultisampledFramebuffer),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Vn.__webglFramebuffer);for(let Tn=0;Tn<we.length;Tn++){if(Ve.resolveDepthBuffer&&(Ve.depthBuffer&&(Qt|=s.DEPTH_BUFFER_BIT),Ve.stencilBuffer&&Ve.resolveStencilBuffer&&(Qt|=s.STENCIL_BUFFER_BIT)),cn){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,Vn.__webglColorRenderbuffer[Tn]);const rr=n.get(we[Tn]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,rr,0)}s.blitFramebuffer(0,0,xt,Dt,0,0,xt,Dt,Qt,s.NEAREST),E===!0&&(Wt.length=0,gn.length=0,Wt.push(s.COLOR_ATTACHMENT0+Tn),Ve.depthBuffer&&Ve.resolveDepthBuffer===!1&&(Wt.push(Ut),gn.push(Ut),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,gn)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Wt))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),cn)for(let Tn=0;Tn<we.length;Tn++){t.bindFramebuffer(s.FRAMEBUFFER,Vn.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Tn,s.RENDERBUFFER,Vn.__webglColorRenderbuffer[Tn]);const rr=n.get(we[Tn]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,Vn.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Tn,s.TEXTURE_2D,rr,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Vn.__webglMultisampledFramebuffer)}else if(Ve.depthBuffer&&Ve.resolveDepthBuffer===!1&&E){const we=Ve.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[we])}}}function li(Ve){return Math.min(i.maxSamples,Ve.samples)}function di(Ve){const we=n.get(Ve);return Ve.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&we.__useRenderToTexture!==!1}function Ji(Ve){const we=o.render.frame;P.get(Ve)!==we&&(P.set(Ve,we),Ve.update())}function _r(Ve,we){const xt=Ve.colorSpace,Dt=Ve.format,Qt=Ve.type;return Ve.isCompressedTexture===!0||Ve.isVideoTexture===!0||xt!==ai&&xt!==ei&&($i.getTransfer(xt)===Qn?(Dt!==Ge||Qt!==$n)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",xt)),we}function mr(Ve){return typeof HTMLImageElement<"u"&&Ve instanceof HTMLImageElement?(B.width=Ve.naturalWidth||Ve.width,B.height=Ve.naturalHeight||Ve.height):typeof VideoFrame<"u"&&Ve instanceof VideoFrame?(B.width=Ve.displayWidth,B.height=Ve.displayHeight):(B.width=Ve.width,B.height=Ve.height),B}this.allocateTextureUnit=rt,this.resetTextureUnits=$e,this.setTexture2D=Rt,this.setTexture2DArray=ln,this.setTexture3D=vt,this.setTextureCube=en,this.rebindTextures=Tt,this.uploadTexture=Nn,this.setupRenderTarget=$t,this.updateRenderTargetMipmap=Xt,this.updateMultisampleRenderTarget=_n,this.setupDepthTexture=st,this.setupDepthRenderbuffer=Ot,this.setupFrameBufferTexture=hn,this.useMultisampledRTT=di,this.runDeferredUploads=ur,this.setDeferTextureUploads=qi}function Td(s,e){function t(n,i=ei){let r;const o=$i.getTransfer(i);if(n===$n)return s.UNSIGNED_BYTE;if(n===sr)return s.UNSIGNED_SHORT_4_4_4_4;if(n===fs)return s.UNSIGNED_SHORT_5_5_5_1;if(n===os)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===Or)return s.BYTE;if(n===dr)return s.SHORT;if(n===Er)return s.UNSIGNED_SHORT;if(n===Fr)return s.INT;if(n===Sr)return s.UNSIGNED_INT;if(n===ir)return s.FLOAT;if(n===Li)return s.HALF_FLOAT;if(n===es)return s.ALPHA;if(n===Ie)return s.RGB;if(n===Ge)return s.RGBA;if(n===tt)return s.LUMINANCE;if(n===At)return s.LUMINANCE_ALPHA;if(n===lt)return s.DEPTH_COMPONENT;if(n===wt)return s.DEPTH_STENCIL;if(n===Ft)return s.RED;if(n===yn)return s.RED_INTEGER;if(n===tn)return s.RG;if(n===bt)return s.RG_INTEGER;if(n===Rn)return s.RGBA_INTEGER;if(n===Pn||n===Xn||n===Di||n===si)if(o===Qn)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===Pn)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Xn)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Di)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===si)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===Pn)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Xn)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Di)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===si)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===ti||n===pi||n===Wi||n===Vi)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===ti)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===pi)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Wi)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Vi)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===on||n===oi||n===or)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===on||n===oi)return o===Qn?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===or)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===gi||n===z||n===q||n===ce||n===me||n===Me||n===Ke||n===et||n===It||n===St||n===it||n===yt||n===Nt||n===_t)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===gi)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===z)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===q)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===ce)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===me)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Me)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Ke)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===et)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===It)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===St)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===it)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===yt)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Nt)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===_t)return o===Qn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Cn||n===le||n===he)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===Cn)return o===Qn?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===le)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===he)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Ee||n===R||n===M||n===Z)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===Cn)return r.COMPRESSED_RED_RGTC1_EXT;if(n===R)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===M)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Z)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Ur?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}class Qo extends Yi{constructor(){super(),this.isGroup=!0,this.type="Group"}}class jh extends Gr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}var Id=new De,Bd=new De;function Q0(s,e,t){Id.setFromMatrixPosition(e.matrixWorld),Bd.setFromMatrixPosition(t.matrixWorld);var n=Id.distanceTo(Bd),i=e.projectionMatrix.elements,r=t.projectionMatrix.elements,o=i[14]/(i[10]-1),c=i[14]/(i[10]+1),E=(i[9]+1)/i[5],x=(i[9]-1)/i[5],B=(i[8]-1)/i[0],P=(r[8]+1)/r[0],U=o*B,V=o*P,j=n/(-B+P),ie=j*-B;e.matrixWorld.decompose(s.position,s.quaternion,s.scale),s.translateX(ie),s.translateZ(j),s.matrixWorld.compose(s.position,s.quaternion,s.scale),s.matrixWorldInverse.copy(s.matrixWorld).invert();var X=o+j,H=c+j,ge=U-ie,pe=V+(n-ie),de=E*c/H*X,We=x*c/H*X;s.projectionMatrix.makePerspective(ge,pe,de,We,X,H)}function Rd(s){var e,t,n=this,i=null,r=null,o=null,c=[],E=new On,x=new On,B=1,P="local-floor";typeof window<"u"&&"VRFrameData"in window&&(r=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",de,!1));var U=new On,V=new Xi,j=new De,ie=new Gr;ie.viewport=new zi,ie.layers.enable(1);var X=new Gr;X.viewport=new zi,X.layers.enable(2);var H=new jh([ie,X]);H.layers.enable(1),H.layers.enable(2);var ge=new Lt,pe;function de(){var je=n.isPresenting=i!==null&&i.isPresenting===!0;if(je){var nt=i.getEyeParameters("left");e=2*nt.renderWidth*B,t=nt.renderHeight*B,pe=s.getPixelRatio(),s.getSize(ge),s.setDrawingBufferSize(e,t,1),ie.viewport.set(0,0,e/2,t),X.viewport.set(e/2,0,e/2,t),be.start(),n.dispatchEvent({type:"sessionstart"})}else n.enabled&&s.setDrawingBufferSize(ge.width,ge.height,pe),be.stop(),n.dispatchEvent({type:"sessionend"})}var We=[],Pe=[];function ke(je){for(var nt=navigator.getGamepads&&navigator.getGamepads(),$e=0,rt=nt.length;$e<rt;$e++){var mt=nt[$e];if(mt&&(mt.id==="Daydream Controller"||mt.id==="Gear VR Controller"||mt.id==="Oculus Go Controller"||mt.id==="OpenVR Gamepad"||mt.id.startsWith("Oculus Touch")||mt.id.startsWith("HTC Vive Focus")||mt.id.startsWith("Spatial Controller"))){var Rt=mt.hand;if(je===0&&(Rt===""||Rt==="right")||je===1&&Rt==="left")return mt}}}function ze(){for(var je=0;je<c.length;je++){var nt=c[je],$e=ke(je);if($e!==void 0&&$e.pose!==void 0){if($e.pose===null)return;var rt=$e.pose;rt.hasPosition===!1&&nt.position.set(.2,-.6,-.05),rt.position!==null&&nt.position.fromArray(rt.position),rt.orientation!==null&&nt.quaternion.fromArray(rt.orientation),nt.matrix.compose(nt.position,nt.quaternion,nt.scale),nt.matrix.premultiply(E),nt.matrix.decompose(nt.position,nt.quaternion,nt.scale),nt.matrixWorldNeedsUpdate=!0,nt.visible=!0;var mt=$e.id==="Daydream Controller"?0:1;We[je]===void 0&&(We[je]=!1),We[je]!==$e.buttons[mt].pressed&&(We[je]=$e.buttons[mt].pressed,We[je]===!0?nt.dispatchEvent({type:"selectstart"}):(nt.dispatchEvent({type:"selectend"}),nt.dispatchEvent({type:"select"}))),mt=2,Pe[je]===void 0&&(Pe[je]=!1),$e.buttons[mt]!==void 0&&Pe[je]!==$e.buttons[mt].pressed&&(Pe[je]=$e.buttons[mt].pressed,Pe[je]===!0?nt.dispatchEvent({type:"squeezestart"}):(nt.dispatchEvent({type:"squeezeend"}),nt.dispatchEvent({type:"squeeze"})))}else nt.visible=!1}}function Te(je,nt){nt!==null&&nt.length===4&&je.set(nt[0]*e,nt[1]*t,nt[2]*e,nt[3]*t)}this.enabled=!1,this.getController=function(je){var nt=c[je];return nt===void 0&&(nt=new Qo,nt.matrixAutoUpdate=!1,nt.visible=!1,c[je]=nt),nt},this.getDevice=function(){return i},this.setDevice=function(je){je!==void 0&&(i=je),be.setContext(je)},this.setFramebufferScaleFactor=function(je){B=je},this.setReferenceSpaceType=function(je){P=je},this.setPoseTarget=function(je){je!==void 0&&(o=je)},this.cameraAutoUpdate=!0,this.updateCamera=function(je){var nt=P==="local-floor"?1.6:0;if(i.depthNear=je.near,i.depthFar=je.far,i.getFrameData(r),P==="local-floor"){var $e=i.stageParameters;$e?E.fromArray($e.sittingToStandingTransform):E.makeTranslation(0,nt,0)}var rt=r.pose,mt=o!==null?o:je;mt.matrix.copy(E),mt.matrix.decompose(mt.position,mt.quaternion,mt.scale),rt.orientation!==null&&(V.fromArray(rt.orientation),mt.quaternion.multiply(V)),rt.position!==null&&(V.setFromRotationMatrix(E),j.fromArray(rt.position),j.applyQuaternion(V),mt.position.add(j)),mt.updateMatrixWorld();for(var Rt=mt.children,ln=0,vt=Rt.length;ln<vt;ln++)Rt[ln].updateMatrixWorld(!0);ie.near=je.near,X.near=je.near,ie.far=je.far,X.far=je.far,ie.matrixWorldInverse.fromArray(r.leftViewMatrix),X.matrixWorldInverse.fromArray(r.rightViewMatrix),x.copy(E).invert(),P==="local-floor"&&(ie.matrixWorldInverse.multiply(x),X.matrixWorldInverse.multiply(x));var en=mt.parent;en!==null&&(U.copy(en.matrixWorld).invert(),ie.matrixWorldInverse.multiply(U),X.matrixWorldInverse.multiply(U)),ie.matrixWorld.copy(ie.matrixWorldInverse).invert(),X.matrixWorld.copy(X.matrixWorldInverse).invert(),ie.projectionMatrix.fromArray(r.leftProjectionMatrix),X.projectionMatrix.fromArray(r.rightProjectionMatrix),Q0(H,ie,X);var rn=i.getLayers();if(rn.length){var Dn=rn[0];Te(ie.viewport,Dn.leftBounds),Te(X.viewport,Dn.rightBounds)}return ze(),H},this.getCamera=function(){return H},this.getFoveation=function(){return 1},this.setFoveation=function(je){je!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(n.isPresenting)return"opaque"},this.getStandingMatrix=function(){return E},this.isPresenting=!1;var be=new Lh;this.setAnimationLoop=function(je){be.setAnimationLoop(je),this.isPresenting&&be.start()},this.submitFrame=function(){this.isPresenting&&i.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",de)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(Rd.prototype,{addEventListener:as.prototype.addEventListener,hasEventListener:as.prototype.hasEventListener,removeEventListener:as.prototype.removeEventListener,dispatchEvent:as.prototype.dispatchEvent});class Ld extends As{constructor(e,t,n,i={}){super(e,t,i),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}copy(e){return super.copy(e),this.numViews=e.numViews,this}}Ld.prototype.isWebGLMultiviewRenderTarget=!0;const V0={type:"move"};class Wh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Qo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Qo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new De,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new De),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Qo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new De,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new De),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,o=null;const c=this._targetRay,E=this._grip,x=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(x&&e.hand){o=!0;for(const ie of e.hand.values()){const X=t.getJointPose(ie,n),H=this._getHandJoint(x,ie);X!==null&&(H.matrix.fromArray(X.transform.matrix),H.matrix.decompose(H.position,H.rotation,H.scale),H.matrixWorldNeedsUpdate=!0,H.jointRadius=X.radius),H.visible=X!==null}const B=x.joints["index-finger-tip"],P=x.joints["thumb-tip"],U=B.position.distanceTo(P.position),V=.02,j=.005;x.inputState.pinching&&U>V+j?(x.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!x.inputState.pinching&&U<=V-j&&(x.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else E!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(E.matrix.fromArray(r.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,r.linearVelocity?(E.hasLinearVelocity=!0,E.linearVelocity.copy(r.linearVelocity)):E.hasLinearVelocity=!1,r.angularVelocity?(E.hasAngularVelocity=!0,E.angularVelocity.copy(r.angularVelocity)):E.hasAngularVelocity=!1));c!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&r!==null&&(i=r),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(V0)))}return c!==null&&(c.visible=i!==null),E!==null&&(E.visible=r!==null),x!==null&&(x.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Qo;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const H0=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,z0=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class j0{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const i=new fr,r=e.properties.get(i);r.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}render(e,t){if(this.texture!==null){if(this.mesh===null){const n=t.cameras[0].viewport,i=new Os({vertexShader:H0,fragmentShader:z0,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Dr(new xa(20,20),i)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class W0 extends as{constructor(e,t,n,i){super();const r=this;let o=null,c=1;var E=null;let x=null,B="local-floor",P=1,U=null,V=null;var j=[];let ie=null,X=null,H=null,ge=null;const pe=new j0,de=t.getContextAttributes();let We=null,Pe=null;const ke=[],ze=[],Te=new Lt;let be=null;const je=new Gr;je.layers.enable(1),je.viewport=new zi;const nt=new Gr;nt.layers.enable(2),nt.viewport=new zi;const $e=[je,nt],rt=new jh;rt.layers.enable(1),rt.layers.enable(2);let mt=null,Rt=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return V},this.getController=function(Pt){let hn=ke[Pt];return hn===void 0&&(hn=new Wh,ke[Pt]=hn),hn.getTargetRaySpace()},this.getControllerGrip=function(Pt){let hn=ke[Pt];return hn===void 0&&(hn=new Wh,ke[Pt]=hn),hn.getGripSpace()},this.getHand=function(Pt){let hn=ke[Pt];return hn===void 0&&(hn=new Wh,ke[Pt]=hn),hn.getHandSpace()};function ln(Pt){const hn=ze.indexOf(Pt.inputSource);if(hn===-1)return;const mn=ke[hn];mn!==void 0&&(mn.update(Pt.inputSource,Pt.frame,U||x),mn.dispatchEvent({type:Pt.type,data:Pt.inputSource}))}function vt(){o.removeEventListener("select",ln),o.removeEventListener("selectstart",ln),o.removeEventListener("selectend",ln),o.removeEventListener("squeeze",ln),o.removeEventListener("squeezestart",ln),o.removeEventListener("squeezeend",ln),o.removeEventListener("end",vt),o.removeEventListener("inputsourceschange",en);for(let Pt=0;Pt<ke.length;Pt++){const hn=ze[Pt];hn!==null&&(ze[Pt]=null,ke[Pt].disconnect(hn))}mt=null,Rt=null,pe.reset(),e.setRenderTarget(We),H=null,X=null,ie=null,o=null,Pe=null,Nn.stop(),r.isPresenting=!1,e.setPixelRatio(be),e.setSize(Te.width,Te.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Pt){c=Pt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Pt){B=Pt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return U||x},this.setReferenceSpace=function(Pt){U=Pt},this.getBaseLayer=function(){return X!==null?X:H},this.getBinding=function(){return ie},this.getFrame=function(){return ge},this.getSession=function(){return o},this.setSession=async function(Pt){if(o=Pt,o!==null){if(We=e.getRenderTarget(),o.addEventListener("select",ln),o.addEventListener("selectstart",ln),o.addEventListener("selectend",ln),o.addEventListener("squeeze",ln),o.addEventListener("squeezestart",ln),o.addEventListener("squeezeend",ln),o.addEventListener("end",vt),o.addEventListener("inputsourceschange",en),de.xrCompatible!==!0&&await t.makeXRCompatible(),be=e.getPixelRatio(),e.getSize(Te),o.renderState.layers===void 0){const hn={antialias:de.antialias,alpha:!0,depth:de.depth,stencil:de.stencil,framebufferScaleFactor:c};H=new XRWebGLLayer(o,t,hn),o.updateRenderState({baseLayer:H}),e.setPixelRatio(1),e.setSize(H.framebufferWidth,H.framebufferHeight,!1),Pe=new As(H.framebufferWidth,H.framebufferHeight,{format:Ge,type:$n,colorSpace:e.outputColorSpace,stencilBuffer:de.stencil})}else{let hn=null,mn=null,st=null;de.depth&&(st=de.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,hn=de.stencil?wt:lt,mn=de.stencil?Ur:Sr),r.isMultiview=i&&n.has("OCULUS_multiview");const Ot={colorFormat:t.RGBA8,depthFormat:st,scaleFactor:c};r.isMultiview&&(Ot.textureType="texture-array"),ie=new XRWebGLBinding(o,t),X=ie.createProjectionLayer(Ot),o.updateRenderState({layers:[X]}),e.setPixelRatio(1),e.setSize(X.textureWidth,X.textureHeight,!1);const Tt={format:Ge,type:$n,depthTexture:new Gh(X.textureWidth,X.textureHeight,mn,void 0,void 0,void 0,void 0,void 0,void 0,hn),stencilBuffer:de.stencil,colorSpace:e.outputColorSpace,samples:de.antialias?4:0,resolveDepthBuffer:X.ignoreDepthValues===!1};if(r.isMultiview){const $t=n.get("OCULUS_multiview");this.maxNumViews=t.getParameter($t.MAX_VIEWS_OVR),Pe=new Ld(X.textureWidth,X.textureHeight,2,Tt)}else Pe=new As(X.textureWidth,X.textureHeight,Tt)}Pe.isXRRenderTarget=!0,this.setFoveation(P),U=null,x=await o.requestReferenceSpace(B),Nn.setContext(o),Nn.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(o!==null)return o.environmentBlendMode},this.addLayer=function(Pt){!window.XRWebGLBinding||!this.layersEnabled||!o||(j.push(Pt),this.updateLayers())},this.removeLayer=function(Pt){j.splice(j.indexOf(Pt),1),!(!window.XRWebGLBinding||!this.layersEnabled||!o)&&this.updateLayers()},this.updateLayers=function(){var Pt=j.map(function(hn){return hn});Pt.unshift(o.renderState.layers[0]),o.updateRenderState({layers:Pt})};function en(Pt){for(let hn=0;hn<Pt.removed.length;hn++){const mn=Pt.removed[hn],st=ze.indexOf(mn);st>=0&&(ze[st]=null,ke[st].disconnect(mn))}for(let hn=0;hn<Pt.added.length;hn++){const mn=Pt.added[hn];let st=ze.indexOf(mn);if(st===-1){for(let Tt=0;Tt<ke.length;Tt++)if(Tt>=ze.length){ze.push(mn),st=Tt;break}else if(ze[Tt]===null){ze[Tt]=mn,st=Tt;break}if(st===-1)break}const Ot=ke[st];Ot&&Ot.connect(mn)}}const rn=new De,Dn=new De;function _i(Pt,hn,mn){rn.setFromMatrixPosition(hn.matrixWorld),Dn.setFromMatrixPosition(mn.matrixWorld);const st=rn.distanceTo(Dn),Ot=hn.projectionMatrix.elements,Tt=mn.projectionMatrix.elements,$t=Ot[14]/(Ot[10]-1),Xt=Ot[14]/(Ot[10]+1),Wt=(Ot[9]+1)/Ot[5],gn=(Ot[9]-1)/Ot[5],_n=(Ot[8]-1)/Ot[0],li=(Tt[8]+1)/Tt[0],di=$t*_n,Ji=$t*li,_r=st/(-_n+li),mr=_r*-_n;hn.matrixWorld.decompose(Pt.position,Pt.quaternion,Pt.scale),Pt.translateX(mr),Pt.translateZ(_r),Pt.matrixWorld.compose(Pt.position,Pt.quaternion,Pt.scale),Pt.matrixWorldInverse.copy(Pt.matrixWorld).invert();const Ve=$t+_r,we=Xt+_r,xt=di-mr,Dt=Ji+(st-mr),Qt=Wt*Xt/we*Ve,Ut=gn*Xt/we*Ve;Pt.projectionMatrix.makePerspective(xt,Dt,Qt,Ut,Ve,we),Pt.projectionMatrixInverse.copy(Pt.projectionMatrix).invert()}function er(Pt,hn){hn===null?Pt.matrixWorld.copy(Pt.matrix):Pt.matrixWorld.multiplyMatrices(hn.matrixWorld,Pt.matrix),Pt.matrixWorldInverse.copy(Pt.matrixWorld).invert()}this.setPoseTarget=function(Pt){Pt!==void 0&&(E=Pt)},this.updateCamera=function(Pt){if(o===null)return;pe.texture!==null&&(Pt.near=pe.depthNear,Pt.far=pe.depthFar),rt.near=nt.near=je.near=Pt.near,rt.far=nt.far=je.far=Pt.far,(mt!==rt.near||Rt!==rt.far)&&(o.updateRenderState({depthNear:rt.near,depthFar:rt.far}),mt=rt.near,Rt=rt.far,je.near=mt,je.far=Rt,nt.near=mt,nt.far=Rt,je.updateProjectionMatrix(),nt.updateProjectionMatrix(),Pt.updateProjectionMatrix());const hn=rt.cameras;var mn=E||Pt;const st=mn.parent;er(rt,st);for(let Ot=0;Ot<hn.length;Ot++)er(hn[Ot],st);hn.length===2?_i(rt,je,nt):rt.projectionMatrix.copy(je.projectionMatrix),Ar(Pt,rt,mn)};function Ar(Pt,hn,mn){hn.matrixWorld.decompose(hn.position,hn.quaternion,hn.scale),mn.parent===null?mn.matrix.copy(hn.matrixWorld):(mn.matrix.copy(mn.parent.matrixWorld),mn.matrix.invert(),mn.matrix.multiply(hn.matrixWorld)),mn.matrix.decompose(mn.position,mn.quaternion,mn.scale),mn.updateMatrixWorld(!0),Pt.projectionMatrix.copy(hn.projectionMatrix),Pt.projectionMatrixInverse.copy(hn.projectionMatrixInverse),Pt.isPerspectiveCamera&&(Pt.fov=uo*2*Math.atan(1/Pt.projectionMatrix.elements[5]),Pt.zoom=1)}this.getCamera=function(){return rt},this.getFoveation=function(){if(!(X===null&&H===null))return P},this.setFoveation=function(Pt){P=Pt,X!==null&&(X.fixedFoveation=Pt),H!==null&&H.fixedFoveation!==void 0&&(H.fixedFoveation=Pt)},this.hasDepthSensing=function(){return pe.texture!==null};let qi=null;function ur(Pt,hn){if(V=hn.getViewerPose(U||x),ge=hn,V!==null){const mn=V.views;H!==null&&(e.setRenderTargetFramebuffer(Pe,H.framebuffer),e.setRenderTarget(Pe));let st=!1;mn.length!==rt.cameras.length&&(rt.cameras.length=0,st=!0);for(let Tt=0;Tt<mn.length;Tt++){const $t=mn[Tt];let Xt=null;if(H!==null)Xt=H.getViewport($t);else{const gn=ie.getViewSubImage(X,$t);Xt=gn.viewport,Tt===0&&(e.setRenderTargetTextures(Pe,gn.colorTexture,X.ignoreDepthValues?void 0:gn.depthStencilTexture),e.setRenderTarget(Pe))}let Wt=$e[Tt];Wt===void 0&&(Wt=new Gr,Wt.layers.enable(Tt),Wt.viewport=new zi,$e[Tt]=Wt),Wt.matrix.fromArray($t.transform.matrix),Wt.matrix.decompose(Wt.position,Wt.quaternion,Wt.scale),Wt.projectionMatrix.fromArray($t.projectionMatrix),Wt.projectionMatrixInverse.copy(Wt.projectionMatrix).invert(),Wt.viewport.set(Xt.x,Xt.y,Xt.width,Xt.height),Tt===0&&(rt.matrix.copy(Wt.matrix),rt.matrix.decompose(rt.position,rt.quaternion,rt.scale)),st===!0&&rt.cameras.push(Wt)}const Ot=o.enabledFeatures;if(Ot&&Ot.includes("depth-sensing")){const Tt=ie.getDepthInformation(mn[0]);Tt&&Tt.isValid&&Tt.texture&&pe.init(e,Tt,o.renderState)}}for(let mn=0;mn<ke.length;mn++){const st=ze[mn],Ot=ke[mn];st!==null&&Ot!==void 0&&Ot.update(st,hn,U||x)}pe.render(e,rt),qi&&qi(Pt,hn),hn.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:hn}),ge=null}const Nn=new Lh;Nn.setAnimationLoop(ur),this.setAnimationLoop=function(Pt){qi=Pt},this.dispose=function(){}}}const Vo=new ws,K0=new On;function X0(s,e){function t(X,H){X.matrixAutoUpdate===!0&&X.updateMatrix(),H.value.copy(X.matrix)}function n(X,H){H.color.getRGB(X.fogColor.value,qu(s)),H.isFog?(X.fogNear.value=H.near,X.fogFar.value=H.far):H.isFogExp2&&(X.fogDensity.value=H.density)}function i(X,H,ge,pe,de){H.isMeshBasicMaterial||H.isMeshLambertMaterial?r(X,H):H.isMeshToonMaterial?(r(X,H),P(X,H)):H.isMeshPhongMaterial?(r(X,H),B(X,H)):H.isMeshStandardMaterial?(r(X,H),U(X,H),H.isMeshPhysicalMaterial&&V(X,H,de)):H.isMeshMatcapMaterial?(r(X,H),j(X,H)):H.isMeshDepthMaterial?r(X,H):H.isMeshDistanceMaterial?(r(X,H),ie(X,H)):H.isMeshNormalMaterial?r(X,H):H.isLineBasicMaterial?(o(X,H),H.isLineDashedMaterial&&c(X,H)):H.isPointsMaterial?E(X,H,ge,pe):H.isSpriteMaterial?x(X,H):H.isShadowMaterial?(X.color.value.copy(H.color),X.opacity.value=H.opacity):H.isShaderMaterial&&(H.uniformsNeedUpdate=!1)}function r(X,H){X.opacity.value=H.opacity,H.color&&X.diffuse.value.copy(H.color),H.emissive&&X.emissive.value.copy(H.emissive).multiplyScalar(H.emissiveIntensity),H.map&&(X.map.value=H.map,t(H.map,X.mapTransform)),H.alphaMap&&(X.alphaMap.value=H.alphaMap,t(H.alphaMap,X.alphaMapTransform)),H.bumpMap&&(X.bumpMap.value=H.bumpMap,t(H.bumpMap,X.bumpMapTransform),X.bumpScale.value=H.bumpScale,H.side===C&&(X.bumpScale.value*=-1)),H.normalMap&&(X.normalMap.value=H.normalMap,t(H.normalMap,X.normalMapTransform),X.normalScale.value.copy(H.normalScale),H.side===C&&X.normalScale.value.negate()),H.displacementMap&&(X.displacementMap.value=H.displacementMap,t(H.displacementMap,X.displacementMapTransform),X.displacementScale.value=H.displacementScale,X.displacementBias.value=H.displacementBias),H.emissiveMap&&(X.emissiveMap.value=H.emissiveMap,t(H.emissiveMap,X.emissiveMapTransform)),H.specularMap&&(X.specularMap.value=H.specularMap,t(H.specularMap,X.specularMapTransform)),H.alphaTest>0&&(X.alphaTest.value=H.alphaTest);const ge=e.get(H),pe=ge.envMap,de=ge.envMapRotation;if(pe&&(X.envMap.value=pe,Vo.copy(de),Vo.x*=-1,Vo.y*=-1,Vo.z*=-1,pe.isCubeTexture&&pe.isRenderTargetTexture===!1&&(Vo.y*=-1,Vo.z*=-1),X.envMapRotation.value.setFromMatrix4(K0.makeRotationFromEuler(Vo)),X.flipEnvMap.value=pe.isCubeTexture&&pe.isRenderTargetTexture===!1?-1:1,X.reflectivity.value=H.reflectivity,X.ior.value=H.ior,X.refractionRatio.value=H.refractionRatio),H.lightMap){X.lightMap.value=H.lightMap;const We=s._useLegacyLights===!0?Math.PI:1;X.lightMapIntensity.value=H.lightMapIntensity*We,t(H.lightMap,X.lightMapTransform)}H.aoMap&&(X.aoMap.value=H.aoMap,X.aoMapIntensity.value=H.aoMapIntensity,t(H.aoMap,X.aoMapTransform))}function o(X,H){X.diffuse.value.copy(H.color),X.opacity.value=H.opacity,H.map&&(X.map.value=H.map,t(H.map,X.mapTransform))}function c(X,H){X.dashSize.value=H.dashSize,X.totalSize.value=H.dashSize+H.gapSize,X.scale.value=H.scale}function E(X,H,ge,pe){X.diffuse.value.copy(H.color),X.opacity.value=H.opacity,X.size.value=H.size*ge,X.scale.value=pe*.5,H.map&&(X.map.value=H.map,t(H.map,X.uvTransform)),H.alphaMap&&(X.alphaMap.value=H.alphaMap,t(H.alphaMap,X.alphaMapTransform)),H.alphaTest>0&&(X.alphaTest.value=H.alphaTest)}function x(X,H){X.diffuse.value.copy(H.color),X.opacity.value=H.opacity,X.rotation.value=H.rotation,H.map&&(X.map.value=H.map,t(H.map,X.mapTransform)),H.alphaMap&&(X.alphaMap.value=H.alphaMap,t(H.alphaMap,X.alphaMapTransform)),H.alphaTest>0&&(X.alphaTest.value=H.alphaTest)}function B(X,H){X.specular.value.copy(H.specular),X.shininess.value=Math.max(H.shininess,1e-4)}function P(X,H){H.gradientMap&&(X.gradientMap.value=H.gradientMap)}function U(X,H){X.metalness.value=H.metalness,H.metalnessMap&&(X.metalnessMap.value=H.metalnessMap,t(H.metalnessMap,X.metalnessMapTransform)),X.roughness.value=H.roughness,H.roughnessMap&&(X.roughnessMap.value=H.roughnessMap,t(H.roughnessMap,X.roughnessMapTransform)),H.envMap&&(X.envMapIntensity.value=H.envMapIntensity)}function V(X,H,ge){X.ior.value=H.ior,H.sheen>0&&(X.sheenColor.value.copy(H.sheenColor).multiplyScalar(H.sheen),X.sheenRoughness.value=H.sheenRoughness,H.sheenColorMap&&(X.sheenColorMap.value=H.sheenColorMap,t(H.sheenColorMap,X.sheenColorMapTransform)),H.sheenRoughnessMap&&(X.sheenRoughnessMap.value=H.sheenRoughnessMap,t(H.sheenRoughnessMap,X.sheenRoughnessMapTransform))),H.clearcoat>0&&(X.clearcoat.value=H.clearcoat,X.clearcoatRoughness.value=H.clearcoatRoughness,H.clearcoatMap&&(X.clearcoatMap.value=H.clearcoatMap,t(H.clearcoatMap,X.clearcoatMapTransform)),H.clearcoatRoughnessMap&&(X.clearcoatRoughnessMap.value=H.clearcoatRoughnessMap,t(H.clearcoatRoughnessMap,X.clearcoatRoughnessMapTransform)),H.clearcoatNormalMap&&(X.clearcoatNormalMap.value=H.clearcoatNormalMap,t(H.clearcoatNormalMap,X.clearcoatNormalMapTransform),X.clearcoatNormalScale.value.copy(H.clearcoatNormalScale),H.side===C&&X.clearcoatNormalScale.value.negate())),H.dispersion>0&&(X.dispersion.value=H.dispersion),H.iridescence>0&&(X.iridescence.value=H.iridescence,X.iridescenceIOR.value=H.iridescenceIOR,X.iridescenceThicknessMinimum.value=H.iridescenceThicknessRange[0],X.iridescenceThicknessMaximum.value=H.iridescenceThicknessRange[1],H.iridescenceMap&&(X.iridescenceMap.value=H.iridescenceMap,t(H.iridescenceMap,X.iridescenceMapTransform)),H.iridescenceThicknessMap&&(X.iridescenceThicknessMap.value=H.iridescenceThicknessMap,t(H.iridescenceThicknessMap,X.iridescenceThicknessMapTransform))),H.transmission>0&&(X.transmission.value=H.transmission,X.transmissionSamplerMap.value=ge.texture,X.transmissionSamplerSize.value.set(ge.width,ge.height),H.transmissionMap&&(X.transmissionMap.value=H.transmissionMap,t(H.transmissionMap,X.transmissionMapTransform)),X.thickness.value=H.thickness,H.thicknessMap&&(X.thicknessMap.value=H.thicknessMap,t(H.thicknessMap,X.thicknessMapTransform)),X.attenuationDistance.value=H.attenuationDistance,X.attenuationColor.value.copy(H.attenuationColor)),H.anisotropy>0&&(X.anisotropyVector.value.set(H.anisotropy*Math.cos(H.anisotropyRotation),H.anisotropy*Math.sin(H.anisotropyRotation)),H.anisotropyMap&&(X.anisotropyMap.value=H.anisotropyMap,t(H.anisotropyMap,X.anisotropyMapTransform))),X.specularIntensity.value=H.specularIntensity,X.specularColor.value.copy(H.specularColor),H.specularColorMap&&(X.specularColorMap.value=H.specularColorMap,t(H.specularColorMap,X.specularColorMapTransform)),H.specularIntensityMap&&(X.specularIntensityMap.value=H.specularIntensityMap,t(H.specularIntensityMap,X.specularIntensityMapTransform))}function j(X,H){H.matcap&&(X.matcap.value=H.matcap)}function ie(X,H){const ge=e.get(H).light;X.referencePosition.value.setFromMatrixPosition(ge.matrixWorld),X.nearDistance.value=ge.shadow.camera.near,X.farDistance.value=ge.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function Y0(s,e,t,n){let i={},r={},o=[];const c=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function E(ge,pe){const de=pe.program;n.uniformBlockBinding(ge,de)}function x(ge,pe){let de=i[ge.id];de===void 0&&(j(ge),de=B(ge),i[ge.id]=de,ge.addEventListener("dispose",X));const We=pe.program;n.updateUBOMapping(ge,We);const Pe=e.render.frame;r[ge.id]!==Pe&&(U(ge),r[ge.id]=Pe)}function B(ge){const pe=P();ge.__bindingPointIndex=pe;const de=s.createBuffer(),We=ge.__size,Pe=ge.usage;return s.bindBuffer(s.UNIFORM_BUFFER,de),s.bufferData(s.UNIFORM_BUFFER,We,Pe),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,pe,de),de}function P(){for(let ge=0;ge<c;ge++)if(o.indexOf(ge)===-1)return o.push(ge),ge;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function U(ge){const pe=i[ge.id],de=ge.uniforms,We=ge.__cache;s.bindBuffer(s.UNIFORM_BUFFER,pe);for(let Pe=0,ke=de.length;Pe<ke;Pe++){const ze=Array.isArray(de[Pe])?de[Pe]:[de[Pe]];for(let Te=0,be=ze.length;Te<be;Te++){const je=ze[Te];if(V(je,Pe,Te,We)===!0){const nt=je.__offset,$e=Array.isArray(je.value)?je.value:[je.value];let rt=0;for(let mt=0;mt<$e.length;mt++){const Rt=$e[mt],ln=ie(Rt);typeof Rt=="number"||typeof Rt=="boolean"?(je.__data[0]=Rt,s.bufferSubData(s.UNIFORM_BUFFER,nt+rt,je.__data)):Rt.isMatrix3?(je.__data[0]=Rt.elements[0],je.__data[1]=Rt.elements[1],je.__data[2]=Rt.elements[2],je.__data[3]=0,je.__data[4]=Rt.elements[3],je.__data[5]=Rt.elements[4],je.__data[6]=Rt.elements[5],je.__data[7]=0,je.__data[8]=Rt.elements[6],je.__data[9]=Rt.elements[7],je.__data[10]=Rt.elements[8],je.__data[11]=0):(Rt.toArray(je.__data,rt),rt+=ln.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,nt,je.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function V(ge,pe,de,We){const Pe=ge.value,ke=pe+"_"+de;if(We[ke]===void 0)return typeof Pe=="number"||typeof Pe=="boolean"?We[ke]=Pe:We[ke]=Pe.clone(),!0;{const ze=We[ke];if(typeof Pe=="number"||typeof Pe=="boolean"){if(ze!==Pe)return We[ke]=Pe,!0}else if(ze.equals(Pe)===!1)return ze.copy(Pe),!0}return!1}function j(ge){const pe=ge.uniforms;let de=0;const We=16;for(let ke=0,ze=pe.length;ke<ze;ke++){const Te=Array.isArray(pe[ke])?pe[ke]:[pe[ke]];for(let be=0,je=Te.length;be<je;be++){const nt=Te[be],$e=Array.isArray(nt.value)?nt.value:[nt.value];for(let rt=0,mt=$e.length;rt<mt;rt++){const Rt=$e[rt],ln=ie(Rt),vt=de%We;vt!==0&&We-vt<ln.boundary&&(de+=We-vt),nt.__data=new Float32Array(ln.storage/Float32Array.BYTES_PER_ELEMENT),nt.__offset=de,de+=ln.storage}}}const Pe=de%We;return Pe>0&&(de+=We-Pe),ge.__size=de,ge.__cache={},this}function ie(ge){const pe={boundary:0,storage:0};return typeof ge=="number"||typeof ge=="boolean"?(pe.boundary=4,pe.storage=4):ge.isVector2?(pe.boundary=8,pe.storage=8):ge.isVector3||ge.isColor?(pe.boundary=16,pe.storage=12):ge.isVector4?(pe.boundary=16,pe.storage=16):ge.isMatrix3?(pe.boundary=48,pe.storage=48):ge.isMatrix4?(pe.boundary=64,pe.storage=64):ge.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",ge),pe}function X(ge){const pe=ge.target;pe.removeEventListener("dispose",X);const de=o.indexOf(pe.__bindingPointIndex);o.splice(de,1),s.deleteBuffer(i[pe.id]),delete i[pe.id],delete r[pe.id]}function H(){for(const ge in i)s.deleteBuffer(i[ge]);o=[],i={},r={}}return{bind:E,update:x,dispose:H}}class q0{constructor(e={}){const{canvas:t=wl(),context:n=null,depth:i=!0,stencil:r=!1,alpha:o=!1,antialias:c=!1,premultipliedAlpha:E=!0,preserveDrawingBuffer:x=!1,powerPreference:B="default",failIfMajorPerformanceCaveat:P=!1,multiviewStereo:U=!1}=e;this.isWebGLRenderer=!0;let V;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");V=n.getContextAttributes().alpha}else V=o;const j=new Uint32Array(4),ie=new Int32Array(4);let X=null,H=null;const ge=[],pe=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Mn,this._useLegacyLights=!1,this.toneMapping=Zn,this.toneMappingExposure=1;const de=this;let We=!1,Pe=0,ke=0,ze=null,Te=-1,be=null;const je=new zi,nt=new zi;let $e=null;const rt=new Sn(0);let mt=0,Rt=t.width,ln=t.height,vt=1,en=null,rn=null;const Dn=new zi(0,0,Rt,ln),_i=new zi(0,0,Rt,ln);let er=!1;const Ar=new Ka;let qi=!1,ur=!1;const Nn=new On,Pt=new De,hn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function mn(){return ze===null?vt:1}let st=n;function Ot(Be,ot){return t.getContext(Be,ot)}try{const Be={alpha:!0,depth:i,stencil:r,antialias:c,premultipliedAlpha:E,preserveDrawingBuffer:x,powerPreference:B,failIfMajorPerformanceCaveat:P};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${u}`),t.addEventListener("webglcontextlost",sn,!1),t.addEventListener("webglcontextrestored",Hn,!1),t.addEventListener("webglcontextcreationerror",bn,!1),st===null){const ot="webgl2";if(st=Ot(ot,Be),st===null)throw Ot(ot)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Be){throw console.error("THREE.WebGLRenderer: "+Be.message),Be}let Tt,$t,Xt,Wt,gn,_n,li,di,Ji,_r,mr,Ve,we,xt,Dt,Qt,Ut,Vn,cn,Tn,rr,In,zn,Ci,ni;function Ye(){Tt=new og(st),Tt.init(),zn=new Td(st,Tt),$t=new eg(st,Tt,e,zn),Xt=new k0(st),Wt=new cg(st),gn=new S0,_n=new G0(st,Tt,Xt,gn,$t,zn,Wt),li=new ng(de),di=new sg(de),Ji=new qp(st),Ci=new Zm(st,Ji),_r=new ag(st,Ji,Wt,Ci),mr=new dg(st,_r,Ji,Wt),Tn=new hg(st,$t,_n),Qt=new tg(gn),Ve=new M0(de,li,di,Tt,$t,Ci,Qt),we=new X0(de,gn),xt=new I0,Dt=new O0(Tt),cn=new Jm(de,li,di,Xt,mr,V,E),Vn=new ug(de,Tt,st),Ut=new N0(de,mr,$t),ni=new Y0(st,Wt,$t,Xt),rr=new $m(st,Tt,Wt),In=new lg(st,Tt,Wt),Wt.programs=Ve.programs,de.capabilities=$t,de.extensions=Tt,de.properties=gn,de.renderLists=xt,de.shadowMap=Ut,de.state=Xt,de.info=Wt}Ye();const Kt=typeof navigator<"u"&&"xr"in navigator?new W0(de,st,Tt,U):new Rd(de);this.xr=Kt,this.getContext=function(){return st},this.getContextAttributes=function(){return st.getContextAttributes()},this.forceContextLoss=function(){const Be=Tt.get("WEBGL_lose_context");Be&&Be.loseContext()},this.forceContextRestore=function(){const Be=Tt.get("WEBGL_lose_context");Be&&Be.restoreContext()},this.getPixelRatio=function(){return vt},this.setPixelRatio=function(Be){Be!==void 0&&(vt=Be,this.setSize(Rt,ln,!1))},this.getSize=function(Be){return Be.set(Rt,ln)},this.setSize=function(Be,ot,gt=!0){if(Kt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Rt=Be,ln=ot,t.width=Math.floor(Be*vt),t.height=Math.floor(ot*vt),gt===!0&&(t.style.width=Be+"px",t.style.height=ot+"px"),this.setViewport(0,0,Be,ot)},this.getDrawingBufferSize=function(Be){return Be.set(Rt*vt,ln*vt).floor()},this.setDrawingBufferSize=function(Be,ot,gt){Rt=Be,ln=ot,vt=gt,t.width=Math.floor(Be*gt),t.height=Math.floor(ot*gt),this.setViewport(0,0,Be,ot)},this.getCurrentViewport=function(Be){return Be.copy(je)},this.getViewport=function(Be){return Be.copy(Dn)},this.setViewport=function(Be,ot,gt,dt){Be.isVector4?Dn.set(Be.x,Be.y,Be.z,Be.w):Dn.set(Be,ot,gt,dt),Xt.viewport(je.copy(Dn).multiplyScalar(vt).round())},this.getScissor=function(Be){return Be.copy(_i)},this.setScissor=function(Be,ot,gt,dt){Be.isVector4?_i.set(Be.x,Be.y,Be.z,Be.w):_i.set(Be,ot,gt,dt),Xt.scissor(nt.copy(_i).multiplyScalar(vt).round())},this.getScissorTest=function(){return er},this.setScissorTest=function(Be){Xt.setScissorTest(er=Be)},this.setOpaqueSort=function(Be){en=Be},this.setTransparentSort=function(Be){rn=Be},this.getClearColor=function(Be){return Be.copy(cn.getClearColor())},this.setClearColor=function(){cn.setClearColor.apply(cn,arguments)},this.getClearAlpha=function(){return cn.getClearAlpha()},this.setClearAlpha=function(){cn.setClearAlpha.apply(cn,arguments)},this.clear=function(Be=!0,ot=!0,gt=!0){let dt=0;if(Be){let pt=!1;if(ze!==null){const En=ze.texture.format;pt=En===Rn||En===bt||En===yn}if(pt){const En=ze.texture.type,jn=En===$n||En===Sr||En===Er||En===Ur||En===sr||En===fs,Yn=cn.getClearColor(),ri=cn.getClearAlpha(),Ai=Yn.r,Mi=Yn.g,Ri=Yn.b;jn?(j[0]=Ai,j[1]=Mi,j[2]=Ri,j[3]=ri,st.clearBufferuiv(st.COLOR,0,j)):(ie[0]=Ai,ie[1]=Mi,ie[2]=Ri,ie[3]=ri,st.clearBufferiv(st.COLOR,0,ie))}else dt|=st.COLOR_BUFFER_BIT}ot&&(dt|=st.DEPTH_BUFFER_BIT),gt&&(dt|=st.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),st.clear(dt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",sn,!1),t.removeEventListener("webglcontextrestored",Hn,!1),t.removeEventListener("webglcontextcreationerror",bn,!1),xt.dispose(),Dt.dispose(),gn.dispose(),li.dispose(),di.dispose(),mr.dispose(),Ci.dispose(),ni.dispose(),Ve.dispose(),Kt.dispose(),Kt.removeEventListener("sessionstart",Xs),Kt.removeEventListener("sessionend",Ep),ta.stop()};function sn(Be){Be.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),We=!0}function Hn(){console.log("THREE.WebGLRenderer: Context Restored."),We=!1;const Be=Wt.autoReset,ot=Ut.enabled,gt=Ut.autoUpdate,dt=Ut.needsUpdate,pt=Ut.type;Ye(),Wt.autoReset=Be,Ut.enabled=ot,Ut.autoUpdate=gt,Ut.needsUpdate=dt,Ut.type=pt}function bn(Be){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Be.statusMessage)}function xi(Be){const ot=Be.target;ot.removeEventListener("dispose",xi),wn(ot)}function wn(Be){vn(Be),gn.remove(Be)}function vn(Be){const ot=gn.get(Be).programs;ot!==void 0&&(ot.forEach(function(gt){Ve.releaseProgram(gt)}),Be.isShaderMaterial&&Ve.releaseShaderCache(Be))}this.renderBufferDirect=function(Be,ot,gt,dt,pt,En){ot===null&&(ot=hn);const jn=pt.isMesh&&pt.matrixWorld.determinant()<0,Yn=zy(Be,ot,gt,dt,pt);Xt.setMaterial(dt,jn);let ri=gt.index,Ai=1;if(dt.wireframe===!0){if(ri=_r.getWireframeAttribute(gt),ri===void 0)return;Ai=2}const Mi=gt.drawRange,Ri=gt.attributes.position;let Pr=Mi.start*Ai,ss=(Mi.start+Mi.count)*Ai;En!==null&&(Pr=Math.max(Pr,En.start*Ai),ss=Math.min(ss,(En.start+En.count)*Ai)),ri!==null?(Pr=Math.max(Pr,0),ss=Math.min(ss,ri.count)):Ri!=null&&(Pr=Math.max(Pr,0),ss=Math.min(ss,Ri.count));const Ss=ss-Pr;if(Ss<0||Ss===1/0)return;Ci.setup(pt,dt,Yn,gt,ri);let To,tr=rr;if(ri!==null&&(To=Ji.get(ri),tr=In,tr.setIndex(To)),pt.isMesh)dt.wireframe===!0?(Xt.setLineWidth(dt.wireframeLinewidth*mn()),tr.setMode(st.LINES)):tr.setMode(st.TRIANGLES);else if(pt.isLine){let lo=dt.linewidth;lo===void 0&&(lo=1),Xt.setLineWidth(lo*mn()),pt.isLineSegments?tr.setMode(st.LINES):pt.isLineLoop?tr.setMode(st.LINE_LOOP):tr.setMode(st.LINE_STRIP)}else pt.isPoints?tr.setMode(st.POINTS):pt.isSprite&&tr.setMode(st.TRIANGLES);if(pt.isBatchedMesh)pt._multiDrawInstances!==null?tr.renderMultiDrawInstances(pt._multiDrawStarts,pt._multiDrawCounts,pt._multiDrawCount,pt._multiDrawInstances):tr.renderMultiDraw(pt._multiDrawStarts,pt._multiDrawCounts,pt._multiDrawCount);else if(pt.isInstancedMesh)tr.renderInstances(Pr,Ss,pt.count);else if(gt.isInstancedBufferGeometry){const lo=gt._maxInstanceCount!==void 0?gt._maxInstanceCount:1/0,Bi=Math.min(gt.instanceCount,lo);tr.renderInstances(Pr,Ss,Bi)}else tr.render(Pr,Ss)};function Ii(Be,ot,gt){Be.transparent===!0&&Be.side===S&&Be.forceSinglePass===!1?(Be.side=C,Be.needsUpdate=!0,Wc(Be,ot,gt),Be.side=p,Be.needsUpdate=!0,Wc(Be,ot,gt),Be.side=S):Wc(Be,ot,gt)}this.compile=function(Be,ot,gt=null){gt===null&&(gt=Be),H=Dt.get(gt),H.init(ot),pe.push(H),gt.traverseVisible(function(pt){pt.isLight&&pt.layers.test(ot.layers)&&(H.pushLight(pt),pt.castShadow&&H.pushShadow(pt))}),Be!==gt&&Be.traverseVisible(function(pt){pt.isLight&&pt.layers.test(ot.layers)&&(H.pushLight(pt),pt.castShadow&&H.pushShadow(pt))}),H.setupLights(de._useLegacyLights);const dt=new Set;return Be.traverse(function(pt){const En=pt.material;if(En)if(Array.isArray(En))for(let jn=0;jn<En.length;jn++){const Yn=En[jn];Ii(Yn,gt,pt),dt.add(Yn)}else Ii(En,gt,pt),dt.add(En)}),pe.pop(),H=null,dt},this.compileAsync=function(Be,ot,gt=null){const dt=this.compile(Be,ot,gt);return new Promise(pt=>{function En(){if(dt.forEach(function(jn){gn.get(jn).currentProgram.isReady()&&dt.delete(jn)}),dt.size===0){pt(Be);return}setTimeout(En,10)}Tt.get("KHR_parallel_shader_compile")!==null?En():setTimeout(En,10)})};let ii=null;function Hr(Be){ii&&ii(Be)}function Xs(){ta.stop()}function Ep(){ta.start()}const ta=new Lh;ta.setAnimationLoop(Hr),typeof self<"u"&&ta.setContext(self),this.setAnimationLoop=function(Be){ii=Be,Kt.setAnimationLoop(Be),Be===null?ta.stop():ta.start()},Kt.addEventListener("sessionstart",Xs),Kt.addEventListener("sessionend",Ep),this.render=function(Be,ot){if(ot!==void 0&&ot.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(We===!0)return;Be.matrixWorldAutoUpdate===!0&&Be.updateMatrixWorld(),ot.parent===null&&ot.matrixWorldAutoUpdate===!0&&ot.updateMatrixWorld(),Kt.enabled===!0&&Kt.isPresenting===!0&&(Kt.cameraAutoUpdate===!0&&Kt.updateCamera(ot),ot=Kt.getCamera()),Be.isScene===!0&&Be.onBeforeRender(de,Be,ot,ze),H=Dt.get(Be,pe.length),H.init(ot),pe.push(H),Nn.multiplyMatrices(ot.projectionMatrix,ot.matrixWorldInverse),Ar.setFromProjectionMatrix(Nn),ur=this.localClippingEnabled,qi=Qt.init(this.clippingPlanes,ur),X=xt.get(Be,ge.length),X.init(),ge.push(X),Cp(Be,ot,0,de.sortObjects),X.finish(),de.sortObjects===!0&&X.sort(en,rn);const gt=Kt.enabled===!1||Kt.isPresenting===!1||Kt.hasDepthSensing()===!1;gt&&cn.addToRenderList(X,Be),this.info.render.frame++,qi===!0&&Qt.beginShadows();const dt=H.state.shadowsArray;Ut.render(dt,Be,ot),qi===!0&&Qt.endShadows(),this.info.autoReset===!0&&this.info.reset();const pt=X.opaque,En=X.transmissive;if(H.setupLights(de._useLegacyLights),ot.isArrayCamera){const jn=ot.cameras;if(En.length>0)for(let Yn=0,ri=jn.length;Yn<ri;Yn++){const Ai=jn[Yn];xp(pt,En,Be,Ai)}if(gt&&cn.render(Be),Kt.enabled&&Kt.isMultiview)_n.setDeferTextureUploads(!0),Lu(X,Be,ot,ot.cameras[0].viewport);else for(let Yn=0,ri=jn.length;Yn<ri;Yn++){const Ai=jn[Yn];Lu(X,Be,Ai,Ai.viewport)}}else En.length>0&&xp(pt,En,Be,ot),gt&&cn.render(Be),Lu(X,Be,ot);ze!==null&&(_n.updateMultisampleRenderTarget(ze),_n.updateRenderTargetMipmap(ze)),Be.isScene===!0&&Be.onAfterRender(de,Be,ot),_n.runDeferredUploads(),Kt.enabled&&Kt.submitFrame&&Kt.submitFrame(),Ci.resetDefaultState(),Te=-1,be=null,pe.pop(),pe.length>0?(H=pe[pe.length-1],qi===!0&&Qt.setGlobalState(de.clippingPlanes,H.state.camera)):H=null,ge.pop(),ge.length>0?X=ge[ge.length-1]:X=null};function Cp(Be,ot,gt,dt){if(Be.visible===!1)return;if(Be.layers.test(ot.layers)){if(Be.isGroup)gt=Be.renderOrder;else if(Be.isLOD)Be.autoUpdate===!0&&Be.update(ot);else if(Be.isLight)H.pushLight(Be),Be.castShadow&&H.pushShadow(Be);else if(Be.isSprite){if(!Be.frustumCulled||Ar.intersectsSprite(Be)){dt&&Pt.setFromMatrixPosition(Be.matrixWorld).applyMatrix4(Nn);const jn=mr.update(Be),Yn=Be.material;Yn.visible&&X.push(Be,jn,Yn,gt,Pt.z,null)}}else if((Be.isMesh||Be.isLine||Be.isPoints)&&(!Be.frustumCulled||Ar.intersectsObject(Be))){const jn=mr.update(Be),Yn=Be.material;if(dt&&(Be.boundingSphere!==void 0?(Be.boundingSphere===null&&Be.computeBoundingSphere(),Pt.copy(Be.boundingSphere.center)):(jn.boundingSphere===null&&jn.computeBoundingSphere(),Pt.copy(jn.boundingSphere.center)),Pt.applyMatrix4(Be.matrixWorld).applyMatrix4(Nn)),Array.isArray(Yn)){const ri=jn.groups;for(let Ai=0,Mi=ri.length;Ai<Mi;Ai++){const Ri=ri[Ai],Pr=Yn[Ri.materialIndex];Pr&&Pr.visible&&X.push(Be,jn,Pr,gt,Pt.z,Ri)}}else Yn.visible&&X.push(Be,jn,Yn,gt,Pt.z,null)}}const En=Be.children;for(let jn=0,Yn=En.length;jn<Yn;jn++)Cp(En[jn],ot,gt,dt)}function Lu(Be,ot,gt,dt){const pt=Be.opaque,En=Be.transmissive,jn=Be.transparent;H.setupLightsView(gt),qi===!0&&Qt.setGlobalState(de.clippingPlanes,gt),dt&&Xt.viewport(je.copy(dt)),pt.length>0&&jc(pt,ot,gt),En.length>0&&jc(En,ot,gt),jn.length>0&&jc(jn,ot,gt),Xt.buffers.depth.setTest(!0),Xt.buffers.depth.setMask(!0),Xt.buffers.color.setMask(!0),Xt.setPolygonOffset(!1)}function xp(Be,ot,gt,dt){if((gt.isScene===!0?gt.overrideMaterial:null)!==null)return;H.state.transmissionRenderTarget[dt.id]===void 0&&(H.state.transmissionRenderTarget[dt.id]=new As(1,1,{generateMipmaps:!0,type:Tt.has("EXT_color_buffer_half_float")||Tt.has("EXT_color_buffer_float")?Li:$n,minFilter:Oi,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const En=H.state.transmissionRenderTarget[dt.id],jn=dt.viewport||je;En.setSize(jn.z,jn.w);const Yn=de.getRenderTarget();de.setRenderTarget(En),de.getClearColor(rt),mt=de.getClearAlpha(),mt<1&&de.setClearColor(16777215,.5),de.clear();const ri=de.toneMapping;de.toneMapping=Zn;const Ai=dt.viewport;if(dt.viewport!==void 0&&(dt.viewport=void 0),H.setupLightsView(dt),qi===!0&&Qt.setGlobalState(de.clippingPlanes,dt),jc(Be,gt,dt),_n.updateMultisampleRenderTarget(En),_n.updateRenderTargetMipmap(En),Tt.has("WEBGL_multisampled_render_to_texture")===!1){let Mi=!1;for(let Ri=0,Pr=ot.length;Ri<Pr;Ri++){const ss=ot[Ri],Ss=ss.object,To=ss.geometry,tr=ss.material,lo=ss.group;if(tr.side===S&&Ss.layers.test(dt.layers)){const Bi=tr.side;tr.side=C,tr.needsUpdate=!0,bp(Ss,gt,dt,To,tr,lo),tr.side=Bi,tr.needsUpdate=!0,Mi=!0}}Mi===!0&&(_n.updateMultisampleRenderTarget(En),_n.updateRenderTargetMipmap(En))}de.setRenderTarget(Yn),de.setClearColor(rt,mt),Ai!==void 0&&(dt.viewport=Ai),de.toneMapping=ri}function jc(Be,ot,gt){const dt=ot.isScene===!0?ot.overrideMaterial:null;for(let pt=0,En=Be.length;pt<En;pt++){const jn=Be[pt],Yn=jn.object,ri=jn.geometry,Ai=dt===null?jn.material:dt,Mi=jn.group;Yn.layers.test(gt.layers)&&bp(Yn,ot,gt,ri,Ai,Mi)}}function bp(Be,ot,gt,dt,pt,En){Be.onBeforeRender(de,ot,gt,dt,pt,En),Be.modelViewMatrix.multiplyMatrices(gt.matrixWorldInverse,Be.matrixWorld),Be.normalMatrix.getNormalMatrix(Be.modelViewMatrix),pt.onBeforeRender(de,ot,gt,dt,Be,En),pt.transparent===!0&&pt.side===S&&pt.forceSinglePass===!1?(pt.side=C,pt.needsUpdate=!0,de.renderBufferDirect(gt,ot,dt,pt,Be,En),pt.side=p,pt.needsUpdate=!0,de.renderBufferDirect(gt,ot,dt,pt,Be,En),pt.side=S):de.renderBufferDirect(gt,ot,dt,pt,Be,En),Be.onAfterRender(de,ot,gt,dt,pt,En)}function Wc(Be,ot,gt){ot.isScene!==!0&&(ot=hn);const dt=gn.get(Be),pt=H.state.lights,En=H.state.shadowsArray,jn=pt.state.version,Yn=Ve.getParameters(Be,pt.state,En,ot,gt),ri=Ve.getProgramCacheKey(Yn);let Ai=dt.programs;dt.environment=Be.isMeshStandardMaterial?ot.environment:null,dt.fog=ot.fog,dt.envMap=(Be.isMeshStandardMaterial?di:li).get(Be.envMap||dt.environment),dt.envMapRotation=dt.environment!==null&&Be.envMap===null?ot.environmentRotation:Be.envMapRotation,Ai===void 0&&(Be.addEventListener("dispose",xi),Ai=new Map,dt.programs=Ai);let Mi=Ai.get(ri);if(Mi!==void 0){if(dt.currentProgram===Mi&&dt.lightsStateVersion===jn)return _p(Be,Yn),Mi}else Yn.uniforms=Ve.getUniforms(Be),Be.onBuild(gt,Yn,de),Be.onBeforeCompile(Yn,de),Mi=Ve.acquireProgram(Yn,ri),Ai.set(ri,Mi),dt.uniforms=Yn.uniforms;const Ri=dt.uniforms;return(!Be.isShaderMaterial&&!Be.isRawShaderMaterial||Be.clipping===!0)&&(Ri.clippingPlanes=Qt.uniform),_p(Be,Yn),dt.needsLights=Wy(Be),dt.lightsStateVersion=jn,dt.needsLights&&(Ri.ambientLightColor.value=pt.state.ambient,Ri.lightProbe.value=pt.state.probe,Ri.directionalLights.value=pt.state.directional,Ri.directionalLightShadows.value=pt.state.directionalShadow,Ri.spotLights.value=pt.state.spot,Ri.spotLightShadows.value=pt.state.spotShadow,Ri.rectAreaLights.value=pt.state.rectArea,Ri.ltc_1.value=pt.state.rectAreaLTC1,Ri.ltc_2.value=pt.state.rectAreaLTC2,Ri.pointLights.value=pt.state.point,Ri.pointLightShadows.value=pt.state.pointShadow,Ri.hemisphereLights.value=pt.state.hemi,Ri.directionalShadowMap.value=pt.state.directionalShadowMap,Ri.directionalShadowMatrix.value=pt.state.directionalShadowMatrix,Ri.spotShadowMap.value=pt.state.spotShadowMap,Ri.spotLightMatrix.value=pt.state.spotLightMatrix,Ri.spotLightMap.value=pt.state.spotLightMap,Ri.pointShadowMap.value=pt.state.pointShadowMap,Ri.pointShadowMatrix.value=pt.state.pointShadowMatrix),dt.currentProgram=Mi,dt.uniformsList=null,Mi}function wp(Be){if(Be.uniformsList===null){const ot=Be.currentProgram.getUniforms();Be.uniformsList=ql.seqWithValue(ot.seq,Be.uniforms)}return Be.uniformsList}function _p(Be,ot){const gt=gn.get(Be);gt.outputColorSpace=ot.outputColorSpace,gt.batching=ot.batching,gt.instancing=ot.instancing,gt.instancingColor=ot.instancingColor,gt.instancingMorph=ot.instancingMorph,gt.skinning=ot.skinning,gt.morphTargets=ot.morphTargets,gt.morphNormals=ot.morphNormals,gt.morphColors=ot.morphColors,gt.morphTargetsCount=ot.morphTargetsCount,gt.numClippingPlanes=ot.numClippingPlanes,gt.numIntersection=ot.numClipIntersection,gt.vertexAlphas=ot.vertexAlphas,gt.vertexTangents=ot.vertexTangents,gt.toneMapping=ot.toneMapping,gt.numMultiviewViews=ot.numMultiviewViews}function zy(Be,ot,gt,dt,pt){ot.isScene!==!0&&(ot=hn),_n.resetTextureUnits();const En=ot.fog,jn=dt.isMeshStandardMaterial?ot.environment:null,Yn=ze===null?de.outputColorSpace:ze.isXRRenderTarget===!0?ze.texture.colorSpace:ai,ri=(dt.isMeshStandardMaterial?di:li).get(dt.envMap||jn),Ai=dt.vertexColors===!0&&!!gt.attributes.color&&gt.attributes.color.itemSize===4,Mi=!!gt.attributes.tangent&&(!!dt.normalMap||dt.anisotropy>0),Ri=!!gt.morphAttributes.position,Pr=!!gt.morphAttributes.normal,ss=!!gt.morphAttributes.color;let Ss=Zn;dt.toneMapped&&(ze===null||ze.isXRRenderTarget===!0)&&(Ss=de.toneMapping);const To=ze&&ze.isWebGLMultiviewRenderTarget?ze.numViews:0,tr=gt.morphAttributes.position||gt.morphAttributes.normal||gt.morphAttributes.color,lo=tr!==void 0?tr.length:0,Bi=gn.get(dt),Ky=H.state.lights;if(qi===!0&&(ur===!0||Be!==be)){const Ls=Be===be&&dt.id===Te;Qt.setState(dt,Be,Ls)}let vr=!1;dt.version===Bi.__version?(Bi.needsLights&&Bi.lightsStateVersion!==Ky.state.version||Bi.outputColorSpace!==Yn||pt.isBatchedMesh&&Bi.batching===!1||!pt.isBatchedMesh&&Bi.batching===!0||pt.isInstancedMesh&&Bi.instancing===!1||!pt.isInstancedMesh&&Bi.instancing===!0||pt.isSkinnedMesh&&Bi.skinning===!1||!pt.isSkinnedMesh&&Bi.skinning===!0||pt.isInstancedMesh&&Bi.instancingColor===!0&&pt.instanceColor===null||pt.isInstancedMesh&&Bi.instancingColor===!1&&pt.instanceColor!==null||pt.isInstancedMesh&&Bi.instancingMorph===!0&&pt.morphTexture===null||pt.isInstancedMesh&&Bi.instancingMorph===!1&&pt.morphTexture!==null||Bi.envMap!==ri||dt.fog===!0&&Bi.fog!==En||Bi.numClippingPlanes!==void 0&&(Bi.numClippingPlanes!==Qt.numPlanes||Bi.numIntersection!==Qt.numIntersection)||Bi.vertexAlphas!==Ai||Bi.vertexTangents!==Mi||Bi.morphTargets!==Ri||Bi.morphNormals!==Pr||Bi.morphColors!==ss||Bi.toneMapping!==Ss||Bi.morphTargetsCount!==lo||Bi.numMultiviewViews!==To)&&(vr=!0):(vr=!0,Bi.__version=dt.version);let co=Bi.currentProgram;vr===!0&&(co=Wc(dt,ot,pt));let Mp=!1,gl=!1,Du=!1;const zr=co.getUniforms(),Io=Bi.uniforms;if(Xt.useProgram(co.program)&&(Mp=!0,gl=!0,Du=!0),dt.id!==Te&&(Te=dt.id,gl=!0),Mp||be!==Be){co.numMultiviewViews>0?(Vn.updateCameraProjectionMatricesUniform(Be,zr),Vn.updateCameraViewMatricesUniform(Be,zr)):(zr.setValue(st,"projectionMatrix",Be.projectionMatrix),zr.setValue(st,"viewMatrix",Be.matrixWorldInverse));const Ls=zr.map.cameraPosition;Ls!==void 0&&Ls.setValue(st,Pt.setFromMatrixPosition(Be.matrixWorld)),$t.logarithmicDepthBuffer&&zr.setValue(st,"logDepthBufFC",2/(Math.log(Be.far+1)/Math.LN2)),(dt.isMeshPhongMaterial||dt.isMeshToonMaterial||dt.isMeshLambertMaterial||dt.isMeshBasicMaterial||dt.isMeshStandardMaterial||dt.isShaderMaterial)&&zr.setValue(st,"isOrthographic",Be.isOrthographicCamera===!0),be!==Be&&(be=Be,gl=!0,Du=!0)}if(pt.isSkinnedMesh){zr.setOptional(st,pt,"bindMatrix"),zr.setOptional(st,pt,"bindMatrixInverse");const Ls=pt.skeleton;Ls&&(Ls.boneTexture===null&&Ls.computeBoneTexture(),zr.setValue(st,"boneTexture",Ls.boneTexture,_n))}pt.isBatchedMesh&&(zr.setOptional(st,pt,"batchingTexture"),zr.setValue(st,"batchingTexture",pt._matricesTexture,_n));const Pu=gt.morphAttributes;if((Pu.position!==void 0||Pu.normal!==void 0||Pu.color!==void 0)&&Tn.update(pt,gt,co),(gl||Bi.receiveShadow!==pt.receiveShadow)&&(Bi.receiveShadow=pt.receiveShadow,zr.setValue(st,"receiveShadow",pt.receiveShadow)),dt.isMeshGouraudMaterial&&dt.envMap!==null&&(Io.envMap.value=ri,Io.flipEnvMap.value=ri.isCubeTexture&&ri.isRenderTargetTexture===!1?-1:1),dt.isMeshStandardMaterial&&dt.envMap===null&&ot.environment!==null&&(Io.envMapIntensity.value=ot.environmentIntensity),gl&&(zr.setValue(st,"toneMappingExposure",de.toneMappingExposure),Bi.needsLights&&jy(Io,Du),En&&dt.fog===!0&&we.refreshFogUniforms(Io,En),we.refreshMaterialUniforms(Io,dt,vt,ln,H.state.transmissionRenderTarget[Be.id]),ql.upload(st,wp(Bi),Io,_n)),dt.isShaderMaterial&&dt.uniformsNeedUpdate===!0&&(ql.upload(st,wp(Bi),Io,_n),dt.uniformsNeedUpdate=!1),dt.isSpriteMaterial&&zr.setValue(st,"center",pt.center),co.numMultiviewViews>0?Vn.updateObjectMatricesUniforms(pt,Be,zr):(zr.setValue(st,"modelViewMatrix",pt.modelViewMatrix),zr.setValue(st,"normalMatrix",pt.normalMatrix)),zr.setValue(st,"modelMatrix",pt.matrixWorld),dt.isShaderMaterial||dt.isRawShaderMaterial){const Ls=dt.uniformsGroups;for(let Ou=0,Xy=Ls.length;Ou<Xy;Ou++){const Sp=Ls[Ou];ni.update(Sp,co),ni.bind(Sp,co)}}return co}function jy(Be,ot){Be.ambientLightColor.needsUpdate=ot,Be.lightProbe.needsUpdate=ot,Be.directionalLights.needsUpdate=ot,Be.directionalLightShadows.needsUpdate=ot,Be.pointLights.needsUpdate=ot,Be.pointLightShadows.needsUpdate=ot,Be.spotLights.needsUpdate=ot,Be.spotLightShadows.needsUpdate=ot,Be.rectAreaLights.needsUpdate=ot,Be.hemisphereLights.needsUpdate=ot}function Wy(Be){return Be.isMeshLambertMaterial||Be.isMeshToonMaterial||Be.isMeshPhongMaterial||Be.isMeshStandardMaterial||Be.isShadowMaterial||Be.isShaderMaterial&&Be.lights===!0}this.setTexture2D=function(){var Be=!1;return function(gt,dt){gt&&gt.isWebGLRenderTarget&&(Be||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),Be=!0),gt=gt.texture),_n.setTexture2D(gt,dt)}}(),this.getActiveCubeFace=function(){return Pe},this.getActiveMipmapLevel=function(){return ke},this.getRenderTarget=function(){return ze},this.setRenderTargetTextures=function(Be,ot,gt){gn.get(Be.texture).__webglTexture=ot,gn.get(Be.depthTexture).__webglTexture=gt;const dt=gn.get(Be);dt.__hasExternalTextures=!0,dt.__autoAllocateDepthBuffer=gt===void 0,!dt.__autoAllocateDepthBuffer&&(!ze||!ze.isWebGLMultiviewRenderTarget)&&Tt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),dt.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Be,ot){const gt=gn.get(Be);gt.__webglFramebuffer=ot,gt.__useDefaultFramebuffer=ot===void 0},this.setRenderTarget=function(Be,ot=0,gt=0){ze=Be,Pe=ot,ke=gt;let dt=!0,pt=null,En=!1,jn=!1;if(Be){const ri=gn.get(Be);ri.__useDefaultFramebuffer!==void 0?(Xt.bindFramebuffer(st.FRAMEBUFFER,null),dt=!1):ri.__webglFramebuffer===void 0?_n.setupRenderTarget(Be):ri.__hasExternalTextures&&_n.rebindTextures(Be,gn.get(Be.texture).__webglTexture,gn.get(Be.depthTexture).__webglTexture);const Ai=Be.texture;(Ai.isData3DTexture||Ai.isDataArrayTexture||Ai.isCompressedArrayTexture)&&(jn=!0);const Mi=gn.get(Be).__webglFramebuffer;Be.isWebGLCubeRenderTarget?(Array.isArray(Mi[ot])?pt=Mi[ot][gt]:pt=Mi[ot],En=!0):Be.samples>0&&_n.useMultisampledRTT(Be)===!1?pt=gn.get(Be).__webglMultisampledFramebuffer:Array.isArray(Mi)?pt=Mi[gt]:pt=Mi,je.copy(Be.viewport),nt.copy(Be.scissor),$e=Be.scissorTest}else je.copy(Dn).multiplyScalar(vt).floor(),nt.copy(_i).multiplyScalar(vt).floor(),$e=er;if(Xt.bindFramebuffer(st.FRAMEBUFFER,pt)&&dt&&Xt.drawBuffers(Be,pt),Xt.viewport(je),Xt.scissor(nt),Xt.setScissorTest($e),En){const ri=gn.get(Be.texture);st.framebufferTexture2D(st.FRAMEBUFFER,st.COLOR_ATTACHMENT0,st.TEXTURE_CUBE_MAP_POSITIVE_X+ot,ri.__webglTexture,gt)}else if(jn){const ri=gn.get(Be.texture),Ai=ot||0;st.framebufferTextureLayer(st.FRAMEBUFFER,st.COLOR_ATTACHMENT0,ri.__webglTexture,gt||0,Ai)}Te=-1},this.readRenderTargetPixels=function(Be,ot,gt,dt,pt,En,jn){if(!(Be&&Be.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Yn=gn.get(Be).__webglFramebuffer;if(Be.isWebGLCubeRenderTarget&&jn!==void 0&&(Yn=Yn[jn]),Yn){Xt.bindFramebuffer(st.FRAMEBUFFER,Yn);try{const ri=Be.texture,Ai=ri.format,Mi=ri.type;if(!$t.textureFormatReadable(Ai)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!$t.textureTypeReadable(Mi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ot>=0&&ot<=Be.width-dt&&gt>=0&&gt<=Be.height-pt&&st.readPixels(ot,gt,dt,pt,zn.convert(Ai),zn.convert(Mi),En)}finally{const ri=ze!==null?gn.get(ze).__webglFramebuffer:null;Xt.bindFramebuffer(st.FRAMEBUFFER,ri)}}},this.copyFramebufferToTexture=function(Be,ot,gt=0){const dt=Math.pow(2,-gt),pt=Math.floor(ot.image.width*dt),En=Math.floor(ot.image.height*dt);_n.setTexture2D(ot,0),st.copyTexSubImage2D(st.TEXTURE_2D,gt,0,0,Be.x,Be.y,pt,En),Xt.unbindTexture()},this.copyTextureToTexture=function(Be,ot,gt,dt=0){const pt=ot.image.width,En=ot.image.height,jn=zn.convert(gt.format),Yn=zn.convert(gt.type);_n.setTexture2D(gt,0),st.pixelStorei(st.UNPACK_FLIP_Y_WEBGL,gt.flipY),st.pixelStorei(st.UNPACK_PREMULTIPLY_ALPHA_WEBGL,gt.premultiplyAlpha),st.pixelStorei(st.UNPACK_ALIGNMENT,gt.unpackAlignment),ot.isDataTexture?st.texSubImage2D(st.TEXTURE_2D,dt,Be.x,Be.y,pt,En,jn,Yn,ot.image.data):ot.isCompressedTexture?st.compressedTexSubImage2D(st.TEXTURE_2D,dt,Be.x,Be.y,ot.mipmaps[0].width,ot.mipmaps[0].height,jn,ot.mipmaps[0].data):st.texSubImage2D(st.TEXTURE_2D,dt,Be.x,Be.y,jn,Yn,ot.image),dt===0&&gt.generateMipmaps&&st.generateMipmap(st.TEXTURE_2D),Xt.unbindTexture()},this.copyTextureToTexture3D=function(Be,ot,gt,dt,pt=0){const En=Be.max.x-Be.min.x,jn=Be.max.y-Be.min.y,Yn=Be.max.z-Be.min.z,ri=zn.convert(dt.format),Ai=zn.convert(dt.type);let Mi;if(dt.isData3DTexture)_n.setTexture3D(dt,0),Mi=st.TEXTURE_3D;else if(dt.isDataArrayTexture||dt.isCompressedArrayTexture)_n.setTexture2DArray(dt,0),Mi=st.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}st.pixelStorei(st.UNPACK_FLIP_Y_WEBGL,dt.flipY),st.pixelStorei(st.UNPACK_PREMULTIPLY_ALPHA_WEBGL,dt.premultiplyAlpha),st.pixelStorei(st.UNPACK_ALIGNMENT,dt.unpackAlignment);const Ri=st.getParameter(st.UNPACK_ROW_LENGTH),Pr=st.getParameter(st.UNPACK_IMAGE_HEIGHT),ss=st.getParameter(st.UNPACK_SKIP_PIXELS),Ss=st.getParameter(st.UNPACK_SKIP_ROWS),To=st.getParameter(st.UNPACK_SKIP_IMAGES),tr=gt.isCompressedTexture?gt.mipmaps[pt]:gt.image;st.pixelStorei(st.UNPACK_ROW_LENGTH,tr.width),st.pixelStorei(st.UNPACK_IMAGE_HEIGHT,tr.height),st.pixelStorei(st.UNPACK_SKIP_PIXELS,Be.min.x),st.pixelStorei(st.UNPACK_SKIP_ROWS,Be.min.y),st.pixelStorei(st.UNPACK_SKIP_IMAGES,Be.min.z),gt.isDataTexture||gt.isData3DTexture?st.texSubImage3D(Mi,pt,ot.x,ot.y,ot.z,En,jn,Yn,ri,Ai,tr.data):dt.isCompressedArrayTexture?st.compressedTexSubImage3D(Mi,pt,ot.x,ot.y,ot.z,En,jn,Yn,ri,tr.data):st.texSubImage3D(Mi,pt,ot.x,ot.y,ot.z,En,jn,Yn,ri,Ai,tr),st.pixelStorei(st.UNPACK_ROW_LENGTH,Ri),st.pixelStorei(st.UNPACK_IMAGE_HEIGHT,Pr),st.pixelStorei(st.UNPACK_SKIP_PIXELS,ss),st.pixelStorei(st.UNPACK_SKIP_ROWS,Ss),st.pixelStorei(st.UNPACK_SKIP_IMAGES,To),pt===0&&dt.generateMipmaps&&st.generateMipmap(Mi),Xt.unbindTexture()},this.initTexture=function(Be){Be.isCubeTexture?_n.setTextureCube(Be,0):Be.isData3DTexture?_n.setTexture3D(Be,0):Be.isDataArrayTexture||Be.isCompressedArrayTexture?_n.setTexture2DArray(Be,0):_n.setTexture2D(Be,0),Xt.unbindTexture()},this.resetState=function(){Pe=0,ke=0,ze=null,Xt.reset(),Ci.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Is}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===qn?"display-p3":"srgb",t.unpackColorSpace=$i.workingColorSpace===Un?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class Jl{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Sn(e),this.density=t}clone(){return new Jl(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Zl{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Sn(e),this.near=t,this.far=n}clone(){return new Zl(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Dd extends Yi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ws,this.environmentIntensity=1,this.environmentRotation=new ws,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class $l{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Ro,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ls()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Ml("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ls()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ls()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const us=new De;class Ho{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)us.fromBufferAttribute(this,t),us.applyMatrix4(e),this.setXYZ(t,us.x,us.y,us.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)us.fromBufferAttribute(this,t),us.applyNormalMatrix(e),this.setXYZ(t,us.x,us.y,us.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)us.fromBufferAttribute(this,t),us.transformDirection(e),this.setXYZ(t,us.x,us.y,us.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Zr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ui(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Zr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Zr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Zr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Zr(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),i=ui(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),i=ui(i,this.array),r=ui(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return new lr(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ho(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Kh extends is{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Sn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ma;const Ya=new De,Sa=new De,Ta=new De,Ia=new Lt,qa=new Lt,Pd=new On,ec=new De,Ja=new De,tc=new De,Od=new Lt,Xh=new Lt,Fd=new Lt;class Ud extends Yi{constructor(e=new Kh){if(super(),this.isSprite=!0,this.type="Sprite",Ma===void 0){Ma=new wi;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new $l(t,5);Ma.setIndex([0,1,2,0,2,3]),Ma.setAttribute("position",new Ho(n,3,0,!1)),Ma.setAttribute("uv",new Ho(n,2,3,!1))}this.geometry=Ma,this.material=e,this.center=new Lt(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Sa.setFromMatrixScale(this.matrixWorld),Pd.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ta.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Sa.multiplyScalar(-Ta.z);const n=this.material.rotation;let i,r;n!==0&&(r=Math.cos(n),i=Math.sin(n));const o=this.center;nc(ec.set(-.5,-.5,0),Ta,o,Sa,i,r),nc(Ja.set(.5,-.5,0),Ta,o,Sa,i,r),nc(tc.set(.5,.5,0),Ta,o,Sa,i,r),Od.set(0,0),Xh.set(1,0),Fd.set(1,1);let c=e.ray.intersectTriangle(ec,Ja,tc,!1,Ya);if(c===null&&(nc(Ja.set(-.5,.5,0),Ta,o,Sa,i,r),Xh.set(0,1),c=e.ray.intersectTriangle(ec,tc,Ja,!1,Ya),c===null))return;const E=e.ray.origin.distanceTo(Ya);E<e.near||E>e.far||t.push({distance:E,point:Ya.clone(),uv:_s.getInterpolation(Ya,ec,Ja,tc,Od,Xh,Fd,new Lt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function nc(s,e,t,n,i,r){Ia.subVectors(s,t).addScalar(.5).multiply(n),i!==void 0?(qa.x=r*Ia.x-i*Ia.y,qa.y=i*Ia.x+r*Ia.y):qa.copy(Ia),s.copy(e),s.x+=qa.x,s.y+=qa.y,s.applyMatrix4(Pd)}const ic=new De,Nd=new De;class kd extends Yi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ic.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(ic);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ic.setFromMatrixPosition(e.matrixWorld),Nd.setFromMatrixPosition(this.matrixWorld);const n=ic.distanceTo(Nd)/e.zoom;t[0].object.visible=!0;let i,r;for(i=1,r=t.length;i<r;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),n>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const Gd=new De,Qd=new zi,Vd=new zi,J0=new De,Hd=new On,rc=new De,Yh=new Nr,zd=new On,qh=new kr;class jd extends Dr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Se,this.bindMatrix=new On,this.bindMatrixInverse=new On,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new br),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,rc),this.boundingBox.expandByPoint(rc)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Nr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,rc),this.boundingSphere.expandByPoint(rc)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Yh.copy(this.boundingSphere),Yh.applyMatrix4(i),e.ray.intersectsSphere(Yh)!==!1&&(zd.copy(i).invert(),qh.copy(e.ray).applyMatrix4(zd),!(this.boundingBox!==null&&qh.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,qh)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zi,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Se?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Re?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;Qd.fromBufferAttribute(i.attributes.skinIndex,e),Vd.fromBufferAttribute(i.attributes.skinWeight,e),Gd.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=Vd.getComponent(r);if(o!==0){const c=Qd.getComponent(r);Hd.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(J0.copy(Gd).applyMatrix4(Hd),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Jh extends Yi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class xo extends fr{constructor(e=null,t=1,n=1,i,r,o,c,E,x=Yt,B=Yt,P,U){super(null,o,c,E,x,B,i,r,P,U),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Wd=new On,Z0=new On;class sc{constructor(e=[],t=[]){this.uuid=ls(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new On)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new On;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const c=e[r]?e[r].matrixWorld:Z0;Wd.multiplyMatrices(c,t[r]),Wd.toArray(n,r*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new sc(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new xo(t,e,e,Ge,ir);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const r=e.bones[n];let o=t[r];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),o=new Jh),this.bones.push(o),this.boneInverses.push(new On().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const o=t[i];e.bones.push(o.uuid);const c=n[i];e.boneInverses.push(c.toArray())}return e}}class Ba extends lr{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ra=new On,Kd=new On,oc=[],Xd=new br,$0=new On,Za=new Dr,$a=new Nr;class Yd extends Dr{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ba(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,$0)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new br),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Ra),Xd.copy(e.boundingBox).applyMatrix4(Ra),this.boundingBox.union(Xd)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Nr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Ra),$a.copy(e.boundingSphere).applyMatrix4(Ra),this.boundingSphere.union($a)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,r=n.length+1,o=e*r+1;for(let c=0;c<n.length;c++)n[c]=i[o+c]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Za.geometry=this.geometry,Za.material=this.material,Za.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),$a.copy(this.boundingSphere),$a.applyMatrix4(n),e.ray.intersectsSphere($a)!==!1))for(let r=0;r<i;r++){this.getMatrixAt(r,Ra),Kd.multiplyMatrices(n,Ra),Za.matrixWorld=Kd,Za.raycast(e,oc);for(let o=0,c=oc.length;o<c;o++){const E=oc[o];E.instanceId=r,E.object=this,t.push(E)}oc.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Ba(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new xo(new Float32Array(i*this.count),i,this.count,Ft,ir));const r=this.morphTexture.source.data.data;let o=0;for(let x=0;x<n.length;x++)o+=n[x];const c=this.geometry.morphTargetsRelative?1:1-o,E=i*e;r[E]=c,r.set(n,E+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function ev(s,e){return s.z-e.z}function tv(s,e){return e.z-s.z}class nv{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const n=this.pool,i=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});const r=n[this.index];i.push(r),this.index++,r.start=e.start,r.count=e.count,r.z=t}reset(){this.list.length=0,this.index=0}}const La="batchId",bo=new On,qd=new On,iv=new On,Jd=new On,Zh=new Ka,ac=new br,zo=new Nr,el=new De,$h=new nv,rs=new Dr,lc=[];function rv(s,e,t=0){const n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){const i=s.count;for(let r=0;r<i;r++)for(let o=0;o<n;o++)e.setComponent(r+t,o,s.getComponent(r,o))}else e.array.set(s.array,t*n);e.needsUpdate=!0}class Zd extends Dr{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,n=t*2,i){super(new wi,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new xo(t,e,e,Ge,ir);this._matricesTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxGeometryCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const c in e.attributes){const E=e.getAttribute(c),{array:x,itemSize:B,normalized:P}=E,U=new x.constructor(n*B),V=new lr(U,B,P);t.setAttribute(c,V)}if(e.getIndex()!==null){const c=n>65536?new Uint32Array(r):new Uint16Array(r);t.setIndex(new lr(c,1))}const o=i>65536?new Uint32Array(n):new Uint16Array(n);t.setAttribute(La,new lr(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(La))throw new Error(`BatchedMesh: Geometry cannot use attribute "${La}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(n===La)continue;if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),r=t.getAttribute(n);if(i.itemSize!==r.itemSize||i.normalized!==r.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new br);const e=this._geometryCount,t=this.boundingBox,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)n[i]!==!1&&(this.getMatrixAt(i,bo),this.getBoundingBoxAt(i,ac).applyMatrix4(bo),t.union(ac))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Nr);const e=this._geometryCount,t=this.boundingSphere,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)n[i]!==!1&&(this.getMatrixAt(i,bo),this.getBoundingSphereAt(i,zo).applyMatrix4(bo),t.union(zo))}addGeometry(e,t=-1,n=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let r=null;const o=this._reservedRanges,c=this._drawRanges,E=this._bounds;this._geometryCount!==0&&(r=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,r===null?i.vertexStart=0:i.vertexStart=r.vertexStart+r.vertexCount;const x=e.getIndex(),B=x!==null;if(B&&(n===-1?i.indexCount=x.count:i.indexCount=n,r===null?i.indexStart=0:i.indexStart=r.indexStart+r.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const P=this._visibility,U=this._active,V=this._matricesTexture,j=this._matricesTexture.image.data;P.push(!0),U.push(!0);const ie=this._geometryCount;this._geometryCount++,iv.toArray(j,ie*16),V.needsUpdate=!0,o.push(i),c.push({start:B?i.indexStart:i.vertexStart,count:-1}),E.push({boxInitialized:!1,box:new br,sphereInitialized:!1,sphere:new Nr});const X=this.geometry.getAttribute(La);for(let H=0;H<i.vertexCount;H++)X.setX(i.vertexStart+H,ie);return X.needsUpdate=!0,this.setGeometryAt(ie,e),ie}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=n.getIndex()!==null,r=n.getIndex(),o=t.getIndex(),c=this._reservedRanges[e];if(i&&o.count>c.indexCount||t.attributes.position.count>c.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const E=c.vertexStart,x=c.vertexCount;for(const V in n.attributes){if(V===La)continue;const j=t.getAttribute(V),ie=n.getAttribute(V);rv(j,ie,E);const X=j.itemSize;for(let H=j.count,ge=x;H<ge;H++){const pe=E+H;for(let de=0;de<X;de++)ie.setComponent(pe,de,0)}ie.needsUpdate=!0,ie.addUpdateRange(E*X,x*X)}if(i){const V=c.indexStart;for(let j=0;j<o.count;j++)r.setX(V+j,E+o.getX(j));for(let j=o.count,ie=c.indexCount;j<ie;j++)r.setX(V+j,E);r.needsUpdate=!0,r.addUpdateRange(V,c.indexCount)}const B=this._bounds[e];t.boundingBox!==null?(B.box.copy(t.boundingBox),B.boxInitialized=!0):B.boxInitialized=!1,t.boundingSphere!==null?(B.sphere.copy(t.boundingSphere),B.sphereInitialized=!0):B.sphereInitialized=!1;const P=this._drawRanges[e],U=t.getAttribute("position");return P.count=i?o.count:U.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(e){return this._multiDrawInstances===null?null:this._multiDrawInstances[e]}setInstanceCountAt(e,t){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[e]=t,e}getBoundingBoxAt(e,t){if(this._active[e]===!1)return null;const i=this._bounds[e],r=i.box,o=this.geometry;if(i.boxInitialized===!1){r.makeEmpty();const c=o.index,E=o.attributes.position,x=this._drawRanges[e];for(let B=x.start,P=x.start+x.count;B<P;B++){let U=B;c&&(U=c.getX(U)),r.expandByPoint(el.fromBufferAttribute(E,U))}i.boxInitialized=!0}return t.copy(r),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return null;const i=this._bounds[e],r=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){r.makeEmpty(),this.getBoundingBoxAt(e,ac),ac.getCenter(r.center);const c=o.index,E=o.attributes.position,x=this._drawRanges[e];let B=0;for(let P=x.start,U=x.start+x.count;P<U;P++){let V=P;c&&(V=c.getX(V)),el.fromBufferAttribute(E,V),B=Math.max(B,r.center.distanceToSquared(el))}r.radius=Math.sqrt(B),i.sphereInitialized=!0}return t.copy(r),t}setMatrixAt(e,t){const n=this._active,i=this._matricesTexture,r=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||n[e]===!1?this:(t.toArray(r,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const n=this._active,i=this._matricesTexture.image.data,r=this._geometryCount;return e>=r||n[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){const n=this._visibility,i=this._active,r=this._geometryCount;return e>=r||i[e]===!1||n[e]===t?this:(n[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,n=this._active,i=this._geometryCount;return e>=i||n[e]===!1?!1:t[e]}raycast(e,t){const n=this._visibility,i=this._active,r=this._drawRanges,o=this._geometryCount,c=this.matrixWorld,E=this.geometry;rs.material=this.material,rs.geometry.index=E.index,rs.geometry.attributes=E.attributes,rs.geometry.boundingBox===null&&(rs.geometry.boundingBox=new br),rs.geometry.boundingSphere===null&&(rs.geometry.boundingSphere=new Nr);for(let x=0;x<o;x++){if(!n[x]||!i[x])continue;const B=r[x];rs.geometry.setDrawRange(B.start,B.count),this.getMatrixAt(x,rs.matrixWorld).premultiply(c),this.getBoundingBoxAt(x,rs.geometry.boundingBox),this.getBoundingSphereAt(x,rs.geometry.boundingSphere),rs.raycast(e,lc);for(let P=0,U=lc.length;P<U;P++){const V=lc[P];V.object=this,V.batchId=x,t.push(V)}lc.length=0}rs.material=null,rs.geometry.index=null,rs.geometry.attributes={},rs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,n,i,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),c=o===null?1:o.array.BYTES_PER_ELEMENT,E=this._active,x=this._visibility,B=this._multiDrawStarts,P=this._multiDrawCounts,U=this._drawRanges,V=this.perObjectFrustumCulled;V&&(Jd.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),Zh.setFromProjectionMatrix(Jd,e.coordinateSystem));let j=0;if(this.sortObjects){qd.copy(this.matrixWorld).invert(),el.setFromMatrixPosition(n.matrixWorld).applyMatrix4(qd);for(let H=0,ge=x.length;H<ge;H++)if(x[H]&&E[H]){this.getMatrixAt(H,bo),this.getBoundingSphereAt(H,zo).applyMatrix4(bo);let pe=!1;if(V&&(pe=!Zh.intersectsSphere(zo)),!pe){const de=el.distanceTo(zo.center);$h.push(U[H],de)}}const ie=$h.list,X=this.customSort;X===null?ie.sort(r.transparent?tv:ev):X.call(this,ie,n);for(let H=0,ge=ie.length;H<ge;H++){const pe=ie[H];B[j]=pe.start*c,P[j]=pe.count,j++}$h.reset()}else for(let ie=0,X=x.length;ie<X;ie++)if(x[ie]&&E[ie]){let H=!1;if(V&&(this.getMatrixAt(ie,bo),this.getBoundingSphereAt(ie,zo).applyMatrix4(bo),H=!Zh.intersectsSphere(zo)),!H){const ge=U[ie];B[j]=ge.start*c,P[j]=ge.count,j++}}this._multiDrawCount=j,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,r,o){this.onBeforeRender(e,null,i,r,o)}}class ds extends is{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Sn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const cc=new De,hc=new De,$d=new On,tl=new kr,uc=new Nr,eu=new De,ef=new De;class wo extends Yi{constructor(e=new wi,t=new ds){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,r=t.count;i<r;i++)cc.fromBufferAttribute(t,i-1),hc.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=cc.distanceTo(hc);e.setAttribute("lineDistance",new Gn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),uc.copy(n.boundingSphere),uc.applyMatrix4(i),uc.radius+=r,e.ray.intersectsSphere(uc)===!1)return;$d.copy(i).invert(),tl.copy(e.ray).applyMatrix4($d);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),E=c*c,x=this.isLineSegments?2:1,B=n.index,U=n.attributes.position;if(B!==null){const V=Math.max(0,o.start),j=Math.min(B.count,o.start+o.count);for(let ie=V,X=j-1;ie<X;ie+=x){const H=B.getX(ie),ge=B.getX(ie+1),pe=dc(this,e,tl,E,H,ge);pe&&t.push(pe)}if(this.isLineLoop){const ie=B.getX(j-1),X=B.getX(V),H=dc(this,e,tl,E,ie,X);H&&t.push(H)}}else{const V=Math.max(0,o.start),j=Math.min(U.count,o.start+o.count);for(let ie=V,X=j-1;ie<X;ie+=x){const H=dc(this,e,tl,E,ie,ie+1);H&&t.push(H)}if(this.isLineLoop){const ie=dc(this,e,tl,E,j-1,V);ie&&t.push(ie)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const c=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function dc(s,e,t,n,i,r){const o=s.geometry.attributes.position;if(cc.fromBufferAttribute(o,i),hc.fromBufferAttribute(o,r),t.distanceSqToSegment(cc,hc,eu,ef)>n)return;eu.applyMatrix4(s.matrixWorld);const E=e.ray.origin.distanceTo(eu);if(!(E<e.near||E>e.far))return{distance:E,point:ef.clone().applyMatrix4(s.matrixWorld),index:i,face:null,faceIndex:null,object:s}}const tf=new De,nf=new De;class Ws extends wo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,r=t.count;i<r;i+=2)tf.fromBufferAttribute(t,i),nf.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+tf.distanceTo(nf);e.setAttribute("lineDistance",new Gn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class rf extends wo{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class tu extends is{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Sn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const sf=new On,nu=new kr,fc=new Nr,pc=new De;class of extends Yi{constructor(e=new wi,t=new tu){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),fc.copy(n.boundingSphere),fc.applyMatrix4(i),fc.radius+=r,e.ray.intersectsSphere(fc)===!1)return;sf.copy(i).invert(),nu.copy(e.ray).applyMatrix4(sf);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),E=c*c,x=n.index,P=n.attributes.position;if(x!==null){const U=Math.max(0,o.start),V=Math.min(x.count,o.start+o.count);for(let j=U,ie=V;j<ie;j++){const X=x.getX(j);pc.fromBufferAttribute(P,X),af(pc,X,E,i,e,t,this)}}else{const U=Math.max(0,o.start),V=Math.min(P.count,o.start+o.count);for(let j=U,ie=V;j<ie;j++)pc.fromBufferAttribute(P,j),af(pc,j,E,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const c=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function af(s,e,t,n,i,r,o){const c=nu.distanceSqToPoint(s);if(c<t){const E=new De;nu.closestPointToPoint(s,E),E.applyMatrix4(n);const x=i.ray.origin.distanceTo(E);if(x<i.near||x>i.far)return;r.push({distance:x,distanceToRay:Math.sqrt(c),point:E,index:e,face:null,object:o})}}class sv extends fr{constructor(e,t,n,i,r,o,c,E,x){super(e,t,n,i,r,o,c,E,x),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Bn,this.magFilter=r!==void 0?r:Bn,this.generateMipmaps=!1;const B=this;function P(){B.needsUpdate=!0,e.requestVideoFrameCallback(P)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(P)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class ov extends fr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Yt,this.minFilter=Yt,this.generateMipmaps=!1,this.needsUpdate=!0}}class Ac extends fr{constructor(e,t,n,i,r,o,c,E,x,B,P,U){super(null,o,c,E,x,B,i,r,P,U),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class av extends Ac{constructor(e,t,n,i,r,o){super(e,t,n,r,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=He}}class lv extends Ac{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,ee),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class cv extends fr{constructor(e,t,n,i,r,o,c,E,x){super(e,t,n,i,r,o,c,E,x),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Us{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const r=n.length;let o;t?o=t:o=e*n[r-1];let c=0,E=r-1,x;for(;c<=E;)if(i=Math.floor(c+(E-c)/2),x=n[i]-o,x<0)c=i+1;else if(x>0)E=i-1;else{E=i;break}if(i=E,n[i]===o)return i/(r-1);const B=n[i],U=n[i+1]-B,V=(o-B)/U;return(i+V)/(r-1)}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);const o=this.getPoint(i),c=this.getPoint(r),E=t||(o.isVector2?new Lt:new De);return E.copy(c).sub(o).normalize(),E}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new De,i=[],r=[],o=[],c=new De,E=new On;for(let V=0;V<=e;V++){const j=V/e;i[V]=this.getTangentAt(j,new De)}r[0]=new De,o[0]=new De;let x=Number.MAX_VALUE;const B=Math.abs(i[0].x),P=Math.abs(i[0].y),U=Math.abs(i[0].z);B<=x&&(x=B,n.set(1,0,0)),P<=x&&(x=P,n.set(0,1,0)),U<=x&&n.set(0,0,1),c.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],c),o[0].crossVectors(i[0],r[0]);for(let V=1;V<=e;V++){if(r[V]=r[V-1].clone(),o[V]=o[V-1].clone(),c.crossVectors(i[V-1],i[V]),c.length()>Number.EPSILON){c.normalize();const j=Math.acos(Cr(i[V-1].dot(i[V]),-1,1));r[V].applyMatrix4(E.makeRotationAxis(c,j))}o[V].crossVectors(i[V],r[V])}if(t===!0){let V=Math.acos(Cr(r[0].dot(r[e]),-1,1));V/=e,i[0].dot(c.crossVectors(r[0],r[e]))>0&&(V=-V);for(let j=1;j<=e;j++)r[j].applyMatrix4(E.makeRotationAxis(i[j],V*j)),o[j].crossVectors(i[j],r[j])}return{tangents:i,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class mc extends Us{constructor(e=0,t=0,n=1,i=1,r=0,o=Math.PI*2,c=!1,E=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=c,this.aRotation=E}getPoint(e,t=new Lt){const n=t,i=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(o?r=0:r=i),this.aClockwise===!0&&!o&&(r===i?r=-i:r=r-i);const c=this.aStartAngle+e*r;let E=this.aX+this.xRadius*Math.cos(c),x=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const B=Math.cos(this.aRotation),P=Math.sin(this.aRotation),U=E-this.aX,V=x-this.aY;E=U*B-V*P+this.aX,x=U*P+V*B+this.aY}return n.set(E,x)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class lf extends mc{constructor(e,t,n,i,r,o){super(e,t,n,n,i,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function iu(){let s=0,e=0,t=0,n=0;function i(r,o,c,E){s=r,e=c,t=-3*r+3*o-2*c-E,n=2*r-2*o+c+E}return{initCatmullRom:function(r,o,c,E,x){i(o,c,x*(c-r),x*(E-o))},initNonuniformCatmullRom:function(r,o,c,E,x,B,P){let U=(o-r)/x-(c-r)/(x+B)+(c-o)/B,V=(c-o)/B-(E-o)/(B+P)+(E-c)/P;U*=B,V*=B,i(o,c,U,V)},calc:function(r){const o=r*r,c=o*r;return s+e*r+t*o+n*c}}}const gc=new De,ru=new iu,su=new iu,ou=new iu;class cf extends Us{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new De){const n=t,i=this.points,r=i.length,o=(r-(this.closed?0:1))*e;let c=Math.floor(o),E=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:E===0&&c===r-1&&(c=r-2,E=1);let x,B;this.closed||c>0?x=i[(c-1)%r]:(gc.subVectors(i[0],i[1]).add(i[0]),x=gc);const P=i[c%r],U=i[(c+1)%r];if(this.closed||c+2<r?B=i[(c+2)%r]:(gc.subVectors(i[r-1],i[r-2]).add(i[r-1]),B=gc),this.curveType==="centripetal"||this.curveType==="chordal"){const V=this.curveType==="chordal"?.5:.25;let j=Math.pow(x.distanceToSquared(P),V),ie=Math.pow(P.distanceToSquared(U),V),X=Math.pow(U.distanceToSquared(B),V);ie<1e-4&&(ie=1),j<1e-4&&(j=ie),X<1e-4&&(X=ie),ru.initNonuniformCatmullRom(x.x,P.x,U.x,B.x,j,ie,X),su.initNonuniformCatmullRom(x.y,P.y,U.y,B.y,j,ie,X),ou.initNonuniformCatmullRom(x.z,P.z,U.z,B.z,j,ie,X)}else this.curveType==="catmullrom"&&(ru.initCatmullRom(x.x,P.x,U.x,B.x,this.tension),su.initCatmullRom(x.y,P.y,U.y,B.y,this.tension),ou.initCatmullRom(x.z,P.z,U.z,B.z,this.tension));return n.set(ru.calc(E),su.calc(E),ou.calc(E)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new De().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function hf(s,e,t,n,i){const r=(n-e)*.5,o=(i-t)*.5,c=s*s,E=s*c;return(2*t-2*n+r+o)*E+(-3*t+3*n-2*r-o)*c+r*s+t}function hv(s,e){const t=1-s;return t*t*e}function uv(s,e){return 2*(1-s)*s*e}function dv(s,e){return s*s*e}function nl(s,e,t,n){return hv(s,e)+uv(s,t)+dv(s,n)}function fv(s,e){const t=1-s;return t*t*t*e}function pv(s,e){const t=1-s;return 3*t*t*s*e}function Av(s,e){return 3*(1-s)*s*s*e}function mv(s,e){return s*s*s*e}function il(s,e,t,n,i){return fv(s,e)+pv(s,t)+Av(s,n)+mv(s,i)}class au extends Us{constructor(e=new Lt,t=new Lt,n=new Lt,i=new Lt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Lt){const n=t,i=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(il(e,i.x,r.x,o.x,c.x),il(e,i.y,r.y,o.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class uf extends Us{constructor(e=new De,t=new De,n=new De,i=new De){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new De){const n=t,i=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(il(e,i.x,r.x,o.x,c.x),il(e,i.y,r.y,o.y,c.y),il(e,i.z,r.z,o.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lu extends Us{constructor(e=new Lt,t=new Lt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Lt){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Lt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class df extends Us{constructor(e=new De,t=new De){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new De){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new De){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class cu extends Us{constructor(e=new Lt,t=new Lt,n=new Lt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Lt){const n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(nl(e,i.x,r.x,o.x),nl(e,i.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hu extends Us{constructor(e=new De,t=new De,n=new De){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new De){const n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(nl(e,i.x,r.x,o.x),nl(e,i.y,r.y,o.y),nl(e,i.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class uu extends Us{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Lt){const n=t,i=this.points,r=(i.length-1)*e,o=Math.floor(r),c=r-o,E=i[o===0?o:o-1],x=i[o],B=i[o>i.length-2?i.length-1:o+1],P=i[o>i.length-3?i.length-1:o+2];return n.set(hf(c,E.x,x.x,B.x,P.x),hf(c,E.y,x.y,B.y,P.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new Lt().fromArray(i))}return this}}var vc=Object.freeze({__proto__:null,ArcCurve:lf,CatmullRomCurve3:cf,CubicBezierCurve:au,CubicBezierCurve3:uf,EllipseCurve:mc,LineCurve:lu,LineCurve3:df,QuadraticBezierCurve:cu,QuadraticBezierCurve3:hu,SplineCurve:uu});class ff extends Us{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new vc[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const o=i[r]-n,c=this.curves[r],E=c.getLength(),x=E===0?0:1-o/E;return c.getPointAt(x,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const o=r[i],c=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,E=o.getPoints(c);for(let x=0;x<E.length;x++){const B=E[x];n&&n.equals(B)||(t.push(B),n=B)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new vc[i.type]().fromJSON(i))}return this}}class rl extends ff{constructor(e){super(),this.type="Path",this.currentPoint=new Lt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new lu(this.currentPoint.clone(),new Lt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new cu(this.currentPoint.clone(),new Lt(e,t),new Lt(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,o){const c=new au(this.currentPoint.clone(),new Lt(e,t),new Lt(n,i),new Lt(r,o));return this.curves.push(c),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new uu(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,o){const c=this.currentPoint.x,E=this.currentPoint.y;return this.absarc(e+c,t+E,n,i,r,o),this}absarc(e,t,n,i,r,o){return this.absellipse(e,t,n,n,i,r,o),this}ellipse(e,t,n,i,r,o,c,E){const x=this.currentPoint.x,B=this.currentPoint.y;return this.absellipse(e+x,t+B,n,i,r,o,c,E),this}absellipse(e,t,n,i,r,o,c,E){const x=new mc(e,t,n,i,r,o,c,E);if(this.curves.length>0){const P=x.getPoint(0);P.equals(this.currentPoint)||this.lineTo(P.x,P.y)}this.curves.push(x);const B=x.getPoint(1);return this.currentPoint.copy(B),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class sl extends wi{constructor(e=[new Lt(0,-.5),new Lt(.5,0),new Lt(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Cr(i,0,Math.PI*2);const r=[],o=[],c=[],E=[],x=[],B=1/t,P=new De,U=new Lt,V=new De,j=new De,ie=new De;let X=0,H=0;for(let ge=0;ge<=e.length-1;ge++)switch(ge){case 0:X=e[ge+1].x-e[ge].x,H=e[ge+1].y-e[ge].y,V.x=H*1,V.y=-X,V.z=H*0,ie.copy(V),V.normalize(),E.push(V.x,V.y,V.z);break;case e.length-1:E.push(ie.x,ie.y,ie.z);break;default:X=e[ge+1].x-e[ge].x,H=e[ge+1].y-e[ge].y,V.x=H*1,V.y=-X,V.z=H*0,j.copy(V),V.x+=ie.x,V.y+=ie.y,V.z+=ie.z,V.normalize(),E.push(V.x,V.y,V.z),ie.copy(j)}for(let ge=0;ge<=t;ge++){const pe=n+ge*B*i,de=Math.sin(pe),We=Math.cos(pe);for(let Pe=0;Pe<=e.length-1;Pe++){P.x=e[Pe].x*de,P.y=e[Pe].y,P.z=e[Pe].x*We,o.push(P.x,P.y,P.z),U.x=ge/t,U.y=Pe/(e.length-1),c.push(U.x,U.y);const ke=E[3*Pe+0]*de,ze=E[3*Pe+1],Te=E[3*Pe+0]*We;x.push(ke,ze,Te)}}for(let ge=0;ge<t;ge++)for(let pe=0;pe<e.length-1;pe++){const de=pe+ge*e.length,We=de,Pe=de+e.length,ke=de+e.length+1,ze=de+1;r.push(We,Pe,ze),r.push(ke,ze,Pe)}this.setIndex(r),this.setAttribute("position",new Gn(o,3)),this.setAttribute("uv",new Gn(c,2)),this.setAttribute("normal",new Gn(x,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sl(e.points,e.segments,e.phiStart,e.phiLength)}}class yc extends sl{constructor(e=1,t=1,n=4,i=8){const r=new rl;r.absarc(0,-t/2,e,Math.PI*1.5,0),r.absarc(0,t/2,e,0,Math.PI*.5),super(r.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new yc(e.radius,e.length,e.capSegments,e.radialSegments)}}class Ec extends wi{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],o=[],c=[],E=[],x=new De,B=new Lt;o.push(0,0,0),c.push(0,0,1),E.push(.5,.5);for(let P=0,U=3;P<=t;P++,U+=3){const V=n+P/t*i;x.x=e*Math.cos(V),x.y=e*Math.sin(V),o.push(x.x,x.y,x.z),c.push(0,0,1),B.x=(o[U]/e+1)/2,B.y=(o[U+1]/e+1)/2,E.push(B.x,B.y)}for(let P=1;P<=t;P++)r.push(P,P+1,0);this.setIndex(r),this.setAttribute("position",new Gn(o,3)),this.setAttribute("normal",new Gn(c,3)),this.setAttribute("uv",new Gn(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ec(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Da extends wi{constructor(e=1,t=1,n=1,i=32,r=1,o=!1,c=0,E=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:c,thetaLength:E};const x=this;i=Math.floor(i),r=Math.floor(r);const B=[],P=[],U=[],V=[];let j=0;const ie=[],X=n/2;let H=0;ge(),o===!1&&(e>0&&pe(!0),t>0&&pe(!1)),this.setIndex(B),this.setAttribute("position",new Gn(P,3)),this.setAttribute("normal",new Gn(U,3)),this.setAttribute("uv",new Gn(V,2));function ge(){const de=new De,We=new De;let Pe=0;const ke=(t-e)/n;for(let ze=0;ze<=r;ze++){const Te=[],be=ze/r,je=be*(t-e)+e;for(let nt=0;nt<=i;nt++){const $e=nt/i,rt=$e*E+c,mt=Math.sin(rt),Rt=Math.cos(rt);We.x=je*mt,We.y=-be*n+X,We.z=je*Rt,P.push(We.x,We.y,We.z),de.set(mt,ke,Rt).normalize(),U.push(de.x,de.y,de.z),V.push($e,1-be),Te.push(j++)}ie.push(Te)}for(let ze=0;ze<i;ze++)for(let Te=0;Te<r;Te++){const be=ie[Te][ze],je=ie[Te+1][ze],nt=ie[Te+1][ze+1],$e=ie[Te][ze+1];B.push(be,je,$e),B.push(je,nt,$e),Pe+=6}x.addGroup(H,Pe,0),H+=Pe}function pe(de){const We=j,Pe=new Lt,ke=new De;let ze=0;const Te=de===!0?e:t,be=de===!0?1:-1;for(let nt=1;nt<=i;nt++)P.push(0,X*be,0),U.push(0,be,0),V.push(.5,.5),j++;const je=j;for(let nt=0;nt<=i;nt++){const rt=nt/i*E+c,mt=Math.cos(rt),Rt=Math.sin(rt);ke.x=Te*Rt,ke.y=X*be,ke.z=Te*mt,P.push(ke.x,ke.y,ke.z),U.push(0,be,0),Pe.x=mt*.5+.5,Pe.y=Rt*.5*be+.5,V.push(Pe.x,Pe.y),j++}for(let nt=0;nt<i;nt++){const $e=We+nt,rt=je+nt;de===!0?B.push(rt,rt+1,$e):B.push(rt+1,rt,$e),ze+=3}x.addGroup(H,ze,de===!0?1:2),H+=ze}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Da(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Cc extends Da{constructor(e=1,t=1,n=32,i=1,r=!1,o=0,c=Math.PI*2){super(0,e,t,n,i,r,o,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:c}}static fromJSON(e){return new Cc(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class _o extends wi{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],o=[];c(i),x(n),B(),this.setAttribute("position",new Gn(r,3)),this.setAttribute("normal",new Gn(r.slice(),3)),this.setAttribute("uv",new Gn(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function c(ge){const pe=new De,de=new De,We=new De;for(let Pe=0;Pe<t.length;Pe+=3)V(t[Pe+0],pe),V(t[Pe+1],de),V(t[Pe+2],We),E(pe,de,We,ge)}function E(ge,pe,de,We){const Pe=We+1,ke=[];for(let ze=0;ze<=Pe;ze++){ke[ze]=[];const Te=ge.clone().lerp(de,ze/Pe),be=pe.clone().lerp(de,ze/Pe),je=Pe-ze;for(let nt=0;nt<=je;nt++)nt===0&&ze===Pe?ke[ze][nt]=Te:ke[ze][nt]=Te.clone().lerp(be,nt/je)}for(let ze=0;ze<Pe;ze++)for(let Te=0;Te<2*(Pe-ze)-1;Te++){const be=Math.floor(Te/2);Te%2===0?(U(ke[ze][be+1]),U(ke[ze+1][be]),U(ke[ze][be])):(U(ke[ze][be+1]),U(ke[ze+1][be+1]),U(ke[ze+1][be]))}}function x(ge){const pe=new De;for(let de=0;de<r.length;de+=3)pe.x=r[de+0],pe.y=r[de+1],pe.z=r[de+2],pe.normalize().multiplyScalar(ge),r[de+0]=pe.x,r[de+1]=pe.y,r[de+2]=pe.z}function B(){const ge=new De;for(let pe=0;pe<r.length;pe+=3){ge.x=r[pe+0],ge.y=r[pe+1],ge.z=r[pe+2];const de=X(ge)/2/Math.PI+.5,We=H(ge)/Math.PI+.5;o.push(de,1-We)}j(),P()}function P(){for(let ge=0;ge<o.length;ge+=6){const pe=o[ge+0],de=o[ge+2],We=o[ge+4],Pe=Math.max(pe,de,We),ke=Math.min(pe,de,We);Pe>.9&&ke<.1&&(pe<.2&&(o[ge+0]+=1),de<.2&&(o[ge+2]+=1),We<.2&&(o[ge+4]+=1))}}function U(ge){r.push(ge.x,ge.y,ge.z)}function V(ge,pe){const de=ge*3;pe.x=e[de+0],pe.y=e[de+1],pe.z=e[de+2]}function j(){const ge=new De,pe=new De,de=new De,We=new De,Pe=new Lt,ke=new Lt,ze=new Lt;for(let Te=0,be=0;Te<r.length;Te+=9,be+=6){ge.set(r[Te+0],r[Te+1],r[Te+2]),pe.set(r[Te+3],r[Te+4],r[Te+5]),de.set(r[Te+6],r[Te+7],r[Te+8]),Pe.set(o[be+0],o[be+1]),ke.set(o[be+2],o[be+3]),ze.set(o[be+4],o[be+5]),We.copy(ge).add(pe).add(de).divideScalar(3);const je=X(We);ie(Pe,be+0,ge,je),ie(ke,be+2,pe,je),ie(ze,be+4,de,je)}}function ie(ge,pe,de,We){We<0&&ge.x===1&&(o[pe]=ge.x-1),de.x===0&&de.z===0&&(o[pe]=We/2/Math.PI+.5)}function X(ge){return Math.atan2(ge.z,-ge.x)}function H(ge){return Math.atan2(-ge.y,Math.sqrt(ge.x*ge.x+ge.z*ge.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _o(e.vertices,e.indices,e.radius,e.details)}}class xc extends _o{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new xc(e.radius,e.detail)}}const bc=new De,wc=new De,du=new De,_c=new _s;class pf extends wi{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),r=Math.cos(Js*t),o=e.getIndex(),c=e.getAttribute("position"),E=o?o.count:c.count,x=[0,0,0],B=["a","b","c"],P=new Array(3),U={},V=[];for(let j=0;j<E;j+=3){o?(x[0]=o.getX(j),x[1]=o.getX(j+1),x[2]=o.getX(j+2)):(x[0]=j,x[1]=j+1,x[2]=j+2);const{a:ie,b:X,c:H}=_c;if(ie.fromBufferAttribute(c,x[0]),X.fromBufferAttribute(c,x[1]),H.fromBufferAttribute(c,x[2]),_c.getNormal(du),P[0]=`${Math.round(ie.x*i)},${Math.round(ie.y*i)},${Math.round(ie.z*i)}`,P[1]=`${Math.round(X.x*i)},${Math.round(X.y*i)},${Math.round(X.z*i)}`,P[2]=`${Math.round(H.x*i)},${Math.round(H.y*i)},${Math.round(H.z*i)}`,!(P[0]===P[1]||P[1]===P[2]||P[2]===P[0]))for(let ge=0;ge<3;ge++){const pe=(ge+1)%3,de=P[ge],We=P[pe],Pe=_c[B[ge]],ke=_c[B[pe]],ze=`${de}_${We}`,Te=`${We}_${de}`;Te in U&&U[Te]?(du.dot(U[Te].normal)<=r&&(V.push(Pe.x,Pe.y,Pe.z),V.push(ke.x,ke.y,ke.z)),U[Te]=null):ze in U||(U[ze]={index0:x[ge],index1:x[pe],normal:du.clone()})}}for(const j in U)if(U[j]){const{index0:ie,index1:X}=U[j];bc.fromBufferAttribute(c,ie),wc.fromBufferAttribute(c,X),V.push(bc.x,bc.y,bc.z),V.push(wc.x,wc.y,wc.z)}this.setAttribute("position",new Gn(V,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class jo extends rl{constructor(e){super(e),this.uuid=ls(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new rl().fromJSON(i))}return this}}const gv={triangulate:function(s,e,t=2){const n=e&&e.length,i=n?e[0]*t:s.length;let r=Af(s,0,i,t,!0);const o=[];if(!r||r.next===r.prev)return o;let c,E,x,B,P,U,V;if(n&&(r=xv(s,e,r,t)),s.length>80*t){c=x=s[0],E=B=s[1];for(let j=t;j<i;j+=t)P=s[j],U=s[j+1],P<c&&(c=P),U<E&&(E=U),P>x&&(x=P),U>B&&(B=U);V=Math.max(x-c,B-E),V=V!==0?32767/V:0}return ol(r,o,t,c,E,V,0),o}};function Af(s,e,t,n,i){let r,o;if(i===Dv(s,e,t,n)>0)for(r=e;r<t;r+=n)o=vf(r,s[r],s[r+1],o);else for(r=t-n;r>=e;r-=n)o=vf(r,s[r],s[r+1],o);return o&&Mc(o,o.next)&&(ll(o),o=o.next),o}function Wo(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(Mc(t,t.next)||wr(t.prev,t,t.next)===0)){if(ll(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function ol(s,e,t,n,i,r,o){if(!s)return;!o&&r&&Sv(s,n,i,r);let c=s,E,x;for(;s.prev!==s.next;){if(E=s.prev,x=s.next,r?yv(s,n,i,r):vv(s)){e.push(E.i/t|0),e.push(s.i/t|0),e.push(x.i/t|0),ll(s),s=x.next,c=x.next;continue}if(s=x,s===c){o?o===1?(s=Ev(Wo(s),e,t),ol(s,e,t,n,i,r,2)):o===2&&Cv(s,e,t,n,i,r):ol(Wo(s),e,t,n,i,r,1);break}}}function vv(s){const e=s.prev,t=s,n=s.next;if(wr(e,t,n)>=0)return!1;const i=e.x,r=t.x,o=n.x,c=e.y,E=t.y,x=n.y,B=i<r?i<o?i:o:r<o?r:o,P=c<E?c<x?c:x:E<x?E:x,U=i>r?i>o?i:o:r>o?r:o,V=c>E?c>x?c:x:E>x?E:x;let j=n.next;for(;j!==e;){if(j.x>=B&&j.x<=U&&j.y>=P&&j.y<=V&&Pa(i,c,r,E,o,x,j.x,j.y)&&wr(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function yv(s,e,t,n){const i=s.prev,r=s,o=s.next;if(wr(i,r,o)>=0)return!1;const c=i.x,E=r.x,x=o.x,B=i.y,P=r.y,U=o.y,V=c<E?c<x?c:x:E<x?E:x,j=B<P?B<U?B:U:P<U?P:U,ie=c>E?c>x?c:x:E>x?E:x,X=B>P?B>U?B:U:P>U?P:U,H=fu(V,j,e,t,n),ge=fu(ie,X,e,t,n);let pe=s.prevZ,de=s.nextZ;for(;pe&&pe.z>=H&&de&&de.z<=ge;){if(pe.x>=V&&pe.x<=ie&&pe.y>=j&&pe.y<=X&&pe!==i&&pe!==o&&Pa(c,B,E,P,x,U,pe.x,pe.y)&&wr(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,de.x>=V&&de.x<=ie&&de.y>=j&&de.y<=X&&de!==i&&de!==o&&Pa(c,B,E,P,x,U,de.x,de.y)&&wr(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;pe&&pe.z>=H;){if(pe.x>=V&&pe.x<=ie&&pe.y>=j&&pe.y<=X&&pe!==i&&pe!==o&&Pa(c,B,E,P,x,U,pe.x,pe.y)&&wr(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;de&&de.z<=ge;){if(de.x>=V&&de.x<=ie&&de.y>=j&&de.y<=X&&de!==i&&de!==o&&Pa(c,B,E,P,x,U,de.x,de.y)&&wr(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function Ev(s,e,t){let n=s;do{const i=n.prev,r=n.next.next;!Mc(i,r)&&mf(i,n,n.next,r)&&al(i,r)&&al(r,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(r.i/t|0),ll(n),ll(n.next),n=s=r),n=n.next}while(n!==s);return Wo(n)}function Cv(s,e,t,n,i,r){let o=s;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&Bv(o,c)){let E=gf(o,c);o=Wo(o,o.next),E=Wo(E,E.next),ol(o,e,t,n,i,r,0),ol(E,e,t,n,i,r,0);return}c=c.next}o=o.next}while(o!==s)}function xv(s,e,t,n){const i=[];let r,o,c,E,x;for(r=0,o=e.length;r<o;r++)c=e[r]*n,E=r<o-1?e[r+1]*n:s.length,x=Af(s,c,E,n,!1),x===x.next&&(x.steiner=!0),i.push(Iv(x));for(i.sort(bv),r=0;r<i.length;r++)t=wv(i[r],t);return t}function bv(s,e){return s.x-e.x}function wv(s,e){const t=_v(s,e);if(!t)return e;const n=gf(t,s);return Wo(n,n.next),Wo(t,t.next)}function _v(s,e){let t=e,n=-1/0,i;const r=s.x,o=s.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const U=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(U<=r&&U>n&&(n=U,i=t.x<t.next.x?t:t.next,U===r))return i}t=t.next}while(t!==e);if(!i)return null;const c=i,E=i.x,x=i.y;let B=1/0,P;t=i;do r>=t.x&&t.x>=E&&r!==t.x&&Pa(o<x?r:n,o,E,x,o<x?n:r,o,t.x,t.y)&&(P=Math.abs(o-t.y)/(r-t.x),al(t,s)&&(P<B||P===B&&(t.x>i.x||t.x===i.x&&Mv(i,t)))&&(i=t,B=P)),t=t.next;while(t!==c);return i}function Mv(s,e){return wr(s.prev,s,e.prev)<0&&wr(e.next,s,s.next)<0}function Sv(s,e,t,n){let i=s;do i.z===0&&(i.z=fu(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,Tv(i)}function Tv(s){let e,t,n,i,r,o,c,E,x=1;do{for(t=s,s=null,r=null,o=0;t;){for(o++,n=t,c=0,e=0;e<x&&(c++,n=n.nextZ,!!n);e++);for(E=x;c>0||E>0&&n;)c!==0&&(E===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,c--):(i=n,n=n.nextZ,E--),r?r.nextZ=i:s=i,i.prevZ=r,r=i;t=n}r.nextZ=null,x*=2}while(o>1);return s}function fu(s,e,t,n,i){return s=(s-t)*i|0,e=(e-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function Iv(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function Pa(s,e,t,n,i,r,o,c){return(i-o)*(e-c)>=(s-o)*(r-c)&&(s-o)*(n-c)>=(t-o)*(e-c)&&(t-o)*(r-c)>=(i-o)*(n-c)}function Bv(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!Rv(s,e)&&(al(s,e)&&al(e,s)&&Lv(s,e)&&(wr(s.prev,s,e.prev)||wr(s,e.prev,e))||Mc(s,e)&&wr(s.prev,s,s.next)>0&&wr(e.prev,e,e.next)>0)}function wr(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function Mc(s,e){return s.x===e.x&&s.y===e.y}function mf(s,e,t,n){const i=Tc(wr(s,e,t)),r=Tc(wr(s,e,n)),o=Tc(wr(t,n,s)),c=Tc(wr(t,n,e));return!!(i!==r&&o!==c||i===0&&Sc(s,t,e)||r===0&&Sc(s,n,e)||o===0&&Sc(t,s,n)||c===0&&Sc(t,e,n))}function Sc(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function Tc(s){return s>0?1:s<0?-1:0}function Rv(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&mf(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function al(s,e){return wr(s.prev,s,s.next)<0?wr(s,e,s.next)>=0&&wr(s,s.prev,e)>=0:wr(s,e,s.prev)<0||wr(s,s.next,e)<0}function Lv(s,e){let t=s,n=!1;const i=(s.x+e.x)/2,r=(s.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&i<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function gf(s,e){const t=new pu(s.i,s.x,s.y),n=new pu(e.i,e.x,e.y),i=s.next,r=e.prev;return s.next=e,e.prev=s,t.next=i,i.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function vf(s,e,t,n){const i=new pu(s,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ll(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function pu(s,e,t){this.i=s,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Dv(s,e,t,n){let i=0;for(let r=e,o=t-n;r<t;r+=n)i+=(s[o]-s[r])*(s[r+1]+s[o+1]),o=r;return i}class Ks{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return n*.5}static isClockWise(e){return Ks.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];yf(e),Ef(n,e);let o=e.length;t.forEach(yf);for(let E=0;E<t.length;E++)i.push(o),o+=t[E].length,Ef(n,t[E]);const c=gv.triangulate(n,i);for(let E=0;E<c.length;E+=3)r.push(c.slice(E,E+3));return r}}function yf(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function Ef(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class Ic extends wi{constructor(e=new jo([new Lt(.5,.5),new Lt(-.5,.5),new Lt(-.5,-.5),new Lt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let c=0,E=e.length;c<E;c++){const x=e[c];o(x)}this.setAttribute("position",new Gn(i,3)),this.setAttribute("uv",new Gn(r,2)),this.computeVertexNormals();function o(c){const E=[],x=t.curveSegments!==void 0?t.curveSegments:12,B=t.steps!==void 0?t.steps:1,P=t.depth!==void 0?t.depth:1;let U=t.bevelEnabled!==void 0?t.bevelEnabled:!0,V=t.bevelThickness!==void 0?t.bevelThickness:.2,j=t.bevelSize!==void 0?t.bevelSize:V-.1,ie=t.bevelOffset!==void 0?t.bevelOffset:0,X=t.bevelSegments!==void 0?t.bevelSegments:3;const H=t.extrudePath,ge=t.UVGenerator!==void 0?t.UVGenerator:Pv;let pe,de=!1,We,Pe,ke,ze;H&&(pe=H.getSpacedPoints(B),de=!0,U=!1,We=H.computeFrenetFrames(B,!1),Pe=new De,ke=new De,ze=new De),U||(X=0,V=0,j=0,ie=0);const Te=c.extractPoints(x);let be=Te.shape;const je=Te.holes;if(!Ks.isClockWise(be)){be=be.reverse();for(let Ot=0,Tt=je.length;Ot<Tt;Ot++){const $t=je[Ot];Ks.isClockWise($t)&&(je[Ot]=$t.reverse())}}const $e=Ks.triangulateShape(be,je),rt=be;for(let Ot=0,Tt=je.length;Ot<Tt;Ot++){const $t=je[Ot];be=be.concat($t)}function mt(Ot,Tt,$t){return Tt||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ot.clone().addScaledVector(Tt,$t)}const Rt=be.length,ln=$e.length;function vt(Ot,Tt,$t){let Xt,Wt,gn;const _n=Ot.x-Tt.x,li=Ot.y-Tt.y,di=$t.x-Ot.x,Ji=$t.y-Ot.y,_r=_n*_n+li*li,mr=_n*Ji-li*di;if(Math.abs(mr)>Number.EPSILON){const Ve=Math.sqrt(_r),we=Math.sqrt(di*di+Ji*Ji),xt=Tt.x-li/Ve,Dt=Tt.y+_n/Ve,Qt=$t.x-Ji/we,Ut=$t.y+di/we,Vn=((Qt-xt)*Ji-(Ut-Dt)*di)/(_n*Ji-li*di);Xt=xt+_n*Vn-Ot.x,Wt=Dt+li*Vn-Ot.y;const cn=Xt*Xt+Wt*Wt;if(cn<=2)return new Lt(Xt,Wt);gn=Math.sqrt(cn/2)}else{let Ve=!1;_n>Number.EPSILON?di>Number.EPSILON&&(Ve=!0):_n<-Number.EPSILON?di<-Number.EPSILON&&(Ve=!0):Math.sign(li)===Math.sign(Ji)&&(Ve=!0),Ve?(Xt=-li,Wt=_n,gn=Math.sqrt(_r)):(Xt=_n,Wt=li,gn=Math.sqrt(_r/2))}return new Lt(Xt/gn,Wt/gn)}const en=[];for(let Ot=0,Tt=rt.length,$t=Tt-1,Xt=Ot+1;Ot<Tt;Ot++,$t++,Xt++)$t===Tt&&($t=0),Xt===Tt&&(Xt=0),en[Ot]=vt(rt[Ot],rt[$t],rt[Xt]);const rn=[];let Dn,_i=en.concat();for(let Ot=0,Tt=je.length;Ot<Tt;Ot++){const $t=je[Ot];Dn=[];for(let Xt=0,Wt=$t.length,gn=Wt-1,_n=Xt+1;Xt<Wt;Xt++,gn++,_n++)gn===Wt&&(gn=0),_n===Wt&&(_n=0),Dn[Xt]=vt($t[Xt],$t[gn],$t[_n]);rn.push(Dn),_i=_i.concat(Dn)}for(let Ot=0;Ot<X;Ot++){const Tt=Ot/X,$t=V*Math.cos(Tt*Math.PI/2),Xt=j*Math.sin(Tt*Math.PI/2)+ie;for(let Wt=0,gn=rt.length;Wt<gn;Wt++){const _n=mt(rt[Wt],en[Wt],Xt);Nn(_n.x,_n.y,-$t)}for(let Wt=0,gn=je.length;Wt<gn;Wt++){const _n=je[Wt];Dn=rn[Wt];for(let li=0,di=_n.length;li<di;li++){const Ji=mt(_n[li],Dn[li],Xt);Nn(Ji.x,Ji.y,-$t)}}}const er=j+ie;for(let Ot=0;Ot<Rt;Ot++){const Tt=U?mt(be[Ot],_i[Ot],er):be[Ot];de?(ke.copy(We.normals[0]).multiplyScalar(Tt.x),Pe.copy(We.binormals[0]).multiplyScalar(Tt.y),ze.copy(pe[0]).add(ke).add(Pe),Nn(ze.x,ze.y,ze.z)):Nn(Tt.x,Tt.y,0)}for(let Ot=1;Ot<=B;Ot++)for(let Tt=0;Tt<Rt;Tt++){const $t=U?mt(be[Tt],_i[Tt],er):be[Tt];de?(ke.copy(We.normals[Ot]).multiplyScalar($t.x),Pe.copy(We.binormals[Ot]).multiplyScalar($t.y),ze.copy(pe[Ot]).add(ke).add(Pe),Nn(ze.x,ze.y,ze.z)):Nn($t.x,$t.y,P/B*Ot)}for(let Ot=X-1;Ot>=0;Ot--){const Tt=Ot/X,$t=V*Math.cos(Tt*Math.PI/2),Xt=j*Math.sin(Tt*Math.PI/2)+ie;for(let Wt=0,gn=rt.length;Wt<gn;Wt++){const _n=mt(rt[Wt],en[Wt],Xt);Nn(_n.x,_n.y,P+$t)}for(let Wt=0,gn=je.length;Wt<gn;Wt++){const _n=je[Wt];Dn=rn[Wt];for(let li=0,di=_n.length;li<di;li++){const Ji=mt(_n[li],Dn[li],Xt);de?Nn(Ji.x,Ji.y+pe[B-1].y,pe[B-1].x+$t):Nn(Ji.x,Ji.y,P+$t)}}}Ar(),qi();function Ar(){const Ot=i.length/3;if(U){let Tt=0,$t=Rt*Tt;for(let Xt=0;Xt<ln;Xt++){const Wt=$e[Xt];Pt(Wt[2]+$t,Wt[1]+$t,Wt[0]+$t)}Tt=B+X*2,$t=Rt*Tt;for(let Xt=0;Xt<ln;Xt++){const Wt=$e[Xt];Pt(Wt[0]+$t,Wt[1]+$t,Wt[2]+$t)}}else{for(let Tt=0;Tt<ln;Tt++){const $t=$e[Tt];Pt($t[2],$t[1],$t[0])}for(let Tt=0;Tt<ln;Tt++){const $t=$e[Tt];Pt($t[0]+Rt*B,$t[1]+Rt*B,$t[2]+Rt*B)}}n.addGroup(Ot,i.length/3-Ot,0)}function qi(){const Ot=i.length/3;let Tt=0;ur(rt,Tt),Tt+=rt.length;for(let $t=0,Xt=je.length;$t<Xt;$t++){const Wt=je[$t];ur(Wt,Tt),Tt+=Wt.length}n.addGroup(Ot,i.length/3-Ot,1)}function ur(Ot,Tt){let $t=Ot.length;for(;--$t>=0;){const Xt=$t;let Wt=$t-1;Wt<0&&(Wt=Ot.length-1);for(let gn=0,_n=B+X*2;gn<_n;gn++){const li=Rt*gn,di=Rt*(gn+1),Ji=Tt+Xt+li,_r=Tt+Wt+li,mr=Tt+Wt+di,Ve=Tt+Xt+di;hn(Ji,_r,mr,Ve)}}}function Nn(Ot,Tt,$t){E.push(Ot),E.push(Tt),E.push($t)}function Pt(Ot,Tt,$t){mn(Ot),mn(Tt),mn($t);const Xt=i.length/3,Wt=ge.generateTopUV(n,i,Xt-3,Xt-2,Xt-1);st(Wt[0]),st(Wt[1]),st(Wt[2])}function hn(Ot,Tt,$t,Xt){mn(Ot),mn(Tt),mn(Xt),mn(Tt),mn($t),mn(Xt);const Wt=i.length/3,gn=ge.generateSideWallUV(n,i,Wt-6,Wt-3,Wt-2,Wt-1);st(gn[0]),st(gn[1]),st(gn[3]),st(gn[1]),st(gn[2]),st(gn[3])}function mn(Ot){i.push(E[Ot*3+0]),i.push(E[Ot*3+1]),i.push(E[Ot*3+2])}function st(Ot){r.push(Ot.x),r.push(Ot.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return Ov(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const c=t[e.shapes[r]];n.push(c)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new vc[i.type]().fromJSON(i)),new Ic(n,e.options)}}const Pv={generateTopUV:function(s,e,t,n,i){const r=e[t*3],o=e[t*3+1],c=e[n*3],E=e[n*3+1],x=e[i*3],B=e[i*3+1];return[new Lt(r,o),new Lt(c,E),new Lt(x,B)]},generateSideWallUV:function(s,e,t,n,i,r){const o=e[t*3],c=e[t*3+1],E=e[t*3+2],x=e[n*3],B=e[n*3+1],P=e[n*3+2],U=e[i*3],V=e[i*3+1],j=e[i*3+2],ie=e[r*3],X=e[r*3+1],H=e[r*3+2];return Math.abs(c-B)<Math.abs(o-x)?[new Lt(o,1-E),new Lt(x,1-P),new Lt(U,1-j),new Lt(ie,1-H)]:[new Lt(c,1-E),new Lt(B,1-P),new Lt(V,1-j),new Lt(X,1-H)]}};function Ov(s,e,t){if(t.shapes=[],Array.isArray(s))for(let n=0,i=s.length;n<i;n++){const r=s[n];t.shapes.push(r.uuid)}else t.shapes.push(s.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Bc extends _o{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Bc(e.radius,e.detail)}}class cl extends _o{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new cl(e.radius,e.detail)}}class Rc extends wi{constructor(e=.5,t=1,n=32,i=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},n=Math.max(3,n),i=Math.max(1,i);const c=[],E=[],x=[],B=[];let P=e;const U=(t-e)/i,V=new De,j=new Lt;for(let ie=0;ie<=i;ie++){for(let X=0;X<=n;X++){const H=r+X/n*o;V.x=P*Math.cos(H),V.y=P*Math.sin(H),E.push(V.x,V.y,V.z),x.push(0,0,1),j.x=(V.x/t+1)/2,j.y=(V.y/t+1)/2,B.push(j.x,j.y)}P+=U}for(let ie=0;ie<i;ie++){const X=ie*(n+1);for(let H=0;H<n;H++){const ge=H+X,pe=ge,de=ge+n+1,We=ge+n+2,Pe=ge+1;c.push(pe,de,Pe),c.push(de,We,Pe)}}this.setIndex(c),this.setAttribute("position",new Gn(E,3)),this.setAttribute("normal",new Gn(x,3)),this.setAttribute("uv",new Gn(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rc(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Lc extends wi{constructor(e=new jo([new Lt(0,.5),new Lt(-.5,-.5),new Lt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],o=[];let c=0,E=0;if(Array.isArray(e)===!1)x(e);else for(let B=0;B<e.length;B++)x(e[B]),this.addGroup(c,E,B),c+=E,E=0;this.setIndex(n),this.setAttribute("position",new Gn(i,3)),this.setAttribute("normal",new Gn(r,3)),this.setAttribute("uv",new Gn(o,2));function x(B){const P=i.length/3,U=B.extractPoints(t);let V=U.shape;const j=U.holes;Ks.isClockWise(V)===!1&&(V=V.reverse());for(let X=0,H=j.length;X<H;X++){const ge=j[X];Ks.isClockWise(ge)===!0&&(j[X]=ge.reverse())}const ie=Ks.triangulateShape(V,j);for(let X=0,H=j.length;X<H;X++){const ge=j[X];V=V.concat(ge)}for(let X=0,H=V.length;X<H;X++){const ge=V[X];i.push(ge.x,ge.y,0),r.push(0,0,1),o.push(ge.x,ge.y)}for(let X=0,H=ie.length;X<H;X++){const ge=ie[X],pe=ge[0]+P,de=ge[1]+P,We=ge[2]+P;n.push(pe,de,We),E+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Fv(t,e)}static fromJSON(e,t){const n=[];for(let i=0,r=e.shapes.length;i<r;i++){const o=t[e.shapes[i]];n.push(o)}return new Lc(n,e.curveSegments)}}function Fv(s,e){if(e.shapes=[],Array.isArray(s))for(let t=0,n=s.length;t<n;t++){const i=s[t];e.shapes.push(i.uuid)}else e.shapes.push(s.uuid);return e}class hl extends wi{constructor(e=1,t=32,n=16,i=0,r=Math.PI*2,o=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const E=Math.min(o+c,Math.PI);let x=0;const B=[],P=new De,U=new De,V=[],j=[],ie=[],X=[];for(let H=0;H<=n;H++){const ge=[],pe=H/n;let de=0;H===0&&o===0?de=.5/t:H===n&&E===Math.PI&&(de=-.5/t);for(let We=0;We<=t;We++){const Pe=We/t;P.x=-e*Math.cos(i+Pe*r)*Math.sin(o+pe*c),P.y=e*Math.cos(o+pe*c),P.z=e*Math.sin(i+Pe*r)*Math.sin(o+pe*c),j.push(P.x,P.y,P.z),U.copy(P).normalize(),ie.push(U.x,U.y,U.z),X.push(Pe+de,1-pe),ge.push(x++)}B.push(ge)}for(let H=0;H<n;H++)for(let ge=0;ge<t;ge++){const pe=B[H][ge+1],de=B[H][ge],We=B[H+1][ge],Pe=B[H+1][ge+1];(H!==0||o>0)&&V.push(pe,de,Pe),(H!==n-1||E<Math.PI)&&V.push(de,We,Pe)}this.setIndex(V),this.setAttribute("position",new Gn(j,3)),this.setAttribute("normal",new Gn(ie,3)),this.setAttribute("uv",new Gn(X,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Dc extends _o{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Dc(e.radius,e.detail)}}class Pc extends wi{constructor(e=1,t=.4,n=12,i=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const o=[],c=[],E=[],x=[],B=new De,P=new De,U=new De;for(let V=0;V<=n;V++)for(let j=0;j<=i;j++){const ie=j/i*r,X=V/n*Math.PI*2;P.x=(e+t*Math.cos(X))*Math.cos(ie),P.y=(e+t*Math.cos(X))*Math.sin(ie),P.z=t*Math.sin(X),c.push(P.x,P.y,P.z),B.x=e*Math.cos(ie),B.y=e*Math.sin(ie),U.subVectors(P,B).normalize(),E.push(U.x,U.y,U.z),x.push(j/i),x.push(V/n)}for(let V=1;V<=n;V++)for(let j=1;j<=i;j++){const ie=(i+1)*V+j-1,X=(i+1)*(V-1)+j-1,H=(i+1)*(V-1)+j,ge=(i+1)*V+j;o.push(ie,X,ge),o.push(X,H,ge)}this.setIndex(o),this.setAttribute("position",new Gn(c,3)),this.setAttribute("normal",new Gn(E,3)),this.setAttribute("uv",new Gn(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pc(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Oc extends wi{constructor(e=1,t=.4,n=64,i=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},n=Math.floor(n),i=Math.floor(i);const c=[],E=[],x=[],B=[],P=new De,U=new De,V=new De,j=new De,ie=new De,X=new De,H=new De;for(let pe=0;pe<=n;++pe){const de=pe/n*r*Math.PI*2;ge(de,r,o,e,V),ge(de+.01,r,o,e,j),X.subVectors(j,V),H.addVectors(j,V),ie.crossVectors(X,H),H.crossVectors(ie,X),ie.normalize(),H.normalize();for(let We=0;We<=i;++We){const Pe=We/i*Math.PI*2,ke=-t*Math.cos(Pe),ze=t*Math.sin(Pe);P.x=V.x+(ke*H.x+ze*ie.x),P.y=V.y+(ke*H.y+ze*ie.y),P.z=V.z+(ke*H.z+ze*ie.z),E.push(P.x,P.y,P.z),U.subVectors(P,V).normalize(),x.push(U.x,U.y,U.z),B.push(pe/n),B.push(We/i)}}for(let pe=1;pe<=n;pe++)for(let de=1;de<=i;de++){const We=(i+1)*(pe-1)+(de-1),Pe=(i+1)*pe+(de-1),ke=(i+1)*pe+de,ze=(i+1)*(pe-1)+de;c.push(We,Pe,ze),c.push(Pe,ke,ze)}this.setIndex(c),this.setAttribute("position",new Gn(E,3)),this.setAttribute("normal",new Gn(x,3)),this.setAttribute("uv",new Gn(B,2));function ge(pe,de,We,Pe,ke){const ze=Math.cos(pe),Te=Math.sin(pe),be=We/de*pe,je=Math.cos(be);ke.x=Pe*(2+je)*.5*ze,ke.y=Pe*(2+je)*Te*.5,ke.z=Pe*Math.sin(be)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Oc(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Fc extends wi{constructor(e=new hu(new De(-1,-1,0),new De(-1,1,0),new De(1,1,0)),t=64,n=1,i=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const c=new De,E=new De,x=new Lt;let B=new De;const P=[],U=[],V=[],j=[];ie(),this.setIndex(j),this.setAttribute("position",new Gn(P,3)),this.setAttribute("normal",new Gn(U,3)),this.setAttribute("uv",new Gn(V,2));function ie(){for(let pe=0;pe<t;pe++)X(pe);X(r===!1?t:0),ge(),H()}function X(pe){B=e.getPointAt(pe/t,B);const de=o.normals[pe],We=o.binormals[pe];for(let Pe=0;Pe<=i;Pe++){const ke=Pe/i*Math.PI*2,ze=Math.sin(ke),Te=-Math.cos(ke);E.x=Te*de.x+ze*We.x,E.y=Te*de.y+ze*We.y,E.z=Te*de.z+ze*We.z,E.normalize(),U.push(E.x,E.y,E.z),c.x=B.x+n*E.x,c.y=B.y+n*E.y,c.z=B.z+n*E.z,P.push(c.x,c.y,c.z)}}function H(){for(let pe=1;pe<=t;pe++)for(let de=1;de<=i;de++){const We=(i+1)*(pe-1)+(de-1),Pe=(i+1)*pe+(de-1),ke=(i+1)*pe+de,ze=(i+1)*(pe-1)+de;j.push(We,Pe,ze),j.push(Pe,ke,ze)}}function ge(){for(let pe=0;pe<=t;pe++)for(let de=0;de<=i;de++)x.x=pe/t,x.y=de/i,V.push(x.x,x.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Fc(new vc[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Cf extends wi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new De,r=new De;if(e.index!==null){const o=e.attributes.position,c=e.index;let E=e.groups;E.length===0&&(E=[{start:0,count:c.count,materialIndex:0}]);for(let x=0,B=E.length;x<B;++x){const P=E[x],U=P.start,V=P.count;for(let j=U,ie=U+V;j<ie;j+=3)for(let X=0;X<3;X++){const H=c.getX(j+X),ge=c.getX(j+(X+1)%3);i.fromBufferAttribute(o,H),r.fromBufferAttribute(o,ge),xf(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let c=0,E=o.count/3;c<E;c++)for(let x=0;x<3;x++){const B=3*c+x,P=3*c+(x+1)%3;i.fromBufferAttribute(o,B),r.fromBufferAttribute(o,P),xf(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Gn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function xf(s,e,t){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var bf=Object.freeze({__proto__:null,BoxGeometry:Fo,CapsuleGeometry:yc,CircleGeometry:Ec,ConeGeometry:Cc,CylinderGeometry:Da,DodecahedronGeometry:xc,EdgesGeometry:pf,ExtrudeGeometry:Ic,IcosahedronGeometry:Bc,LatheGeometry:sl,OctahedronGeometry:cl,PlaneGeometry:xa,PolyhedronGeometry:_o,RingGeometry:Rc,ShapeGeometry:Lc,SphereGeometry:hl,TetrahedronGeometry:Dc,TorusGeometry:Pc,TorusKnotGeometry:Oc,TubeGeometry:Fc,WireframeGeometry:Cf});class wf extends is{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Sn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class _f extends Os{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Au extends is{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Sn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pn,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ws,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Mf extends Au{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Lt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Cr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Sn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Sn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Sn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Sf extends is{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Sn(16777215),this.specular=new Sn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pn,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ws,this.combine=Fn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Tf extends is{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Sn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pn,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class If extends is{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pn,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Bf extends is{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Sn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pn,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ws,this.combine=Fn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Rf extends is{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Sn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pn,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Lf extends ds{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ko(s,e,t){return!s||!t&&s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function Df(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function Pf(s){function e(i,r){return s[i]-s[r]}const t=s.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function mu(s,e,t){const n=s.length,i=new s.constructor(n);for(let r=0,o=0;o!==n;++r){const c=t[r]*e;for(let E=0;E!==e;++E)i[o++]=s[c+E]}return i}function gu(s,e,t,n){let i=1,r=s[0];for(;r!==void 0&&r[n]===void 0;)r=s[i++];if(r===void 0)return;let o=r[n];if(o!==void 0)if(Array.isArray(o))do o=r[n],o!==void 0&&(e.push(r.time),t.push.apply(t,o)),r=s[i++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[n],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=s[i++];while(r!==void 0);else do o=r[n],o!==void 0&&(e.push(r.time),t.push(o)),r=s[i++];while(r!==void 0)}function Uv(s,e,t,n,i=30){const r=s.clone();r.name=e;const o=[];for(let E=0;E<r.tracks.length;++E){const x=r.tracks[E],B=x.getValueSize(),P=[],U=[];for(let V=0;V<x.times.length;++V){const j=x.times[V]*i;if(!(j<t||j>=n)){P.push(x.times[V]);for(let ie=0;ie<B;++ie)U.push(x.values[V*B+ie])}}P.length!==0&&(x.times=Ko(P,x.times.constructor),x.values=Ko(U,x.values.constructor),o.push(x))}r.tracks=o;let c=1/0;for(let E=0;E<r.tracks.length;++E)c>r.tracks[E].times[0]&&(c=r.tracks[E].times[0]);for(let E=0;E<r.tracks.length;++E)r.tracks[E].shift(-1*c);return r.resetDuration(),r}function Nv(s,e=0,t=s,n=30){n<=0&&(n=30);const i=t.tracks.length,r=e/n;for(let o=0;o<i;++o){const c=t.tracks[o],E=c.ValueTypeName;if(E==="bool"||E==="string")continue;const x=s.tracks.find(function(H){return H.name===c.name&&H.ValueTypeName===E});if(x===void 0)continue;let B=0;const P=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(B=P/3);let U=0;const V=x.getValueSize();x.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(U=V/3);const j=c.times.length-1;let ie;if(r<=c.times[0]){const H=B,ge=P-B;ie=c.values.slice(H,ge)}else if(r>=c.times[j]){const H=j*P+B,ge=H+P-B;ie=c.values.slice(H,ge)}else{const H=c.createInterpolant(),ge=B,pe=P-B;H.evaluate(r),ie=H.resultBuffer.slice(ge,pe)}E==="quaternion"&&new Xi().fromArray(ie).normalize().conjugate().toArray(ie);const X=x.times.length;for(let H=0;H<X;++H){const ge=H*V+U;if(E==="quaternion")Xi.multiplyQuaternionsFlat(x.values,ge,ie,0,x.values,ge);else{const pe=V-U*2;for(let de=0;de<pe;++de)x.values[ge+de]-=ie[de]}}}return s.blendMode=qt,s}const kv={convertArray:Ko,isTypedArray:Df,getKeyframeOrder:Pf,sortedArray:mu,flattenJSON:gu,subclip:Uv,makeClipAdditive:Nv};class ul{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<i)){for(let c=n+2;;){if(i===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(r=i,i=t[++n],e<i)break t}o=t.length;break n}if(!(e>=r)){const c=t[1];e<c&&(n=2,r=c);for(let E=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===E)break;if(i=r,r=t[--n-1],e>=r)break t}o=n,n=0;break n}break e}for(;n<o;){const c=n+o>>>1;e<t[c]?o=c:n=c+1}if(i=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let o=0;o!==i;++o)t[o]=n[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Of extends ul{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ct,endingEnd:ct}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,o=e+1,c=i[r],E=i[o];if(c===void 0)switch(this.getSettings_().endingStart){case at:r=e,c=2*t-n;break;case ut:r=i.length-2,c=t+i[r]-i[r+1];break;default:r=e,c=n}if(E===void 0)switch(this.getSettings_().endingEnd){case at:o=e,E=2*n-t;break;case ut:o=1,E=n+i[1]-i[0];break;default:o=e-1,E=t}const x=(n-t)*.5,B=this.valueSize;this._weightPrev=x/(t-c),this._weightNext=x/(E-n),this._offsetPrev=r*B,this._offsetNext=o*B}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,E=e*c,x=E-c,B=this._offsetPrev,P=this._offsetNext,U=this._weightPrev,V=this._weightNext,j=(n-t)/(i-t),ie=j*j,X=ie*j,H=-U*X+2*U*ie-U*j,ge=(1+U)*X+(-1.5-2*U)*ie+(-.5+U)*j+1,pe=(-1-V)*X+(1.5+V)*ie+.5*j,de=V*X-V*ie;for(let We=0;We!==c;++We)r[We]=H*o[B+We]+ge*o[x+We]+pe*o[E+We]+de*o[P+We];return r}}class vu extends ul{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,E=e*c,x=E-c,B=(n-t)/(i-t),P=1-B;for(let U=0;U!==c;++U)r[U]=o[x+U]*P+o[E+U]*B;return r}}class Ff extends ul{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ns{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ko(t,this.TimeBufferType),this.values=Ko(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ko(e.times,Array),values:Ko(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Ff(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new vu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Of(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Je:t=this.InterpolantFactoryMethodDiscrete;break;case Xe:t=this.InterpolantFactoryMethodLinear;break;case ht:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Je;case this.InterpolantFactoryMethodLinear:return Xe;case this.InterpolantFactoryMethodSmooth:return ht}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,o=i-1;for(;r!==i&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;if(++o,r!==0||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);const c=this.getValueSize();this.times=n.slice(r,o),this.values=this.values.slice(r*c,o*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let c=0;c!==r;c++){const E=n[c];if(typeof E=="number"&&isNaN(E)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,E),e=!1;break}if(o!==null&&o>E){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,E,o),e=!1;break}o=E}if(i!==void 0&&Df(i))for(let c=0,E=i.length;c!==E;++c){const x=i[c];if(isNaN(x)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,x),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===ht,r=e.length-1;let o=1;for(let c=1;c<r;++c){let E=!1;const x=e[c],B=e[c+1];if(x!==B&&(c!==1||x!==e[0]))if(i)E=!0;else{const P=c*n,U=P-n,V=P+n;for(let j=0;j!==n;++j){const ie=t[P+j];if(ie!==t[U+j]||ie!==t[V+j]){E=!0;break}}}if(E){if(c!==o){e[o]=e[c];const P=c*n,U=o*n;for(let V=0;V!==n;++V)t[U+V]=t[P+V]}++o}}if(r>0){e[o]=e[r];for(let c=r*n,E=o*n,x=0;x!==n;++x)t[E+x]=t[c+x];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Ns.prototype.TimeBufferType=Float32Array,Ns.prototype.ValueBufferType=Float32Array,Ns.prototype.DefaultInterpolation=Xe;class Xo extends Ns{}Xo.prototype.ValueTypeName="bool",Xo.prototype.ValueBufferType=Array,Xo.prototype.DefaultInterpolation=Je,Xo.prototype.InterpolantFactoryMethodLinear=void 0,Xo.prototype.InterpolantFactoryMethodSmooth=void 0;class yu extends Ns{}yu.prototype.ValueTypeName="color";class dl extends Ns{}dl.prototype.ValueTypeName="number";class Uf extends ul{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,E=(n-t)/(i-t);let x=e*c;for(let B=x+c;x!==B;x+=4)Xi.slerpFlat(r,0,o,x-c,o,x,E);return r}}class Oa extends Ns{InterpolantFactoryMethodLinear(e){return new Uf(this.times,this.values,this.getValueSize(),e)}}Oa.prototype.ValueTypeName="quaternion",Oa.prototype.DefaultInterpolation=Xe,Oa.prototype.InterpolantFactoryMethodSmooth=void 0;class Yo extends Ns{}Yo.prototype.ValueTypeName="string",Yo.prototype.ValueBufferType=Array,Yo.prototype.DefaultInterpolation=Je,Yo.prototype.InterpolantFactoryMethodLinear=void 0,Yo.prototype.InterpolantFactoryMethodSmooth=void 0;class fl extends Ns{}fl.prototype.ValueTypeName="vector";class pl{constructor(e="",t=-1,n=[],i=Ct){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=ls(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let o=0,c=n.length;o!==c;++o)t.push(Qv(n[o]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,o=n.length;r!==o;++r)t.push(Ns.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,o=[];for(let c=0;c<r;c++){let E=[],x=[];E.push((c+r-1)%r,c,(c+1)%r),x.push(0,1,0);const B=Pf(E);E=mu(E,1,B),x=mu(x,1,B),!i&&E[0]===0&&(E.push(r),x.push(x[0])),o.push(new dl(".morphTargetInfluences["+t[c].name+"]",E,x).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let c=0,E=e.length;c<E;c++){const x=e[c],B=x.name.match(r);if(B&&B.length>1){const P=B[1];let U=i[P];U||(i[P]=U=[]),U.push(x)}}const o=[];for(const c in i)o.push(this.CreateFromMorphTargetSequence(c,i[c],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(P,U,V,j,ie){if(V.length!==0){const X=[],H=[];gu(V,X,H,j),X.length!==0&&ie.push(new P(U,X,H))}},i=[],r=e.name||"default",o=e.fps||30,c=e.blendMode;let E=e.length||-1;const x=e.hierarchy||[];for(let P=0;P<x.length;P++){const U=x[P].keys;if(!(!U||U.length===0))if(U[0].morphTargets){const V={};let j;for(j=0;j<U.length;j++)if(U[j].morphTargets)for(let ie=0;ie<U[j].morphTargets.length;ie++)V[U[j].morphTargets[ie]]=-1;for(const ie in V){const X=[],H=[];for(let ge=0;ge!==U[j].morphTargets.length;++ge){const pe=U[j];X.push(pe.time),H.push(pe.morphTarget===ie?1:0)}i.push(new dl(".morphTargetInfluence["+ie+"]",X,H))}E=V.length*o}else{const V=".bones["+t[P].name+"]";n(fl,V+".position",U,"pos",i),n(Oa,V+".quaternion",U,"rot",i),n(fl,V+".scale",U,"scl",i)}}return i.length===0?null:new this(r,E,i,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Gv(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return dl;case"vector":case"vector2":case"vector3":case"vector4":return fl;case"color":return yu;case"quaternion":return Oa;case"bool":case"boolean":return Xo;case"string":return Yo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function Qv(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Gv(s.type);if(s.times===void 0){const t=[],n=[];gu(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const so={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class Eu{constructor(e,t,n){const i=this;let r=!1,o=0,c=0,E;const x=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(B){c++,r===!1&&i.onStart!==void 0&&i.onStart(B,o,c),r=!0},this.itemEnd=function(B){o++,i.onProgress!==void 0&&i.onProgress(B,o,c),o===c&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(B){i.onError!==void 0&&i.onError(B)},this.resolveURL=function(B){return E?E(B):B},this.setURLModifier=function(B){return E=B,this},this.addHandler=function(B,P){return x.push(B,P),this},this.removeHandler=function(B){const P=x.indexOf(B);return P!==-1&&x.splice(P,2),this},this.getHandler=function(B){for(let P=0,U=x.length;P<U;P+=2){const V=x[P],j=x[P+1];if(V.global&&(V.lastIndex=0),V.test(B))return j}return null}}}const Nf=new Eu;class ys{constructor(e){this.manager=e!==void 0?e:Nf,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,r){n.load(e,i,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}ys.DEFAULT_MATERIAL_NAME="__DEFAULT";const oo={};class Vv extends Error{constructor(e,t){super(e),this.response=t}}class ao extends ys{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=so.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(oo[e]!==void 0){oo[e].push({onLoad:t,onProgress:n,onError:i});return}oo[e]=[],oo[e].push({onLoad:t,onProgress:n,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,E=this.responseType;fetch(o).then(x=>{if(x.status===200||x.status===0){if(x.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||x.body===void 0||x.body.getReader===void 0)return x;const B=oo[e],P=x.body.getReader(),U=x.headers.get("X-File-Size")||x.headers.get("Content-Length"),V=U?parseInt(U):0,j=V!==0;let ie=0;const X=new ReadableStream({start(H){ge();function ge(){P.read().then(({done:pe,value:de})=>{if(pe)H.close();else{ie+=de.byteLength;const We=new ProgressEvent("progress",{lengthComputable:j,loaded:ie,total:V});for(let Pe=0,ke=B.length;Pe<ke;Pe++){const ze=B[Pe];ze.onProgress&&ze.onProgress(We)}H.enqueue(de),ge()}})}}});return new Response(X)}else throw new Vv(`fetch for "${x.url}" responded with ${x.status}: ${x.statusText}`,x)}).then(x=>{switch(E){case"arraybuffer":return x.arrayBuffer();case"blob":return x.blob();case"document":return x.text().then(B=>new DOMParser().parseFromString(B,c));case"json":return x.json();default:if(c===void 0)return x.text();{const P=/charset="?([^;"\s]*)"?/i.exec(c),U=P&&P[1]?P[1].toLowerCase():void 0,V=new TextDecoder(U);return x.arrayBuffer().then(j=>V.decode(j))}}}).then(x=>{so.add(e,x);const B=oo[e];delete oo[e];for(let P=0,U=B.length;P<U;P++){const V=B[P];V.onLoad&&V.onLoad(x)}}).catch(x=>{const B=oo[e];if(B===void 0)throw this.manager.itemError(e),x;delete oo[e];for(let P=0,U=B.length;P<U;P++){const V=B[P];V.onError&&V.onError(x)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Hv extends ys{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new ao(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(E){i?i(E):console.error(E),r.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=pl.parse(e[n]);t.push(i)}return t}}class zv extends ys{constructor(e){super(e)}load(e,t,n,i){const r=this,o=[],c=new Ac,E=new ao(this.manager);E.setPath(this.path),E.setResponseType("arraybuffer"),E.setRequestHeader(this.requestHeader),E.setWithCredentials(r.withCredentials);let x=0;function B(P){E.load(e[P],function(U){const V=r.parse(U,!0);o[P]={width:V.width,height:V.height,format:V.format,mipmaps:V.mipmaps},x+=1,x===6&&(V.mipmapCount===1&&(c.minFilter=Bn),c.image=o,c.format=V.format,c.needsUpdate=!0,t&&t(c))},n,i)}if(Array.isArray(e))for(let P=0,U=e.length;P<U;++P)B(P);else E.load(e,function(P){const U=r.parse(P,!0);if(U.isCubemap){const V=U.mipmaps.length/U.mipmapCount;for(let j=0;j<V;j++){o[j]={mipmaps:[]};for(let ie=0;ie<U.mipmapCount;ie++)o[j].mipmaps.push(U.mipmaps[j*U.mipmapCount+ie]),o[j].format=U.format,o[j].width=U.width,o[j].height=U.height}c.image=o}else c.image.width=U.width,c.image.height=U.height,c.mipmaps=U.mipmaps;U.mipmapCount===1&&(c.minFilter=Bn),c.format=U.format,c.needsUpdate=!0,t&&t(c)},n,i);return c}}class Al extends ys{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=so.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;const c=Po("img");function E(){B(),so.add(e,this),t&&t(this),r.manager.itemEnd(e)}function x(P){B(),i&&i(P),r.manager.itemError(e),r.manager.itemEnd(e)}function B(){c.removeEventListener("load",E,!1),c.removeEventListener("error",x,!1)}return c.addEventListener("load",E,!1),c.addEventListener("error",x,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),r.manager.itemStart(e),c.src=e,c}}class jv extends ys{constructor(e){super(e)}load(e,t,n,i){const r=new Wa;r.colorSpace=Mn;const o=new Al(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let c=0;function E(x){o.load(e[x],function(B){r.images[x]=B,c++,c===6&&(r.needsUpdate=!0,t&&t(r))},void 0,i)}for(let x=0;x<e.length;++x)E(x);return r}}class Wv extends ys{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new xo,c=new ao(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(r.withCredentials),c.load(e,function(E){let x;try{x=r.parse(E)}catch(B){if(i!==void 0)i(B);else{console.error(B);return}}x.image!==void 0?o.image=x.image:x.data!==void 0&&(o.image.width=x.width,o.image.height=x.height,o.image.data=x.data),o.wrapS=x.wrapS!==void 0?x.wrapS:He,o.wrapT=x.wrapT!==void 0?x.wrapT:He,o.magFilter=x.magFilter!==void 0?x.magFilter:Bn,o.minFilter=x.minFilter!==void 0?x.minFilter:Bn,o.anisotropy=x.anisotropy!==void 0?x.anisotropy:1,x.colorSpace!==void 0&&(o.colorSpace=x.colorSpace),x.flipY!==void 0&&(o.flipY=x.flipY),x.format!==void 0&&(o.format=x.format),x.type!==void 0&&(o.type=x.type),x.mipmaps!==void 0&&(o.mipmaps=x.mipmaps,o.minFilter=Oi),x.mipmapCount===1&&(o.minFilter=Bn),x.generateMipmaps!==void 0&&(o.generateMipmaps=x.generateMipmaps),o.needsUpdate=!0,t&&t(o,x)},n,i),o}}class Kv extends ys{constructor(e){super(e)}load(e,t,n,i){const r=new fr,o=new Al(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(c){r.image=c,r.needsUpdate=!0,t!==void 0&&t(r)},n,i),r}}class Mo extends Yi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Sn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class kf extends Mo{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Yi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Sn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Cu=new On,Gf=new De,Qf=new De;class xu{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Lt(512,512),this.map=null,this.mapPass=null,this.matrix=new On,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ka,this._frameExtents=new Lt(1,1),this._viewportCount=1,this._viewports=[new zi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Gf.setFromMatrixPosition(e.matrixWorld),t.position.copy(Gf),Qf.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Qf),t.updateMatrixWorld(),Cu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Cu),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Cu)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Xv extends xu{constructor(){super(new Gr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=uo*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||i!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Vf extends Mo{constructor(e,t,n=0,i=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Yi.DEFAULT_UP),this.updateMatrix(),this.target=new Yi,this.distance=n,this.angle=i,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new Xv}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Hf=new On,ml=new De,bu=new De;class Yv extends xu{constructor(){super(new Gr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Lt(4,2),this._viewportCount=6,this._viewports=[new zi(2,1,1,1),new zi(0,1,1,1),new zi(3,1,1,1),new zi(1,1,1,1),new zi(3,0,1,1),new zi(1,0,1,1)],this._cubeDirections=[new De(1,0,0),new De(-1,0,0),new De(0,0,1),new De(0,0,-1),new De(0,1,0),new De(0,-1,0)],this._cubeUps=[new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,0,1),new De(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),ml.setFromMatrixPosition(e.matrixWorld),n.position.copy(ml),bu.copy(n.position),bu.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(bu),n.updateMatrixWorld(),i.makeTranslation(-ml.x,-ml.y,-ml.z),Hf.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hf)}}class zf extends Mo{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Yv}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class qv extends xu{constructor(){super(new Kl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jf extends Mo{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Yi.DEFAULT_UP),this.updateMatrix(),this.target=new Yi,this.shadow=new qv}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Wf extends Mo{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Kf extends Mo{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Xf{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new De)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*i)),t.addScaledVector(o[5],1.092548*(i*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(n*r)),t.addScaledVector(o[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*i),t.addScaledVector(o[2],1.023328*r),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*i),t.addScaledVector(o[5],.858086*i*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],.858086*n*r),t.addScaledVector(o[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class Yf extends Mo{constructor(e=new Xf,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Uc extends ys{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,o=new ao(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(E){i?i(E):console.error(E),r.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const i=Uc.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Sn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(i.uniforms[r]={},o.type){case"t":i.uniforms[r].value=n(o.value);break;case"c":i.uniforms[r].value=new Sn().setHex(o.value);break;case"v2":i.uniforms[r].value=new Lt().fromArray(o.value);break;case"v3":i.uniforms[r].value=new De().fromArray(o.value);break;case"v4":i.uniforms[r].value=new zi().fromArray(o.value);break;case"m3":i.uniforms[r].value=new ci().fromArray(o.value);break;case"m4":i.uniforms[r].value=new On().fromArray(o.value);break;default:i.uniforms[r].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),i.normalScale=new Lt().fromArray(r)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Lt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:wf,SpriteMaterial:Kh,RawShaderMaterial:_f,ShaderMaterial:Os,PointsMaterial:tu,MeshPhysicalMaterial:Mf,MeshStandardMaterial:Au,MeshPhongMaterial:Sf,MeshToonMaterial:Tf,MeshNormalMaterial:If,MeshLambertMaterial:Bf,MeshDepthMaterial:Hh,MeshDistanceMaterial:zh,MeshBasicMaterial:yo,MeshMatcapMaterial:Rf,LineDashedMaterial:Lf,LineBasicMaterial:ds,Material:is};return new t[e]}}class wu{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class qf extends wi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Jf extends ys{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new ao(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(E){i?i(E):console.error(E),r.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(V,j){if(t[j]!==void 0)return t[j];const X=V.interleavedBuffers[j],H=r(V,X.buffer),ge=fo(X.type,H),pe=new $l(ge,X.stride);return pe.uuid=X.uuid,t[j]=pe,pe}function r(V,j){if(n[j]!==void 0)return n[j];const X=V.arrayBuffers[j],H=new Uint32Array(X).buffer;return n[j]=H,H}const o=e.isInstancedBufferGeometry?new qf:new wi,c=e.data.index;if(c!==void 0){const V=fo(c.type,c.array);o.setIndex(new lr(V,1))}const E=e.data.attributes;for(const V in E){const j=E[V];let ie;if(j.isInterleavedBufferAttribute){const X=i(e.data,j.data);ie=new Ho(X,j.itemSize,j.offset,j.normalized)}else{const X=fo(j.type,j.array),H=j.isInstancedBufferAttribute?Ba:lr;ie=new H(X,j.itemSize,j.normalized)}j.name!==void 0&&(ie.name=j.name),j.usage!==void 0&&ie.setUsage(j.usage),o.setAttribute(V,ie)}const x=e.data.morphAttributes;if(x)for(const V in x){const j=x[V],ie=[];for(let X=0,H=j.length;X<H;X++){const ge=j[X];let pe;if(ge.isInterleavedBufferAttribute){const de=i(e.data,ge.data);pe=new Ho(de,ge.itemSize,ge.offset,ge.normalized)}else{const de=fo(ge.type,ge.array);pe=new lr(de,ge.itemSize,ge.normalized)}ge.name!==void 0&&(pe.name=ge.name),ie.push(pe)}o.morphAttributes[V]=ie}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const P=e.data.groups||e.data.drawcalls||e.data.offsets;if(P!==void 0)for(let V=0,j=P.length;V!==j;++V){const ie=P[V];o.addGroup(ie.start,ie.count,ie.materialIndex)}const U=e.data.boundingSphere;if(U!==void 0){const V=new De;U.center!==void 0&&V.fromArray(U.center),o.boundingSphere=new Nr(V,U.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Jv extends ys{constructor(e){super(e)}load(e,t,n,i){const r=this,o=this.path===""?wu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const c=new ao(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(E){let x=null;try{x=JSON.parse(E)}catch(P){i!==void 0&&i(P),console.error("THREE:ObjectLoader: Can't parse "+e+".",P.message);return}const B=x.metadata;if(B===void 0||B.type===void 0||B.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(x,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?wu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const r=new ao(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,t),c=JSON.parse(o),E=c.metadata;if(E===void 0||E.type===void 0||E.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(c)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(x)}),c=this.parseTextures(e.textures,o),E=this.parseMaterials(e.materials,c),x=this.parseObject(e.object,r,E,c,n),B=this.parseSkeletons(e.skeletons,x);if(this.bindSkeletons(x,B),t!==void 0){let P=!1;for(const U in o)if(o[U].data instanceof HTMLImageElement){P=!0;break}P===!1&&t(x)}return x}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),c=this.parseMaterials(e.materials,o),E=this.parseObject(e.object,i,c,o,t),x=this.parseSkeletons(e.skeletons,E);return this.bindSkeletons(E,x),E}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const r=new jo().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(r){r.isBone&&(i[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=new sc().fromJSON(e[r],i);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new Jf;for(let o=0,c=e.length;o<c;o++){let E;const x=e[o];switch(x.type){case"BufferGeometry":case"InstancedBufferGeometry":E=r.parse(x);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var i=new THREE.LegacyJSONLoader;E=i.parse(x,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:x.type in bf?E=bf[x.type].fromJSON(x,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${x.type}"`)}E.uuid=x.uuid,x.name!==void 0&&(E.name=x.name),x.userData!==void 0&&(E.userData=x.userData),n[x.uuid]=E}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const r=new Uc;r.setTextures(t);for(let o=0,c=e.length;o<c;o++){const E=e[o];n[E.uuid]===void 0&&(n[E.uuid]=r.parse(E)),i[E.uuid]=n[E.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],r=pl.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function o(E){return n.manager.itemStart(E),r.load(E,function(){n.manager.itemEnd(E)},void 0,function(){n.manager.itemError(E),n.manager.itemEnd(E)})}function c(E){if(typeof E=="string"){const x=E,B=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(x)?x:n.resourcePath+x;return o(B)}else return E.data?{data:fo(E.type,E.data),width:E.width,height:E.height}:null}if(e!==void 0&&e.length>0){const E=new Eu(t);r=new Al(E),r.setCrossOrigin(this.crossOrigin);for(let x=0,B=e.length;x<B;x++){const P=e[x],U=P.url;if(Array.isArray(U)){const V=[];for(let j=0,ie=U.length;j<ie;j++){const X=U[j],H=c(X);H!==null&&(H instanceof HTMLImageElement?V.push(H):V.push(new xo(H.data,H.width,H.height)))}i[P.uuid]=new gr(V)}else{const V=c(P.url);i[P.uuid]=new gr(V)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function r(o){if(typeof o=="string"){const c=o,E=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await i.loadAsync(E)}else return o.data?{data:fo(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new Al(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,c=e.length;o<c;o++){const E=e[o],x=E.url;if(Array.isArray(x)){const B=[];for(let P=0,U=x.length;P<U;P++){const V=x[P],j=await r(V);j!==null&&(j instanceof HTMLImageElement?B.push(j):B.push(new xo(j.data,j.width,j.height)))}n[E.uuid]=new gr(B)}else{const B=await r(E.url);n[E.uuid]=new gr(B)}}}return n}parseTextures(e,t){function n(r,o){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const i={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=e[r];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);const E=t[c.image],x=E.data;let B;Array.isArray(x)?(B=new Wa,x.length===6&&(B.needsUpdate=!0)):(x&&x.data?B=new xo:B=new fr,x&&(B.needsUpdate=!0)),B.source=E,B.uuid=c.uuid,c.name!==void 0&&(B.name=c.name),c.mapping!==void 0&&(B.mapping=n(c.mapping,Zv)),c.channel!==void 0&&(B.channel=c.channel),c.offset!==void 0&&B.offset.fromArray(c.offset),c.repeat!==void 0&&B.repeat.fromArray(c.repeat),c.center!==void 0&&B.center.fromArray(c.center),c.rotation!==void 0&&(B.rotation=c.rotation),c.wrap!==void 0&&(B.wrapS=n(c.wrap[0],Zf),B.wrapT=n(c.wrap[1],Zf)),c.format!==void 0&&(B.format=c.format),c.internalFormat!==void 0&&(B.internalFormat=c.internalFormat),c.type!==void 0&&(B.type=c.type),c.colorSpace!==void 0&&(B.colorSpace=c.colorSpace),c.minFilter!==void 0&&(B.minFilter=n(c.minFilter,$f)),c.magFilter!==void 0&&(B.magFilter=n(c.magFilter,$f)),c.anisotropy!==void 0&&(B.anisotropy=c.anisotropy),c.flipY!==void 0&&(B.flipY=c.flipY),c.generateMipmaps!==void 0&&(B.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(B.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(B.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(B.compareFunction=c.compareFunction),c.userData!==void 0&&(B.userData=c.userData),i[c.uuid]=B}return i}parseObject(e,t,n,i,r){let o;function c(U){return t[U]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",U),t[U]}function E(U){if(U!==void 0){if(Array.isArray(U)){const V=[];for(let j=0,ie=U.length;j<ie;j++){const X=U[j];n[X]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",X),V.push(n[X])}return V}return n[U]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",U),n[U]}}function x(U){return i[U]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",U),i[U]}let B,P;switch(e.type){case"Scene":o=new Dd,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Sn(e.background):o.background=x(e.background)),e.environment!==void 0&&(o.environment=x(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Zl(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Jl(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Gr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Kl(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Wf(e.color,e.intensity);break;case"DirectionalLight":o=new jf(e.color,e.intensity);break;case"PointLight":o=new zf(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Kf(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Vf(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new kf(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new Yf().fromJSON(e);break;case"SkinnedMesh":B=c(e.geometry),P=E(e.material),o=new jd(B,P),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":B=c(e.geometry),P=E(e.material),o=new Dr(B,P);break;case"InstancedMesh":B=c(e.geometry),P=E(e.material);const U=e.count,V=e.instanceMatrix,j=e.instanceColor;o=new Yd(B,P,U),o.instanceMatrix=new Ba(new Float32Array(V.array),16),j!==void 0&&(o.instanceColor=new Ba(new Float32Array(j.array),j.itemSize));break;case"BatchedMesh":B=c(e.geometry),P=E(e.material),o=new Zd(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,P),o.geometry=B,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(ie=>{const X=new br;X.min.fromArray(ie.boxMin),X.max.fromArray(ie.boxMax);const H=new Nr;return H.radius=ie.sphereRadius,H.center.fromArray(ie.sphereCenter),{boxInitialized:ie.boxInitialized,box:X,sphereInitialized:ie.sphereInitialized,sphere:H}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=x(e.matricesTexture.uuid);break;case"LOD":o=new kd;break;case"Line":o=new wo(c(e.geometry),E(e.material));break;case"LineLoop":o=new rf(c(e.geometry),E(e.material));break;case"LineSegments":o=new Ws(c(e.geometry),E(e.material));break;case"PointCloud":case"Points":o=new of(c(e.geometry),E(e.material));break;case"Sprite":o=new Ud(E(e.material));break;case"Group":o=new Qo;break;case"Bone":o=new Jh;break;default:o=new Yi}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const U=e.children;for(let V=0;V<U.length;V++)o.add(this.parseObject(U[V],t,n,i,r))}if(e.animations!==void 0){const U=e.animations;for(let V=0;V<U.length;V++){const j=U[V];o.animations.push(r[j])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const U=e.levels;for(let V=0;V<U.length;V++){const j=U[V],ie=o.getObjectByProperty("uuid",j.object);ie!==void 0&&o.addLevel(ie,j.distance,j.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}}const Zv={UVMapping:Ue,CubeReflectionMapping:ee,CubeRefractionMapping:D,EquirectangularReflectionMapping:G,EquirectangularRefractionMapping:ue,CubeUVReflectionMapping:xe},Zf={RepeatWrapping:Ne,ClampToEdgeWrapping:He,MirroredRepeatWrapping:Gt},$f={NearestFilter:Yt,NearestMipmapNearestFilter:Ht,NearestMipmapLinearFilter:fn,LinearFilter:Bn,LinearMipmapNearestFilter:bi,LinearMipmapLinearFilter:Oi};class $v extends ys{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=so.get(e);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(x=>{t&&t(x),r.manager.itemEnd(e)}).catch(x=>{i&&i(x)});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader;const E=fetch(e,c).then(function(x){return x.blob()}).then(function(x){return createImageBitmap(x,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(x){return so.add(e,x),t&&t(x),r.manager.itemEnd(e),x}).catch(function(x){i&&i(x),so.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)});so.add(e,E),r.manager.itemStart(e)}}let Nc;class _u{static getContext(){return Nc===void 0&&(Nc=new(window.AudioContext||window.webkitAudioContext)),Nc}static setContext(e){Nc=e}}class ey extends ys{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new ao(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(E){try{const x=E.slice(0);_u.getContext().decodeAudioData(x,function(P){t(P)}).catch(c)}catch(x){c(x)}},n,i);function c(E){i?i(E):console.error(E),r.manager.itemError(e)}}}const ep=new On,tp=new On,qo=new On;class ty{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Gr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Gr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,qo.copy(e.projectionMatrix);const i=t.eyeSep/2,r=i*t.near/t.focus,o=t.near*Math.tan(Js*t.fov*.5)/t.zoom;let c,E;tp.elements[12]=-i,ep.elements[12]=i,c=-o*t.aspect+r,E=o*t.aspect+r,qo.elements[0]=2*t.near/(E-c),qo.elements[8]=(E+c)/(E-c),this.cameraL.projectionMatrix.copy(qo),c=-o*t.aspect-r,E=o*t.aspect-r,qo.elements[0]=2*t.near/(E-c),qo.elements[8]=(E+c)/(E-c),this.cameraR.projectionMatrix.copy(qo)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(tp),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ep)}}class np{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=ip(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=ip();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function ip(){return(typeof performance>"u"?Date:performance).now()}const Jo=new De,rp=new Xi,ny=new De,Zo=new De;class iy extends Yi{constructor(){super(),this.type="AudioListener",this.context=_u.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new np}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Jo,rp,ny),Zo.set(0,0,-1).applyQuaternion(rp),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Jo.x,i),t.positionY.linearRampToValueAtTime(Jo.y,i),t.positionZ.linearRampToValueAtTime(Jo.z,i),t.forwardX.linearRampToValueAtTime(Zo.x,i),t.forwardY.linearRampToValueAtTime(Zo.y,i),t.forwardZ.linearRampToValueAtTime(Zo.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Jo.x,Jo.y,Jo.z),t.setOrientation(Zo.x,Zo.y,Zo.z,n.x,n.y,n.z)}}class sp extends Yi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const $o=new De,op=new Xi,ry=new De,ea=new De;class sy extends sp{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose($o,op,ry),ea.set(0,0,1).applyQuaternion(op);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime($o.x,n),t.positionY.linearRampToValueAtTime($o.y,n),t.positionZ.linearRampToValueAtTime($o.z,n),t.orientationX.linearRampToValueAtTime(ea.x,n),t.orientationY.linearRampToValueAtTime(ea.y,n),t.orientationZ.linearRampToValueAtTime(ea.z,n)}else t.setPosition($o.x,$o.y,$o.z),t.setOrientation(ea.x,ea.y,ea.z)}}class oy{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class ap{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,r,o;switch(t){case"quaternion":i=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let c=0;c!==i;++c)n[r+c]=n[c];o=t}else{o+=t;const c=t/o;this._mixBufferRegion(n,r,0,c,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const E=t*this._origIndex;this._mixBufferRegion(n,i,E,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let E=t,x=t+t;E!==x;++E)if(n[E]!==n[E+t]){c.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,o=i;r!==o;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let o=0;o!==r;++o)e[t+o]=e[n+o]}_slerp(e,t,n,i){Xi.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const o=this._workIndex*r;Xi.multiplyQuaternionsFlat(e,o,e,t,e,n),Xi.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,n,i,r){const o=1-i;for(let c=0;c!==r;++c){const E=t+c;e[E]=e[E]*o+e[n+c]*i}}_lerpAdditive(e,t,n,i,r){for(let o=0;o!==r;++o){const c=t+o;e[c]=e[c]+e[n+o]*i}}}const Mu="\\[\\]\\.:\\/",ay=new RegExp("["+Mu+"]","g"),Su="[^"+Mu+"]",ly="[^"+Mu.replace("\\.","")+"]",cy=/((?:WC+[\/:])*)/.source.replace("WC",Su),hy=/(WCOD+)?/.source.replace("WCOD",ly),uy=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Su),dy=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Su),fy=new RegExp("^"+cy+hy+uy+dy+"$"),py=["material","materials","bones","map"];class Ay{constructor(e,t,n){const i=n||ji.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class ji{constructor(e,t,n){this.path=t,this.parsedPath=n||ji.parseTrackName(t),this.node=ji.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new ji.Composite(e,t,n):new ji(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(ay,"")}static parseTrackName(e){const t=fy.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const r=n.nodeName.substring(i+1);py.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let o=0;o<r.length;o++){const c=r[o];if(c.name===t||c.uuid===t)return c;const E=n(c.children);if(E)return E}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=ji.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let x=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let B=0;B<e.length;B++)if(e[B].name===x){x=B;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(x!==void 0){if(e[x]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[x]}}const o=e[i];if(o===void 0){const x=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+x+"."+i+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let E=this.BindingType.Direct;if(r!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}E=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(E=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(E=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[E],this.setValue=this.SetterByBindingTypeAndVersioning[E][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ji.Composite=Ay,ji.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ji.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ji.prototype.GetterByBindingType=[ji.prototype._getValue_direct,ji.prototype._getValue_array,ji.prototype._getValue_arrayElement,ji.prototype._getValue_toArray],ji.prototype.SetterByBindingTypeAndVersioning=[[ji.prototype._setValue_direct,ji.prototype._setValue_direct_setNeedsUpdate,ji.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_array,ji.prototype._setValue_array_setNeedsUpdate,ji.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_arrayElement,ji.prototype._setValue_arrayElement_setNeedsUpdate,ji.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_fromArray,ji.prototype._setValue_fromArray_setNeedsUpdate,ji.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class my{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ls(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,o=r.length;let c,E=e.length,x=this.nCachedObjects_;for(let B=0,P=arguments.length;B!==P;++B){const U=arguments[B],V=U.uuid;let j=t[V];if(j===void 0){j=E++,t[V]=j,e.push(U);for(let ie=0,X=o;ie!==X;++ie)r[ie].push(new ji(U,n[ie],i[ie]))}else if(j<x){c=e[j];const ie=--x,X=e[ie];t[X.uuid]=j,e[j]=X,t[V]=ie,e[ie]=U;for(let H=0,ge=o;H!==ge;++H){const pe=r[H],de=pe[ie];let We=pe[j];pe[j]=de,We===void 0&&(We=new ji(U,n[H],i[H])),pe[ie]=We}}else e[j]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=x}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let o=0,c=arguments.length;o!==c;++o){const E=arguments[o],x=E.uuid,B=t[x];if(B!==void 0&&B>=r){const P=r++,U=e[P];t[U.uuid]=B,e[B]=U,t[x]=P,e[P]=E;for(let V=0,j=i;V!==j;++V){const ie=n[V],X=ie[P],H=ie[B];ie[B]=X,ie[P]=H}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,o=e.length;for(let c=0,E=arguments.length;c!==E;++c){const x=arguments[c],B=x.uuid,P=t[B];if(P!==void 0)if(delete t[B],P<r){const U=--r,V=e[U],j=--o,ie=e[j];t[V.uuid]=P,e[P]=V,t[ie.uuid]=U,e[U]=ie,e.pop();for(let X=0,H=i;X!==H;++X){const ge=n[X],pe=ge[U],de=ge[j];ge[P]=pe,ge[U]=de,ge.pop()}}else{const U=--o,V=e[U];U>0&&(t[V.uuid]=P),e[P]=V,e.pop();for(let j=0,ie=i;j!==ie;++j){const X=n[j];X[P]=X[U],X.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(i!==void 0)return r[i];const o=this._paths,c=this._parsedPaths,E=this._objects,x=E.length,B=this.nCachedObjects_,P=new Array(x);i=r.length,n[e]=i,o.push(e),c.push(t),r.push(P);for(let U=B,V=E.length;U!==V;++U){const j=E[U];P[U]=new ji(j,e,t)}return P}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,r=this._parsedPaths,o=this._bindings,c=o.length-1,E=o[c],x=e[c];t[x]=n,o[n]=E,o.pop(),r[n]=r[c],r.pop(),i[n]=i[c],i.pop()}}}class lp{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,o=r.length,c=new Array(o),E={endingStart:ct,endingEnd:ct};for(let x=0;x!==o;++x){const B=r[x].createInterpolant(null);c[x]=B,B.settings=E}this._interpolantSettings=E,this._interpolants=c,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Oe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,r=e._clip.duration,o=r/i,c=i/r;e.warp(1,o,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,o=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=i._lendControlInterpolant(),this._timeScaleInterpolant=c);const E=c.parameterPositions,x=c.sampleValues;return E[0]=r,E[1]=r+n,x[0]=e/o,x[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const E=(e-r)*n;E<0||n===0?t=0:(this._startTime=null,t=n*E)}t*=this._updateTimeScale(e);const o=this._updateTime(t),c=this._updateWeight(e);if(c>0){const E=this._interpolants,x=this._propertyBindings;switch(this.blendMode){case qt:for(let B=0,P=E.length;B!==P;++B)E[B].evaluate(o),x[B].accumulateAdditive(c);break;case Ct:default:for(let B=0,P=E.length;B!==P;++B)E[B].evaluate(o),x[B].accumulate(i,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const o=n===Qe;if(e===0)return r===-1?i:o&&(r&1)===1?t-i:i;if(n===fe){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const c=Math.floor(i/t);i-=t*c,r+=Math.abs(c);const E=this.repetitions-r;if(E<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(E===1){const x=e<0;this._setEndings(x,!x,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=i;if(o&&(r&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=at,i.endingEnd=at):(e?i.endingStart=this.zeroSlopeAtStart?at:ct:i.endingStart=ut,t?i.endingEnd=this.zeroSlopeAtEnd?at:ct:i.endingEnd=ut)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const c=o.parameterPositions,E=o.sampleValues;return c[0]=r,E[0]=t,c[1]=r+e,E[1]=n,this}}const gy=new Float32Array(1);class vy extends as{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings,c=e._interpolants,E=n.uuid,x=this._bindingsByRootAndName;let B=x[E];B===void 0&&(B={},x[E]=B);for(let P=0;P!==r;++P){const U=i[P],V=U.name;let j=B[V];if(j!==void 0)++j.referenceCount,o[P]=j;else{if(j=o[P],j!==void 0){j._cacheIndex===null&&(++j.referenceCount,this._addInactiveBinding(j,E,V));continue}const ie=t&&t._propertyBindings[P].binding.parsedPath;j=new ap(ji.create(n,V,ie),U.ValueTypeName,U.getValueSize()),++j.referenceCount,this._addInactiveBinding(j,E,V),o[P]=j}c[P].resultBuffer=j.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,r=this._actionsByClip[i];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const c=o.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,c=o[r],E=c.knownActions,x=E[E.length-1],B=e._byClipCacheIndex;x._byClipCacheIndex=B,E[B]=x,E.pop(),e._byClipCacheIndex=null;const P=c.actionByRoot,U=(e._localRoot||this._root).uuid;delete P[U],E.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,c=o[i],E=t[t.length-1],x=e._cacheIndex;E._cacheIndex=x,t[x]=E,t.pop(),delete c[r],Object.keys(c).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new vu(new Float32Array(2),new Float32Array(2),1,gy),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let o=typeof e=="string"?pl.findByName(i,e):e;const c=o!==null?o.uuid:e,E=this._actionsByClip[c];let x=null;if(n===void 0&&(o!==null?n=o.blendMode:n=Ct),E!==void 0){const P=E.actionByRoot[r];if(P!==void 0&&P.blendMode===n)return P;x=E.knownActions[0],o===null&&(o=x._clip)}if(o===null)return null;const B=new lp(this,o,t,n);return this._bindAction(B,x),this._addInactiveAction(B,c,r),B}existingAction(e,t){const n=t||this._root,i=n.uuid,r=typeof e=="string"?pl.findByName(n,e):e,o=r?r.uuid:e,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let x=0;x!==n;++x)t[x]._update(i,e,r,o);const c=this._bindings,E=this._nActiveBindings;for(let x=0;x!==E;++x)c[x].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(r!==void 0){const o=r.knownActions;for(let c=0,E=o.length;c!==E;++c){const x=o[c];this._deactivateAction(x);const B=x._cacheIndex,P=t[t.length-1];x._cacheIndex=null,x._byClipCacheIndex=null,P._cacheIndex=B,t[B]=P,t.pop(),this._removeInactiveBindingsForAction(x)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const c=n[o].actionByRoot,E=c[t];E!==void 0&&(this._deactivateAction(E),this._removeInactiveAction(E))}const i=this._bindingsByRootAndName,r=i[t];if(r!==void 0)for(const o in r){const c=r[o];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Tu{constructor(e){this.value=e}clone(){return new Tu(this.value.clone===void 0?this.value:this.value.clone())}}let yy=0;class Ey extends as{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:yy++}),this.name="",this.usage=Ro,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Cy extends $l{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class xy{constructor(e,t,n,i,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const cp=new On;class by{constructor(e,t,n=0,i=1/0){this.ray=new kr(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Ll,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return cp.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(cp),this}intersectObject(e,t=!0,n=[]){return Iu(e,this,n,t),n.sort(hp),n}intersectObjects(e,t=!0,n=[]){for(let i=0,r=e.length;i<r;i++)Iu(e[i],this,n,t);return n.sort(hp),n}}function hp(s,e){return s.distance-e.distance}function Iu(s,e,t,n){if(s.layers.test(e.layers)&&s.raycast(e,t),n===!0){const i=s.children;for(let r=0,o=i.length;r<o;r++)Iu(i[r],e,t,!0)}}class wy{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Cr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class _y{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const up=new Lt;class My{constructor(e=new Lt(1/0,1/0),t=new Lt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=up.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,up).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const dp=new De,kc=new De;class Sy{constructor(e=new De,t=new De){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){dp.subVectors(e,this.start),kc.subVectors(this.end,this.start);const n=kc.dot(kc);let r=kc.dot(dp)/n;return t&&(r=Cr(r,0,1)),r}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const fp=new De;class Ty extends Yi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new wi,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,c=1,E=32;o<E;o++,c++){const x=o/E*Math.PI*2,B=c/E*Math.PI*2;i.push(Math.cos(x),Math.sin(x),1,Math.cos(B),Math.sin(B),1)}n.setAttribute("position",new Gn(i,3));const r=new ds({fog:!1,toneMapped:!1});this.cone=new Ws(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),fp.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(fp),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const So=new De,Gc=new On,Bu=new On;class Iy extends Ws{constructor(e){const t=pp(e),n=new wi,i=[],r=[],o=new Sn(0,0,1),c=new Sn(0,1,0);for(let x=0;x<t.length;x++){const B=t[x];B.parent&&B.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(c.r,c.g,c.b))}n.setAttribute("position",new Gn(i,3)),n.setAttribute("color",new Gn(r,3));const E=new ds({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,E),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");Bu.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const c=t[r];c.parent&&c.parent.isBone&&(Gc.multiplyMatrices(Bu,c.matrixWorld),So.setFromMatrixPosition(Gc),i.setXYZ(o,So.x,So.y,So.z),Gc.multiplyMatrices(Bu,c.parent.matrixWorld),So.setFromMatrixPosition(Gc),i.setXYZ(o+1,So.x,So.y,So.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function pp(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push.apply(e,pp(s.children[t]));return e}class By extends Dr{constructor(e,t,n){const i=new hl(t,4,2),r=new yo({wireframe:!0,fog:!1,toneMapped:!1});super(i,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ry=new De,Ap=new Sn,mp=new Sn;class Ly extends Yi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new cl(t);i.rotateY(Math.PI*.5),this.material=new yo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),o=new Float32Array(r.count*3);i.setAttribute("color",new lr(o,3)),this.add(new Dr(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Ap.copy(this.light.color),mp.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const r=n<i/2?Ap:mp;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Ry.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Dy extends Ws{constructor(e=10,t=10,n=4473924,i=8947848){n=new Sn(n),i=new Sn(i);const r=t/2,o=e/t,c=e/2,E=[],x=[];for(let U=0,V=0,j=-c;U<=t;U++,j+=o){E.push(-c,0,j,c,0,j),E.push(j,0,-c,j,0,c);const ie=U===r?n:i;ie.toArray(x,V),V+=3,ie.toArray(x,V),V+=3,ie.toArray(x,V),V+=3,ie.toArray(x,V),V+=3}const B=new wi;B.setAttribute("position",new Gn(E,3)),B.setAttribute("color",new Gn(x,3));const P=new ds({vertexColors:!0,toneMapped:!1});super(B,P),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Py extends Ws{constructor(e=10,t=16,n=8,i=64,r=4473924,o=8947848){r=new Sn(r),o=new Sn(o);const c=[],E=[];if(t>1)for(let P=0;P<t;P++){const U=P/t*(Math.PI*2),V=Math.sin(U)*e,j=Math.cos(U)*e;c.push(0,0,0),c.push(V,0,j);const ie=P&1?r:o;E.push(ie.r,ie.g,ie.b),E.push(ie.r,ie.g,ie.b)}for(let P=0;P<n;P++){const U=P&1?r:o,V=e-e/n*P;for(let j=0;j<i;j++){let ie=j/i*(Math.PI*2),X=Math.sin(ie)*V,H=Math.cos(ie)*V;c.push(X,0,H),E.push(U.r,U.g,U.b),ie=(j+1)/i*(Math.PI*2),X=Math.sin(ie)*V,H=Math.cos(ie)*V,c.push(X,0,H),E.push(U.r,U.g,U.b)}}const x=new wi;x.setAttribute("position",new Gn(c,3)),x.setAttribute("color",new Gn(E,3));const B=new ds({vertexColors:!0,toneMapped:!1});super(x,B),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const gp=new De,Qc=new De,vp=new De;class Oy extends Yi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new wi;i.setAttribute("position",new Gn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new ds({fog:!1,toneMapped:!1});this.lightPlane=new wo(i,r),this.add(this.lightPlane),i=new wi,i.setAttribute("position",new Gn([0,0,0,0,0,1],3)),this.targetLine=new wo(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),gp.setFromMatrixPosition(this.light.matrixWorld),Qc.setFromMatrixPosition(this.light.target.matrixWorld),vp.subVectors(Qc,gp),this.lightPlane.lookAt(Qc),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Qc),this.targetLine.scale.z=vp.length()}}const Vc=new De,Ir=new zl;class Fy extends Ws{constructor(e){const t=new wi,n=new ds({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],o={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(j,ie){E(j),E(ie)}function E(j){i.push(0,0,0),r.push(0,0,0),o[j]===void 0&&(o[j]=[]),o[j].push(i.length/3-1)}t.setAttribute("position",new Gn(i,3)),t.setAttribute("color",new Gn(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const x=new Sn(16755200),B=new Sn(16711680),P=new Sn(43775),U=new Sn(16777215),V=new Sn(3355443);this.setColors(x,B,P,U,V)}setColors(e,t,n,i,r){const c=this.geometry.getAttribute("color");c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,i.r,i.g,i.b),c.setXYZ(39,i.r,i.g,i.b),c.setXYZ(40,r.r,r.g,r.b),c.setXYZ(41,r.r,r.g,r.b),c.setXYZ(42,r.r,r.g,r.b),c.setXYZ(43,r.r,r.g,r.b),c.setXYZ(44,r.r,r.g,r.b),c.setXYZ(45,r.r,r.g,r.b),c.setXYZ(46,r.r,r.g,r.b),c.setXYZ(47,r.r,r.g,r.b),c.setXYZ(48,r.r,r.g,r.b),c.setXYZ(49,r.r,r.g,r.b),c.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;Ir.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Br("c",t,e,Ir,0,0,-1),Br("t",t,e,Ir,0,0,1),Br("n1",t,e,Ir,-n,-i,-1),Br("n2",t,e,Ir,n,-i,-1),Br("n3",t,e,Ir,-n,i,-1),Br("n4",t,e,Ir,n,i,-1),Br("f1",t,e,Ir,-n,-i,1),Br("f2",t,e,Ir,n,-i,1),Br("f3",t,e,Ir,-n,i,1),Br("f4",t,e,Ir,n,i,1),Br("u1",t,e,Ir,n*.7,i*1.1,-1),Br("u2",t,e,Ir,-n*.7,i*1.1,-1),Br("u3",t,e,Ir,0,i*2,-1),Br("cf1",t,e,Ir,-n,0,1),Br("cf2",t,e,Ir,n,0,1),Br("cf3",t,e,Ir,0,-i,1),Br("cf4",t,e,Ir,0,i,1),Br("cn1",t,e,Ir,-n,0,-1),Br("cn2",t,e,Ir,n,0,-1),Br("cn3",t,e,Ir,0,-i,-1),Br("cn4",t,e,Ir,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Br(s,e,t,n,i,r,o){Vc.set(i,r,o).unproject(n);const c=e[s];if(c!==void 0){const E=t.getAttribute("position");for(let x=0,B=c.length;x<B;x++)E.setXYZ(c[x],Vc.x,Vc.y,Vc.z)}}const Hc=new br;class Uy extends Ws{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),r=new wi;r.setIndex(new lr(n,1)),r.setAttribute("position",new lr(i,3)),super(r,new ds({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Hc.setFromObject(this.object),Hc.isEmpty())return;const t=Hc.min,n=Hc.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Ny extends Ws{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new wi;r.setIndex(new lr(n,1)),r.setAttribute("position",new Gn(i,3)),super(r,new ds({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class ky extends wo{constructor(e,t=1,n=16776960){const i=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new wi;o.setAttribute("position",new Gn(r,3)),o.computeBoundingSphere(),super(o,new ds({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],E=new wi;E.setAttribute("position",new Gn(c,3)),E.computeBoundingSphere(),this.add(new Dr(E,new yo({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const yp=new De;let zc,Ru;class Gy extends Yi{constructor(e=new De(0,0,1),t=new De(0,0,0),n=1,i=16776960,r=n*.2,o=r*.2){super(),this.type="ArrowHelper",zc===void 0&&(zc=new wi,zc.setAttribute("position",new Gn([0,0,0,0,1,0],3)),Ru=new Da(0,.5,1,5,1),Ru.translate(0,-.5,0)),this.position.copy(t),this.line=new wo(zc,new ds({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Dr(Ru,new yo({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{yp.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(yp,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Qy extends Ws{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new wi;i.setAttribute("position",new Gn(t,3)),i.setAttribute("color",new Gn(n,3));const r=new ds({vertexColors:!0,toneMapped:!1});super(i,r),this.type="AxesHelper"}setColors(e,t,n){const i=new Sn,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Vy{constructor(){this.type="ShapePath",this.color=new Sn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new rl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,o){return this.currentPath.bezierCurveTo(e,t,n,i,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(H){const ge=[];for(let pe=0,de=H.length;pe<de;pe++){const We=H[pe],Pe=new jo;Pe.curves=We.curves,ge.push(Pe)}return ge}function n(H,ge){const pe=ge.length;let de=!1;for(let We=pe-1,Pe=0;Pe<pe;We=Pe++){let ke=ge[We],ze=ge[Pe],Te=ze.x-ke.x,be=ze.y-ke.y;if(Math.abs(be)>Number.EPSILON){if(be<0&&(ke=ge[Pe],Te=-Te,ze=ge[We],be=-be),H.y<ke.y||H.y>ze.y)continue;if(H.y===ke.y){if(H.x===ke.x)return!0}else{const je=be*(H.x-ke.x)-Te*(H.y-ke.y);if(je===0)return!0;if(je<0)continue;de=!de}}else{if(H.y!==ke.y)continue;if(ze.x<=H.x&&H.x<=ke.x||ke.x<=H.x&&H.x<=ze.x)return!0}}return de}const i=Ks.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,c,E;const x=[];if(r.length===1)return c=r[0],E=new jo,E.curves=c.curves,x.push(E),x;let B=!i(r[0].getPoints());B=e?!B:B;const P=[],U=[];let V=[],j=0,ie;U[j]=void 0,V[j]=[];for(let H=0,ge=r.length;H<ge;H++)c=r[H],ie=c.getPoints(),o=i(ie),o=e?!o:o,o?(!B&&U[j]&&j++,U[j]={s:new jo,p:ie},U[j].s.curves=c.curves,B&&j++,V[j]=[]):V[j].push({h:c,p:ie[0]});if(!U[0])return t(r);if(U.length>1){let H=!1,ge=0;for(let pe=0,de=U.length;pe<de;pe++)P[pe]=[];for(let pe=0,de=U.length;pe<de;pe++){const We=V[pe];for(let Pe=0;Pe<We.length;Pe++){const ke=We[Pe];let ze=!0;for(let Te=0;Te<U.length;Te++)n(ke.p,U[Te].p)&&(pe!==Te&&ge++,ze?(ze=!1,P[Te].push(ke)):H=!0);ze&&P[pe].push(ke)}}ge>0&&H===!1&&(V=P)}let X;for(let H=0,ge=U.length;H<ge;H++){E=U[H].s,x.push(E),X=V[H];for(let pe=0,de=X.length;pe<de;pe++)E.holes.push(X[pe].h)}return x}}class Hy extends As{constructor(e=1,t=1,n=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...i,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:u}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=u)},"./node_modules/three/examples/jsm/libs/ktx-parse.module.js":(W,$,A)=>{A.r($),A.d($,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>Ui,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>Wn,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>Zn,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>Fn,KHR_DF_CHANNEL_RGBSDA_RED:()=>xn,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>Si,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>L,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>_,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>f,KHR_DF_MODEL_ASTC:()=>C,KHR_DF_MODEL_ETC1:()=>d,KHR_DF_MODEL_ETC1S:()=>S,KHR_DF_MODEL_ETC2:()=>p,KHR_DF_MODEL_RGBSDA:()=>g,KHR_DF_MODEL_UNSPECIFIED:()=>y,KHR_DF_PRIMARIES_ACES:()=>Bt,KHR_DF_PRIMARIES_ACESCC:()=>kt,KHR_DF_PRIMARIES_ADOBERGB:()=>kn,KHR_DF_PRIMARIES_BT2020:()=>ft,KHR_DF_PRIMARIES_BT601_EBU:()=>Ze,KHR_DF_PRIMARIES_BT601_SMPTE:()=>qe,KHR_DF_PRIMARIES_BT709:()=>_e,KHR_DF_PRIMARIES_CIEXYZ:()=>Et,KHR_DF_PRIMARIES_DISPLAYP3:()=>Jn,KHR_DF_PRIMARIES_NTSC1953:()=>jt,KHR_DF_PRIMARIES_PAL525:()=>nn,KHR_DF_PRIMARIES_UNSPECIFIED:()=>Le,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>Mt,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>Qi,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>Ce,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>Kn,KHR_DF_TRANSFER_ACESCC:()=>Q,KHR_DF_TRANSFER_ACESCCT:()=>J,KHR_DF_TRANSFER_ADOBERGB:()=>ve,KHR_DF_TRANSFER_BT1886:()=>re,KHR_DF_TRANSFER_DCIP3:()=>Ae,KHR_DF_TRANSFER_HLG_EOTF:()=>k,KHR_DF_TRANSFER_HLG_OETF:()=>Y,KHR_DF_TRANSFER_ITU:()=>te,KHR_DF_TRANSFER_LINEAR:()=>N,KHR_DF_TRANSFER_NTSC:()=>K,KHR_DF_TRANSFER_PAL625_EOTF:()=>I,KHR_DF_TRANSFER_PAL_OETF:()=>b,KHR_DF_TRANSFER_PQ_EOTF:()=>oe,KHR_DF_TRANSFER_PQ_OETF:()=>ae,KHR_DF_TRANSFER_SLOG:()=>se,KHR_DF_TRANSFER_SLOG2:()=>ne,KHR_DF_TRANSFER_SRGB:()=>F,KHR_DF_TRANSFER_ST240:()=>O,KHR_DF_TRANSFER_UNSPECIFIED:()=>T,KHR_DF_VENDORID_KHRONOS:()=>m,KHR_DF_VERSION:()=>l,KHR_SUPERCOMPRESSION_BASISLZ:()=>h,KHR_SUPERCOMPRESSION_NONE:()=>w,KHR_SUPERCOMPRESSION_ZLIB:()=>a,KHR_SUPERCOMPRESSION_ZSTD:()=>v,KTX2Container:()=>Zs,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>ue,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>Rn,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>tn,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>bt,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>yn,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>Ft,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>lt,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>wt,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>At,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>Ga,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>po,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>ia,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>Cr,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>ls,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>Ml,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>as,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>Lo,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>Sl,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>xl,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Wr,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>Tl,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>uo,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Js,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>Eh,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>nh,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>Na,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>$i,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>Do,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>ih,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>ci,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>yl,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>ho,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>ka,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>Cl,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>El,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>bl,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>Kc,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>Ro,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>yh,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>Yc,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>Xc,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>fo,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>Jc,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>qc,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>Po,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>$c,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>Zc,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>wl,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>th,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>eh,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>_l,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>Is,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>Ua,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>an,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>lh,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>fh,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>Re,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>G,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>ee,VK_FORMAT_B8G8R8A8_SINT:()=>Ge,VK_FORMAT_B8G8R8A8_SNORM:()=>es,VK_FORMAT_B8G8R8A8_SRGB:()=>tt,VK_FORMAT_B8G8R8A8_UINT:()=>Ie,VK_FORMAT_B8G8R8A8_UNORM:()=>os,VK_FORMAT_B8G8R8_SINT:()=>Fr,VK_FORMAT_B8G8R8_SNORM:()=>dr,VK_FORMAT_B8G8R8_SRGB:()=>Sr,VK_FORMAT_B8G8R8_UINT:()=>Er,VK_FORMAT_B8G8R8_UNORM:()=>Or,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>Qn,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>fi,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>Un,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>qn,VK_FORMAT_BC2_SRGB_BLOCK:()=>cr,VK_FORMAT_BC2_UNORM_BLOCK:()=>Ni,VK_FORMAT_BC3_SRGB_BLOCK:()=>Hi,VK_FORMAT_BC3_UNORM_BLOCK:()=>Zi,VK_FORMAT_BC4_SNORM_BLOCK:()=>Ki,VK_FORMAT_BC4_UNORM_BLOCK:()=>hr,VK_FORMAT_BC5_SNORM_BLOCK:()=>xr,VK_FORMAT_BC5_UNORM_BLOCK:()=>Rr,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>jr,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>Ds,VK_FORMAT_BC7_SRGB_BLOCK:()=>qr,VK_FORMAT_BC7_UNORM_BLOCK:()=>Es,VK_FORMAT_D16_UNORM:()=>dn,VK_FORMAT_D16_UNORM_S8_UINT:()=>ei,VK_FORMAT_D24_UNORM_S8_UINT:()=>Mn,VK_FORMAT_D32_SFLOAT:()=>pn,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>ai,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Zt,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>Ts,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>Hs,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>Vs,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>qs,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>ks,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>ps,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>Qs,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>Gs,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>pr,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>Jr,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>ah,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>dh,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>Zr,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>ph,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>ui,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>Ah,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>vh,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>mh,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>Lt,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>gh,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>oh,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>sh,VK_FORMAT_R10X6_UNORM_PACK16:()=>rh,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>uh,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>hh,VK_FORMAT_R12X4_UNORM_PACK16:()=>ch,VK_FORMAT_R16G16B16A16_SFLOAT:()=>It,VK_FORMAT_R16G16B16A16_SINT:()=>et,VK_FORMAT_R16G16B16A16_SNORM:()=>Me,VK_FORMAT_R16G16B16A16_UINT:()=>Ke,VK_FORMAT_R16G16B16A16_UNORM:()=>me,VK_FORMAT_R16G16B16_SFLOAT:()=>ce,VK_FORMAT_R16G16B16_SINT:()=>q,VK_FORMAT_R16G16B16_SNORM:()=>gi,VK_FORMAT_R16G16B16_UINT:()=>z,VK_FORMAT_R16G16B16_UNORM:()=>or,VK_FORMAT_R16G16_SFLOAT:()=>oi,VK_FORMAT_R16G16_SINT:()=>on,VK_FORMAT_R16G16_SNORM:()=>Wi,VK_FORMAT_R16G16_UINT:()=>Vi,VK_FORMAT_R16G16_UNORM:()=>pi,VK_FORMAT_R16_SFLOAT:()=>ti,VK_FORMAT_R16_SINT:()=>si,VK_FORMAT_R16_SNORM:()=>Xn,VK_FORMAT_R16_UINT:()=>Di,VK_FORMAT_R16_UNORM:()=>Pn,VK_FORMAT_R32G32B32A32_SFLOAT:()=>Z,VK_FORMAT_R32G32B32A32_SINT:()=>M,VK_FORMAT_R32G32B32A32_UINT:()=>R,VK_FORMAT_R32G32B32_SFLOAT:()=>Ee,VK_FORMAT_R32G32B32_SINT:()=>he,VK_FORMAT_R32G32B32_UINT:()=>le,VK_FORMAT_R32G32_SFLOAT:()=>Cn,VK_FORMAT_R32G32_SINT:()=>_t,VK_FORMAT_R32G32_UINT:()=>Nt,VK_FORMAT_R32_SFLOAT:()=>yt,VK_FORMAT_R32_SINT:()=>it,VK_FORMAT_R32_UINT:()=>St,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>Se,VK_FORMAT_R4G4_UNORM_PACK8:()=>Fe,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>D,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>Ue,VK_FORMAT_R64G64B64A64_SFLOAT:()=>Jt,VK_FORMAT_R64G64B64A64_SINT:()=>qt,VK_FORMAT_R64G64B64A64_UINT:()=>Ct,VK_FORMAT_R64G64B64_SFLOAT:()=>ut,VK_FORMAT_R64G64B64_SINT:()=>at,VK_FORMAT_R64G64B64_UINT:()=>ct,VK_FORMAT_R64G64_SFLOAT:()=>ht,VK_FORMAT_R64G64_SINT:()=>Xe,VK_FORMAT_R64G64_UINT:()=>Je,VK_FORMAT_R64_SFLOAT:()=>Qe,VK_FORMAT_R64_SINT:()=>Oe,VK_FORMAT_R64_UINT:()=>fe,VK_FORMAT_R8G8B8A8_SINT:()=>fs,VK_FORMAT_R8G8B8A8_SNORM:()=>Li,VK_FORMAT_R8G8B8A8_SRGB:()=>Ur,VK_FORMAT_R8G8B8A8_UINT:()=>sr,VK_FORMAT_R8G8B8A8_UNORM:()=>ir,VK_FORMAT_R8G8B8_SINT:()=>Mr,VK_FORMAT_R8G8B8_SNORM:()=>Ti,VK_FORMAT_R8G8B8_SRGB:()=>$n,VK_FORMAT_R8G8B8_UINT:()=>Oi,VK_FORMAT_R8G8B8_UNORM:()=>bi,VK_FORMAT_R8G8_SINT:()=>nr,VK_FORMAT_R8G8_SNORM:()=>zt,VK_FORMAT_R8G8_SRGB:()=>Bn,VK_FORMAT_R8G8_UINT:()=>fn,VK_FORMAT_R8G8_UNORM:()=>Ht,VK_FORMAT_R8_SINT:()=>Gt,VK_FORMAT_R8_SNORM:()=>Ne,VK_FORMAT_R8_SRGB:()=>Yt,VK_FORMAT_R8_UINT:()=>He,VK_FORMAT_R8_UNORM:()=>xe,VK_FORMAT_S8_UINT:()=>Vt,VK_FORMAT_UNDEFINED:()=>ye,VK_FORMAT_X8_D24_UNORM_PACK32:()=>un,read:()=>zi,write:()=>oa});var u=A("./node_modules/buffer/index.js").Buffer;const w=0,h=1,v=2,a=3,f=0,m=0,l=2,y=0,g=1,d=160,p=161,C=162,S=163,_=0,L=1,T=0,N=1,F=2,te=3,K=4,se=5,ne=6,re=7,Y=8,k=9,oe=10,ae=11,Ae=12,b=13,I=14,O=15,Q=16,J=17,ve=18,Le=0,_e=1,Ze=2,qe=3,ft=4,Et=5,Bt=6,kt=7,jt=8,nn=9,Jn=10,kn=11,xn=0,Fn=1,Wn=2,Si=13,Zn=14,Ui=15,Qi=128,Kn=64,Mt=32,Ce=16,ye=0,Fe=1,Se=2,Re=3,Ue=4,ee=5,D=6,G=7,ue=8,xe=9,Ne=10,He=13,Gt=14,Yt=15,Ht=16,zt=17,fn=20,nr=21,Bn=22,bi=23,Ti=24,Oi=27,Mr=28,$n=29,Or=30,dr=31,Er=34,Fr=35,Sr=36,ir=37,Li=38,sr=41,fs=42,Ur=43,os=44,es=45,Ie=48,Ge=49,tt=50,At=58,lt=59,wt=62,Ft=63,yn=64,tn=65,bt=68,Rn=69,Pn=70,Xn=71,Di=74,si=75,ti=76,pi=77,Wi=78,Vi=81,on=82,oi=83,or=84,gi=85,z=88,q=89,ce=90,me=91,Me=92,Ke=95,et=96,It=97,St=98,it=99,yt=100,Nt=101,_t=102,Cn=103,le=104,he=105,Ee=106,R=107,M=108,Z=109,fe=110,Oe=111,Qe=112,Je=113,Xe=114,ht=115,ct=116,at=117,ut=118,Ct=119,qt=120,Jt=121,an=122,Zt=123,dn=124,un=125,pn=126,Vt=127,ei=128,Mn=129,ai=130,qn=131,Un=132,fi=133,Qn=134,Ni=135,cr=136,Zi=137,Hi=138,hr=139,Ki=140,Rr=141,xr=142,Ds=143,jr=144,Es=145,qr=146,Jr=147,pr=148,ps=149,ks=150,Gs=151,Qs=152,qs=153,Vs=154,Hs=155,Ts=156,ho=157,yl=158,El=159,Cl=160,Ro=161,Kc=162,Xc=163,Yc=164,qc=165,Jc=166,Zc=167,$c=168,eh=169,th=170,Ua=171,Is=172,Lo=173,as=174,Wr=175,xl=176,Js=177,uo=178,ls=179,Cr=180,Na=181,nh=182,ih=183,Do=184,rh=1000156007,sh=1000156008,oh=1000156009,ah=1000156010,lh=1000156011,ch=1000156017,hh=1000156018,uh=1000156019,dh=1000156020,fh=1000156021,ph=1000054e3,Ah=1000054001,mh=1000054002,gh=1000054003,Zr=1000054004,ui=1000054005,vh=1000054006,Lt=1000054007,ci=1000066e3,ka=1000066001,bl=1000066002,yh=1000066003,fo=1000066004,Po=1000066005,wl=1000066006,_l=1000066007,Ml=1000066008,Sl=1000066009,Tl=1000066010,ia=1000066011,Eh=1000066012,$i=1000066013,po=100034e4,Ga=1000340001;class Zs{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Ao{constructor(hi,Fi,Xi,De){this._dataView=new DataView(hi.buffer,hi.byteOffset+Fi,Xi),this._littleEndian=De,this._offset=0}_nextUint8(){const hi=this._dataView.getUint8(this._offset);return this._offset+=1,hi}_nextUint16(){const hi=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,hi}_nextUint32(){const hi=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,hi}_nextUint64(){const hi=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,hi}_nextInt32(){const hi=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,hi}_skip(hi){return this._offset+=hi,this}_scan(hi,Fi=0){const Xi=this._offset;let De=0;for(;this._dataView.getUint8(this._offset)!==Fi&&De<hi;)De++,this._offset++;return De<hi&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+Xi,De)}}const Il=new Uint8Array([0]),gr=[171,75,84,88,32,50,48,187,13,10,26,10];function ra(Ln){return typeof TextEncoder<"u"?new TextEncoder().encode(Ln):u.from(Ln)}function Bl(Ln){return typeof TextDecoder<"u"?new TextDecoder().decode(Ln):u.from(Ln).toString("utf8")}function fr(Ln){let hi=0;for(const De of Ln)hi+=De.byteLength;const Fi=new Uint8Array(hi);let Xi=0;for(const De of Ln)Fi.set(new Uint8Array(De),Xi),Xi+=De.byteLength;return Fi}function zi(Ln){const hi=new Uint8Array(Ln.buffer,Ln.byteOffset,gr.length);if(hi[0]!==gr[0]||hi[1]!==gr[1]||hi[2]!==gr[2]||hi[3]!==gr[3]||hi[4]!==gr[4]||hi[5]!==gr[5]||hi[6]!==gr[6]||hi[7]!==gr[7]||hi[8]!==gr[8]||hi[9]!==gr[9]||hi[10]!==gr[10]||hi[11]!==gr[11])throw new Error("Missing KTX 2.0 identifier.");const Fi=new Zs,Xi=17*Uint32Array.BYTES_PER_ELEMENT,De=new Ao(Ln,gr.length,Xi,!0);Fi.vkFormat=De._nextUint32(),Fi.typeSize=De._nextUint32(),Fi.pixelWidth=De._nextUint32(),Fi.pixelHeight=De._nextUint32(),Fi.pixelDepth=De._nextUint32(),Fi.layerCount=De._nextUint32(),Fi.faceCount=De._nextUint32();const Cs=De._nextUint32();Fi.supercompressionScheme=De._nextUint32();const Tr=De._nextUint32(),br=De._nextUint32(),Pi=De._nextUint32(),ts=De._nextUint32(),zs=De._nextUint64(),ms=De._nextUint64(),Kr=new Ao(Ln,gr.length+Xi,3*Cs*8,!0);for(let kr=0;kr<Cs;kr++)Fi.levels.push({levelData:new Uint8Array(Ln.buffer,Ln.byteOffset+Kr._nextUint64(),Kr._nextUint64()),uncompressedByteLength:Kr._nextUint64()});const vi=new Ao(Ln,Tr,br,!0),$r={vendorId:vi._skip(4)._nextUint16(),descriptorType:vi._nextUint16(),versionNumber:vi._nextUint16(),descriptorBlockSize:vi._nextUint16(),colorModel:vi._nextUint8(),colorPrimaries:vi._nextUint8(),transferFunction:vi._nextUint8(),flags:vi._nextUint8(),texelBlockDimension:[vi._nextUint8(),vi._nextUint8(),vi._nextUint8(),vi._nextUint8()],bytesPlane:[vi._nextUint8(),vi._nextUint8(),vi._nextUint8(),vi._nextUint8(),vi._nextUint8(),vi._nextUint8(),vi._nextUint8(),vi._nextUint8()],samples:[]},xs=($r.descriptorBlockSize/4-6)/4;for(let kr=0;kr<xs;kr++){const On={bitOffset:vi._nextUint16(),bitLength:vi._nextUint8(),channelType:vi._nextUint8(),samplePosition:[vi._nextUint8(),vi._nextUint8(),vi._nextUint8(),vi._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&On.channelType?(On.sampleLower=vi._nextInt32(),On.sampleUpper=vi._nextInt32()):(On.sampleLower=vi._nextUint32(),On.sampleUpper=vi._nextUint32()),$r.samples[kr]=On}Fi.dataFormatDescriptor.length=0,Fi.dataFormatDescriptor.push($r);const Xr=new Ao(Ln,Pi,ts,!0);for(;Xr._offset<ts;){const kr=Xr._nextUint32(),On=Xr._scan(kr),eo=Bl(On),gs=Xr._scan(kr-On.byteLength);Fi.keyValue[eo]=eo.match(/^ktx/i)?Bl(gs):gs,Xr._offset%4&&Xr._skip(4-Xr._offset%4)}if(ms<=0)return Fi;const ki=new Ao(Ln,zs,ms,!0),ar=ki._nextUint16(),yi=ki._nextUint16(),Gi=ki._nextUint32(),cs=ki._nextUint32(),mo=ki._nextUint32(),$s=ki._nextUint32(),aa=[];for(let kr=0;kr<Cs;kr++)aa.push({imageFlags:ki._nextUint32(),rgbSliceByteOffset:ki._nextUint32(),rgbSliceByteLength:ki._nextUint32(),alphaSliceByteOffset:ki._nextUint32(),alphaSliceByteLength:ki._nextUint32()});const Nr=zs+ki._offset,Bs=Nr+Gi,la=Bs+cs,ca=la+mo,js=new Uint8Array(Ln.buffer,Ln.byteOffset+Nr,Gi),Qa=new Uint8Array(Ln.buffer,Ln.byteOffset+Bs,cs),ha=new Uint8Array(Ln.buffer,Ln.byteOffset+la,mo),Va=new Uint8Array(Ln.buffer,Ln.byteOffset+ca,$s);return Fi.globalData={endpointCount:ar,selectorCount:yi,imageDescs:aa,endpointsData:js,selectorsData:Qa,tablesData:ha,extendedData:Va},Fi}function sa(){return(sa=Object.assign||function(Ln){for(var hi=1;hi<arguments.length;hi++){var Fi=arguments[hi];for(var Xi in Fi)Object.prototype.hasOwnProperty.call(Fi,Xi)&&(Ln[Xi]=Fi[Xi])}return Ln}).apply(this,arguments)}const As={keepWriter:!1};function oa(Ln,hi={}){hi=sa({},As,hi);let Fi=new ArrayBuffer(0);if(Ln.globalData){const ar=new ArrayBuffer(20+5*Ln.globalData.imageDescs.length*4),yi=new DataView(ar);yi.setUint16(0,Ln.globalData.endpointCount,!0),yi.setUint16(2,Ln.globalData.selectorCount,!0),yi.setUint32(4,Ln.globalData.endpointsData.byteLength,!0),yi.setUint32(8,Ln.globalData.selectorsData.byteLength,!0),yi.setUint32(12,Ln.globalData.tablesData.byteLength,!0),yi.setUint32(16,Ln.globalData.extendedData.byteLength,!0);for(let Gi=0;Gi<Ln.globalData.imageDescs.length;Gi++){const cs=Ln.globalData.imageDescs[Gi];yi.setUint32(20+5*Gi*4+0,cs.imageFlags,!0),yi.setUint32(20+5*Gi*4+4,cs.rgbSliceByteOffset,!0),yi.setUint32(20+5*Gi*4+8,cs.rgbSliceByteLength,!0),yi.setUint32(20+5*Gi*4+12,cs.alphaSliceByteOffset,!0),yi.setUint32(20+5*Gi*4+16,cs.alphaSliceByteLength,!0)}Fi=fr([ar,Ln.globalData.endpointsData,Ln.globalData.selectorsData,Ln.globalData.tablesData,Ln.globalData.extendedData])}const Xi=[];let De=Ln.keyValue;hi.keepWriter||(De=sa({},Ln.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const ar in De){const yi=De[ar],Gi=ra(ar),cs=typeof yi=="string"?ra(yi):yi,mo=Gi.byteLength+1+cs.byteLength+1,$s=mo%4?4-mo%4:0;Xi.push(fr([new Uint32Array([mo]),Gi,Il,cs,Il,new Uint8Array($s).fill(0)]))}const Cs=fr(Xi);if(Ln.dataFormatDescriptor.length!==1||Ln.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const Tr=Ln.dataFormatDescriptor[0],br=new ArrayBuffer(28+16*Tr.samples.length),Pi=new DataView(br),ts=24+16*Tr.samples.length;if(Pi.setUint32(0,br.byteLength,!0),Pi.setUint16(4,Tr.vendorId,!0),Pi.setUint16(6,Tr.descriptorType,!0),Pi.setUint16(8,Tr.versionNumber,!0),Pi.setUint16(10,ts,!0),Pi.setUint8(12,Tr.colorModel),Pi.setUint8(13,Tr.colorPrimaries),Pi.setUint8(14,Tr.transferFunction),Pi.setUint8(15,Tr.flags),!Array.isArray(Tr.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");Pi.setUint8(16,Tr.texelBlockDimension[0]),Pi.setUint8(17,Tr.texelBlockDimension[1]),Pi.setUint8(18,Tr.texelBlockDimension[2]),Pi.setUint8(19,Tr.texelBlockDimension[3]);for(let ar=0;ar<8;ar++)Pi.setUint8(20+ar,Tr.bytesPlane[ar]);for(let ar=0;ar<Tr.samples.length;ar++){const yi=Tr.samples[ar],Gi=28+16*ar;if(yi.channelID)throw new Error("channelID has been renamed to channelType.");Pi.setUint16(Gi+0,yi.bitOffset,!0),Pi.setUint8(Gi+2,yi.bitLength),Pi.setUint8(Gi+3,yi.channelType),Pi.setUint8(Gi+4,yi.samplePosition[0]),Pi.setUint8(Gi+5,yi.samplePosition[1]),Pi.setUint8(Gi+6,yi.samplePosition[2]),Pi.setUint8(Gi+7,yi.samplePosition[3]),64&yi.channelType?(Pi.setInt32(Gi+8,yi.sampleLower,!0),Pi.setInt32(Gi+12,yi.sampleUpper,!0)):(Pi.setUint32(Gi+8,yi.sampleLower,!0),Pi.setUint32(Gi+12,yi.sampleUpper,!0))}const zs=gr.length+68+3*Ln.levels.length*8,ms=zs+br.byteLength;let Kr=Fi.byteLength>0?ms+Cs.byteLength:0;Kr%8&&(Kr+=8-Kr%8);const vi=[],$r=new DataView(new ArrayBuffer(3*Ln.levels.length*8));let xs=(Kr||ms+Cs.byteLength)+Fi.byteLength;for(let ar=0;ar<Ln.levels.length;ar++){const yi=Ln.levels[ar];vi.push(yi.levelData),$r.setBigUint64(24*ar+0,BigInt(xs),!0),$r.setBigUint64(24*ar+8,BigInt(yi.levelData.byteLength),!0),$r.setBigUint64(24*ar+16,BigInt(yi.uncompressedByteLength),!0),xs+=yi.levelData.byteLength}const Xr=new ArrayBuffer(68),ki=new DataView(Xr);return ki.setUint32(0,Ln.vkFormat,!0),ki.setUint32(4,Ln.typeSize,!0),ki.setUint32(8,Ln.pixelWidth,!0),ki.setUint32(12,Ln.pixelHeight,!0),ki.setUint32(16,Ln.pixelDepth,!0),ki.setUint32(20,Ln.layerCount,!0),ki.setUint32(24,Ln.faceCount,!0),ki.setUint32(28,Ln.levels.length,!0),ki.setUint32(32,Ln.supercompressionScheme,!0),ki.setUint32(36,zs,!0),ki.setUint32(40,br.byteLength,!0),ki.setUint32(44,ms,!0),ki.setUint32(48,Cs.byteLength,!0),ki.setBigUint64(52,BigInt(Fi.byteLength>0?Kr:0),!0),ki.setBigUint64(60,BigInt(Fi.byteLength),!0),new Uint8Array(fr([new Uint8Array(gr).buffer,Xr,$r.buffer,br,Cs,Kr>0?new ArrayBuffer(Kr-(ms+Cs.byteLength)):new ArrayBuffer(0),Fi,...vi]))}},"./node_modules/three/examples/jsm/libs/zstddec.module.js":(W,$,A)=>{A.r($),A.d($,{ZSTDDecoder:()=>f});var u=A("./node_modules/buffer/index.js").Buffer;let w,h,v;const a={env:{emscripten_notify_memory_growth:function(l){v=new Uint8Array(h.exports.memory.buffer)}}};class f{init(){return w||(w=typeof fetch<"u"?fetch("data:application/wasm;base64,"+m).then(y=>y.arrayBuffer()).then(y=>WebAssembly.instantiate(y,a)).then(this._init):WebAssembly.instantiate(u.from(m,"base64"),a).then(this._init),w)}_init(y){h=y.instance,a.env.emscripten_notify_memory_growth(0)}decode(y,g=0){if(!h)throw new Error("ZSTDDecoder: Await .init() before decoding.");const d=y.byteLength,p=h.exports.malloc(d);v.set(y,p),g=g||Number(h.exports.ZSTD_findDecompressedSize(p,d));const C=h.exports.malloc(g),S=h.exports.ZSTD_decompress(C,g,p,d),_=v.slice(C,C+S);return h.exports.free(p),h.exports.free(C),_}}const m="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/three/examples/jsm/lights/LightProbeGenerator.js":(W,$,A)=>{A.r($),A.d($,{LightProbeGenerator:()=>w});var u=A("./node_modules/three/build/three.module.js");class w{static fromCubeTexture(a){let f=0;const m=new u.Vector3,l=new u.Vector3,y=new u.Color,g=[0,0,0,0,0,0,0,0,0],d=new u.SphericalHarmonics3,p=d.coefficients;for(let S=0;S<6;S++){const _=a.image[S],L=_.width,T=_.height,N=document.createElement("canvas");N.width=L,N.height=T;const F=N.getContext("2d");F.drawImage(_,0,0,L,T);const te=F.getImageData(0,0,L,T),K=te.data,se=te.width,ne=2/se;for(let re=0,Y=K.length;re<Y;re+=4){y.setRGB(K[re]/255,K[re+1]/255,K[re+2]/255),h(y,a.colorSpace);const k=re/4,oe=-1+(k%se+.5)*ne,ae=1-(Math.floor(k/se)+.5)*ne;switch(S){case 0:m.set(-1,ae,-oe);break;case 1:m.set(1,ae,oe);break;case 2:m.set(-oe,1,-ae);break;case 3:m.set(-oe,-1,ae);break;case 4:m.set(-oe,ae,1);break;case 5:m.set(oe,ae,-1);break}const Ae=m.lengthSq(),b=4/(Math.sqrt(Ae)*Ae);f+=b,l.copy(m).normalize(),u.SphericalHarmonics3.getBasisAt(l,g);for(let I=0;I<9;I++)p[I].x+=g[I]*y.r*b,p[I].y+=g[I]*y.g*b,p[I].z+=g[I]*y.b*b}}const C=4*Math.PI/f;for(let S=0;S<9;S++)p[S].x*=C,p[S].y*=C,p[S].z*=C;return new u.LightProbe(d)}static fromCubeRenderTarget(a,f){let m=0;const l=new u.Vector3,y=new u.Vector3,g=new u.Color,d=[0,0,0,0,0,0,0,0,0],p=new u.SphericalHarmonics3,C=p.coefficients,S=f.texture.type;for(let L=0;L<6;L++){const T=f.width;let N;S===u.HalfFloatType?N=new Uint16Array(T*T*4):N=new Uint8Array(T*T*4),a.readRenderTargetPixels(f,0,0,T,T,N,L);const F=2/T;for(let te=0,K=N.length;te<K;te+=4){let se,ne,re;S===u.HalfFloatType?(se=u.DataUtils.fromHalfFloat(N[te]),ne=u.DataUtils.fromHalfFloat(N[te+1]),re=u.DataUtils.fromHalfFloat(N[te+2])):(se=N[te]/255,ne=N[te+1]/255,re=N[te+2]/255),g.setRGB(se,ne,re),h(g,f.texture.colorSpace);const Y=te/4,k=-1+(Y%T+.5)*F,oe=1-(Math.floor(Y/T)+.5)*F;switch(L){case 0:l.set(1,oe,-k);break;case 1:l.set(-1,oe,k);break;case 2:l.set(k,1,-oe);break;case 3:l.set(k,-1,oe);break;case 4:l.set(k,oe,1);break;case 5:l.set(-k,oe,-1);break}const ae=l.lengthSq(),Ae=4/(Math.sqrt(ae)*ae);m+=Ae,y.copy(l).normalize(),u.SphericalHarmonics3.getBasisAt(y,d);for(let b=0;b<9;b++)C[b].x+=d[b]*g.r*Ae,C[b].y+=d[b]*g.g*Ae,C[b].z+=d[b]*g.b*Ae}}const _=4*Math.PI/m;for(let L=0;L<9;L++)C[L].x*=_,C[L].y*=_,C[L].z*=_;return new u.LightProbe(p)}}function h(v,a){switch(a){case u.SRGBColorSpace:v.convertSRGBToLinear();break;case u.LinearSRGBColorSpace:case u.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return v}},"./node_modules/three/examples/jsm/loaders/DRACOLoader.js":(W,$,A)=>{A.r($),A.d($,{DRACOLoader:()=>h});var u=A("./node_modules/three/build/three.module.js");const w=new WeakMap;class h extends u.Loader{constructor(f){super(f),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(f){return this.decoderPath=f,this}setDecoderConfig(f){return this.decoderConfig=f,this}setWorkerLimit(f){return this.workerLimit=f,this}load(f,m,l,y){const g=new u.FileLoader(this.manager);g.setPath(this.path),g.setResponseType("arraybuffer"),g.setRequestHeader(this.requestHeader),g.setWithCredentials(this.withCredentials),g.load(f,d=>{this.parse(d,m,y)},l,y)}parse(f,m,l=()=>{}){this.decodeDracoFile(f,m,null,null,u.SRGBColorSpace).catch(l)}decodeDracoFile(f,m,l,y,g=u.LinearSRGBColorSpace,d=()=>{}){const p={attributeIDs:l||this.defaultAttributeIDs,attributeTypes:y||this.defaultAttributeTypes,useUniqueIDs:!!l,vertexColorSpace:g};return this.decodeGeometry(f,p).then(m).catch(d)}decodeGeometry(f,m){const l=JSON.stringify(m);if(w.has(f)){const C=w.get(f);if(C.key===l)return C.promise;if(f.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let y;const g=this.workerNextTaskID++,d=f.byteLength,p=this._getWorker(g,d).then(C=>(y=C,new Promise((S,_)=>{y._callbacks[g]={resolve:S,reject:_},y.postMessage({type:"decode",id:g,taskConfig:m,buffer:f},[f])}))).then(C=>this._createGeometry(C.geometry));return p.catch(()=>!0).then(()=>{y&&g&&this._releaseTask(y,g)}),w.set(f,{key:l,promise:p}),p}_createGeometry(f){const m=new u.BufferGeometry;f.index&&m.setIndex(new u.BufferAttribute(f.index.array,1));for(let l=0;l<f.attributes.length;l++){const y=f.attributes[l],g=y.name,d=y.array,p=y.itemSize,C=new u.BufferAttribute(d,p);g==="color"&&(this._assignVertexColorSpace(C,y.vertexColorSpace),C.normalized=!(d instanceof Float32Array)),m.setAttribute(g,C)}return m}_assignVertexColorSpace(f,m){if(m!==u.SRGBColorSpace)return;const l=new u.Color;for(let y=0,g=f.count;y<g;y++)l.fromBufferAttribute(f,y).convertSRGBToLinear(),f.setXYZ(y,l.r,l.g,l.b)}_loadLibrary(f,m){const l=new u.FileLoader(this.manager);return l.setPath(this.decoderPath),l.setResponseType(m),l.setWithCredentials(this.withCredentials),new Promise((y,g)=>{l.load(f,y,void 0,g)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const f=typeof WebAssembly!="object"||this.decoderConfig.type==="js",m=[];return f?m.push(this._loadLibrary("draco_decoder.js","text")):(m.push(this._loadLibrary("draco_wasm_wrapper.js","text")),m.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(m).then(l=>{const y=l[0];f||(this.decoderConfig.wasmBinary=l[1]);const g=v.toString(),d=["/* draco decoder */",y,"","/* worker */",g.substring(g.indexOf("{")+1,g.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([d]))}),this.decoderPending}_getWorker(f,m){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const y=new Worker(this.workerSourceURL);y._callbacks={},y._taskCosts={},y._taskLoad=0,y.postMessage({type:"init",decoderConfig:this.decoderConfig}),y.onmessage=function(g){const d=g.data;switch(d.type){case"decode":y._callbacks[d.id].resolve(d);break;case"error":y._callbacks[d.id].reject(d);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+d.type+'"')}},this.workerPool.push(y)}else this.workerPool.sort(function(y,g){return y._taskLoad>g._taskLoad?-1:1});const l=this.workerPool[this.workerPool.length-1];return l._taskCosts[f]=m,l._taskLoad+=m,l})}_releaseTask(f,m){f._taskLoad-=f._taskCosts[m],delete f._callbacks[m],delete f._taskCosts[m]}debug(){console.log("Task load: ",this.workerPool.map(f=>f._taskLoad))}dispose(){for(let f=0;f<this.workerPool.length;++f)this.workerPool[f].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function v(){let a,f;onmessage=function(d){const p=d.data;switch(p.type){case"init":a=p.decoderConfig,f=new Promise(function(_){a.onModuleLoaded=function(L){_({draco:L})},DracoDecoderModule(a)});break;case"decode":const C=p.buffer,S=p.taskConfig;f.then(_=>{const L=_.draco,T=new L.Decoder;try{const N=m(L,T,new Int8Array(C),S),F=N.attributes.map(te=>te.array.buffer);N.index&&F.push(N.index.array.buffer),self.postMessage({type:"decode",id:p.id,geometry:N},F)}catch(N){console.error(N),self.postMessage({type:"error",id:p.id,error:N.message})}finally{L.destroy(T)}});break}};function m(d,p,C,S){const _=S.attributeIDs,L=S.attributeTypes;let T,N;const F=p.GetEncodedGeometryType(C);if(F===d.TRIANGULAR_MESH)T=new d.Mesh,N=p.DecodeArrayToMesh(C,C.byteLength,T);else if(F===d.POINT_CLOUD)T=new d.PointCloud,N=p.DecodeArrayToPointCloud(C,C.byteLength,T);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!N.ok()||T.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+N.error_msg());const te={index:null,attributes:[]};for(const K in _){const se=self[L[K]];let ne,re;if(S.useUniqueIDs)re=_[K],ne=p.GetAttributeByUniqueId(T,re);else{if(re=p.GetAttributeId(T,d[_[K]]),re===-1)continue;ne=p.GetAttribute(T,re)}const Y=y(d,p,T,K,se,ne);K==="color"&&(Y.vertexColorSpace=S.vertexColorSpace),te.attributes.push(Y)}return F===d.TRIANGULAR_MESH&&(te.index=l(d,p,T)),d.destroy(T),te}function l(d,p,C){const _=C.num_faces()*3,L=_*4,T=d._malloc(L);p.GetTrianglesUInt32Array(C,L,T);const N=new Uint32Array(d.HEAPF32.buffer,T,_).slice();return d._free(T),{array:N,itemSize:1}}function y(d,p,C,S,_,L){const T=L.num_components(),F=C.num_points()*T,te=F*_.BYTES_PER_ELEMENT,K=g(d,_),se=d._malloc(te);p.GetAttributeDataArrayForAllPoints(C,L,K,te,se);const ne=new _(d.HEAPF32.buffer,se,F).slice();return d._free(se),{name:S,array:ne,itemSize:T}}function g(d,p){switch(p){case Float32Array:return d.DT_FLOAT32;case Int8Array:return d.DT_INT8;case Int16Array:return d.DT_INT16;case Int32Array:return d.DT_INT32;case Uint8Array:return d.DT_UINT8;case Uint16Array:return d.DT_UINT16;case Uint32Array:return d.DT_UINT32}}}},"./node_modules/three/examples/jsm/loaders/GLTFLoader.js":(W,$,A)=>{A.r($),A.d($,{GLTFLoader:()=>h});var u=A("./node_modules/three/build/three.module.js"),w=A("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");class h extends u.Loader{constructor(Ce){super(Ce),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ye){return new y(ye)}),this.register(function(ye){return new g(ye)}),this.register(function(ye){return new F(ye)}),this.register(function(ye){return new te(ye)}),this.register(function(ye){return new K(ye)}),this.register(function(ye){return new p(ye)}),this.register(function(ye){return new C(ye)}),this.register(function(ye){return new S(ye)}),this.register(function(ye){return new _(ye)}),this.register(function(ye){return new l(ye)}),this.register(function(ye){return new L(ye)}),this.register(function(ye){return new d(ye)}),this.register(function(ye){return new N(ye)}),this.register(function(ye){return new T(ye)}),this.register(function(ye){return new f(ye)}),this.register(function(ye){return new se(ye)}),this.register(function(ye){return new ne(ye)})}load(Ce,ye,Fe,Se){const Re=this;let Ue;if(this.resourcePath!=="")Ue=this.resourcePath;else if(this.path!==""){const G=u.LoaderUtils.extractUrlBase(Ce);Ue=u.LoaderUtils.resolveURL(G,this.path)}else Ue=u.LoaderUtils.extractUrlBase(Ce);this.manager.itemStart(Ce);const ee=function(G){Se?Se(G):console.error(G),Re.manager.itemError(Ce),Re.manager.itemEnd(Ce)},D=new u.FileLoader(this.manager);D.setPath(this.path),D.setResponseType("arraybuffer"),D.setRequestHeader(this.requestHeader),D.setWithCredentials(this.withCredentials),D.load(Ce,function(G){try{Re.parse(G,Ue,function(ue){ye(ue),Re.manager.itemEnd(Ce)},ee)}catch(ue){ee(ue)}},Fe,ee)}setDRACOLoader(Ce){return this.dracoLoader=Ce,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(Ce){return this.ktx2Loader=Ce,this}setMeshoptDecoder(Ce){return this.meshoptDecoder=Ce,this}register(Ce){return this.pluginCallbacks.indexOf(Ce)===-1&&this.pluginCallbacks.push(Ce),this}unregister(Ce){return this.pluginCallbacks.indexOf(Ce)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(Ce),1),this}parse(Ce,ye,Fe,Se){let Re;const Ue={},ee={},D=new TextDecoder;if(typeof Ce=="string")Re=JSON.parse(Ce);else if(Ce instanceof ArrayBuffer)if(D.decode(new Uint8Array(Ce,0,4))===re){try{Ue[a.KHR_BINARY_GLTF]=new oe(Ce)}catch(xe){Se&&Se(xe);return}Re=JSON.parse(Ue[a.KHR_BINARY_GLTF].content)}else Re=JSON.parse(D.decode(Ce));else Re=Ce;if(Re.asset===void 0||Re.asset.version[0]<2){Se&&Se(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const G=new Ui(Re,{path:ye||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});G.fileLoader.setRequestHeader(this.requestHeader);for(let ue=0;ue<this.pluginCallbacks.length;ue++){const xe=this.pluginCallbacks[ue](G);xe.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),ee[xe.name]=xe,Ue[xe.name]=!0}if(Re.extensionsUsed)for(let ue=0;ue<Re.extensionsUsed.length;++ue){const xe=Re.extensionsUsed[ue],Ne=Re.extensionsRequired||[];switch(xe){case a.KHR_MATERIALS_UNLIT:Ue[xe]=new m;break;case a.KHR_DRACO_MESH_COMPRESSION:Ue[xe]=new ae(Re,this.dracoLoader);break;case a.KHR_TEXTURE_TRANSFORM:Ue[xe]=new Ae;break;case a.KHR_MESH_QUANTIZATION:Ue[xe]=new b;break;default:Ne.indexOf(xe)>=0&&ee[xe]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+xe+'".')}}G.setExtensions(Ue),G.setPlugins(ee),G.parse(Fe,Se)}parseAsync(Ce,ye){const Fe=this;return new Promise(function(Se,Re){Fe.parse(Ce,ye,Se,Re)})}}function v(){let Mt={};return{get:function(Ce){return Mt[Ce]},add:function(Ce,ye){Mt[Ce]=ye},remove:function(Ce){delete Mt[Ce]},removeAll:function(){Mt={}}}}const a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class f{constructor(Ce){this.parser=Ce,this.name=a.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const Ce=this.parser,ye=this.parser.json.nodes||[];for(let Fe=0,Se=ye.length;Fe<Se;Fe++){const Re=ye[Fe];Re.extensions&&Re.extensions[this.name]&&Re.extensions[this.name].light!==void 0&&Ce._addNodeRef(this.cache,Re.extensions[this.name].light)}}_loadLight(Ce){const ye=this.parser,Fe="light:"+Ce;let Se=ye.cache.get(Fe);if(Se)return Se;const Re=ye.json,D=((Re.extensions&&Re.extensions[this.name]||{}).lights||[])[Ce];let G;const ue=new u.Color(16777215);D.color!==void 0&&ue.setRGB(D.color[0],D.color[1],D.color[2],u.LinearSRGBColorSpace);const xe=D.range!==void 0?D.range:0;switch(D.type){case"directional":G=new u.DirectionalLight(ue),G.target.position.set(0,0,-1),G.add(G.target);break;case"point":G=new u.PointLight(ue),G.distance=xe;break;case"spot":G=new u.SpotLight(ue),G.distance=xe,D.spot=D.spot||{},D.spot.innerConeAngle=D.spot.innerConeAngle!==void 0?D.spot.innerConeAngle:0,D.spot.outerConeAngle=D.spot.outerConeAngle!==void 0?D.spot.outerConeAngle:Math.PI/4,G.angle=D.spot.outerConeAngle,G.penumbra=1-D.spot.innerConeAngle/D.spot.outerConeAngle,G.target.position.set(0,0,-1),G.add(G.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+D.type)}return G.position.set(0,0,0),G.decay=2,nn(G,D),D.intensity!==void 0&&(G.intensity=D.intensity),G.name=ye.createUniqueName(D.name||"light_"+Ce),Se=Promise.resolve(G),ye.cache.add(Fe,Se),Se}getDependency(Ce,ye){if(Ce==="light")return this._loadLight(ye)}createNodeAttachment(Ce){const ye=this,Fe=this.parser,Re=Fe.json.nodes[Ce],ee=(Re.extensions&&Re.extensions[this.name]||{}).light;return ee===void 0?null:this._loadLight(ee).then(function(D){return Fe._getNodeRef(ye.cache,ee,D)})}}class m{constructor(){this.name=a.KHR_MATERIALS_UNLIT}getMaterialType(){return u.MeshBasicMaterial}extendParams(Ce,ye,Fe){const Se=[];Ce.color=new u.Color(1,1,1),Ce.opacity=1;const Re=ye.pbrMetallicRoughness;if(Re){if(Array.isArray(Re.baseColorFactor)){const Ue=Re.baseColorFactor;Ce.color.setRGB(Ue[0],Ue[1],Ue[2],u.LinearSRGBColorSpace),Ce.opacity=Ue[3]}Re.baseColorTexture!==void 0&&Se.push(Fe.assignTexture(Ce,"map",Re.baseColorTexture,u.SRGBColorSpace))}return Promise.all(Se)}}class l{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(Ce,ye){const Se=this.parser.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=Se.extensions[this.name].emissiveStrength;return Re!==void 0&&(ye.emissiveIntensity=Re),Promise.resolve()}}class y{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_CLEARCOAT}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Ue=Se.extensions[this.name];if(Ue.clearcoatFactor!==void 0&&(ye.clearcoat=Ue.clearcoatFactor),Ue.clearcoatTexture!==void 0&&Re.push(Fe.assignTexture(ye,"clearcoatMap",Ue.clearcoatTexture)),Ue.clearcoatRoughnessFactor!==void 0&&(ye.clearcoatRoughness=Ue.clearcoatRoughnessFactor),Ue.clearcoatRoughnessTexture!==void 0&&Re.push(Fe.assignTexture(ye,"clearcoatRoughnessMap",Ue.clearcoatRoughnessTexture)),Ue.clearcoatNormalTexture!==void 0&&(Re.push(Fe.assignTexture(ye,"clearcoatNormalMap",Ue.clearcoatNormalTexture)),Ue.clearcoatNormalTexture.scale!==void 0)){const ee=Ue.clearcoatNormalTexture.scale;ye.clearcoatNormalScale=new u.Vector2(ee,ee)}return Promise.all(Re)}}class g{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_DISPERSION}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Se=this.parser.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=Se.extensions[this.name];return ye.dispersion=Re.dispersion!==void 0?Re.dispersion:0,Promise.resolve()}}class d{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_IRIDESCENCE}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Ue=Se.extensions[this.name];return Ue.iridescenceFactor!==void 0&&(ye.iridescence=Ue.iridescenceFactor),Ue.iridescenceTexture!==void 0&&Re.push(Fe.assignTexture(ye,"iridescenceMap",Ue.iridescenceTexture)),Ue.iridescenceIor!==void 0&&(ye.iridescenceIOR=Ue.iridescenceIor),ye.iridescenceThicknessRange===void 0&&(ye.iridescenceThicknessRange=[100,400]),Ue.iridescenceThicknessMinimum!==void 0&&(ye.iridescenceThicknessRange[0]=Ue.iridescenceThicknessMinimum),Ue.iridescenceThicknessMaximum!==void 0&&(ye.iridescenceThicknessRange[1]=Ue.iridescenceThicknessMaximum),Ue.iridescenceThicknessTexture!==void 0&&Re.push(Fe.assignTexture(ye,"iridescenceThicknessMap",Ue.iridescenceThicknessTexture)),Promise.all(Re)}}class p{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_SHEEN}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[];ye.sheenColor=new u.Color(0,0,0),ye.sheenRoughness=0,ye.sheen=1;const Ue=Se.extensions[this.name];if(Ue.sheenColorFactor!==void 0){const ee=Ue.sheenColorFactor;ye.sheenColor.setRGB(ee[0],ee[1],ee[2],u.LinearSRGBColorSpace)}return Ue.sheenRoughnessFactor!==void 0&&(ye.sheenRoughness=Ue.sheenRoughnessFactor),Ue.sheenColorTexture!==void 0&&Re.push(Fe.assignTexture(ye,"sheenColorMap",Ue.sheenColorTexture,u.SRGBColorSpace)),Ue.sheenRoughnessTexture!==void 0&&Re.push(Fe.assignTexture(ye,"sheenRoughnessMap",Ue.sheenRoughnessTexture)),Promise.all(Re)}}class C{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_TRANSMISSION}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Ue=Se.extensions[this.name];return Ue.transmissionFactor!==void 0&&(ye.transmission=Ue.transmissionFactor),Ue.transmissionTexture!==void 0&&Re.push(Fe.assignTexture(ye,"transmissionMap",Ue.transmissionTexture)),Promise.all(Re)}}class S{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_VOLUME}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Ue=Se.extensions[this.name];ye.thickness=Ue.thicknessFactor!==void 0?Ue.thicknessFactor:0,Ue.thicknessTexture!==void 0&&Re.push(Fe.assignTexture(ye,"thicknessMap",Ue.thicknessTexture)),ye.attenuationDistance=Ue.attenuationDistance||1/0;const ee=Ue.attenuationColor||[1,1,1];return ye.attenuationColor=new u.Color().setRGB(ee[0],ee[1],ee[2],u.LinearSRGBColorSpace),Promise.all(Re)}}class _{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_IOR}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Se=this.parser.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=Se.extensions[this.name];return ye.ior=Re.ior!==void 0?Re.ior:1.5,Promise.resolve()}}class L{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_SPECULAR}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Ue=Se.extensions[this.name];ye.specularIntensity=Ue.specularFactor!==void 0?Ue.specularFactor:1,Ue.specularTexture!==void 0&&Re.push(Fe.assignTexture(ye,"specularIntensityMap",Ue.specularTexture));const ee=Ue.specularColorFactor||[1,1,1];return ye.specularColor=new u.Color().setRGB(ee[0],ee[1],ee[2],u.LinearSRGBColorSpace),Ue.specularColorTexture!==void 0&&Re.push(Fe.assignTexture(ye,"specularColorMap",Ue.specularColorTexture,u.SRGBColorSpace)),Promise.all(Re)}}class T{constructor(Ce){this.parser=Ce,this.name=a.EXT_MATERIALS_BUMP}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Ue=Se.extensions[this.name];return ye.bumpScale=Ue.bumpFactor!==void 0?Ue.bumpFactor:1,Ue.bumpTexture!==void 0&&Re.push(Fe.assignTexture(ye,"bumpMap",Ue.bumpTexture)),Promise.all(Re)}}class N{constructor(Ce){this.parser=Ce,this.name=a.KHR_MATERIALS_ANISOTROPY}getMaterialType(Ce){const Fe=this.parser.json.materials[Ce];return!Fe.extensions||!Fe.extensions[this.name]?null:u.MeshPhysicalMaterial}extendMaterialParams(Ce,ye){const Fe=this.parser,Se=Fe.json.materials[Ce];if(!Se.extensions||!Se.extensions[this.name])return Promise.resolve();const Re=[],Ue=Se.extensions[this.name];return Ue.anisotropyStrength!==void 0&&(ye.anisotropy=Ue.anisotropyStrength),Ue.anisotropyRotation!==void 0&&(ye.anisotropyRotation=Ue.anisotropyRotation),Ue.anisotropyTexture!==void 0&&Re.push(Fe.assignTexture(ye,"anisotropyMap",Ue.anisotropyTexture)),Promise.all(Re)}}class F{constructor(Ce){this.parser=Ce,this.name=a.KHR_TEXTURE_BASISU}loadTexture(Ce){const ye=this.parser,Fe=ye.json,Se=Fe.textures[Ce];if(!Se.extensions||!Se.extensions[this.name])return null;const Re=Se.extensions[this.name],Ue=ye.options.ktx2Loader;if(!Ue){if(Fe.extensionsRequired&&Fe.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ye.loadTextureImage(Ce,Re.source,Ue)}}class te{constructor(Ce){this.parser=Ce,this.name=a.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(Ce){const ye=this.name,Fe=this.parser,Se=Fe.json,Re=Se.textures[Ce];if(!Re.extensions||!Re.extensions[ye])return null;const Ue=Re.extensions[ye],ee=Se.images[Ue.source];let D=Fe.textureLoader;if(ee.uri){const G=Fe.options.manager.getHandler(ee.uri);G!==null&&(D=G)}return this.detectSupport().then(function(G){if(G)return Fe.loadTextureImage(Ce,Ue.source,D);if(Se.extensionsRequired&&Se.extensionsRequired.indexOf(ye)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Fe.loadTexture(Ce)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(Ce){const ye=new Image;ye.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ye.onload=ye.onerror=function(){Ce(ye.height===1)}})),this.isSupported}}class K{constructor(Ce){this.parser=Ce,this.name=a.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(Ce){const ye=this.name,Fe=this.parser,Se=Fe.json,Re=Se.textures[Ce];if(!Re.extensions||!Re.extensions[ye])return null;const Ue=Re.extensions[ye],ee=Se.images[Ue.source];let D=Fe.textureLoader;if(ee.uri){const G=Fe.options.manager.getHandler(ee.uri);G!==null&&(D=G)}return this.detectSupport().then(function(G){if(G)return Fe.loadTextureImage(Ce,Ue.source,D);if(Se.extensionsRequired&&Se.extensionsRequired.indexOf(ye)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return Fe.loadTexture(Ce)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(Ce){const ye=new Image;ye.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",ye.onload=ye.onerror=function(){Ce(ye.height===1)}})),this.isSupported}}class se{constructor(Ce){this.name=a.EXT_MESHOPT_COMPRESSION,this.parser=Ce}loadBufferView(Ce){const ye=this.parser.json,Fe=ye.bufferViews[Ce];if(Fe.extensions&&Fe.extensions[this.name]){const Se=Fe.extensions[this.name],Re=this.parser.getDependency("buffer",Se.buffer),Ue=this.parser.options.meshoptDecoder;if(!Ue||!Ue.supported){if(ye.extensionsRequired&&ye.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Re.then(function(ee){const D=Se.byteOffset||0,G=Se.byteLength||0,ue=Se.count,xe=Se.byteStride,Ne=new Uint8Array(ee,D,G);return Ue.decodeGltfBufferAsync?Ue.decodeGltfBufferAsync(ue,xe,Ne,Se.mode,Se.filter).then(function(He){return He.buffer}):Ue.ready.then(function(){const He=new ArrayBuffer(ue*xe);return Ue.decodeGltfBuffer(new Uint8Array(He),ue,xe,Ne,Se.mode,Se.filter),He})})}else return null}}class ne{constructor(Ce){this.name=a.EXT_MESH_GPU_INSTANCING,this.parser=Ce}createNodeMesh(Ce){const ye=this.parser.json,Fe=ye.nodes[Ce];if(!Fe.extensions||!Fe.extensions[this.name]||Fe.mesh===void 0)return null;const Se=ye.meshes[Fe.mesh];for(const G of Se.primitives)if(G.mode!==J.TRIANGLES&&G.mode!==J.TRIANGLE_STRIP&&G.mode!==J.TRIANGLE_FAN&&G.mode!==void 0)return null;const Ue=Fe.extensions[this.name].attributes,ee=[],D={};for(const G in Ue)ee.push(this.parser.getDependency("accessor",Ue[G]).then(ue=>(D[G]=ue,D[G])));return ee.length<1?null:(ee.push(this.parser.createNodeMesh(Ce)),Promise.all(ee).then(G=>{const ue=G.pop(),xe=ue.isGroup?ue.children:[ue],Ne=G[0].count,He=[];for(const Gt of xe){const Yt=new u.Matrix4,Ht=new u.Vector3,zt=new u.Quaternion,fn=new u.Vector3(1,1,1),nr=new u.InstancedMesh(Gt.geometry,Gt.material,Ne);for(let Bn=0;Bn<Ne;Bn++)D.TRANSLATION&&Ht.fromBufferAttribute(D.TRANSLATION,Bn),D.ROTATION&&zt.fromBufferAttribute(D.ROTATION,Bn),D.SCALE&&fn.fromBufferAttribute(D.SCALE,Bn),nr.setMatrixAt(Bn,Yt.compose(Ht,zt,fn));for(const Bn in D)if(Bn==="_COLOR_0"){const bi=D[Bn];nr.instanceColor=new u.InstancedBufferAttribute(bi.array,bi.itemSize,bi.normalized)}else Bn!=="TRANSLATION"&&Bn!=="ROTATION"&&Bn!=="SCALE"&&Gt.geometry.setAttribute(Bn,D[Bn]);u.Object3D.prototype.copy.call(nr,Gt),this.parser.assignFinalMaterial(nr),He.push(nr)}return ue.isGroup?(ue.clear(),ue.add(...He),ue):He[0]}))}}const re="glTF",Y=12,k={JSON:1313821514,BIN:5130562};class oe{constructor(Ce){this.name=a.KHR_BINARY_GLTF,this.content=null,this.body=null;const ye=new DataView(Ce,0,Y),Fe=new TextDecoder;if(this.header={magic:Fe.decode(new Uint8Array(Ce.slice(0,4))),version:ye.getUint32(4,!0),length:ye.getUint32(8,!0)},this.header.magic!==re)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const Se=this.header.length-Y,Re=new DataView(Ce,Y);let Ue=0;for(;Ue<Se;){const ee=Re.getUint32(Ue,!0);Ue+=4;const D=Re.getUint32(Ue,!0);if(Ue+=4,D===k.JSON){const G=new Uint8Array(Ce,Y+Ue,ee);this.content=Fe.decode(G)}else if(D===k.BIN){const G=Y+Ue;this.body=Ce.slice(G,G+ee)}Ue+=ee}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ae{constructor(Ce,ye){if(!ye)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION,this.json=Ce,this.dracoLoader=ye,this.dracoLoader.preload()}decodePrimitive(Ce,ye){const Fe=this.json,Se=this.dracoLoader,Re=Ce.extensions[this.name].bufferView,Ue=Ce.extensions[this.name].attributes,ee={},D={},G={};for(const ue in Ue){const xe=qe[ue]||ue.toLowerCase();ee[xe]=Ue[ue]}for(const ue in Ce.attributes){const xe=qe[ue]||ue.toLowerCase();if(Ue[ue]!==void 0){const Ne=Fe.accessors[Ce.attributes[ue]],He=ve[Ne.componentType];G[xe]=He.name,D[xe]=Ne.normalized===!0}}return ye.getDependency("bufferView",Re).then(function(ue){return new Promise(function(xe,Ne){Se.decodeDracoFile(ue,function(He){for(const Gt in He.attributes){const Yt=He.attributes[Gt],Ht=D[Gt];Ht!==void 0&&(Yt.normalized=Ht)}xe(He)},ee,G,u.LinearSRGBColorSpace,Ne)})})}}class Ae{constructor(){this.name=a.KHR_TEXTURE_TRANSFORM}extendTexture(Ce,ye){return(ye.texCoord===void 0||ye.texCoord===Ce.channel)&&ye.offset===void 0&&ye.rotation===void 0&&ye.scale===void 0||(Ce=Ce.clone(),ye.texCoord!==void 0&&(Ce.channel=ye.texCoord),ye.offset!==void 0&&Ce.offset.fromArray(ye.offset),ye.rotation!==void 0&&(Ce.rotation=ye.rotation),ye.scale!==void 0&&Ce.repeat.fromArray(ye.scale),Ce.needsUpdate=!0),Ce}}class b{constructor(){this.name=a.KHR_MESH_QUANTIZATION}}class I extends u.Interpolant{constructor(Ce,ye,Fe,Se){super(Ce,ye,Fe,Se)}copySampleValue_(Ce){const ye=this.resultBuffer,Fe=this.sampleValues,Se=this.valueSize,Re=Ce*Se*3+Se;for(let Ue=0;Ue!==Se;Ue++)ye[Ue]=Fe[Re+Ue];return ye}interpolate_(Ce,ye,Fe,Se){const Re=this.resultBuffer,Ue=this.sampleValues,ee=this.valueSize,D=ee*2,G=ee*3,ue=Se-ye,xe=(Fe-ye)/ue,Ne=xe*xe,He=Ne*xe,Gt=Ce*G,Yt=Gt-G,Ht=-2*He+3*Ne,zt=He-Ne,fn=1-Ht,nr=zt-Ne+xe;for(let Bn=0;Bn!==ee;Bn++){const bi=Ue[Yt+Bn+ee],Ti=Ue[Yt+Bn+D]*ue,Oi=Ue[Gt+Bn+ee],Mr=Ue[Gt+Bn]*ue;Re[Bn]=fn*bi+nr*Ti+Ht*Oi+zt*Mr}return Re}}const O=new u.Quaternion;class Q extends I{interpolate_(Ce,ye,Fe,Se){const Re=super.interpolate_(Ce,ye,Fe,Se);return O.fromArray(Re).normalize().toArray(Re),Re}}const J={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ve={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Le={9728:u.NearestFilter,9729:u.LinearFilter,9984:u.NearestMipmapNearestFilter,9985:u.LinearMipmapNearestFilter,9986:u.NearestMipmapLinearFilter,9987:u.LinearMipmapLinearFilter},_e={33071:u.ClampToEdgeWrapping,33648:u.MirroredRepeatWrapping,10497:u.RepeatWrapping},Ze={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},qe={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ft={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Et={CUBICSPLINE:void 0,LINEAR:u.InterpolateLinear,STEP:u.InterpolateDiscrete},Bt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function kt(Mt){return Mt.DefaultMaterial===void 0&&(Mt.DefaultMaterial=new u.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:u.FrontSide})),Mt.DefaultMaterial}function jt(Mt,Ce,ye){for(const Fe in ye.extensions)Mt[Fe]===void 0&&(Ce.userData.gltfExtensions=Ce.userData.gltfExtensions||{},Ce.userData.gltfExtensions[Fe]=ye.extensions[Fe])}function nn(Mt,Ce){Ce.extras!==void 0&&(typeof Ce.extras=="object"?Object.assign(Mt.userData,Ce.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+Ce.extras))}function Jn(Mt,Ce,ye){let Fe=!1,Se=!1,Re=!1;for(let G=0,ue=Ce.length;G<ue;G++){const xe=Ce[G];if(xe.POSITION!==void 0&&(Fe=!0),xe.NORMAL!==void 0&&(Se=!0),xe.COLOR_0!==void 0&&(Re=!0),Fe&&Se&&Re)break}if(!Fe&&!Se&&!Re)return Promise.resolve(Mt);const Ue=[],ee=[],D=[];for(let G=0,ue=Ce.length;G<ue;G++){const xe=Ce[G];if(Fe){const Ne=xe.POSITION!==void 0?ye.getDependency("accessor",xe.POSITION):Mt.attributes.position;Ue.push(Ne)}if(Se){const Ne=xe.NORMAL!==void 0?ye.getDependency("accessor",xe.NORMAL):Mt.attributes.normal;ee.push(Ne)}if(Re){const Ne=xe.COLOR_0!==void 0?ye.getDependency("accessor",xe.COLOR_0):Mt.attributes.color;D.push(Ne)}}return Promise.all([Promise.all(Ue),Promise.all(ee),Promise.all(D)]).then(function(G){const ue=G[0],xe=G[1],Ne=G[2];return Fe&&(Mt.morphAttributes.position=ue),Se&&(Mt.morphAttributes.normal=xe),Re&&(Mt.morphAttributes.color=Ne),Mt.morphTargetsRelative=!0,Mt})}function kn(Mt,Ce){if(Mt.updateMorphTargets(),Ce.weights!==void 0)for(let ye=0,Fe=Ce.weights.length;ye<Fe;ye++)Mt.morphTargetInfluences[ye]=Ce.weights[ye];if(Ce.extras&&Array.isArray(Ce.extras.targetNames)){const ye=Ce.extras.targetNames;if(Mt.morphTargetInfluences.length===ye.length){Mt.morphTargetDictionary={};for(let Fe=0,Se=ye.length;Fe<Se;Fe++)Mt.morphTargetDictionary[ye[Fe]]=Fe}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function xn(Mt){let Ce;const ye=Mt.extensions&&Mt.extensions[a.KHR_DRACO_MESH_COMPRESSION];if(ye?Ce="draco:"+ye.bufferView+":"+ye.indices+":"+Fn(ye.attributes):Ce=Mt.indices+":"+Fn(Mt.attributes)+":"+Mt.mode,Mt.targets!==void 0)for(let Fe=0,Se=Mt.targets.length;Fe<Se;Fe++)Ce+=":"+Fn(Mt.targets[Fe]);return Ce}function Fn(Mt){let Ce="";const ye=Object.keys(Mt).sort();for(let Fe=0,Se=ye.length;Fe<Se;Fe++)Ce+=ye[Fe]+":"+Mt[ye[Fe]]+";";return Ce}function Wn(Mt){switch(Mt){case Int8Array:return .007874015748031496;case Uint8Array:return .00392156862745098;case Int16Array:return 3051850947599719e-20;case Uint16Array:return 15259021896696422e-21;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Si(Mt){return Mt.search(/\.jpe?g($|\?)/i)>0||Mt.search(/^data\:image\/jpeg/)===0?"image/jpeg":Mt.search(/\.webp($|\?)/i)>0||Mt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Zn=new u.Matrix4;class Ui{constructor(Ce={},ye={}){this.json=Ce,this.extensions={},this.plugins={},this.options=ye,this.cache=new v,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let Fe=!1,Se=!1,Re=-1;typeof navigator<"u"&&(Fe=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,Se=navigator.userAgent.indexOf("Firefox")>-1,Re=Se?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||Fe||Se&&Re<98?this.textureLoader=new u.TextureLoader(this.options.manager):this.textureLoader=new u.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new u.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(Ce){this.extensions=Ce}setPlugins(Ce){this.plugins=Ce}parse(Ce,ye){const Fe=this,Se=this.json,Re=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(Ue){return Ue._markDefs&&Ue._markDefs()}),Promise.all(this._invokeAll(function(Ue){return Ue.beforeRoot&&Ue.beforeRoot()})).then(function(){return Promise.all([Fe.getDependencies("scene"),Fe.getDependencies("animation"),Fe.getDependencies("camera")])}).then(function(Ue){const ee={scene:Ue[0][Se.scene||0],scenes:Ue[0],animations:Ue[1],cameras:Ue[2],asset:Se.asset,parser:Fe,userData:{}};return jt(Re,ee,Se),nn(ee,Se),Promise.all(Fe._invokeAll(function(D){return D.afterRoot&&D.afterRoot(ee)})).then(function(){for(const D of ee.scenes)D.updateMatrixWorld();Ce(ee)})}).catch(ye)}_markDefs(){const Ce=this.json.nodes||[],ye=this.json.skins||[],Fe=this.json.meshes||[];for(let Se=0,Re=ye.length;Se<Re;Se++){const Ue=ye[Se].joints;for(let ee=0,D=Ue.length;ee<D;ee++)Ce[Ue[ee]].isBone=!0}for(let Se=0,Re=Ce.length;Se<Re;Se++){const Ue=Ce[Se];Ue.mesh!==void 0&&(this._addNodeRef(this.meshCache,Ue.mesh),Ue.skin!==void 0&&(Fe[Ue.mesh].isSkinnedMesh=!0)),Ue.camera!==void 0&&this._addNodeRef(this.cameraCache,Ue.camera)}}_addNodeRef(Ce,ye){ye!==void 0&&(Ce.refs[ye]===void 0&&(Ce.refs[ye]=Ce.uses[ye]=0),Ce.refs[ye]++)}_getNodeRef(Ce,ye,Fe){if(Ce.refs[ye]<=1)return Fe;const Se=Fe.clone(),Re=(Ue,ee)=>{const D=this.associations.get(Ue);D!=null&&this.associations.set(ee,D);for(const[G,ue]of Ue.children.entries())Re(ue,ee.children[G])};return Re(Fe,Se),Se.name+="_instance_"+Ce.uses[ye]++,Se}_invokeOne(Ce){const ye=Object.values(this.plugins);ye.push(this);for(let Fe=0;Fe<ye.length;Fe++){const Se=Ce(ye[Fe]);if(Se)return Se}return null}_invokeAll(Ce){const ye=Object.values(this.plugins);ye.unshift(this);const Fe=[];for(let Se=0;Se<ye.length;Se++){const Re=Ce(ye[Se]);Re&&Fe.push(Re)}return Fe}getDependency(Ce,ye){const Fe=Ce+":"+ye;let Se=this.cache.get(Fe);if(!Se){switch(Ce){case"scene":Se=this.loadScene(ye);break;case"node":Se=this._invokeOne(function(Re){return Re.loadNode&&Re.loadNode(ye)});break;case"mesh":Se=this._invokeOne(function(Re){return Re.loadMesh&&Re.loadMesh(ye)});break;case"accessor":Se=this.loadAccessor(ye);break;case"bufferView":Se=this._invokeOne(function(Re){return Re.loadBufferView&&Re.loadBufferView(ye)});break;case"buffer":Se=this.loadBuffer(ye);break;case"material":Se=this._invokeOne(function(Re){return Re.loadMaterial&&Re.loadMaterial(ye)});break;case"texture":Se=this._invokeOne(function(Re){return Re.loadTexture&&Re.loadTexture(ye)});break;case"skin":Se=this.loadSkin(ye);break;case"animation":Se=this._invokeOne(function(Re){return Re.loadAnimation&&Re.loadAnimation(ye)});break;case"camera":Se=this.loadCamera(ye);break;default:if(Se=this._invokeOne(function(Re){return Re!=this&&Re.getDependency&&Re.getDependency(Ce,ye)}),!Se)throw new Error("Unknown type: "+Ce);break}this.cache.add(Fe,Se)}return Se}getDependencies(Ce){let ye=this.cache.get(Ce);if(!ye){const Fe=this,Se=this.json[Ce+(Ce==="mesh"?"es":"s")]||[];ye=Promise.all(Se.map(function(Re,Ue){return Fe.getDependency(Ce,Ue)})),this.cache.add(Ce,ye)}return ye}loadBuffer(Ce){const ye=this.json.buffers[Ce],Fe=this.fileLoader;if(ye.type&&ye.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ye.type+" buffer type is not supported.");if(ye.uri===void 0&&Ce===0)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);const Se=this.options;return new Promise(function(Re,Ue){Fe.load(u.LoaderUtils.resolveURL(ye.uri,Se.path),Re,void 0,function(){Ue(new Error('THREE.GLTFLoader: Failed to load buffer "'+ye.uri+'".'))})})}loadBufferView(Ce){const ye=this.json.bufferViews[Ce];return this.getDependency("buffer",ye.buffer).then(function(Fe){const Se=ye.byteLength||0,Re=ye.byteOffset||0;return Fe.slice(Re,Re+Se)})}loadAccessor(Ce){const ye=this,Fe=this.json,Se=this.json.accessors[Ce];if(Se.bufferView===void 0&&Se.sparse===void 0){const Ue=Ze[Se.type],ee=ve[Se.componentType],D=Se.normalized===!0,G=new ee(Se.count*Ue);return Promise.resolve(new u.BufferAttribute(G,Ue,D))}const Re=[];return Se.bufferView!==void 0?Re.push(this.getDependency("bufferView",Se.bufferView)):Re.push(null),Se.sparse!==void 0&&(Re.push(this.getDependency("bufferView",Se.sparse.indices.bufferView)),Re.push(this.getDependency("bufferView",Se.sparse.values.bufferView))),Promise.all(Re).then(function(Ue){const ee=Ue[0],D=Ze[Se.type],G=ve[Se.componentType],ue=G.BYTES_PER_ELEMENT,xe=ue*D,Ne=Se.byteOffset||0,He=Se.bufferView!==void 0?Fe.bufferViews[Se.bufferView].byteStride:void 0,Gt=Se.normalized===!0;let Yt,Ht;if(He&&He!==xe){const zt=Math.floor(Ne/He),fn="InterleavedBuffer:"+Se.bufferView+":"+Se.componentType+":"+zt+":"+Se.count;let nr=ye.cache.get(fn);nr||(Yt=new G(ee,zt*He,Se.count*He/ue),nr=new u.InterleavedBuffer(Yt,He/ue),ye.cache.add(fn,nr)),Ht=new u.InterleavedBufferAttribute(nr,D,Ne%He/ue,Gt)}else ee===null?Yt=new G(Se.count*D):Yt=new G(ee,Ne,Se.count*D),Ht=new u.BufferAttribute(Yt,D,Gt);if(Se.sparse!==void 0){const zt=Ze.SCALAR,fn=ve[Se.sparse.indices.componentType],nr=Se.sparse.indices.byteOffset||0,Bn=Se.sparse.values.byteOffset||0,bi=new fn(Ue[1],nr,Se.sparse.count*zt),Ti=new G(Ue[2],Bn,Se.sparse.count*D);ee!==null&&(Ht=new u.BufferAttribute(Ht.array.slice(),Ht.itemSize,Ht.normalized));for(let Oi=0,Mr=bi.length;Oi<Mr;Oi++){const $n=bi[Oi];if(Ht.setX($n,Ti[Oi*D]),D>=2&&Ht.setY($n,Ti[Oi*D+1]),D>=3&&Ht.setZ($n,Ti[Oi*D+2]),D>=4&&Ht.setW($n,Ti[Oi*D+3]),D>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Ht})}loadTexture(Ce){const ye=this.json,Fe=this.options,Re=ye.textures[Ce].source,Ue=ye.images[Re];let ee=this.textureLoader;if(Ue.uri){const D=Fe.manager.getHandler(Ue.uri);D!==null&&(ee=D)}return this.loadTextureImage(Ce,Re,ee)}loadTextureImage(Ce,ye,Fe){const Se=this,Re=this.json,Ue=Re.textures[Ce],ee=Re.images[ye],D=(ee.uri||ee.bufferView)+":"+Ue.sampler;if(this.textureCache[D])return this.textureCache[D];const G=this.loadImageSource(ye,Fe).then(function(ue){ue.flipY=!1,ue.name=Ue.name||ee.name||"",ue.name===""&&typeof ee.uri=="string"&&ee.uri.startsWith("data:image/")===!1&&(ue.name=ee.uri);const Ne=(Re.samplers||{})[Ue.sampler]||{};return ue.magFilter=Le[Ne.magFilter]||u.LinearFilter,ue.minFilter=Le[Ne.minFilter]||u.LinearMipmapLinearFilter,ue.wrapS=_e[Ne.wrapS]||u.RepeatWrapping,ue.wrapT=_e[Ne.wrapT]||u.RepeatWrapping,Se.associations.set(ue,{textures:Ce}),ue}).catch(function(){return null});return this.textureCache[D]=G,G}loadImageSource(Ce,ye){const Fe=this,Se=this.json,Re=this.options;if(this.sourceCache[Ce]!==void 0)return this.sourceCache[Ce].then(xe=>xe.clone());const Ue=Se.images[Ce],ee=self.URL||self.webkitURL;let D=Ue.uri||"",G=!1;if(Ue.bufferView!==void 0)D=Fe.getDependency("bufferView",Ue.bufferView).then(function(xe){G=!0;const Ne=new Blob([xe],{type:Ue.mimeType});return D=ee.createObjectURL(Ne),D});else if(Ue.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+Ce+" is missing URI and bufferView");const ue=Promise.resolve(D).then(function(xe){return new Promise(function(Ne,He){let Gt=Ne;ye.isImageBitmapLoader===!0&&(Gt=function(Yt){const Ht=new u.Texture(Yt);Ht.needsUpdate=!0,Ne(Ht)}),ye.load(u.LoaderUtils.resolveURL(xe,Re.path),Gt,void 0,He)})}).then(function(xe){return G===!0&&ee.revokeObjectURL(D),xe.userData.mimeType=Ue.mimeType||Si(Ue.uri),xe}).catch(function(xe){throw console.error("THREE.GLTFLoader: Couldn't load texture",D),xe});return this.sourceCache[Ce]=ue,ue}assignTexture(Ce,ye,Fe,Se){const Re=this;return this.getDependency("texture",Fe.index).then(function(Ue){if(!Ue)return null;if(Fe.texCoord!==void 0&&Fe.texCoord>0&&(Ue=Ue.clone(),Ue.channel=Fe.texCoord),Re.extensions[a.KHR_TEXTURE_TRANSFORM]){const ee=Fe.extensions!==void 0?Fe.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;if(ee){const D=Re.associations.get(Ue);Ue=Re.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(Ue,ee),Re.associations.set(Ue,D)}}return Se!==void 0&&(Ue.colorSpace=Se),Ce[ye]=Ue,Ue})}assignFinalMaterial(Ce){const ye=Ce.geometry;let Fe=Ce.material;const Se=ye.attributes.tangent===void 0,Re=ye.attributes.color!==void 0,Ue=ye.attributes.normal===void 0;if(Ce.isPoints){const ee="PointsMaterial:"+Fe.uuid;let D=this.cache.get(ee);D||(D=new u.PointsMaterial,u.Material.prototype.copy.call(D,Fe),D.color.copy(Fe.color),D.map=Fe.map,D.sizeAttenuation=!1,this.cache.add(ee,D)),Fe=D}else if(Ce.isLine){const ee="LineBasicMaterial:"+Fe.uuid;let D=this.cache.get(ee);D||(D=new u.LineBasicMaterial,u.Material.prototype.copy.call(D,Fe),D.color.copy(Fe.color),D.map=Fe.map,this.cache.add(ee,D)),Fe=D}if(Se||Re||Ue){let ee="ClonedMaterial:"+Fe.uuid+":";Se&&(ee+="derivative-tangents:"),Re&&(ee+="vertex-colors:"),Ue&&(ee+="flat-shading:");let D=this.cache.get(ee);D||(D=Fe.clone(),Re&&(D.vertexColors=!0),Ue&&(D.flatShading=!0),Se&&(D.normalScale&&(D.normalScale.y*=-1),D.clearcoatNormalScale&&(D.clearcoatNormalScale.y*=-1)),this.cache.add(ee,D),this.associations.set(D,this.associations.get(Fe))),Fe=D}Ce.material=Fe}getMaterialType(){return u.MeshStandardMaterial}loadMaterial(Ce){const ye=this,Fe=this.json,Se=this.extensions,Re=Fe.materials[Ce];let Ue;const ee={},D=Re.extensions||{},G=[];if(D[a.KHR_MATERIALS_UNLIT]){const xe=Se[a.KHR_MATERIALS_UNLIT];Ue=xe.getMaterialType(),G.push(xe.extendParams(ee,Re,ye))}else{const xe=Re.pbrMetallicRoughness||{};if(ee.color=new u.Color(1,1,1),ee.opacity=1,Array.isArray(xe.baseColorFactor)){const Ne=xe.baseColorFactor;ee.color.setRGB(Ne[0],Ne[1],Ne[2],u.LinearSRGBColorSpace),ee.opacity=Ne[3]}xe.baseColorTexture!==void 0&&G.push(ye.assignTexture(ee,"map",xe.baseColorTexture,u.SRGBColorSpace)),ee.metalness=xe.metallicFactor!==void 0?xe.metallicFactor:1,ee.roughness=xe.roughnessFactor!==void 0?xe.roughnessFactor:1,xe.metallicRoughnessTexture!==void 0&&(G.push(ye.assignTexture(ee,"metalnessMap",xe.metallicRoughnessTexture)),G.push(ye.assignTexture(ee,"roughnessMap",xe.metallicRoughnessTexture))),Ue=this._invokeOne(function(Ne){return Ne.getMaterialType&&Ne.getMaterialType(Ce)}),G.push(Promise.all(this._invokeAll(function(Ne){return Ne.extendMaterialParams&&Ne.extendMaterialParams(Ce,ee)})))}Re.doubleSided===!0&&(ee.side=u.DoubleSide);const ue=Re.alphaMode||Bt.OPAQUE;if(ue===Bt.BLEND?(ee.transparent=!0,ee.depthWrite=!1):(ee.transparent=!1,ue===Bt.MASK&&(ee.alphaTest=Re.alphaCutoff!==void 0?Re.alphaCutoff:.5)),Re.normalTexture!==void 0&&Ue!==u.MeshBasicMaterial&&(G.push(ye.assignTexture(ee,"normalMap",Re.normalTexture)),ee.normalScale=new u.Vector2(1,1),Re.normalTexture.scale!==void 0)){const xe=Re.normalTexture.scale;ee.normalScale.set(xe,xe)}if(Re.occlusionTexture!==void 0&&Ue!==u.MeshBasicMaterial&&(G.push(ye.assignTexture(ee,"aoMap",Re.occlusionTexture)),Re.occlusionTexture.strength!==void 0&&(ee.aoMapIntensity=Re.occlusionTexture.strength)),Re.emissiveFactor!==void 0&&Ue!==u.MeshBasicMaterial){const xe=Re.emissiveFactor;ee.emissive=new u.Color().setRGB(xe[0],xe[1],xe[2],u.LinearSRGBColorSpace)}return Re.emissiveTexture!==void 0&&Ue!==u.MeshBasicMaterial&&G.push(ye.assignTexture(ee,"emissiveMap",Re.emissiveTexture,u.SRGBColorSpace)),Promise.all(G).then(function(){const xe=new Ue(ee);return Re.name&&(xe.name=Re.name),nn(xe,Re),ye.associations.set(xe,{materials:Ce}),Re.extensions&&jt(Se,xe,Re),xe})}createUniqueName(Ce){const ye=u.PropertyBinding.sanitizeNodeName(Ce||"");return ye in this.nodeNamesUsed?ye+"_"+ ++this.nodeNamesUsed[ye]:(this.nodeNamesUsed[ye]=0,ye)}loadGeometries(Ce){const ye=this,Fe=this.extensions,Se=this.primitiveCache;function Re(ee){return Fe[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ee,ye).then(function(D){return Kn(D,ee,ye)})}const Ue=[];for(let ee=0,D=Ce.length;ee<D;ee++){const G=Ce[ee],ue=xn(G),xe=Se[ue];if(xe)Ue.push(xe.promise);else{let Ne;G.extensions&&G.extensions[a.KHR_DRACO_MESH_COMPRESSION]?Ne=Re(G):Ne=Kn(new u.BufferGeometry,G,ye),Se[ue]={primitive:G,promise:Ne},Ue.push(Ne)}}return Promise.all(Ue)}loadMesh(Ce){const ye=this,Fe=this.json,Se=this.extensions,Re=Fe.meshes[Ce],Ue=Re.primitives,ee=[];for(let D=0,G=Ue.length;D<G;D++){const ue=Ue[D].material===void 0?kt(this.cache):this.getDependency("material",Ue[D].material);ee.push(ue)}return ee.push(ye.loadGeometries(Ue)),Promise.all(ee).then(function(D){const G=D.slice(0,D.length-1),ue=D[D.length-1],xe=[];for(let He=0,Gt=ue.length;He<Gt;He++){const Yt=ue[He],Ht=Ue[He];let zt;const fn=G[He];if(Ht.mode===J.TRIANGLES||Ht.mode===J.TRIANGLE_STRIP||Ht.mode===J.TRIANGLE_FAN||Ht.mode===void 0)zt=Re.isSkinnedMesh===!0?new u.SkinnedMesh(Yt,fn):new u.Mesh(Yt,fn),zt.isSkinnedMesh===!0&&zt.normalizeSkinWeights(),Ht.mode===J.TRIANGLE_STRIP?zt.geometry=(0,w.toTrianglesDrawMode)(zt.geometry,u.TriangleStripDrawMode):Ht.mode===J.TRIANGLE_FAN&&(zt.geometry=(0,w.toTrianglesDrawMode)(zt.geometry,u.TriangleFanDrawMode));else if(Ht.mode===J.LINES)zt=new u.LineSegments(Yt,fn);else if(Ht.mode===J.LINE_STRIP)zt=new u.Line(Yt,fn);else if(Ht.mode===J.LINE_LOOP)zt=new u.LineLoop(Yt,fn);else if(Ht.mode===J.POINTS)zt=new u.Points(Yt,fn);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Ht.mode);Object.keys(zt.geometry.morphAttributes).length>0&&kn(zt,Re),zt.name=ye.createUniqueName(Re.name||"mesh_"+Ce),nn(zt,Re),Ht.extensions&&jt(Se,zt,Ht),ye.assignFinalMaterial(zt),xe.push(zt)}for(let He=0,Gt=xe.length;He<Gt;He++)ye.associations.set(xe[He],{meshes:Ce,primitives:He});if(xe.length===1)return Re.extensions&&jt(Se,xe[0],Re),xe[0];const Ne=new u.Group;Re.extensions&&jt(Se,Ne,Re),ye.associations.set(Ne,{meshes:Ce});for(let He=0,Gt=xe.length;He<Gt;He++)Ne.add(xe[He]);return Ne})}loadCamera(Ce){let ye;const Fe=this.json.cameras[Ce],Se=Fe[Fe.type];if(!Se){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Fe.type==="perspective"?ye=new u.PerspectiveCamera(u.MathUtils.radToDeg(Se.yfov),Se.aspectRatio||1,Se.znear||1,Se.zfar||2e6):Fe.type==="orthographic"&&(ye=new u.OrthographicCamera(-Se.xmag,Se.xmag,Se.ymag,-Se.ymag,Se.znear,Se.zfar)),Fe.name&&(ye.name=this.createUniqueName(Fe.name)),nn(ye,Fe),Promise.resolve(ye)}loadSkin(Ce){const ye=this.json.skins[Ce],Fe=[];for(let Se=0,Re=ye.joints.length;Se<Re;Se++)Fe.push(this._loadNodeShallow(ye.joints[Se]));return ye.inverseBindMatrices!==void 0?Fe.push(this.getDependency("accessor",ye.inverseBindMatrices)):Fe.push(null),Promise.all(Fe).then(function(Se){const Re=Se.pop(),Ue=Se,ee=[],D=[];for(let G=0,ue=Ue.length;G<ue;G++){const xe=Ue[G];if(xe){ee.push(xe);const Ne=new u.Matrix4;Re!==null&&Ne.fromArray(Re.array,G*16),D.push(Ne)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',ye.joints[G])}return new u.Skeleton(ee,D)})}loadAnimation(Ce){const ye=this.json,Fe=this,Se=ye.animations[Ce],Re=Se.name?Se.name:"animation_"+Ce,Ue=[],ee=[],D=[],G=[],ue=[];for(let xe=0,Ne=Se.channels.length;xe<Ne;xe++){const He=Se.channels[xe],Gt=Se.samplers[He.sampler],Yt=He.target,Ht=Yt.node,zt=Se.parameters!==void 0?Se.parameters[Gt.input]:Gt.input,fn=Se.parameters!==void 0?Se.parameters[Gt.output]:Gt.output;Yt.node!==void 0&&(Ue.push(this.getDependency("node",Ht)),ee.push(this.getDependency("accessor",zt)),D.push(this.getDependency("accessor",fn)),G.push(Gt),ue.push(Yt))}return Promise.all([Promise.all(Ue),Promise.all(ee),Promise.all(D),Promise.all(G),Promise.all(ue)]).then(function(xe){const Ne=xe[0],He=xe[1],Gt=xe[2],Yt=xe[3],Ht=xe[4],zt=[];for(let fn=0,nr=Ne.length;fn<nr;fn++){const Bn=Ne[fn],bi=He[fn],Ti=Gt[fn],Oi=Yt[fn],Mr=Ht[fn];if(Bn===void 0)continue;Bn.updateMatrix&&Bn.updateMatrix();const $n=Fe._createAnimationTracks(Bn,bi,Ti,Oi,Mr);if($n)for(let Or=0;Or<$n.length;Or++)zt.push($n[Or])}return new u.AnimationClip(Re,void 0,zt)})}createNodeMesh(Ce){const ye=this.json,Fe=this,Se=ye.nodes[Ce];return Se.mesh===void 0?null:Fe.getDependency("mesh",Se.mesh).then(function(Re){const Ue=Fe._getNodeRef(Fe.meshCache,Se.mesh,Re);return Se.weights!==void 0&&Ue.traverse(function(ee){if(ee.isMesh)for(let D=0,G=Se.weights.length;D<G;D++)ee.morphTargetInfluences[D]=Se.weights[D]}),Ue})}loadNode(Ce){const ye=this.json,Fe=this,Se=ye.nodes[Ce],Re=Fe._loadNodeShallow(Ce),Ue=[],ee=Se.children||[];for(let G=0,ue=ee.length;G<ue;G++)Ue.push(Fe.getDependency("node",ee[G]));const D=Se.skin===void 0?Promise.resolve(null):Fe.getDependency("skin",Se.skin);return Promise.all([Re,Promise.all(Ue),D]).then(function(G){const ue=G[0],xe=G[1],Ne=G[2];Ne!==null&&ue.traverse(function(He){He.isSkinnedMesh&&He.bind(Ne,Zn)});for(let He=0,Gt=xe.length;He<Gt;He++)ue.add(xe[He]);return ue})}_loadNodeShallow(Ce){const ye=this.json,Fe=this.extensions,Se=this;if(this.nodeCache[Ce]!==void 0)return this.nodeCache[Ce];const Re=ye.nodes[Ce],Ue=Re.name?Se.createUniqueName(Re.name):"",ee=[],D=Se._invokeOne(function(G){return G.createNodeMesh&&G.createNodeMesh(Ce)});return D&&ee.push(D),Re.camera!==void 0&&ee.push(Se.getDependency("camera",Re.camera).then(function(G){return Se._getNodeRef(Se.cameraCache,Re.camera,G)})),Se._invokeAll(function(G){return G.createNodeAttachment&&G.createNodeAttachment(Ce)}).forEach(function(G){ee.push(G)}),this.nodeCache[Ce]=Promise.all(ee).then(function(G){let ue;if(Re.isBone===!0?ue=new u.Bone:G.length>1?ue=new u.Group:G.length===1?ue=G[0]:ue=new u.Object3D,ue!==G[0])for(let xe=0,Ne=G.length;xe<Ne;xe++)ue.add(G[xe]);if(Re.name&&(ue.userData.name=Re.name,ue.name=Ue),nn(ue,Re),Re.extensions&&jt(Fe,ue,Re),Re.matrix!==void 0){const xe=new u.Matrix4;xe.fromArray(Re.matrix),ue.applyMatrix4(xe)}else Re.translation!==void 0&&ue.position.fromArray(Re.translation),Re.rotation!==void 0&&ue.quaternion.fromArray(Re.rotation),Re.scale!==void 0&&ue.scale.fromArray(Re.scale);return Se.associations.has(ue)||Se.associations.set(ue,{}),Se.associations.get(ue).nodes=Ce,ue}),this.nodeCache[Ce]}loadScene(Ce){const ye=this.extensions,Fe=this.json.scenes[Ce],Se=this,Re=new u.Group;Fe.name&&(Re.name=Se.createUniqueName(Fe.name)),nn(Re,Fe),Fe.extensions&&jt(ye,Re,Fe);const Ue=Fe.nodes||[],ee=[];for(let D=0,G=Ue.length;D<G;D++)ee.push(Se.getDependency("node",Ue[D]));return Promise.all(ee).then(function(D){for(let ue=0,xe=D.length;ue<xe;ue++)Re.add(D[ue]);const G=ue=>{const xe=new Map;for(const[Ne,He]of Se.associations)(Ne instanceof u.Material||Ne instanceof u.Texture)&&xe.set(Ne,He);return ue.traverse(Ne=>{const He=Se.associations.get(Ne);He!=null&&xe.set(Ne,He)}),xe};return Se.associations=G(Re),Re})}_createAnimationTracks(Ce,ye,Fe,Se,Re){const Ue=[],ee=Ce.name?Ce.name:Ce.uuid,D=[];ft[Re.path]===ft.weights?Ce.traverse(function(Ne){Ne.morphTargetInfluences&&D.push(Ne.name?Ne.name:Ne.uuid)}):D.push(ee);let G;switch(ft[Re.path]){case ft.weights:G=u.NumberKeyframeTrack;break;case ft.rotation:G=u.QuaternionKeyframeTrack;break;case ft.position:case ft.scale:G=u.VectorKeyframeTrack;break;default:switch(Fe.itemSize){case 1:G=u.NumberKeyframeTrack;break;case 2:case 3:default:G=u.VectorKeyframeTrack;break}break}const ue=Se.interpolation!==void 0?Et[Se.interpolation]:u.InterpolateLinear,xe=this._getArrayFromAccessor(Fe);for(let Ne=0,He=D.length;Ne<He;Ne++){const Gt=new G(D[Ne]+"."+ft[Re.path],ye.array,xe,ue);Se.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(Gt),Ue.push(Gt)}return Ue}_getArrayFromAccessor(Ce){let ye=Ce.array;if(Ce.normalized){const Fe=Wn(ye.constructor),Se=new Float32Array(ye.length);for(let Re=0,Ue=ye.length;Re<Ue;Re++)Se[Re]=ye[Re]*Fe;ye=Se}return ye}_createCubicSplineTrackInterpolant(Ce){Ce.createInterpolant=function(Fe){const Se=this instanceof u.QuaternionKeyframeTrack?Q:I;return new Se(this.times,this.values,this.getValueSize()/3,Fe)},Ce.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Qi(Mt,Ce,ye){const Fe=Ce.attributes,Se=new u.Box3;if(Fe.POSITION!==void 0){const ee=ye.json.accessors[Fe.POSITION],D=ee.min,G=ee.max;if(D!==void 0&&G!==void 0){if(Se.set(new u.Vector3(D[0],D[1],D[2]),new u.Vector3(G[0],G[1],G[2])),ee.normalized){const ue=Wn(ve[ee.componentType]);Se.min.multiplyScalar(ue),Se.max.multiplyScalar(ue)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const Re=Ce.targets;if(Re!==void 0){const ee=new u.Vector3,D=new u.Vector3;for(let G=0,ue=Re.length;G<ue;G++){const xe=Re[G];if(xe.POSITION!==void 0){const Ne=ye.json.accessors[xe.POSITION],He=Ne.min,Gt=Ne.max;if(He!==void 0&&Gt!==void 0){if(D.setX(Math.max(Math.abs(He[0]),Math.abs(Gt[0]))),D.setY(Math.max(Math.abs(He[1]),Math.abs(Gt[1]))),D.setZ(Math.max(Math.abs(He[2]),Math.abs(Gt[2]))),Ne.normalized){const Yt=Wn(ve[Ne.componentType]);D.multiplyScalar(Yt)}ee.max(D)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Se.expandByVector(ee)}Mt.boundingBox=Se;const Ue=new u.Sphere;Se.getCenter(Ue.center),Ue.radius=Se.min.distanceTo(Se.max)/2,Mt.boundingSphere=Ue}function Kn(Mt,Ce,ye){const Fe=Ce.attributes,Se=[];function Re(Ue,ee){return ye.getDependency("accessor",Ue).then(function(D){Mt.setAttribute(ee,D)})}for(const Ue in Fe){const ee=qe[Ue]||Ue.toLowerCase();ee in Mt.attributes||Se.push(Re(Fe[Ue],ee))}if(Ce.indices!==void 0&&!Mt.index){const Ue=ye.getDependency("accessor",Ce.indices).then(function(ee){Mt.setIndex(ee)});Se.push(Ue)}return u.ColorManagement.workingColorSpace!==u.LinearSRGBColorSpace&&"COLOR_0"in Fe&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${u.ColorManagement.workingColorSpace}" not supported.`),nn(Mt,Ce),Qi(Mt,Ce,ye),Promise.all(Se).then(function(){return Ce.targets!==void 0?Jn(Mt,Ce.targets,ye):Mt})}},"./node_modules/three/examples/jsm/loaders/KTX2Loader.js":(W,$,A)=>{A.r($),A.d($,{KTX2Loader:()=>l});var u=A("./node_modules/three/build/three.module.js"),w=A("./node_modules/three/examples/jsm/utils/WorkerPool.js"),h=A("./node_modules/three/examples/jsm/libs/ktx-parse.module.js"),v=A("./node_modules/three/examples/jsm/libs/zstddec.module.js");const a=new WeakMap;let f=0,m;class l extends u.Loader{constructor(_){super(_),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new w.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(_){return this.transcoderPath=_,this}setWorkerLimit(_){return this.workerPool.setWorkerLimit(_),this}async detectSupportAsync(_){return this.workerConfig={astcSupported:await _.hasFeatureAsync("texture-compression-astc"),etc1Supported:await _.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await _.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await _.hasFeatureAsync("texture-compression-bc"),bptcSupported:await _.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await _.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(_){return _.isWebGPURenderer===!0?this.workerConfig={astcSupported:_.hasFeature("texture-compression-astc"),etc1Supported:_.hasFeature("texture-compression-etc1"),etc2Supported:_.hasFeature("texture-compression-etc2"),dxtSupported:_.hasFeature("texture-compression-bc"),bptcSupported:_.hasFeature("texture-compression-bptc"),pvrtcSupported:_.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:_.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:_.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:_.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:_.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:_.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:_.extensions.has("WEBGL_compressed_texture_pvrtc")||_.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const _=new u.FileLoader(this.manager);_.setPath(this.transcoderPath),_.setWithCredentials(this.withCredentials);const L=_.loadAsync("basis_transcoder.js"),T=new u.FileLoader(this.manager);T.setPath(this.transcoderPath),T.setResponseType("arraybuffer"),T.setWithCredentials(this.withCredentials);const N=T.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([L,N]).then(([F,te])=>{const K=l.BasisWorker.toString(),se=["/* constants */","let _EngineFormat = "+JSON.stringify(l.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(l.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(l.BasisFormat),"/* basis_transcoder.js */",F,"/* worker */",K.substring(K.indexOf("{")+1,K.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([se])),this.transcoderBinary=te,this.workerPool.setWorkerCreator(()=>{const ne=new Worker(this.workerSourceURL),re=this.transcoderBinary.slice(0);return ne.postMessage({type:"init",config:this.workerConfig,transcoderBinary:re},[re]),ne})}),f>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),f++}return this.transcoderPending}load(_,L,T,N){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const F=new u.FileLoader(this.manager);F.setResponseType("arraybuffer"),F.setWithCredentials(this.withCredentials),F.load(_,te=>{if(a.has(te))return a.get(te).promise.then(L).catch(N);this._createTexture(te).then(K=>L?L(K):null).catch(N)},T,N)}_createTextureFrom(_,L){const{faces:T,width:N,height:F,format:te,type:K,error:se,dfdFlags:ne}=_;if(K==="error")return Promise.reject(se);let re;if(L.faceCount===6)re=new u.CompressedCubeTexture(T,te,u.UnsignedByteType);else{const Y=T[0].mipmaps;re=L.layerCount>1?new u.CompressedArrayTexture(Y,N,F,L.layerCount,te,u.UnsignedByteType):new u.CompressedTexture(Y,N,F,te,u.UnsignedByteType)}return re.minFilter=T[0].mipmaps.length===1?u.LinearFilter:u.LinearMipmapLinearFilter,re.magFilter=u.LinearFilter,re.generateMipmaps=!1,re.needsUpdate=!0,re.colorSpace=C(L),re.premultiplyAlpha=!!(ne&h.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),re}async _createTexture(_,L={}){const T=(0,h.read)(new Uint8Array(_));if(T.vkFormat!==h.VK_FORMAT_UNDEFINED)return p(T);const N=L,F=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:_,taskConfig:N},[_])).then(te=>this._createTextureFrom(te.data,T));return a.set(_,{promise:F}),F}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),f--,this}}l.BasisFormat={ETC1S:0,UASTC_4x4:1},l.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},l.EngineFormat={RGBAFormat:u.RGBAFormat,RGBA_ASTC_4x4_Format:u.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:u.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:u.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:u.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:u.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:u.RGB_ETC1_Format,RGB_ETC2_Format:u.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:u.RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:u.RGBA_S3TC_DXT1_Format},l.BasisWorker=function(){let S,_,L;const T=_EngineFormat,N=_TranscoderFormat,F=_BasisFormat;self.addEventListener("message",function(ae){const Ae=ae.data;switch(Ae.type){case"init":S=Ae.config,te(Ae.transcoderBinary);break;case"transcode":_.then(()=>{try{const{faces:b,buffers:I,width:O,height:Q,hasAlpha:J,format:ve,dfdFlags:Le}=K(Ae.buffer);self.postMessage({type:"transcode",id:Ae.id,faces:b,width:O,height:Q,hasAlpha:J,format:ve,dfdFlags:Le},I)}catch(b){console.error(b),self.postMessage({type:"error",id:Ae.id,error:b.message})}});break}});function te(ae){_=new Promise(Ae=>{L={wasmBinary:ae,onRuntimeInitialized:Ae},BASIS(L)}).then(()=>{L.initializeBasis(),L.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function K(ae){const Ae=new L.KTX2File(new Uint8Array(ae));function b(){Ae.close(),Ae.delete()}if(!Ae.isValid())throw b(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const I=Ae.isUASTC()?F.UASTC_4x4:F.ETC1S,O=Ae.getWidth(),Q=Ae.getHeight(),J=Ae.getLayers()||1,ve=Ae.getLevels(),Le=Ae.getFaces(),_e=Ae.getHasAlpha(),Ze=Ae.getDFDFlags(),{transcoderFormat:qe,engineFormat:ft}=Y(I,O,Q,_e);if(!O||!Q||!ve)throw b(),new Error("THREE.KTX2Loader:	Invalid texture");if(!Ae.startTranscoding())throw b(),new Error("THREE.KTX2Loader: .startTranscoding failed");const Et=[],Bt=[];for(let kt=0;kt<Le;kt++){const jt=[];for(let nn=0;nn<ve;nn++){const Jn=[];let kn,xn;for(let Wn=0;Wn<J;Wn++){const Si=Ae.getImageLevelInfo(nn,Wn,kt);kt===0&&nn===0&&Wn===0&&(Si.origWidth%4!==0||Si.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),ve>1?(kn=Si.origWidth,xn=Si.origHeight):(kn=Si.width,xn=Si.height);const Zn=new Uint8Array(Ae.getImageTranscodedSizeInBytes(nn,Wn,0,qe));if(!Ae.transcodeImage(Zn,nn,Wn,kt,qe,0,-1,-1))throw b(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Jn.push(Zn)}const Fn=oe(Jn);jt.push({data:Fn,width:kn,height:xn}),Bt.push(Fn.buffer)}Et.push({mipmaps:jt,width:O,height:Q,format:ft})}return b(),{faces:Et,buffers:Bt,width:O,height:Q,hasAlpha:_e,format:ft,dfdFlags:Ze}}const se=[{if:"astcSupported",basisFormat:[F.UASTC_4x4],transcoderFormat:[N.ASTC_4x4,N.ASTC_4x4],engineFormat:[T.RGBA_ASTC_4x4_Format,T.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[N.BC7_M5,N.BC7_M5],engineFormat:[T.RGBA_BPTC_Format,T.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[N.BC1,N.BC3],engineFormat:[T.RGBA_S3TC_DXT1_Format,T.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[N.ETC1,N.ETC2],engineFormat:[T.RGB_ETC2_Format,T.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[N.ETC1],engineFormat:[T.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[N.PVRTC1_4_RGB,N.PVRTC1_4_RGBA],engineFormat:[T.RGB_PVRTC_4BPPV1_Format,T.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],ne=se.sort(function(ae,Ae){return ae.priorityETC1S-Ae.priorityETC1S}),re=se.sort(function(ae,Ae){return ae.priorityUASTC-Ae.priorityUASTC});function Y(ae,Ae,b,I){let O,Q;const J=ae===F.ETC1S?ne:re;for(let ve=0;ve<J.length;ve++){const Le=J[ve];if(S[Le.if]&&Le.basisFormat.includes(ae)&&!(I&&Le.transcoderFormat.length<2)&&!(Le.needsPowerOfTwo&&!(k(Ae)&&k(b))))return O=Le.transcoderFormat[I?1:0],Q=Le.engineFormat[I?1:0],{transcoderFormat:O,engineFormat:Q}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),O=N.RGBA32,Q=T.RGBAFormat,{transcoderFormat:O,engineFormat:Q}}function k(ae){return ae<=2?!0:(ae&ae-1)===0&&ae!==0}function oe(ae){if(ae.length===1)return ae[0];let Ae=0;for(let O=0;O<ae.length;O++){const Q=ae[O];Ae+=Q.byteLength}const b=new Uint8Array(Ae);let I=0;for(let O=0;O<ae.length;O++){const Q=ae[O];b.set(Q,I),I+=Q.byteLength}return b}};const y=new Set([u.RGBAFormat,u.RGFormat,u.RedFormat]),g={[h.VK_FORMAT_R32G32B32A32_SFLOAT]:u.RGBAFormat,[h.VK_FORMAT_R16G16B16A16_SFLOAT]:u.RGBAFormat,[h.VK_FORMAT_R8G8B8A8_UNORM]:u.RGBAFormat,[h.VK_FORMAT_R8G8B8A8_SRGB]:u.RGBAFormat,[h.VK_FORMAT_R32G32_SFLOAT]:u.RGFormat,[h.VK_FORMAT_R16G16_SFLOAT]:u.RGFormat,[h.VK_FORMAT_R8G8_UNORM]:u.RGFormat,[h.VK_FORMAT_R8G8_SRGB]:u.RGFormat,[h.VK_FORMAT_R32_SFLOAT]:u.RedFormat,[h.VK_FORMAT_R16_SFLOAT]:u.RedFormat,[h.VK_FORMAT_R8_SRGB]:u.RedFormat,[h.VK_FORMAT_R8_UNORM]:u.RedFormat,[h.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:u.RGBA_ASTC_6x6_Format,[h.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:u.RGBA_ASTC_6x6_Format},d={[h.VK_FORMAT_R32G32B32A32_SFLOAT]:u.FloatType,[h.VK_FORMAT_R16G16B16A16_SFLOAT]:u.HalfFloatType,[h.VK_FORMAT_R8G8B8A8_UNORM]:u.UnsignedByteType,[h.VK_FORMAT_R8G8B8A8_SRGB]:u.UnsignedByteType,[h.VK_FORMAT_R32G32_SFLOAT]:u.FloatType,[h.VK_FORMAT_R16G16_SFLOAT]:u.HalfFloatType,[h.VK_FORMAT_R8G8_UNORM]:u.UnsignedByteType,[h.VK_FORMAT_R8G8_SRGB]:u.UnsignedByteType,[h.VK_FORMAT_R32_SFLOAT]:u.FloatType,[h.VK_FORMAT_R16_SFLOAT]:u.HalfFloatType,[h.VK_FORMAT_R8_SRGB]:u.UnsignedByteType,[h.VK_FORMAT_R8_UNORM]:u.UnsignedByteType,[h.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:u.UnsignedByteType,[h.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:u.UnsignedByteType};async function p(S){const{vkFormat:_}=S;if(g[_]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let L;S.supercompressionScheme===h.KHR_SUPERCOMPRESSION_ZSTD&&(m||(m=new Promise(async F=>{const te=new v.ZSTDDecoder;await te.init(),F(te)})),L=await m);const T=[];for(let F=0;F<S.levels.length;F++){const te=Math.max(1,S.pixelWidth>>F),K=Math.max(1,S.pixelHeight>>F),se=S.pixelDepth?Math.max(1,S.pixelDepth>>F):0,ne=S.levels[F];let re;if(S.supercompressionScheme===h.KHR_SUPERCOMPRESSION_NONE)re=ne.levelData;else if(S.supercompressionScheme===h.KHR_SUPERCOMPRESSION_ZSTD)re=L.decode(ne.levelData,ne.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let Y;d[_]===u.FloatType?Y=new Float32Array(re.buffer,re.byteOffset,re.byteLength/Float32Array.BYTES_PER_ELEMENT):d[_]===u.HalfFloatType?Y=new Uint16Array(re.buffer,re.byteOffset,re.byteLength/Uint16Array.BYTES_PER_ELEMENT):Y=re,T.push({data:Y,width:te,height:K,depth:se})}let N;if(y.has(g[_]))N=S.pixelDepth===0?new u.DataTexture(T[0].data,S.pixelWidth,S.pixelHeight):new u.Data3DTexture(T[0].data,S.pixelWidth,S.pixelHeight,S.pixelDepth);else{if(S.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");N=new u.CompressedTexture(T,S.pixelWidth,S.pixelHeight)}return N.mipmaps=T,N.type=d[_],N.format=g[_],N.colorSpace=C(S),N.needsUpdate=!0,Promise.resolve(N)}function C(S){const _=S.dataFormatDescriptor[0];return _.colorPrimaries===h.KHR_DF_PRIMARIES_BT709?_.transferFunction===h.KHR_DF_TRANSFER_SRGB?u.SRGBColorSpace:u.LinearSRGBColorSpace:_.colorPrimaries===h.KHR_DF_PRIMARIES_DISPLAYP3?_.transferFunction===h.KHR_DF_TRANSFER_SRGB?u.DisplayP3ColorSpace:u.LinearDisplayP3ColorSpace:(_.colorPrimaries===h.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${_.colorPrimaries}"`),u.NoColorSpace)}},"./node_modules/three/examples/jsm/loaders/MTLLoader.js":(W,$,A)=>{A.r($),A.d($,{MTLLoader:()=>w});var u=A("./node_modules/three/build/three.module.js");class w extends u.Loader{constructor(a){super(a)}load(a,f,m,l){const y=this,g=this.path===""?u.LoaderUtils.extractUrlBase(a):this.path,d=new u.FileLoader(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(a,function(p){try{f(y.parse(p,g))}catch(C){l?l(C):console.error(C),y.manager.itemError(a)}},m,l)}setMaterialOptions(a){return this.materialOptions=a,this}parse(a,f){const m=a.split(`
`);let l={};const y=/\s+/,g={};for(let p=0;p<m.length;p++){let C=m[p];if(C=C.trim(),C.length===0||C.charAt(0)==="#")continue;const S=C.indexOf(" ");let _=S>=0?C.substring(0,S):C;_=_.toLowerCase();let L=S>=0?C.substring(S+1):"";if(L=L.trim(),_==="newmtl")l={name:L},g[L]=l;else if(_==="ka"||_==="kd"||_==="ks"||_==="ke"){const T=L.split(y,3);l[_]=[parseFloat(T[0]),parseFloat(T[1]),parseFloat(T[2])]}else l[_]=L}const d=new h(this.resourcePath||f,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(g),d}}class h{constructor(a="",f={}){this.baseUrl=a,this.options=f,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:u.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:u.RepeatWrapping}setCrossOrigin(a){return this.crossOrigin=a,this}setManager(a){this.manager=a}setMaterials(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(a){if(!this.options)return a;const f={};for(const m in a){const l=a[m],y={};f[m]=y;for(const g in l){let d=!0,p=l[g];const C=g.toLowerCase();switch(C){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(p=[p[0]/255,p[1]/255,p[2]/255]),this.options&&this.options.ignoreZeroRGBs&&p[0]===0&&p[1]===0&&p[2]===0&&(d=!1);break}d&&(y[C]=p)}}return f}preload(){for(const a in this.materialsInfo)this.create(a)}getIndex(a){return this.nameLookup[a]}getAsArray(){let a=0;for(const f in this.materialsInfo)this.materialsArray[a]=this.create(f),this.nameLookup[f]=a,a++;return this.materialsArray}create(a){return this.materials[a]===void 0&&this.createMaterial_(a),this.materials[a]}createMaterial_(a){const f=this,m=this.materialsInfo[a],l={name:a,side:this.side};function y(d,p){return typeof p!="string"||p===""?"":/^https?:\/\//i.test(p)?p:d+p}function g(d,p){if(l[d])return;const C=f.getTextureParams(p,l),S=f.loadTexture(y(f.baseUrl,C.url));S.repeat.copy(C.scale),S.offset.copy(C.offset),S.wrapS=f.wrap,S.wrapT=f.wrap,(d==="map"||d==="emissiveMap")&&(S.colorSpace=u.SRGBColorSpace),l[d]=S}for(const d in m){const p=m[d];let C;if(p!=="")switch(d.toLowerCase()){case"kd":l.color=new u.Color().fromArray(p).convertSRGBToLinear();break;case"ks":l.specular=new u.Color().fromArray(p).convertSRGBToLinear();break;case"ke":l.emissive=new u.Color().fromArray(p).convertSRGBToLinear();break;case"map_kd":g("map",p);break;case"map_ks":g("specularMap",p);break;case"map_ke":g("emissiveMap",p);break;case"norm":g("normalMap",p);break;case"map_bump":case"bump":g("bumpMap",p);break;case"map_d":g("alphaMap",p),l.transparent=!0;break;case"ns":l.shininess=parseFloat(p);break;case"d":C=parseFloat(p),C<1&&(l.opacity=C,l.transparent=!0);break;case"tr":C=parseFloat(p),this.options&&this.options.invertTrProperty&&(C=1-C),C>0&&(l.opacity=1-C,l.transparent=!0);break}}return this.materials[a]=new u.MeshPhongMaterial(l),this.materials[a]}getTextureParams(a,f){const m={scale:new u.Vector2(1,1),offset:new u.Vector2(0,0)},l=a.split(/\s+/);let y;return y=l.indexOf("-bm"),y>=0&&(f.bumpScale=parseFloat(l[y+1]),l.splice(y,2)),y=l.indexOf("-s"),y>=0&&(m.scale.set(parseFloat(l[y+1]),parseFloat(l[y+2])),l.splice(y,4)),y=l.indexOf("-o"),y>=0&&(m.offset.set(parseFloat(l[y+1]),parseFloat(l[y+2])),l.splice(y,4)),m.url=l.join(" ").trim(),m}loadTexture(a,f,m,l,y){const g=this.manager!==void 0?this.manager:u.DefaultLoadingManager;let d=g.getHandler(a);d===null&&(d=new u.TextureLoader(g)),d.setCrossOrigin&&d.setCrossOrigin(this.crossOrigin);const p=d.load(a,m,l,y);return f!==void 0&&(p.mapping=f),p}}},"./node_modules/three/examples/jsm/loaders/OBJLoader.js":(W,$,A)=>{A.r($),A.d($,{OBJLoader:()=>S});var u=A("./node_modules/three/build/three.module.js");const w=/^[og]\s*(.+)?/,h=/^mtllib /,v=/^usemtl /,a=/^usemap /,f=/\s+/,m=new u.Vector3,l=new u.Vector3,y=new u.Vector3,g=new u.Vector3,d=new u.Vector3,p=new u.Color;function C(){const _={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(L,T){if(this.object&&this.object.fromDeclaration===!1){this.object.name=L,this.object.fromDeclaration=T!==!1;return}const N=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:L||"",fromDeclaration:T!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(F,te){const K=this._finalize(!1);K&&(K.inherited||K.groupCount<=0)&&this.materials.splice(K.index,1);const se={index:this.materials.length,name:F||"",mtllib:Array.isArray(te)&&te.length>0?te[te.length-1]:"",smooth:K!==void 0?K.smooth:this.smooth,groupStart:K!==void 0?K.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(ne){const re={index:typeof ne=="number"?ne:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return re.clone=this.clone.bind(re),re}};return this.materials.push(se),se},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(F){const te=this.currentMaterial();if(te&&te.groupEnd===-1&&(te.groupEnd=this.geometry.vertices.length/3,te.groupCount=te.groupEnd-te.groupStart,te.inherited=!1),F&&this.materials.length>1)for(let K=this.materials.length-1;K>=0;K--)this.materials[K].groupCount<=0&&this.materials.splice(K,1);return F&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),te}},N&&N.name&&typeof N.clone=="function"){const F=N.clone(0);F.inherited=!0,this.object.materials.push(F)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(L,T){const N=parseInt(L,10);return(N>=0?N-1:N+T/3)*3},parseNormalIndex:function(L,T){const N=parseInt(L,10);return(N>=0?N-1:N+T/3)*3},parseUVIndex:function(L,T){const N=parseInt(L,10);return(N>=0?N-1:N+T/2)*2},addVertex:function(L,T,N){const F=this.vertices,te=this.object.geometry.vertices;te.push(F[L+0],F[L+1],F[L+2]),te.push(F[T+0],F[T+1],F[T+2]),te.push(F[N+0],F[N+1],F[N+2])},addVertexPoint:function(L){const T=this.vertices;this.object.geometry.vertices.push(T[L+0],T[L+1],T[L+2])},addVertexLine:function(L){const T=this.vertices;this.object.geometry.vertices.push(T[L+0],T[L+1],T[L+2])},addNormal:function(L,T,N){const F=this.normals,te=this.object.geometry.normals;te.push(F[L+0],F[L+1],F[L+2]),te.push(F[T+0],F[T+1],F[T+2]),te.push(F[N+0],F[N+1],F[N+2])},addFaceNormal:function(L,T,N){const F=this.vertices,te=this.object.geometry.normals;m.fromArray(F,L),l.fromArray(F,T),y.fromArray(F,N),d.subVectors(y,l),g.subVectors(m,l),d.cross(g),d.normalize(),te.push(d.x,d.y,d.z),te.push(d.x,d.y,d.z),te.push(d.x,d.y,d.z)},addColor:function(L,T,N){const F=this.colors,te=this.object.geometry.colors;F[L]!==void 0&&te.push(F[L+0],F[L+1],F[L+2]),F[T]!==void 0&&te.push(F[T+0],F[T+1],F[T+2]),F[N]!==void 0&&te.push(F[N+0],F[N+1],F[N+2])},addUV:function(L,T,N){const F=this.uvs,te=this.object.geometry.uvs;te.push(F[L+0],F[L+1]),te.push(F[T+0],F[T+1]),te.push(F[N+0],F[N+1])},addDefaultUV:function(){const L=this.object.geometry.uvs;L.push(0,0),L.push(0,0),L.push(0,0)},addUVLine:function(L){const T=this.uvs;this.object.geometry.uvs.push(T[L+0],T[L+1])},addFace:function(L,T,N,F,te,K,se,ne,re){const Y=this.vertices.length;let k=this.parseVertexIndex(L,Y),oe=this.parseVertexIndex(T,Y),ae=this.parseVertexIndex(N,Y);if(this.addVertex(k,oe,ae),this.addColor(k,oe,ae),se!==void 0&&se!==""){const Ae=this.normals.length;k=this.parseNormalIndex(se,Ae),oe=this.parseNormalIndex(ne,Ae),ae=this.parseNormalIndex(re,Ae),this.addNormal(k,oe,ae)}else this.addFaceNormal(k,oe,ae);if(F!==void 0&&F!==""){const Ae=this.uvs.length;k=this.parseUVIndex(F,Ae),oe=this.parseUVIndex(te,Ae),ae=this.parseUVIndex(K,Ae),this.addUV(k,oe,ae),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(L){this.object.geometry.type="Points";const T=this.vertices.length;for(let N=0,F=L.length;N<F;N++){const te=this.parseVertexIndex(L[N],T);this.addVertexPoint(te),this.addColor(te)}},addLineGeometry:function(L,T){this.object.geometry.type="Line";const N=this.vertices.length,F=this.uvs.length;for(let te=0,K=L.length;te<K;te++)this.addVertexLine(this.parseVertexIndex(L[te],N));for(let te=0,K=T.length;te<K;te++)this.addUVLine(this.parseUVIndex(T[te],F))}};return _.startObject("",!1),_}class S extends u.Loader{constructor(L){super(L),this.materials=null}load(L,T,N,F){const te=this,K=new u.FileLoader(this.manager);K.setPath(this.path),K.setRequestHeader(this.requestHeader),K.setWithCredentials(this.withCredentials),K.load(L,function(se){try{T(te.parse(se))}catch(ne){F?F(ne):console.error(ne),te.manager.itemError(L)}},N,F)}setMaterials(L){return this.materials=L,this}parse(L){const T=new C;L.indexOf(`\r
`)!==-1&&(L=L.replace(/\r\n/g,`
`)),L.indexOf(`\\
`)!==-1&&(L=L.replace(/\\\n/g,""));const N=L.split(`
`);let F=[];for(let se=0,ne=N.length;se<ne;se++){const re=N[se].trimStart();if(re.length===0)continue;const Y=re.charAt(0);if(Y!=="#")if(Y==="v"){const k=re.split(f);switch(k[0]){case"v":T.vertices.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])),k.length>=7?(p.setRGB(parseFloat(k[4]),parseFloat(k[5]),parseFloat(k[6])).convertSRGBToLinear(),T.colors.push(p.r,p.g,p.b)):T.colors.push(void 0,void 0,void 0);break;case"vn":T.normals.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));break;case"vt":T.uvs.push(parseFloat(k[1]),parseFloat(k[2]));break}}else if(Y==="f"){const oe=re.slice(1).trim().split(f),ae=[];for(let b=0,I=oe.length;b<I;b++){const O=oe[b];if(O.length>0){const Q=O.split("/");ae.push(Q)}}const Ae=ae[0];for(let b=1,I=ae.length-1;b<I;b++){const O=ae[b],Q=ae[b+1];T.addFace(Ae[0],O[0],Q[0],Ae[1],O[1],Q[1],Ae[2],O[2],Q[2])}}else if(Y==="l"){const k=re.substring(1).trim().split(" ");let oe=[];const ae=[];if(re.indexOf("/")===-1)oe=k;else for(let Ae=0,b=k.length;Ae<b;Ae++){const I=k[Ae].split("/");I[0]!==""&&oe.push(I[0]),I[1]!==""&&ae.push(I[1])}T.addLineGeometry(oe,ae)}else if(Y==="p"){const oe=re.slice(1).trim().split(" ");T.addPointGeometry(oe)}else if((F=w.exec(re))!==null){const k=(" "+F[0].slice(1).trim()).slice(1);T.startObject(k)}else if(v.test(re))T.object.startMaterial(re.substring(7).trim(),T.materialLibraries);else if(h.test(re))T.materialLibraries.push(re.substring(7).trim());else if(a.test(re))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(Y==="s"){if(F=re.split(" "),F.length>1){const oe=F[1].trim().toLowerCase();T.object.smooth=oe!=="0"&&oe!=="off"}else T.object.smooth=!0;const k=T.object.currentMaterial();k&&(k.smooth=T.object.smooth)}else{if(re==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+re+'"')}}T.finalize();const te=new u.Group;if(te.materialLibraries=[].concat(T.materialLibraries),!(T.objects.length===1&&T.objects[0].geometry.vertices.length===0)===!0)for(let se=0,ne=T.objects.length;se<ne;se++){const re=T.objects[se],Y=re.geometry,k=re.materials,oe=Y.type==="Line",ae=Y.type==="Points";let Ae=!1;if(Y.vertices.length===0)continue;const b=new u.BufferGeometry;b.setAttribute("position",new u.Float32BufferAttribute(Y.vertices,3)),Y.normals.length>0&&b.setAttribute("normal",new u.Float32BufferAttribute(Y.normals,3)),Y.colors.length>0&&(Ae=!0,b.setAttribute("color",new u.Float32BufferAttribute(Y.colors,3))),Y.hasUVIndices===!0&&b.setAttribute("uv",new u.Float32BufferAttribute(Y.uvs,2));const I=[];for(let Q=0,J=k.length;Q<J;Q++){const ve=k[Q],Le=ve.name+"_"+ve.smooth+"_"+Ae;let _e=T.materials[Le];if(this.materials!==null){if(_e=this.materials.create(ve.name),oe&&_e&&!(_e instanceof u.LineBasicMaterial)){const Ze=new u.LineBasicMaterial;u.Material.prototype.copy.call(Ze,_e),Ze.color.copy(_e.color),_e=Ze}else if(ae&&_e&&!(_e instanceof u.PointsMaterial)){const Ze=new u.PointsMaterial({size:10,sizeAttenuation:!1});u.Material.prototype.copy.call(Ze,_e),Ze.color.copy(_e.color),Ze.map=_e.map,_e=Ze}}_e===void 0&&(oe?_e=new u.LineBasicMaterial:ae?_e=new u.PointsMaterial({size:1,sizeAttenuation:!1}):_e=new u.MeshPhongMaterial,_e.name=ve.name,_e.flatShading=!ve.smooth,_e.vertexColors=Ae,T.materials[Le]=_e),I.push(_e)}let O;if(I.length>1){for(let Q=0,J=k.length;Q<J;Q++){const ve=k[Q];b.addGroup(ve.groupStart,ve.groupCount,Q)}oe?O=new u.LineSegments(b,I):ae?O=new u.Points(b,I):O=new u.Mesh(b,I)}else oe?O=new u.LineSegments(b,I[0]):ae?O=new u.Points(b,I[0]):O=new u.Mesh(b,I[0]);O.name=re.name,te.add(O)}else if(T.vertices.length>0){const se=new u.PointsMaterial({size:1,sizeAttenuation:!1}),ne=new u.BufferGeometry;ne.setAttribute("position",new u.Float32BufferAttribute(T.vertices,3)),T.colors.length>0&&T.colors[0]!==void 0&&(ne.setAttribute("color",new u.Float32BufferAttribute(T.colors,3)),se.vertexColors=!0);const re=new u.Points(ne,se);te.add(re)}return te}}},"./node_modules/three/examples/jsm/math/OBB.js":(W,$,A)=>{A.r($),A.d($,{OBB:()=>N});var u=A("./node_modules/three/build/three.module.js");const w={c:null,u:[new u.Vector3,new u.Vector3,new u.Vector3],e:[]},h={c:null,u:[new u.Vector3,new u.Vector3,new u.Vector3],e:[]},v=[[],[],[]],a=[[],[],[]],f=[],m=new u.Vector3,l=new u.Vector3,y=new u.Vector3,g=new u.Vector3,d=new u.Vector3,p=new u.Vector3,C=new u.Matrix3,S=new u.Box3,_=new u.Matrix4,L=new u.Matrix4,T=new u.Ray;class N{constructor(K=new u.Vector3,se=new u.Vector3,ne=new u.Matrix3){this.center=K,this.halfSize=se,this.rotation=ne}set(K,se,ne){return this.center=K,this.halfSize=se,this.rotation=ne,this}copy(K){return this.center.copy(K.center),this.halfSize.copy(K.halfSize),this.rotation.copy(K.rotation),this}clone(){return new this.constructor().copy(this)}getSize(K){return K.copy(this.halfSize).multiplyScalar(2)}clampPoint(K,se){const ne=this.halfSize;g.subVectors(K,this.center),this.rotation.extractBasis(m,l,y),se.copy(this.center);const re=u.MathUtils.clamp(g.dot(m),-ne.x,ne.x);se.add(m.multiplyScalar(re));const Y=u.MathUtils.clamp(g.dot(l),-ne.y,ne.y);se.add(l.multiplyScalar(Y));const k=u.MathUtils.clamp(g.dot(y),-ne.z,ne.z);return se.add(y.multiplyScalar(k)),se}containsPoint(K){return g.subVectors(K,this.center),this.rotation.extractBasis(m,l,y),Math.abs(g.dot(m))<=this.halfSize.x&&Math.abs(g.dot(l))<=this.halfSize.y&&Math.abs(g.dot(y))<=this.halfSize.z}intersectsBox3(K){return this.intersectsOBB(F.fromBox3(K))}intersectsSphere(K){return this.clampPoint(K.center,p),p.distanceToSquared(K.center)<=K.radius*K.radius}intersectsOBB(K,se=Number.EPSILON){w.c=this.center,w.e[0]=this.halfSize.x,w.e[1]=this.halfSize.y,w.e[2]=this.halfSize.z,this.rotation.extractBasis(w.u[0],w.u[1],w.u[2]),h.c=K.center,h.e[0]=K.halfSize.x,h.e[1]=K.halfSize.y,h.e[2]=K.halfSize.z,K.rotation.extractBasis(h.u[0],h.u[1],h.u[2]);for(let Y=0;Y<3;Y++)for(let k=0;k<3;k++)v[Y][k]=w.u[Y].dot(h.u[k]);g.subVectors(h.c,w.c),f[0]=g.dot(w.u[0]),f[1]=g.dot(w.u[1]),f[2]=g.dot(w.u[2]);for(let Y=0;Y<3;Y++)for(let k=0;k<3;k++)a[Y][k]=Math.abs(v[Y][k])+se;let ne,re;for(let Y=0;Y<3;Y++)if(ne=w.e[Y],re=h.e[0]*a[Y][0]+h.e[1]*a[Y][1]+h.e[2]*a[Y][2],Math.abs(f[Y])>ne+re)return!1;for(let Y=0;Y<3;Y++)if(ne=w.e[0]*a[0][Y]+w.e[1]*a[1][Y]+w.e[2]*a[2][Y],re=h.e[Y],Math.abs(f[0]*v[0][Y]+f[1]*v[1][Y]+f[2]*v[2][Y])>ne+re)return!1;return ne=w.e[1]*a[2][0]+w.e[2]*a[1][0],re=h.e[1]*a[0][2]+h.e[2]*a[0][1],!(Math.abs(f[2]*v[1][0]-f[1]*v[2][0])>ne+re||(ne=w.e[1]*a[2][1]+w.e[2]*a[1][1],re=h.e[0]*a[0][2]+h.e[2]*a[0][0],Math.abs(f[2]*v[1][1]-f[1]*v[2][1])>ne+re)||(ne=w.e[1]*a[2][2]+w.e[2]*a[1][2],re=h.e[0]*a[0][1]+h.e[1]*a[0][0],Math.abs(f[2]*v[1][2]-f[1]*v[2][2])>ne+re)||(ne=w.e[0]*a[2][0]+w.e[2]*a[0][0],re=h.e[1]*a[1][2]+h.e[2]*a[1][1],Math.abs(f[0]*v[2][0]-f[2]*v[0][0])>ne+re)||(ne=w.e[0]*a[2][1]+w.e[2]*a[0][1],re=h.e[0]*a[1][2]+h.e[2]*a[1][0],Math.abs(f[0]*v[2][1]-f[2]*v[0][1])>ne+re)||(ne=w.e[0]*a[2][2]+w.e[2]*a[0][2],re=h.e[0]*a[1][1]+h.e[1]*a[1][0],Math.abs(f[0]*v[2][2]-f[2]*v[0][2])>ne+re)||(ne=w.e[0]*a[1][0]+w.e[1]*a[0][0],re=h.e[1]*a[2][2]+h.e[2]*a[2][1],Math.abs(f[1]*v[0][0]-f[0]*v[1][0])>ne+re)||(ne=w.e[0]*a[1][1]+w.e[1]*a[0][1],re=h.e[0]*a[2][2]+h.e[2]*a[2][0],Math.abs(f[1]*v[0][1]-f[0]*v[1][1])>ne+re)||(ne=w.e[0]*a[1][2]+w.e[1]*a[0][2],re=h.e[0]*a[2][1]+h.e[1]*a[2][0],Math.abs(f[1]*v[0][2]-f[0]*v[1][2])>ne+re))}intersectsPlane(K){this.rotation.extractBasis(m,l,y);const se=this.halfSize.x*Math.abs(K.normal.dot(m))+this.halfSize.y*Math.abs(K.normal.dot(l))+this.halfSize.z*Math.abs(K.normal.dot(y)),ne=K.normal.dot(this.center)-K.constant;return Math.abs(ne)<=se}intersectRay(K,se){return this.getSize(d),S.setFromCenterAndSize(g.set(0,0,0),d),_.setFromMatrix3(this.rotation),_.setPosition(this.center),L.copy(_).invert(),T.copy(K).applyMatrix4(L),T.intersectBox(S,se)?se.applyMatrix4(_):null}intersectsRay(K){return this.intersectRay(K,g)!==null}fromBox3(K){return K.getCenter(this.center),K.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(K){return K.center.equals(this.center)&&K.halfSize.equals(this.halfSize)&&K.rotation.equals(this.rotation)}applyMatrix4(K){const se=K.elements;let ne=g.set(se[0],se[1],se[2]).length();const re=g.set(se[4],se[5],se[6]).length(),Y=g.set(se[8],se[9],se[10]).length();K.determinant()<0&&(ne=-ne),C.setFromMatrix4(K);const oe=1/ne,ae=1/re,Ae=1/Y;return C.elements[0]*=oe,C.elements[1]*=oe,C.elements[2]*=oe,C.elements[3]*=ae,C.elements[4]*=ae,C.elements[5]*=ae,C.elements[6]*=Ae,C.elements[7]*=Ae,C.elements[8]*=Ae,this.rotation.multiply(C),this.halfSize.x*=ne,this.halfSize.y*=re,this.halfSize.z*=Y,g.setFromMatrixPosition(K),this.center.add(g),this}}const F=new N},"./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js":(W,$,A)=>{A.r($),A.d($,{computeMikkTSpaceTangents:()=>w,computeMorphedAttributes:()=>p,deepCloneAttribute:()=>a,deinterleaveAttribute:()=>m,deinterleaveGeometry:()=>l,estimateBytesUsed:()=>y,interleaveAttributes:()=>f,mergeAttributes:()=>v,mergeGeometries:()=>h,mergeGroups:()=>C,mergeVertices:()=>g,toCreasedNormals:()=>S,toTrianglesDrawMode:()=>d});var u=A("./node_modules/three/build/three.module.js");function w(_,L,T=!0){if(!L||!L.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!_.hasAttribute("position")||!_.hasAttribute("normal")||!_.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function N(K){if(K.normalized||K.isInterleavedBufferAttribute){const se=new Float32Array(K.count*K.itemSize);for(let ne=0,re=0;ne<K.count;ne++)se[re++]=K.getX(ne),se[re++]=K.getY(ne),K.itemSize>2&&(se[re++]=K.getZ(ne));return se}return K.array instanceof Float32Array?K.array:new Float32Array(K.array)}const F=_.index?_.toNonIndexed():_,te=L.generateTangents(N(F.attributes.position),N(F.attributes.normal),N(F.attributes.uv));if(T)for(let K=3;K<te.length;K+=4)te[K]*=-1;return F.setAttribute("tangent",new u.BufferAttribute(te,4)),_!==F&&_.copy(F),_}function h(_,L=!1){const T=_[0].index!==null,N=new Set(Object.keys(_[0].attributes)),F=new Set(Object.keys(_[0].morphAttributes)),te={},K={},se=_[0].morphTargetsRelative,ne=new u.BufferGeometry;let re=0;for(let Y=0;Y<_.length;++Y){const k=_[Y];let oe=0;if(T!==(k.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Y+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const ae in k.attributes){if(!N.has(ae))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Y+'. All geometries must have compatible attributes; make sure "'+ae+'" attribute exists among all geometries, or in none of them.'),null;te[ae]===void 0&&(te[ae]=[]),te[ae].push(k.attributes[ae]),oe++}if(oe!==N.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Y+". Make sure all geometries have the same number of attributes."),null;if(se!==k.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Y+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const ae in k.morphAttributes){if(!F.has(ae))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Y+".  .morphAttributes must be consistent throughout all geometries."),null;K[ae]===void 0&&(K[ae]=[]),K[ae].push(k.morphAttributes[ae])}if(L){let ae;if(T)ae=k.index.count;else if(k.attributes.position!==void 0)ae=k.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Y+". The geometry must have either an index or a position attribute"),null;ne.addGroup(re,ae,Y),re+=ae}}if(T){let Y=0;const k=[];for(let oe=0;oe<_.length;++oe){const ae=_[oe].index;for(let Ae=0;Ae<ae.count;++Ae)k.push(ae.getX(Ae)+Y);Y+=_[oe].attributes.position.count}ne.setIndex(k)}for(const Y in te){const k=v(te[Y]);if(!k)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Y+" attribute."),null;ne.setAttribute(Y,k)}for(const Y in K){const k=K[Y][0].length;if(k===0)break;ne.morphAttributes=ne.morphAttributes||{},ne.morphAttributes[Y]=[];for(let oe=0;oe<k;++oe){const ae=[];for(let b=0;b<K[Y].length;++b)ae.push(K[Y][b][oe]);const Ae=v(ae);if(!Ae)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Y+" morphAttribute."),null;ne.morphAttributes[Y].push(Ae)}}return ne}function v(_){let L,T,N,F=-1,te=0;for(let re=0;re<_.length;++re){const Y=_[re];if(L===void 0&&(L=Y.array.constructor),L!==Y.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(T===void 0&&(T=Y.itemSize),T!==Y.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(N===void 0&&(N=Y.normalized),N!==Y.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(F===-1&&(F=Y.gpuType),F!==Y.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;te+=Y.count*T}const K=new L(te),se=new u.BufferAttribute(K,T,N);let ne=0;for(let re=0;re<_.length;++re){const Y=_[re];if(Y.isInterleavedBufferAttribute){const k=ne/T;for(let oe=0,ae=Y.count;oe<ae;oe++)for(let Ae=0;Ae<T;Ae++){const b=Y.getComponent(oe,Ae);se.setComponent(oe+k,Ae,b)}}else K.set(Y.array,ne);ne+=Y.count*T}return F!==void 0&&(se.gpuType=F),se}function a(_){return _.isInstancedInterleavedBufferAttribute||_.isInterleavedBufferAttribute?m(_):_.isInstancedBufferAttribute?new u.InstancedBufferAttribute().copy(_):new u.BufferAttribute().copy(_)}function f(_){let L,T=0,N=0;for(let re=0,Y=_.length;re<Y;++re){const k=_[re];if(L===void 0&&(L=k.array.constructor),L!==k.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;T+=k.array.length,N+=k.itemSize}const F=new u.InterleavedBuffer(new L(T),N);let te=0;const K=[],se=["getX","getY","getZ","getW"],ne=["setX","setY","setZ","setW"];for(let re=0,Y=_.length;re<Y;re++){const k=_[re],oe=k.itemSize,ae=k.count,Ae=new u.InterleavedBufferAttribute(F,oe,te,k.normalized);K.push(Ae),te+=oe;for(let b=0;b<ae;b++)for(let I=0;I<oe;I++)Ae[ne[I]](b,k[se[I]](b))}return K}function m(_){const L=_.data.array.constructor,T=_.count,N=_.itemSize,F=_.normalized,te=new L(T*N);let K;_.isInstancedInterleavedBufferAttribute?K=new u.InstancedBufferAttribute(te,N,F,_.meshPerAttribute):K=new u.BufferAttribute(te,N,F);for(let se=0;se<T;se++)K.setX(se,_.getX(se)),N>=2&&K.setY(se,_.getY(se)),N>=3&&K.setZ(se,_.getZ(se)),N>=4&&K.setW(se,_.getW(se));return K}function l(_){const L=_.attributes,T=_.morphTargets,N=new Map;for(const F in L){const te=L[F];te.isInterleavedBufferAttribute&&(N.has(te)||N.set(te,m(te)),L[F]=N.get(te))}for(const F in T){const te=T[F];te.isInterleavedBufferAttribute&&(N.has(te)||N.set(te,m(te)),T[F]=N.get(te))}}function y(_){let L=0;for(const N in _.attributes){const F=_.getAttribute(N);L+=F.count*F.itemSize*F.array.BYTES_PER_ELEMENT}const T=_.getIndex();return L+=T?T.count*T.itemSize*T.array.BYTES_PER_ELEMENT:0,L}function g(_,L=1e-4){L=Math.max(L,Number.EPSILON);const T={},N=_.getIndex(),F=_.getAttribute("position"),te=N?N.count:F.count;let K=0;const se=Object.keys(_.attributes),ne={},re={},Y=[],k=["getX","getY","getZ","getW"],oe=["setX","setY","setZ","setW"];for(let Q=0,J=se.length;Q<J;Q++){const ve=se[Q],Le=_.attributes[ve];ne[ve]=new u.BufferAttribute(new Le.array.constructor(Le.count*Le.itemSize),Le.itemSize,Le.normalized);const _e=_.morphAttributes[ve];_e&&(re[ve]=new u.BufferAttribute(new _e.array.constructor(_e.count*_e.itemSize),_e.itemSize,_e.normalized))}const ae=L*.5,Ae=Math.log10(1/L),b=Math.pow(10,Ae),I=ae*b;for(let Q=0;Q<te;Q++){const J=N?N.getX(Q):Q;let ve="";for(let Le=0,_e=se.length;Le<_e;Le++){const Ze=se[Le],qe=_.getAttribute(Ze),ft=qe.itemSize;for(let Et=0;Et<ft;Et++)ve+=`${~~(qe[k[Et]](J)*b+I)},`}if(ve in T)Y.push(T[ve]);else{for(let Le=0,_e=se.length;Le<_e;Le++){const Ze=se[Le],qe=_.getAttribute(Ze),ft=_.morphAttributes[Ze],Et=qe.itemSize,Bt=ne[Ze],kt=re[Ze];for(let jt=0;jt<Et;jt++){const nn=k[jt],Jn=oe[jt];if(Bt[Jn](K,qe[nn](J)),ft)for(let kn=0,xn=ft.length;kn<xn;kn++)kt[kn][Jn](K,ft[kn][nn](J))}}T[ve]=K,Y.push(K),K++}}const O=_.clone();for(const Q in _.attributes){const J=ne[Q];if(O.setAttribute(Q,new u.BufferAttribute(J.array.slice(0,K*J.itemSize),J.itemSize,J.normalized)),Q in re)for(let ve=0;ve<re[Q].length;ve++){const Le=re[Q][ve];O.morphAttributes[Q][ve]=new u.BufferAttribute(Le.array.slice(0,K*Le.itemSize),Le.itemSize,Le.normalized)}}return O.setIndex(Y),O}function d(_,L){if(L===u.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),_;if(L===u.TriangleFanDrawMode||L===u.TriangleStripDrawMode){let T=_.getIndex();if(T===null){const K=[],se=_.getAttribute("position");if(se!==void 0){for(let ne=0;ne<se.count;ne++)K.push(ne);_.setIndex(K),T=_.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),_}const N=T.count-2,F=[];if(L===u.TriangleFanDrawMode)for(let K=1;K<=N;K++)F.push(T.getX(0)),F.push(T.getX(K)),F.push(T.getX(K+1));else for(let K=0;K<N;K++)K%2===0?(F.push(T.getX(K)),F.push(T.getX(K+1)),F.push(T.getX(K+2))):(F.push(T.getX(K+2)),F.push(T.getX(K+1)),F.push(T.getX(K)));F.length/3!==N&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const te=_.clone();return te.setIndex(F),te.clearGroups(),te}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",L),_}function p(_){const L=new u.Vector3,T=new u.Vector3,N=new u.Vector3,F=new u.Vector3,te=new u.Vector3,K=new u.Vector3,se=new u.Vector3,ne=new u.Vector3,re=new u.Vector3;function Y(Wn,Si,Zn,Ui,Qi,Kn,Mt,Ce){L.fromBufferAttribute(Si,Qi),T.fromBufferAttribute(Si,Kn),N.fromBufferAttribute(Si,Mt);const ye=Wn.morphTargetInfluences;if(Zn&&ye){se.set(0,0,0),ne.set(0,0,0),re.set(0,0,0);for(let Fe=0,Se=Zn.length;Fe<Se;Fe++){const Re=ye[Fe],Ue=Zn[Fe];Re!==0&&(F.fromBufferAttribute(Ue,Qi),te.fromBufferAttribute(Ue,Kn),K.fromBufferAttribute(Ue,Mt),Ui?(se.addScaledVector(F,Re),ne.addScaledVector(te,Re),re.addScaledVector(K,Re)):(se.addScaledVector(F.sub(L),Re),ne.addScaledVector(te.sub(T),Re),re.addScaledVector(K.sub(N),Re)))}L.add(se),T.add(ne),N.add(re)}Wn.isSkinnedMesh&&(Wn.applyBoneTransform(Qi,L),Wn.applyBoneTransform(Kn,T),Wn.applyBoneTransform(Mt,N)),Ce[Qi*3+0]=L.x,Ce[Qi*3+1]=L.y,Ce[Qi*3+2]=L.z,Ce[Kn*3+0]=T.x,Ce[Kn*3+1]=T.y,Ce[Kn*3+2]=T.z,Ce[Mt*3+0]=N.x,Ce[Mt*3+1]=N.y,Ce[Mt*3+2]=N.z}const k=_.geometry,oe=_.material;let ae,Ae,b;const I=k.index,O=k.attributes.position,Q=k.morphAttributes.position,J=k.morphTargetsRelative,ve=k.attributes.normal,Le=k.morphAttributes.position,_e=k.groups,Ze=k.drawRange;let qe,ft,Et,Bt,kt,jt,nn;const Jn=new Float32Array(O.count*O.itemSize),kn=new Float32Array(ve.count*ve.itemSize);if(I!==null)if(Array.isArray(oe))for(qe=0,Et=_e.length;qe<Et;qe++)for(kt=_e[qe],jt=Math.max(kt.start,Ze.start),nn=Math.min(kt.start+kt.count,Ze.start+Ze.count),ft=jt,Bt=nn;ft<Bt;ft+=3)ae=I.getX(ft),Ae=I.getX(ft+1),b=I.getX(ft+2),Y(_,O,Q,J,ae,Ae,b,Jn),Y(_,ve,Le,J,ae,Ae,b,kn);else for(jt=Math.max(0,Ze.start),nn=Math.min(I.count,Ze.start+Ze.count),qe=jt,Et=nn;qe<Et;qe+=3)ae=I.getX(qe),Ae=I.getX(qe+1),b=I.getX(qe+2),Y(_,O,Q,J,ae,Ae,b,Jn),Y(_,ve,Le,J,ae,Ae,b,kn);else if(Array.isArray(oe))for(qe=0,Et=_e.length;qe<Et;qe++)for(kt=_e[qe],jt=Math.max(kt.start,Ze.start),nn=Math.min(kt.start+kt.count,Ze.start+Ze.count),ft=jt,Bt=nn;ft<Bt;ft+=3)ae=ft,Ae=ft+1,b=ft+2,Y(_,O,Q,J,ae,Ae,b,Jn),Y(_,ve,Le,J,ae,Ae,b,kn);else for(jt=Math.max(0,Ze.start),nn=Math.min(O.count,Ze.start+Ze.count),qe=jt,Et=nn;qe<Et;qe+=3)ae=qe,Ae=qe+1,b=qe+2,Y(_,O,Q,J,ae,Ae,b,Jn),Y(_,ve,Le,J,ae,Ae,b,kn);const xn=new u.Float32BufferAttribute(Jn,3),Fn=new u.Float32BufferAttribute(kn,3);return{positionAttribute:O,normalAttribute:ve,morphedPositionAttribute:xn,morphedNormalAttribute:Fn}}function C(_){if(_.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),_;let L=_.groups;if(L=L.sort((K,se)=>K.materialIndex!==se.materialIndex?K.materialIndex-se.materialIndex:K.start-se.start),_.getIndex()===null){const K=_.getAttribute("position"),se=[];for(let ne=0;ne<K.count;ne+=3)se.push(ne,ne+1,ne+2);_.setIndex(se)}const T=_.getIndex(),N=[];for(let K=0;K<L.length;K++){const se=L[K],ne=se.start,re=ne+se.count;for(let Y=ne;Y<re;Y++)N.push(T.getX(Y))}_.dispose(),_.setIndex(N);let F=0;for(let K=0;K<L.length;K++){const se=L[K];se.start=F,F+=se.count}let te=L[0];_.groups=[te];for(let K=1;K<L.length;K++){const se=L[K];te.materialIndex===se.materialIndex?te.count+=se.count:(te=se,_.groups.push(te))}return _}function S(_,L=Math.PI/3){const T=Math.cos(L),N=(1+1e-10)*100,F=[new u.Vector3,new u.Vector3,new u.Vector3],te=new u.Vector3,K=new u.Vector3,se=new u.Vector3,ne=new u.Vector3;function re(b){const I=~~(b.x*N),O=~~(b.y*N),Q=~~(b.z*N);return`${I},${O},${Q}`}const Y=_.index?_.toNonIndexed():_,k=Y.attributes.position,oe={};for(let b=0,I=k.count/3;b<I;b++){const O=3*b,Q=F[0].fromBufferAttribute(k,O+0),J=F[1].fromBufferAttribute(k,O+1),ve=F[2].fromBufferAttribute(k,O+2);te.subVectors(ve,J),K.subVectors(Q,J);const Le=new u.Vector3().crossVectors(te,K).normalize();for(let _e=0;_e<3;_e++){const Ze=F[_e],qe=re(Ze);qe in oe||(oe[qe]=[]),oe[qe].push(Le)}}const ae=new Float32Array(k.count*3),Ae=new u.BufferAttribute(ae,3,!1);for(let b=0,I=k.count/3;b<I;b++){const O=3*b,Q=F[0].fromBufferAttribute(k,O+0),J=F[1].fromBufferAttribute(k,O+1),ve=F[2].fromBufferAttribute(k,O+2);te.subVectors(ve,J),K.subVectors(Q,J),se.crossVectors(te,K).normalize();for(let Le=0;Le<3;Le++){const _e=F[Le],Ze=re(_e),qe=oe[Ze];ne.set(0,0,0);for(let ft=0,Et=qe.length;ft<Et;ft++){const Bt=qe[ft];se.dot(Bt)>T&&ne.add(Bt)}ne.normalize(),Ae.setXYZ(O+Le,ne.x,ne.y,ne.z)}}return Y.setAttribute("normal",Ae),Y}},"./node_modules/three/examples/jsm/utils/WorkerPool.js":(W,$,A)=>{A.r($),A.d($,{WorkerPool:()=>u});class u{constructor(h=4){this.pool=h,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(h){if(!this.workers[h]){const v=this.workerCreator();v.addEventListener("message",this._onMessage.bind(this,h)),this.workers[h]=v}}_getIdleWorker(){for(let h=0;h<this.pool;h++)if(!(this.workerStatus&1<<h))return h;return-1}_onMessage(h,v){const a=this.workersResolve[h];if(a&&a(v),this.queue.length){const{resolve:f,msg:m,transfer:l}=this.queue.shift();this.workersResolve[h]=f,this.workers[h].postMessage(m,l)}else this.workerStatus^=1<<h}setWorkerCreator(h){this.workerCreator=h}setWorkerLimit(h){this.pool=h}postMessage(h,v){return new Promise(a=>{const f=this._getIdleWorker();f!==-1?(this._initWorker(f),this.workerStatus|=1<<f,this.workersResolve[f]=a,this.workers[f].postMessage(h,v)):this.queue.push({resolve:a,msg:h,transfer:v})})}dispose(){this.workers.forEach(h=>h.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./src/lib/three.mjs":(W,$,A)=>{A.r($),A.d($,{default:()=>d});var u=A("./node_modules/three/build/three.module.js"),w=A("./node_modules/three/examples/jsm/loaders/DRACOLoader.js"),h=A("./node_modules/three/examples/jsm/loaders/GLTFLoader.js"),v=A("./node_modules/three/examples/jsm/loaders/KTX2Loader.js"),a=A("./node_modules/three/examples/jsm/math/OBB.js"),f=A("./node_modules/three/examples/jsm/loaders/OBJLoader.js"),m=A("./node_modules/three/examples/jsm/loaders/MTLLoader.js"),l=A("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js"),y=A("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js"),g={...u};g.DRACOLoader=w.DRACOLoader,g.GLTFLoader=h.GLTFLoader,g.KTX2Loader=v.KTX2Loader,g.OBJLoader=f.OBJLoader,g.MTLLoader=m.MTLLoader,g.OBB=a.OBB,g.BufferGeometryUtils=l,g.LightProbeGenerator=y.LightProbeGenerator;const d=g},"./package.json":W=>{W.exports=JSON.parse('{"name":"aframe","version":"1.6.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.5.0 1.6.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"node --experimental-require-module ./node_modules/mocha/bin/mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"buffer":"^6.0.3","debug":"^4.3.4","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","super-animejs":"^3.1.0","three":"npm:super-three@0.164.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^24.0.0","jsdom-global":"^3.0.2","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},yr={};function mi(W){var $=yr[W];if($!==void 0)return $.exports;var A=yr[W]={id:W,exports:{}};return Ys[W].call(A.exports,A,A.exports,mi),A.exports}mi.m=Ys,mi.n=W=>{var $=W&&W.__esModule?()=>W.default:()=>W;return mi.d($,{a:$}),$},mi.d=(W,$)=>{for(var A in $)mi.o($,A)&&!mi.o(W,A)&&Object.defineProperty(W,A,{enumerable:!0,get:$[A]})},mi.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),mi.o=(W,$)=>Object.prototype.hasOwnProperty.call(W,$),mi.r=W=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(W,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(W,"__esModule",{value:!0})},mi.b=document.baseURI||self.location.href,mi.nc=void 0;var Bo=mi("./src/index.js");return Bo})())})(qy);var Jy={exports:{}};(function(vl,Fa){(function(Ys,yr){vl.exports=yr(Yy)})(self,na=>(()=>{var Ys={"./lib/ColladaLoader.js":W=>{W.exports=THREE.ColladaLoader=function($){this.manager=$!==void 0?$:THREE.DefaultLoadingManager},THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function($,A,u,w){var h=this,v=h.path===void 0?THREE.LoaderUtils.extractUrlBase($):h.path,a=new THREE.FileLoader(h.manager);a.setPath(h.path),a.load($,function(f){A(h.parse(f,v))},u,w)},setPath:function($){return this.path=$,this},setResourcePath:function($){return this.resourcePath=$,this},options:{set convertUpAxis($){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function($){return this.crossOrigin=$,this},parse:function($,A){function u(le,he){for(var Ee=[],R=le.childNodes,M=0,Z=R.length;M<Z;M++){var fe=R[M];fe.nodeName===he&&Ee.push(fe)}return Ee}function w(le){if(le.length===0)return[];for(var he=le.trim().split(/\s+/),Ee=new Array(he.length),R=0,M=he.length;R<M;R++)Ee[R]=he[R];return Ee}function h(le){if(le.length===0)return[];for(var he=le.trim().split(/\s+/),Ee=new Array(he.length),R=0,M=he.length;R<M;R++)Ee[R]=parseFloat(he[R]);return Ee}function v(le){if(le.length===0)return[];for(var he=le.trim().split(/\s+/),Ee=new Array(he.length),R=0,M=he.length;R<M;R++)Ee[R]=parseInt(he[R]);return Ee}function a(le){return le.substring(1)}function f(){return"three_default_"+Nt++}function m(le){return Object.keys(le).length===0}function l(le){return{unit:y(u(le,"unit")[0]),upAxis:g(u(le,"up_axis")[0])}}function y(le){return le!==void 0&&le.hasAttribute("meter")===!0?parseFloat(le.getAttribute("meter")):1}function g(le){return le!==void 0?le.textContent:"Y_UP"}function d(le,he,Ee,R){var M=u(le,he)[0];if(M!==void 0)for(var Z=u(M,Ee),fe=0;fe<Z.length;fe++)R(Z[fe])}function p(le,he){for(var Ee in le){var R=le[Ee];R.build=he(le[Ee])}}function C(le,he){return le.build!==void 0||(le.build=he(le)),le.build}function S(le){for(var he={sources:{},samplers:{},channels:{}},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1){var Z;switch(M.nodeName){case"source":Z=M.getAttribute("id"),he.sources[Z]=fn(M);break;case"sampler":Z=M.getAttribute("id"),he.samplers[Z]=_(M);break;case"channel":Z=M.getAttribute("target"),he.channels[Z]=L(M);break;default:console.log(M)}}}_t.animations[le.getAttribute("id")]=he}function _(le){for(var he={inputs:{}},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"input":var Z=a(M.getAttribute("source")),fe=M.getAttribute("semantic");he.inputs[fe]=Z;break}}return he}function L(le){var he={},Ee=le.getAttribute("target"),R=Ee.split("/"),M=R.shift(),Z=R.shift(),fe=Z.indexOf("(")!==-1,Oe=Z.indexOf(".")!==-1;if(Oe)R=Z.split("."),Z=R.shift(),he.member=R.shift();else if(fe){var Qe=Z.split("(");Z=Qe.shift();for(var Je=0;Je<Qe.length;Je++)Qe[Je]=parseInt(Qe[Je].replace(/\)/,""));he.indices=Qe}return he.id=M,he.sid=Z,he.arraySyntax=fe,he.memberSyntax=Oe,he.sampler=a(le.getAttribute("source")),he}function T(le){var he=[],Ee=le.channels,R=le.samplers,M=le.sources;for(var Z in Ee)if(Ee.hasOwnProperty(Z)){var fe=Ee[Z],Oe=R[fe.sampler],Qe=Oe.inputs.INPUT,Je=Oe.inputs.OUTPUT,Xe=M[Qe],ht=M[Je],ct=F(fe,Xe,ht);re(ct,he)}return he}function N(le){return C(_t.animations[le],T)}function F(le,he,Ee){var R=_t.nodes[le.id],M=on(R.id),Z=R.transforms[le.sid],fe=R.matrix.clone().transpose(),Oe,Qe,Je,Xe,ht,ct,at={};switch(Z){case"matrix":for(Je=0,Xe=he.array.length;Je<Xe;Je++)if(Oe=he.array[Je],Qe=Je*Ee.stride,at[Oe]===void 0&&(at[Oe]={}),le.arraySyntax===!0){var ut=Ee.array[Qe],Ct=le.indices[0]+4*le.indices[1];at[Oe][Ct]=ut}else for(ht=0,ct=Ee.stride;ht<ct;ht++)at[Oe][ht]=Ee.array[Qe+ht];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Z);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Z);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Z);break}var qt=te(at,fe),Jt={name:M.uuid,keyframes:qt};return Jt}function te(le,he){var Ee=[];for(var R in le)Ee.push({time:parseFloat(R),value:le[R]});Ee.sort(Z);for(var M=0;M<16;M++)Y(Ee,M,he.elements[M]);return Ee;function Z(fe,Oe){return fe.time-Oe.time}}var K=new THREE.Vector3,se=new THREE.Vector3,ne=new THREE.Quaternion;function re(le,he){for(var Ee=le.keyframes,R=le.name,M=[],Z=[],fe=[],Oe=[],Qe=0,Je=Ee.length;Qe<Je;Qe++){var Xe=Ee[Qe],ht=Xe.time,ct=Xe.value;tn.fromArray(ct).transpose(),tn.decompose(K,ne,se),M.push(ht),Z.push(K.x,K.y,K.z),fe.push(ne.x,ne.y,ne.z,ne.w),Oe.push(se.x,se.y,se.z)}return Z.length>0&&he.push(new THREE.VectorKeyframeTrack(R+".position",M,Z)),fe.length>0&&he.push(new THREE.QuaternionKeyframeTrack(R+".quaternion",M,fe)),Oe.length>0&&he.push(new THREE.VectorKeyframeTrack(R+".scale",M,Oe)),he}function Y(le,he,Ee){var R,M=!0,Z,fe;for(Z=0,fe=le.length;Z<fe;Z++)R=le[Z],R.value[he]===void 0?R.value[he]=null:M=!1;if(M===!0)for(Z=0,fe=le.length;Z<fe;Z++)R=le[Z],R.value[he]=Ee;else k(le,he)}function k(le,he){for(var Ee,R,M=0,Z=le.length;M<Z;M++){var fe=le[M];if(fe.value[he]===null){if(Ee=oe(le,M,he),R=ae(le,M,he),Ee===null){fe.value[he]=R.value[he];continue}if(R===null){fe.value[he]=Ee.value[he];continue}Ae(fe,Ee,R,he)}}}function oe(le,he,Ee){for(;he>=0;){var R=le[he];if(R.value[Ee]!==null)return R;he--}return null}function ae(le,he,Ee){for(;he<le.length;){var R=le[he];if(R.value[Ee]!==null)return R;he++}return null}function Ae(le,he,Ee,R){if(Ee.time-he.time===0){le.value[R]=he.value[R];return}le.value[R]=(le.time-he.time)*(Ee.value[R]-he.value[R])/(Ee.time-he.time)+he.value[R]}function b(le){for(var he={name:le.getAttribute("id")||"default",start:parseFloat(le.getAttribute("start")||0),end:parseFloat(le.getAttribute("end")||0),animations:[]},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"instance_animation":he.animations.push(a(M.getAttribute("url")));break}}_t.clips[le.getAttribute("id")]=he}function I(le){for(var he=[],Ee=le.name,R=le.end-le.start||-1,M=le.animations,Z=0,fe=M.length;Z<fe;Z++)for(var Oe=N(M[Z]),Qe=0,Je=Oe.length;Qe<Je;Qe++)he.push(Oe[Qe]);return new THREE.AnimationClip(Ee,R,he)}function O(le){return C(_t.clips[le],I)}function Q(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"skin":he.id=a(M.getAttribute("source")),he.skin=J(M);break;case"morph":he.id=a(M.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}_t.controllers[le.getAttribute("id")]=he}function J(le){for(var he={sources:{}},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"bind_shape_matrix":he.bindShapeMatrix=h(M.textContent);break;case"source":var Z=M.getAttribute("id");he.sources[Z]=fn(M);break;case"joints":he.joints=ve(M);break;case"vertex_weights":he.vertexWeights=Le(M);break}}return he}function ve(le){for(var he={inputs:{}},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"input":var Z=M.getAttribute("semantic"),fe=a(M.getAttribute("source"));he.inputs[Z]=fe;break}}return he}function Le(le){for(var he={inputs:{}},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"input":var Z=M.getAttribute("semantic"),fe=a(M.getAttribute("source")),Oe=parseInt(M.getAttribute("offset"));he.inputs[Z]={id:fe,offset:Oe};break;case"vcount":he.vcount=v(M.textContent);break;case"v":he.v=v(M.textContent);break}}return he}function _e(le){var he={id:le.id},Ee=_t.geometries[he.id];return le.skin!==void 0&&(he.skin=Ze(le.skin),Ee.sources.skinIndices=he.skin.indices,Ee.sources.skinWeights=he.skin.weights),he}function Ze(le){var he=4,Ee={joints:[],indices:{array:[],stride:he},weights:{array:[],stride:he}},R=le.sources,M=le.vertexWeights,Z=M.vcount,fe=M.v,Oe=M.inputs.JOINT.offset,Qe=M.inputs.WEIGHT.offset,Je=le.sources[le.joints.inputs.JOINT],Xe=le.sources[le.joints.inputs.INV_BIND_MATRIX],ht=R[M.inputs.WEIGHT.id].array,ct=0,at,ut,Ct;for(at=0,Ct=Z.length;at<Ct;at++){var qt=Z[at],Jt=[];for(ut=0;ut<qt;ut++){var an=fe[ct+Oe],Zt=fe[ct+Qe],dn=ht[Zt];Jt.push({index:an,weight:dn}),ct+=2}for(Jt.sort(ei),ut=0;ut<he;ut++){var un=Jt[ut];un!==void 0?(Ee.indices.array.push(un.index),Ee.weights.array.push(un.weight)):(Ee.indices.array.push(0),Ee.weights.array.push(0))}}for(le.bindShapeMatrix?Ee.bindMatrix=new THREE.Matrix4().fromArray(le.bindShapeMatrix).transpose():Ee.bindMatrix=new THREE.Matrix4().identity(),at=0,Ct=Je.array.length;at<Ct;at++){var pn=Je.array[at],Vt=new THREE.Matrix4().fromArray(Xe.array,at*Xe.stride).transpose();Ee.joints.push({name:pn,boneInverse:Vt})}return Ee;function ei(Mn,ai){return ai.weight-Mn.weight}}function qe(le){return C(_t.controllers[le],_e)}function ft(le){var he={init_from:u(le,"init_from")[0].textContent};_t.images[le.getAttribute("id")]=he}function Et(le){return le.build!==void 0?le.build:le.init_from}function Bt(le){var he=_t.images[le];return he!==void 0?C(he,Et):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",le),null)}function kt(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"profile_COMMON":he.profile=jt(M);break}}_t.effects[le.getAttribute("id")]=he}function jt(le){for(var he={surfaces:{},samplers:{}},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"newparam":nn(M,he);break;case"technique":he.technique=xn(M);break;case"extra":he.extra=Qi(M);break}}return he}function nn(le,he){for(var Ee=le.getAttribute("sid"),R=0,M=le.childNodes.length;R<M;R++){var Z=le.childNodes[R];if(Z.nodeType===1)switch(Z.nodeName){case"surface":he.surfaces[Ee]=Jn(Z);break;case"sampler2D":he.samplers[Ee]=kn(Z);break}}}function Jn(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"init_from":he.init_from=M.textContent;break}}return he}function kn(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"source":he.source=M.textContent;break}}return he}function xn(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"constant":case"lambert":case"blinn":case"phong":he.type=M.nodeName,he.parameters=Fn(M);break}}return he}function Fn(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":he[M.nodeName]=Wn(M);break;case"transparent":he[M.nodeName]={opaque:M.getAttribute("opaque"),data:Wn(M)};break}}return he}function Wn(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"color":he[M.nodeName]=h(M.textContent);break;case"float":he[M.nodeName]=parseFloat(M.textContent);break;case"texture":he[M.nodeName]={id:M.getAttribute("texture"),extra:Si(M)};break}}return he}function Si(le){for(var he={technique:{}},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"extra":Zn(M,he);break}}return he}function Zn(le,he){for(var Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"technique":Ui(M,he);break}}}function Ui(le,he){for(var Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":he.technique[M.nodeName]=parseFloat(M.textContent);break;case"wrapU":case"wrapV":M.textContent.toUpperCase()==="TRUE"?he.technique[M.nodeName]=1:M.textContent.toUpperCase()==="FALSE"?he.technique[M.nodeName]=0:he.technique[M.nodeName]=parseInt(M.textContent);break}}}function Qi(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"technique":he.technique=Kn(M);break}}return he}function Kn(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"double_sided":he[M.nodeName]=parseInt(M.textContent);break}}return he}function Mt(le){return le}function Ce(le){return C(_t.effects[le],Mt)}function ye(le){for(var he={name:le.getAttribute("name")},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"instance_effect":he.url=a(M.getAttribute("url"));break}}_t.materials[le.getAttribute("id")]=he}function Fe(le){var he,Ee=le.slice((le.lastIndexOf(".")-1>>>0)+2);switch(Ee=Ee.toLowerCase(),Ee){case"tga":he=St;break;default:he=It}return he}function Se(le){var he=Ce(le.url),Ee=he.profile.technique,R=he.profile.extra,M;switch(Ee.type){case"phong":case"blinn":M=new THREE.MeshPhongMaterial;break;case"lambert":M=new THREE.MeshLambertMaterial;break;default:M=new THREE.MeshBasicMaterial;break}M.name=le.name;function Z(ct){var at=he.profile.samplers[ct.id],ut=null;if(at!==void 0){var Ct=he.profile.surfaces[at.source];ut=Bt(Ct.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),ut=Bt(ct.id);if(ut!==null){var qt=Fe(ut);if(qt!==void 0){var Jt=qt.load(ut),an=ct.extra;if(an!==void 0&&an.technique!==void 0&&m(an.technique)===!1){var Zt=an.technique;Jt.wrapS=Zt.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Jt.wrapT=Zt.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Jt.offset.set(Zt.offsetU||0,Zt.offsetV||0),Jt.repeat.set(Zt.repeatU||1,Zt.repeatV||1)}else Jt.wrapS=THREE.RepeatWrapping,Jt.wrapT=THREE.RepeatWrapping;return Jt}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",ut),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",ct.id),null}var fe=Ee.parameters;for(var Oe in fe){var Qe=fe[Oe];switch(Oe){case"diffuse":Qe.color&&M.color.fromArray(Qe.color),Qe.texture&&(M.map=Z(Qe.texture));break;case"specular":Qe.color&&M.specular&&M.specular.fromArray(Qe.color),Qe.texture&&(M.specularMap=Z(Qe.texture));break;case"bump":Qe.texture&&(M.normalMap=Z(Qe.texture));break;case"ambient":Qe.texture&&(M.lightMap=Z(Qe.texture));break;case"shininess":Qe.float&&M.shininess&&(M.shininess=Qe.float);break;case"emission":Qe.color&&M.emissive&&M.emissive.fromArray(Qe.color),Qe.texture&&(M.emissiveMap=Z(Qe.texture));break}}var Je=fe.transparent,Xe=fe.transparency;if(Xe===void 0&&Je&&(Xe={float:1}),Je===void 0&&Xe&&(Je={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Je&&Xe)if(Je.data.texture)M.transparent=!0;else{var ht=Je.data.color;switch(Je.opaque){case"A_ONE":M.opacity=ht[3]*Xe.float;break;case"RGB_ZERO":M.opacity=1-ht[0]*Xe.float;break;case"A_ZERO":M.opacity=1-ht[3]*Xe.float;break;case"RGB_ONE":M.opacity=ht[0]*Xe.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Je.opaque)}M.opacity<1&&(M.transparent=!0)}return R!==void 0&&R.technique!==void 0&&R.technique.double_sided===1&&(M.side=THREE.DoubleSide),M}function Re(le){return C(_t.materials[le],Se)}function Ue(le){for(var he={name:le.getAttribute("name")},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"optics":he.optics=ee(M);break}}_t.cameras[le.getAttribute("id")]=he}function ee(le){for(var he=0;he<le.childNodes.length;he++){var Ee=le.childNodes[he];switch(Ee.nodeName){case"technique_common":return D(Ee)}}return{}}function D(le){for(var he={},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];switch(R.nodeName){case"perspective":case"orthographic":he.technique=R.nodeName,he.parameters=G(R);break}}return he}function G(le){for(var he={},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];switch(R.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":he[R.nodeName]=parseFloat(R.textContent);break}}return he}function ue(le){var he;switch(le.optics.technique){case"perspective":he=new THREE.PerspectiveCamera(le.optics.parameters.yfov,le.optics.parameters.aspect_ratio,le.optics.parameters.znear,le.optics.parameters.zfar);break;case"orthographic":var Ee=le.optics.parameters.ymag,R=le.optics.parameters.xmag,M=le.optics.parameters.aspect_ratio;R=R===void 0?Ee*M:R,Ee=Ee===void 0?R/M:Ee,R*=.5,Ee*=.5,he=new THREE.OrthographicCamera(-R,R,Ee,-Ee,le.optics.parameters.znear,le.optics.parameters.zfar);break;default:he=new THREE.PerspectiveCamera;break}return he.name=le.name,he}function xe(le){var he=_t.cameras[le];return he!==void 0?C(he,ue):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",le),null)}function Ne(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"technique_common":he=He(M);break}}_t.lights[le.getAttribute("id")]=he}function He(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"directional":case"point":case"spot":case"ambient":he.technique=M.nodeName,he.parameters=Gt(M)}}return he}function Gt(le){for(var he={},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"color":var Z=h(M.textContent);he.color=new THREE.Color().fromArray(Z);break;case"falloff_angle":he.falloffAngle=parseFloat(M.textContent);break;case"quadratic_attenuation":var fe=parseFloat(M.textContent);he.distance=fe?Math.sqrt(1/fe):0;break}}return he}function Yt(le){var he;switch(le.technique){case"directional":he=new THREE.DirectionalLight;break;case"point":he=new THREE.PointLight;break;case"spot":he=new THREE.SpotLight;break;case"ambient":he=new THREE.AmbientLight;break}return le.parameters.color&&he.color.copy(le.parameters.color),le.parameters.distance&&(he.distance=le.parameters.distance),he}function Ht(le){var he=_t.lights[le];return he!==void 0?C(he,Yt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",le),null)}function zt(le){var he={name:le.getAttribute("name"),sources:{},vertices:{},primitives:[]},Ee=u(le,"mesh")[0];if(Ee!==void 0){for(var R=0;R<Ee.childNodes.length;R++){var M=Ee.childNodes[R];if(M.nodeType===1){var Z=M.getAttribute("id");switch(M.nodeName){case"source":he.sources[Z]=fn(M);break;case"vertices":he.vertices=nr(M);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",M.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":he.primitives.push(Bn(M));break;default:console.log(M)}}}_t.geometries[le.getAttribute("id")]=he}}function fn(le){for(var he={array:[],stride:3},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"float_array":he.array=h(R.textContent);break;case"Name_array":he.array=w(R.textContent);break;case"technique_common":var M=u(R,"accessor")[0];M!==void 0&&(he.stride=parseInt(M.getAttribute("stride")));break}}return he}function nr(le){for(var he={},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];R.nodeType===1&&(he[R.getAttribute("semantic")]=a(R.getAttribute("source")))}return he}function Bn(le){for(var he={type:le.nodeName,material:le.getAttribute("material"),count:parseInt(le.getAttribute("count")),inputs:{},stride:0,hasUV:!1},Ee=0,R=le.childNodes.length;Ee<R;Ee++){var M=le.childNodes[Ee];if(M.nodeType===1)switch(M.nodeName){case"input":var Z=a(M.getAttribute("source")),fe=M.getAttribute("semantic"),Oe=parseInt(M.getAttribute("offset")),Qe=parseInt(M.getAttribute("set")),Je=Qe>0?fe+Qe:fe;he.inputs[Je]={id:Z,offset:Oe},he.stride=Math.max(he.stride,Oe+1),fe==="TEXCOORD"&&(he.hasUV=!0);break;case"vcount":he.vcount=v(M.textContent);break;case"p":he.p=v(M.textContent);break}}return he}function bi(le){for(var he={},Ee=0;Ee<le.length;Ee++){var R=le[Ee];he[R.type]===void 0&&(he[R.type]=[]),he[R.type].push(R)}return he}function Ti(le){for(var he=0,Ee=0,R=le.length;Ee<R;Ee++){var M=le[Ee];M.hasUV===!0&&he++}he>0&&he<le.length&&(le.uvsNeedsFix=!0)}function Oi(le){var he={},Ee=le.sources,R=le.vertices,M=le.primitives;if(M.length===0)return{};var Z=bi(M);for(var fe in Z){var Oe=Z[fe];Ti(Oe),he[fe]=Mr(Oe,Ee,R)}return he}function Mr(le,he,Ee){for(var R={},M={array:[],stride:0},Z={array:[],stride:0},fe={array:[],stride:0},Oe={array:[],stride:0},Qe={array:[],stride:0},Je={array:[],stride:4},Xe={array:[],stride:4},ht=new THREE.BufferGeometry,ct=[],at=0,ut=0;ut<le.length;ut++){var Ct=le[ut],qt=Ct.inputs,Jt=0;switch(Ct.type){case"lines":case"linestrips":Jt=Ct.count*2;break;case"triangles":Jt=Ct.count*3;break;case"polylist":for(var an=0;an<Ct.count;an++){var Zt=Ct.vcount[an];switch(Zt){case 3:Jt+=3;break;case 4:Jt+=6;break;default:Jt+=(Zt-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",Ct.type)}ht.addGroup(at,Jt,ut),at+=Jt,Ct.material&&ct.push(Ct.material);for(var dn in qt){var un=qt[dn];switch(dn){case"VERTEX":for(var pn in Ee){var Vt=Ee[pn];switch(pn){case"POSITION":var ei=M.array.length;if($n(Ct,he[Vt],un.offset,M.array),M.stride=he[Vt].stride,he.skinWeights&&he.skinIndices&&($n(Ct,he.skinIndices,un.offset,Je.array),$n(Ct,he.skinWeights,un.offset,Xe.array)),Ct.hasUV===!1&&le.uvsNeedsFix===!0)for(var Jt=(M.array.length-ei)/M.stride,Mn=0;Mn<Jt;Mn++)fe.array.push(0,0);break;case"NORMAL":$n(Ct,he[Vt],un.offset,Z.array),Z.stride=he[Vt].stride;break;case"COLOR":$n(Ct,he[Vt],un.offset,Qe.array),Qe.stride=he[Vt].stride;break;case"TEXCOORD":$n(Ct,he[Vt],un.offset,fe.array),fe.stride=he[Vt].stride;break;case"TEXCOORD1":$n(Ct,he[Vt],un.offset,Oe.array),fe.stride=he[Vt].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',pn)}}break;case"NORMAL":$n(Ct,he[un.id],un.offset,Z.array),Z.stride=he[un.id].stride;break;case"COLOR":$n(Ct,he[un.id],un.offset,Qe.array),Qe.stride=he[un.id].stride;break;case"TEXCOORD":$n(Ct,he[un.id],un.offset,fe.array),fe.stride=he[un.id].stride;break;case"TEXCOORD1":$n(Ct,he[un.id],un.offset,Oe.array),Oe.stride=he[un.id].stride;break}}}return M.array.length>0&&ht.addAttribute("position",new THREE.Float32BufferAttribute(M.array,M.stride)),Z.array.length>0&&ht.addAttribute("normal",new THREE.Float32BufferAttribute(Z.array,Z.stride)),Qe.array.length>0&&ht.addAttribute("color",new THREE.Float32BufferAttribute(Qe.array,Qe.stride)),fe.array.length>0&&ht.addAttribute("uv",new THREE.Float32BufferAttribute(fe.array,fe.stride)),Oe.array.length>0&&ht.addAttribute("uv2",new THREE.Float32BufferAttribute(Oe.array,Oe.stride)),Je.array.length>0&&ht.addAttribute("skinIndex",new THREE.Float32BufferAttribute(Je.array,Je.stride)),Xe.array.length>0&&ht.addAttribute("skinWeight",new THREE.Float32BufferAttribute(Xe.array,Xe.stride)),R.data=ht,R.type=le[0].type,R.materialKeys=ct,R}function $n(le,he,Ee,R){var M=le.p,Z=le.stride,fe=le.vcount;function Oe(dn){for(var un=M[dn+Ee]*Je,pn=un+Je;un<pn;un++)R.push(Qe[un])}var Qe=he.array,Je=he.stride;if(le.vcount!==void 0)for(var Xe=0,ht=0,ct=fe.length;ht<ct;ht++){var at=fe[ht];if(at===4){var ut=Xe+Z*0,Ct=Xe+Z*1,qt=Xe+Z*2,Jt=Xe+Z*3;Oe(ut),Oe(Ct),Oe(Jt),Oe(Ct),Oe(qt),Oe(Jt)}else if(at===3){var ut=Xe+Z*0,Ct=Xe+Z*1,qt=Xe+Z*2;Oe(ut),Oe(Ct),Oe(qt)}else if(at>4)for(var an=1,Zt=at-2;an<=Zt;an++){var ut=Xe+Z*0,Ct=Xe+Z*an,qt=Xe+Z*(an+1);Oe(ut),Oe(Ct),Oe(qt)}Xe+=Z*at}else for(var ht=0,ct=M.length;ht<ct;ht+=Z)Oe(ht)}function Or(le){return C(_t.geometries[le],Oi)}function dr(le){for(var he={name:le.getAttribute("name")||"",joints:{},links:[]},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"technique_common":Sr(R,he);break}}_t.kinematicsModels[le.getAttribute("id")]=he}function Er(le){return le.build!==void 0?le.build:le}function Fr(le){return C(_t.kinematicsModels[le],Er)}function Sr(le,he){for(var Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"joint":he.joints[R.getAttribute("sid")]=ir(R);break;case"link":he.links.push(sr(R));break}}}function ir(le){for(var he,Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"prismatic":case"revolute":he=Li(R);break}}return he}function Li(le,Ee){for(var Ee={sid:le.getAttribute("sid"),name:le.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:le.nodeName,static:!1,zeroPosition:0,middlePosition:0},R=0;R<le.childNodes.length;R++){var M=le.childNodes[R];if(M.nodeType===1)switch(M.nodeName){case"axis":var Z=h(M.textContent);Ee.axis.fromArray(Z);break;case"limits":var fe=M.getElementsByTagName("max")[0],Oe=M.getElementsByTagName("min")[0];Ee.limits.max=parseFloat(fe.textContent),Ee.limits.min=parseFloat(Oe.textContent);break}}return Ee.limits.min>=Ee.limits.max&&(Ee.static=!0),Ee.middlePosition=(Ee.limits.min+Ee.limits.max)/2,Ee}function sr(le){for(var he={sid:le.getAttribute("sid"),name:le.getAttribute("name")||"",attachments:[],transforms:[]},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"attachment_full":he.attachments.push(fs(R));break;case"matrix":case"translate":case"rotate":he.transforms.push(Ur(R));break}}return he}function fs(le){for(var he={joint:le.getAttribute("joint").split("/").pop(),transforms:[],links:[]},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"link":he.links.push(sr(R));break;case"matrix":case"translate":case"rotate":he.transforms.push(Ur(R));break}}return he}function Ur(le){var he={type:le.nodeName},Ee=h(le.textContent);switch(he.type){case"matrix":he.obj=new THREE.Matrix4,he.obj.fromArray(Ee).transpose();break;case"translate":he.obj=new THREE.Vector3,he.obj.fromArray(Ee);break;case"rotate":he.obj=new THREE.Vector3,he.obj.fromArray(Ee),he.angle=THREE.MathUtils.degToRad(Ee[3]);break}return he}function os(le){for(var he={name:le.getAttribute("name")||"",rigidBodies:{}},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"rigid_body":he.rigidBodies[R.getAttribute("name")]={},es(R,he.rigidBodies[R.getAttribute("name")]);break}}_t.physicsModels[le.getAttribute("id")]=he}function es(le,he){for(var Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"technique_common":Ie(R,he);break}}}function Ie(le,he){for(var Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"inertia":he.inertia=h(R.textContent);break;case"mass":he.mass=h(R.textContent)[0];break}}}function Ge(le){for(var he={bindJointAxis:[]},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"bind_joint_axis":he.bindJointAxis.push(tt(R));break}}_t.kinematicsScenes[a(le.getAttribute("url"))]=he}function tt(le){for(var he={target:le.getAttribute("target").split("/").pop()},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"axis":var M=R.getElementsByTagName("param")[0];he.axis=M.textContent;var Z=he.axis.split("inst_").pop().split("axis")[0];he.jointIndex=Z.substr(0,Z.length-1);break}}return he}function At(le){return le.build!==void 0?le.build:le}function lt(le){return C(_t.kinematicsScenes[le],At)}function wt(){var le=Object.keys(_t.kinematicsModels)[0],he=Object.keys(_t.kinematicsScenes)[0],Ee=Object.keys(_t.visualScenes)[0];if(le===void 0||he===void 0)return;for(var R=Fr(le),M=lt(he),Z=z(Ee),fe=M.bindJointAxis,Oe={},Qe=0,Je=fe.length;Qe<Je;Qe++){var Xe=fe[Qe],ht=Me.querySelector('[sid="'+Xe.target+'"]');if(ht){var ct=ht.parentElement;at(Xe.jointIndex,ct)}}function at(Ct,qt){var Jt=qt.getAttribute("name"),an=R.joints[Ct];Z.traverse(function(Zt){Zt.name===Jt&&(Oe[Ct]={object:Zt,transforms:Ft(qt),joint:an,position:an.zeroPosition})})}var ut=new THREE.Matrix4;yt={joints:R&&R.joints,getJointValue:function(Ct){var qt=Oe[Ct];if(qt)return qt.position;console.warn("THREE.ColladaLoader: Joint "+Ct+" doesn't exist.")},setJointValue:function(Ct,qt){var Jt=Oe[Ct];if(Jt){var an=Jt.joint;if(qt>an.limits.max||qt<an.limits.min)console.warn("THREE.ColladaLoader: Joint "+Ct+" value "+qt+" outside of limits (min: "+an.limits.min+", max: "+an.limits.max+").");else if(an.static)console.warn("THREE.ColladaLoader: Joint "+Ct+" is static.");else{var Zt=Jt.object,dn=an.axis,un=Jt.transforms;tn.identity();for(var pn=0;pn<un.length;pn++){var Vt=un[pn];if(Vt.sid&&Vt.sid.indexOf(Ct)!==-1)switch(an.type){case"revolute":tn.multiply(ut.makeRotationAxis(dn,THREE.MathUtils.degToRad(qt)));break;case"prismatic":tn.multiply(ut.makeTranslation(dn.x*qt,dn.y*qt,dn.z*qt));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+an.type);break}else switch(Vt.type){case"matrix":tn.multiply(Vt.obj);break;case"translate":tn.multiply(ut.makeTranslation(Vt.obj.x,Vt.obj.y,Vt.obj.z));break;case"scale":tn.scale(Vt.obj);break;case"rotate":tn.multiply(ut.makeRotationAxis(Vt.obj,Vt.angle));break}}Zt.matrix.copy(tn),Zt.matrix.decompose(Zt.position,Zt.quaternion,Zt.scale),Oe[Ct].position=qt}}else console.log("THREE.ColladaLoader: "+Ct+" does not exist.")}}}function Ft(le){for(var he=[],Ee=Me.querySelector('[id="'+le.id+'"]'),R=0;R<Ee.childNodes.length;R++){var M=Ee.childNodes[R];if(M.nodeType===1)switch(M.nodeName){case"matrix":var fe=h(M.textContent),Z=new THREE.Matrix4().fromArray(fe).transpose();he.push({sid:M.getAttribute("sid"),type:M.nodeName,obj:Z});break;case"translate":case"scale":var fe=h(M.textContent),Oe=new THREE.Vector3().fromArray(fe);he.push({sid:M.getAttribute("sid"),type:M.nodeName,obj:Oe});break;case"rotate":var fe=h(M.textContent),Oe=new THREE.Vector3().fromArray(fe),Qe=THREE.MathUtils.degToRad(fe[3]);he.push({sid:M.getAttribute("sid"),type:M.nodeName,obj:Oe,angle:Qe});break}}return he}function yn(le){for(var he=le.getElementsByTagName("node"),Ee=0;Ee<he.length;Ee++){var R=he[Ee];R.hasAttribute("id")===!1&&R.setAttribute("id",f())}}var tn=new THREE.Matrix4,bt=new THREE.Vector3;function Rn(le){for(var he={name:le.getAttribute("name")||"",type:le.getAttribute("type"),id:le.getAttribute("id"),sid:le.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];if(R.nodeType===1)switch(R.nodeName){case"node":he.nodes.push(R.getAttribute("id")),Rn(R);break;case"instance_camera":he.instanceCameras.push(a(R.getAttribute("url")));break;case"instance_controller":he.instanceControllers.push(Pn(R));break;case"instance_light":he.instanceLights.push(a(R.getAttribute("url")));break;case"instance_geometry":he.instanceGeometries.push(Pn(R));break;case"instance_node":he.instanceNodes.push(a(R.getAttribute("url")));break;case"matrix":var Z=h(R.textContent);he.matrix.multiply(tn.fromArray(Z).transpose()),he.transforms[R.getAttribute("sid")]=R.nodeName;break;case"translate":var Z=h(R.textContent);bt.fromArray(Z),he.matrix.multiply(tn.makeTranslation(bt.x,bt.y,bt.z)),he.transforms[R.getAttribute("sid")]=R.nodeName;break;case"rotate":var Z=h(R.textContent),M=THREE.MathUtils.degToRad(Z[3]);he.matrix.multiply(tn.makeRotationAxis(bt.fromArray(Z),M)),he.transforms[R.getAttribute("sid")]=R.nodeName;break;case"scale":var Z=h(R.textContent);he.matrix.scale(bt.fromArray(Z)),he.transforms[R.getAttribute("sid")]=R.nodeName;break;case"extra":break;default:console.log(R)}}return Vi(he.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",he.id):_t.nodes[he.id]=he,he}function Pn(le){for(var he={id:a(le.getAttribute("url")),materials:{},skeletons:[]},Ee=0;Ee<le.childNodes.length;Ee++){var R=le.childNodes[Ee];switch(R.nodeName){case"bind_material":for(var M=R.getElementsByTagName("instance_material"),Z=0;Z<M.length;Z++){var fe=M[Z],Oe=fe.getAttribute("symbol"),Qe=fe.getAttribute("target");he.materials[Oe]=a(Qe)}break;case"skeleton":he.skeletons.push(a(R.textContent));break}}return he}function Xn(le,he){var Ee=[],R=[],M,Z,fe;for(M=0;M<le.length;M++){var Oe=le[M],Qe;if(Vi(Oe))Qe=on(Oe),Di(Qe,he,Ee);else if(gi(Oe))for(var Je=_t.visualScenes[Oe],Xe=Je.children,Z=0;Z<Xe.length;Z++){var ht=Xe[Z];if(ht.type==="JOINT"){var Qe=on(ht.id);Di(Qe,he,Ee)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Oe)}for(M=0;M<he.length;M++)for(Z=0;Z<Ee.length;Z++)if(fe=Ee[Z],fe.bone.name===he[M].name){R[M]=fe,fe.processed=!0;break}for(M=0;M<Ee.length;M++)fe=Ee[M],fe.processed===!1&&(R.push(fe),fe.processed=!0);var ct=[],at=[];for(M=0;M<R.length;M++)fe=R[M],ct.push(fe.bone),at.push(fe.boneInverse);return new THREE.Skeleton(ct,at)}function Di(le,he,Ee){le.traverse(function(R){if(R.isBone===!0){for(var M,Z=0;Z<he.length;Z++){var fe=he[Z];if(fe.name===R.name){M=fe.boneInverse;break}}M===void 0&&(M=new THREE.Matrix4),Ee.push({bone:R,boneInverse:M,processed:!1})}})}function si(le){for(var he=[],Ee=le.matrix,R=le.nodes,M=le.type,Z=le.instanceCameras,fe=le.instanceControllers,Oe=le.instanceLights,Qe=le.instanceGeometries,Je=le.instanceNodes,Xe=0,ht=R.length;Xe<ht;Xe++)he.push(on(R[Xe]));for(var Xe=0,ht=Z.length;Xe<ht;Xe++){var ct=xe(Z[Xe]);ct!==null&&he.push(ct.clone())}for(var Xe=0,ht=fe.length;Xe<ht;Xe++)for(var at=fe[Xe],ut=qe(at.id),Ct=Or(ut.id),qt=Wi(Ct,at.materials),Jt=at.skeletons,an=ut.skin.joints,Zt=Xn(Jt,an),dn=0,un=qt.length;dn<un;dn++){var Vt=qt[dn];Vt.isSkinnedMesh&&(Vt.bind(Zt,ut.skin.bindMatrix),Vt.normalizeSkinWeights()),he.push(Vt)}for(var Xe=0,ht=Oe.length;Xe<ht;Xe++){var pn=Ht(Oe[Xe]);pn!==null&&he.push(pn.clone())}for(var Xe=0,ht=Qe.length;Xe<ht;Xe++)for(var at=Qe[Xe],Ct=Or(at.id),qt=Wi(Ct,at.materials),dn=0,un=qt.length;dn<un;dn++)he.push(qt[dn]);for(var Xe=0,ht=Je.length;Xe<ht;Xe++)he.push(on(Je[Xe]).clone());var Vt;if(R.length===0&&he.length===1)Vt=he[0];else{Vt=M==="JOINT"?new THREE.Bone:new THREE.Group;for(var Xe=0;Xe<he.length;Xe++)Vt.add(he[Xe])}return Vt.name===""&&(Vt.name=M==="JOINT"?le.sid:le.name),Vt.matrix.copy(Ee),Vt.matrix.decompose(Vt.position,Vt.quaternion,Vt.scale),Vt}var ti=new THREE.MeshBasicMaterial({color:16711935});function pi(le,he){for(var Ee=[],R=0,M=le.length;R<M;R++){var Z=he[le[R]];Z===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",le[R]),Ee.push(ti)):Ee.push(Re(Z))}return Ee}function Wi(le,he){var Ee=[];for(var R in le){var M=le[R],Z=pi(M.materialKeys,he);Z.length===0&&(R==="lines"||R==="linestrips"?Z.push(new THREE.LineBasicMaterial):Z.push(new THREE.MeshPhongMaterial));var fe=M.data.attributes.skinIndex!==void 0;if(fe)for(var Oe=0,Qe=Z.length;Oe<Qe;Oe++)Z[Oe].skinning=!0;var Je=Z.length===1?Z[0]:Z,Xe;switch(R){case"lines":Xe=new THREE.LineSegments(M.data,Je);break;case"linestrips":Xe=new THREE.Line(M.data,Je);break;case"triangles":case"polylist":fe?Xe=new THREE.SkinnedMesh(M.data,Je):Xe=new THREE.Mesh(M.data,Je);break}Ee.push(Xe)}return Ee}function Vi(le){return _t.nodes[le]!==void 0}function on(le){return C(_t.nodes[le],si)}function oi(le){var he={name:le.getAttribute("name"),children:[]};yn(le);for(var Ee=u(le,"node"),R=0;R<Ee.length;R++)he.children.push(Rn(Ee[R]));_t.visualScenes[le.getAttribute("id")]=he}function or(le){var he=new THREE.Group;he.name=le.name;for(var Ee=le.children,R=0;R<Ee.length;R++){var M=Ee[R];he.add(on(M.id))}return he}function gi(le){return _t.visualScenes[le]!==void 0}function z(le){return C(_t.visualScenes[le],or)}function q(le){var he=u(le,"instance_visual_scene")[0];return z(a(he.getAttribute("url")))}function ce(){var le=_t.clips;if(m(le)===!0){if(m(_t.animations)===!1){var he=[];for(var Ee in _t.animations)for(var R=N(Ee),M=0,Z=R.length;M<Z;M++)he.push(R[M]);it.push(new THREE.AnimationClip("default",-1,he))}}else for(var Ee in le)it.push(O(Ee))}if($.length===0)return{scene:new THREE.Scene};var me=new DOMParser().parseFromString($,"application/xml"),Me=u(me,"COLLADA")[0],Ke=Me.getAttribute("version");console.log("THREE.ColladaLoader: File version",Ke);var et=l(u(Me,"asset")[0]),It=new THREE.TextureLoader(this.manager);It.setPath(this.resourcePath||A).setCrossOrigin(this.crossOrigin);var St;THREE.TGALoader&&(St=new THREE.TGALoader(this.manager),St.setPath(this.resourcePath||A));var it=[],yt={},Nt=0,_t={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};d(Me,"library_animations","animation",S),d(Me,"library_animation_clips","animation_clip",b),d(Me,"library_controllers","controller",Q),d(Me,"library_images","image",ft),d(Me,"library_effects","effect",kt),d(Me,"library_materials","material",ye),d(Me,"library_cameras","camera",Ue),d(Me,"library_lights","light",Ne),d(Me,"library_geometries","geometry",zt),d(Me,"library_nodes","node",Rn),d(Me,"library_visual_scenes","visual_scene",oi),d(Me,"library_kinematics_models","kinematics_model",dr),d(Me,"library_physics_models","physics_model",os),d(Me,"scene","instance_kinematics_scene",Ge),p(_t.animations,T),p(_t.clips,I),p(_t.controllers,_e),p(_t.images,Et),p(_t.effects,Mt),p(_t.materials,Se),p(_t.cameras,ue),p(_t.lights,Yt),p(_t.geometries,Oi),p(_t.visualScenes,or),ce(),wt();var Cn=q(u(Me,"scene")[0]);return et.upAxis==="Z_UP"&&Cn.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),Cn.scale.multiplyScalar(et.unit),{animations:it,kinematics:yt,library:_t,scene:Cn}}}},"./lib/GamepadButton.js":W=>{W.exports=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})},"./lib/GamepadButtonEvent.js":W=>{function $(A,u,w){this.type=A,this.index=u,this.pressed=w.pressed,this.value=w.value}W.exports=$},"./lib/fetch-script.js":W=>{function $(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function A(a,f){var m=document.createElement("script");return m.type="text/javascript",m.async=!0,m.id=f,m.src=a,m}function u(a){const f=document.getElementById(a),m=f.parentNode;try{m&&m.removeChild(f)}catch{}}function w(a){const f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}function h(a,f,m){return new m(function(l,y){const g=f.timeout||5e3,d=$(),p=A(a,d),C=setTimeout(function(){y(new Error("Script request to "+a+" timed out")),u(d)},g),S=function(_){clearTimeout(_)};p.addEventListener("load",function(_){l({ok:!0}),S(C),u(d)}),p.addEventListener("error",function(_){y(new Error("Script request to "+a+" failed "+_)),S(C),u(d)}),w(p)})}function v(a){return a=a||{},function(f,m){return m=m||{},h(f,m,a.Promise||Promise)}}W.exports=v},"./lib/keyboard.polyfill.js":()=>{(function(W){var $="KeyboardEvent"in W;$||(W.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in W.KeyboardEvent||(W.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in W.KeyboardEvent||(W.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in W.KeyboardEvent||(W.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in W.KeyboardEvent||(W.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var A=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,u=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,w=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,h=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function v(F,te){return String(F).indexOf(te)!==-1}var a=function(){return v(navigator.platform,"Win")?"win":v(navigator.platform,"Mac")?"mac":v(navigator.platform,"CrOS")?"cros":v(navigator.platform,"Linux")?"linux":v(navigator.userAgent,"iPad")||v(navigator.platform,"iPod")||v(navigator.platform,"iPhone")?"ios":""}(),f=function(){return v(navigator.userAgent,"Chrome/")?"chrome":v(navigator.vendor,"Apple")?"safari":v(navigator.userAgent,"MSIE")?"ie":v(navigator.userAgent,"Gecko/")?"moz":v(navigator.userAgent,"Opera/")?"opera":""}(),m=f+"-"+a;function l(F,te,K){(m===te||f===te||a===te)&&Object.keys(K).forEach(function(se){F[se]=K[se]})}function y(F,te){var K={};return Object.keys(F).forEach(function(se){var ne=F[se];te in ne&&(K[ne[te]]=ne)}),K}var g={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:u},92:{code:"OSRight",location:w},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:h},97:{code:"Numpad1",keyCap:"1",location:h},98:{code:"Numpad2",keyCap:"2",location:h},99:{code:"Numpad3",keyCap:"3",location:h},100:{code:"Numpad4",keyCap:"4",location:h},101:{code:"Numpad5",keyCap:"5",location:h},102:{code:"Numpad6",keyCap:"6",location:h},103:{code:"Numpad7",keyCap:"7",location:h},104:{code:"Numpad8",keyCap:"8",location:h},105:{code:"Numpad9",keyCap:"9",location:h},106:{code:"NumpadMultiply",keyCap:"*",location:h},107:{code:"NumpadAdd",keyCap:"+",location:h},108:{code:"NumpadComma",keyCap:",",location:h},109:{code:"NumpadSubtract",keyCap:"-",location:h},110:{code:"NumpadDecimal",keyCap:".",location:h},111:{code:"NumpadDivide",keyCap:"/",location:h},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:h},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:u},161:{code:"ShiftRight",location:w},162:{code:"ControlLeft",location:u},163:{code:"ControlRight",location:w},164:{code:"AltLeft",location:u},165:{code:"AltRight",location:w},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};l(g,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:h},189:{code:"NumpadSubtract",keyCap:"-",location:h}}),l(g,"moz-mac",{12:{code:"NumLock",location:h},173:{code:"Minus",keyCap:"-"}}),l(g,"moz-win",{173:{code:"Minus",keyCap:"-"}}),l(g,"chrome-mac",{93:{code:"OSRight",location:w}}),l(g,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),l(g,"ios",{10:{code:"Enter",location:A}}),l(g,"safari-mac",{91:{code:"OSLeft",location:u},93:{code:"OSRight",location:w},229:{code:"KeyQ",keyCap:"Q"}});var d={};a==="cros"&&(d["U+00A0"]={code:"ShiftLeft",location:u},d["U+00A1"]={code:"ShiftRight",location:w},d["U+00A2"]={code:"ControlLeft",location:u},d["U+00A3"]={code:"ControlRight",location:w},d["U+00A4"]={code:"AltLeft",location:u},d["U+00A5"]={code:"AltRight",location:w}),m==="chrome-mac"&&(d["U+0010"]={code:"ContextMenu"}),m==="safari-mac"&&(d["U+0010"]={code:"ContextMenu"}),a==="ios"&&(d["U+0010"]={code:"Function"},d["U+001C"]={code:"ArrowLeft"},d["U+001D"]={code:"ArrowRight"},d["U+001E"]={code:"ArrowUp"},d["U+001F"]={code:"ArrowDown"},d["U+0001"]={code:"Home"},d["U+0004"]={code:"End"},d["U+000B"]={code:"PageUp"},d["U+000C"]={code:"PageDown"});var p=[];p[u]={16:{code:"ShiftLeft",location:u},17:{code:"ControlLeft",location:u},18:{code:"AltLeft",location:u}},p[w]={16:{code:"ShiftRight",location:w},17:{code:"ControlRight",location:w},18:{code:"AltRight",location:w}},p[h]={13:{code:"NumpadEnter",location:h}},l(p[h],"moz",{109:{code:"NumpadSubtract",location:h},107:{code:"NumpadAdd",location:h}}),l(p[u],"moz-mac",{224:{code:"OSLeft",location:u}}),l(p[w],"moz-mac",{224:{code:"OSRight",location:w}}),l(p[w],"moz-win",{91:{code:"OSRight",location:w}}),l(p[w],"mac",{93:{code:"OSRight",location:w}}),l(p[h],"chrome-mac",{12:{code:"NumLock",location:h}}),l(p[h],"safari-mac",{12:{code:"NumLock",location:h},187:{code:"NumpadAdd",location:h},189:{code:"NumpadSubtract",location:h},190:{code:"NumpadDecimal",location:h},191:{code:"NumpadDivide",location:h}});var C={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};l(C,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var S={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},_=y(g,"code");try{var L=$&&"location"in new KeyboardEvent("")}catch{}function T(F){var te="keyCode"in F?F.keyCode:"which"in F?F.which:0,K=function(){if(L||"keyLocation"in F){var ne=L?F.location:F.keyLocation;if(ne&&te in p[ne])return p[ne][te]}return"keyIdentifier"in F&&F.keyIdentifier in d?d[F.keyIdentifier]:te in g?g[te]:null}();if(!K)return null;var se=function(){var ne=C[K.code];return ne?F.shiftKey&&"shiftKey"in ne?ne.shiftKey:ne.key:K.code}();return{code:K.code,key:se,location:K.location,keyCap:K.keyCap}}function N(F,te){if(F=String(F),!_.hasOwnProperty(F))return"Undefined";if(te&&String(te).toLowerCase()!=="en-us")throw Error("Unsupported locale");var K=_[F];return K.keyCap||K.code||"Undefined"}"KeyboardEvent"in W&&"defineProperty"in Object&&function(){function F(K,se,ne){se in K||Object.defineProperty(K,se,ne)}if(F(KeyboardEvent.prototype,"code",{get:function(){var K=T(this);return K?K.code:""}}),"key"in KeyboardEvent.prototype){var te=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var K=te.get.call(this);return S.hasOwnProperty(K)?S[K]:K}})}F(KeyboardEvent.prototype,"key",{get:function(){var K=T(this);return K&&"key"in K?K.key:"Unidentified"}}),F(KeyboardEvent.prototype,"location",{get:function(){var K=T(this);return K&&"location"in K?K.location:A}}),F(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in W.KeyboardEvent||(W.KeyboardEvent.queryKeyCap=N),W.identifyKey=function(F){if(!("code"in F)){var te=T(F);F.code=te?te.code:"",F.key=te&&"key"in te?te.key:"Unidentified",F.location="location"in F?F.location:"keyLocation"in F?F.keyLocation:te&&"location"in te?te.location:A,F.locale=""}}})(window)},"./node_modules/nipplejs/dist/nipplejs.js":W=>{(function($,A){W.exports=A()})(window,function(){return function($){var A={};function u(w){if(A[w])return A[w].exports;var h=A[w]={i:w,l:!1,exports:{}};return $[w].call(h.exports,h,h.exports,u),h.l=!0,h.exports}return u.m=$,u.c=A,u.d=function(w,h,v){u.o(w,h)||Object.defineProperty(w,h,{enumerable:!0,get:v})},u.r=function(w){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(w,"__esModule",{value:!0})},u.t=function(w,h){if(1&h&&(w=u(w)),8&h||4&h&&typeof w=="object"&&w&&w.__esModule)return w;var v=Object.create(null);if(u.r(v),Object.defineProperty(v,"default",{enumerable:!0,value:w}),2&h&&typeof w!="string")for(var a in w)u.d(v,a,(function(f){return w[f]}).bind(null,a));return v},u.n=function(w){var h=w&&w.__esModule?function(){return w.default}:function(){return w};return u.d(h,"a",h),h},u.o=function(w,h){return Object.prototype.hasOwnProperty.call(w,h)},u.p="",u(u.s=0)}([function($,A,u){u.r(A);var w,h=function(b,I){var O=I.x-b.x,Q=I.y-b.y;return Math.sqrt(O*O+Q*Q)},v=function(b){return b*(Math.PI/180)},a=function(b){return b*(180/Math.PI)},f=new Map,m=function(b){f.has(b)&&clearTimeout(f.get(b)),f.set(b,setTimeout(b,100))},l=function(b,I,O){for(var Q,J=I.split(/[ ,]+/g),ve=0;ve<J.length;ve+=1)Q=J[ve],b.addEventListener?b.addEventListener(Q,O,!1):b.attachEvent&&b.attachEvent(Q,O)},y=function(b,I,O){for(var Q,J=I.split(/[ ,]+/g),ve=0;ve<J.length;ve+=1)Q=J[ve],b.removeEventListener?b.removeEventListener(Q,O):b.detachEvent&&b.detachEvent(Q,O)},g=function(b){return b.preventDefault(),b.type.match(/^touch/)?b.changedTouches:b},d=function(){return{x:window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},p=function(b,I){I.top||I.right||I.bottom||I.left?(b.style.top=I.top,b.style.right=I.right,b.style.bottom=I.bottom,b.style.left=I.left):(b.style.left=I.x+"px",b.style.top=I.y+"px")},C=function(b,I,O){var Q=S(b);for(var J in Q)if(Q.hasOwnProperty(J))if(typeof I=="string")Q[J]=I+" "+O;else{for(var ve="",Le=0,_e=I.length;Le<_e;Le+=1)ve+=I[Le]+" "+O+", ";Q[J]=ve.slice(0,-2)}return Q},S=function(b){var I={};return I[b]="",["webkit","Moz","o"].forEach(function(O){I[O+b.charAt(0).toUpperCase()+b.slice(1)]=""}),I},_=function(b,I){for(var O in I)I.hasOwnProperty(O)&&(b[O]=I[O]);return b},L=function(b,I){if(b.length)for(var O=0,Q=b.length;O<Q;O+=1)I(b[O]);else I(b)},T="ontouchstart"in window,N=!!window.PointerEvent,F=!!window.MSPointerEvent,te={start:"mousedown",move:"mousemove",end:"mouseup"},K={};function se(){}N?w={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:F?w={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:T?(w={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},K=te):w=te,se.prototype.on=function(b,I){var O,Q=b.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var J=0;J<Q.length;J+=1)O=Q[J],this._handlers_[O]=this._handlers_[O]||[],this._handlers_[O].push(I);return this},se.prototype.off=function(b,I){return this._handlers_=this._handlers_||{},b===void 0?this._handlers_={}:I===void 0?this._handlers_[b]=null:this._handlers_[b]&&this._handlers_[b].indexOf(I)>=0&&this._handlers_[b].splice(this._handlers_[b].indexOf(I),1),this},se.prototype.trigger=function(b,I){var O,Q=this,J=b.split(/[ ,]+/g);Q._handlers_=Q._handlers_||{};for(var ve=0;ve<J.length;ve+=1)O=J[ve],Q._handlers_[O]&&Q._handlers_[O].length&&Q._handlers_[O].forEach(function(Le){Le.call(Q,{type:O,target:Q},I)})},se.prototype.config=function(b){this.options=this.defaults||{},b&&(this.options=function(I,O){var Q={};for(var J in I)I.hasOwnProperty(J)&&O.hasOwnProperty(J)?Q[J]=O[J]:I.hasOwnProperty(J)&&(Q[J]=I[J]);return Q}(this.options,b))},se.prototype.bindEvt=function(b,I){var O=this;return O._domHandlers_=O._domHandlers_||{},O._domHandlers_[I]=function(){typeof O["on"+I]=="function"?O["on"+I].apply(O,arguments):console.warn('[WARNING] : Missing "on'+I+'" handler.')},l(b,w[I],O._domHandlers_[I]),K[I]&&l(b,K[I],O._domHandlers_[I]),O},se.prototype.unbindEvt=function(b,I){return this._domHandlers_=this._domHandlers_||{},y(b,w[I],this._domHandlers_[I]),K[I]&&y(b,K[I],this._domHandlers_[I]),delete this._domHandlers_[I],this};var ne=se;function re(b,I){return this.identifier=I.identifier,this.position=I.position,this.frontPosition=I.frontPosition,this.collection=b,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(I),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=re.id,re.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}re.prototype=new ne,re.constructor=re,re.id=0,re.prototype.buildEl=function(b){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},re.prototype.stylize=function(){if(this.options.dataOnly)return this;var b=this.options.fadeTime+"ms",I=function(J,ve){var Le=S(J);for(var _e in Le)Le.hasOwnProperty(_e)&&(Le[_e]=ve);return Le}("borderRadius","50%"),O=C("transition","opacity",b),Q={};return Q.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},Q.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},Q.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},_(Q.el,O),this.options.shape==="circle"&&_(Q.back,I),_(Q.front,I),this.applyStyles(Q),this},re.prototype.applyStyles=function(b){for(var I in this.ui)if(this.ui.hasOwnProperty(I))for(var O in b[I])this.ui[I].style[O]=b[I][O];return this},re.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},re.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},re.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},re.prototype.show=function(b){var I=this;return I.options.dataOnly||(clearTimeout(I.removeTimeout),clearTimeout(I.showTimeout),clearTimeout(I.restTimeout),I.addToDom(),I.restCallback(),setTimeout(function(){I.ui.el.style.opacity=1},0),I.showTimeout=setTimeout(function(){I.trigger("shown",I.instance),typeof b=="function"&&b.call(this)},I.options.fadeTime)),I},re.prototype.hide=function(b){var I=this;if(I.options.dataOnly)return I;if(I.ui.el.style.opacity=I.options.restOpacity,clearTimeout(I.removeTimeout),clearTimeout(I.showTimeout),clearTimeout(I.restTimeout),I.removeTimeout=setTimeout(function(){var J=I.options.mode==="dynamic"?"none":"block";I.ui.el.style.display=J,typeof b=="function"&&b.call(I),I.trigger("hidden",I.instance)},I.options.fadeTime),I.options.restJoystick){var O=I.options.restJoystick,Q={};Q.x=O===!0||O.x!==!1?0:I.instance.frontPosition.x,Q.y=O===!0||O.y!==!1?0:I.instance.frontPosition.y,I.setPosition(b,Q)}return I},re.prototype.setPosition=function(b,I){var O=this;O.frontPosition={x:I.x,y:I.y};var Q=O.options.fadeTime+"ms",J={};J.front=C("transition",["transform"],Q);var ve={front:{}};ve.front={transform:"translate("+O.frontPosition.x+"px,"+O.frontPosition.y+"px)"},O.applyStyles(J),O.applyStyles(ve),O.restTimeout=setTimeout(function(){typeof b=="function"&&b.call(O),O.restCallback()},O.options.fadeTime)},re.prototype.restCallback=function(){var b={};b.front=C("transition","none",""),this.applyStyles(b),this.trigger("rested",this.instance)},re.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},re.prototype.computeDirection=function(b){var I,O,Q,J=b.angle.radian,ve=Math.PI/4,Le=Math.PI/2;if(J>ve&&J<3*ve&&!b.lockX?I="up":J>-ve&&J<=ve&&!b.lockY?I="left":J>3*-ve&&J<=-ve&&!b.lockX?I="down":b.lockY||(I="right"),b.lockY||(O=J>-Le&&J<Le?"left":"right"),b.lockX||(Q=J>0?"up":"down"),b.force>this.options.threshold){var _e,Ze={};for(_e in this.direction)this.direction.hasOwnProperty(_e)&&(Ze[_e]=this.direction[_e]);var qe={};for(_e in this.direction={x:O,y:Q,angle:I},b.direction=this.direction,Ze)Ze[_e]===this.direction[_e]&&(qe[_e]=!0);if(qe.x&&qe.y&&qe.angle)return b;qe.x&&qe.y||this.trigger("plain",b),qe.x||this.trigger("plain:"+O,b),qe.y||this.trigger("plain:"+Q,b),qe.angle||this.trigger("dir dir:"+I,b)}else this.resetDirection();return b};var Y=re;function k(b,I){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=b,this.id=k.id,k.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(I),this.options.mode!=="static"&&this.options.mode!=="semi"||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var O=getComputedStyle(this.options.zone.parentElement);return O&&O.display==="flex"&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}k.prototype=new ne,k.constructor=k,k.id=0,k.prototype.prepareNipples=function(){var b=this.nipples;b.on=this.on.bind(this),b.off=this.off.bind(this),b.options=this.options,b.destroy=this.destroy.bind(this),b.ids=this.ids,b.id=this.id,b.processOnMove=this.processOnMove.bind(this),b.processOnEnd=this.processOnEnd.bind(this),b.get=function(I){if(I===void 0)return b[0];for(var O=0,Q=b.length;O<Q;O+=1)if(b[O].identifier===I)return b[O];return!1}},k.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},k.prototype.begin=function(){var b=this.options;if(b.mode==="static"){var I=this.createNipple(b.position,this.manager.getIdentifier());I.add(),this.idles.push(I)}},k.prototype.createNipple=function(b,I){var O=this.manager.scroll,Q={},J=this.options,ve=this.parentIsFlex?O.x:O.x+this.box.left,Le=this.parentIsFlex?O.y:O.y+this.box.top;if(b.x&&b.y)Q={x:b.x-ve,y:b.y-Le};else if(b.top||b.right||b.bottom||b.left){var _e=document.createElement("DIV");_e.style.display="hidden",_e.style.top=b.top,_e.style.right=b.right,_e.style.bottom=b.bottom,_e.style.left=b.left,_e.style.position="absolute",J.zone.appendChild(_e);var Ze=_e.getBoundingClientRect();J.zone.removeChild(_e),Q=b,b={x:Ze.left+O.x,y:Ze.top+O.y}}var qe=new Y(this,{color:J.color,size:J.size,threshold:J.threshold,fadeTime:J.fadeTime,dataOnly:J.dataOnly,restJoystick:J.restJoystick,restOpacity:J.restOpacity,mode:J.mode,identifier:I,position:b,zone:J.zone,frontPosition:{x:0,y:0},shape:J.shape});return J.dataOnly||(p(qe.ui.el,Q),p(qe.ui.front,qe.frontPosition)),this.nipples.push(qe),this.trigger("added "+qe.identifier+":added",qe),this.manager.trigger("added "+qe.identifier+":added",qe),this.bindNipple(qe),qe},k.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},k.prototype.bindNipple=function(b){var I,O=this,Q=function(J,ve){I=J.type+" "+ve.id+":"+J.type,O.trigger(I,ve)};b.on("destroyed",O.onDestroyed.bind(O)),b.on("shown hidden rested dir plain",Q),b.on("dir:up dir:right dir:down dir:left",Q),b.on("plain:up plain:right plain:down plain:left",Q)},k.prototype.pressureFn=function(b,I,O){var Q=this,J=0;clearInterval(Q.pressureIntervals[O]),Q.pressureIntervals[O]=setInterval((function(){var ve=b.force||b.pressure||b.webkitForce||0;ve!==J&&(I.trigger("pressure",ve),Q.trigger("pressure "+I.identifier+":pressure",ve),J=ve)}).bind(Q),100)},k.prototype.onstart=function(b){var I=this,O=I.options,Q=b;return b=g(b),I.updateBox(),L(b,function(J){I.actives.length<O.maxNumberOfNipples?I.processOnStart(J):Q.type.match(/^touch/)&&(Object.keys(I.manager.ids).forEach(function(ve){if(Object.values(Q.touches).findIndex(function(_e){return _e.identifier===ve})<0){var Le=[b[0]];Le.identifier=ve,I.processOnEnd(Le)}}),I.actives.length<O.maxNumberOfNipples&&I.processOnStart(J))}),I.manager.bindDocument(),!1},k.prototype.processOnStart=function(b){var I,O=this,Q=O.options,J=O.manager.getIdentifier(b),ve=b.force||b.pressure||b.webkitForce||0,Le={x:b.pageX,y:b.pageY},_e=O.getOrCreate(J,Le);_e.identifier!==J&&O.manager.removeIdentifier(_e.identifier),_e.identifier=J;var Ze=function(qe){qe.trigger("start",qe),O.trigger("start "+qe.id+":start",qe),qe.show(),ve>0&&O.pressureFn(b,qe,qe.identifier),O.processOnMove(b)};if((I=O.idles.indexOf(_e))>=0&&O.idles.splice(I,1),O.actives.push(_e),O.ids.push(_e.identifier),Q.mode!=="semi")Ze(_e);else{if(!(h(Le,_e.position)<=Q.catchDistance))return _e.destroy(),void O.processOnStart(b);Ze(_e)}return _e},k.prototype.getOrCreate=function(b,I){var O,Q=this.options;return/(semi|static)/.test(Q.mode)?(O=this.idles[0])?(this.idles.splice(0,1),O):Q.mode==="semi"?this.createNipple(I,b):(console.warn("Coudln't find the needed nipple."),!1):O=this.createNipple(I,b)},k.prototype.processOnMove=function(b){var I=this.options,O=this.manager.getIdentifier(b),Q=this.nipples.get(O),J=this.manager.scroll;if(function(ye){return isNaN(ye.buttons)?ye.pressure!==0:ye.buttons!==0}(b)){if(!Q)return console.error("Found zombie joystick with ID "+O),void this.manager.removeIdentifier(O);if(I.dynamicPage){var ve=Q.el.getBoundingClientRect();Q.position={x:J.x+ve.left,y:J.y+ve.top}}Q.identifier=O;var Le=Q.options.size/2,_e={x:b.pageX,y:b.pageY};I.lockX&&(_e.y=Q.position.y),I.lockY&&(_e.x=Q.position.x);var Ze,qe,ft,Et,Bt,kt,jt,nn,Jn,kn,xn=h(_e,Q.position),Fn=(Ze=_e,qe=Q.position,ft=qe.x-Ze.x,Et=qe.y-Ze.y,a(Math.atan2(Et,ft))),Wn=v(Fn),Si=xn/Le,Zn={distance:xn,position:_e};if(Q.options.shape==="circle"?(Bt=Math.min(xn,Le),jt=Q.position,nn=Bt,kn={x:0,y:0},Jn=v(Jn=Fn),kn.x=jt.x-nn*Math.cos(Jn),kn.y=jt.y-nn*Math.sin(Jn),kt=kn):(kt=function(ye,Fe,Se){return{x:Math.min(Math.max(ye.x,Fe.x-Se),Fe.x+Se),y:Math.min(Math.max(ye.y,Fe.y-Se),Fe.y+Se)}}(_e,Q.position,Le),Bt=h(kt,Q.position)),I.follow){if(xn>Le){var Ui=_e.x-kt.x,Qi=_e.y-kt.y;Q.position.x+=Ui,Q.position.y+=Qi,Q.el.style.top=Q.position.y-(this.box.top+J.y)+"px",Q.el.style.left=Q.position.x-(this.box.left+J.x)+"px",xn=h(_e,Q.position)}}else _e=kt,xn=Bt;var Kn=_e.x-Q.position.x,Mt=_e.y-Q.position.y;Q.frontPosition={x:Kn,y:Mt},I.dataOnly||(Q.ui.front.style.transform="translate("+Kn+"px,"+Mt+"px)");var Ce={identifier:Q.identifier,position:_e,force:Si,pressure:b.force||b.pressure||b.webkitForce||0,distance:xn,angle:{radian:Wn,degree:Fn},vector:{x:Kn/Le,y:-Mt/Le},raw:Zn,instance:Q,lockX:I.lockX,lockY:I.lockY};(Ce=Q.computeDirection(Ce)).angle={radian:v(180-Fn),degree:180-Fn},Q.trigger("move",Ce),this.trigger("move "+Q.id+":move",Ce)}else this.processOnEnd(b)},k.prototype.processOnEnd=function(b){var I=this,O=I.options,Q=I.manager.getIdentifier(b),J=I.nipples.get(Q),ve=I.manager.removeIdentifier(J.identifier);J&&(O.dataOnly||J.hide(function(){O.mode==="dynamic"&&(J.trigger("removed",J),I.trigger("removed "+J.id+":removed",J),I.manager.trigger("removed "+J.id+":removed",J),J.destroy())}),clearInterval(I.pressureIntervals[J.identifier]),J.resetDirection(),J.trigger("end",J),I.trigger("end "+J.id+":end",J),I.ids.indexOf(J.identifier)>=0&&I.ids.splice(I.ids.indexOf(J.identifier),1),I.actives.indexOf(J)>=0&&I.actives.splice(I.actives.indexOf(J),1),/(semi|static)/.test(O.mode)?I.idles.push(J):I.nipples.indexOf(J)>=0&&I.nipples.splice(I.nipples.indexOf(J),1),I.manager.unbindDocument(),/(semi|static)/.test(O.mode)&&(I.manager.ids[ve.id]=ve.identifier))},k.prototype.onDestroyed=function(b,I){this.nipples.indexOf(I)>=0&&this.nipples.splice(this.nipples.indexOf(I),1),this.actives.indexOf(I)>=0&&this.actives.splice(this.actives.indexOf(I),1),this.idles.indexOf(I)>=0&&this.idles.splice(this.idles.indexOf(I),1),this.ids.indexOf(I.identifier)>=0&&this.ids.splice(this.ids.indexOf(I.identifier),1),this.manager.removeIdentifier(I.identifier),this.manager.unbindDocument()},k.prototype.destroy=function(){for(var b in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(I){I.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(b)&&clearInterval(this.pressureIntervals[b]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var oe=k;function ae(b){var I=this;I.ids={},I.index=0,I.collections=[],I.scroll=d(),I.config(b),I.prepareCollections();var O=function(){var J;I.collections.forEach(function(ve){ve.forEach(function(Le){J=Le.el.getBoundingClientRect(),Le.position={x:I.scroll.x+J.left,y:I.scroll.y+J.top}})})};l(window,"resize",function(){m(O)});var Q=function(){I.scroll=d()};return l(window,"scroll",function(){m(Q)}),I.collections}ae.prototype=new ne,ae.constructor=ae,ae.prototype.prepareCollections=function(){var b=this;b.collections.create=b.create.bind(b),b.collections.on=b.on.bind(b),b.collections.off=b.off.bind(b),b.collections.destroy=b.destroy.bind(b),b.collections.get=function(I){var O;return b.collections.every(function(Q){return!(O=Q.get(I))}),O}},ae.prototype.create=function(b){return this.createCollection(b)},ae.prototype.createCollection=function(b){var I=new oe(this,b);return this.bindCollection(I),this.collections.push(I),I},ae.prototype.bindCollection=function(b){var I,O=this,Q=function(J,ve){I=J.type+" "+ve.id+":"+J.type,O.trigger(I,ve)};b.on("destroyed",O.onDestroyed.bind(O)),b.on("shown hidden rested dir plain",Q),b.on("dir:up dir:right dir:down dir:left",Q),b.on("plain:up plain:right plain:down plain:left",Q)},ae.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},ae.prototype.unbindDocument=function(b){Object.keys(this.ids).length&&b!==!0||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},ae.prototype.getIdentifier=function(b){var I;return b?(I=b.identifier===void 0?b.pointerId:b.identifier)===void 0&&(I=this.latest||0):I=this.index,this.ids[I]===void 0&&(this.ids[I]=this.index,this.index+=1),this.latest=I,this.ids[I]},ae.prototype.removeIdentifier=function(b){var I={};for(var O in this.ids)if(this.ids[O]===b){I.id=O,I.identifier=this.ids[O],delete this.ids[O];break}return I},ae.prototype.onmove=function(b){return this.onAny("move",b),!1},ae.prototype.onend=function(b){return this.onAny("end",b),!1},ae.prototype.oncancel=function(b){return this.onAny("end",b),!1},ae.prototype.onAny=function(b,I){var O,Q=this,J="processOn"+b.charAt(0).toUpperCase()+b.slice(1);return I=g(I),L(I,function(ve){O=Q.getIdentifier(ve),L(Q.collections,(function(Le,_e,Ze){Ze.ids.indexOf(_e)>=0&&(Ze[J](Le),Le._found_=!0)}).bind(null,ve,O)),ve._found_||Q.removeIdentifier(O)}),!1},ae.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(b){b.destroy()}),this.off()},ae.prototype.onDestroyed=function(b,I){if(this.collections.indexOf(I)<0)return!1;this.collections.splice(this.collections.indexOf(I),1)};var Ae=new ae;A.default={create:function(b){return Ae.create(b)},factory:Ae}}]).default})},"./node_modules/three-pathfinding/dist/three-pathfinding.module.js":(W,$,A)=>{A.r($),A.d($,{Pathfinding:()=>a,PathfindingHelper:()=>f});var u=A("three");class w{static roundNumber(l,y){const g=Math.pow(10,y);return Math.round(l*g)/g}static sample(l){return l[Math.floor(Math.random()*l.length)]}static distanceToSquared(l,y){var g=l.x-y.x,d=l.y-y.y,p=l.z-y.z;return g*g+d*d+p*p}static isPointInPoly(l,y){for(var g=!1,d=-1,p=l.length,C=p-1;++d<p;C=d)(l[d].z<=y.z&&y.z<l[C].z||l[C].z<=y.z&&y.z<l[d].z)&&y.x<(l[C].x-l[d].x)*(y.z-l[d].z)/(l[C].z-l[d].z)+l[d].x&&(g=!g);return g}static isVectorInPolygon(l,y,g){var d=1e5,p=-1e5,C=[];return y.vertexIds.forEach(S=>{d=Math.min(g[S].y,d),p=Math.max(g[S].y,p),C.push(g[S])}),!!(l.y<p+.5&&l.y>d-.5&&this.isPointInPoly(C,l))}static triarea2(l,y,g){return(g.x-l.x)*(y.z-l.z)-(y.x-l.x)*(g.z-l.z)}static vequal(l,y){return this.distanceToSquared(l,y)<1e-5}static mergeVertices(l,y=1e-4){y=Math.max(y,Number.EPSILON);for(var g={},d=l.getIndex(),p=l.getAttribute("position"),C=d?d.count:p.count,S=0,_=[],L=[],T=Math.log10(1/y),N=Math.pow(10,T),F=0;F<C;F++){var te=d?d.getX(F):F,K="";K+=~~(p.getX(te)*N)+",",K+=~~(p.getY(te)*N)+",",(K+=~~(p.getZ(te)*N)+",")in g?_.push(g[K]):(L.push(p.getX(te)),L.push(p.getY(te)),L.push(p.getZ(te)),g[K]=S,_.push(S),S++)}const se=new u.BufferAttribute(new Float32Array(L),p.itemSize,p.normalized),ne=new u.BufferGeometry;return ne.setAttribute("position",se),ne.setIndex(_),ne}}class h{constructor(l){this.content=[],this.scoreFunction=l}push(l){this.content.push(l),this.sinkDown(this.content.length-1)}pop(){const l=this.content[0],y=this.content.pop();return this.content.length>0&&(this.content[0]=y,this.bubbleUp(0)),l}remove(l){const y=this.content.indexOf(l),g=this.content.pop();y!==this.content.length-1&&(this.content[y]=g,this.scoreFunction(g)<this.scoreFunction(l)?this.sinkDown(y):this.bubbleUp(y))}size(){return this.content.length}rescoreElement(l){this.sinkDown(this.content.indexOf(l))}sinkDown(l){const y=this.content[l];for(;l>0;){const g=(l+1>>1)-1,d=this.content[g];if(!(this.scoreFunction(y)<this.scoreFunction(d)))break;this.content[g]=y,this.content[l]=d,l=g}}bubbleUp(l){const y=this.content.length,g=this.content[l],d=this.scoreFunction(g);for(;;){const p=l+1<<1,C=p-1;let S,_=null;if(C<y&&(S=this.scoreFunction(this.content[C]),S<d&&(_=C)),p<y&&this.scoreFunction(this.content[p])<(_===null?d:S)&&(_=p),_===null)break;this.content[l]=this.content[_],this.content[_]=g,l=_}}}class v{constructor(){this.portals=[]}push(l,y){y===void 0&&(y=l),this.portals.push({left:l,right:y})}stringPull(){const l=this.portals,y=[];let g,d,p,C=0,S=0,_=0;g=l[0].left,d=l[0].left,p=l[0].right,y.push(g);for(let L=1;L<l.length;L++){const T=l[L].left,N=l[L].right;if(w.triarea2(g,p,N)<=0){if(!(w.vequal(g,p)||w.triarea2(g,d,N)>0)){y.push(d),g=d,C=S,d=g,p=g,S=C,_=C,L=C;continue}p=N,_=L}if(w.triarea2(g,d,T)>=0){if(!(w.vequal(g,d)||w.triarea2(g,p,T)<0)){y.push(p),g=p,C=_,d=g,p=g,S=C,_=C,L=C;continue}d=T,S=L}}return y.length!==0&&w.vequal(y[y.length-1],l[l.length-1].left)||y.push(l[l.length-1].left),this.path=y,y}}class a{constructor(){this.zones={}}static createZone(l,y=1e-4){return(class{static buildZone(g,d){const p=this._buildNavigationMesh(g,d),C={};p.vertices.forEach(_=>{_.x=w.roundNumber(_.x,2),_.y=w.roundNumber(_.y,2),_.z=w.roundNumber(_.z,2)}),C.vertices=p.vertices;const S=this._buildPolygonGroups(p);return C.groups=new Array(S.length),S.forEach((_,L)=>{const T=new Map;_.forEach((F,te)=>{T.set(F,te)});const N=new Array(_.length);_.forEach((F,te)=>{const K=[];F.neighbours.forEach(re=>K.push(T.get(re)));const se=[];F.neighbours.forEach(re=>se.push(this._getSharedVerticesInOrder(F,re)));const ne=new u.Vector3(0,0,0);ne.add(C.vertices[F.vertexIds[0]]),ne.add(C.vertices[F.vertexIds[1]]),ne.add(C.vertices[F.vertexIds[2]]),ne.divideScalar(3),ne.x=w.roundNumber(ne.x,2),ne.y=w.roundNumber(ne.y,2),ne.z=w.roundNumber(ne.z,2),N[te]={id:te,neighbours:K,vertexIds:F.vertexIds,centroid:ne,portals:se}}),C.groups[L]=N}),C}static _buildNavigationMesh(g,d){return g=w.mergeVertices(g,d),this._buildPolygonsFromGeometry(g)}static _spreadGroupId(g){let d=new Set([g]);for(;d.size>0;){const p=d;d=new Set,p.forEach(C=>{C.group=g.group,C.neighbours.forEach(S=>{S.group===void 0&&d.add(S)})})}}static _buildPolygonGroups(g){const d=[];return g.polygons.forEach(p=>{p.group!==void 0?d[p.group].push(p):(p.group=d.length,this._spreadGroupId(p),d.push([p]))}),d}static _buildPolygonNeighbours(g,d){const p=new Set,C=d[g.vertexIds[1]],S=d[g.vertexIds[2]];return d[g.vertexIds[0]].forEach(_=>{_!==g&&(C.includes(_)||S.includes(_))&&p.add(_)}),C.forEach(_=>{_!==g&&S.includes(_)&&p.add(_)}),p}static _buildPolygonsFromGeometry(g){const d=[],p=[],C=g.attributes.position,S=g.index,_=[];for(let L=0;L<C.count;L++)p.push(new u.Vector3().fromBufferAttribute(C,L)),_[L]=[];for(let L=0;L<g.index.count;L+=3){const T=S.getX(L),N=S.getX(L+1),F=S.getX(L+2),te={vertexIds:[T,N,F],neighbours:null};d.push(te),_[T].push(te),_[N].push(te),_[F].push(te)}return d.forEach(L=>{L.neighbours=this._buildPolygonNeighbours(L,_)}),{polygons:d,vertices:p}}static _getSharedVerticesInOrder(g,d){const p=g.vertexIds,C=p[0],S=p[1],_=p[2],L=d.vertexIds,T=L.includes(C),N=L.includes(S),F=L.includes(_);return T&&N&&F?Array.from(p):T&&N?[C,S]:N&&F?[S,_]:T&&F?[_,C]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}).buildZone(l,y)}setZoneData(l,y){this.zones[l]=y}getRandomNode(l,y,g,d){if(!this.zones[l])return new u.Vector3;g=g||null,d=d||0;const p=[];return this.zones[l].groups[y].forEach(C=>{g&&d?w.distanceToSquared(g,C.centroid)<d*d&&p.push(C.centroid):p.push(C.centroid)}),w.sample(p)||new u.Vector3}getClosestNode(l,y,g,d=!1){const p=this.zones[y].vertices;let C=null,S=1/0;return this.zones[y].groups[g].forEach(_=>{const L=w.distanceToSquared(_.centroid,l);L<S&&(!d||w.isVectorInPolygon(l,_,p))&&(C=_,S=L)}),C}findPath(l,y,g,d){const p=this.zones[g].groups[d],C=this.zones[g].vertices,S=this.getClosestNode(l,g,d,!0),_=this.getClosestNode(y,g,d,!0);if(!S||!_)return null;const L=(class{static init(te){for(let K=0;K<te.length;K++){const se=te[K];se.f=0,se.g=0,se.h=0,se.cost=1,se.visited=!1,se.closed=!1,se.parent=null}}static cleanUp(te){for(let K=0;K<te.length;K++){const se=te[K];delete se.f,delete se.g,delete se.h,delete se.cost,delete se.visited,delete se.closed,delete se.parent}}static heap(){return new h(function(te){return te.f})}static search(te,K,se){this.init(te);const ne=this.heap();for(ne.push(K);ne.size()>0;){const re=ne.pop();if(re===se){let k=re;const oe=[];for(;k.parent;)oe.push(k),k=k.parent;return this.cleanUp(oe),oe.reverse()}re.closed=!0;const Y=this.neighbours(te,re);for(let k=0,oe=Y.length;k<oe;k++){const ae=Y[k];if(ae.closed)continue;const Ae=re.g+ae.cost,b=ae.visited;if(!b||Ae<ae.g){if(ae.visited=!0,ae.parent=re,!ae.centroid||!se.centroid)throw new Error("Unexpected state");ae.h=ae.h||this.heuristic(ae.centroid,se.centroid),ae.g=Ae,ae.f=ae.g+ae.h,b?ne.rescoreElement(ae):ne.push(ae)}}}return[]}static heuristic(te,K){return w.distanceToSquared(te,K)}static neighbours(te,K){const se=[];for(let ne=0;ne<K.neighbours.length;ne++)se.push(te[K.neighbours[ne]]);return se}}).search(p,S,_),T=function(te,K){for(var se=0;se<te.neighbours.length;se++)if(te.neighbours[se]===K.id)return te.portals[se]},N=new v;N.push(l);for(let te=0;te<L.length;te++){const K=L[te],se=L[te+1];if(se){const ne=T(K,se);N.push(C[ne[0]],C[ne[1]])}}N.push(y),N.stringPull();const F=N.path.map(te=>new u.Vector3(te.x,te.y,te.z));return F.shift(),F}}a.prototype.getGroup=function(){const m=new u.Plane;return function(l,y,g=!1){if(!this.zones[l])return null;let d=null,p=Math.pow(50,2);const C=this.zones[l];for(let S=0;S<C.groups.length;S++){const _=C.groups[S];for(const L of _){if(g&&(m.setFromCoplanarPoints(C.vertices[L.vertexIds[0]],C.vertices[L.vertexIds[1]],C.vertices[L.vertexIds[2]]),Math.abs(m.distanceToPoint(y))<.01)&&w.isPointInPoly([C.vertices[L.vertexIds[0]],C.vertices[L.vertexIds[1]],C.vertices[L.vertexIds[2]]],y))return S;const T=w.distanceToSquared(L.centroid,y);T<p&&(d=S,p=T)}}return d}}(),a.prototype.clampStep=function(){const m=new u.Vector3,l=new u.Plane,y=new u.Triangle,g=new u.Vector3;let d,p,C=new u.Vector3;return function(S,_,L,T,N,F){const te=this.zones[T].vertices,K=this.zones[T].groups[N],se=[L],ne={};ne[L.id]=0,d=void 0,C.set(0,0,0),p=1/0,l.setFromCoplanarPoints(te[L.vertexIds[0]],te[L.vertexIds[1]],te[L.vertexIds[2]]),l.projectPoint(_,m),g.copy(m);for(let re=se.pop();re;re=se.pop()){y.set(te[re.vertexIds[0]],te[re.vertexIds[1]],te[re.vertexIds[2]]),y.closestPointToPoint(g,m),m.distanceToSquared(g)<p&&(d=re,C.copy(m),p=m.distanceToSquared(g));const Y=ne[re.id];if(!(Y>2))for(let k=0;k<re.neighbours.length;k++){const oe=K[re.neighbours[k]];oe.id in ne||(se.push(oe),ne[oe.id]=Y+1)}}return F.copy(C),d}}();class f extends u.Object3D{constructor(){super(),this._playerMarker=new u.Mesh(new u.SphereGeometry(.25,32,32),new u.MeshBasicMaterial({color:15631215})),this._targetMarker=new u.Mesh(new u.BoxGeometry(.3,.3,.3),new u.MeshBasicMaterial({color:14469912})),this._nodeMarker=new u.Mesh(new u.BoxGeometry(.1,.8,.1),new u.MeshBasicMaterial({color:4417387})),this._stepMarker=new u.Mesh(new u.BoxGeometry(.1,1,.1),new u.MeshBasicMaterial({color:14472114})),this._pathMarker=new u.Object3D,this._pathLineMaterial=new u.LineBasicMaterial({color:41903,linewidth:2}),this._pathPointMaterial=new u.MeshBasicMaterial({color:41903}),this._pathPointGeometry=new u.SphereGeometry(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(l=>{l.visible=!1,this.add(l)})}setPath(l){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);l=[this._playerMarker.position].concat(l);const y=new u.BufferGeometry;y.setAttribute("position",new u.BufferAttribute(new Float32Array(3*l.length),3));for(let g=0;g<l.length;g++)y.attributes.position.setXYZ(g,l[g].x,l[g].y+.2,l[g].z);this._pathMarker.add(new u.Line(y,this._pathLineMaterial));for(let g=0;g<l.length-1;g++){const d=new u.Mesh(this._pathPointGeometry,this._pathPointMaterial);d.position.copy(l[g]),d.position.y+=.2,this._pathMarker.add(d)}return this._pathMarker.visible=!0,this}setPlayerPosition(l){return this._playerMarker.position.copy(l),this._playerMarker.visible=!0,this}setTargetPosition(l){return this._targetMarker.position.copy(l),this._targetMarker.visible=!0,this}setNodePosition(l){return this._nodeMarker.position.copy(l),this._nodeMarker.visible=!0,this}setStepPosition(l){return this._stepMarker.position.copy(l),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(l=>{l.visible=!1}),this}}},"./src/controls/checkpoint-controls.js":W=>{W.exports=AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(A){const u=this.el;if(this.active&&this.checkpoint!==A){if(this.checkpoint&&u.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=A,this.sync(),this.position.distanceTo(this.targetPosition)<.1){this.checkpoint=null;return}u.emit("navigation-start",{checkpoint:A}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,u.emit("navigation-end",{checkpoint:A}),u.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const A=this.data,u=this.offset,w=this.position,h=this.targetPosition,v=this.checkpoint;return this.sync(),w.distanceTo(h)<.1?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:v}),u.set(0,0,0)):(u.setLength(A.animateSpeed),u)},sync:function(){const A=this.offset,u=this.position,w=this.targetPosition;u.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(w),w.add(this.checkpoint.components.checkpoint.getOffset()),A.copy(w).sub(u)}})},"./src/controls/gamepad-controls.js":(W,$,A)=>{const u=A("./lib/GamepadButton.js"),w=A("./lib/GamepadButtonEvent.js"),h=.2,v={LEFT:"left",RIGHT:"right"},a={MOVEMENT:1,ROTATION:2};W.exports=AFRAME.registerComponent("gamepad-controls",{GamepadButton:u,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){const f=this.el.sceneEl;this.system=f.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const m=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=m.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=m.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,f.addBehavior(this)},update:function(){this.tick()},tick:function(f,m){this.updateButtonState(),this.updateRotation(m)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const f=this._dpadVector,m=this._moveVector;this.getDpad(f),this.getJoystick(a.MOVEMENT,m);const l=f.x||m.x,y=f.y||m.y;return Math.abs(l)>h||Math.abs(y)>h},getVelocityDelta:function(){const f=this._dpadVector,m=this._moveVector;this.getDpad(f),this.getJoystick(a.MOVEMENT,m);const l=f.x||m.x,y=f.y||m.y,g=new THREE.Vector3;return Math.abs(l)>h&&(g.x+=l),Math.abs(y)>h&&(g.z+=y),g},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const f=this._lookVector;return this.getJoystick(a.ROTATION,f),Math.abs(f.x)>h||Math.abs(f.y)>h},updateRotation:function(f){if(!this.isRotationActive())return;const m=this.data,l=this.yaw,y=this.pitch;l.rotation.y=this.el.object3D.rotation.y,y.rotation.x=this.el.object3D.rotation.x;const g=this._lookVector;this.getJoystick(a.ROTATION,g),Math.abs(g.x)<=h&&(g.x=0),Math.abs(g.y)<=h&&(g.y=0),g.multiplyScalar(m.rotationSensitivity*f/1e3),l.rotation.y-=g.x,y.rotation.x-=g.y,y.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,y.rotation.x)),this.el.object3D.rotation.set(y.rotation.x,l.rotation.y,0)},updateButtonState:function(){const f=this.getGamepad(v.RIGHT);if(this.data.enabled&&f)for(var m=0;m<f.buttons.length;m++)f.buttons[m].pressed&&!this.buttons[m]?this.emit(new w("gamepadbuttondown",m,f.buttons[m])):!f.buttons[m].pressed&&this.buttons[m]&&this.emit(new w("gamepadbuttonup",m,f.buttons[m])),this.buttons[m]=f.buttons[m].pressed;else for(const l in this.buttons)this.buttons[l]=!1},emit:function(f){this.el.emit(f.type,f),this.el.emit(f.type+":"+f.index,new w(f.type,f.index,f))},getGamepad:function(){const f=[],m=[];return function(l){const y=this.el.sceneEl.components["proxy-controls"],g=y&&y.isConnected()&&y.getGamepad(0);if(g)return g;f.length=0;for(let p=0;p<this.system.controllers.length;p++){const C=this.system.controllers[p],S=C?C.gamepad:null;if(f.push(S),S&&C.handedness===l)return S}const d=navigator.getGamepads?navigator.getGamepads():m;for(let p=0;p<d.length;p++){const C=d[p];if(C&&C.hand===l)return C}return f[0]||d[0]}}(),getButton:function(f){return this.getGamepad(v.RIGHT).buttons[f]},getAxis:function(f){return this.getGamepad(f>1?v.RIGHT:v.LEFT).axes[f]},getJoystick:function(f,m){const l=this.getGamepad(f===a.MOVEMENT?v.LEFT:v.RIGHT);if(!l)return m.set(0,0);if(l.mapping==="xr-standard")switch(f){case a.MOVEMENT:return m.set(l.axes[2],l.axes[3]);case a.ROTATION:return m.set(l.axes[2],0)}else switch(f){case a.MOVEMENT:return m.set(l.axes[0],l.axes[1]);case a.ROTATION:return m.set(l.axes[2],l.axes[3])}throw new Error('Unexpected joystick index "%d".',f)},getDpad:function(f){const m=this.getGamepad(v.LEFT);return!m||!m.buttons[u.DPAD_RIGHT]?f.set(0,0):f.set((m.buttons[u.DPAD_RIGHT].pressed?1:0)+(m.buttons[u.DPAD_LEFT].pressed?-1:0),(m.buttons[u.DPAD_UP].pressed?-1:0)+(m.buttons[u.DPAD_DOWN].pressed?1:0))},isConnected:function(){const f=this.getGamepad(v.LEFT);return!!(f&&f.connected)},getID:function(){return this.getGamepad(v.LEFT).id}})},"./src/controls/index.js":(W,$,A)=>{A("./src/controls/checkpoint-controls.js"),A("./src/controls/gamepad-controls.js"),A("./src/controls/keyboard-controls.js"),A("./src/controls/touch-controls.js"),A("./src/controls/movement-controls.js"),A("./src/controls/trackpad-controls.js"),A("./src/controls/nipple-controls.js")},"./src/controls/keyboard-controls.js":(W,$,A)=>{A("./lib/keyboard.polyfill.js");const u="__keyboard-controls-proxy",w=window.KeyboardEvent;W.exports=AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const h=this.data,v=this.getKeys();return this.dVelocity.set(0,0,0),h.enabled&&((v.KeyW||v.ArrowUp)&&(this.dVelocity.z-=1),(v.KeyA||v.ArrowLeft)&&(this.dVelocity.x-=1),(v.KeyS||v.ArrowDown)&&(this.dVelocity.z+=1),(v.KeyD||v.ArrowRight)&&(this.dVelocity.x+=1),v.ShiftLeft&&(this.dVelocity=this.dVelocity.multiplyScalar(2))),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(const h in this.localKeys)this.localKeys.hasOwnProperty(h)&&delete this.localKeys[h]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(h){AFRAME.utils.shouldCaptureKeyEvent(h)&&(this.localKeys[h.code]=!0,this.emit(h))},onKeyUp:function(h){AFRAME.utils.shouldCaptureKeyEvent(h)&&(delete this.localKeys[h.code],this.emit(h))},onBlur:function(){for(const h in this.localKeys)this.localKeys.hasOwnProperty(h)&&delete this.localKeys[h]},emit:function(h){u in h&&this.el.emit(h.type,h),this.el.emit(h.type+":"+h.code,new w(h.type,h)),this.data.debug&&console.log(h.type+":"+h.code)},isPressed:function(h){return h in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const h=this.el.sceneEl.components["proxy-controls"];return h&&h.isConnected()}})},"./src/controls/movement-controls.js":W=>{const $="-controls",w="moved";W.exports=AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const h=this.el;this.data.camera||(this.data.camera=h.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.eventDetail={},this.navGroup=null,this.navNode=null,h.sceneEl.hasLoaded?this.injectControls():h.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(h){const v=this.el,a=this.data,f=v.sceneEl.systems.nav;if(v.sceneEl.hasLoaded&&this.injectControls(),f&&a.constrainToNavMesh!==h.constrainToNavMesh&&(a.constrainToNavMesh?f.addAgent(this):f.removeAgent(this)),a.enabled!==h.enabled)for(let m=0;m<a.controls.length;m++){const l=a.controls[m]+$;this.el.setAttribute(l,{enabled:this.data.enabled})}},injectControls:function(){const h=this.data;for(let v=0;v<h.controls.length;v++){const a=h.controls[v]+$;this.el.setAttribute(a,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const h=new THREE.Vector3,v=new THREE.Vector3,a=new THREE.Vector3;return function(f,m){if(!m)return;const l=this.el,y=this.data;if(!y.enabled)return;this.updateVelocityCtrl();const g=this.velocityCtrl,d=this.velocity;if(g)if(m/1e3>.2?d.set(0,0,0):this.updateVelocity(m),y.constrainToNavMesh&&g.isNavMeshConstrained!==!1){if(d.lengthSq()<1e-5)return;h.copy(l.object3D.position),v.copy(d).multiplyScalar(m/1e3).add(h);const p=l.sceneEl.systems.nav;this.navGroup=this.navGroup===null?p.getGroup(h):this.navGroup,this.navNode=this.navNode||p.getNode(h,this.navGroup),this.navNode=p.clampStep(h,v,this.navGroup,this.navNode,a),l.object3D.position.copy(a)}else l.hasAttribute("velocity")?l.setAttribute("velocity",d):(l.object3D.position.x+=d.x*m/1e3,l.object3D.position.y+=d.y*m/1e3,l.object3D.position.z+=d.z*m/1e3)}}(),updateVelocityCtrl:function(){const h=this.data;if(h.enabled){for(let v=0,a=h.controls.length;v<a;v++){const f=this.el.components[h.controls[v]+$];if(f&&f.isVelocityActive()){this.velocityCtrl=f;return}}this.velocityCtrl=null}},updateVelocity:function(){const h=new THREE.Vector2,v=new THREE.Quaternion;return function(a){let f;const m=this.el,l=this.velocityCtrl,y=this.velocity,g=this.data;if(l)if(l.getVelocityDelta)f=l.getVelocityDelta(a);else if(l.getVelocity){y.copy(l.getVelocity());return}else if(l.getPositionDelta){y.copy(l.getPositionDelta(a).multiplyScalar(1e3/a));return}else throw new Error("Incompatible movement controls: ",l);if(m.hasAttribute("velocity")&&!g.constrainToNavMesh&&y.copy(this.el.getAttribute("velocity")),f&&g.enabled){const d=g.camera;v.copy(d.object3D.quaternion),v.premultiply(m.object3D.quaternion),f.applyQuaternion(v);const p=f.length();g.fly?(y.copy(f),y.multiplyScalar(this.data.speed*16.66667)):(h.set(f.x,f.z),h.setLength(p*this.data.speed*16.66667),y.x=h.x,y.y=0,y.z=h.y),(y.x!==0||y.y!==0||y.z!==0)&&(this.eventDetail.velocity=y,this.el.emit(w,this.eventDetail))}}}()})},"./src/controls/nipple-controls.js":(W,$,A)=>{A.r($);var u=A("./node_modules/nipplejs/dist/nipplejs.js"),w=A.n(u);AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;const h=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=h.pitchObject,this.yawObject=h.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update(h){(this.data.moveJoystickPosition!==h.moveJoystickPosition||this.data.sideMargin!==h.sideMargin||this.data.bottomMargin!==h.bottomMargin||this.data.mode!==h.mode)&&this.removeMoveJoystick(),(this.data.lookJoystickPosition!==h.lookJoystickPosition||this.data.sideMargin!==h.sideMargin||this.data.bottomMargin!==h.bottomMargin||this.data.mode!==h.mode)&&this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause(){this.moving=!1,this.rotating=!1},remove(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive(){return this.data.enabled&&this.moving},getVelocityDelta(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){const h=this.moveData.force<1?this.moveData.force:1,v=this.moveData.angle.radian,a=Math.cos(v)*h,f=-Math.sin(v)*h;this.dVelocity.set(a,0,f)}return this.dVelocity},isRotationActive(){return this.data.enabled&&this.rotating},updateRotation(h){if(!this.isRotationActive())return;const v=this.lookData.force<1?this.lookData.force:1,a=this.lookData.angle.radian,f=this.lookVector;f.x=Math.cos(a)*v,f.y=Math.sin(a)*v,f.multiplyScalar(this.data.rotationSensitivity*h/1e3),this.yawObject.rotation.y-=f.x;let m=this.pitchObject.rotation.x+f.y;m=Math.max(-Math.PI/2,Math.min(Math.PI/2,m)),this.pitchObject.rotation.x=m},tick:function(h,v){this.updateRotation(v)},initLeftZone(){const h=document.createElement("div");h.setAttribute("id","joystickLeftZone"),h.setAttribute("style",`position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(h),this.leftZone=h},initRightZone(){const h=document.createElement("div");h.setAttribute("id","joystickRightZone"),h.setAttribute("style",`position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(h),this.rightZone=h},createMoveJoystick(){if(this.moveJoystick)return;this.initLeftZone();const h={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",h.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=w().create(h),this.moveJoystick.on("move",(v,a)=>{this.moveData=a,this.moving=!0}),this.moveJoystick.on("end",(v,a)=>{this.moving=!1})},createLookJoystick(){if(this.lookJoystick)return;this.initRightZone();const h={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",h.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=w().create(h),this.lookJoystick.on("move",(v,a)=>{this.lookData=a,this.rotating=!0}),this.lookJoystick.on("end",(v,a)=>{this.rotating=!1})},removeMoveJoystick(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}})},"./src/controls/touch-controls.js":W=>{W.exports=AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const $=this.el.sceneEl,A=$.canvas;if(!A){$.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}A.addEventListener("touchstart",this.onTouchStart,{passive:!0}),A.addEventListener("touchend",this.onTouchEnd,{passive:!0});const u=$.getAttribute("vr-mode-ui");u&&u.cardboardModeEnabled&&$.addEventListener("enter-vr",this.onEnterVR)},removeEventListeners:function(){const $=this.el.sceneEl&&this.el.sceneEl.canvas;$&&($.removeEventListener("touchstart",this.onTouchStart),$.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function($){this.direction=-1,this.data.reverseEnabled&&$.touches&&$.touches.length===2&&(this.direction=1),$.preventDefault()},onTouchEnd:function($){this.direction=0,$.preventDefault()},onEnterVR:function(){const $=this.el.sceneEl.xrSession;$&&($.addEventListener("selectstart",this.onTouchStart),$.addEventListener("selectend",this.onTouchEnd))}})},"./src/controls/trackpad-controls.js":W=>{W.exports=AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const $=this.data,A=this.el.sceneEl;switch(A.addEventListener("axismove",this.onAxisMove),$.mode){case"swipe":case"touch":A.addEventListener("trackpadtouchstart",this.onTouchStart),A.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":A.addEventListener("trackpaddown",this.onTouchStart),A.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const $=this.el.sceneEl;$.removeEventListener("axismove",this.onAxisMove),$.removeEventListener("trackpadtouchstart",this.onTouchStart),$.removeEventListener("trackpadtouchend",this.onTouchEnd),$.removeEventListener("trackpaddown",this.onTouchStart),$.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function($){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}$.preventDefault()},onTouchEnd:function($){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,$.preventDefault()},onAxisMove:function($){switch(this.data.mode){case"swipe":return this.handleSwipeAxis($);case"touch":case"press":return this.handleTouchAxis($)}},handleSwipeAxis:function($){const A=this.data,u=$.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=u[0],this.startingAxisData[1]=u[1]),this.startingAxisData.length>0){let w=0,h=0;A.enableNegX&&u[0]<this.startingAxisData[0]&&(w=-1),A.enablePosX&&u[0]>this.startingAxisData[0]&&(w=1),A.enablePosZ&&u[1]>this.startingAxisData[1]&&(h=-1),A.enableNegZ&&u[1]<this.startingAxisData[1]&&(h=1);const v=Math.abs(this.startingAxisData[1]-u[1]);Math.abs(this.startingAxisData[0]-u[0])>v?(this.zVel=0,this.xVel=w,this.isMoving=!0):(this.xVel=0,this.zVel=h,this.isMoving=!0)}},handleTouchAxis:function($){const A=this.data,u=$.detail.axis;let w=0,h=0;A.enableNegX&&u[0]<0&&(w=-1),A.enablePosX&&u[0]>0&&(w=1),A.enablePosZ&&u[1]>0&&(h=-1),A.enableNegZ&&u[1]<0&&(h=1),Math.abs(u[0])>Math.abs(u[1])?(this.zVel=0,this.xVel=w):(this.xVel=0,this.zVel=h)}})},"./src/loaders/animation-mixer.js":W=>{const $={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};W.exports=AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys($)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const w=this.el.getObject3D("mesh");w?this.load(w):this.el.addEventListener("model-loaded",h=>{this.load(h.detail.model)})},load:function(w){const h=this.el;this.model=w,this.mixer=new THREE.AnimationMixer(w),this.mixer.addEventListener("loop",v=>{h.emit("animation-loop",{action:v.action,loopDelta:v.loopDelta})}),this.mixer.addEventListener("finished",v=>{h.emit("animation-finished",{action:v.action,direction:v.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(w){if(!w)return;const h=this.data,v=AFRAME.utils.diff(h,w);if("clip"in v){this.stopAction(),h.clip&&this.playAction();return}this.activeActions.forEach(a=>{"duration"in v&&h.duration&&a.setDuration(h.duration),"clampWhenFinished"in v&&(a.clampWhenFinished=h.clampWhenFinished),("loop"in v||"repetitions"in v)&&a.setLoop($[h.loop],h.repetitions),"timeScale"in v&&a.setEffectiveTimeScale(h.timeScale)})},stopAction:function(){const w=this.data;for(let h=0;h<this.activeActions.length;h++)w.crossFadeDuration?this.activeActions[h].fadeOut(w.crossFadeDuration):this.activeActions[h].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const w=this.model,h=this.data,v=w.animations||(w.geometry||{}).animations||[];if(!v.length)return;const a=h.useRegExp?h.clip:A(h.clip);for(let f,m=0;f=v[m];m++)if(f.name.match(a)){const l=this.mixer.clipAction(f,w);l.enabled=!0,l.clampWhenFinished=h.clampWhenFinished,h.duration&&l.setDuration(h.duration),h.timeScale!==1&&l.setEffectiveTimeScale(h.timeScale),l.startAt(this.mixer.time-h.startAt/1e3),l.setLoop($[h.loop],h.repetitions).fadeIn(h.crossFadeDuration).play(),this.activeActions.push(l)}},tick:function(w,h){this.mixer&&!isNaN(h)&&this.mixer.update(h/1e3)}});function A(w){return new RegExp("^"+w.split(/\*+/).map(u).join(".*")+"$")}function u(w){return w.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}},"./src/loaders/collada-model-legacy.js":(W,$,A)=>{THREE.ColladaLoader=A("./lib/ColladaLoader.js"),W.exports.Component=AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var u=this,w=this.el,h=this.data,v=this.el.sceneEl.systems.renderer;h&&(this.remove(),this.loader.load(h,function(a){u.model=a.scene,u.model.traverse(function(f){if(f.isMesh){var m=f.material;m.color&&v.applyColorCorrection(m.color),m.map&&v.applyColorCorrection(m.map),m.emissive&&v.applyColorCorrection(m.emissive),m.emissiveMap&&v.applyColorCorrection(m.emissiveMap)}}),w.setObject3D("mesh",u.model),w.emit("model-loaded",{format:"collada",model:u.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/loaders/fbx-model.js":(W,$,A)=>{A.r($);var u=A("./node_modules/three/examples/jsm/loaders/FBXLoader.js");THREE.FBXLoader=u.FBXLoader,AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const w=this.data;if(!w.src)return;this.remove();const h=new THREE.FBXLoader;w.crossorigin&&h.setCrossOrigin(w.crossorigin),h.load(w.src,this.load.bind(this))},load:function(w){this.model=w,this.el.setObject3D("mesh",w),this.el.emit("model-loaded",{format:"fbx",model:w})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/loaders/gltf-model-legacy.js":(W,$,A)=>{const u=A("./lib/fetch-script.js")(),w="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",h=function(){let v;return function(){return v=v||u(w),v}}();W.exports=AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=h().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const v=this,a=this.el,f=this.data;f&&(this.remove(),this.loaderPromise.then(()=>{this.loader.load(f,function(l){v.model=l.scene,v.model.animations=l.animations,a.setObject3D("mesh",v.model),a.emit("model-loaded",{format:"gltf",model:v.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/loaders/index.js":(W,$,A)=>{A("./src/loaders/animation-mixer.js"),A("./src/loaders/collada-model-legacy.js"),A("./src/loaders/fbx-model.js"),A("./src/loaders/gltf-model-legacy.js"),A("./src/loaders/object-model.js")},"./src/loaders/object-model.js":W=>{W.exports=AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let $;const A=this.data;A.src&&(this.remove(),$=new THREE.ObjectLoader,A.crossorigin&&$.setCrossOrigin(A.crossorigin),$.load(A.src,u=>{u.traverse(w=>{w instanceof THREE.SkinnedMesh&&w.material&&(w.material.skinning=!!(w.geometry&&w.geometry.bones||[]).length)}),this.load(u)}))},load:function($){this.model=$,this.el.setObject3D("mesh",$),this.el.emit("model-loaded",{format:"json",model:$})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/misc/checkpoint.js":W=>{W.exports=AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const $=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!$)throw new Error("No `checkpoint-controls` component found.");$.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}})},"./src/misc/cube-env-map.js":W=>{function $(u){return u?Array.isArray(u)?u:u.materials?u.materials:[u]:[]}function A(u,w,h,v){u&&(w=w||[],u.traverse(a=>{if(!a.isMesh)return;$(a.material).forEach(m=>{m&&!("envMap"in m)||w.length&&w.indexOf(m.name)===-1||(m.envMap=h,m.reflectivity=v,m.needsUpdate=!0)})}))}W.exports=AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const u=this.data;this.texture=new THREE.CubeTextureLoader().load([u.path+"posx."+u.extension,u.path+"negx."+u.extension,u.path+"posy."+u.extension,u.path+"negy."+u.extension,u.path+"posz."+u.extension,u.path+"negz."+u.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{const w=this.el.getObject3D("mesh"),h=this.data;A(w,h.materials,this.texture,h.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(u){const w=this.data,h=this.el.getObject3D("mesh");let v=[],a=[];if(w.materials.length&&(u.materials?(v=w.materials.filter(f=>!u.materials.includes(f)),a=u.materials.filter(f=>!w.materials.includes(f))):v=w.materials),v.length&&A(h,v,this.texture,w.reflectivity),a.length&&A(h,a,null,1),u.materials&&w.reflectivity!==u.reflectivity){const f=w.materials.filter(m=>u.materials.includes(m));f.length&&A(h,f,this.texture,w.reflectivity)}this.data.enableBackground&&!u.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&u.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const u=this.el.getObject3D("mesh"),w=this.data;A(u,w.materials,null,1),w.enableBackground&&this.setBackground(null)},setBackground:function(u){this.el.sceneEl.object3D.background=u}})},"./src/misc/grab.js":W=>{W.exports=AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const $=this.el;$.addEventListener("hit",this.onHit),$.addEventListener("gripdown",this.onGripClose),$.addEventListener("gripup",this.onGripOpen),$.addEventListener("trackpaddown",this.onGripClose),$.addEventListener("trackpadup",this.onGripOpen),$.addEventListener("triggerdown",this.onGripClose),$.addEventListener("triggerup",this.onGripOpen)},pause:function(){const $=this.el;$.removeEventListener("hit",this.onHit),$.removeEventListener("gripdown",this.onGripClose),$.removeEventListener("gripup",this.onGripOpen),$.removeEventListener("trackpaddown",this.onGripClose),$.removeEventListener("trackpadup",this.onGripOpen),$.removeEventListener("triggerdown",this.onGripClose),$.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const $=this.hitEl;this.grabbing=!1,$&&($.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function($){const A=$.detail.el;A.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(A.addState(this.GRABBED_STATE),this.hitEl=A,this.constraint=new CANNON.LockConstraint(this.el.body,A.body),this.system.addConstraint(this.constraint))}})},"./src/misc/index.js":(W,$,A)=>{A("./src/misc/checkpoint.js"),A("./src/misc/cube-env-map.js"),A("./src/misc/grab.js"),A("./src/misc/normal-material.js"),A("./src/misc/sphere-collider.js")},"./src/misc/normal-material.js":W=>{W.exports=AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse($=>{$.isMesh&&($.material=this.material)})}})},"./src/misc/sphere-collider.js":W=>{W.exports=AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){const A=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(A,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const A=this.data;let u;A.objects?u=this.el.sceneEl.querySelectorAll(A.objects):u=this.el.sceneEl.children,this.els=Array.prototype.slice.call(u)},tick:function(){const A=new THREE.Vector3,u=new THREE.Vector3,w=new THREE.Vector3,h=new THREE.Vector3,v=new THREE.Box3,a=[],f=new Map;return function(m){if(!this.data.enabled)return;const l=this.prevCheckTime;if(l&&m-l<this.data.interval)return;this.prevCheckTime=m;const y=this.el,g=this.data,d=y.getObject3D("mesh");let p;if(!d)return;a.length=0,f.clear(),y.object3D.getWorldPosition(A),y.object3D.getWorldScale(w),p=g.radius*S(w),this.els.forEach(C),a.sort((_,L)=>f.get(_)>f.get(L)?1:-1).forEach(this.handleHit),this.collisions.filter(_=>!f.has(_)).forEach(this.handleHitEnd),$(this.collisions,a);function C(_){let L,T,N,F;_.isEntity&&(T=_.getObject3D("mesh"),T&&(v.setFromObject(T).getSize(h),F=Math.max(h.x,h.y,h.z)/2,L=Math.sqrt(2*F*F),v.getCenter(u),L&&(N=A.distanceTo(u),N<L+p&&(a.push(_),f.set(_,N)))))}function S(_){return Math.max(_.x,_.y,_.z)}}}(),handleHit:function(A){A.emit("hit"),A.addState(this.data.state),this.eventDetail.el=A,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(A){A.emit("hitend"),A.removeState(this.data.state),this.eventDetail.el=A,this.el.emit("hitend",this.eventDetail)}});function $(A,u){A.length=0;for(let w=0;w<u.length;w++)A[w]=u[w]}},"./src/pathfinding/index.js":(W,$,A)=>{A("./src/pathfinding/nav-mesh.js"),A("./src/pathfinding/nav-agent.js"),A("./src/pathfinding/system.js")},"./src/pathfinding/nav-agent.js":W=>{W.exports=AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const $=new THREE.Vector3,A=new THREE.Vector3,u=new THREE.Vector3;return function(w,h){const v=this.el,a=this.data,f=this.raycaster,m=a.speed*h/1e3;if(!a.active)return;if(!this.path.length){const C=this.el.object3D.position;this.group=this.group||this.system.getGroup(C),this.path=this.system.getPath(C,$.copy(a.destination),this.group)||[],v.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",a.destination),this.el.setAttribute("nav-agent",{active:!1}),v.emit("navigation-end");return}const l=v.object3D.position,y=this.path[0];A.subVectors(y,l);const g=A.length();let d;if(g<m){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),v.emit("navigation-end");return}u.copy(l),d=this.path[0]}else u.copy(A.setLength(m)).add(l),d=y;d.y=l.y,v.object3D.lookAt(d),f.ray.origin.copy(u),f.ray.origin.y+=1.5,f.ray.direction={x:0,y:-1,z:0};const p=f.intersectObject(this.system.getNavMesh());p.length?(A.subVectors(p[0].point,l),l.add(A.setLength(m))):l.copy(u)}}()})},"./src/pathfinding/nav-mesh.js":W=>{W.exports=AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var $=this;const A=this.el.getObject3D("mesh");if(this.el.sceneEl.object3D,!A)return;let u;if(A.traverse(h=>{h.isMesh&&(!$.nodeName||h.name===$.nodeName)&&(u=h)}),!u)return;const w=u.geometry.clone();u.updateWorldMatrix(!0,!1),w.applyMatrix4(u.matrixWorld),this.system.setNavMeshGeometry(w),this.hasLoadedNavMesh=!0}})},"./src/pathfinding/system.js":(W,$,A)=>{const{Pathfinding:u}=A("./node_modules/three-pathfinding/dist/three-pathfinding.module.js"),w=new u,h="level";W.exports=AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(v){this.navMesh=new THREE.Mesh(v),w.setZoneData(h,u.createZone(v)),Array.from(this.agents).forEach(a=>a.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(v){this.agents.add(v)},removeAgent:function(v){this.agents.delete(v)},getPath:function(v,a,f){return this.navMesh?w.findPath(v,a,h,f):null},getGroup:function(v){return this.navMesh?w.getGroup(h,v):null},getNode:function(v,a){return this.navMesh?w.getClosestNode(v,h,a,!0):null},clampStep:function(v,a,f,m,l){if(this.navMesh){if(!m)return l.copy(a),this.getNode(a,f)}else return l.copy(a),null;return w.clampStep(v,a,m,h,f,l)}})},"./src/primitives/a-grid.js":W=>{W.exports=AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}})},"./src/primitives/a-ocean.js":W=>{W.exports.Primitive=AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}}),W.exports.Component=AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const $=this.el,A=this.data;let u=$.components.material;const w=new THREE.PlaneGeometry(A.width,A.depth,A.density,A.density);this.waves=[];const h=w.getAttribute("position");for(let v=0;v<h.count;v++)this.waves.push({z:h.getZ(v),ang:Math.random()*Math.PI*2,amp:A.amplitude+Math.random()*A.amplitudeVariance,speed:(A.speed+Math.random()*A.speedVariance)/1e3});u||(u={},u.material=new THREE.MeshPhongMaterial({color:A.color,transparent:A.opacity<1,opacity:A.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(w,u.material),$.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function($,A){if(!A)return;const u=this.mesh.geometry.getAttribute("position");for(let w=0;w<u.count;w++){const h=this.waves[w],v=h.z+Math.sin(h.ang)*h.amp;u.setZ(w,v),h.ang+=h.speed*A}u.needsUpdate=!0}})},"./src/primitives/a-tube.js":W=>{W.exports.Primitive=AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}}),W.exports.Component=AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const $=this.el,A=this.data;let u=$.components.material;if(!A.path.length){console.error("[a-tube] `path` property expected but not found.");return}const w=new THREE.CatmullRomCurve3(A.path.map(function(v){return v=v.split(" "),new THREE.Vector3(Number(v[0]),Number(v[1]),Number(v[2]))})),h=new THREE.TubeGeometry(w,A.segments,A.radius,A.radialSegments,A.closed);u||(u={},u.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(h,u.material),this.el.setObject3D("mesh",this.mesh)},update:function($){Object.keys($).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}})},"./src/primitives/index.js":(W,$,A)=>{A("./src/primitives/a-grid.js"),A("./src/primitives/a-ocean.js"),A("./src/primitives/a-tube.js")},three:W=>{W.exports=na},"./node_modules/three/examples/jsm/curves/NURBSCurve.js":(W,$,A)=>{A.r($),A.d($,{NURBSCurve:()=>h});var u=A("three"),w=A("./node_modules/three/examples/jsm/curves/NURBSUtils.js");class h extends u.Curve{constructor(a,f,m,l,y){super(),this.degree=a,this.knots=f,this.controlPoints=[],this.startKnot=l||0,this.endKnot=y||this.knots.length-1;for(let g=0;g<m.length;++g){const d=m[g];this.controlPoints[g]=new u.Vector4(d.x,d.y,d.z,d.w)}}getPoint(a,f=new u.Vector3){const m=f,l=this.knots[this.startKnot]+a*(this.knots[this.endKnot]-this.knots[this.startKnot]),y=w.calcBSplinePoint(this.degree,this.knots,this.controlPoints,l);return y.w!==1&&y.divideScalar(y.w),m.set(y.x,y.y,y.z)}getTangent(a,f=new u.Vector3){const m=f,l=this.knots[0]+a*(this.knots[this.knots.length-1]-this.knots[0]),y=w.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,l,1);return m.copy(y[1]).normalize(),m}}},"./node_modules/three/examples/jsm/curves/NURBSUtils.js":(W,$,A)=>{A.r($),A.d($,{calcBSplineDerivatives:()=>f,calcBSplinePoint:()=>v,calcBasisFunctionDerivatives:()=>a,calcBasisFunctions:()=>h,calcKoverI:()=>m,calcNURBSDerivatives:()=>y,calcRationalCurveDerivatives:()=>l,calcSurfacePoint:()=>g,calcVolumePoint:()=>d,findSpan:()=>w});var u=A("three");function w(p,C,S){const _=S.length-p-1;if(C>=S[_])return _-1;if(C<=S[p])return p;let L=p,T=_,N=Math.floor((L+T)/2);for(;C<S[N]||C>=S[N+1];)C<S[N]?T=N:L=N,N=Math.floor((L+T)/2);return N}function h(p,C,S,_){const L=[],T=[],N=[];L[0]=1;for(let F=1;F<=S;++F){T[F]=C-_[p+1-F],N[F]=_[p+F]-C;let te=0;for(let K=0;K<F;++K){const se=N[K+1],ne=T[F-K],re=L[K]/(se+ne);L[K]=te+se*re,te=ne*re}L[F]=te}return L}function v(p,C,S,_){const L=w(p,_,C),T=h(L,_,p,C),N=new u.Vector4(0,0,0,0);for(let F=0;F<=p;++F){const te=S[L-p+F],K=T[F],se=te.w*K;N.x+=te.x*se,N.y+=te.y*se,N.z+=te.z*se,N.w+=te.w*K}return N}function a(p,C,S,_,L){const T=[];for(let ne=0;ne<=S;++ne)T[ne]=0;const N=[];for(let ne=0;ne<=_;++ne)N[ne]=T.slice(0);const F=[];for(let ne=0;ne<=S;++ne)F[ne]=T.slice(0);F[0][0]=1;const te=T.slice(0),K=T.slice(0);for(let ne=1;ne<=S;++ne){te[ne]=C-L[p+1-ne],K[ne]=L[p+ne]-C;let re=0;for(let Y=0;Y<ne;++Y){const k=K[Y+1],oe=te[ne-Y];F[ne][Y]=k+oe;const ae=F[Y][ne-1]/F[ne][Y];F[Y][ne]=re+k*ae,re=oe*ae}F[ne][ne]=re}for(let ne=0;ne<=S;++ne)N[0][ne]=F[ne][S];for(let ne=0;ne<=S;++ne){let re=0,Y=1;const k=[];for(let oe=0;oe<=S;++oe)k[oe]=T.slice(0);k[0][0]=1;for(let oe=1;oe<=_;++oe){let ae=0;const Ae=ne-oe,b=S-oe;ne>=oe&&(k[Y][0]=k[re][0]/F[b+1][Ae],ae=k[Y][0]*F[Ae][b]);const I=Ae>=-1?1:-Ae,O=ne-1<=b?oe-1:S-ne;for(let J=I;J<=O;++J)k[Y][J]=(k[re][J]-k[re][J-1])/F[b+1][Ae+J],ae+=k[Y][J]*F[Ae+J][b];ne<=b&&(k[Y][oe]=-k[re][oe-1]/F[b+1][ne],ae+=k[Y][oe]*F[ne][b]),N[oe][ne]=ae;const Q=re;re=Y,Y=Q}}let se=S;for(let ne=1;ne<=_;++ne){for(let re=0;re<=S;++re)N[ne][re]*=se;se*=S-ne}return N}function f(p,C,S,_,L){const T=L<p?L:p,N=[],F=w(p,_,C),te=a(F,_,p,T,C),K=[];for(let se=0;se<S.length;++se){const ne=S[se].clone(),re=ne.w;ne.x*=re,ne.y*=re,ne.z*=re,K[se]=ne}for(let se=0;se<=T;++se){const ne=K[F-p].clone().multiplyScalar(te[se][0]);for(let re=1;re<=p;++re)ne.add(K[F-p+re].clone().multiplyScalar(te[se][re]));N[se]=ne}for(let se=T+1;se<=L+1;++se)N[se]=new u.Vector4(0,0,0);return N}function m(p,C){let S=1;for(let L=2;L<=p;++L)S*=L;let _=1;for(let L=2;L<=C;++L)_*=L;for(let L=2;L<=p-C;++L)_*=L;return S/_}function l(p){const C=p.length,S=[],_=[];for(let T=0;T<C;++T){const N=p[T];S[T]=new u.Vector3(N.x,N.y,N.z),_[T]=N.w}const L=[];for(let T=0;T<C;++T){const N=S[T].clone();for(let F=1;F<=T;++F)N.sub(L[T-F].clone().multiplyScalar(m(T,F)*_[F]));L[T]=N.divideScalar(_[0])}return L}function y(p,C,S,_,L){const T=f(p,C,S,_,L);return l(T)}function g(p,C,S,_,L,T,N,F){const te=w(p,T,S),K=w(C,N,_),se=h(te,T,p,S),ne=h(K,N,C,_),re=[];for(let k=0;k<=C;++k){re[k]=new u.Vector4(0,0,0,0);for(let oe=0;oe<=p;++oe){const ae=L[te-p+oe][K-C+k].clone(),Ae=ae.w;ae.x*=Ae,ae.y*=Ae,ae.z*=Ae,re[k].add(ae.multiplyScalar(se[oe]))}}const Y=new u.Vector4(0,0,0,0);for(let k=0;k<=C;++k)Y.add(re[k].multiplyScalar(ne[k]));Y.divideScalar(Y.w),F.set(Y.x,Y.y,Y.z)}function d(p,C,S,_,L,T,N,F,te,K,se){const ne=w(p,F,_),re=w(C,te,L),Y=w(S,K,T),k=h(ne,F,p,_),oe=h(re,te,C,L),ae=h(Y,K,S,T),Ae=[];for(let I=0;I<=S;++I){Ae[I]=[];for(let O=0;O<=C;++O){Ae[I][O]=new u.Vector4(0,0,0,0);for(let Q=0;Q<=p;++Q){const J=N[ne-p+Q][re-C+O][Y-S+I].clone(),ve=J.w;J.x*=ve,J.y*=ve,J.z*=ve,Ae[I][O].add(J.multiplyScalar(k[Q]))}}}const b=new u.Vector4(0,0,0,0);for(let I=0;I<=S;++I)for(let O=0;O<=C;++O)b.add(Ae[I][O].multiplyScalar(ae[I]).multiplyScalar(oe[O]));b.divideScalar(b.w),se.set(b.x,b.y,b.z)}},"./node_modules/three/examples/jsm/libs/fflate.module.js":(W,$,A)=>{A.r($),A.d($,{AsyncCompress:()=>Sr,AsyncDecompress:()=>tn,AsyncDeflate:()=>Ti,AsyncGunzip:()=>fs,AsyncGzip:()=>Sr,AsyncInflate:()=>Or,AsyncUnzipInflate:()=>_t,AsyncUnzlib:()=>lt,AsyncZipDeflate:()=>et,AsyncZlib:()=>Ie,Compress:()=>Fr,DecodeUTF8:()=>pi,Decompress:()=>yn,Deflate:()=>bi,EncodeUTF8:()=>Wi,FlateErrorCode:()=>I,Gunzip:()=>sr,Gzip:()=>Fr,Inflate:()=>$n,Unzip:()=>Cn,UnzipInflate:()=>Nt,UnzipPassThrough:()=>yt,Unzlib:()=>At,Zip:()=>It,ZipDeflate:()=>Ke,ZipPassThrough:()=>Me,Zlib:()=>es,compress:()=>ir,compressSync:()=>Li,decompress:()=>bt,decompressSync:()=>Rn,deflate:()=>Oi,deflateSync:()=>Mr,gunzip:()=>Ur,gunzipSync:()=>os,gzip:()=>ir,gzipSync:()=>Li,inflate:()=>dr,inflateSync:()=>Er,strFromU8:()=>on,strToU8:()=>Vi,unzip:()=>he,unzipSync:()=>Ee,unzlib:()=>wt,unzlibSync:()=>Ft,zip:()=>St,zipSync:()=>it,zlib:()=>Ge,zlibSync:()=>tt});/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var u={},w=function(R,M,Z,fe,Oe){var Qe=new Worker(u[M]||(u[M]=URL.createObjectURL(new Blob([R+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return Qe.onmessage=function(Je){var Xe=Je.data,ht=Xe.$e$;if(ht){var ct=new Error(ht[0]);ct.code=ht[1],ct.stack=ht[2],Oe(ct,null)}else Oe(null,Xe)},Qe.postMessage(Z,fe),Qe},h=Uint8Array,v=Uint16Array,a=Int32Array,f=new h([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),m=new h([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l=new h([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),y=function(R,M){for(var Z=new v(31),fe=0;fe<31;++fe)Z[fe]=M+=1<<R[fe-1];for(var Oe=new a(Z[30]),fe=1;fe<30;++fe)for(var Qe=Z[fe];Qe<Z[fe+1];++Qe)Oe[Qe]=Qe-Z[fe]<<5|fe;return{b:Z,r:Oe}},g=y(f,2),d=g.b,p=g.r;d[28]=258,p[258]=28;for(var C=y(m,0),S=C.b,_=C.r,L=new v(32768),T=0;T<32768;++T){var N=(T&43690)>>1|(T&21845)<<1;N=(N&52428)>>2|(N&13107)<<2,N=(N&61680)>>4|(N&3855)<<4,L[T]=((N&65280)>>8|(N&255)<<8)>>1}for(var F=function(R,M,Z){for(var fe=R.length,Oe=0,Qe=new v(M);Oe<fe;++Oe)R[Oe]&&++Qe[R[Oe]-1];var Je=new v(M);for(Oe=1;Oe<M;++Oe)Je[Oe]=Je[Oe-1]+Qe[Oe-1]<<1;var Xe;if(Z){Xe=new v(1<<M);var ht=15-M;for(Oe=0;Oe<fe;++Oe)if(R[Oe])for(var ct=Oe<<4|R[Oe],at=M-R[Oe],ut=Je[R[Oe]-1]++<<at,Ct=ut|(1<<at)-1;ut<=Ct;++ut)Xe[L[ut]>>ht]=ct}else for(Xe=new v(fe),Oe=0;Oe<fe;++Oe)R[Oe]&&(Xe[Oe]=L[Je[R[Oe]-1]++]>>15-R[Oe]);return Xe},te=new h(288),T=0;T<144;++T)te[T]=8;for(var T=144;T<256;++T)te[T]=9;for(var T=256;T<280;++T)te[T]=7;for(var T=280;T<288;++T)te[T]=8;for(var K=new h(32),T=0;T<32;++T)K[T]=5;var se=F(te,9,0),ne=F(te,9,1),re=F(K,5,0),Y=F(K,5,1),k=function(R){for(var M=R[0],Z=1;Z<R.length;++Z)R[Z]>M&&(M=R[Z]);return M},oe=function(R,M,Z){var fe=M/8|0;return(R[fe]|R[fe+1]<<8)>>(M&7)&Z},ae=function(R,M){var Z=M/8|0;return(R[Z]|R[Z+1]<<8|R[Z+2]<<16)>>(M&7)},Ae=function(R){return(R+7)/8|0},b=function(R,M,Z){return(M==null||M<0)&&(M=0),(Z==null||Z>R.length)&&(Z=R.length),new h(R.subarray(M,Z))},I={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14},O=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Q=function(R,M,Z){var fe=new Error(M||O[R]);if(fe.code=R,Error.captureStackTrace&&Error.captureStackTrace(fe,Q),!Z)throw fe;return fe},J=function(R,M,Z,fe){var Oe=R.length,Qe=fe?fe.length:0;if(!Oe||M.f&&!M.l)return Z||new h(0);var Je=!Z,Xe=Je||M.i!=2,ht=M.i;Je&&(Z=new h(Oe*3));var ct=function(Vs){var Hs=Z.length;if(Vs>Hs){var Ts=new h(Math.max(Hs*2,Vs));Ts.set(Z),Z=Ts}},at=M.f||0,ut=M.p||0,Ct=M.b||0,qt=M.l,Jt=M.d,an=M.m,Zt=M.n,dn=Oe*8;do{if(!qt){at=oe(R,ut,1);var un=oe(R,ut+1,3);if(ut+=3,un)if(un==1)qt=ne,Jt=Y,an=9,Zt=5;else if(un==2){var Mn=oe(R,ut,31)+257,ai=oe(R,ut+10,15)+4,qn=Mn+oe(R,ut+5,31)+1;ut+=14;for(var Un=new h(qn),fi=new h(19),Qn=0;Qn<ai;++Qn)fi[l[Qn]]=oe(R,ut+Qn*3,7);ut+=ai*3;for(var Ni=k(fi),cr=(1<<Ni)-1,Zi=F(fi,Ni,1),Qn=0;Qn<qn;){var Hi=Zi[oe(R,ut,cr)];ut+=Hi&15;var pn=Hi>>4;if(pn<16)Un[Qn++]=pn;else{var hr=0,Ki=0;for(pn==16?(Ki=3+oe(R,ut,3),ut+=2,hr=Un[Qn-1]):pn==17?(Ki=3+oe(R,ut,7),ut+=3):pn==18&&(Ki=11+oe(R,ut,127),ut+=7);Ki--;)Un[Qn++]=hr}}var Rr=Un.subarray(0,Mn),xr=Un.subarray(Mn);an=k(Rr),Zt=k(xr),qt=F(Rr,an,1),Jt=F(xr,Zt,1)}else Q(1);else{var pn=Ae(ut)+4,Vt=R[pn-4]|R[pn-3]<<8,ei=pn+Vt;if(ei>Oe){ht&&Q(0);break}Xe&&ct(Ct+Vt),Z.set(R.subarray(pn,ei),Ct),M.b=Ct+=Vt,M.p=ut=ei*8,M.f=at;continue}if(ut>dn){ht&&Q(0);break}}Xe&&ct(Ct+131072);for(var Ds=(1<<an)-1,jr=(1<<Zt)-1,Es=ut;;Es=ut){var hr=qt[ae(R,ut)&Ds],qr=hr>>4;if(ut+=hr&15,ut>dn){ht&&Q(0);break}if(hr||Q(2),qr<256)Z[Ct++]=qr;else if(qr==256){Es=ut,qt=null;break}else{var Jr=qr-254;if(qr>264){var Qn=qr-257,pr=f[Qn];Jr=oe(R,ut,(1<<pr)-1)+d[Qn],ut+=pr}var ps=Jt[ae(R,ut)&jr],ks=ps>>4;ps||Q(3),ut+=ps&15;var xr=S[ks];if(ks>3){var pr=m[ks];xr+=ae(R,ut)&(1<<pr)-1,ut+=pr}if(ut>dn){ht&&Q(0);break}Xe&&ct(Ct+131072);var Gs=Ct+Jr;if(Ct<xr){var Qs=Qe-xr,qs=Math.min(xr,Gs);for(Qs+Ct<0&&Q(3);Ct<qs;++Ct)Z[Ct]=fe[Qs+Ct]}for(;Ct<Gs;++Ct)Z[Ct]=Z[Ct-xr]}}M.l=qt,M.p=Es,M.b=Ct,M.f=at,qt&&(at=1,M.m=an,M.d=Jt,M.n=Zt)}while(!at);return Ct!=Z.length&&Je?b(Z,0,Ct):Z.subarray(0,Ct)},ve=function(R,M,Z){Z<<=M&7;var fe=M/8|0;R[fe]|=Z,R[fe+1]|=Z>>8},Le=function(R,M,Z){Z<<=M&7;var fe=M/8|0;R[fe]|=Z,R[fe+1]|=Z>>8,R[fe+2]|=Z>>16},_e=function(R,M){for(var Z=[],fe=0;fe<R.length;++fe)R[fe]&&Z.push({s:fe,f:R[fe]});var Oe=Z.length,Qe=Z.slice();if(!Oe)return{t:jt,l:0};if(Oe==1){var Je=new h(Z[0].s+1);return Je[Z[0].s]=1,{t:Je,l:1}}Z.sort(function(ei,Mn){return ei.f-Mn.f}),Z.push({s:-1,f:25001});var Xe=Z[0],ht=Z[1],ct=0,at=1,ut=2;for(Z[0]={s:-1,f:Xe.f+ht.f,l:Xe,r:ht};at!=Oe-1;)Xe=Z[Z[ct].f<Z[ut].f?ct++:ut++],ht=Z[ct!=at&&Z[ct].f<Z[ut].f?ct++:ut++],Z[at++]={s:-1,f:Xe.f+ht.f,l:Xe,r:ht};for(var Ct=Qe[0].s,fe=1;fe<Oe;++fe)Qe[fe].s>Ct&&(Ct=Qe[fe].s);var qt=new v(Ct+1),Jt=Ze(Z[at-1],qt,0);if(Jt>M){var fe=0,an=0,Zt=Jt-M,dn=1<<Zt;for(Qe.sort(function(Mn,ai){return qt[ai.s]-qt[Mn.s]||Mn.f-ai.f});fe<Oe;++fe){var un=Qe[fe].s;if(qt[un]>M)an+=dn-(1<<Jt-qt[un]),qt[un]=M;else break}for(an>>=Zt;an>0;){var pn=Qe[fe].s;qt[pn]<M?an-=1<<M-qt[pn]++-1:++fe}for(;fe>=0&&an;--fe){var Vt=Qe[fe].s;qt[Vt]==M&&(--qt[Vt],++an)}Jt=M}return{t:new h(qt),l:Jt}},Ze=function(R,M,Z){return R.s==-1?Math.max(Ze(R.l,M,Z+1),Ze(R.r,M,Z+1)):M[R.s]=Z},qe=function(R){for(var M=R.length;M&&!R[--M];);for(var Z=new v(++M),fe=0,Oe=R[0],Qe=1,Je=function(ht){Z[fe++]=ht},Xe=1;Xe<=M;++Xe)if(R[Xe]==Oe&&Xe!=M)++Qe;else{if(!Oe&&Qe>2){for(;Qe>138;Qe-=138)Je(32754);Qe>2&&(Je(Qe>10?Qe-11<<5|28690:Qe-3<<5|12305),Qe=0)}else if(Qe>3){for(Je(Oe),--Qe;Qe>6;Qe-=6)Je(8304);Qe>2&&(Je(Qe-3<<5|8208),Qe=0)}for(;Qe--;)Je(Oe);Qe=1,Oe=R[Xe]}return{c:Z.subarray(0,fe),n:M}},ft=function(R,M){for(var Z=0,fe=0;fe<M.length;++fe)Z+=R[fe]*M[fe];return Z},Et=function(R,M,Z){var fe=Z.length,Oe=Ae(M+2);R[Oe]=fe&255,R[Oe+1]=fe>>8,R[Oe+2]=R[Oe]^255,R[Oe+3]=R[Oe+1]^255;for(var Qe=0;Qe<fe;++Qe)R[Oe+Qe+4]=Z[Qe];return(Oe+4+fe)*8},Bt=function(R,M,Z,fe,Oe,Qe,Je,Xe,ht,ct,at){ve(M,at++,Z),++Oe[256];for(var ut=_e(Oe,15),Ct=ut.t,qt=ut.l,Jt=_e(Qe,15),an=Jt.t,Zt=Jt.l,dn=qe(Ct),un=dn.c,pn=dn.n,Vt=qe(an),ei=Vt.c,Mn=Vt.n,ai=new v(19),qn=0;qn<un.length;++qn)++ai[un[qn]&31];for(var qn=0;qn<ei.length;++qn)++ai[ei[qn]&31];for(var Un=_e(ai,7),fi=Un.t,Qn=Un.l,Ni=19;Ni>4&&!fi[l[Ni-1]];--Ni);var cr=ct+5<<3,Zi=ft(Oe,te)+ft(Qe,K)+Je,Hi=ft(Oe,Ct)+ft(Qe,an)+Je+14+3*Ni+ft(ai,fi)+2*ai[16]+3*ai[17]+7*ai[18];if(ht>=0&&cr<=Zi&&cr<=Hi)return Et(M,at,R.subarray(ht,ht+ct));var hr,Ki,Rr,xr;if(ve(M,at,1+(Hi<Zi)),at+=2,Hi<Zi){hr=F(Ct,qt,0),Ki=Ct,Rr=F(an,Zt,0),xr=an;var Ds=F(fi,Qn,0);ve(M,at,pn-257),ve(M,at+5,Mn-1),ve(M,at+10,Ni-4),at+=14;for(var qn=0;qn<Ni;++qn)ve(M,at+3*qn,fi[l[qn]]);at+=3*Ni;for(var jr=[un,ei],Es=0;Es<2;++Es)for(var qr=jr[Es],qn=0;qn<qr.length;++qn){var Jr=qr[qn]&31;ve(M,at,Ds[Jr]),at+=fi[Jr],Jr>15&&(ve(M,at,qr[qn]>>5&127),at+=qr[qn]>>12)}}else hr=se,Ki=te,Rr=re,xr=K;for(var qn=0;qn<Xe;++qn){var pr=fe[qn];if(pr>255){var Jr=pr>>18&31;Le(M,at,hr[Jr+257]),at+=Ki[Jr+257],Jr>7&&(ve(M,at,pr>>23&31),at+=f[Jr]);var ps=pr&31;Le(M,at,Rr[ps]),at+=xr[ps],ps>3&&(Le(M,at,pr>>5&8191),at+=m[ps])}else Le(M,at,hr[pr]),at+=Ki[pr]}return Le(M,at,hr[256]),at+Ki[256]},kt=new a([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),jt=new h(0),nn=function(R,M,Z,fe,Oe,Qe){var Je=Qe.z||R.length,Xe=new h(fe+Je+5*(1+Math.ceil(Je/7e3))+Oe),ht=Xe.subarray(fe,Xe.length-Oe),ct=Qe.l,at=(Qe.r||0)&7;if(M){at&&(ht[0]=Qe.r>>3);for(var ut=kt[M-1],Ct=ut>>13,qt=ut&8191,Jt=(1<<Z)-1,an=Qe.p||new v(32768),Zt=Qe.h||new v(Jt+1),dn=Math.ceil(Z/3),un=2*dn,pn=function(ho){return(R[ho]^R[ho+1]<<dn^R[ho+2]<<un)&Jt},Vt=new a(25e3),ei=new v(288),Mn=new v(32),ai=0,qn=0,Un=Qe.i||0,fi=0,Qn=Qe.w||0,Ni=0;Un+2<Je;++Un){var cr=pn(Un),Zi=Un&32767,Hi=Zt[cr];if(an[Zi]=Hi,Zt[cr]=Zi,Qn<=Un){var hr=Je-Un;if((ai>7e3||fi>24576)&&(hr>423||!ct)){at=Bt(R,ht,0,Vt,ei,Mn,qn,fi,Ni,Un-Ni,at),fi=ai=qn=0,Ni=Un;for(var Ki=0;Ki<286;++Ki)ei[Ki]=0;for(var Ki=0;Ki<30;++Ki)Mn[Ki]=0}var Rr=2,xr=0,Ds=qt,jr=Zi-Hi&32767;if(hr>2&&cr==pn(Un-jr))for(var Es=Math.min(Ct,hr)-1,qr=Math.min(32767,Un),Jr=Math.min(258,hr);jr<=qr&&--Ds&&Zi!=Hi;){if(R[Un+Rr]==R[Un+Rr-jr]){for(var pr=0;pr<Jr&&R[Un+pr]==R[Un+pr-jr];++pr);if(pr>Rr){if(Rr=pr,xr=jr,pr>Es)break;for(var ps=Math.min(jr,pr-2),ks=0,Ki=0;Ki<ps;++Ki){var Gs=Un-jr+Ki&32767,Qs=an[Gs],qs=Gs-Qs&32767;qs>ks&&(ks=qs,Hi=Gs)}}}Zi=Hi,Hi=an[Zi],jr+=Zi-Hi&32767}if(xr){Vt[fi++]=268435456|p[Rr]<<18|_[xr];var Vs=p[Rr]&31,Hs=_[xr]&31;qn+=f[Vs]+m[Hs],++ei[257+Vs],++Mn[Hs],Qn=Un+Rr,++ai}else Vt[fi++]=R[Un],++ei[R[Un]]}}for(Un=Math.max(Un,Qn);Un<Je;++Un)Vt[fi++]=R[Un],++ei[R[Un]];at=Bt(R,ht,ct,Vt,ei,Mn,qn,fi,Ni,Un-Ni,at),ct||(Qe.r=at&7|ht[at/8|0]<<3,at-=7,Qe.h=Zt,Qe.p=an,Qe.i=Un,Qe.w=Qn)}else{for(var Un=Qe.w||0;Un<Je+ct;Un+=65535){var Ts=Un+65535;Ts>=Je&&(ht[at/8|0]=ct,Ts=Je),at=Et(ht,at+1,R.subarray(Un,Ts))}Qe.i=Je}return b(Xe,0,fe+Ae(at)+Oe)},Jn=function(){for(var R=new Int32Array(256),M=0;M<256;++M){for(var Z=M,fe=9;--fe;)Z=(Z&1&&-306674912)^Z>>>1;R[M]=Z}return R}(),kn=function(){var R=-1;return{p:function(M){for(var Z=R,fe=0;fe<M.length;++fe)Z=Jn[Z&255^M[fe]]^Z>>>8;R=Z},d:function(){return~R}}},xn=function(){var R=1,M=0;return{p:function(Z){for(var fe=R,Oe=M,Qe=Z.length|0,Je=0;Je!=Qe;){for(var Xe=Math.min(Je+2655,Qe);Je<Xe;++Je)Oe+=fe+=Z[Je];fe=(fe&65535)+15*(fe>>16),Oe=(Oe&65535)+15*(Oe>>16)}R=fe,M=Oe},d:function(){return R%=65521,M%=65521,(R&255)<<24|(R&65280)<<8|(M&255)<<8|M>>8}}},Fn=function(R,M,Z,fe,Oe){if(!Oe&&(Oe={l:1},M.dictionary)){var Qe=M.dictionary.subarray(-32768),Je=new h(Qe.length+R.length);Je.set(Qe),Je.set(R,Qe.length),R=Je,Oe.w=Qe.length}return nn(R,M.level==null?6:M.level,M.mem==null?Oe.l?Math.ceil(Math.max(8,Math.min(13,Math.log(R.length)))*1.5):20:12+M.mem,Z,fe,Oe)},Wn=function(R,M){var Z={};for(var fe in R)Z[fe]=R[fe];for(var fe in M)Z[fe]=M[fe];return Z},Si=function(R,M,Z){for(var fe=R(),Oe=R.toString(),Qe=Oe.slice(Oe.indexOf("[")+1,Oe.lastIndexOf("]")).replace(/\s+/g,"").split(","),Je=0;Je<fe.length;++Je){var Xe=fe[Je],ht=Qe[Je];if(typeof Xe=="function"){M+=";"+ht+"=";var ct=Xe.toString();if(Xe.prototype)if(ct.indexOf("[native code]")!=-1){var at=ct.indexOf(" ",8)+1;M+=ct.slice(at,ct.indexOf("(",at))}else{M+=ct;for(var ut in Xe.prototype)M+=";"+ht+".prototype."+ut+"="+Xe.prototype[ut].toString()}else M+=ct}else Z[ht]=Xe}return M},Zn=[],Ui=function(R){var M=[];for(var Z in R)R[Z].buffer&&M.push((R[Z]=new R[Z].constructor(R[Z])).buffer);return M},Qi=function(R,M,Z,fe){if(!Zn[Z]){for(var Oe="",Qe={},Je=R.length-1,Xe=0;Xe<Je;++Xe)Oe=Si(R[Xe],Oe,Qe);Zn[Z]={c:Si(R[Je],Oe,Qe),e:Qe}}var ht=Wn({},Zn[Z].e);return w(Zn[Z].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+M.toString()+"}",Z,ht,Ui(ht),fe)},Kn=function(){return[h,v,a,f,m,l,d,S,ne,Y,L,O,F,k,oe,ae,Ae,b,Q,J,Er,Re,Ue]},Mt=function(){return[h,v,a,f,m,l,p,_,se,te,re,K,L,kt,jt,F,ve,Le,_e,Ze,qe,ft,Et,Bt,Ae,b,nn,Fn,Mr,Re]},Ce=function(){return[Gt,zt,He,kn,Jn]},ye=function(){return[Yt,Ht]},Fe=function(){return[fn,He,xn]},Se=function(){return[nr]},Re=function(R){return postMessage(R,[R.buffer])},Ue=function(R){return R&&{out:R.size&&new h(R.size),dictionary:R.dictionary}},ee=function(R,M,Z,fe,Oe,Qe){var Je=Qi(Z,fe,Oe,function(Xe,ht){Je.terminate(),Qe(Xe,ht)});return Je.postMessage([R,M],M.consume?[R.buffer]:[]),function(){Je.terminate()}},D=function(R){return R.ondata=function(M,Z){return postMessage([M,Z],[M.buffer])},function(M){M.data.length?(R.push(M.data[0],M.data[1]),postMessage([M.data[0].length])):R.flush()}},G=function(R,M,Z,fe,Oe,Qe,Je){var Xe,ht=Qi(R,fe,Oe,function(ct,at){ct?(ht.terminate(),M.ondata.call(M,ct)):Array.isArray(at)?at.length==1?(M.queuedSize-=at[0],M.ondrain&&M.ondrain(at[0])):(at[1]&&ht.terminate(),M.ondata.call(M,ct,at[0],at[1])):Je(at)});ht.postMessage(Z),M.queuedSize=0,M.push=function(ct,at){M.ondata||Q(5),Xe&&M.ondata(Q(4,0,1),null,!!at),M.queuedSize+=ct.length,ht.postMessage([ct,Xe=at],[ct.buffer])},M.terminate=function(){ht.terminate()},Qe&&(M.flush=function(){ht.postMessage([])})},ue=function(R,M){return R[M]|R[M+1]<<8},xe=function(R,M){return(R[M]|R[M+1]<<8|R[M+2]<<16|R[M+3]<<24)>>>0},Ne=function(R,M){return xe(R,M)+xe(R,M+4)*4294967296},He=function(R,M,Z){for(;Z;++M)R[M]=Z,Z>>>=8},Gt=function(R,M){var Z=M.filename;if(R[0]=31,R[1]=139,R[2]=8,R[8]=M.level<2?4:M.level==9?2:0,R[9]=3,M.mtime!=0&&He(R,4,Math.floor(new Date(M.mtime||Date.now())/1e3)),Z){R[3]=8;for(var fe=0;fe<=Z.length;++fe)R[fe+10]=Z.charCodeAt(fe)}},Yt=function(R){(R[0]!=31||R[1]!=139||R[2]!=8)&&Q(6,"invalid gzip data");var M=R[3],Z=10;M&4&&(Z+=(R[10]|R[11]<<8)+2);for(var fe=(M>>3&1)+(M>>4&1);fe>0;fe-=!R[Z++]);return Z+(M&2)},Ht=function(R){var M=R.length;return(R[M-4]|R[M-3]<<8|R[M-2]<<16|R[M-1]<<24)>>>0},zt=function(R){return 10+(R.filename?R.filename.length+1:0)},fn=function(R,M){var Z=M.level,fe=Z==0?0:Z<6?1:Z==9?3:2;if(R[0]=120,R[1]=fe<<6|(M.dictionary&&32),R[1]|=31-(R[0]<<8|R[1])%31,M.dictionary){var Oe=xn();Oe.p(M.dictionary),He(R,2,Oe.d())}},nr=function(R,M){return((R[0]&15)!=8||R[0]>>4>7||(R[0]<<8|R[1])%31)&&Q(6,"invalid zlib data"),(R[1]>>5&1)==+!M&&Q(6,"invalid zlib data: "+(R[1]&32?"need":"unexpected")+" dictionary"),(R[1]>>3&4)+2};function Bn(R,M){return typeof R=="function"&&(M=R,R={}),this.ondata=M,R}var bi=function(){function R(M,Z){if(typeof M=="function"&&(Z=M,M={}),this.ondata=Z,this.o=M||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new h(98304),this.o.dictionary){var fe=this.o.dictionary.subarray(-32768);this.b.set(fe,32768-fe.length),this.s.i=32768-fe.length}}return R.prototype.p=function(M,Z){this.ondata(Fn(M,this.o,0,0,this.s),Z)},R.prototype.push=function(M,Z){this.ondata||Q(5),this.s.l&&Q(4);var fe=M.length+this.s.z;if(fe>this.b.length){if(fe>2*this.b.length-32768){var Oe=new h(fe&-32768);Oe.set(this.b.subarray(0,this.s.z)),this.b=Oe}var Qe=this.b.length-this.s.z;this.b.set(M.subarray(0,Qe),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(M.subarray(Qe),32768),this.s.z=M.length-Qe+32768,this.s.i=32766,this.s.w=32768}else this.b.set(M,this.s.z),this.s.z+=M.length;this.s.l=Z&1,(this.s.z>this.s.w+8191||Z)&&(this.p(this.b,Z||!1),this.s.w=this.s.i,this.s.i-=2)},R.prototype.flush=function(){this.ondata||Q(5),this.s.l&&Q(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},R}(),Ti=function(){function R(M,Z){G([Mt,function(){return[D,bi]}],this,Bn.call(this,M,Z),function(fe){var Oe=new bi(fe.data);onmessage=D(Oe)},6,1)}return R}();function Oi(R,M,Z){return Z||(Z=M,M={}),typeof Z!="function"&&Q(7),ee(R,M,[Mt],function(fe){return Re(Mr(fe.data[0],fe.data[1]))},0,Z)}function Mr(R,M){return Fn(R,M||{},0,0)}var $n=function(){function R(M,Z){typeof M=="function"&&(Z=M,M={}),this.ondata=Z;var fe=M&&M.dictionary&&M.dictionary.subarray(-32768);this.s={i:0,b:fe?fe.length:0},this.o=new h(32768),this.p=new h(0),fe&&this.o.set(fe)}return R.prototype.e=function(M){if(this.ondata||Q(5),this.d&&Q(4),!this.p.length)this.p=M;else if(M.length){var Z=new h(this.p.length+M.length);Z.set(this.p),Z.set(M,this.p.length),this.p=Z}},R.prototype.c=function(M){this.s.i=+(this.d=M||!1);var Z=this.s.b,fe=J(this.p,this.s,this.o);this.ondata(b(fe,Z,this.s.b),this.d),this.o=b(fe,this.s.b-32768),this.s.b=this.o.length,this.p=b(this.p,this.s.p/8|0),this.s.p&=7},R.prototype.push=function(M,Z){this.e(M),this.c(Z)},R}(),Or=function(){function R(M,Z){G([Kn,function(){return[D,$n]}],this,Bn.call(this,M,Z),function(fe){var Oe=new $n(fe.data);onmessage=D(Oe)},7,0)}return R}();function dr(R,M,Z){return Z||(Z=M,M={}),typeof Z!="function"&&Q(7),ee(R,M,[Kn],function(fe){return Re(Er(fe.data[0],Ue(fe.data[1])))},1,Z)}function Er(R,M){return J(R,{i:2},M&&M.out,M&&M.dictionary)}var Fr=function(){function R(M,Z){this.c=kn(),this.l=0,this.v=1,bi.call(this,M,Z)}return R.prototype.push=function(M,Z){this.c.p(M),this.l+=M.length,bi.prototype.push.call(this,M,Z)},R.prototype.p=function(M,Z){var fe=Fn(M,this.o,this.v&&zt(this.o),Z&&8,this.s);this.v&&(Gt(fe,this.o),this.v=0),Z&&(He(fe,fe.length-8,this.c.d()),He(fe,fe.length-4,this.l)),this.ondata(fe,Z)},R.prototype.flush=function(){bi.prototype.flush.call(this)},R}(),Sr=function(){function R(M,Z){G([Mt,Ce,function(){return[D,bi,Fr]}],this,Bn.call(this,M,Z),function(fe){var Oe=new Fr(fe.data);onmessage=D(Oe)},8,1)}return R}();function ir(R,M,Z){return Z||(Z=M,M={}),typeof Z!="function"&&Q(7),ee(R,M,[Mt,Ce,function(){return[Li]}],function(fe){return Re(Li(fe.data[0],fe.data[1]))},2,Z)}function Li(R,M){M||(M={});var Z=kn(),fe=R.length;Z.p(R);var Oe=Fn(R,M,zt(M),8),Qe=Oe.length;return Gt(Oe,M),He(Oe,Qe-8,Z.d()),He(Oe,Qe-4,fe),Oe}var sr=function(){function R(M,Z){this.v=1,this.r=0,$n.call(this,M,Z)}return R.prototype.push=function(M,Z){if($n.prototype.e.call(this,M),this.r+=M.length,this.v){var fe=this.p.subarray(this.v-1),Oe=fe.length>3?Yt(fe):4;if(Oe>fe.length){if(!Z)return}else this.v>1&&this.onmember&&this.onmember(this.r-fe.length);this.p=fe.subarray(Oe),this.v=0}$n.prototype.c.call(this,Z),this.s.f&&!this.s.l&&!Z&&(this.v=Ae(this.s.p)+9,this.s={i:0},this.o=new h(0),this.push(new h(0),Z))},R}(),fs=function(){function R(M,Z){var fe=this;G([Kn,ye,function(){return[D,$n,sr]}],this,Bn.call(this,M,Z),function(Oe){var Qe=new sr(Oe.data);Qe.onmember=function(Je){return postMessage(Je)},onmessage=D(Qe)},9,0,function(Oe){return fe.onmember&&fe.onmember(Oe)})}return R}();function Ur(R,M,Z){return Z||(Z=M,M={}),typeof Z!="function"&&Q(7),ee(R,M,[Kn,ye,function(){return[os]}],function(fe){return Re(os(fe.data[0],fe.data[1]))},3,Z)}function os(R,M){var Z=Yt(R);return Z+8>R.length&&Q(6,"invalid gzip data"),J(R.subarray(Z,-8),{i:2},M&&M.out||new h(Ht(R)),M&&M.dictionary)}var es=function(){function R(M,Z){this.c=xn(),this.v=1,bi.call(this,M,Z)}return R.prototype.push=function(M,Z){this.c.p(M),bi.prototype.push.call(this,M,Z)},R.prototype.p=function(M,Z){var fe=Fn(M,this.o,this.v&&(this.o.dictionary?6:2),Z&&4,this.s);this.v&&(fn(fe,this.o),this.v=0),Z&&He(fe,fe.length-4,this.c.d()),this.ondata(fe,Z)},R.prototype.flush=function(){bi.prototype.flush.call(this)},R}(),Ie=function(){function R(M,Z){G([Mt,Fe,function(){return[D,bi,es]}],this,Bn.call(this,M,Z),function(fe){var Oe=new es(fe.data);onmessage=D(Oe)},10,1)}return R}();function Ge(R,M,Z){return Z||(Z=M,M={}),typeof Z!="function"&&Q(7),ee(R,M,[Mt,Fe,function(){return[tt]}],function(fe){return Re(tt(fe.data[0],fe.data[1]))},4,Z)}function tt(R,M){M||(M={});var Z=xn();Z.p(R);var fe=Fn(R,M,M.dictionary?6:2,4);return fn(fe,M),He(fe,fe.length-4,Z.d()),fe}var At=function(){function R(M,Z){$n.call(this,M,Z),this.v=M&&M.dictionary?2:1}return R.prototype.push=function(M,Z){if($n.prototype.e.call(this,M),this.v){if(this.p.length<6&&!Z)return;this.p=this.p.subarray(nr(this.p,this.v-1)),this.v=0}Z&&(this.p.length<4&&Q(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),$n.prototype.c.call(this,Z)},R}(),lt=function(){function R(M,Z){G([Kn,Se,function(){return[D,$n,At]}],this,Bn.call(this,M,Z),function(fe){var Oe=new At(fe.data);onmessage=D(Oe)},11,0)}return R}();function wt(R,M,Z){return Z||(Z=M,M={}),typeof Z!="function"&&Q(7),ee(R,M,[Kn,Se,function(){return[Ft]}],function(fe){return Re(Ft(fe.data[0],Ue(fe.data[1])))},5,Z)}function Ft(R,M){return J(R.subarray(nr(R,M&&M.dictionary),-4),{i:2},M&&M.out,M&&M.dictionary)}var yn=function(){function R(M,Z){this.o=Bn.call(this,M,Z)||{},this.G=sr,this.I=$n,this.Z=At}return R.prototype.i=function(){var M=this;this.s.ondata=function(Z,fe){M.ondata(Z,fe)}},R.prototype.push=function(M,Z){if(this.ondata||Q(5),this.s)this.s.push(M,Z);else{if(this.p&&this.p.length){var fe=new h(this.p.length+M.length);fe.set(this.p),fe.set(M,this.p.length)}else this.p=M;this.p.length>2&&(this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(this.o):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(this.o):new this.Z(this.o),this.i(),this.s.push(this.p,Z),this.p=null)}},R}(),tn=function(){function R(M,Z){yn.call(this,M,Z),this.queuedSize=0,this.G=fs,this.I=Or,this.Z=lt}return R.prototype.i=function(){var M=this;this.s.ondata=function(Z,fe,Oe){M.ondata(Z,fe,Oe)},this.s.ondrain=function(Z){M.queuedSize-=Z,M.ondrain&&M.ondrain(Z)}},R.prototype.push=function(M,Z){this.queuedSize+=M.length,yn.prototype.push.call(this,M,Z)},R}();function bt(R,M,Z){return Z||(Z=M,M={}),typeof Z!="function"&&Q(7),R[0]==31&&R[1]==139&&R[2]==8?Ur(R,M,Z):(R[0]&15)!=8||R[0]>>4>7||(R[0]<<8|R[1])%31?dr(R,M,Z):wt(R,M,Z)}function Rn(R,M){return R[0]==31&&R[1]==139&&R[2]==8?os(R,M):(R[0]&15)!=8||R[0]>>4>7||(R[0]<<8|R[1])%31?Er(R,M):Ft(R,M)}var Pn=function(R,M,Z,fe){for(var Oe in R){var Qe=R[Oe],Je=M+Oe,Xe=fe;Array.isArray(Qe)&&(Xe=Wn(fe,Qe[1]),Qe=Qe[0]),Qe instanceof h?Z[Je]=[Qe,Xe]:(Z[Je+="/"]=[new h(0),Xe],Pn(Qe,Je,Z,fe))}},Xn=typeof TextEncoder<"u"&&new TextEncoder,Di=typeof TextDecoder<"u"&&new TextDecoder,si=0;try{Di.decode(jt,{stream:!0}),si=1}catch{}var ti=function(R){for(var M="",Z=0;;){var fe=R[Z++],Oe=(fe>127)+(fe>223)+(fe>239);if(Z+Oe>R.length)return{s:M,r:b(R,Z-1)};Oe?Oe==3?(fe=((fe&15)<<18|(R[Z++]&63)<<12|(R[Z++]&63)<<6|R[Z++]&63)-65536,M+=String.fromCharCode(55296|fe>>10,56320|fe&1023)):Oe&1?M+=String.fromCharCode((fe&31)<<6|R[Z++]&63):M+=String.fromCharCode((fe&15)<<12|(R[Z++]&63)<<6|R[Z++]&63):M+=String.fromCharCode(fe)}},pi=function(){function R(M){this.ondata=M,si?this.t=new TextDecoder:this.p=jt}return R.prototype.push=function(M,Z){if(this.ondata||Q(5),Z=!!Z,this.t){this.ondata(this.t.decode(M,{stream:!0}),Z),Z&&(this.t.decode().length&&Q(8),this.t=null);return}this.p||Q(4);var fe=new h(this.p.length+M.length);fe.set(this.p),fe.set(M,this.p.length);var Oe=ti(fe),Qe=Oe.s,Je=Oe.r;Z?(Je.length&&Q(8),this.p=null):this.p=Je,this.ondata(Qe,Z)},R}(),Wi=function(){function R(M){this.ondata=M}return R.prototype.push=function(M,Z){this.ondata||Q(5),this.d&&Q(4),this.ondata(Vi(M),this.d=Z||!1)},R}();function Vi(R,M){if(M){for(var Z=new h(R.length),fe=0;fe<R.length;++fe)Z[fe]=R.charCodeAt(fe);return Z}if(Xn)return Xn.encode(R);for(var Oe=R.length,Qe=new h(R.length+(R.length>>1)),Je=0,Xe=function(at){Qe[Je++]=at},fe=0;fe<Oe;++fe){if(Je+5>Qe.length){var ht=new h(Je+8+(Oe-fe<<1));ht.set(Qe),Qe=ht}var ct=R.charCodeAt(fe);ct<128||M?Xe(ct):ct<2048?(Xe(192|ct>>6),Xe(128|ct&63)):ct>55295&&ct<57344?(ct=65536+(ct&1047552)|R.charCodeAt(++fe)&1023,Xe(240|ct>>18),Xe(128|ct>>12&63),Xe(128|ct>>6&63),Xe(128|ct&63)):(Xe(224|ct>>12),Xe(128|ct>>6&63),Xe(128|ct&63))}return b(Qe,0,Je)}function on(R,M){if(M){for(var Z="",fe=0;fe<R.length;fe+=16384)Z+=String.fromCharCode.apply(null,R.subarray(fe,fe+16384));return Z}else{if(Di)return Di.decode(R);var Oe=ti(R),Qe=Oe.s,Z=Oe.r;return Z.length&&Q(8),Qe}}var oi=function(R){return R==1?3:R<6?2:R==9?1:0},or=function(R,M){return M+30+ue(R,M+26)+ue(R,M+28)},gi=function(R,M,Z){var fe=ue(R,M+28),Oe=on(R.subarray(M+46,M+46+fe),!(ue(R,M+8)&2048)),Qe=M+46+fe,Je=xe(R,M+20),Xe=Z&&Je==4294967295?z(R,Qe):[Je,xe(R,M+24),xe(R,M+42)],ht=Xe[0],ct=Xe[1],at=Xe[2];return[ue(R,M+10),ht,ct,Oe,Qe+ue(R,M+30)+ue(R,M+32),at]},z=function(R,M){for(;ue(R,M)!=1;M+=4+ue(R,M+2));return[Ne(R,M+12),Ne(R,M+4),Ne(R,M+20)]},q=function(R){var M=0;if(R)for(var Z in R){var fe=R[Z].length;fe>65535&&Q(9),M+=fe+4}return M},ce=function(R,M,Z,fe,Oe,Qe,Je,Xe){var ht=fe.length,ct=Z.extra,at=Xe&&Xe.length,ut=q(ct);He(R,M,Je!=null?33639248:67324752),M+=4,Je!=null&&(R[M++]=20,R[M++]=Z.os),R[M]=20,M+=2,R[M++]=Z.flag<<1|(Qe<0&&8),R[M++]=Oe&&8,R[M++]=Z.compression&255,R[M++]=Z.compression>>8;var Ct=new Date(Z.mtime==null?Date.now():Z.mtime),qt=Ct.getFullYear()-1980;if((qt<0||qt>119)&&Q(10),He(R,M,qt<<25|Ct.getMonth()+1<<21|Ct.getDate()<<16|Ct.getHours()<<11|Ct.getMinutes()<<5|Ct.getSeconds()>>1),M+=4,Qe!=-1&&(He(R,M,Z.crc),He(R,M+4,Qe<0?-Qe-2:Qe),He(R,M+8,Z.size)),He(R,M+12,ht),He(R,M+14,ut),M+=16,Je!=null&&(He(R,M,at),He(R,M+6,Z.attrs),He(R,M+10,Je),M+=14),R.set(fe,M),M+=ht,ut)for(var Jt in ct){var an=ct[Jt],Zt=an.length;He(R,M,+Jt),He(R,M+2,Zt),R.set(an,M+4),M+=4+Zt}return at&&(R.set(Xe,M),M+=at),M},me=function(R,M,Z,fe,Oe){He(R,M,101010256),He(R,M+8,Z),He(R,M+10,Z),He(R,M+12,fe),He(R,M+16,Oe)},Me=function(){function R(M){this.filename=M,this.c=kn(),this.size=0,this.compression=0}return R.prototype.process=function(M,Z){this.ondata(null,M,Z)},R.prototype.push=function(M,Z){this.ondata||Q(5),this.c.p(M),this.size+=M.length,Z&&(this.crc=this.c.d()),this.process(M,Z||!1)},R}(),Ke=function(){function R(M,Z){var fe=this;Z||(Z={}),Me.call(this,M),this.d=new bi(Z,function(Oe,Qe){fe.ondata(null,Oe,Qe)}),this.compression=8,this.flag=oi(Z.level)}return R.prototype.process=function(M,Z){try{this.d.push(M,Z)}catch(fe){this.ondata(fe,null,Z)}},R.prototype.push=function(M,Z){Me.prototype.push.call(this,M,Z)},R}(),et=function(){function R(M,Z){var fe=this;Z||(Z={}),Me.call(this,M),this.d=new Ti(Z,function(Oe,Qe,Je){fe.ondata(Oe,Qe,Je)}),this.compression=8,this.flag=oi(Z.level),this.terminate=this.d.terminate}return R.prototype.process=function(M,Z){this.d.push(M,Z)},R.prototype.push=function(M,Z){Me.prototype.push.call(this,M,Z)},R}(),It=function(){function R(M){this.ondata=M,this.u=[],this.d=1}return R.prototype.add=function(M){var Z=this;if(this.ondata||Q(5),this.d&2)this.ondata(Q(4+(this.d&1)*8,0,1),null,!1);else{var fe=Vi(M.filename),Oe=fe.length,Qe=M.comment,Je=Qe&&Vi(Qe),Xe=Oe!=M.filename.length||Je&&Qe.length!=Je.length,ht=Oe+q(M.extra)+30;Oe>65535&&this.ondata(Q(11,0,1),null,!1);var ct=new h(ht);ce(ct,0,M,fe,Xe,-1);var at=[ct],ut=function(){for(var Zt=0,dn=at;Zt<dn.length;Zt++){var un=dn[Zt];Z.ondata(null,un,!1)}at=[]},Ct=this.d;this.d=0;var qt=this.u.length,Jt=Wn(M,{f:fe,u:Xe,o:Je,t:function(){M.terminate&&M.terminate()},r:function(){if(ut(),Ct){var Zt=Z.u[qt+1];Zt?Zt.r():Z.d=1}Ct=1}}),an=0;M.ondata=function(Zt,dn,un){if(Zt)Z.ondata(Zt,dn,un),Z.terminate();else if(an+=dn.length,at.push(dn),un){var pn=new h(16);He(pn,0,134695760),He(pn,4,M.crc),He(pn,8,an),He(pn,12,M.size),at.push(pn),Jt.c=an,Jt.b=ht+an+16,Jt.crc=M.crc,Jt.size=M.size,Ct&&Jt.r(),Ct=1}else Ct&&ut()},this.u.push(Jt)}},R.prototype.end=function(){var M=this;if(this.d&2){this.ondata(Q(4+(this.d&1)*8,0,1),null,!0);return}this.d?this.e():this.u.push({r:function(){M.d&1&&(M.u.splice(-1,1),M.e())},t:function(){}}),this.d=3},R.prototype.e=function(){for(var M=0,Z=0,fe=0,Oe=0,Qe=this.u;Oe<Qe.length;Oe++){var Je=Qe[Oe];fe+=46+Je.f.length+q(Je.extra)+(Je.o?Je.o.length:0)}for(var Xe=new h(fe+22),ht=0,ct=this.u;ht<ct.length;ht++){var Je=ct[ht];ce(Xe,M,Je,Je.f,Je.u,-Je.c-2,Z,Je.o),M+=46+Je.f.length+q(Je.extra)+(Je.o?Je.o.length:0),Z+=Je.b}me(Xe,M,this.u.length,fe,Z),this.ondata(null,Xe,!0),this.d=2},R.prototype.terminate=function(){for(var M=0,Z=this.u;M<Z.length;M++){var fe=Z[M];fe.t()}this.d=2},R}();function St(R,M,Z){Z||(Z=M,M={}),typeof Z!="function"&&Q(7);var fe={};Pn(R,"",fe,M);var Oe=Object.keys(fe),Qe=Oe.length,Je=0,Xe=0,ht=Qe,ct=new Array(Qe),at=[],ut=function(){for(var Zt=0;Zt<at.length;++Zt)at[Zt]()},Ct=function(Zt,dn){le(function(){Z(Zt,dn)})};le(function(){Ct=Z});var qt=function(){var Zt=new h(Xe+22),dn=Je,un=Xe-Je;Xe=0;for(var pn=0;pn<ht;++pn){var Vt=ct[pn];try{var ei=Vt.c.length;ce(Zt,Xe,Vt,Vt.f,Vt.u,ei);var Mn=30+Vt.f.length+q(Vt.extra),ai=Xe+Mn;Zt.set(Vt.c,ai),ce(Zt,Je,Vt,Vt.f,Vt.u,ei,Xe,Vt.m),Je+=16+Mn+(Vt.m?Vt.m.length:0),Xe=ai+ei}catch(qn){return Ct(qn,null)}}me(Zt,Je,ct.length,un,dn),Ct(null,Zt)};Qe||qt();for(var Jt=function(Zt){var dn=Oe[Zt],un=fe[dn],pn=un[0],Vt=un[1],ei=kn(),Mn=pn.length;ei.p(pn);var ai=Vi(dn),qn=ai.length,Un=Vt.comment,fi=Un&&Vi(Un),Qn=fi&&fi.length,Ni=q(Vt.extra),cr=Vt.level==0?0:8,Zi=function(Hi,hr){if(Hi)ut(),Ct(Hi,null);else{var Ki=hr.length;ct[Zt]=Wn(Vt,{size:Mn,crc:ei.d(),c:hr,f:ai,m:fi,u:qn!=dn.length||fi&&Un.length!=Qn,compression:cr}),Je+=30+qn+Ni+Ki,Xe+=76+2*(qn+Ni)+(Qn||0)+Ki,--Qe||qt()}};if(qn>65535&&Zi(Q(11,0,1),null),!cr)Zi(null,pn);else if(Mn<16e4)try{Zi(null,Mr(pn,Vt))}catch(Hi){Zi(Hi,null)}else at.push(Oi(pn,Vt,Zi))},an=0;an<ht;++an)Jt(an);return ut}function it(R,M){M||(M={});var Z={},fe=[];Pn(R,"",Z,M);var Oe=0,Qe=0;for(var Je in Z){var Xe=Z[Je],ht=Xe[0],ct=Xe[1],at=ct.level==0?0:8,ut=Vi(Je),Ct=ut.length,qt=ct.comment,Jt=qt&&Vi(qt),an=Jt&&Jt.length,Zt=q(ct.extra);Ct>65535&&Q(11);var dn=at?Mr(ht,ct):ht,un=dn.length,pn=kn();pn.p(ht),fe.push(Wn(ct,{size:ht.length,crc:pn.d(),c:dn,f:ut,m:Jt,u:Ct!=Je.length||Jt&&qt.length!=an,o:Oe,compression:at})),Oe+=30+Ct+Zt+un,Qe+=76+2*(Ct+Zt)+(an||0)+un}for(var Vt=new h(Qe+22),ei=Oe,Mn=Qe-Oe,ai=0;ai<fe.length;++ai){var ut=fe[ai];ce(Vt,ut.o,ut,ut.f,ut.u,ut.c.length);var qn=30+ut.f.length+q(ut.extra);Vt.set(ut.c,ut.o+qn),ce(Vt,Oe,ut,ut.f,ut.u,ut.c.length,ut.o,ut.m),Oe+=16+qn+(ut.m?ut.m.length:0)}return me(Vt,Oe,fe.length,Mn,ei),Vt}var yt=function(){function R(){}return R.prototype.push=function(M,Z){this.ondata(null,M,Z)},R.compression=0,R}(),Nt=function(){function R(){var M=this;this.i=new $n(function(Z,fe){M.ondata(null,Z,fe)})}return R.prototype.push=function(M,Z){try{this.i.push(M,Z)}catch(fe){this.ondata(fe,null,Z)}},R.compression=8,R}(),_t=function(){function R(M,Z){var fe=this;Z<32e4?this.i=new $n(function(Oe,Qe){fe.ondata(null,Oe,Qe)}):(this.i=new Or(function(Oe,Qe,Je){fe.ondata(Oe,Qe,Je)}),this.terminate=this.i.terminate)}return R.prototype.push=function(M,Z){this.i.terminate&&(M=b(M,0)),this.i.push(M,Z)},R.compression=8,R}(),Cn=function(){function R(M){this.onfile=M,this.k=[],this.o={0:yt},this.p=jt}return R.prototype.push=function(M,Z){var fe=this;if(this.onfile||Q(5),this.p||Q(4),this.c>0){var Oe=Math.min(this.c,M.length),Qe=M.subarray(0,Oe);if(this.c-=Oe,this.d?this.d.push(Qe,!this.c):this.k[0].push(Qe),M=M.subarray(Oe),M.length)return this.push(M,Z)}else{var Je=0,Xe=0,ht=void 0,ct=void 0;this.p.length?M.length?(ct=new h(this.p.length+M.length),ct.set(this.p),ct.set(M,this.p.length)):ct=this.p:ct=M;for(var at=ct.length,ut=this.c,Ct=ut&&this.d,qt=function(){var dn,un=xe(ct,Xe);if(un==67324752){Je=1,ht=Xe,Jt.d=null,Jt.c=0;var pn=ue(ct,Xe+6),Vt=ue(ct,Xe+8),ei=pn&2048,Mn=pn&8,ai=ue(ct,Xe+26),qn=ue(ct,Xe+28);if(at>Xe+30+ai+qn){var Un=[];Jt.k.unshift(Un),Je=2;var fi=xe(ct,Xe+18),Qn=xe(ct,Xe+22),Ni=on(ct.subarray(Xe+30,Xe+=30+ai),!ei);fi==4294967295?(dn=Mn?[-2]:z(ct,Xe),fi=dn[0],Qn=dn[1]):Mn&&(fi=-1),Xe+=qn,Jt.c=fi;var cr,Zi={name:Ni,compression:Vt,start:function(){if(Zi.ondata||Q(5),!fi)Zi.ondata(null,jt,!0);else{var Hi=fe.o[Vt];Hi||Zi.ondata(Q(14,"unknown compression type "+Vt,1),null,!1),cr=fi<0?new Hi(Ni):new Hi(Ni,fi,Qn),cr.ondata=function(xr,Ds,jr){Zi.ondata(xr,Ds,jr)};for(var hr=0,Ki=Un;hr<Ki.length;hr++){var Rr=Ki[hr];cr.push(Rr,!1)}fe.k[0]==Un&&fe.c?fe.d=cr:cr.push(jt,!0)}},terminate:function(){cr&&cr.terminate&&cr.terminate()}};fi>=0&&(Zi.size=fi,Zi.originalSize=Qn),Jt.onfile(Zi)}return"break"}else if(ut){if(un==134695760)return ht=Xe+=12+(ut==-2&&8),Je=3,Jt.c=0,"break";if(un==33639248)return ht=Xe-=4,Je=3,Jt.c=0,"break"}},Jt=this;Xe<at-4;++Xe){var an=qt();if(an==="break")break}if(this.p=jt,ut<0){var Zt=Je?ct.subarray(0,ht-12-(ut==-2&&8)-(xe(ct,ht-16)==134695760&&4)):ct.subarray(0,Xe);Ct?Ct.push(Zt,!!Je):this.k[+(Je==2)].push(Zt)}if(Je&2)return this.push(ct.subarray(Xe),Z);this.p=ct.subarray(Xe)}Z&&(this.c&&Q(13),this.p=null)},R.prototype.register=function(M){this.o[M.compression]=M},R}(),le=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(R){R()};function he(R,M,Z){Z||(Z=M,M={}),typeof Z!="function"&&Q(7);var fe=[],Oe=function(){for(var Zt=0;Zt<fe.length;++Zt)fe[Zt]()},Qe={},Je=function(Zt,dn){le(function(){Z(Zt,dn)})};le(function(){Je=Z});for(var Xe=R.length-22;xe(R,Xe)!=101010256;--Xe)if(!Xe||R.length-Xe>65558)return Je(Q(13,0,1),null),Oe;var ht=ue(R,Xe+8);if(ht){var ct=ht,at=xe(R,Xe+16),ut=at==4294967295||ct==65535;if(ut){var Ct=xe(R,Xe-12);ut=xe(R,Ct)==101075792,ut&&(ct=ht=xe(R,Ct+32),at=xe(R,Ct+48))}for(var qt=M&&M.filter,Jt=function(Zt){var dn=gi(R,at,ut),un=dn[0],pn=dn[1],Vt=dn[2],ei=dn[3],Mn=dn[4],ai=dn[5],qn=or(R,ai);at=Mn;var Un=function(Qn,Ni){Qn?(Oe(),Je(Qn,null)):(Ni&&(Qe[ei]=Ni),--ht||Je(null,Qe))};if(!qt||qt({name:ei,size:pn,originalSize:Vt,compression:un}))if(!un)Un(null,b(R,qn,qn+pn));else if(un==8){var fi=R.subarray(qn,qn+pn);if(Vt<524288||pn>.8*Vt)try{Un(null,Er(fi,{out:new h(Vt)}))}catch(Qn){Un(Qn,null)}else fe.push(dr(fi,{size:Vt},Un))}else Un(Q(14,"unknown compression type "+un,1),null);else Un(null,null)},an=0;an<ct;++an)Jt(an)}else Je(null,{});return Oe}function Ee(R,M){for(var Z={},fe=R.length-22;xe(R,fe)!=101010256;--fe)(!fe||R.length-fe>65558)&&Q(13);var Oe=ue(R,fe+8);if(!Oe)return{};var Qe=xe(R,fe+16),Je=Qe==4294967295||Oe==65535;if(Je){var Xe=xe(R,fe-12);Je=xe(R,Xe)==101075792,Je&&(Oe=xe(R,Xe+32),Qe=xe(R,Xe+48))}for(var ht=M&&M.filter,ct=0;ct<Oe;++ct){var at=gi(R,Qe,Je),ut=at[0],Ct=at[1],qt=at[2],Jt=at[3],an=at[4],Zt=at[5],dn=or(R,Zt);Qe=an,(!ht||ht({name:Jt,size:Ct,originalSize:qt,compression:ut}))&&(ut?ut==8?Z[Jt]=Er(R.subarray(dn,dn+Ct),{out:new h(qt)}):Q(14,"unknown compression type "+ut):Z[Jt]=b(R,dn,dn+Ct))}return Z}},"./node_modules/three/examples/jsm/loaders/FBXLoader.js":(W,$,A)=>{A.r($),A.d($,{FBXLoader:()=>m});var u=A("three"),w=A("./node_modules/three/examples/jsm/libs/fflate.module.js"),h=A("./node_modules/three/examples/jsm/curves/NURBSCurve.js");let v,a,f;class m extends u.Loader{constructor(b){super(b)}load(b,I,O,Q){const J=this,ve=J.path===""?u.LoaderUtils.extractUrlBase(b):J.path,Le=new u.FileLoader(this.manager);Le.setPath(J.path),Le.setResponseType("arraybuffer"),Le.setRequestHeader(J.requestHeader),Le.setWithCredentials(J.withCredentials),Le.load(b,function(_e){try{I(J.parse(_e,ve))}catch(Ze){Q?Q(Ze):console.error(Ze),J.manager.itemError(b)}},O,Q)}parse(b,I){if(_(b))v=new p().parse(b);else{const Q=k(b);if(!L(Q))throw new Error("THREE.FBXLoader: Unknown format.");if(T(Q)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+T(Q));v=new d().parse(Q)}const O=new u.TextureLoader(this.manager).setPath(this.resourcePath||I).setCrossOrigin(this.crossOrigin);return new l(O,this.manager).parse(v)}}class l{constructor(b,I){this.textureLoader=b,this.manager=I}parse(){a=this.parseConnections();const b=this.parseImages(),I=this.parseTextures(b),O=this.parseMaterials(I),Q=this.parseDeformers(),J=new y().parse(Q);return this.parseScene(Q,J,O),f}parseConnections(){const b=new Map;return"Connections"in v&&v.Connections.connections.forEach(function(O){const Q=O[0],J=O[1],ve=O[2];b.has(Q)||b.set(Q,{parents:[],children:[]});const Le={ID:J,relationship:ve};b.get(Q).parents.push(Le),b.has(J)||b.set(J,{parents:[],children:[]});const _e={ID:Q,relationship:ve};b.get(J).children.push(_e)}),b}parseImages(){const b={},I={};if("Video"in v.Objects){const O=v.Objects.Video;for(const Q in O){const J=O[Q],ve=parseInt(Q);if(b[ve]=J.RelativeFilename||J.Filename,"Content"in J){const Le=J.Content instanceof ArrayBuffer&&J.Content.byteLength>0,_e=typeof J.Content=="string"&&J.Content!=="";if(Le||_e){const Ze=this.parseImage(O[Q]);I[J.RelativeFilename||J.Filename]=Ze}}}}for(const O in b){const Q=b[O];I[Q]!==void 0?b[O]=I[Q]:b[O]=b[O].split("\\").pop()}return b}parseImage(b){const I=b.Content,O=b.RelativeFilename||b.Filename,Q=O.slice(O.lastIndexOf(".")+1).toLowerCase();let J;switch(Q){case"bmp":J="image/bmp";break;case"jpg":case"jpeg":J="image/jpeg";break;case"png":J="image/png";break;case"tif":J="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",O),J="image/tga";break;default:console.warn('FBXLoader: Image type "'+Q+'" is not supported.');return}if(typeof I=="string")return"data:"+J+";base64,"+I;{const ve=new Uint8Array(I);return window.URL.createObjectURL(new Blob([ve],{type:J}))}}parseTextures(b){const I=new Map;if("Texture"in v.Objects){const O=v.Objects.Texture;for(const Q in O){const J=this.parseTexture(O[Q],b);I.set(parseInt(Q),J)}}return I}parseTexture(b,I){const O=this.loadTexture(b,I);O.ID=b.id,O.name=b.attrName;const Q=b.WrapModeU,J=b.WrapModeV,ve=Q!==void 0?Q.value:0,Le=J!==void 0?J.value:0;if(O.wrapS=ve===0?u.RepeatWrapping:u.ClampToEdgeWrapping,O.wrapT=Le===0?u.RepeatWrapping:u.ClampToEdgeWrapping,"Scaling"in b){const _e=b.Scaling.value;O.repeat.x=_e[0],O.repeat.y=_e[1]}if("Translation"in b){const _e=b.Translation.value;O.offset.x=_e[0],O.offset.y=_e[1]}return O}loadTexture(b,I){let O;const Q=this.textureLoader.path,J=a.get(b.id).children;J!==void 0&&J.length>0&&I[J[0].ID]!==void 0&&(O=I[J[0].ID],(O.indexOf("blob:")===0||O.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let ve;const Le=b.FileName.slice(-3).toLowerCase();if(Le==="tga"){const _e=this.manager.getHandler(".tga");_e===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",b.RelativeFilename),ve=new u.Texture):(_e.setPath(this.textureLoader.path),ve=_e.load(O))}else if(Le==="dds"){const _e=this.manager.getHandler(".dds");_e===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",b.RelativeFilename),ve=new u.Texture):(_e.setPath(this.textureLoader.path),ve=_e.load(O))}else Le==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",b.RelativeFilename),ve=new u.Texture):ve=this.textureLoader.load(O);return this.textureLoader.setPath(Q),ve}parseMaterials(b){const I=new Map;if("Material"in v.Objects){const O=v.Objects.Material;for(const Q in O){const J=this.parseMaterial(O[Q],b);J!==null&&I.set(parseInt(Q),J)}}return I}parseMaterial(b,I){const O=b.id,Q=b.attrName;let J=b.ShadingModel;if(typeof J=="object"&&(J=J.value),!a.has(O))return null;const ve=this.parseParameters(b,I,O);let Le;switch(J.toLowerCase()){case"phong":Le=new u.MeshPhongMaterial;break;case"lambert":Le=new u.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',J),Le=new u.MeshPhongMaterial;break}return Le.setValues(ve),Le.name=Q,Le}parseParameters(b,I,O){const Q={};b.BumpFactor&&(Q.bumpScale=b.BumpFactor.value),b.Diffuse?Q.color=new u.Color().fromArray(b.Diffuse.value).convertSRGBToLinear():b.DiffuseColor&&(b.DiffuseColor.type==="Color"||b.DiffuseColor.type==="ColorRGB")&&(Q.color=new u.Color().fromArray(b.DiffuseColor.value).convertSRGBToLinear()),b.DisplacementFactor&&(Q.displacementScale=b.DisplacementFactor.value),b.Emissive?Q.emissive=new u.Color().fromArray(b.Emissive.value).convertSRGBToLinear():b.EmissiveColor&&(b.EmissiveColor.type==="Color"||b.EmissiveColor.type==="ColorRGB")&&(Q.emissive=new u.Color().fromArray(b.EmissiveColor.value).convertSRGBToLinear()),b.EmissiveFactor&&(Q.emissiveIntensity=parseFloat(b.EmissiveFactor.value)),b.Opacity&&(Q.opacity=parseFloat(b.Opacity.value)),Q.opacity<1&&(Q.transparent=!0),b.ReflectionFactor&&(Q.reflectivity=b.ReflectionFactor.value),b.Shininess&&(Q.shininess=b.Shininess.value),b.Specular?Q.specular=new u.Color().fromArray(b.Specular.value).convertSRGBToLinear():b.SpecularColor&&b.SpecularColor.type==="Color"&&(Q.specular=new u.Color().fromArray(b.SpecularColor.value).convertSRGBToLinear());const J=this;return a.get(O).children.forEach(function(ve){const Le=ve.relationship;switch(Le){case"Bump":Q.bumpMap=J.getTexture(I,ve.ID);break;case"Maya|TEX_ao_map":Q.aoMap=J.getTexture(I,ve.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":Q.map=J.getTexture(I,ve.ID),Q.map!==void 0&&(Q.map.colorSpace=u.SRGBColorSpace);break;case"DisplacementColor":Q.displacementMap=J.getTexture(I,ve.ID);break;case"EmissiveColor":Q.emissiveMap=J.getTexture(I,ve.ID),Q.emissiveMap!==void 0&&(Q.emissiveMap.colorSpace=u.SRGBColorSpace);break;case"NormalMap":case"Maya|TEX_normal_map":Q.normalMap=J.getTexture(I,ve.ID);break;case"ReflectionColor":Q.envMap=J.getTexture(I,ve.ID),Q.envMap!==void 0&&(Q.envMap.mapping=u.EquirectangularReflectionMapping,Q.envMap.colorSpace=u.SRGBColorSpace);break;case"SpecularColor":Q.specularMap=J.getTexture(I,ve.ID),Q.specularMap!==void 0&&(Q.specularMap.colorSpace=u.SRGBColorSpace);break;case"TransparentColor":case"TransparencyFactor":Q.alphaMap=J.getTexture(I,ve.ID),Q.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",Le);break}}),Q}getTexture(b,I){return"LayeredTexture"in v.Objects&&I in v.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),I=a.get(I).children[0].ID),b.get(I)}parseDeformers(){const b={},I={};if("Deformer"in v.Objects){const O=v.Objects.Deformer;for(const Q in O){const J=O[Q],ve=a.get(parseInt(Q));if(J.attrType==="Skin"){const Le=this.parseSkeleton(ve,O);Le.ID=Q,ve.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),Le.geometryID=ve.parents[0].ID,b[Q]=Le}else if(J.attrType==="BlendShape"){const Le={id:Q};Le.rawTargets=this.parseMorphTargets(ve,O),Le.id=Q,ve.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),I[Q]=Le}}}return{skeletons:b,morphTargets:I}}parseSkeleton(b,I){const O=[];return b.children.forEach(function(Q){const J=I[Q.ID];if(J.attrType!=="Cluster")return;const ve={ID:Q.ID,indices:[],weights:[],transformLink:new u.Matrix4().fromArray(J.TransformLink.a)};"Indexes"in J&&(ve.indices=J.Indexes.a,ve.weights=J.Weights.a),O.push(ve)}),{rawBones:O,bones:[]}}parseMorphTargets(b,I){const O=[];for(let Q=0;Q<b.children.length;Q++){const J=b.children[Q],ve=I[J.ID],Le={name:ve.attrName,initialWeight:ve.DeformPercent,id:ve.id,fullWeights:ve.FullWeights.a};if(ve.attrType!=="BlendShapeChannel")return;Le.geoID=a.get(parseInt(J.ID)).children.filter(function(_e){return _e.relationship===void 0})[0].ID,O.push(Le)}return O}parseScene(b,I,O){f=new u.Group;const Q=this.parseModels(b.skeletons,I,O),J=v.Objects.Model,ve=this;Q.forEach(function(_e){const Ze=J[_e.ID];ve.setLookAtProperties(_e,Ze),a.get(_e.ID).parents.forEach(function(ft){const Et=Q.get(ft.ID);Et!==void 0&&Et.add(_e)}),_e.parent===null&&f.add(_e)}),this.bindSkeleton(b.skeletons,I,Q),this.addGlobalSceneSettings(),f.traverse(function(_e){if(_e.userData.transformData){_e.parent&&(_e.userData.transformData.parentMatrix=_e.parent.matrix,_e.userData.transformData.parentMatrixWorld=_e.parent.matrixWorld);const Ze=ne(_e.userData.transformData);_e.applyMatrix4(Ze),_e.updateWorldMatrix()}});const Le=new g().parse();f.children.length===1&&f.children[0].isGroup&&(f.children[0].animations=Le,f=f.children[0]),f.animations=Le}parseModels(b,I,O){const Q=new Map,J=v.Objects.Model;for(const ve in J){const Le=parseInt(ve),_e=J[ve],Ze=a.get(Le);let qe=this.buildSkeleton(Ze,b,Le,_e.attrName);if(!qe){switch(_e.attrType){case"Camera":qe=this.createCamera(Ze);break;case"Light":qe=this.createLight(Ze);break;case"Mesh":qe=this.createMesh(Ze,I,O);break;case"NurbsCurve":qe=this.createCurve(Ze,I);break;case"LimbNode":case"Root":qe=new u.Bone;break;case"Null":default:qe=new u.Group;break}qe.name=_e.attrName?u.PropertyBinding.sanitizeNodeName(_e.attrName):"",qe.userData.originalName=_e.attrName,qe.ID=Le}this.getTransformData(qe,_e),Q.set(Le,qe)}return Q}buildSkeleton(b,I,O,Q){let J=null;return b.parents.forEach(function(ve){for(const Le in I){const _e=I[Le];_e.rawBones.forEach(function(Ze,qe){if(Ze.ID===ve.ID){const ft=J;J=new u.Bone,J.matrixWorld.copy(Ze.transformLink),J.name=Q?u.PropertyBinding.sanitizeNodeName(Q):"",J.userData.originalName=Q,J.ID=O,_e.bones[qe]=J,ft!==null&&J.add(ft)}})}}),J}createCamera(b){let I,O;if(b.children.forEach(function(Q){const J=v.Objects.NodeAttribute[Q.ID];J!==void 0&&(O=J)}),O===void 0)I=new u.Object3D;else{let Q=0;O.CameraProjectionType!==void 0&&O.CameraProjectionType.value===1&&(Q=1);let J=1;O.NearPlane!==void 0&&(J=O.NearPlane.value/1e3);let ve=1e3;O.FarPlane!==void 0&&(ve=O.FarPlane.value/1e3);let Le=window.innerWidth,_e=window.innerHeight;O.AspectWidth!==void 0&&O.AspectHeight!==void 0&&(Le=O.AspectWidth.value,_e=O.AspectHeight.value);const Ze=Le/_e;let qe=45;O.FieldOfView!==void 0&&(qe=O.FieldOfView.value);const ft=O.FocalLength?O.FocalLength.value:null;switch(Q){case 0:I=new u.PerspectiveCamera(qe,Ze,J,ve),ft!==null&&I.setFocalLength(ft);break;case 1:I=new u.OrthographicCamera(-Le/2,Le/2,_e/2,-_e/2,J,ve);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+Q+"."),I=new u.Object3D;break}}return I}createLight(b){let I,O;if(b.children.forEach(function(Q){const J=v.Objects.NodeAttribute[Q.ID];J!==void 0&&(O=J)}),O===void 0)I=new u.Object3D;else{let Q;O.LightType===void 0?Q=0:Q=O.LightType.value;let J=16777215;O.Color!==void 0&&(J=new u.Color().fromArray(O.Color.value).convertSRGBToLinear());let ve=O.Intensity===void 0?1:O.Intensity.value/100;O.CastLightOnObject!==void 0&&O.CastLightOnObject.value===0&&(ve=0);let Le=0;O.FarAttenuationEnd!==void 0&&(O.EnableFarAttenuation!==void 0&&O.EnableFarAttenuation.value===0?Le=0:Le=O.FarAttenuationEnd.value);const _e=1;switch(Q){case 0:I=new u.PointLight(J,ve,Le,_e);break;case 1:I=new u.DirectionalLight(J,ve);break;case 2:let Ze=Math.PI/3;O.InnerAngle!==void 0&&(Ze=u.MathUtils.degToRad(O.InnerAngle.value));let qe=0;O.OuterAngle!==void 0&&(qe=u.MathUtils.degToRad(O.OuterAngle.value),qe=Math.max(qe,1)),I=new u.SpotLight(J,ve,Le,Ze,qe,_e);break;default:console.warn("THREE.FBXLoader: Unknown light type "+O.LightType.value+", defaulting to a PointLight."),I=new u.PointLight(J,ve);break}O.CastShadows!==void 0&&O.CastShadows.value===1&&(I.castShadow=!0)}return I}createMesh(b,I,O){let Q,J=null,ve=null;const Le=[];return b.children.forEach(function(_e){I.has(_e.ID)&&(J=I.get(_e.ID)),O.has(_e.ID)&&Le.push(O.get(_e.ID))}),Le.length>1?ve=Le:Le.length>0?ve=Le[0]:(ve=new u.MeshPhongMaterial({name:u.Loader.DEFAULT_MATERIAL_NAME,color:13421772}),Le.push(ve)),"color"in J.attributes&&Le.forEach(function(_e){_e.vertexColors=!0}),J.FBX_Deformer?(Q=new u.SkinnedMesh(J,ve),Q.normalizeSkinWeights()):Q=new u.Mesh(J,ve),Q}createCurve(b,I){const O=b.children.reduce(function(J,ve){return I.has(ve.ID)&&(J=I.get(ve.ID)),J},null),Q=new u.LineBasicMaterial({name:u.Loader.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new u.Line(O,Q)}getTransformData(b,I){const O={};"InheritType"in I&&(O.inheritType=parseInt(I.InheritType.value)),"RotationOrder"in I?O.eulerOrder=re(I.RotationOrder.value):O.eulerOrder="ZYX","Lcl_Translation"in I&&(O.translation=I.Lcl_Translation.value),"PreRotation"in I&&(O.preRotation=I.PreRotation.value),"Lcl_Rotation"in I&&(O.rotation=I.Lcl_Rotation.value),"PostRotation"in I&&(O.postRotation=I.PostRotation.value),"Lcl_Scaling"in I&&(O.scale=I.Lcl_Scaling.value),"ScalingOffset"in I&&(O.scalingOffset=I.ScalingOffset.value),"ScalingPivot"in I&&(O.scalingPivot=I.ScalingPivot.value),"RotationOffset"in I&&(O.rotationOffset=I.RotationOffset.value),"RotationPivot"in I&&(O.rotationPivot=I.RotationPivot.value),b.userData.transformData=O}setLookAtProperties(b,I){"LookAtProperty"in I&&a.get(b.ID).children.forEach(function(Q){if(Q.relationship==="LookAtProperty"){const J=v.Objects.Model[Q.ID];if("Lcl_Translation"in J){const ve=J.Lcl_Translation.value;b.target!==void 0?(b.target.position.fromArray(ve),f.add(b.target)):b.lookAt(new u.Vector3().fromArray(ve))}}})}bindSkeleton(b,I,O){const Q=this.parsePoseNodes();for(const J in b){const ve=b[J];a.get(parseInt(ve.ID)).parents.forEach(function(_e){if(I.has(_e.ID)){const Ze=_e.ID;a.get(Ze).parents.forEach(function(ft){O.has(ft.ID)&&O.get(ft.ID).bind(new u.Skeleton(ve.bones),Q[ft.ID])})}})}}parsePoseNodes(){const b={};if("Pose"in v.Objects){const I=v.Objects.Pose;for(const O in I)if(I[O].attrType==="BindPose"&&I[O].NbPoseNodes>0){const Q=I[O].PoseNode;Array.isArray(Q)?Q.forEach(function(J){b[J.Node]=new u.Matrix4().fromArray(J.Matrix.a)}):b[Q.Node]=new u.Matrix4().fromArray(Q.Matrix.a)}}return b}addGlobalSceneSettings(){if("GlobalSettings"in v){if("AmbientColor"in v.GlobalSettings){const b=v.GlobalSettings.AmbientColor.value,I=b[0],O=b[1],Q=b[2];if(I!==0||O!==0||Q!==0){const J=new u.Color(I,O,Q).convertSRGBToLinear();f.add(new u.AmbientLight(J,1))}}"UnitScaleFactor"in v.GlobalSettings&&(f.userData.unitScaleFactor=v.GlobalSettings.UnitScaleFactor.value)}}}class y{constructor(){this.negativeMaterialIndices=!1}parse(b){const I=new Map;if("Geometry"in v.Objects){const O=v.Objects.Geometry;for(const Q in O){const J=a.get(parseInt(Q)),ve=this.parseGeometry(J,O[Q],b);I.set(parseInt(Q),ve)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),I}parseGeometry(b,I,O){switch(I.attrType){case"Mesh":return this.parseMeshGeometry(b,I,O);case"NurbsCurve":return this.parseNurbsGeometry(I)}}parseMeshGeometry(b,I,O){const Q=O.skeletons,J=[],ve=b.parents.map(function(ft){return v.Objects.Model[ft.ID]});if(ve.length===0)return;const Le=b.children.reduce(function(ft,Et){return Q[Et.ID]!==void 0&&(ft=Q[Et.ID]),ft},null);b.children.forEach(function(ft){O.morphTargets[ft.ID]!==void 0&&J.push(O.morphTargets[ft.ID])});const _e=ve[0],Ze={};"RotationOrder"in _e&&(Ze.eulerOrder=re(_e.RotationOrder.value)),"InheritType"in _e&&(Ze.inheritType=parseInt(_e.InheritType.value)),"GeometricTranslation"in _e&&(Ze.translation=_e.GeometricTranslation.value),"GeometricRotation"in _e&&(Ze.rotation=_e.GeometricRotation.value),"GeometricScaling"in _e&&(Ze.scale=_e.GeometricScaling.value);const qe=ne(Ze);return this.genGeometry(I,Le,J,qe)}genGeometry(b,I,O,Q){const J=new u.BufferGeometry;b.attrName&&(J.name=b.attrName);const ve=this.parseGeoNode(b,I),Le=this.genBuffers(ve),_e=new u.Float32BufferAttribute(Le.vertex,3);if(_e.applyMatrix4(Q),J.setAttribute("position",_e),Le.colors.length>0&&J.setAttribute("color",new u.Float32BufferAttribute(Le.colors,3)),I&&(J.setAttribute("skinIndex",new u.Uint16BufferAttribute(Le.weightsIndices,4)),J.setAttribute("skinWeight",new u.Float32BufferAttribute(Le.vertexWeights,4)),J.FBX_Deformer=I),Le.normal.length>0){const Ze=new u.Matrix3().getNormalMatrix(Q),qe=new u.Float32BufferAttribute(Le.normal,3);qe.applyNormalMatrix(Ze),J.setAttribute("normal",qe)}if(Le.uvs.forEach(function(Ze,qe){const ft=qe===0?"uv":`uv${qe}`;J.setAttribute(ft,new u.Float32BufferAttribute(Le.uvs[qe],2))}),ve.material&&ve.material.mappingType!=="AllSame"){let Ze=Le.materialIndex[0],qe=0;if(Le.materialIndex.forEach(function(ft,Et){ft!==Ze&&(J.addGroup(qe,Et-qe,Ze),Ze=ft,qe=Et)}),J.groups.length>0){const ft=J.groups[J.groups.length-1],Et=ft.start+ft.count;Et!==Le.materialIndex.length&&J.addGroup(Et,Le.materialIndex.length-Et,Ze)}J.groups.length===0&&J.addGroup(0,Le.materialIndex.length,Le.materialIndex[0])}return this.addMorphTargets(J,b,O,Q),J}parseGeoNode(b,I){const O={};if(O.vertexPositions=b.Vertices!==void 0?b.Vertices.a:[],O.vertexIndices=b.PolygonVertexIndex!==void 0?b.PolygonVertexIndex.a:[],b.LayerElementColor&&(O.color=this.parseVertexColors(b.LayerElementColor[0])),b.LayerElementMaterial&&(O.material=this.parseMaterialIndices(b.LayerElementMaterial[0])),b.LayerElementNormal&&(O.normal=this.parseNormals(b.LayerElementNormal[0])),b.LayerElementUV){O.uv=[];let Q=0;for(;b.LayerElementUV[Q];)b.LayerElementUV[Q].UV&&O.uv.push(this.parseUVs(b.LayerElementUV[Q])),Q++}return O.weightTable={},I!==null&&(O.skeleton=I,I.rawBones.forEach(function(Q,J){Q.indices.forEach(function(ve,Le){O.weightTable[ve]===void 0&&(O.weightTable[ve]=[]),O.weightTable[ve].push({id:J,weight:Q.weights[Le]})})})),O}genBuffers(b){const I={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let O=0,Q=0,J=!1,ve=[],Le=[],_e=[],Ze=[],qe=[],ft=[];const Et=this;return b.vertexIndices.forEach(function(Bt,kt){let jt,nn=!1;Bt<0&&(Bt=Bt^-1,nn=!0);let Jn=[],kn=[];if(ve.push(Bt*3,Bt*3+1,Bt*3+2),b.color){const xn=te(kt,O,Bt,b.color);_e.push(xn[0],xn[1],xn[2])}if(b.skeleton){if(b.weightTable[Bt]!==void 0&&b.weightTable[Bt].forEach(function(xn){kn.push(xn.weight),Jn.push(xn.id)}),kn.length>4){J||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),J=!0);const xn=[0,0,0,0],Fn=[0,0,0,0];kn.forEach(function(Wn,Si){let Zn=Wn,Ui=Jn[Si];Fn.forEach(function(Qi,Kn,Mt){if(Zn>Qi){Mt[Kn]=Zn,Zn=Qi;const Ce=xn[Kn];xn[Kn]=Ui,Ui=Ce}})}),Jn=xn,kn=Fn}for(;kn.length<4;)kn.push(0),Jn.push(0);for(let xn=0;xn<4;++xn)qe.push(kn[xn]),ft.push(Jn[xn])}if(b.normal){const xn=te(kt,O,Bt,b.normal);Le.push(xn[0],xn[1],xn[2])}b.material&&b.material.mappingType!=="AllSame"&&(jt=te(kt,O,Bt,b.material)[0],jt<0&&(Et.negativeMaterialIndices=!0,jt=0)),b.uv&&b.uv.forEach(function(xn,Fn){const Wn=te(kt,O,Bt,xn);Ze[Fn]===void 0&&(Ze[Fn]=[]),Ze[Fn].push(Wn[0]),Ze[Fn].push(Wn[1])}),Q++,nn&&(Et.genFace(I,b,ve,jt,Le,_e,Ze,qe,ft,Q),O++,Q=0,ve=[],Le=[],_e=[],Ze=[],qe=[],ft=[])}),I}getNormalNewell(b){const I=new u.Vector3(0,0,0);for(let O=0;O<b.length;O++){const Q=b[O],J=b[(O+1)%b.length];I.x+=(Q.y-J.y)*(Q.z+J.z),I.y+=(Q.z-J.z)*(Q.x+J.x),I.z+=(Q.x-J.x)*(Q.y+J.y)}return I.normalize(),I}getNormalTangentAndBitangent(b){const I=this.getNormalNewell(b),Q=(Math.abs(I.z)>.5?new u.Vector3(0,1,0):new u.Vector3(0,0,1)).cross(I).normalize(),J=I.clone().cross(Q).normalize();return{normal:I,tangent:Q,bitangent:J}}flattenVertex(b,I,O){return new u.Vector2(b.dot(I),b.dot(O))}genFace(b,I,O,Q,J,ve,Le,_e,Ze,qe){let ft;if(qe>3){const Et=[];for(let nn=0;nn<O.length;nn+=3)Et.push(new u.Vector3(I.vertexPositions[O[nn]],I.vertexPositions[O[nn+1]],I.vertexPositions[O[nn+2]]));const{tangent:Bt,bitangent:kt}=this.getNormalTangentAndBitangent(Et),jt=[];for(const nn of Et)jt.push(this.flattenVertex(nn,Bt,kt));ft=u.ShapeUtils.triangulateShape(jt,[])}else ft=[[0,1,2]];for(const[Et,Bt,kt]of ft)b.vertex.push(I.vertexPositions[O[Et*3]]),b.vertex.push(I.vertexPositions[O[Et*3+1]]),b.vertex.push(I.vertexPositions[O[Et*3+2]]),b.vertex.push(I.vertexPositions[O[Bt*3]]),b.vertex.push(I.vertexPositions[O[Bt*3+1]]),b.vertex.push(I.vertexPositions[O[Bt*3+2]]),b.vertex.push(I.vertexPositions[O[kt*3]]),b.vertex.push(I.vertexPositions[O[kt*3+1]]),b.vertex.push(I.vertexPositions[O[kt*3+2]]),I.skeleton&&(b.vertexWeights.push(_e[Et*4]),b.vertexWeights.push(_e[Et*4+1]),b.vertexWeights.push(_e[Et*4+2]),b.vertexWeights.push(_e[Et*4+3]),b.vertexWeights.push(_e[Bt*4]),b.vertexWeights.push(_e[Bt*4+1]),b.vertexWeights.push(_e[Bt*4+2]),b.vertexWeights.push(_e[Bt*4+3]),b.vertexWeights.push(_e[kt*4]),b.vertexWeights.push(_e[kt*4+1]),b.vertexWeights.push(_e[kt*4+2]),b.vertexWeights.push(_e[kt*4+3]),b.weightsIndices.push(Ze[Et*4]),b.weightsIndices.push(Ze[Et*4+1]),b.weightsIndices.push(Ze[Et*4+2]),b.weightsIndices.push(Ze[Et*4+3]),b.weightsIndices.push(Ze[Bt*4]),b.weightsIndices.push(Ze[Bt*4+1]),b.weightsIndices.push(Ze[Bt*4+2]),b.weightsIndices.push(Ze[Bt*4+3]),b.weightsIndices.push(Ze[kt*4]),b.weightsIndices.push(Ze[kt*4+1]),b.weightsIndices.push(Ze[kt*4+2]),b.weightsIndices.push(Ze[kt*4+3])),I.color&&(b.colors.push(ve[Et*3]),b.colors.push(ve[Et*3+1]),b.colors.push(ve[Et*3+2]),b.colors.push(ve[Bt*3]),b.colors.push(ve[Bt*3+1]),b.colors.push(ve[Bt*3+2]),b.colors.push(ve[kt*3]),b.colors.push(ve[kt*3+1]),b.colors.push(ve[kt*3+2])),I.material&&I.material.mappingType!=="AllSame"&&(b.materialIndex.push(Q),b.materialIndex.push(Q),b.materialIndex.push(Q)),I.normal&&(b.normal.push(J[Et*3]),b.normal.push(J[Et*3+1]),b.normal.push(J[Et*3+2]),b.normal.push(J[Bt*3]),b.normal.push(J[Bt*3+1]),b.normal.push(J[Bt*3+2]),b.normal.push(J[kt*3]),b.normal.push(J[kt*3+1]),b.normal.push(J[kt*3+2])),I.uv&&I.uv.forEach(function(jt,nn){b.uvs[nn]===void 0&&(b.uvs[nn]=[]),b.uvs[nn].push(Le[nn][Et*2]),b.uvs[nn].push(Le[nn][Et*2+1]),b.uvs[nn].push(Le[nn][Bt*2]),b.uvs[nn].push(Le[nn][Bt*2+1]),b.uvs[nn].push(Le[nn][kt*2]),b.uvs[nn].push(Le[nn][kt*2+1])})}addMorphTargets(b,I,O,Q){if(O.length===0)return;b.morphTargetsRelative=!0,b.morphAttributes.position=[];const J=this;O.forEach(function(ve){ve.rawTargets.forEach(function(Le){const _e=v.Objects.Geometry[Le.geoID];_e!==void 0&&J.genMorphGeometry(b,I,_e,Q,Le.name)})})}genMorphGeometry(b,I,O,Q,J){const ve=I.PolygonVertexIndex!==void 0?I.PolygonVertexIndex.a:[],Le=O.Vertices!==void 0?O.Vertices.a:[],_e=O.Indexes!==void 0?O.Indexes.a:[],Ze=b.attributes.position.count*3,qe=new Float32Array(Ze);for(let kt=0;kt<_e.length;kt++){const jt=_e[kt]*3;qe[jt]=Le[kt*3],qe[jt+1]=Le[kt*3+1],qe[jt+2]=Le[kt*3+2]}const ft={vertexIndices:ve,vertexPositions:qe},Et=this.genBuffers(ft),Bt=new u.Float32BufferAttribute(Et.vertex,3);Bt.name=J||O.attrName,Bt.applyMatrix4(Q),b.morphAttributes.position.push(Bt)}parseNormals(b){const I=b.MappingInformationType,O=b.ReferenceInformationType,Q=b.Normals.a;let J=[];return O==="IndexToDirect"&&("NormalIndex"in b?J=b.NormalIndex.a:"NormalsIndex"in b&&(J=b.NormalsIndex.a)),{dataSize:3,buffer:Q,indices:J,mappingType:I,referenceType:O}}parseUVs(b){const I=b.MappingInformationType,O=b.ReferenceInformationType,Q=b.UV.a;let J=[];return O==="IndexToDirect"&&(J=b.UVIndex.a),{dataSize:2,buffer:Q,indices:J,mappingType:I,referenceType:O}}parseVertexColors(b){const I=b.MappingInformationType,O=b.ReferenceInformationType,Q=b.Colors.a;let J=[];O==="IndexToDirect"&&(J=b.ColorIndex.a);for(let ve=0,Le=new u.Color;ve<Q.length;ve+=4)Le.fromArray(Q,ve).convertSRGBToLinear().toArray(Q,ve);return{dataSize:4,buffer:Q,indices:J,mappingType:I,referenceType:O}}parseMaterialIndices(b){const I=b.MappingInformationType,O=b.ReferenceInformationType;if(I==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:O};const Q=b.Materials.a,J=[];for(let ve=0;ve<Q.length;++ve)J.push(ve);return{dataSize:1,buffer:Q,indices:J,mappingType:I,referenceType:O}}parseNurbsGeometry(b){const I=parseInt(b.Order);if(isNaN(I))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",b.Order,b.id),new u.BufferGeometry;const O=I-1,Q=b.KnotVector.a,J=[],ve=b.Points.a;for(let ft=0,Et=ve.length;ft<Et;ft+=4)J.push(new u.Vector4().fromArray(ve,ft));let Le,_e;if(b.Form==="Closed")J.push(J[0]);else if(b.Form==="Periodic"){Le=O,_e=Q.length-1-Le;for(let ft=0;ft<O;++ft)J.push(J[ft])}const qe=new h.NURBSCurve(O,Q,J,Le,_e).getPoints(J.length*12);return new u.BufferGeometry().setFromPoints(qe)}}class g{parse(){const b=[],I=this.parseClips();if(I!==void 0)for(const O in I){const Q=I[O],J=this.addClip(Q);b.push(J)}return b}parseClips(){if(v.Objects.AnimationCurve===void 0)return;const b=this.parseAnimationCurveNodes();this.parseAnimationCurves(b);const I=this.parseAnimationLayers(b);return this.parseAnimStacks(I)}parseAnimationCurveNodes(){const b=v.Objects.AnimationCurveNode,I=new Map;for(const O in b){const Q=b[O];if(Q.attrName.match(/S|R|T|DeformPercent/)!==null){const J={id:Q.id,attr:Q.attrName,curves:{}};I.set(J.id,J)}}return I}parseAnimationCurves(b){const I=v.Objects.AnimationCurve;for(const O in I){const Q={id:I[O].id,times:I[O].KeyTime.a.map(N),values:I[O].KeyValueFloat.a},J=a.get(Q.id);if(J!==void 0){const ve=J.parents[0].ID,Le=J.parents[0].relationship;Le.match(/X/)?b.get(ve).curves.x=Q:Le.match(/Y/)?b.get(ve).curves.y=Q:Le.match(/Z/)?b.get(ve).curves.z=Q:Le.match(/DeformPercent/)&&b.has(ve)&&(b.get(ve).curves.morph=Q)}}}parseAnimationLayers(b){const I=v.Objects.AnimationLayer,O=new Map;for(const Q in I){const J=[],ve=a.get(parseInt(Q));ve!==void 0&&(ve.children.forEach(function(_e,Ze){if(b.has(_e.ID)){const qe=b.get(_e.ID);if(qe.curves.x!==void 0||qe.curves.y!==void 0||qe.curves.z!==void 0){if(J[Ze]===void 0){const ft=a.get(_e.ID).parents.filter(function(Et){return Et.relationship!==void 0})[0].ID;if(ft!==void 0){const Et=v.Objects.Model[ft.toString()];if(Et===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",_e);return}const Bt={modelName:Et.attrName?u.PropertyBinding.sanitizeNodeName(Et.attrName):"",ID:Et.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};f.traverse(function(kt){kt.ID===Et.id&&(Bt.transform=kt.matrix,kt.userData.transformData&&(Bt.eulerOrder=kt.userData.transformData.eulerOrder))}),Bt.transform||(Bt.transform=new u.Matrix4),"PreRotation"in Et&&(Bt.preRotation=Et.PreRotation.value),"PostRotation"in Et&&(Bt.postRotation=Et.PostRotation.value),J[Ze]=Bt}}J[Ze]&&(J[Ze][qe.attr]=qe)}else if(qe.curves.morph!==void 0){if(J[Ze]===void 0){const ft=a.get(_e.ID).parents.filter(function(Jn){return Jn.relationship!==void 0})[0].ID,Et=a.get(ft).parents[0].ID,Bt=a.get(Et).parents[0].ID,kt=a.get(Bt).parents[0].ID,jt=v.Objects.Model[kt],nn={modelName:jt.attrName?u.PropertyBinding.sanitizeNodeName(jt.attrName):"",morphName:v.Objects.Deformer[ft].attrName};J[Ze]=nn}J[Ze][qe.attr]=qe}}}),O.set(parseInt(Q),J))}return O}parseAnimStacks(b){const I=v.Objects.AnimationStack,O={};for(const Q in I){const J=a.get(parseInt(Q)).children;J.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const ve=b.get(J[0].ID);O[Q]={name:I[Q].attrName,layer:ve}}return O}addClip(b){let I=[];const O=this;return b.layer.forEach(function(Q){I=I.concat(O.generateTracks(Q))}),new u.AnimationClip(b.name,-1,I)}generateTracks(b){const I=[];let O=new u.Vector3,Q=new u.Vector3;if(b.transform&&b.transform.decompose(O,new u.Quaternion,Q),O=O.toArray(),Q=Q.toArray(),b.T!==void 0&&Object.keys(b.T.curves).length>0){const J=this.generateVectorTrack(b.modelName,b.T.curves,O,"position");J!==void 0&&I.push(J)}if(b.R!==void 0&&Object.keys(b.R.curves).length>0){const J=this.generateRotationTrack(b.modelName,b.R.curves,b.preRotation,b.postRotation,b.eulerOrder);J!==void 0&&I.push(J)}if(b.S!==void 0&&Object.keys(b.S.curves).length>0){const J=this.generateVectorTrack(b.modelName,b.S.curves,Q,"scale");J!==void 0&&I.push(J)}if(b.DeformPercent!==void 0){const J=this.generateMorphTrack(b);J!==void 0&&I.push(J)}return I}generateVectorTrack(b,I,O,Q){const J=this.getTimesForAllAxes(I),ve=this.getKeyframeTrackValues(J,I,O);return new u.VectorKeyframeTrack(b+"."+Q,J,ve)}generateRotationTrack(b,I,O,Q,J){let ve,Le;if(I.x!==void 0&&I.y!==void 0&&I.z!==void 0){const ft=this.interpolateRotations(I.x,I.y,I.z,J);ve=ft[0],Le=ft[1]}O!==void 0&&(O=O.map(u.MathUtils.degToRad),O.push(J),O=new u.Euler().fromArray(O),O=new u.Quaternion().setFromEuler(O)),Q!==void 0&&(Q=Q.map(u.MathUtils.degToRad),Q.push(J),Q=new u.Euler().fromArray(Q),Q=new u.Quaternion().setFromEuler(Q).invert());const _e=new u.Quaternion,Ze=new u.Euler,qe=[];if(!Le||!ve)return new u.QuaternionKeyframeTrack(b+".quaternion",[0],[0]);for(let ft=0;ft<Le.length;ft+=3)Ze.set(Le[ft],Le[ft+1],Le[ft+2],J),_e.setFromEuler(Ze),O!==void 0&&_e.premultiply(O),Q!==void 0&&_e.multiply(Q),ft>2&&new u.Quaternion().fromArray(qe,(ft-3)/3*4).dot(_e)<0&&_e.set(-_e.x,-_e.y,-_e.z,-_e.w),_e.toArray(qe,ft/3*4);return new u.QuaternionKeyframeTrack(b+".quaternion",ve,qe)}generateMorphTrack(b){const I=b.DeformPercent.curves.morph,O=I.values.map(function(J){return J/100}),Q=f.getObjectByName(b.modelName).morphTargetDictionary[b.morphName];return new u.NumberKeyframeTrack(b.modelName+".morphTargetInfluences["+Q+"]",I.times,O)}getTimesForAllAxes(b){let I=[];if(b.x!==void 0&&(I=I.concat(b.x.times)),b.y!==void 0&&(I=I.concat(b.y.times)),b.z!==void 0&&(I=I.concat(b.z.times)),I=I.sort(function(O,Q){return O-Q}),I.length>1){let O=1,Q=I[0];for(let J=1;J<I.length;J++){const ve=I[J];ve!==Q&&(I[O]=ve,Q=ve,O++)}I=I.slice(0,O)}return I}getKeyframeTrackValues(b,I,O){const Q=O,J=[];let ve=-1,Le=-1,_e=-1;return b.forEach(function(Ze){if(I.x&&(ve=I.x.times.indexOf(Ze)),I.y&&(Le=I.y.times.indexOf(Ze)),I.z&&(_e=I.z.times.indexOf(Ze)),ve!==-1){const qe=I.x.values[ve];J.push(qe),Q[0]=qe}else J.push(Q[0]);if(Le!==-1){const qe=I.y.values[Le];J.push(qe),Q[1]=qe}else J.push(Q[1]);if(_e!==-1){const qe=I.z.values[_e];J.push(qe),Q[2]=qe}else J.push(Q[2])}),J}interpolateRotations(b,I,O,Q){const J=[],ve=[];J.push(b.times[0]),ve.push(u.MathUtils.degToRad(b.values[0])),ve.push(u.MathUtils.degToRad(I.values[0])),ve.push(u.MathUtils.degToRad(O.values[0]));for(let Le=1;Le<b.values.length;Le++){const _e=[b.values[Le-1],I.values[Le-1],O.values[Le-1]];if(isNaN(_e[0])||isNaN(_e[1])||isNaN(_e[2]))continue;const Ze=_e.map(u.MathUtils.degToRad),qe=[b.values[Le],I.values[Le],O.values[Le]];if(isNaN(qe[0])||isNaN(qe[1])||isNaN(qe[2]))continue;const ft=qe.map(u.MathUtils.degToRad),Et=[qe[0]-_e[0],qe[1]-_e[1],qe[2]-_e[2]],Bt=[Math.abs(Et[0]),Math.abs(Et[1]),Math.abs(Et[2])];if(Bt[0]>=180||Bt[1]>=180||Bt[2]>=180){const jt=Math.max(...Bt)/180,nn=new u.Euler(...Ze,Q),Jn=new u.Euler(...ft,Q),kn=new u.Quaternion().setFromEuler(nn),xn=new u.Quaternion().setFromEuler(Jn);kn.dot(xn)&&xn.set(-xn.x,-xn.y,-xn.z,-xn.w);const Fn=b.times[Le-1],Wn=b.times[Le]-Fn,Si=new u.Quaternion,Zn=new u.Euler;for(let Ui=0;Ui<1;Ui+=1/jt)Si.copy(kn.clone().slerp(xn.clone(),Ui)),J.push(Fn+Ui*Wn),Zn.setFromQuaternion(Si,Q),ve.push(Zn.x),ve.push(Zn.y),ve.push(Zn.z)}else J.push(b.times[Le]),ve.push(u.MathUtils.degToRad(b.values[Le])),ve.push(u.MathUtils.degToRad(I.values[Le])),ve.push(u.MathUtils.degToRad(O.values[Le]))}return[J,ve]}}class d{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(b){this.nodeStack.push(b),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(b,I){this.currentProp=b,this.currentPropName=I}parse(b){this.currentIndent=0,this.allNodes=new S,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const I=this,O=b.split(/[\r\n]+/);return O.forEach(function(Q,J){const ve=Q.match(/^[\s\t]*;/),Le=Q.match(/^[\s\t]*$/);if(ve||Le)return;const _e=Q.match("^\\t{"+I.currentIndent+"}(\\w+):(.*){",""),Ze=Q.match("^\\t{"+I.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),qe=Q.match("^\\t{"+(I.currentIndent-1)+"}}");_e?I.parseNodeBegin(Q,_e):Ze?I.parseNodeProperty(Q,Ze,O[++J]):qe?I.popStack():Q.match(/^[^\s\t}]/)&&I.parseNodePropertyContinued(Q)}),this.allNodes}parseNodeBegin(b,I){const O=I[1].trim().replace(/^"/,"").replace(/"$/,""),Q=I[2].split(",").map(function(_e){return _e.trim().replace(/^"/,"").replace(/"$/,"")}),J={name:O},ve=this.parseNodeAttr(Q),Le=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(O,J):O in Le?(O==="PoseNode"?Le.PoseNode.push(J):Le[O].id!==void 0&&(Le[O]={},Le[O][Le[O].id]=Le[O]),ve.id!==""&&(Le[O][ve.id]=J)):typeof ve.id=="number"?(Le[O]={},Le[O][ve.id]=J):O!=="Properties70"&&(O==="PoseNode"?Le[O]=[J]:Le[O]=J),typeof ve.id=="number"&&(J.id=ve.id),ve.name!==""&&(J.attrName=ve.name),ve.type!==""&&(J.attrType=ve.type),this.pushStack(J)}parseNodeAttr(b){let I=b[0];b[0]!==""&&(I=parseInt(b[0]),isNaN(I)&&(I=b[0]));let O="",Q="";return b.length>1&&(O=b[1].replace(/^(\w+)::/,""),Q=b[2]),{id:I,name:O,type:Q}}parseNodeProperty(b,I,O){let Q=I[1].replace(/^"/,"").replace(/"$/,"").trim(),J=I[2].replace(/^"/,"").replace(/"$/,"").trim();Q==="Content"&&J===","&&(J=O.replace(/"/g,"").replace(/,$/,"").trim());const ve=this.getCurrentNode();if(ve.name==="Properties70"){this.parseNodeSpecialProperty(b,Q,J);return}if(Q==="C"){const _e=J.split(",").slice(1),Ze=parseInt(_e[0]),qe=parseInt(_e[1]);let ft=J.split(",").slice(3);ft=ft.map(function(Et){return Et.trim().replace(/^"/,"")}),Q="connections",J=[Ze,qe],oe(J,ft),ve[Q]===void 0&&(ve[Q]=[])}Q==="Node"&&(ve.id=J),Q in ve&&Array.isArray(ve[Q])?ve[Q].push(J):Q!=="a"?ve[Q]=J:ve.a=J,this.setCurrentProp(ve,Q),Q==="a"&&J.slice(-1)!==","&&(ve.a=Y(J))}parseNodePropertyContinued(b){const I=this.getCurrentNode();I.a+=b,b.slice(-1)!==","&&(I.a=Y(I.a))}parseNodeSpecialProperty(b,I,O){const Q=O.split('",').map(function(qe){return qe.trim().replace(/^\"/,"").replace(/\s/,"_")}),J=Q[0],ve=Q[1],Le=Q[2],_e=Q[3];let Ze=Q[4];switch(ve){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":Ze=parseFloat(Ze);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":Ze=Y(Ze);break}this.getPrevNode()[J]={type:ve,type2:Le,flag:_e,value:Ze},this.setCurrentProp(this.getPrevNode(),J)}}class p{parse(b){const I=new C(b);I.skip(23);const O=I.getUint32();if(O<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+O);const Q=new S;for(;!this.endOfContent(I);){const J=this.parseNode(I,O);J!==null&&Q.add(J.name,J)}return Q}endOfContent(b){return b.size()%16===0?(b.getOffset()+160+16&-16)>=b.size():b.getOffset()+160+16>=b.size()}parseNode(b,I){const O={},Q=I>=7500?b.getUint64():b.getUint32(),J=I>=7500?b.getUint64():b.getUint32();I>=7500?b.getUint64():b.getUint32();const ve=b.getUint8(),Le=b.getString(ve);if(Q===0)return null;const _e=[];for(let Et=0;Et<J;Et++)_e.push(this.parseProperty(b));const Ze=_e.length>0?_e[0]:"",qe=_e.length>1?_e[1]:"",ft=_e.length>2?_e[2]:"";for(O.singleProperty=J===1&&b.getOffset()===Q;Q>b.getOffset();){const Et=this.parseNode(b,I);Et!==null&&this.parseSubNode(Le,O,Et)}return O.propertyList=_e,typeof Ze=="number"&&(O.id=Ze),qe!==""&&(O.attrName=qe),ft!==""&&(O.attrType=ft),Le!==""&&(O.name=Le),O}parseSubNode(b,I,O){if(O.singleProperty===!0){const Q=O.propertyList[0];Array.isArray(Q)?(I[O.name]=O,O.a=Q):I[O.name]=Q}else if(b==="Connections"&&O.name==="C"){const Q=[];O.propertyList.forEach(function(J,ve){ve!==0&&Q.push(J)}),I.connections===void 0&&(I.connections=[]),I.connections.push(Q)}else if(O.name==="Properties70")Object.keys(O).forEach(function(J){I[J]=O[J]});else if(b==="Properties70"&&O.name==="P"){let Q=O.propertyList[0],J=O.propertyList[1];const ve=O.propertyList[2],Le=O.propertyList[3];let _e;Q.indexOf("Lcl ")===0&&(Q=Q.replace("Lcl ","Lcl_")),J.indexOf("Lcl ")===0&&(J=J.replace("Lcl ","Lcl_")),J==="Color"||J==="ColorRGB"||J==="Vector"||J==="Vector3D"||J.indexOf("Lcl_")===0?_e=[O.propertyList[4],O.propertyList[5],O.propertyList[6]]:_e=O.propertyList[4],I[Q]={type:J,type2:ve,flag:Le,value:_e}}else I[O.name]===void 0?typeof O.id=="number"?(I[O.name]={},I[O.name][O.id]=O):I[O.name]=O:O.name==="PoseNode"?(Array.isArray(I[O.name])||(I[O.name]=[I[O.name]]),I[O.name].push(O)):I[O.name][O.id]===void 0&&(I[O.name][O.id]=O)}parseProperty(b){const I=b.getString(1);let O;switch(I){case"C":return b.getBoolean();case"D":return b.getFloat64();case"F":return b.getFloat32();case"I":return b.getInt32();case"L":return b.getInt64();case"R":return O=b.getUint32(),b.getArrayBuffer(O);case"S":return O=b.getUint32(),b.getString(O);case"Y":return b.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const Q=b.getUint32(),J=b.getUint32(),ve=b.getUint32();if(J===0)switch(I){case"b":case"c":return b.getBooleanArray(Q);case"d":return b.getFloat64Array(Q);case"f":return b.getFloat32Array(Q);case"i":return b.getInt32Array(Q);case"l":return b.getInt64Array(Q)}const Le=w.unzlibSync(new Uint8Array(b.getArrayBuffer(ve))),_e=new C(Le.buffer);switch(I){case"b":case"c":return _e.getBooleanArray(Q);case"d":return _e.getFloat64Array(Q);case"f":return _e.getFloat32Array(Q);case"i":return _e.getInt32Array(Q);case"l":return _e.getInt64Array(Q)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+I)}}}class C{constructor(b,I){this.dv=new DataView(b),this.offset=0,this.littleEndian=I!==void 0?I:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(b){this.offset+=b}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(b){const I=[];for(let O=0;O<b;O++)I.push(this.getBoolean());return I}getUint8(){const b=this.dv.getUint8(this.offset);return this.offset+=1,b}getInt16(){const b=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,b}getInt32(){const b=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,b}getInt32Array(b){const I=[];for(let O=0;O<b;O++)I.push(this.getInt32());return I}getUint32(){const b=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,b}getInt64(){let b,I;return this.littleEndian?(b=this.getUint32(),I=this.getUint32()):(I=this.getUint32(),b=this.getUint32()),I&2147483648?(I=~I&4294967295,b=~b&4294967295,b===4294967295&&(I=I+1&4294967295),b=b+1&4294967295,-(I*4294967296+b)):I*4294967296+b}getInt64Array(b){const I=[];for(let O=0;O<b;O++)I.push(this.getInt64());return I}getUint64(){let b,I;return this.littleEndian?(b=this.getUint32(),I=this.getUint32()):(I=this.getUint32(),b=this.getUint32()),I*4294967296+b}getFloat32(){const b=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,b}getFloat32Array(b){const I=[];for(let O=0;O<b;O++)I.push(this.getFloat32());return I}getFloat64(){const b=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,b}getFloat64Array(b){const I=[];for(let O=0;O<b;O++)I.push(this.getFloat64());return I}getArrayBuffer(b){const I=this.dv.buffer.slice(this.offset,this.offset+b);return this.offset+=b,I}getString(b){const I=this.offset;let O=new Uint8Array(this.dv.buffer,I,b);this.skip(b);const Q=O.indexOf(0);return Q>=0&&(O=new Uint8Array(this.dv.buffer,I,Q)),this._textDecoder.decode(O)}}class S{add(b,I){this[b]=I}}function _(Ae){const b="Kaydara FBX Binary  \0";return Ae.byteLength>=b.length&&b===k(Ae,0,b.length)}function L(Ae){const b=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let I=0;function O(Q){const J=Ae[Q-1];return Ae=Ae.slice(I+Q),I++,J}for(let Q=0;Q<b.length;++Q)if(O(1)===b[Q])return!1;return!0}function T(Ae){const b=/FBXVersion: (\d+)/,I=Ae.match(b);if(I)return parseInt(I[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function N(Ae){return Ae/46186158e3}const F=[];function te(Ae,b,I,O){let Q;switch(O.mappingType){case"ByPolygonVertex":Q=Ae;break;case"ByPolygon":Q=b;break;case"ByVertice":Q=I;break;case"AllSame":Q=O.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+O.mappingType)}O.referenceType==="IndexToDirect"&&(Q=O.indices[Q]);const J=Q*O.dataSize,ve=J+O.dataSize;return ae(F,O.buffer,J,ve)}const K=new u.Euler,se=new u.Vector3;function ne(Ae){const b=new u.Matrix4,I=new u.Matrix4,O=new u.Matrix4,Q=new u.Matrix4,J=new u.Matrix4,ve=new u.Matrix4,Le=new u.Matrix4,_e=new u.Matrix4,Ze=new u.Matrix4,qe=new u.Matrix4,ft=new u.Matrix4,Et=new u.Matrix4,Bt=Ae.inheritType?Ae.inheritType:0;if(Ae.translation&&b.setPosition(se.fromArray(Ae.translation)),Ae.preRotation){const Kn=Ae.preRotation.map(u.MathUtils.degToRad);Kn.push(Ae.eulerOrder||u.Euler.DEFAULT_ORDER),I.makeRotationFromEuler(K.fromArray(Kn))}if(Ae.rotation){const Kn=Ae.rotation.map(u.MathUtils.degToRad);Kn.push(Ae.eulerOrder||u.Euler.DEFAULT_ORDER),O.makeRotationFromEuler(K.fromArray(Kn))}if(Ae.postRotation){const Kn=Ae.postRotation.map(u.MathUtils.degToRad);Kn.push(Ae.eulerOrder||u.Euler.DEFAULT_ORDER),Q.makeRotationFromEuler(K.fromArray(Kn)),Q.invert()}Ae.scale&&J.scale(se.fromArray(Ae.scale)),Ae.scalingOffset&&Le.setPosition(se.fromArray(Ae.scalingOffset)),Ae.scalingPivot&&ve.setPosition(se.fromArray(Ae.scalingPivot)),Ae.rotationOffset&&_e.setPosition(se.fromArray(Ae.rotationOffset)),Ae.rotationPivot&&Ze.setPosition(se.fromArray(Ae.rotationPivot)),Ae.parentMatrixWorld&&(ft.copy(Ae.parentMatrix),qe.copy(Ae.parentMatrixWorld));const kt=I.clone().multiply(O).multiply(Q),jt=new u.Matrix4;jt.extractRotation(qe);const nn=new u.Matrix4;nn.copyPosition(qe);const Jn=nn.clone().invert().multiply(qe),kn=jt.clone().invert().multiply(Jn),xn=J,Fn=new u.Matrix4;if(Bt===0)Fn.copy(jt).multiply(kt).multiply(kn).multiply(xn);else if(Bt===1)Fn.copy(jt).multiply(kn).multiply(kt).multiply(xn);else{const Mt=new u.Matrix4().scale(new u.Vector3().setFromMatrixScale(ft)).clone().invert(),Ce=kn.clone().multiply(Mt);Fn.copy(jt).multiply(kt).multiply(Ce).multiply(xn)}const Wn=Ze.clone().invert(),Si=ve.clone().invert();let Zn=b.clone().multiply(_e).multiply(Ze).multiply(I).multiply(O).multiply(Q).multiply(Wn).multiply(Le).multiply(ve).multiply(J).multiply(Si);const Ui=new u.Matrix4().copyPosition(Zn),Qi=qe.clone().multiply(Ui);return Et.copyPosition(Qi),Zn=Et.clone().multiply(Fn),Zn.premultiply(qe.invert()),Zn}function re(Ae){Ae=Ae||0;const b=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return Ae===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),b[0]):b[Ae]}function Y(Ae){return Ae.split(",").map(function(I){return parseFloat(I)})}function k(Ae,b,I){return b===void 0&&(b=0),I===void 0&&(I=Ae.byteLength),new TextDecoder().decode(new Uint8Array(Ae,b,I))}function oe(Ae,b){for(let I=0,O=Ae.length,Q=b.length;I<Q;I++,O++)Ae[O]=b[I]}function ae(Ae,b,I,O){for(let Q=I,J=0;Q<O;Q++,J++)Ae[J]=b[Q];return Ae}}},yr={};function mi(W){var $=yr[W];if($!==void 0)return $.exports;var A=yr[W]={exports:{}};return Ys[W](A,A.exports,mi),A.exports}mi.n=W=>{var $=W&&W.__esModule?()=>W.default:()=>W;return mi.d($,{a:$}),$},mi.d=(W,$)=>{for(var A in $)mi.o($,A)&&!mi.o(W,A)&&Object.defineProperty(W,A,{enumerable:!0,get:$[A]})},mi.o=(W,$)=>Object.prototype.hasOwnProperty.call(W,$),mi.r=W=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(W,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(W,"__esModule",{value:!0})};var Bo={};return(()=>{/*!******************!*\
  !*** ./index.js ***!
  \******************/mi("./src/controls/index.js"),mi("./src/loaders/index.js"),mi("./src/misc/index.js"),mi("./src/pathfinding/index.js"),mi("./src/primitives/index.js")})(),Bo})())})(Jy);
